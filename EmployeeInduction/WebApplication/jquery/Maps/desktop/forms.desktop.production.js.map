{"version":3,"sources":["jquery/rendering/js/desktop/container/bizagi.rendering.desktop.container.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.render.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.column.js","jquery/rendering/js/desktop/container/dialog/bizagi.rendering.desktop.dialog.form.js","jquery/rendering/js/desktop/container/dialog/bizagi.rendering.desktop.dialog.startForm.js","jquery/rendering/js/desktop/container/dialog/bizagi.rendering.desktop.dialog.search.js","jquery/rendering/js/desktop/container/dialog/bizagi.rendering.desktop.dialog.searchUser.js","jquery/rendering/js/desktop/container/dialog/bizagi.rendering.desktop.dialog.letter.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.form.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.panel.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.contentPanel.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.nestedForm.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.tab.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.tabItem.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.horizontal.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.layout.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.accordion.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.accordionItem.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.group.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.searchForm.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.text.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.extendedText.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.label.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryLabel.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.number.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryNumber.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.date.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryDate.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.yesno.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.check.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.combo.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.cascadingCombo.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryCombo.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryCascadingCombo.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.collectionnavigator.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.ecm.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.grid.bizagi.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.grid.grouped.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.search.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.letter.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.button.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.fileprint.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.link.js","jquery/rendering/js/desktop/render/layout/bizagi.rendering.desktop.layout.render.js","jquery/rendering/js/desktop/render/layout/bizagi.rendering.desktop.layout.placeholder.js","jquery/rendering/js/desktop/render/layout/bizagi.rendering.desktop.layout.boolean.js","jquery/rendering/js/desktop/render/layout/bizagi.rendering.desktop.layout.image.js","jquery/rendering/js/desktop/render/layout/bizagi.rendering.desktop.layout.link.js","jquery/rendering/js/desktop/render/layout/bizagi.rendering.desktop.layout.label.js","jquery/rendering/js/desktop/render/layout/bizagi.rendering.desktop.layout.text.js","jquery/rendering/js/desktop/render/layout/bizagi.rendering.desktop.layout.dateTime.js","jquery/rendering/js/desktop/render/layout/bizagi.rendering.desktop.layout.number.js","jquery/rendering/js/desktop/render/layout/bizagi.rendering.desktop.layout.money.js","jquery/rendering/js/desktop/render/layout/bizagi.rendering.desktop.layout.upload.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.formLink.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.geolocation.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.hidden.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.money.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryMoney.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.radio.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryRadio.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryState.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryCaseState.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryGrid.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.list.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.multiSelect.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryList.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryMultiSelect.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.userfield.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.document.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.image.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.searchList.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.association.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.upload.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.getUser.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryProcess.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.querySearchUser.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.comboSelected.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.usersForm.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.stakeholder.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.userPassword.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.gridActions.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.numberScientificNotation.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.actionLauncher.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.range.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.rangeDate.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.rangeMoney.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.rangeNumber.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.entityTemplate.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.checkList.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.activityCheckList.js","jquery/rendering/js/desktop/render/bizagi.rendering.desktop.polymorphicLauncher.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.combo.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.document.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.letter.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.search.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.date.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.text.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.searchList.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.number.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.numberScientificNotation.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.upload.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.radio.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.list.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.image.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.uploadecm.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.link.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.button.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.actions.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.exclusiveCheck.js","jquery/rendering/js/desktop/render/column/bizagi.rendering.desktop.columns.readonly.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.querySuggest.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryExtendedText.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryText.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryCheck.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.queryYesNo.js","jquery/rendering/js/desktop/render/query/bizagi.rendering.desktop.querySearch.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.queryForm.js","jquery/rendering/js/desktop/container/bizagi.rendering.desktop.formTemplate.js","jquery/rendering/js/desktop/bizagi.rendering.desktop.factory.js"],"names":["bizagi","rendering","container","extend","initializeData","params","this","_super","containsGrid","countByRenderType","resize","size","width","$","each","children","i","child","when","isRendered","done","startLoading","element","delay","overlay","endLoading","type","counter","length","getElementType","ELEMENT_TYPE_CONTAINER","properties","countByRenderTypeWithParams","param","height","configureLayoutView","getChildrenSumHeight","excludeElement","containerHeight","ELEMENT_TYPE_RENDER","renderHeight","getChildreCount","render","postRender","self","retype","processClassicRetype","hint","processRenderHint","helpText","showIcon","postRenderReadOnly","processLayout","isLabelFormat","format","getLabel","label","observableElement","processLabelLineBreak","$label","find","text","reg","lastIndex","exec","append","substring","getControl","control","jQuery","getControlFiller","controlFiller","setValidationMessage","message","util","isIE8","ready","iconError","iconHelp","isIE9","attr","tooltip","parent","removeClass","isNewRenderForm","hideIcon","addClass","input","span","prepend","focus","keypress","blur","val","click","getDisplayOptionClass","displayType","changeDisplayOption","el","getAlignClass","alignType","changeLabelAlign","changeValueAlign","getContainerIcons","icon","visibleIcon","$containerIcons","$errorIcon","$helpIcon","css","is","min-width","mouseover","e","preventDefault","stopPropagation","undefined","data","tooltipClass","items","content","hasClass","attributes","value","test","sanitizeHTML","title","_title","ui","dialog","prototype","_getMaxZindex","containerIcons","errorIcon","iconContainer","style","display","performDesignModeMethods","columns","column","applyOverrides","decorated","originalGetControl","getFormattingLabel","bold","result","surrogateKey","cell","cellIcon","editable","remove","applyColumnStyles","align","textFormat","background","Class","POPUP_WIDTH","POPUP_HEIGHT","init","dataService","renderFactory","dialogParams","doc","window","document","item","buttons","extraButtons","localization","getResource","dialogDeferred","Deferred","dialogBox","empty","appendTo","showDialogBox","resolve","fail","reject","idPageCache","form","getPageCache","renderDialogBox","promise","reverseButtons","orientation","defer","showSaveButton","parseBoolean","showCancelButton","saveButtonLabel","cancelButtonLabel","maximized","performActions","event","validateForm","forceCollectData","collectRenderValues","allowGetOriginalFormValues","formValues","onSave","currentTarget","prop","button","closeDialogBox","includes","addValidationMessage","messages","modalError","show","key","renders","getRenders","updateOriginalValue","addErrorMessage","asyncTabsDef","getAllTabs","getRenderByType","getAllTabsLength","innerTabsLoading","useOrSetLoaderDeferred","loadingDeferred","getLoaderPromise","response","deleteLoaderDeferred","onCancel","objButtons","nameButon","modal","resizable","open","isWebpart","close","resizeStop","maximize","triggerHandler","trigger","unmaximize","adjustOverlay","_appresize","args","left","screen","top","dispose","focusFirstControl","time","effect","defaultControl","not","controlHtml","closest","xpath","getRender","innerControl","isValidControlForFocus","removeAttr","setTimeout","id","isOnGrid","grid","getGridByColumn","getColumnType","def","contextType","rewriteContextType","getFormData","pipe","recordXPath","recordXpath","removeActions","required","removeTransitions","getContainer","canvas","selectedTabs","isRefresh","requestedForm","errorTemplate","getCommonTemplate","responseText","objMessage","JSON","parse","errorType","tmpl","html","customizeDialogBox","mainForm","override","adjustButtonPositionDialogForm","adjustButtonPosition","scrollTop","bind","_","refreshParams","getSelectedTabs","childrenContainer","availableHeight","ResizeSensor","fitSizes","clientHeight","transitions","actions","body","overlayHeight","parseInt","overlayBody","overlayCanvas","getStartForm","instance","recalculate","searchForms","searchParams","otherOptions","hasOwnProperty","unbindAutoSaveForm","renderSearchDialog","getSearchContainerData","_form","contexttype","tabContainer","firstChild","searchForm","index","loadSearchTab","tab","currentSearchForm","tabs","ev","dialogBoxDeferred","getSearchFormData","searchFormContainer","push","defaultButtons","searchTriggeredBy","performSearch","concat","reverse","popupWidth","popupHeight","detach","pageCacheToInvalidate","invalidatePageCache","addButtons","deferred","elements","searchFormToLoad","otherElements","isDefault","displayName","caption","searchFormData","pageCacheId","console","log","strMessage","divMessage","idSearchForm","url","idRender","search","xpathContext","dataType","sessionId","template","getTemplate","textarea","nicEditor","iconsPath","getLetterEditorIconsPath","fullPanel","panelInstance","templateParts","split","nicEditors","findEditor","setContent","newContent","getContent","replaceAll","join","desktop","postRenderContainer","getButtons","getMode","isEntityForm","useCustomButtons","configureBindAutoSave","deferredSave","autoSaveEvents","beforeUnloadFunction","newData","isEmptyObject","unbind","_data","buildProcessPath","scroll","hide","callback","autoSaveFunction","haveAutosaveAssociated","saveFormDelegate","proxy","idAutoSave","getIdentifierFormForAutosave","functionSaveFormDelegate","uniqueId","autoSaveIdentifier","autoSaveHandlers","saveBox","changes","getFormContainer","hasChanged","showSaveBox","saveForm","isOfflineForm","context","deferredsToWait","collectRenderValuesForSubmit","deferreds","apply","submitData","action","getChanges","mode","queryForm","getFormType","summaryForm","globalForm","displayAsReadOnly","processPath","fasttmpl","pathProcess","panel","contentPanel","configureDesignView","formDisplayName","active","activeTab","activate","visibleTab","getParams","resizeInPopUpHTML","beforeActivate","newTab","setActiveTab","forEach","tabItem","tabHeader$","position","at","heightActivitiFormContainer","renderForm","buttonContainer","idWorkitem","heightButtonContainer","tabReadyDeferred","tabActiveDeferred","resizeTimeout","setAsActiveContainer","argument","renderTabContent","loadOnDemand","replaceChildrenHtml","renderChildrenHtml","isDisposed","replaceChildrenTag","setInterval","clearInterval","changeVisibility","header","getActiveTab","visible","always","afterToRefresh","horizontal","iCount","j","innerChild","jCount","renderWidth","percent2Number","renderedElement","getRenderedElement","layout","accordion","autoHeight","accordionItem","ordinal","group","styleSufix","collapse","expanded","configureHandlers","toggleClass","toggle","isOpen","expand","toogleContainer","renderResult","skipInitialLoad","rowsPerPage","inlineAdd","allowDelete","allowAdd","hideActionsColumn","floatingHeader","sortBy","sortOrder","overrideGetRemoteData","getRemoteData","parseAdditionalProperties","columnVisible","allowDecimals","showTime","jqgrid","resultsGrid","searchCriteria","results","childrenElements","childElement","Number","childrenHash","postRenderElement","criteriaContainer","resultsContainer","refreshResults","refresh","dataReady","resizeResults","onSearchFinished","records","maxLength","setDisplayValue","isEmpty","attachRetypeDouble","retypeDouble","changeRequired","changeRequiredLabel","disabled","hasValue","triggerRenderValidate","changeCellRequired","currentValue","setValue","createTooltip","collectData","renderValues","getValue","String","fromCharCode","controlValueIsChanged","validateInputRetype","extendedText","actualMaxLength","autoExtend","minHeight","maxLines","overflow","changeHeightAutoExtended","decodedValue","decodeURI","validateValue","resolvedValue","br2nl","cleanData","clearDisplayValue","previousValue","newValue","removeProperty","scrollHeight","renderReadOnly","number","numericInput","executeFormatCurrencyPlugin","asNumber","symbol","positiveFormat","negativeFormat","decimalSymbol","digitGroupSymbol","groupDigits","date","i18n","dateFormat","getDateFormat","datePickerFormat","timePickerFormat","substr","indexOf","getElementsToStylize","getTimePickerFormat","timeFormat","c","token","returnObj","show24Hours","showSeconds","showZeroInHour","separator","lastToken","charAt","toUpperCase","ampmPrefix","timeControl","getTimeControl","dateControl","getDateControl","timeFormatProperties","maxUndefinedYear","Date","getFullYear","toString","minUndefinedYear","maxValue","minValue","dateFormatter","analyzeTimeFormat","timeEntry","spinnerTexts","useMouseWheel","dateIcon","getDateIcon","initYear","endYear","isNaN","datepicker","parseDate","setDefaults","options","firstDay","yearRange","changeYear","changeMonth","shortYearCutoff","BIZAGI_DEFAULT_DATETIME_INFO","twoDigitYearMaxDelta","beforeShow","changeMinValue","changeMaxValue","on","onClose","off","isIE","onSelect","change","match","getDisplayValue","getDateFromFormat","replace","formatInvariant","getDateFromInvariant","isNumeric","dateObj","INVARIANT_FORMAT","setHours","assert","internalSetInitialValueFlag","inputTimeValue","checkIcon","displayValue","formatDate","fullFormat","currPadding","removeValidations","clearValidationMessages","onChangeHandler","isNow","currentDate","currentDateString","currentTime","updatingTime","getHours","setMinutes","getMinutes","setSeconds","getSeconds","objDate","isValid","oldVal","oldValTime","validationController","command","controllers","validation","validations","showValidationMessage","collectDataQueryForm","queryValue","included","searchType","typeSearch","rangeQuery","orderType","yesno","removeData","optiongroup","evt","parsedValue","check","$control","performStyles","showLetters","randomId","randomNumber","changeFontSize","combo","inputCombo","selectedValue","select","isExtraItem","resizeCombo","idDropdown","comboDropDown","dropDownDestroy","addEventListener","keyup","keyUpFunction","keydown","keyDownFunction","showLoadingData","getData","hideLoadingData","internalComboDropDown","loading","outerWidth","padding","margin","my","of","collision","selectTmp","objSelected","containerDropdown","containerControl","parents","last","containerRender","findDataByValue","scrollPosition","navigator","userAgent","appVersion","contFormScroll","repositionInterval","datasource","dropDwn","objParent","widthChild","widthControl","recalculateComboOffset","delegate","onComboItemSelected","makeArray","one","tg","target","dropDownValidClose","dropDown","dropDownReposition","containerForm","validateValueInDatasource","triggerEvents","isKeyByKey","selected","selectedKey","altKey","ctrlKey","metaKey","shiftKey","keyCode","focusDependant","selectPreviousElement","selectNextElement","selectFirstElement","selectLastElement","enableTyping","typingForCombos","isSelectingItem","selectItemByKeyUp","actual","previous","prev","next","selectedId","selectedLabel","originalValue","comboValue","mapValue","isString","findDataById","translated","hasLocalData","remoteDataLoaded","isArray","emptySelection","escapeValue","formatItem","emptyLabelForCombo","getSelectedValue","keyByKey","equalsToValue","tvalue","nValue","compareValIn","compareVal","dataLength","trim","toLowerCase","getValueFromData","dataValue","getInternetExplorerVersion","offset","selectMenu","get","originalRefreshPositionMethod","selectmenu","_refreshPosition","list","arguments","newelement","cascadingCombo","BA_ACTION_PARAMETER_PREFIX","services","service","BA_CONTEXT_PARAMETER_PREFIX","valueFormat","itemSelected","postRenderPrintVersion","changeRequiredControl","parentCombo","isDependant","renderControl","getParentCombo","initializingCascadingCombo","bindDependantCombo","dependantCombo","dependants","onChangeFunction","isInitialValue","refreshDependantCombo","cleanInput","isEventBinded","canBeSentQueryForm","collectionnavigator","navigationControls","getCanvas","hasData","showRow","getFirstRow","refreshControls","isValidRow","saveChanges","checkSave","getNextRow","getPreviousRow","getLastRow","removeRow","addInlineRow","updateRow","addRow","editRow","showDetailForm","inlineEdit","isTherePendingInlineRow","getRow","cancelChanges","configureButtonsForm","refreshForwardButtons","refreshBackButtons","refreshPagination","refreshTotal","refreshRemoveAction","nextControl","getInnerControl","lastControl","keys","pointer","previousControl","firstControl","removeButton","getTotalRows","refreshActions","eSave","eCancel","save","cancel","section","setFocus","navigationPage","getParameters","loadForm","detailLabel","editPage","showInlineRow","isValidKey","setPointer","isLoaderDeferredSet","appendWaitForLoader","formContainer","rendersById","bindRenderChangeEvent","l","changed","temp","triggerRenderChange","performValidations","isSaveEnabled","checkSaveEnabled","arrayCollectionNavigator","getChildCollectionNavigator","saveChangesChildren","submitSaveRequest","removeInlineAddRecord","fetchData","failHandler","inlineAddRecords","removeKey","pop","submitRollbackRequest","removeNavigationForm","drawPreview","submitAddRequest","newid","addKey","addLabel","addPage","error","submitInvalidatePageCacheRequest","submitEditRequest","editLabel","showConfirmationBox","submitDeleteRequest","addNavigationForm","processButton","buttonProperties","valid","originalProcessButton","processFailMessage","validate","disposed","getKeys","rows","totalRows","drawControls","controls","collectionControls","drawForms","drawControl","drawActions","outerHTML","total","withAddForm","withEditForm","allowDetail","forms","getActionsTemplate","saveDeferred","actionClass","buttonClass","BA_PAGE_CACHE","ecm","listControl","fileProperties","maxSize","BIZAGI_SETTINGS","UploadMaxFileSize","maxFiles","maxfiles","validExtensions","singleExtensions","addUrl","getUploadAddUrl","deleteUrl","q_xpath","encodeXpath","getUploadXpath","files","filesCount","showRenderOptions","renderUploadItem","checkMaxFiles","preventDefaultForAnchorTag","buildAddParams","networkSpeed","bizagiUpload","renderReference","dialogTemplate","uploadedFiles","isECM","onUploadFileCompletedCallback","onUploadFileCompleted","dialogTitle","configureUploadHandlers","reference","extraData","buildUpgradeParams","isUpdatingECM","onUpdateUploadFileCompleted","waiting","renderFileLayout","idFileUpload","fileName","status","getFileExtension","isImage","allowSendInMail","controlContent","insertAfter","uploadId","getXpathContext","xPath","idAttrib","bindEmailDialog","showMessageBox","bizagiSendEmail","fileControl","metadataTemplate","imageConfig","zIndex","getMaxZindex","originalData","metadataParams","metadataECMMultiaction","getFileProperties","getECMMetadata","metaData","Array","filename","buildItemUrl","ecm_ecmStatus","ecmStatus","ecm_isVisible","isVisible","ecm_allowUpdateMetadata","allowUpdateMetadata","ecm_allowDelete","ecm_allowUpdateContent","allowUpdateContent","ecm_allowView","allowView","ecm_allowCheckOut","allowCheckOut","ecm_allowCancelCheckOut","allowCancelCheckOut","ecm_allowEdit","allowEdit","idFileUploads","image","src","imageZoom","dataItem","showMetadata","hover","setControlEvents","debug","multiClickControl","modalEcm","displayOptionsContent","configureToggleHandlers","isAsync","asynCheckEnabled","asyncCheckTimeout","IsFileOnECM","isFileOnECM","idUpload","toggleOptions","globalControl","first","clone","prepare","deleteECMFile","splice","cancelCheckOut","checkOutFile","makeStringMetaDataControler","valueMatch","makeDatetimeMetaDataControler","numericFormat","RegExp","lastChar","makeBooleanMetaDataControler","ecmMetaDataFieldEdit","metadatavalue","metadatapostvalue","spanMetaDataValue","replaceWith","validateData","checkData","isValidFields","metadata","editButtons","field","actualValue","idMetadata","metaValues","encode","metadataValues","updateECMMetadata","inputMetaDataValue","validationFunction","inputValue","dateText","inst","makeDecimalMetaDataControler","checked","Math","ceil","random","rnd","file","extension","inArray","idSession","folder","BIZAGI_PATH_TO_BASE","scriptData","editUrl","uploadWrapper","controlList","invalidElements","bValid","isNewRow","isFromCreatedRow","isValidBase","$arrayEcmControls","errorMessage","arrayItems","deleteUploadItem","ctrl","metadataContext","currentField","showActionColumn","singleInstance","cellMetadata","pendingActions","collapseState","labelAlign","editableGrid","columnActions","printversion","columnActionParams","xpath-column","submitOnChange","totalize","hasTotalizer","columnwidth","headerStyles","cssclass","spliceRowData","spliceRowDataVisible","spliceRowDataEditable","hasActions","getGridTemplate","buildColumnModel","cleanNewRecords","applyGridPlugin","page","sortType","updateData","initialLoadDone","method","buttonsComponent","applyColumnsWidth","changeFontBold","pager","scrollableArea","scrollParent","bizagi_grid_desktop","showSummary","tableCssClass","buttonsPst","smartPagination","gridDefaultSortBy","getHeaderStyles","gridRtl","table","emptyTable","specialColumn","row","rowButtons","rowButtonsRtl","specialCell","buttonsRtl","dynamicPager","summary","summaryCell","exportOptions","add","edit","details","allowMore","enableXlsExport","enablePdfExport","tooltips","deleteLabel","exportOptionsLabel","errorsMessage","pageRequested","Object","sortRequestedPage","sortRequested","sortName","getColumn","getSortName","drawCell","cellReady","onCellReady","rowSelected","deleteRow","moreRows","saveAddedRows","saveInlineAddedRows","saveRows","beforeInlineAdd","inlineAddDeferred","afterInlineAdd","canBeExported","showFormDetails","cancelEdition","removeNewRecords","showGridExportOptions","performExportGrid","printParams","performCollapseGrid","rowdblclick","canEditRow","businessKey","triggerGridPluginHandler","slice","call","columnModel","name","hidden","columnIndex","columnLabel","gridColumn","summarizeBy","operation","bizAgiProperties","dataReadyDeferred","loadChanges","idRow","assignValue","columnData","columnNumber","setCellOverrides","applyColumnsWidthUpdate","sort","then","isRTL","removeRemainingColumns","changeOrderData","color","isReadyToSave","newKeys","alreadySaved","errDef","cellOverride","getCellOverride","renderColumn","newRecords","originalProperties","drawEditableCell","drawReadonlyCell","originalEditable","overrideProperties","cellOverrides","getDecorated","onCellChange","originalFormat","renderSummary","_value","compositeValue","getCompositeValue","isNewRecord","isSubmitOnChange","advancedSearch","collectGridChange","startActionExecution","endActionExecution","isExclusiveControl","isExclusive","max-width","submitOnChangexpathContext","submitOnChangexpathContextRow","postRenderSummary","applySummaryColumnStyles","addFormDialog","maximizeGridPopup","disableServerGridValidations","submitForGridChange","executeSubmitEditRequest","headerFormat","italic","underline","strikethru","editInlineRow","changeRowEditable","changeCellBackgroundColor","getControlCell","changeCellColor","changeCellVisibility","changeCellEditability","changeEditabilityCellControl","changeEditability","cleanCellData","rowLength","changeCellValue","changeCellMaxValue","changeCellMinValue","rowDeleted","calculateFetchData","originalrowsPerPage","dataToSend","moreRowsCommon","workportal-widget-dialog-box-print","printFormCommand","workportal","printform","print","hasRefresh","queue","prepareAddAction","multiaction","addGridRecordData","exportPst","expMenuDirection","outerHeight","$gridWrapper","$collapseIcon","updateCollapseState","$header","dataUrl","getCollapseData","filePrintUrl","getGridExportUrl","exportType","isAcrobatInstalled","checkAdobePlugin","browser","msie","downloadExportedGrid","updateAffectedCellManually","rowIndex","getRowIndexByKey","installed","ActiveXObject","formatGrid","tableControl","closeButton","parentPromise","inlineAddPromise","columnWidth","widthToApply","resizableColumns","elementChild","textDecorator","operator","changeColor","setProperty","$tableContext","enableColorHeaderGrid","hasColorHeader","convertProperties","bizagi_grid_grouped_desktop","groupByColumns","headerRow","emptyCell","groupBy","ADVANCED_SEARCH_ID","ADVANCED_ADDITION_ID","CLEAR_SEARCH_ID","NO_RESULTS_SEARCH_ID","SEARCH_DELAY","SEARCH_MAX_RECORDS","searchImage","getSearchDefaultImage","searchInput","applyAutocompletePlugin","selection","oSel","createRange","moveStart","moveEnd","msgObj","hideAutocompleteLoading","autocomplete","showSearchDialog","allowClear","alignForSuggest","rtlClassForSuggest","autoFocus","noResults","source","req","activeRequestTerm","term","now","getTime","parseRequest","encodeURIComponent","expireKey","requestKey","expire","getItemLocalStorage","enableLocalStorage","processRequest","suggestMenu","menu","suggestContainer","controlContainer","itemWidth","calculateSuggestionWidth","_renderItem","ul","renderClearItem","renderAdvancedItem","renderAddItem","renderSearchItem","searchItem","readyActionExecution","suggestions","addToSuggestions","allSuggestions","request","expireTime","expireCache","setItemLocalStorage","allowSuggest","searchLength","showAutocompleteLoading","deferredReference","state","hideStatus","maxRecords","parseValue","highlightMatches","getValueId","getValueLabel","additionallabel","showAddRecordDialog","guidEntity","entity","formData","isMapEmpty","mapping","searchDialog","found","obj","setDisplayValueToControl","allowFullSearch","jqXHR","renderControlSearchForm","addForm","allowNew","refreshControl","currentId","letter","showLetterDialog","configureHandlersReadOnly","getLetterNotEditableUrl","getXpath","getContextXpath","getCanGenerateLetter","wasGenerated","canGenerate","getLetterContent","saveLetterContent","base","buttonInput","validateGridsOnButtonClick","hasValidGrids","needsUserConfirmation","htmlMessage","userConfirmationMessage","draggable","pressed","runButtonAction","fileprint","typeForm","getAbsoluteFilePrintUrl","fileType","getFilePrintUrl","ajax","pathToBase","bizagiConfig","proxyPrefix","getXSRFToken","fileObject","isIE10","isIE11","mozilla","idFrame","iframe","frm","getElementById","contentWindow","mycounter","all","readyState","wnd","onload","link","attachEvents","linkSolver","linkPrefix","linkType","windowParams","printf","windowObjReference","linktarget","$context","layoutRender","layoutPlaceholder","layoutBoolean","layoutImage","getImageUri","processData","success","blob","contentType","getResponseHeader","byteArrayToBlob","stringToByteArray","imageUrl","URL","webkitURL","createObjectURL","renderParams","paramsRender","map","guid","hash","idcase","idCase","idworkitem","contextxpath","xpathActions","serviceLocator","getUrl","replaceMultiple","layoutLink","onClickElement","referenceType","contextEvent","getContextEvent","triggerGlobalHandler","layoutLabel","layoutText","layoutDateTime","layoutNumber","layoutMoney","layoutUpload","getValueFilesByData","valueResult","getHTMLFiles","noFiles","replaceFilesHtml","getUploadFileEntityUrl","isContextContainerWidgetRender","fileId","surrogatekey","guidentity","formLink","openLinkRule","property","elLink","getPropertyValue","dataRuleResp","showErrorMessage","openLink","propertyName","getPropertyData","extra","textStatus","errorThrown","defClose","getFormLinkXpath","saveLinkForm","saveUrl","getDisplayAsReadOnlyValue","closeExitRule","hasexitrule","canBeSaved","executeSubmitOnChange","submitCommitRequest","submitDataRequest","hasentryrule","refreshForm","renderFormLinkDialog","getFormLinkXpathContext","parentXpathContext","submitCheckpointRequest","geolocation","cordinate","isExecutionMode","msg","performPrecision","getCurrentPosition","coordinate","coords","latitude","longitude","money","attachFormatCurrency","showSymbol","currentUser","radio","unique","radiogroup","onOptionGroupChange","defaultValue","createRenderElement","createContainerElement","createFormElement","selectable2","multiple","isPropagationStopped","focusSelectedItem","listSize","elList","multiSelect","MORE_OPTION_WIDTH","renderElement","addSelectedElements","onToggleDataView","onUnselectElement","onShowSelectedElements","values","getDataValue","totalValues","$tagsContainer","$ChildToAdd","processControlLayout","canAddMoreItems","$viewMore","renderFloatView","updateArrow","isChecked","markAsChecked","$floatList","showFloatListView","floatListHandlers","$containerControl","$containerRender","destroyFloatView","$list","closeFloatView","$listView","floatViewIsCollapsed","idToRemove","removeElement","valuesToShow","$tagElements","$floatListContext","$listContainer","checkbox","filterList","findItemById","addElement","userfieldWrapper","getUserfieldControl","sControl","userfieldName","exists","eval","createUserfieldInstance","getUserfieldDefinition","userfield","userfieldGuid","device","loadUserfield","dynamicFunction","initialParams","getUserFieldInstance","isUserField","userfieldInstance","replicateUserfieldMethods","styleGuid","str","ex","loadStyle","defaultUserField","designUserField","userfieldDefinition","basicUserField","showDialog","formDialog","load","callInside","BACloseWindow","submitForm","showPopup","getEditableControl","controlName","getReadonlyControl","applyDocumentTemplatesFormat","documentList","previewTooltip","resources","returnType","returnCssTypeFile","updateControlForPrintMode","showDocumentPreview","tem","N","ua","M","sayswho","appName","count","printFn","pdf","redrawDocuments","documents","downloadalldocuments","autoOpenDocuments","autoOpen","joinedDocument","lastIndexOf","imgWidth","imgHeight","flashVersion","cssExtended","containerChildsSize","containerChildsHeightSum","baseImageURL","resizableImgNode","background-image","border-top-width","border-left-width","border-right-width","border-down-width","isImageGreaterThanContainer","controlWidth","isAuto","isAutoWidth","wSize","isPostRendered","deleteHandler","deleteImage","border","line-height","getTemplateItem","openUploadDialog","checkMaxSize","checkFileTypes","processUploadFile","closeUploadDialog","imageWrapper","isImageLoaded","widthBase","htmlImage","columnAlign","isUserPreference","BIZAGI_SESSION_NAME","showError","stringEndsWithValidExtension","stringToCheck","acceptableExtensionsArray","endsWith","errorContainer","uploadForm","uploadIFrame","timeoutFn","submit","searchList","SEARCH_MIN_LENGTH","padding-right","attachKeyEvents","keyUnicode","charCode","selectionStart","removeLastElement","selectedValues","isNewItem","appendFoundItem","minLength","deleteItem","newElement","before","li","stringValue","templateWithValues","association","closeElement","togglepanels","animated","allowFlip","flipped","flipstate","getFlipAssociation","getColumnData","getRightAssociation","internalPostRender","idLeft","idRight","mask","setBindToClose","ol","classCss","makeJsonBase","getLeftName","upload","haveFiles","isClicked","bindExternalPopup","isInGrid","getCaseNumber","caseNumber","currentPopup","widgetName","widgets","widget","BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME","widgetURL","injectCss","modalParameters","afterLoad","labels","getElementsByTagName","innerText","parentElement","previousSibling","textContent","afterLoadParams","pluginUpload","onChangeFile","onCheckMaxSize","onValidate","maxAllowedFiles","maxFilesLimit","alert","uploadField","enabled","previousCheck","getDefaultValueAlign","errorList","toFind","newItem","insertBefore","changeFontItalic","$element","documentMode","getUser","bindSearchUserPlugin","clearValue","filters","displayNames","searchButtonName","clearButtonName","valuesToSelect","selectItem","onItemSelectedSuccess","searchUsers","filterData","allowDelegatedUser","getUsersListFromPreferences","getUsersListForStakeholders","getTableTemplate","usersResults","currentPage","pagination","pagesArray","users","links","editingUser","idUser","opt","allowAddUser","menuSecurity","UserAdmin","bizagiSearchUser","getOptions","iduser","user","queryProcess","getElement","wrapper","getWrapper","loadData","renderData","wrapperElement","linkApplication","process","itemElement","idParent","idContCategory","setupLinks","idCategory","elementRender","processSelect","parentType","routeProcess","getAttribute","iconProcess","querySearchUser","getUsersList","username","comboSelected","showInitialData","selectedItemsToUpdate","orderArrayList","orderList","a","b","nA","nB","addItem","filterFunction","rightValues","removeItem","leftValues","filter","selectInput","binaryInsert","binarySearch","array","middle","current","right","dataSelected","dataResults","grep","dataSelectedToRemove","dataOptions","showListBoxComboData","htmlControl","stringify","checkRequired","collectedValues","waitingTemplate","waitingOverlay","waitingMessage","$canvas","processButtons","formAction","sendMail","sendMailControl","passwordControl","password","getConfiguration","redirectErrorPage","location","href","passwordMinLength","passwordMaxLength","generateRandomPassword","processSave","userFormData","createUser","updateUser","expandNotificationBox","maxLenth","getLengthPassword","chars","randomPassword","randomPosition","floor","saveValue","collectedData","expiredAccountControl","lockedAccountControl","domain","expiredAccount","lockedAccount","fullName","userName","userId","idEntity","stakeholder","bizagiControl","maxElemShow","maxPageToShow","selectedItems","valueXpath","addInstance","addGrid","goToBack","removeAssociated","onKeyUpFilter","paramField","gridDataService","onGetData","onGetDataFail","tempGrid","dataColumns","tempColumns","iColumn","objectColumn","idData","idInstance","nameInstance","newDataRows","iRow","stateInstance","tooltipLink","rowTemplate","gridTmp","tooltipUnassociated","tempPagination","totalRecords","totalPages","pageToshow","pagerData","pages","pageNumber","paginationHtml","$pager","bizagiPagination","actualPage","listElement","clickCallBack","setRowsEvents","onLinkClick","executeLinkClickIfProceed","associatedUser","refreshStakeholderValue","onStakeAssociatedFail","confirmationMsg","refreshStakeholderList","userPassword","C","CryptoJS","userFormsSpanner","enc","Utf8","userFormsCode","Latin1","resultMain","algo","AES","createEncryptor","CBC","pad","Pkcs7","iv","finalize","resultMainFinal","Base64","spanTmp","numberScientificNotation","attachFormatScientificNotation","scientificNotationFormat","scientificNotationNumber","actionLauncher","surrogatedKey","appendContent","templateArguments","actionsContainer","configureQueueVisibility","getActions","processPropertyValueArgs","getPropertiesActionLaucher","templatetype","processPropertyValueDataTmplArgs","templateData","deferredActions","totalActions","moreActionsManager","isMoreActions","lessActions","isHorizontal","engine","isDefaultTemplate","moreActions","allowactions","actionsVertical","allowSearch","isExpanded","moreButtonTitle","subscribe","loader","start","BIZAGI_WORKPORTAL_WIDGET_DIALOGNAV","refreshInbox","maximizeOnly","maxItems","moreActionsTemp","actionLauncherControls","moreVerticalButton","configureMoreActionsHandler","guidProcess","guidAction","actionType","readOnlyForm","isReadOnlyForm","onActionClicked","expr","FilterAction","resultReadOnly","moreButton","startAndThen","kendoTooltip","autoHide","multipleSelection","countSameActions","actionManager","act","executeAction","showConfirmationDialog","notifyExecution","notifications","INotifications","showSucessMessage","processActionForm","additionalXpaths","additionalXpath","isActionStartForm","savedData","editMode","idStartScope","IdScope","idForm","caseId","processActionFormCollection","xpathContextWithKey","xpathContextWithoutKey","IdEntity","addActionToQueue","processStartForm","startForm","guidprocess","mappingstakeholders","executeActionImmediately","confirmTemplate","confirmContent","confirmationMessage","confirmContentParams","actionsToExecuteContainer","listOfActions","removeActionSelector","openActionSelector","removeActionToQueue","extraParameters","dataAction","actionsToExecuteTitle","range","rangeDate","defineRangeControl","rangeMoney","rangeNumber","templateGuid","guidTemplate","htmlTemplate","entityTemplateControls","checkList","checkListGroup","itemId","updateDisplay","onCheckListGroupChange","addButton","newItemName","goalActivity","additionalElements","notifyLoadItems","activityWork","$divContainer","activityDescription","prepareNewItem","repaintControl","itemSelectedName","itemContent","setSelectionRange","addSelectedHandlers","refreshValue","resolved","which","checkListHtml","completed","allCheckedItems","every","idActivity","validationResolvedItems","lastActionButton","getLastActionButton","polymorphicLauncher","getPolymorphicActions","serializePolymorphicActions","treeActionsList","getTreeItems","readOnly","level","templateTreeItem","$targetData","guidObject","guidConstructor","$node","path","cachedValue","pageCache","$target","tableCell","getControlHtml","getDocumentXpath","documentTemplateGenerate","preRenderControl","deleteDocumentTemplate","xpathcontext","buttonExecuted","generateDocumentTemplate","allowGenerate","isInlineRow","noActivateButton","allowgenerate","xpathPath","deleteUploadFile","setSurrogateKey","refreshCell","calculateValue","resolveValue","indexes","getIndexes","resetData","defaultvalue","setDefaultValue","originalMethod","applyUploadPlugin","undelegate","getUploadFileUrl","readyDeferred","originalApplyUploadPlugin","originalRenderControl","originalInternalPostRender","columnXpath","nameFile","caller","calculateInitialLayoutProperties","configureHandlersActions","renderDraftControl","viewMore","events","fn","overflowMenu","exclusiveChanges","originalEnabledChecks","overrideDecoratedRenderProperties","clearOtherRows","simpleXpathArray","simpleXpath","enabledChecks","readonly","getContextType","h_contexttype","getSearchData","checkIncludedAll","collectRenderValuesQueryForm","parameters","getSearchParams","checkedChildren","includedInResult","formTemplate","factory","printVersion","loadTemplates","loadTemplate","tmplIcons","loadOverrides","enableCustomizations","loadFile","getJavaScript","containerParams","usersForm","nestedForm","mobileform","mobilegroup","mobiletext","isExtended","grouped","enableQuerySuggestBehavior","entityTemplate","getLayoutRender","getSearchRender","getQueryRender","getRangeRender","activityCheckList","columnParams","exclusiveCheck","uploadecm","gridActions","queryExtendedText","queryText","queryCheck","queryYesNo","queryNumber","queryMoney","queryDate","queryCombo","queryCascadingCombo","querySuggest","queryLabel","queryList","queryMultiSelect","querySearch","queryRadio","queryState","queryCaseState"],"mappings":"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","sourcesContent":["/*\r\n*   Name: Bizagi Desktop Container Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the container class to adjust to desktop devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.container.extend(\"bizagi.rendering.desktop.container\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    initializeData: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Checks if the container contains grids\r\n        this.containsGrid = this.countByRenderType(\"grid\") != 0;\r\n    },\r\n\r\n    /* \r\n    *   Resizes the container to adjust it to the container\r\n    */\r\n    resize: function (size) {\r\n        var self = this;\r\n        var container = self.container;\r\n        var width = container.width();\r\n\r\n        // Don't resize thin or invisible containers\r\n        if (width < 300) return;\r\n\r\n        // Don't resize if there are no grid renders\r\n        if (this.containsGrid == false) return;\r\n\r\n        $.each(self.children, function (i, child) {\r\n            $.when(child.isRendered())\r\n            .done(function () {\r\n                child.resize({ width: width });\r\n            });\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Starts waiting signal for async stuff\r\n    */\r\n    startLoading: function () {\r\n        var self = this;\r\n        var element = self.container;\r\n        if (element) {\r\n            element.startLoading({ delay: 250, overlay: true });\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Ends waiting for async stuff\r\n    */\r\n    endLoading: function () {\r\n        var self = this;\r\n\r\n        var element = self.container;\r\n        if (element) {\r\n            element.endLoading();\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Counts how many renders belong to the container with some render type\r\n    */\r\n    countByRenderType: function (type) {\r\n        var self = this;\r\n        var counter = 0;\r\n        for (var i = 0; i < self.children.length; i++) {\r\n            var child = self.children[i];\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                counter += child.countByRenderType(type);\r\n            }\r\n\r\n            if (child.properties.type == type) counter++;\r\n        }\r\n\r\n        return counter;\r\n    },\r\n\r\n    /*\r\n    *   Counts how many renders belong to the container with some render type excluding by param\r\n    */\r\n    countByRenderTypeWithParams: function (type, param) {\r\n        var self = this;\r\n        var counter = 0;\r\n        for (var i = 0; i < self.children.length; i++) {\r\n            var child = self.children[i];\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                counter += child.countByRenderType(type);\r\n            }\r\n\r\n            if (child.properties.type == type && param == child.properties.height) counter++;\r\n        }\r\n\r\n        return counter;\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the container's behaviour to show layout\r\n    */\r\n    configureLayoutView: function () {\r\n        var self = this;\r\n        var container = self.container;\r\n    },\r\n\r\n    /*\r\n    * Return the sumatory of the height of all children\r\n    */\r\n    getChildrenSumHeight: function (excludeElement) {\r\n        var self = this;\r\n        var counter = 0;\r\n        for (var i = 0; i < self.children.length; i++) {\r\n            var child = self.children[i];\r\n            if (excludeElement && excludeElement == child.properties.type && child.properties.height == -1) {\r\n                // do nothing (exclude the element)\r\n            } else {\r\n                if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                    var containerHeight = $(child.container).height();\r\n                    counter += containerHeight != null ? containerHeight : 0;\r\n                } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                    var renderHeight = $(child.element).height();\r\n                    counter += renderHeight != null ? renderHeight : 0;\r\n                }\r\n            }\r\n        }\r\n\r\n        return counter;\r\n    },\r\n\r\n    /*\r\n    * Return the count of children\r\n    */\r\n    getChildreCount: function () {\r\n        var self = this;\r\n\r\n        return self.children.length;\r\n    }\r\n  \r\n\r\n});\r\n","/*\r\n*   Name: Bizagi Desktop Render Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the render class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from render base\r\nbizagi.rendering.render.extend(\"bizagi.rendering.desktop.render\", {}, {\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        this._super();\r\n\r\n        // Add classic retype validation\r\n        if (properties.retype == \"double\") {\r\n            self.processClassicRetype();\r\n        }\r\n\r\n        // Add hint feature\r\n        if (properties.hint) {\r\n            self.processRenderHint();\r\n        }\r\n\r\n        // Hide icons if no helptext is provided\r\n        if (properties.helpText && properties.helpText.length > 0) {\r\n            self.showIcon(\"help\");\r\n        }\r\n    },\r\n\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (properties.helpText && properties.helpText.length > 0) {\r\n            self.showIcon(\"help\");\r\n        }\r\n    },\r\n\r\n    // #region Process Layout\r\n    /*\r\n    *   Method to process the render the layout\r\n    */\r\n    processLayout: function (isLabelFormat, format) {\r\n        this._super(isLabelFormat, format);\r\n    },\r\n\r\n    // #endregion\r\n\r\n    /*\r\n    *   Starts waiting signal for async stuff\r\n    */\r\n    startLoading: function () {\r\n        var self = this;\r\n        var element = self.element;\r\n        if (element) {\r\n            element.startLoading({ delay: 250, overlay: true });\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Ends waiting for async stuff\r\n    */\r\n    endLoading: function () {\r\n        var self = this;\r\n\r\n        var element = self.element;\r\n        if (element) {\r\n            element.endLoading();\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Template method to get the label element\r\n    */\r\n    getLabel: function () {\r\n        var self = this;\r\n        if (!self.label) {\r\n            self.label = $(\".ui-bizagi-label\", self.element || self.observableElement);\r\n        }\r\n        self.processLabelLineBreak(self.label);\r\n        return self.label;\r\n    },\r\n\r\n    processLabelLineBreak: function ($label) {\r\n        var label = $label.find(\"label\");\r\n        var text = label.text();\r\n        var reg = /\\\\n/g;\r\n        var array, result = \"\", lastIndex = 0;\r\n        while ((array = reg.exec(text)) !== null) {\r\n            if (lastIndex === 0) {\r\n                label.text(\"\");\r\n            }\r\n            label.append(text.substring(lastIndex, reg.lastIndex - 2));\r\n            label.append($(\"<br/>\"));\r\n            lastIndex = reg.lastIndex;\r\n        }\r\n        if (lastIndex !== 0) {\r\n            label.append(text.substring(lastIndex));\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Template method to get the control element\r\n    */\r\n    getControl: function () {\r\n        var self = this;\r\n        if (!self.control || (self.control instanceof jQuery && self.control.length === 0)) {\r\n            self.control = $(\".ui-bizagi-render-control\", self.element || self.observableElement);\r\n        }\r\n        if (!self.control || self.control.length == 0) {\r\n            return null;\r\n        }\r\n        return self.control;\r\n    },\r\n\r\n    /*\r\n    *   Template method to get the control filler element\r\n    */\r\n    getControlFiller: function () {\r\n        var self = this;\r\n        if (!self.controlFiller) self.controlFiller = $(\".ui-bizagi-control\", self.element || self.observableElement);\r\n        return self.controlFiller;\r\n    },\r\n\r\n    /* \r\n    *   Adds a validation message to the render\r\n    */\r\n    setValidationMessage: function (message) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(message);\r\n\r\n        // DiegoP: Please don't remove this line again, this is intended to avoid performance problems in IE8\r\n        if (!bizagi.util.isIE8()) {\r\n\r\n            // Wait until element is ready\r\n            $.when(self.ready())\r\n    \t\t.done(function () {\r\n    \t\t    var element = self.element;\r\n\r\n    \t\t    // Set tooltip\r\n    \t\t    var iconError = $(\".ui-bizagi-render-icon-error\", element);\r\n    \t\t    var iconHelp = $(\".ui-bizagi-render-icon-help\", element);\r\n\r\n    \t\t    if (message && message.length > 0) {\r\n    \t\t        self.showIcon(\"error\");\r\n    \t\t        if (bizagi.util.isIE9()) {\r\n    \t\t            iconError.attr(\"data-title\", message);\r\n    \t\t        } else {\r\n    \t\t            iconError.attr(\"title\", message);\r\n    \t\t        }\r\n\r\n    \t\t        iconError.tooltip();\r\n    \t\t        $(iconError).parent().removeClass('ui-hidden');\r\n\r\n    \t\t        if(self.isNewRenderForm)\r\n    \t\t            $(iconError).parent().removeClass('bz-forms-icons__hidden');\r\n\r\n    \t\t    } else {\r\n    \t\t        self.hideIcon(\"error\");\r\n    \t\t        if ($(iconHelp).text() == \"\") {\r\n    \t\t            $(iconError).parent().addClass('ui-hidden');\r\n\r\n                        if(self.isNewRenderForm)\r\n    \t\t                $(iconError).parent().addClass('bz-forms-icons__hidden');\r\n    \t\t        }\r\n    \t\t    }\r\n    \t\t});\r\n        }\r\n    },\r\n\r\n    /* \r\n    *   Attach handlers to implement the classic retype option\r\n    */\r\n    processClassicRetype: function () { },\r\n\r\n    /* \r\n    *   Attach effects to implement render hint\r\n    */\r\n    processRenderHint: function () {\r\n        var self = this,\r\n            element = self.element,\r\n            properties = self.properties;\r\n\r\n        var input = $(\"input[type!=hidden], select\", element);\r\n        if (!input) return;\r\n\r\n        var span = input.parent();\r\n        if (!span) return;\r\n\r\n        // Add hint label\r\n        span.prepend('<label class=\"ui-bizagi-render-hint\">' + properties.hint + '</label>');\r\n        var hint = $(\".ui-bizagi-render-hint\", element);\r\n\r\n        // Bind events\r\n        input.focus(function () {\r\n            hint.addClass(\"focus\");\r\n        });\r\n        input.keypress(function () {\r\n            hint.addClass(\"has-text\").removeClass(\"focus\");\r\n        });\r\n        input.blur(function () {\r\n            if ($(this).val() == \"\") {\r\n                hint.removeClass(\"has-text\").removeClass(\"focus\");\r\n            }\r\n        });\r\n        hint.click(function () {\r\n            input.focus();\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Return the right display option class\r\n    */\r\n    getDisplayOptionClass: function (displayType) {\r\n        // Set display type\r\n        if (displayType == \"normal\" ||\r\n            displayType == \"both\") {\r\n            return \"ui-bizagi-render-display-normal\";\r\n\r\n        } else if (displayType == \"vertical\") {\r\n            return \"ui-bizagi-render-display-vertical\";\r\n\r\n        } else if (displayType == \"reversed\") {\r\n            return \"ui-bizagi-render-display-reversed\";\r\n\r\n        } else if (displayType == \"verticalReversed\") {\r\n            return \"ui-bizagi-render-display-vertical-reversed\";\r\n\r\n        } else if (displayType == \"label\") {\r\n            return \"ui-bizagi-render-display-label\";\r\n\r\n        } else if (displayType == \"value\") {\r\n            return \"ui-bizagi-render-display-value\";\r\n        }\r\n        return \"\";\r\n    },\r\n\r\n    /*\r\n    *   Customizes render display type with custom css classes\r\n    */\r\n    changeDisplayOption: function (displayType) {\r\n        var self = this,\r\n        el = self.element;\r\n\r\n        // Call base\r\n        self._super(displayType);\r\n\r\n        // Clean old display type\r\n        el.removeClass(\"ui-bizagi-render-display-normal ui-bizagi-render-display-vertical ui-bizagi-render-display-reversed\")\r\n          .removeClass(\"ui-bizagi-render-display-vertical-reversed ui-bizagi-render-display-label ui-bizagi-render-display-value\");\r\n\r\n        // Set display type\r\n        el.addClass(self.getDisplayOptionClass(displayType));\r\n    },\r\n\r\n    /*\r\n    *   Return the right align class\r\n    */\r\n    getAlignClass: function (alignType) {\r\n        // Set label align\r\n        if (alignType == \"left\") {\r\n            return \"ui-bizagi-render-align-left\";\r\n\r\n        } else if (alignType == \"center\") {\r\n            return \"ui-bizagi-render-align-center\";\r\n\r\n        } else if (alignType == \"right\") {\r\n            return \"ui-bizagi-render-align-right\";\r\n        } else if (alignType == \"justify\") {\r\n            return \"ui-bizagi-render-align-justify\";\r\n        }\r\n        return \"\";\r\n    },\r\n\r\n    /*\r\n    *   Customizes render label align\r\n    */\r\n    changeLabelAlign: function (alignType) {\r\n        var self = this;\r\n\r\n        // Get label\r\n        var label = self.getLabel();\r\n\r\n        // Remove old label align\r\n        label.removeClass(\"ui-bizagi-render-align-left ui-bizagi-render-align-center ui-bizagi-render-align-right\");\r\n\r\n        // Set label align\r\n        label.addClass(self.getAlignClass(alignType));\r\n\r\n        // Call base\r\n        this._super(alignType);\r\n    },\r\n\r\n    /*\r\n    *   Customizes render value align\r\n    */\r\n    changeValueAlign: function (alignType) {\r\n        var self = this;\r\n\r\n        // Get control\r\n        var controlFiller = self.getControlFiller();\r\n\r\n        // Remove old value align\r\n        controlFiller.removeClass(\"ui-bizagi-render-align-left ui-bizagi-render-align-center ui-bizagi-render-align-right\");\r\n\r\n        // Set value align\r\n        controlFiller.addClass(self.getAlignClass(alignType));\r\n\r\n        // Call base\r\n        this._super(alignType);\r\n    },\r\n\r\n    /* Return the icons container*/\r\n    getContainerIcons: function(){\r\n        return $(\".ui-bizagi-render-icons\", this.element);\r\n    },\r\n        \r\n    /*\r\n    *   Show a notification icon\r\n    */\r\n    showIcon: function (icon) {\r\n        var self = this;\r\n        var $containerIcons = self.getContainerIcons();    \r\n        var $errorIcon = $(\".ui-bizagi-render-icon-error\",  $containerIcons);\r\n        var $helpIcon =  $(\".ui-bizagi-render-icon-help\", $containerIcons);\r\n        var visibleIcon;\r\n\r\n        $containerIcons.removeClass('ui-hidden');\r\n\r\n        if(self.isNewRenderForm)\r\n            $containerIcons.removeClass('bz-forms-icons__hidden');\r\n\r\n        if (icon == \"error\") {  \r\n            visibleIcon = $errorIcon.css(\"display\", \"inline-block\");\r\n        }\r\n        if (icon == \"help\") {\r\n            visibleIcon = $helpIcon.css(\"display\", \"inline-block\");\r\n        }\r\n\r\n        if ($helpIcon.is(':visible') && $errorIcon.is(':visible')) {\r\n            $containerIcons.css({'width':'48px', 'min-width': \"48px\"});\r\n        } else if ($helpIcon.is(':visible') || $errorIcon.is(':visible')) {\r\n            $containerIcons.css({'width':'24px', 'min-width': \"24px\"});\r\n        }\r\n\r\n        // Make sure that icon container is visible\r\n        self.getControlFiller().addClass(\"ui-bizagi-state-show-icons\");\r\n\r\n        // Add hover handler in order to lazy-add the tooltip plugin\r\n        visibleIcon.mouseover(function (e) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            if (visibleIcon.data(\"tooltip\") === undefined) {\r\n                // Apply tooltip plugin\r\n                visibleIcon.tooltip({\r\n                    tooltipClass: 'ui-widget-content ui-help-tooltip',\r\n                    items: visibleIcon.attr(\"title\") ? \".ui-icon[title]\" : \".ui-icon[data-title]\",\r\n                    content: function () {\r\n                        var reg = /<\\s*script[^>]*>[\\s\\S]*?(<\\s*\\/script[^>]*>|$)/ig;\r\n                        var element = $(this);\r\n                        var replaceHTML = !element.hasClass(\"ui-bizagi-render-icon-error\");\r\n                        //set the title as 'content' to apply possible html tags or styles included in original title\r\n                        if (element[0] && element[0].attributes[\"data-title\"]) {\r\n                            var text = element[0].attributes[\"data-title\"].value;\r\n                            if(reg.test(text)) {\r\n                                return bizagi.util.sanitizeHTML(text);\r\n                            } else {\r\n                                return text;\r\n                            }\r\n                        } else if (element[0] && element[0].title) {\r\n                            var _title = element[0].title;\r\n                            element[0].title = \"\";\r\n                            if(reg.test(_title)) {\r\n                                return bizagi.util.sanitizeHTML(_title);\r\n                            } else {\r\n                                return _title;\r\n                            }\r\n                        }\r\n                    }\r\n                });\r\n\r\n                visibleIcon.tooltip(\"open\");\r\n                $(\".ui-help-tooltip\").css(\"z-index\", $.ui.dialog.prototype._getMaxZindex());\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Show a notification icon\r\n    */\r\n    hideIcon: function (icon) {\r\n        var self = this;       \r\n        var containerIcons = $(\".ui-bizagi-render-icons\", self.element);\r\n        var errorIcon = $(\".ui-bizagi-render-icon-error\", self.element);\r\n        var helpIcon = $(\".ui-bizagi-render-icon-help\", self.element);\r\n\r\n        if (helpIcon.is(':visible') && errorIcon.is(':visible')) {\r\n            containerIcons.css({'width':'24px', 'min-width': \"24px\"});\r\n        }\r\n\r\n        if (icon == \"error\") {\r\n            $(\".ui-bizagi-render-icon-error\", self.element).css(\"display\", \"none\");\r\n        }\r\n        if (icon == \"help\") {\r\n            $(\".ui-bizagi-render-icon-help\", self.element).css(\"display\", \"none\");\r\n        }\r\n\r\n        // Hide icon container if no icons are shown\r\n        var iconContainer = $(\".ui-bizagi-render-icons span\", self.element);\r\n        if (iconContainer.length > 0 && iconContainer[0].style.display != \"none\") {\r\n            self.getControlFiller().removeClass(\"ui-bizagi-state-show-icons\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Execute design only methods\r\n     */\r\n    performDesignModeMethods: function () {\r\n        // Set all controls read-only\r\n        var control = this.getControl();\r\n\r\n        // Valid control\r\n        if (control !== null) {\r\n            $(\"input, select, button, textarea\", control).attr(\"readonly\", true);\r\n        }\r\n\r\n        // Call base\r\n        this._super();\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Desktop Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.desktop.columns.column\", {}, {\r\n\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n        if (!decorated) return;\r\n        \r\n        // Hacks the getControl method in the decorated render to add features\r\n        if (decorated.getControl) {\r\n            this.originalGetControl = decorated.getControl;\r\n            decorated.getControl = this.getControl;\r\n        }\r\n\r\n        /* Customizes the font weight */\r\n        decorated.getFormattingLabel = function (bold) {\r\n            var self = this;\r\n            return self.getControl();\r\n        };\r\n    },\r\n\r\n    /*\r\n    *   Template method to get the control element\r\n    *   This code runs under the decorated element context\r\n    */\r\n    getControl: function () {\r\n        var self = this;\r\n        var result = this._super();\r\n\r\n        if (!result || result.length == 0) {\r\n            result = $(\".ui-bizagi-cell-readonly\", self.element || self.observableElement);\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function (surrogateKey, cell) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        // Just draw render if the cell layout has been filled\r\n        if (cell && cell.length > 0) {\r\n            var cellIcon = $(\".ui-bizagi-cell-icon\", cell);\r\n            if (!properties.editable) cellIcon.remove();\r\n\r\n            // Apply styles to cell\r\n            self.applyColumnStyles(cell);\r\n\r\n            if (properties.align == \"left\") {\r\n                cellIcon.addClass(\"ui-bizagi-cell-icon-right\");\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Apply column styles to a specified element\r\n    */\r\n    applyColumnStyles: function (element) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set cell back color\r\n        if (properties.textFormat.background) {\r\n            element.css(\"background-color\", properties.textFormat.background);\r\n            element.css(\"background-image\", \"none\");\r\n        }\r\n    }\r\n});","/*\r\n *   Name: Bizagi Desktop Form Dialog Implementation\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will shows a form inside a popup dialog in order to edit\r\n */\r\n\r\n// Extends itself\r\n$.Class.extend(\"bizagi.rendering.dialog.form\", {\r\n    POPUP_WIDTH: 768,\r\n    POPUP_HEIGHT: 550\r\n}, {\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (dataService, renderFactory, dialogParams) {\r\n        var self = this;\r\n        var doc = window.document;\r\n\r\n        //Attach the desired extra buttons, everyone need to have the localization id, so the label could match\r\n        self.buttons = {};\r\n\r\n        for (var item in dialogParams.extraButtons) {\r\n            self.buttons[bizagi.localization.getResource(item)] = dialogParams.extraButtons[item];\r\n        }\r\n\r\n        // Define instance variables\r\n        this.dataService = dataService;\r\n        this.renderFactory = renderFactory;\r\n        this.dialogDeferred = new $.Deferred();\r\n        dialogParams = self.dialogParams = dialogParams || {};\r\n\r\n        // Draw dialog box\r\n        self.dialogBox = $(\"<div class='ui-bizagi-component-loading'/>\");\r\n        self.dialogBox.empty();\r\n        self.dialogBox.appendTo(\"body\", doc);\r\n\r\n        // Create dialog box\r\n        self.showDialogBox(self.dialogBox, dialogParams)\r\n            .done(function (data) {\r\n                self.dialogDeferred.resolve(data);\r\n            })\r\n            .fail(function () {\r\n                self.dialogDeferred.reject({idPageCache: self.form.getPageCache()});\r\n            });\r\n    },\r\n    /*\r\n    *   Render the form\r\n    *   The params are the same that will be send to the ajax service\r\n    *   Returns a deferred\r\n    */\r\n    render: function (params) {\r\n        var self = this;\r\n\r\n        // Fill dialog box\r\n        self.renderDialogBox(self.dialogBox, params);\r\n\r\n        // Return promise\r\n        return self.dialogDeferred.promise();\r\n    },\r\n    /*\r\n    *   Shows the dialog box in the browser\r\n    *   Returns a promise that the dialog will be closed\r\n    */\r\n    showDialogBox: function (dialogBox, dialogParams, reverseButtons) {\r\n        var self = this;\r\n        var reverseButtons = self.dialogParams.orientation == \"rtl\" ? true : false;\r\n\r\n        // Define buttons\r\n        var buttons = {};\r\n        var defer = new $.Deferred();\r\n\r\n        // Define options\r\n        var showSaveButton = bizagi.util.parseBoolean(dialogParams.showSaveButton) !== null ? bizagi.util.parseBoolean(dialogParams.showSaveButton) : true;\r\n        var showCancelButton = bizagi.util.parseBoolean(dialogParams.showCancelButton) !== null ? bizagi.util.parseBoolean(dialogParams.showCancelButton) : true;\r\n        var saveButtonLabel = dialogParams.saveButtonLabel ? dialogParams.saveButtonLabel : bizagi.localization.getResource(\"render-form-dialog-box-save\");\r\n        var cancelButtonLabel = dialogParams.cancelButtonLabel ? dialogParams.cancelButtonLabel : bizagi.localization.getResource(\"render-form-dialog-box-cancel\");\r\n        var maximized = bizagi.util.parseBoolean(dialogParams.maximized) !== null ? bizagi.util.parseBoolean(dialogParams.maximized) : false;\r\n\r\n        var performActions = function(event) {\r\n            // Perform validations\r\n            if (self.form.validateForm()) {\r\n\r\n                // Collect data\r\n                var data = {};\r\n\r\n                if (dialogParams.forceCollectData) {\r\n                    // Turn on flag to force to collect all data on the form\r\n                    $.forceCollectData = true;\r\n                    self.form.collectRenderValues(data);\r\n                    // Turn off flag\r\n                    $.forceCollectData = false;\r\n                } else {\r\n                    self.form.collectRenderValues(data);\r\n                }\r\n\r\n                if (dialogParams.allowGetOriginalFormValues) {\r\n                    data.formValues = self.form.children;\r\n                }\r\n\r\n                // Add page cache for this form\r\n                data.idPageCache = self.form.getPageCache();\r\n\r\n                // Call user callback\r\n                if (dialogParams.onSave && !$(event.currentTarget).prop(\"disabled\")) {\r\n                    $(event.currentTarget).prop(\"disabled\", true);\r\n                    $(event.currentTarget).button(\"disable\"); //Setting styles\r\n                    $.when(dialogParams.onSave(data))\r\n                        .done(function (result) {\r\n                            $(event.currentTarget).prop(\"disabled\", false);\r\n                            $(event.currentTarget).button(\"enable\"); //Setting styles\r\n                            if (result == null || result == true || result.type == \"success\") {\r\n                                defer.resolve();\r\n                                self.closeDialogBox();\r\n                            } else if ([\"validationMessages\", \"alertMessages\"].includes(result.type)) {\r\n                                // Add validation messages\r\n                                if (result.type === \"validationMessages\") {\r\n                                    self.form.addValidationMessage(result.messages);\r\n                                } else {\r\n                                    bizagi.modalError.show(result.messages, 'workportal-general-word-information', false);\r\n                                }\r\n\r\n                                // Update original value to use as reference to other futures changes in the dialogBox\r\n                                $.each(data, function (key, value) {\r\n                                    var renders = self.form.getRenders(key);\r\n                                    $.each(renders, function (i, render) {\r\n                                        render.updateOriginalValue();\r\n                                    });\r\n                                });\r\n                            } else if (result.type === \"error\") {\r\n                                // Add error messages \r\n                                self.form.addErrorMessage(result.message);\r\n                            }\r\n                        }).fail(function () {\r\n                            $(event.currentTarget).prop(\"disabled\", false);\r\n                            $(event.currentTarget).button(\"enable\"); //Setting styles\r\n                    });                                \r\n                } else {\r\n                    defer.resolve();\r\n                    self.closeDialogBox();\r\n                }\r\n            }\r\n        };\r\n\r\n        if (showSaveButton) {\r\n            buttons[saveButtonLabel] = function (event) {\r\n                if (self.form) {\r\n                    // load tabs\r\n                    var form = self.form,\r\n                        asyncTabsDef = $.Deferred(),\r\n                        getAllTabs = form.getRenderByType(\"tabItem\"),\r\n                        getAllTabsLength = getAllTabs.length;\r\n\r\n                    form.innerTabsLoading = true;\r\n\r\n                    $(event.currentTarget).prop(\"disabled\", true);\r\n                    form.useOrSetLoaderDeferred();\r\n\r\n                    // Check\r\n                    for (var i = 0; i < getAllTabsLength; i++) {\r\n                        var render = getAllTabs[i];\r\n                        // Resolve internal deferred\r\n                        if (render.loadingDeferred && render.parent.container) {\r\n                            render.loadingDeferred.resolve();\r\n                        }\r\n                    }\r\n\r\n                    delete form.innerTabsLoading;\r\n                    // Resolve task deferred\r\n                    asyncTabsDef.resolve({event: event});\r\n\r\n                    $.when(asyncTabsDef.promise(), form.getLoaderPromise()).done(function (response) {\r\n                        var event = response.event;\r\n\r\n                        $(event.currentTarget).prop(\"disabled\", false);\r\n                        form.deleteLoaderDeferred();\r\n\r\n                        performActions(event);\r\n                    }).fail(function() {\r\n                        $(event.currentTarget).prop(\"disabled\", false);\r\n                        form.deleteLoaderDeferred();\r\n\r\n                        performActions(event);\r\n                    });\r\n                }\r\n            };\r\n        }\r\n        if (showCancelButton) {\r\n            buttons[cancelButtonLabel] = function () {\r\n                dialogParams.onCancel && dialogParams.onCancel();\r\n                defer.reject();\r\n                self.closeDialogBox();\r\n            };\r\n        }\r\n\r\n        //Attach the desired extra buttons \r\n        self.buttons = $.extend(buttons, self.buttons);\r\n\r\n        //Orientation RTL - OrderBut\r\n        if (self.dialogParams.orientation == \"rtl\") {\r\n            var objButtons;\r\n            var nameButon;\r\n            for (var prop in buttons) {\r\n                objButtons = buttons[prop];\r\n                nameButon = prop;\r\n                break;\r\n            }\r\n\r\n            delete buttons[nameButon];\r\n            buttons[nameButon] = objButtons;\r\n\r\n        }\r\n\r\n        // Creates a dialog\r\n        dialogBox.dialog({\r\n            width: this.Class.POPUP_WIDTH,\r\n            height: this.Class.POPUP_HEIGHT,\r\n            title: dialogParams.title,\r\n            modal: true,\r\n            buttons: self.buttons,\r\n            resizable: false,  // This one is to avoid a memory leak, DO NOT CHANGE PLEASE\r\n            maximized: maximized,\r\n            open: function (event, ui) {\r\n                if (maximized && typeof isWebpart == \"undefined\") {\r\n                    // remove scroll bar\r\n                    $(\"body\", window.document).css(\"position\", \"fixed\");\r\n                }\r\n            },\r\n            close: function () {\r\n                // set scroll bar\r\n                $(\"body\", window.document).css(\"position\", \"static\");\r\n\r\n                defer.reject();\r\n                self.closeDialogBox();\r\n            },\r\n            resizeStop: function (event, ui) {\r\n                if (self.form) {\r\n                    self.form.resize(ui.size);\r\n                }\r\n            },\r\n            maximize: function (e) {\r\n                if (self.form) {\r\n                    self.form.triggerHandler(\"maximazedForm\");\r\n                    self.dialogBox.trigger(\"resize\");\r\n                }\r\n            },\r\n            unmaximize: function (e) {\r\n                if (self.form) {\r\n                    self.form.triggerHandler(\"unmaximazedForm\");\r\n                    self.dialogBox.trigger(\"resize\");\r\n                }\r\n            }\r\n        });\r\n\r\n        self.adjustOverlay();\r\n\r\n        // Return promise\r\n        return defer.promise();\r\n    },\r\n    _appresize: function (args) {\r\n        var self = this;\r\n        $(self.dialogBox).dialog('widget').css({\r\n            left: ((window.screen.width / 2) - (self.Class.POPUP_WIDTH / 2)) + \"px\",\r\n            top: ((window.screen.height / 2) - (self.Class.POPUP_HEIGHT / 2)) + \"px\",\r\n            width: self.Class.POPUP_WIDTH + \"px\",\r\n            height: self.Class.POPUP_HEIGHT + \"px\"\r\n        }).show();\r\n\r\n    },\r\n    /*\r\n    *   Closes the dialog box\r\n    */\r\n    closeDialogBox: function () {\r\n        var self = this;\r\n        var dialogBox = self.dialogBox;\r\n\r\n        // set scroll bar\r\n        $(\"body\", window.document).css(\"position\", \"static\");\r\n\r\n        dialogBox.dialog('destroy');\r\n        dialogBox.remove();\r\n        // Send the form to the hell, please dont remove this line, make a several bugs!!\r\n        self.dispose();\r\n    },\r\n    /**\r\n     * Sets the focus to the first control\r\n     */\r\n    focusFirstControl: function (form, time) {\r\n        var self = this;\r\n        // Configures effect\r\n        var effect = function () {\r\n            var defaultControl = $(\"input:visible, select:visible, option:visible, textarea:visible\", form.container).not(\".ui-bizagi-render-date,.ui-bizagi-render-search\");\r\n            if (defaultControl.length > 0) {\r\n                // fix for retype double\r\n                var controlHtml = $(defaultControl[0]).closest(\".ui-bizagi-render\");\r\n                var xpath = controlHtml.length > 0 ? controlHtml.data(\"render-xpath\") : \"\";\r\n                var control = xpath ? form.getRender(xpath) : \"\";\r\n                if (control) {\r\n                    if (control.properties && control.properties.retype && control.properties.retype === \"double\") {\r\n                        return;\r\n                    }\r\n                }\r\n                // Focus control\r\n                var innerControl = defaultControl[0];\r\n                if (self.isValidControlForFocus(innerControl, form)) {\r\n                    try {\r\n                        innerControl.focus();\r\n                    } catch (e) {\r\n                    }\r\n                }\r\n            } else {\r\n                var innerControl = $(\".ui-bizagi-render\", form.container)[0];\r\n                $(innerControl).attr(\"tabindex\", 0);\r\n\r\n                innerControl.focus();\r\n\r\n                $(innerControl).removeAttr(\"tabindex\");\r\n            }\r\n        };\r\n\r\n        // Run effect\r\n        if (time > 0) {\r\n            setTimeout(effect, time);\r\n\r\n        } else {\r\n            effect();\r\n        }\r\n    },\r\n\r\n    isValidControlForFocus: function (control, form) {\r\n        var result = true;\r\n        var container = $(control).closest('[data-render-id]');\r\n        var id = container.data('render-id');\r\n        var isOnGrid = id && container.length ? (container.data('bizagi-component') == 'cellContent') : false;\r\n\r\n        if (id && isOnGrid) {\r\n            var grid = form.getGridByColumn(id);\r\n            var type = grid ? grid.getColumnType(id) : null;\r\n            if (type && type == 'columnCombo') {\r\n                result = false;\r\n            }\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    * Renders the dialog box content\r\n    */\r\n    renderDialogBox: function (dialogBox, params) {\r\n        var self = this;\r\n        var def = new $.Deferred();\r\n\r\n        // Clear dialog box\r\n        dialogBox.empty();\r\n\r\n        // Check context\r\n        try {\r\n            if (self.form && self.form.params.data.contextType) {\r\n                params.contextType = self.form.params.data.contextType;\r\n            }\r\n        } catch (e) { }\r\n        if (params.rewriteContextType === true) {\r\n            //self.properties.contextType\r\n        }\r\n\r\n        // Load template and data\r\n        return $.when(self.dataService.getFormData(params)).pipe(function (data) {\r\n            // Apply recordXpath\r\n            if (params.recordXPath) {\r\n                data.form.properties.recordXpath = params.recordXPath;\r\n            }\r\n\r\n            // Apply contextType\r\n            data.form.contextType = params.contextType;\r\n            if (params.rewriteContextType) {\r\n                data.form.contextType = undefined;\r\n            }\r\n\r\n            // Apply editable param\r\n            if (params.editable === false) {\r\n                data.form.properties.editable = false;\r\n\r\n                // The actions don't apply in dialog form\r\n                self.removeActions(data.form);\r\n            }\r\n\r\n            // Apply required param\r\n            if (params.required === false) {\r\n                data.form.properties.required = false;\r\n            }\r\n\r\n            // The transitions don't apply in dialog form\r\n            self.removeTransitions(data.form);\r\n\r\n            // Render dialog template\r\n            self.form = self.renderFactory.getContainer({\r\n                type: \"form\",\r\n                data: data.form,\r\n                canvas: self.dialogBox,\r\n                focus: params.focus || false,\r\n                selectedTabs: params.selectedTabs,\r\n                isRefresh: params.isRefresh || false,\r\n                requestedForm: params.requestedForm\r\n            });\r\n\r\n            def.resolve(self.form);\r\n\r\n            // Return rendering promise\r\n            return self.form.render();\r\n        }, function (message) {\r\n            /*** FAIL FILTER **/\r\n            var errorTemplate = self.renderFactory.getCommonTemplate(\"form-error\");\r\n            if (typeof message == \"object\" && message.responseText) {\r\n                var objMessage = JSON.parse(message.responseText);\r\n                message = \"Error:\" + objMessage.errorType + \"<br>\" + objMessage.message || \" Error in form \";\r\n            }\r\n\r\n            // Clear dialog box\r\n            $(\"*\", dialogBox).remove();\r\n\r\n            $.tmpl(errorTemplate, {\r\n                message: message\r\n            }).appendTo(dialogBox);\r\n        }).done(function (element) {\r\n            // Remove button container\r\n            $(\".ui-bizagi-button-container\", element).remove();\r\n\r\n            // Append form  in the dialog\r\n            $('.ui-bizagi-loading-message', dialogBox).remove();\r\n            dialogBox.data(\"loading\", false);\r\n            dialogBox.removeClass(\"ui-bizagi-component-loading\");\r\n            dialogBox.html(element);\r\n\r\n            // Customize dialog box\r\n            dialogBox = self.customizeDialogBox(dialogBox);\r\n\r\n            // Publish an event to check if the form has been set in the DOM\r\n            self.form.triggerHandler(\"ondomincluded\", params.mainForm);\r\n\r\n            if (bizagi.override.adjustButtonPositionDialogForm)\r\n                self.adjustButtonPosition(dialogBox);\r\n\r\n            // Scroll to element if has scroll top set\r\n            if (params.scrollTop) {\r\n                // Restore scroll at same position\r\n                self.form.container.parent().scrollTop(params.scrollTop);\r\n            } else {\r\n                // Focus into first control\r\n                self.focusFirstControl(self.form, 150);\r\n            }\r\n\r\n            // Attach a refresh handler to recreate all the form\r\n            self.form.bind(\"refresh\", function (_, refreshParams) {\r\n                // Check current scroll in parent\r\n                refreshParams.scrollTop = self.form.container.parent().scrollTop();\r\n                refreshParams = $.extend({\r\n                    focus: focus,\r\n                    selectedTabs: self.form.getSelectedTabs(),\r\n                    isRefresh: true,\r\n                    mainForm: params.mainForm\r\n                }, refreshParams);\r\n\r\n                return self.renderDialogBox(dialogBox, refreshParams);\r\n            });\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    adjustButtonPosition: function (dialogBox) {\r\n        var childrenContainer = dialogBox.find(\".ui-bizagi-container:first\")[0];\r\n        var titleHeight = 29;\r\n        var buttonHeight = 58;\r\n        var availableHeight = dialogBox.parent().height() - titleHeight - buttonHeight;\r\n\r\n        new ResizeSensor(childrenContainer, function () {\r\n            availableHeight = dialogBox.parent().height() - titleHeight - buttonHeight;\r\n            fitSizes();\r\n        });\r\n\r\n        var fitSizes = function () {\r\n            if (childrenContainer.clientHeight > availableHeight) {\r\n                dialogBox.height(availableHeight - 20);\r\n                $(\".ui-dialog-buttonpane\", dialogBox.parent()).css(\"top\", titleHeight + availableHeight);\r\n            } else {\r\n                dialogBox.height(childrenContainer.clientHeight + 20);\r\n                $(\".ui-dialog-buttonpane\", dialogBox.parent()).css(\"top\", titleHeight + dialogBox.height());\r\n            }\r\n        }\r\n\r\n        fitSizes();\r\n    },\r\n\r\n    /*\r\n    *   This method can be overriden in order to customize the dialog form rendering\r\n    */\r\n    customizeDialogBox: function (dialogBox) {\r\n        return dialogBox;\r\n    },\r\n\r\n    /*\r\n    * This method removes the transitions\r\n    */\r\n    removeTransitions: function (data) {\r\n        data = data || {};\r\n\r\n        if (data.transitions) {\r\n            delete data.transitions;\r\n        }\r\n    },\r\n\r\n    /*\r\n    * This method removes the actions\r\n    */\r\n    removeActions: function (data) {\r\n        data = data || {};\r\n\r\n        if (data.actions) {\r\n            delete data.actions;\r\n        }\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n        if (self.form) self.form.dispose();\r\n        bizagi.util.dispose(self.buttons);\r\n        bizagi.util.dispose(self);\r\n    },\r\n\r\n    adjustOverlay: function () {\r\n        var overlay = $(\".ui-widget-overlay.ui-front\");\r\n        var body = $(\"body\");\r\n        var canvas = $(\"#render-canvas\");\r\n        var overlayHeight = parseInt(overlay.height());\r\n        var overlayBody = parseInt(body.height());\r\n        var overlayCanvas = parseInt(canvas.height());\r\n\r\n        if (overlayHeight < overlayBody) {\r\n            overlay.height(overlayBody);\r\n            overlayHeight = overlayBody;\r\n        }\r\n        if (overlayHeight < overlayCanvas) {\r\n            overlay.height(overlayCanvas);\r\n        }\r\n    }\r\n\r\n});\r\n","/**\r\n * Show a startform within a dialog box\r\n * Based on dialog.form developed by Diego Parra\r\n *\r\n * @author Edward Morales\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.dialog.startForm\", {\r\n\tPOPUP_WIDTH: 900,\r\n\tPOPUP_HEIGHT: 650\r\n}, {\r\n\r\n\t/**\r\n\t * Constructor\r\n\t * @param dataService\r\n\t * @param renderFactory\r\n\t * @param dialogParams\r\n\t */\r\n\tinit: function(dataService, renderFactory, dialogParams) {\r\n\t\tvar self = this;\r\n\t\tvar doc = window.document;\r\n\r\n\t\t// Object whit reference and actions of buttons\r\n\t\tself.buttons = {};\r\n\r\n\t\tfor(var item in dialogParams.extraButtons) {\r\n\t\t\tself.buttons[bizagi.localization.getResource(item)] = dialogParams.extraButtons[item];\r\n\t\t}\r\n\r\n\t\t// Define instance variables\r\n\t\tthis.dataService = dataService;\r\n\t\tthis.renderFactory = renderFactory;\r\n\t\tthis.dialogDeferred = new $.Deferred();\r\n\t\tdialogParams = self.dialogParams = dialogParams || {};\r\n\r\n\t\t// Draw dialog box\r\n\t\tself.dialogBox = $(\"<div class='ui-bizagi-component-loading'/>\");\r\n\t\tself.dialogBox.empty();\r\n\t\tself.dialogBox.appendTo(\"body\", doc);\r\n\r\n\t\t// Create dialog box\r\n\t\tself.showDialogBox(self.dialogBox, dialogParams)\r\n\t\t\t.done(function(data) {\r\n\t\t\t\tself.dialogDeferred.resolve(data);\r\n\t\t\t})\r\n\t\t\t.fail(function() {\r\n\t\t\t\tself.dialogDeferred.reject();\r\n\t\t\t});\r\n\t},\r\n\r\n\t/*\r\n\t *   Render the form\r\n\t *   The params are the same that will be send to the ajax service\r\n\t *   Returns a deferred\r\n\t */\r\n\trender: function(params) {\r\n\t\tvar self = this;\r\n\r\n\t\t// Fill dialog box\r\n\t\tself.renderDialogBox(self.dialogBox, params);\r\n\r\n\t\t// Return promise\r\n\t\treturn self.dialogDeferred.promise();\r\n\t},\r\n\t/*\r\n\t *   Shows the dialog box in the browser\r\n\t *   Returns a promise that the dialog will be closed\r\n\t */\r\n\tshowDialogBox: function(dialogBox, dialogParams) {\r\n\t\tvar self = this;\r\n\r\n\t\t// Define buttons\r\n\t\tvar buttons = {};\r\n\t\tvar defer = new $.Deferred();\r\n\r\n\t\t// Define options\r\n\t\tvar showSaveButton = bizagi.util.parseBoolean(dialogParams.showSaveButton) !== null ? bizagi.util.parseBoolean(dialogParams.showSaveButton) : true;\r\n\t\tvar showCancelButton = bizagi.util.parseBoolean(dialogParams.showCancelButton) !== null ? bizagi.util.parseBoolean(dialogParams.showCancelButton) : true;\r\n\t\tvar saveButtonLabel = dialogParams.saveButtonLabel ? dialogParams.saveButtonLabel : bizagi.localization.getResource(\"render-form-dialog-box-save\");\r\n\t\tvar cancelButtonLabel = dialogParams.cancelButtonLabel ? dialogParams.cancelButtonLabel : bizagi.localization.getResource(\"render-form-dialog-box-cancel\");\r\n\t\tvar maximized = bizagi.util.parseBoolean(dialogParams.maximized) !== null ? bizagi.util.parseBoolean(dialogParams.maximized) : false;\r\n\r\n\t\tif(showSaveButton) {\r\n\t\t\tbuttons[saveButtonLabel] = function() {\r\n\t\t\t\tif(self.form) {\r\n\t\t\t\t\t// Perform validations\r\n\t\t\t\t\tif(self.form.validateForm()) {\r\n\r\n\t\t\t\t\t\t// Collect data\r\n\t\t\t\t\t\tvar data = {};\r\n\r\n\t\t\t\t\t\tif(dialogParams.forceCollectData) {\r\n\t\t\t\t\t\t\t// Turn on flag to force to collect all data on the form\r\n\t\t\t\t\t\t\t$.forceCollectData = true;\r\n\t\t\t\t\t\t\tself.form.collectRenderValues(data);\r\n\t\t\t\t\t\t\t// Turn off flag\r\n\t\t\t\t\t\t\t$.forceCollectData = false;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tself.form.collectRenderValues(data);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif(dialogParams.allowGetOriginalFormValues) {\r\n\r\n\t\t\t\t\t\t\tdata.formValues = self.form.children;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// Add page cache for this form\r\n\t\t\t\t\t\tdata.idPageCache = self.form.getPageCache();\r\n\r\n\t\t\t\t\t\t// Call user callback\r\n\t\t\t\t\t\tif(dialogParams.onSave) {\r\n\t\t\t\t\t\t\t$.when(dialogParams.onSave(data))\r\n\t\t\t\t\t\t\t\t.done(function(result) {\r\n\t\t\t\t\t\t\t\t\tif(result == null || result == true || result.type == \"success\") {\r\n\t\t\t\t\t\t\t\t\t\tdefer.resolve();\r\n\t\t\t\t\t\t\t\t\t\tself.closeDialogBox();\r\n\t\t\t\t\t\t\t\t\t} else if ([\"validationMessages\", \"alertMessages\"].includes(result.type)) {\r\n\t\t\t\t\t\t\t\t\t\t// Add validation messages\r\n\t\t\t\t\t\t\t\t\t\tif (result.type === \"validationMessages\") {\r\n\t\t\t\t\t\t\t\t\t\t\tself.form.addValidationMessage(result.messages);\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\tbizagi.modalError.show(result.messages, 'workportal-general-word-information', false);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t// Update original value to use as reference to other futures changes in the dialogBox\r\n\t\t\t\t\t\t\t\t\t\t$.each(data, function(key) {\r\n\t\t\t\t\t\t\t\t\t\t\tvar renders = self.form.getRenders(key);\r\n\t\t\t\t\t\t\t\t\t\t\t$.each(renders, function(i, render) {\r\n\t\t\t\t\t\t\t\t\t\t\t\trender.updateOriginalValue();\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t} else if(result.type === \"error\") {\r\n\t\t\t\t\t\t\t\t\t\t// Add error messages\r\n\t\t\t\t\t\t\t\t\t\tself.form.addErrorMessage(result.message);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tdefer.resolve();\r\n\t\t\t\t\t\t\tself.closeDialogBox();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\t\tif(showCancelButton) {\r\n\t\t\tbuttons[cancelButtonLabel] = function() {\r\n\t\t\t\tdialogParams.onCancel && dialogParams.onCancel();\r\n\t\t\t\tself.closeDialogBox();\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t//Attach the desired extra buttons\r\n\t\tself.buttons = $.extend(buttons, self.buttons);\r\n\r\n\t\t// Creates a dialog\r\n\t\tdialogBox.dialog({\r\n\t\t\twidth: this.Class.POPUP_WIDTH,\r\n\t\t\theight: this.Class.POPUP_HEIGHT,\r\n\t\t\ttitle: dialogParams.title,\r\n\t\t\tmodal: true,\r\n\t\t\tbuttons: self.buttons,\r\n\t\t\tresizable: false,  // This one is to avoid a memory leak, DO NOT CHANGE PLEASE\r\n\t\t\tmaximized: maximized,\r\n\t\t\topen: function() {\r\n\t\t\t\tif(maximized) {\r\n\t\t\t\t\t// remove scroll bar\r\n\t\t\t\t\t$(\"body\", window.document).css(\"position\", \"fixed\");\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tclose: function() {\r\n\t\t\t\t// set scroll bar\r\n\t\t\t\t$(\"body\", window.document).css(\"position\", \"static\");\r\n\r\n\t\t\t\tdefer.reject();\r\n\t\t\t\tself.closeDialogBox();\r\n\t\t\t},\r\n\t\t\tresizeStop: function(event, ui) {\r\n\t\t\t\tif(self.form) {\r\n\t\t\t\t\tself.form.resize(ui.size);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tmaximize: function(e){\r\n\t\t\t\tif(self.form) {\r\n\t\t\t\t\tself.form.triggerHandler(\"maximazedForm\");\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tunmaximize: function(e){\r\n\t\t\t\tif(self.form) {\r\n\t\t\t\t\tself.form.triggerHandler(\"unmaximazedForm\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tself.adjustOverlay();\r\n\r\n\t\t// Return promise\r\n\t\treturn defer.promise();\r\n\t},\r\n\t_appresize: function() {\r\n\t\tvar self = this;\r\n\t\t$(self.dialogBox).dialog('widget').css({\r\n\t\t\tleft: ((window.screen.width / 2) - (self.Class.POPUP_WIDTH / 2)) + \"px\",\r\n\t\t\ttop: ((window.screen.height / 2) - (self.Class.POPUP_HEIGHT / 2)) + \"px\",\r\n\t\t\twidth: self.Class.POPUP_WIDTH + \"px\",\r\n\t\t\theight: self.Class.POPUP_HEIGHT + \"px\"\r\n\t\t}).show();\r\n\r\n\t},\r\n\t/*\r\n\t *   Closes the dialog box\r\n\t */\r\n\tcloseDialogBox: function() {\r\n\t\tvar self = this;\r\n\t\tvar dialogBox = self.dialogBox;\r\n\t\t// set scroll bar\r\n\t\t$(\"body\", window.document).css(\"position\", \"static\");\r\n\t\tdialogBox.dialog('destroy');\r\n\t\tdialogBox.remove();\r\n\t\tself.dispose();\r\n\t},\r\n\r\n\t/*\r\n\t * Renders the dialog box content\r\n\t */\r\n\trenderDialogBox: function(dialogBox, params) {\r\n\t\tvar self = this;\r\n\t\tvar def = new $.Deferred();\r\n\r\n\t\t// Clear dialog box\r\n\t\tdialogBox.empty();\r\n\r\n\t\t// Check context\r\n\t\ttry {\r\n\t\t\tif(self.form && self.form.params.data.contextType) {\r\n\t\t\t\tparams.contextType = self.form.params.data.contextType;\r\n\t\t\t}\r\n\t\t} catch(e) {\r\n\t\t}\r\n\r\n\t\t// Load template and data\r\n\t\treturn $.when(self.dataService.getStartForm(params)).pipe(function(data) {\r\n\r\n\t\t\t// Apply contextType\r\n\t\t\tdata.form.contextType = params.contextType;\r\n\r\n\t\t\t// Apply editable param\r\n\t\t\tif(params.editable == false) {\r\n\t\t\t\tdata.form.properties.editable = false;\r\n\r\n\t\t\t\t// The actions don't apply in dialog form\r\n\t\t\t\tself.removeActions(data.form);\r\n\t\t\t}\r\n\r\n\t\t\t// The transitions don't apply in dialog form\r\n\t\t\tself.removeTransitions(data.form);\r\n\r\n\t\t\t// Render dialog template\r\n\t\t\tself.form = self.renderFactory.getContainer({\r\n\t\t\t\ttype: \"form\",\r\n\t\t\t\tdata: data.form,\r\n\t\t\t\tfocus: params.focus || false,\r\n\t\t\t\tselectedTabs: params.selectedTabs,\r\n\t\t\t\tisRefresh: params.isRefresh || false\r\n\t\t\t});\r\n\r\n\t\t\tdef.resolve(self.form);\r\n\r\n\t\t\t// Return rendering promise\r\n\t\t\treturn self.form.render();\r\n\t\t}, function(message) {\r\n\t\t\t/*** FAIL FILTER **/\r\n\t\t\tvar errorTemplate = self.renderFactory.getCommonTemplate(\"form-error\");\r\n\t\t\tif(typeof message == \"object\" && message.responseText) {\r\n\t\t\t\tvar objMessage = JSON.parse(message.responseText);\r\n\t\t\t\tmessage = \"Error:\" + objMessage.errorType + \"<br>\" + objMessage.message || \" Error in form \";\r\n\t\t\t}\r\n\r\n\t\t\t// Clear dialog box\r\n\t\t\t$(\"*\", dialogBox).remove();\r\n\r\n\t\t\t$.tmpl(errorTemplate, {\r\n\t\t\t\tmessage: message\r\n\t\t\t}).appendTo(dialogBox);\r\n\t\t}).done(function(element) {\r\n\t\t\t// Remove button container\r\n\t\t\t$(\".ui-bizagi-button-container\", element).remove();\r\n\r\n\t\t\t// Append form  in the dialog\r\n\t\t\t$('.ui-bizagi-loading-message', dialogBox).remove();\r\n\t\t\tdialogBox.data(\"loading\", false);\r\n\t\t\tdialogBox.removeClass(\"ui-bizagi-component-loading\");\r\n\t\t\tdialogBox.html(element);\r\n\r\n\t\t\t// Customize dialog box\r\n\t\t\tdialogBox = self.customizeDialogBox(dialogBox);\r\n\r\n\t\t\t// Publish an event to check if the form has been set in the DOM\r\n\t\t\tself.form.triggerHandler(\"ondomincluded\");\r\n\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tif(self.dialogParams.maximized) {\r\n\t\t\t\t\tvar instance = self.dialogBox.data(\"ui-dialog\");\r\n\t\t\t\t\tinstance.recalculate && instance.recalculate();\r\n\t\t\t\t}\r\n\t\t\t}, 650);\r\n\r\n\r\n\t\t\t// Attach a refresh handler to recreate all the form\r\n\t\t\tself.form.bind(\"refresh\", function(_, refreshParams) {\r\n\t\t\t\t// Check current scroll in parent\r\n\t\t\t\trefreshParams = $.extend({\r\n\t\t\t\t\tfocus: focus,\r\n\t\t\t\t\tselectedTabs: self.form.getSelectedTabs(),\r\n\t\t\t\t\tisRefresh: true\r\n\t\t\t\t}, params, refreshParams);\r\n\r\n\t\t\t\treturn self.renderDialogBox(dialogBox, refreshParams);\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\treturn def.promise();\r\n\t},\r\n\t/*\r\n\t *   This method can be overriden in order to customize the dialog form rendering\r\n\t */\r\n\tcustomizeDialogBox: function(dialogBox) {\r\n\t\treturn dialogBox;\r\n\t},\r\n\r\n\t/*\r\n\t * This method removes the transitions\r\n\t */\r\n\tremoveTransitions: function(data) {\r\n\t\tdata = data || {};\r\n\r\n\t\tif(data.transitions) {\r\n\t\t\tdelete data.transitions;\r\n\t\t}\r\n\t},\r\n\r\n\t/*\r\n\t * This method removes the actions\r\n\t */\r\n\tremoveActions: function(data) {\r\n\t\tdata = data || {};\r\n\r\n\t\tif(data.actions) {\r\n\t\t\tdelete data.actions;\r\n\t\t}\r\n\t},\r\n\r\n\tdispose: function() {\r\n\t\tvar self = this;\r\n\t\tif(self.form) {\r\n\t\t\tself.form.dispose();\r\n\t\t}\r\n\t\tbizagi.util.dispose(self.buttons);\r\n\t\tbizagi.util.dispose(self);\r\n\t},\r\n\r\n\tadjustOverlay: function() {\r\n\t\tvar overlay = $(\".ui-widget-overlay\");\r\n\t\tvar body = $(\"body\");\r\n\t\tvar overlayHeight = parseInt(overlay.height()), overlayBody = parseInt(body.height());\r\n\r\n\t\tif(overlayHeight < overlayBody) {\r\n\t\t\toverlay.height(overlayBody);\r\n\t\t}\r\n\t}\r\n});\r\n","/*\r\n *   Name: Bizagi Desktop Search Dialog Implementation\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will shows a search form inside a popup dialog in order to edit\r\n */\r\n\r\n// Extends itself\r\n$.Class.extend(\"bizagi.rendering.dialog.search\", {\r\n    POPUP_WIDTH: 800,\r\n    POPUP_HEIGHT: 600\r\n}, {\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (dataService, renderFactory, searchForms, searchParams, otherOptions) {\r\n        var self = this;\r\n        var doc = window.document;\r\n        otherOptions = otherOptions || {};\r\n\r\n        this.dataService = dataService;\r\n        this.renderFactory = renderFactory;\r\n        this.searchForms = searchForms;\r\n        this.searchParams = searchParams;\r\n        this.dialogDeferred = new $.Deferred();\r\n        this.extraButtons = (otherOptions.hasOwnProperty(\"buttons\")) ? otherOptions.buttons : false;\r\n\r\n        // Draw dialog box\r\n        self.dialogBox = $(\"<div class='ui-bizagi-component-loading'/>\");\r\n        self.dialogBox.empty();\r\n        self.dialogBox.appendTo(\"body\", doc);\r\n\r\n        // Create dialog box\r\n        self.showDialogBox(self.dialogBox)\r\n\t\t\t\t.done(function (data) {\r\n\t\t\t\t    self.dialogDeferred.resolve(data);\r\n                    self.form.unbindAutoSaveForm();\r\n\t\t\t\t})\r\n\t\t\t\t.fail(function () {\r\n\t\t\t\t    self.dialogDeferred.reject();\r\n                    self.form.unbindAutoSaveForm();\r\n\t\t\t\t});\r\n    },\r\n    /*\r\n    *   Render the form\r\n    *   The params are the same that will be send to the ajax service\r\n    *   Returns a deferred\r\n    */\r\n    render: function (params) {\r\n        var self = this;\r\n\r\n        // Render search dialog\r\n        self.renderSearchDialog(params);\r\n\r\n        // Return promise\r\n        return self.dialogDeferred.promise();\r\n    },\r\n    renderSearchDialog: function (params) {\r\n        var self = this;\r\n        self.form = null;\r\n        // Creates a dialog\r\n        $.when(self.getSearchContainerData(params))\r\n\t\t\t\t.pipe(function (data) {\r\n\r\n\t\t\t\t    // Render dialog form\r\n\t\t\t\t    if (typeof (data.form.properties) != \"undefined\")\r\n\t\t\t\t        data.form.properties.orientation = params.orientation || \"ltr\";\r\n\r\n\t\t\t\t    var _form = self.renderFactory.getContainer({\r\n\t\t\t\t        type: \"form\",\r\n                        data: data.form,\r\n                        canvas: self.dialogBox\r\n\t\t\t\t    });\r\n\r\n\t\t\t\t    if (params.contexttype) {\r\n\t\t\t\t        _form.properties.contexttype = params.contexttype;\r\n\t\t\t\t    }\r\n\r\n\t\t\t\t    // Save form reference\r\n\t\t\t\t    self.form = _form;\r\n\r\n\t\t\t\t    // Return rendering promise\r\n\t\t\t\t    return self.form.render();\r\n\t\t\t\t})\r\n\t\t\t\t.done(function (element) {\r\n\t\t\t\t    // Remove button container\r\n\t\t\t\t    $(\".ui-bizagi-button-container\", element).remove();\r\n\r\n\t\t\t\t    // Append form  in the dialog\r\n\t\t\t\t    $('.ui-bizagi-loading-message', self.dialogBox).remove();\r\n\t\t\t\t    element.appendTo(self.dialogBox);\r\n\r\n\t\t\t\t    // Publish an event to check if the form has been set in the DOM\r\n\t\t\t\t    self.form.triggerHandler(\"ondomincluded\");\r\n\r\n\t\t\t\t    // Check if there is a tab container (when there are more than one search form)\r\n\t\t\t\t    var tabContainer = self.form.firstChild().properties.type == \"tab\" ? self.form.firstChild() : null;\r\n\t\t\t\t    if (tabContainer) {\r\n\r\n\t\t\t\t        // Bind select tab event\r\n\t\t\t\t        tabContainer.bind(\"selected\", function (e, ui) {\r\n\t\t\t\t            var searchForm = self.searchForms[ui.index];\r\n\r\n\t\t\t\t            $.when(self.loadSearchTab(params, ui.tab, searchForm))\r\n\t\t\t\t\t\t\t.done(function () {\r\n\t\t\t\t\t\t\t    // Set currents search form\r\n\t\t\t\t\t\t\t    self.currentSearchForm = ui.tab.firstChild();\r\n\t\t\t\t\t\t\t    self.currentSearchForm.triggerHandler(\"ondomincluded\");\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t        });\r\n\r\n\t\t\t\t        // Select first tab\r\n\t\t\t\t        tabContainer.container.tabs(\"option\", \"active\", 0);\r\n\t\t\t\t        self.currentSearchForm = tabContainer.firstChild().firstChild();\r\n\t\t\t\t        self.currentSearchForm.triggerHandler(\"ondomincluded\");\r\n\r\n\t\t\t\t    } else {\r\n\r\n\t\t\t\t        // Set currents search form\r\n\t\t\t\t        self.currentSearchForm = self.form.firstChild();\r\n\t\t\t\t        self.currentSearchForm.triggerHandler(\"ondomincluded\");\r\n\t\t\t\t    }\r\n\r\n\t\t\t\t    // Focus into first control\r\n\t\t\t\t    self.focusFirstControl(self.currentSearchForm, 100);\r\n\r\n\t\t\t\t    // Add row selected handlers to resolve the deferred\r\n\t\t\t\t    self.currentSearchForm.bind(\"instanceSelected\", function (ev, ui) {\r\n\t\t\t\t        self.closeDialogBox();\r\n\t\t\t\t        self.dialogBoxDeferred.resolve({\r\n\t\t\t\t            id: ui.id,\r\n\t\t\t\t            label: ''\r\n\t\t\t\t        });\r\n\t\t\t\t    });\r\n\r\n\t\t\t\t    // Event handler to searchList control\r\n\t\t\t\t    self.currentSearchForm.bind(\"multiSelect\", function (ev, ui) {\r\n\t\t\t\t        self.closeDialogBox();\r\n\t\t\t\t        self.dialogBoxDeferred.resolve({\r\n\t\t\t\t            id: ui.id,\r\n\t\t\t\t            label: ui.data\r\n\t\t\t\t        });\r\n\t\t\t\t    });\r\n\t\t\t\t});\r\n    },\r\n    /**\r\n    * Sets the focus to the first control\r\n    */\r\n    focusFirstControl: function (form, time) {\r\n        // Configures effect\r\n        var effect = function () {\r\n            var defaultControl = $(\"input:visible, select:visible, option:visible, textarea:visible\", form.container);\r\n            if (defaultControl.length > 0) {\r\n                // Focus control\r\n                var innerControl = defaultControl[0];\r\n                try {\r\n                    innerControl.focus();\r\n                } catch (e) { };\r\n            }\r\n        };\r\n\r\n        // Run effect\r\n        if (time > 0) {\r\n            setTimeout(effect, time);\r\n\r\n        } else {\r\n            effect();\r\n        }\r\n    },\r\n    /*\r\n    *   Loads a search tab on demand inside an already rendered dialog\r\n    */\r\n    loadSearchTab: function (params, tab, searchForm) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        // If the tab has children it is loaded already\r\n        if (tab.children.length > 0)\r\n            return null;\r\n\r\n        // Load search form data\r\n        $.when(self.getSearchFormData(params, searchForm))\r\n\t\t\t\t.pipe(function (data) {\r\n\t\t\t\t    // Render data inside selected tab\r\n\t\t\t\t    var searchFormContainer = self.renderFactory.getContainer({\r\n\t\t\t\t        type: \"searchForm\",\r\n\t\t\t\t        data: data.form\r\n\t\t\t\t    });\r\n\t\t\t\t    tab.children.push(searchFormContainer);\r\n\r\n\t\t\t\t    return searchFormContainer.render();\r\n\t\t\t\t})\r\n\t\t\t\t.done(function (element) {\r\n\t\t\t\t    // Remove button container\r\n\t\t\t\t    $(\".ui-bizagi-button-container\", element).remove();\r\n\r\n\t\t\t\t    tab.container.append(element);\r\n\t\t\t\t    defer.resolve();\r\n\t\t\t\t});\r\n\r\n        return defer.promise();\r\n    },\r\n    /*\r\n    *   Shows the dialog box in the browser\r\n    *   Returns a promise that the dialog will be closed\r\n    */\r\n    showDialogBox: function (dialogBox, reverseButtons) {\r\n        var self = this;\r\n        var reverseButtons = self.searchParams.orientation == \"rtl\" ? true : false;\r\n        // Define buttons\r\n        var buttons = [];\r\n        self.dialogBoxDeferred = new $.Deferred();\r\n\r\n        var defaultButtons = [\r\n            {\r\n                text: bizagi.localization.getResource(\"render-form-dialog-box-search\"),\r\n                click: function () {\r\n                    if (self.searchParams) {\r\n                        self.searchParams.searchTriggeredBy = \"button\";\r\n                    }\r\n                    // Perform search\r\n                    self.currentSearchForm.performSearch(self.searchParams);\r\n                }\r\n            },\r\n            {\r\n                text: bizagi.localization.getResource(\"render-form-dialog-box-cancel\"),\r\n                click: function () {\r\n                    self.dialogBoxDeferred.reject();\r\n                    self.closeDialogBox();\r\n                }\r\n            }\r\n        ]\r\n        if (this.extraButtons) {\r\n            buttons.push(this.extraButtons);\r\n        }\r\n        buttons = buttons.concat(defaultButtons);\r\n\r\n        if (reverseButtons)\r\n            buttons.reverse();\r\n\r\n        var popupWidth = this.Class.POPUP_WIDTH;\r\n        var popupHeight = this.Class.POPUP_HEIGHT;\r\n\r\n        if (popupWidth > $(window).width())\r\n            popupWidth = $(window).width() * 0.9;\r\n\r\n        // Creates a dialog\r\n        dialogBox\r\n\t\t\t\t.addClass(\"ui-bizagi-dialog-search\")\r\n\t\t\t\t.dialog({\r\n\t\t\t\t    title: bizagi.localization.getResource(\"render-search-dialog-title\"),\r\n\t\t\t\t    width: popupWidth,\r\n\t\t\t\t    height: popupHeight,\r\n\t\t\t\t    resizable: false,  // This one is to avoid a memory leak, DO NOT CHANGE PLEASE\r\n\t\t\t\t    modal: true,\r\n\t\t\t\t    buttons: buttons,\r\n\t\t\t\t    close: function () {\r\n\t\t\t\t        self.dialogBoxDeferred.reject();\r\n\t\t\t\t        self.closeDialogBox();\r\n\t\t\t\t    },\r\n\t\t\t\t    resizeStop: function (event, ui) {\r\n                        self.form.resize(ui.size);\r\n                    },\r\n                    maximize: function(e){\r\n                        if (self.currentSearchForm){\r\n                            self.currentSearchForm.triggerHandler(\"maximazedForm\");\r\n                            self.dialogBox.trigger(\"resize\");\r\n                        }\r\n                    },\r\n                    unmaximize: function(e){\r\n                        if (self.currentSearchForm){\r\n                            self.currentSearchForm.triggerHandler(\"unmaximazedForm\");\r\n                            self.dialogBox.trigger(\"resize\");\r\n                        }\r\n                    }\r\n\t\t\t\t});\r\n\r\n        // Return promise\r\n        return self.dialogBoxDeferred.promise();\r\n    },\r\n\r\n    /*\r\n    *   Closes the dialog box\r\n    */\r\n    closeDialogBox: function () {\r\n        var self = this;\r\n        var dialogBox = self.dialogBox;\r\n        dialogBox.dialog('destroy');\r\n        dialogBox.detach();\r\n\t\t// Invalidate searchform page cache in the server\r\n        var pageCacheToInvalidate = self.currentSearchForm.getPageCache();\r\n        self.dataService.invalidatePageCache({ idPageCache: pageCacheToInvalidate });\r\n    },\r\n\r\n    /**\r\n    * Add buttons to dialog box\r\n    */\r\n\r\n    addButtons: function (params) {\r\n\r\n\r\n    },\r\n    /*     \r\n    *   Creates the search dialog sub-containers\r\n    */\r\n    getSearchContainerData: function (params) {\r\n        var self = this;\r\n        var deferred = new $.Deferred();\r\n        var data = {\r\n            form: {\r\n                properties: {},\r\n                elements: []\r\n            }\r\n        };\r\n        var container = data.form;\r\n        var searchFormToLoad = self.searchForms[0];\r\n\r\n        // When there are more than one search form, render a tab container\r\n        if (self.searchForms.length > 1) {\r\n\r\n            var tabContainer = {};\r\n            tabContainer.properties = {\r\n                type: \"tab\"\r\n            };\r\n            tabContainer.elements = [];\r\n            var otherElements = [];\r\n\r\n            $.each(self.searchForms, function (i, searchForm) {\r\n                var isDefault = searchForm[\"default\"] || false;\r\n\r\n                // Create tab item\r\n                var tab = {};\r\n                tab.properties = {\r\n                    id: i,\r\n                    type: 'tabItem',\r\n                    displayName: searchForm.caption\r\n                };\r\n                tab.elements = [];\r\n\r\n                // Append children \r\n                if (isDefault) {\r\n\r\n                    tabContainer.elements.push({\r\n                        container: tab\r\n                    });\r\n\r\n                    // Set properties to load default container\r\n                    container = tab;\r\n                    searchFormToLoad = self.searchForms[0];\r\n\r\n                } else {\r\n                    otherElements.push({\r\n                        container: tab\r\n                    });\r\n\r\n                }\r\n            });\r\n\r\n            // Append no defaults elements\r\n            $.each(otherElements, function (i, element) {\r\n                tabContainer.elements.push(element);\r\n            });\r\n\r\n            data.form.elements.push({\r\n                container: tabContainer\r\n            });\r\n        }\r\n\r\n        // Loads default form\r\n        $.when(self.getSearchFormData(params, searchFormToLoad)).done(function (searchFormData) {\r\n            if (searchFormData) {\r\n                container.elements.push(searchFormData);\r\n\t\t\t\t// Add a reference to inner search form pagecache\r\n                container.pageCacheId = searchFormData.form.pageCacheId;\r\n                // Resolve deferred\r\n                deferred.resolve(data);\r\n            }\r\n        }).fail(function(){\r\n            console.log(\"Error\");\r\n        });\r\n\r\n        return deferred.promise();\r\n    },\r\n    /*\r\n    *   Loads a search form\r\n    */\r\n    getSearchFormData: function (params, searchForm) {\r\n        var self = this;\r\n        //Check if exist form\r\n        if (searchForm == undefined || searchForm.id == undefined) {\r\n            var strMessage = bizagi.localization.getResource(\"render-search-without-form\");\r\n            var divMessage = $(\"<div>\").append(strMessage);\r\n            self.dialogBox.dialog(\"close\");\r\n\r\n            $(divMessage).dialog({\r\n                modal: true,\r\n                buttons: [{\r\n                    text: bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n                    click: function () {\r\n                        $(this).dialog(\"close\");\r\n                    }\r\n                }],\r\n                maximize: function(e){\r\n                    console.log(\"please check if executed, which form trigger the event 'dialog.search'\");\r\n                },\r\n                unmaximize: function(e){\r\n                    console.log(\"please check if executed, which form trigger the event 'dialog.search'\");\r\n                }\r\n            });\r\n\r\n            return false;\r\n        }\r\n\r\n        return self.dataService.getSearchFormData($.extend(params, {\r\n            idSearchForm: searchForm.id,\r\n            url: searchForm.url\r\n\r\n        })).pipe(function (data) {\r\n            // Append search render properties\r\n            data.form.properties.idRender = params.idRender;\r\n\r\n            return data;\r\n        });\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n        self.form.dispose();\r\n        bizagi.util.dispose(self.buttons);\r\n        bizagi.util.dispose(self);\r\n    }\r\n});\r\n","/**\r\n * Description of file\r\n *\r\n * @author: Jeison Borja\r\n */\r\n\r\nbizagi.rendering.dialog.search.extend(\"bizagi.rendering.dialog.searchUser\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function(dataService, renderFactory, searchForms, searchParams, otherOptions) {\r\n        // Call base\r\n        this._super(dataService, renderFactory, searchForms, searchParams, otherOptions);\r\n    },\r\n\r\n    getSearchFormData: function(params) {\r\n        return {\r\n            \"form\": {\r\n                \"properties\":\r\n                {\r\n                    \"id\": \"3ad923cf-f21e-439e-90b5-f2df8ffe4559\",\r\n                    \"type\": \"searchForm\",\r\n                    \"displayName\": \"SearchWFuser\",\r\n                    \"xpathContext\": \"\",\r\n                    \"columns\": [\r\n                        { \"caption\": \"idUser\", \"dataType\": 7, \"xpath\": \"idUser\" },\r\n                        { \"caption\": \"userName\", \"dataType\": 15, \"xpath\": \"userName\" },\r\n                        { \"caption\": \"domain\", \"dataType\": 15, \"xpath\": \"domain\" },\r\n                        { \"caption\": \"fullName\", \"dataType\": 15, \"xpath\": \"fullName\" },\r\n                        { \"caption\": \"enabledForAssignation\", \"dataType\": 5, \"xpath\": \"enabledForAssignation\" },\r\n                        { \"caption\": \"enabled\", \"dataType\": 5, \"xpath\": \"enabled\" }\r\n                    ]\r\n                },\r\n                \"elements\": [\r\n                    {\r\n                        \"render\": {\r\n                            \"properties\": {\r\n                                \"id\": \"e0babe1d-7924-4d2a-8fb3-b915b746dbe6\",\r\n                                \"type\": \"searchText\",\r\n                                \"xpath\": \"domain\",\r\n                                \"displayName\": \"domain\",\r\n                                \"dataType\": 15\r\n                            }\r\n                        }\r\n                    },\r\n                    {\r\n                        \"render\": {\r\n                            \"properties\": {\r\n                                \"id\": \"87b14b2e-992d-4e40-a17b-eecbcbc2466a\",\r\n                                \"type\": \"searchText\",\r\n                                \"xpath\": \"userName\",\r\n                                \"displayName\": \"userName\",\r\n                                \"dataType\": 15\r\n                            }\r\n                        }\r\n                    },\r\n                    {\r\n                        \"render\": {\r\n                            \"properties\": {\r\n                                \"id\": \"c5d137d9-a392-4d8e-9088-d5eba64b4c2a\",\r\n                                \"type\": \"searchText\",\r\n                                \"xpath\": \"fullName\",\r\n                                \"displayName\": \"fullName\",\r\n                                \"dataType\": 15\r\n                            }\r\n                        }\r\n                    }\r\n                ],\r\n                \"buttons\": [],\r\n                \"sessionId\": \"bcy5gtv11xxao4oy4xrlk3o3\",\r\n                \"pageCacheId\": 1876964702\r\n            },\r\n            \"type\": \"form\"\r\n        };\r\n    }\r\n\r\n});","/*\r\n*   Name: Bizagi Desktop Letter Dialog Implementation\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will shows a letter inside a popup dialog in order to edit\r\n*/\r\n\r\n// Extends itself\r\n$.Class.extend(\"bizagi.rendering.dialog.letter\", {\r\n    POPUP_WIDTH: 800,\r\n    POPUP_HEIGHT: 550    \r\n}, {\r\n\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (dataService, renderFactory) {\r\n        this.dataService = dataService;\r\n        this.renderFactory = renderFactory;\r\n    },\r\n\r\n    /*\r\n    *   Render the letter content\r\n    *   The params are the same that will be send to the ajax service\r\n    *   Returns a deferred\r\n    */\r\n    render: function (content) {\r\n        var self = this;\r\n        var doc = window.document;\r\n        var template = self.renderFactory.getTemplate(\"letter.dialog\");\r\n        \r\n        // Render template\r\n        var dialog = $.tmpl(template);\r\n        \r\n        // Append form  in the dialog\r\n        dialog.appendTo(\"body\", doc);\r\n        \r\n        // Set height and width manually to adjust to the container\r\n        var textarea = $(\"#ui-bizagi-rtfeditor\", dialog);\r\n        textarea.width(this.Class.POPUP_WIDTH - 30);\r\n        textarea.height(this.Class.POPUP_HEIGHT - 150);\r\n        \r\n        // Apply plugin\r\n        new nicEditor({\r\n            iconsPath: self.dataService.getLetterEditorIconsPath(),\r\n            fullPanel: true\r\n        }).panelInstance('ui-bizagi-rtfeditor');\r\n        \r\n        // Create a templateParts array to hold the full html separated by body tags\r\n        self.templateParts = content.split(/(<body>|<\\/body>)/ig);\r\n        \r\n        // Set data\r\n        nicEditors.findEditor(\"ui-bizagi-rtfeditor\").setContent(content);\r\n        \r\n        // Create dialog box\r\n        return self.showDialogBox(dialog);\r\n    },\r\n\r\n    /*\r\n    *   Shows the dialog box in the browser\r\n    *   Returns a promise that the dialog will be closed\r\n    */\r\n    showDialogBox: function (dialogBox) {\r\n        var self = this;\r\n        \r\n        // Define buttons\r\n        var buttons = {};\r\n        var defer = new $.Deferred();\r\n                   \r\n        buttons[bizagi.localization.getResource(\"render-letter-dialog-box-save\")] = function () {\r\n            var newContent = nicEditors.findEditor(\"ui-bizagi-rtfeditor\").getContent();\r\n            \r\n            // Destroy dialog\r\n            dialogBox.dialog('destroy');\r\n            dialogBox.remove();\r\n            \r\n            // Append content to template, because the plugine removed html, head and body tags\r\n            //  - Actually there is an incosistent behaviour between IE8 and IE9\r\n            //  - In IE8, the templateParts doesn't include the <body> in the splitted array\r\n            //  - In IE9, the templateParts includes the <body> in the splitted array\r\n            if (self.templateParts[1] == \"<body>\") {\r\n            \t\r\n            \t// Remove empty headers, rare behaviour in IE9\r\n            \t self.templateParts[2] = newContent.replaceAll(\"<header></header>\", \"\");\r\n            \t\r\n            \t// Return new content\r\n                defer.resolve(self.templateParts.join(\"\"));\r\n            \r\n            } else {\r\n            \t// Return new content\r\n                defer.resolve(self.templateParts[0] + \"<body>\" + newContent + \"</body>\" + (self.templateParts.length > 2 ? self.templateParts[2] : \"\"));\r\n            }\r\n            \r\n            \r\n        };\r\n        buttons[bizagi.localization.getResource(\"render-letter-dialog-box-cancel\")] = function () {\r\n            dialogBox.dialog('close'); \r\n        };\r\n\r\n        // Creates a dialog\r\n        dialogBox.dialog({\r\n            width: this.Class.POPUP_WIDTH,\r\n            height: this.Class.POPUP_HEIGHT,\r\n        \ttitle: bizagi.localization.getResource(\"render-letter-dialog-title\"),\r\n            modal: true,\r\n            buttons: buttons,\r\n            close: function (ev, ui) {\r\n                dialogBox.dialog('destroy');\r\n                dialogBox.remove();\r\n                defer.reject();\r\n            }\r\n        });\r\n\r\n        // Return promise\r\n        return defer.promise();\r\n    }\r\n});\r\n\r\n","/*\r\n*   Name: Bizagi Desktop Form Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the form class to adjust to desktop devices\r\n*   -   Will apply a desktop form template\r\n*/\r\n\r\n// Extends from container desktop base\r\nbizagi.rendering.desktop.container.extend(\"bizagi.rendering.desktop.form\", bizagi.rendering.form.prototype);\r\n// Auto extend\r\nbizagi.rendering.desktop.form.extend(\"bizagi.rendering.desktop.form\", {}, {\r\n\r\n    /* \r\n    *   Template method to implement in each device to customize each container after processed\r\n    */\r\n    postRenderContainer: function (container) {\r\n        var self = this;\r\n        var buttons = self.getButtons();\r\n\r\n        // Call base\r\n        self._super(container);\r\n\r\n        if (self.getMode() !== \"execution\") {\r\n            return;\r\n        }\r\n        \r\n        \r\n        // Style buttons\r\n        buttons.button();\r\n\r\n        //Set button length\r\n        var lengthButtons = (buttons) ? buttons.length : 0;\r\n\r\n        if (lengthButtons && self.params.type === \"form\" && self.params.isEntityForm !== true) {\r\n\r\n            if (self.properties.orientation == \"rtl\" && buttons.length > 0 && !self.properties.useCustomButtons) {\r\n                self.buttons.reverse();\r\n            }\r\n\r\n            $(document).data('auto-save', self.properties.id);\r\n            self.configureBindAutoSave(function(deferredSave){\r\n                self.autoSaveEvents(deferredSave);\r\n            });\r\n\r\n            //bind event beforeunload\r\n            self.beforeUnloadFunction = function (e) {\r\n\r\n                var newData = {};\r\n                self.collectRenderValues(newData);\r\n                //if there are changes in the form show a message\r\n                if (!$.isEmptyObject(newData) && $(document).data('auto-save')) {\r\n                    return bizagi.localization.getResource(\"confirmation-savebox-message2\");\r\n                }\r\n                return;\r\n            };\r\n            $(window).unbind('beforeunload').bind('beforeunload', self.beforeUnloadFunction);\r\n        } else {\r\n            if ($._data(document)['events'] && !$._data(document)['events']['save-form']) {\r\n                self.configureBindAutoSave(function(deferredSave){\r\n                    deferredSave.resolve();\r\n                });\r\n            }\r\n        }\r\n\r\n        self.buildProcessPath();\r\n        var ecmContainer = (typeof (isWebpart) !== \"undefined\") ? $(document) : $(\"#ui-bizagi-wp-app-render-form-content\");\r\n        ecmContainer.scroll(function () {\r\n            $(\".modal-ecm\", this).hide();\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Configure autoSave with callback\r\n     * @param callback\r\n     */\r\n    configureBindAutoSave: function(callback){\r\n        var self = this;\r\n\r\n        //bind event auto-save\r\n        self.autoSaveFunction = function (e, deferredSave) {\r\n            callback(deferredSave);\r\n        };\r\n\r\n        //Keeps the reference of the function required for handling autoSave\r\n        if (self.haveAutosaveAssociated()){\r\n            // Unbind previous events in order to prevent propagation //QAF-2521\r\n            $(document).unbind(\"save-form\", self.saveFormDelegate);\r\n        }\r\n        else{\r\n            self.saveFormDelegate = $.proxy(self.autoSaveFunction, self);\r\n        }\r\n        // Bind event with actual reference of form\r\n        $(document).unbind(\"save-form\").bind(\"save-form\", {idAutoSave: self.getIdentifierFormForAutosave(), functionSaveFormDelegate: self.saveFormDelegate}, self.saveFormDelegate);\r\n    },\r\n\r\n    /**\r\n     * Call from child widgets\r\n     */\r\n    unbindAutoSaveForm: function(){\r\n        var self = this;\r\n        if(self.saveFormDelegate){\r\n            $(document).unbind(\"save-form\", self.saveFormDelegate);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Get a identifier for knows if form have autoSave associated\r\n     * @returns {*}\r\n     */\r\n    getIdentifierFormForAutosave: function(){\r\n        var self = this;\r\n        return self.properties.id || self.properties.uniqueId;\r\n    },\r\n\r\n    /**\r\n     * Determine if form have autosave associated, if yes, rewrite function saveFormDelegate\r\n     * @returns {boolean}\r\n     */\r\n    haveAutosaveAssociated: function(){\r\n        var result = false;\r\n        var self = this;\r\n        var autoSaveIdentifier = self.getIdentifierFormForAutosave();\r\n        var autoSaveHandlers = $._data($(document)[0], 'events')[\"save-form\"] || [];\r\n        for(var i = 0, length = autoSaveHandlers.length; i < length; i += 1){\r\n            if(autoSaveHandlers[i].data.idAutoSave === autoSaveIdentifier){\r\n                self.saveFormDelegate = autoSaveHandlers[i].data.functionSaveFormDelegate;\r\n                result = true;\r\n                break;\r\n            }\r\n        }\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    * Auto Save Events\r\n    */\r\n    autoSaveEvents: function (deferredSave, saveBox) {\r\n        var self = this;\r\n        var data = {};\r\n        var changes = [];\r\n        var form = self.getFormContainer();\r\n        form.hasChanged(changes);\r\n\r\n        /* \r\n        *saving changes to validate or not the contents into a table\r\n        */\r\n        if (changes.length > 0) {\r\n\r\n            $.when(bizagi.showSaveBox(bizagi.localization.getResource(\"confirmation-savebox-message1\"), \"Bizagi\", \"warning\", self.properties.orientation)).done(function () {\r\n                self.collectRenderValues(data);\r\n                $.when(self.saveForm(data)).done(function () {\r\n                    //unbinding the save-form\r\n                    if (self.saveFormDelegate){\r\n                        $(document).unbind(\"save-form\", self.saveFormDelegate);\r\n                    }\r\n                    deferredSave.resolve();\r\n                });\r\n            }).fail(function (params) {\r\n                if (params == \"cancel\") {\r\n                    deferredSave.reject();\r\n                } else {\r\n                    deferredSave.resolve();\r\n\r\n                    //unbinding the save-form function in case if is still bound\r\n                    if (self.saveFormDelegate)\r\n                        $(document).unbind(\"save-form\", self.saveFormDelegate);\r\n                }\r\n            });\r\n        } else {\r\n            //unbinding the save-form function in case if is still bound\r\n            if (self.saveFormDelegate)\r\n                $(document).unbind(\"save-form\", self.saveFormDelegate);\r\n\r\n            deferredSave.resolve();\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Template method to get the buttons objects \r\n    */\r\n    getButtons: function () {\r\n        var self = this;\r\n        var container = self.container;\r\n\r\n        return $(\".ui-bizagi-button-container .ui-bizagi-button\", container);\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the container's behaviour to show layout\r\n    */\r\n    configureLayoutView: function () {\r\n        // Do nothing\r\n    },\r\n\r\n    /*\r\n    *   Dispose the class so we can detect when a class is invalid already\r\n    */\r\n    dispose: function () {\r\n        var self = this;\r\n\r\n        // Remove  the document handlers for auto-save\r\n        $(window).unbind('beforeunload', self.beforeUnloadFunction);\r\n\r\n        $(document).unbind(\"save-form\", self.saveFormDelegate);\r\n\r\n        // Call base\r\n        self._super();\r\n    },\r\n      /*\r\n    *   Submits all the form to the server and returns a deferred to check when the process finishes\r\n    */\r\n    saveForm: function(data) {\r\n        var self = this;\r\n\r\n        // Check is offline form\r\n        var isOfflineForm = bizagi.util.isOfflineForm({ context: self });\r\n\r\n        // Collect data\r\n        data = self.collectRenderValuesForSubmit(data);\r\n\r\n        // Check if there are deferreds to wait\r\n        var deferredsToWait = null;\r\n        if (data.deferreds) {\r\n            deferredsToWait = $.when.apply($, data.deferreds);\r\n            delete data.deferreds;\r\n        }\r\n\r\n        // Wait for deferreds\r\n        return $.when(deferredsToWait).pipe(function() {\r\n            self.startLoading();\r\n\r\n            // Submit the form\r\n            return self.dataService.submitData({\r\n                action: \"SAVE\",\r\n                data: data,\r\n                xpathContext: self.properties.xpathContext,\r\n                idPageCache: self.properties.idPageCache,\r\n                isOfflineForm: isOfflineForm || false\r\n            }).pipe(function() {\r\n                self.endLoading();\r\n            });\r\n        });\r\n    },\r\n    /*\r\n    * Gets changes of current navigation form\r\n    */\r\n    getChanges: function () {\r\n        var self = this;\r\n        var data = {};\r\n\r\n        if (typeof (self.collectRenderValues) != \"undefined\") {\r\n            self.collectRenderValues(data);\r\n        }\r\n\r\n        return data;\r\n    },\r\n    /*\r\n     *build path process\r\n     */\r\n    buildProcessPath: function (container) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n        var queryForm = self.getFormType() == \"queryForm\";\r\n        var summaryForm = self.params.summaryForm || false;\r\n        var globalForm = self.properties.displayAsReadOnly || false;\r\n        if (mode == \"execution\" && !queryForm && !summaryForm && !globalForm && self.properties.processPath && self.properties.processPath.length > 0) {\r\n            var template = self.renderFactory.getTemplate(\"form-process-path\");\r\n            var html = $.fasttmpl(template, {processPath: properties.processPath});\r\n            self.pathProcess = html;\r\n        } else {\r\n            self.pathProcess = \"\";\r\n        }\r\n    }\r\n});\r\n","/*\r\n*   Name: Bizagi Desktop Panel Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the panel class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from container desktop base\r\nbizagi.rendering.desktop.container.extend(\"bizagi.rendering.desktop.panel\", bizagi.rendering.panel.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.panel.extend(\"bizagi.rendering.desktop.panel\", {}, {\r\n    \r\n});\r\n","/*\r\n*   Name: Bizagi Desktop ContentPanel Extension\r\n*   Author: David Romero\r\n*   Comments:\r\n*   -   This script will redefine the content panel class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from container desktop base\r\nbizagi.rendering.desktop.container.extend(\"bizagi.rendering.desktop.contentPanel\", bizagi.rendering.contentPanel.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.contentPanel.extend(\"bizagi.rendering.desktop.contentPanel\", {}, {\r\n    \r\n});\r\n","/**\r\n *   Name: Bizagi Desktop Nested Form Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define a nested form container class for all devices\r\n */\r\n\r\n// Extends from container desktop panel base\r\nbizagi.rendering.desktop.panel.extend(\"bizagi.rendering.desktop.nestedForm\", {}, {\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour when rendering in design mode\r\n    */\r\n    configureDesignView: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var container = self.container;\r\n\r\n        container.removeClass(\"ui-bizagi-container-panel\");\r\n        container.addClass(\"ui-bizagi-container-nestedform\");\r\n\r\n        var title = $(\"<span class= 'ui-bizagi-container-nestedform-title'/>\");\r\n        title.text(\"Nested Form: \" + properties.formDisplayName);\r\n        container.prepend(title);\r\n    }\r\n});","/*\r\n*   Name: Bizagi Desktop Tab Container Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the tab class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from container desktop base\r\nbizagi.rendering.desktop.container.extend(\"bizagi.rendering.desktop.tab\", bizagi.rendering.tab.prototype);\r\n// Auto extend\r\nbizagi.rendering.desktop.tab.extend(\"bizagi.rendering.desktop.tab\", {}, {\r\n\r\n    /* \r\n    *   Template method to implement in each device to customize each container after processed\r\n    */\r\n    postRenderContainer: function (tab) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(tab);\r\n\r\n        // Apply tabs widget\r\n        tab.tabs({\r\n            active: self.activeTab,\r\n            activate: function (event, ui) {\r\n                self.children[self.activeTab].visibleTab();\r\n                // BUGFIX for grids inside tabs\r\n                setTimeout(\r\n                    function () {\r\n                        self.resize({width: self.container.width(), height: self.container.height()});\r\n                        if (typeof (self.getParams()) != \"undefined\")\r\n                            if (self.getParams().context == \"sharepoint\" || window.self !== window.top)\r\n                                self.resizeInPopUpHTML();\r\n                    }, 50);\r\n            },\r\n            beforeActivate: function (event, ui) {\r\n                var index = ui.newTab.index();\r\n\r\n                self.setActiveTab(index);\r\n            }\r\n        });\r\n\r\n        setTimeout(function () {\r\n            self.children.forEach(function (tabItem) {\r\n                var properties = tabItem.properties;\r\n                if (properties.tooltip) {\r\n                    var tabHeader$ = $(\"a[href=#ui-bizagi-tab-\" + properties.id + \"]\", tab);\r\n                    tabHeader$.tooltip({\r\n                        content: tabHeader$.attr(\"title\"),\r\n                        position: {\r\n                            at: \"center top-55\"\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n        }, 10);\r\n\r\n    },\r\n    resizeInPopUpHTML: function () {\r\n        var self = this;\r\n        if ($(\".activitiFormContainer\").length > 0) {\r\n            var heightActivitiFormContainer = $(\".activitiFormContainer\").height() || 0;\r\n            var renderForm = $(\".activitiFormContainer #ui-bizagi-webpart-render-container\");\r\n            var buttonContainer = $(\".ui-bizagi-button-container\", \".activitiFormContainer\");\r\n            var params = self.getParams();\r\n            if (params.idWorkitem || buttonContainer.length > 0) {\r\n                //display buttons\r\n                var heightButtonContainer = buttonContainer.height() || 0;\r\n                renderForm.height(heightActivitiFormContainer - 110 - heightButtonContainer);\r\n            } else {\r\n                //NOT display buttons\r\n                renderForm.height(heightActivitiFormContainer - 110);\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the container's behaviour to show layout\r\n    */\r\n    configureLayoutView: function () {\r\n        // Do nothing\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop TabItem Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the tab item class to adjust to desktop devices\r\n */\r\n\r\n// Extends from container desktop base\r\nbizagi.rendering.desktop.container.extend(\"bizagi.rendering.desktop.tabItem\", bizagi.rendering.tabItem.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.tabItem.extend(\"bizagi.rendering.desktop.tabItem\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Set tab ready deferred\r\n        self.tabReadyDeferred = new $.Deferred();\r\n        self.loadingDeferred = new $.Deferred();\r\n        self.tabActiveDeferred = new $.Deferred();\r\n    },\r\n\r\n    /* \r\n    *   Resizes the container to adjust it to the container\r\n    */\r\n    resize: function (size) {\r\n        var self = this,\r\n            container = self.container;\r\n        var width = container.width();\r\n\r\n        // Set a timeout to resize the tab only when the tab is visible\r\n        // Will try only ten times to avoid infinite cycles\r\n        var counter = 0;\r\n        var resizeTimeout = function () {\r\n            if (counter > 10) return;\r\n            if (container.is(\":visible\")) {\r\n                $.each(self.children, function (i, child) {\r\n                    child.resize({width: width});\r\n                });\r\n            } else {\r\n                counter++;\r\n                setTimeout(resizeTimeout, 200);\r\n            }\r\n        };\r\n        $.when(self.ready()).done(function () {\r\n            resizeTimeout();\r\n        });\r\n    },\r\n\r\n    /* \r\n    *   Change selected item \r\n    */\r\n    setAsActiveContainer: function (argument) {\r\n        var self = this;\r\n\r\n        $.when(self.ready()).done(function () {\r\n            // Changes item\r\n            var tabContainer = self.parent;\r\n            if (tabContainer.container.data(\"ui-tabs\")) {\r\n                tabContainer.container.tabs(\"option\", \"active\", self.container.data(\"tab-counter\"));\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Fires when the tab is selected manually\r\n    */\r\n    activate: function () {\r\n        this._super();\r\n        if (this.loadingDeferred) this.loadingDeferred.resolve();\r\n    },\r\n\r\n    /*\r\n    *   Fires when the tab is visible\r\n    */\r\n    visibleTab: function () {\r\n        if (this.tabActiveDeferred) this.tabActiveDeferred.resolve();\r\n    },\r\n\r\n    /* \r\n    *   Focus on container\r\n    */\r\n    focus: function () {\r\n        // Activate the tab if it hasn't been loaded\r\n        this.activate();\r\n\r\n        // Set this tab as an active container\r\n        this.setAsActiveContainer();\r\n\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /*\r\n    * Renders the tab content\r\n    */\r\n    renderTabContent: function (html) {\r\n        var self = this;\r\n        var properties = this.properties;\r\n\r\n        var form = self.getFormContainer();\r\n\r\n        // Render children\r\n        if (properties.loadOnDemand === undefined || properties.loadOnDemand == false || form.innerTabsLoading) {\r\n            html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n            self.tabReadyDeferred.resolve();\r\n            self.tabActiveDeferred.resolve();\r\n            return html;\r\n\r\n        } else {\r\n            // Defer execution for a while to improve first tab pkerformance\r\n            self.startLoading();\r\n\r\n            // Start a timeout, when the timeout finishes, it resolves the deferred therefore loading the tab\r\n            if (self.getMode() == \"execution\") {\r\n                setTimeout(function () {\r\n                    if (self.loadingDeferred) {\r\n                        self.loadingDeferred.resolve();\r\n                    }\r\n                }, 10500);\r\n            }\r\n\r\n            $.when(self.loadingDeferred.promise())\r\n                .done(function () {\r\n                    if (!self.isDisposed()) {\r\n                        $.when(self.parent.ready()).done(function () {\r\n                            self.replaceChildrenTag(self.container, self.renderChildrenHtml());\r\n                            self.postRenderContainer(self.container);\r\n                            self.endLoading();\r\n\r\n                            // Resolve tab deferred when tab is ready\r\n                            self.tabReadyDeferred.resolve();\r\n                            self.tabActiveDeferred.resolve();\r\n                        });\r\n                    } else {\r\n                        // Reject tab deferred when tab is not valid\r\n                        self.tabReadyDeferred.reject();\r\n                        self.tabActiveDeferred.reject();\r\n                    }\r\n                });\r\n\r\n            // Set a div in order to asynchonously resolve this\r\n            html = self.replaceChildrenHtml(html, '<div class=\"children\"/>');\r\n            return html;\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Returns promise to hold any execution until the content is ready\r\n    */\r\n    ready: function (argument) {\r\n        var self = this;\r\n\r\n        if (bizagi.util.parseBoolean(argument) && self.container && self.container.length) {\r\n            if (self.loadingDeferred) {\r\n                self.loadingDeferred.resolve();\r\n            }\r\n            $.when(self.tabReadyDeferred.promise()).done(function () {\r\n                self.activate();\r\n            });\r\n        }\r\n\r\n        if (bizagi.util.parseBoolean(argument)) {\r\n            if (!(self.container && self.container.length)) {\r\n                var id = setInterval(function () {\r\n                    if (self.container && self.container.length) {\r\n                        clearInterval(id);\r\n                        if (self.loadingDeferred) {\r\n                            self.loadingDeferred.resolve();\r\n                        }\r\n                    }\r\n                }, 50);\r\n            }\r\n        }\r\n\r\n        // Merge promises\r\n        return $.when(\r\n            self.tabReadyDeferred.promise(),\r\n            self.parent.ready(),\r\n            self.tabActiveDeferred.promise()\r\n        );\r\n    },\r\n\r\n    /* \r\n    *   Hides / Show container \r\n    */\r\n    changeVisibility: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        self._super(argument);\r\n\r\n        var tabContainer = self.parent.container;\r\n        var id = \"ui-bizagi-tab-\" + properties.id;\r\n        var header = $(\"ul li[aria-controls = '\" + id + \"']\", tabContainer);\r\n        var activeTab = self.parent.getActiveTab();\r\n\r\n        $.when(self.ready())\r\n            .done(function () {\r\n                // Hide - show the render\r\n                if (properties.visible) {\r\n                    header && header.show();\r\n                    self.setAsActiveContainer();\r\n                } else {\r\n                    if (self.getMode() === \"execution\") {\r\n                        header && header.hide();\r\n                    }\r\n                }\r\n            })\r\n            .always(function () {\r\n                if (tabContainer.data(\"ui-tabs\")) {\r\n                    tabContainer.tabs(\"option\", \"active\", activeTab);\r\n                }\r\n            });\r\n\r\n    },\r\n\r\n    afterToRefresh: function () {\r\n        this._super();\r\n        $(this.parent.container).tabs(\"refresh\");\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: Bizagi Desktop Horizontal Container Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the horizontal container class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from container desktop base\r\nbizagi.rendering.desktop.container.extend(\"bizagi.rendering.desktop.horizontal\", bizagi.rendering.horizontal.prototype);\r\n// Auto extend\r\nbizagi.rendering.desktop.horizontal.extend(\"bizagi.rendering.desktop.horizontal\", {}, {\r\n\r\n    /* \r\n    *   Template method to implement in each device to customize each container after processed\r\n    */\r\n    postRenderContainer: function (container) {\r\n        var self = this;\r\n        var children = self.children;\r\n        var iCount = children.length;\r\n\r\n        // Call base\r\n        self._super(container);\r\n\r\n        // Process each child\r\n        $.each(children, function (i, child) {\r\n            // Process width\r\n            var renderWidth = child.properties.width;\r\n            if (renderWidth == null || renderWidth.length == 0) {\r\n                // Set default size\r\n                renderWidth = 100 / iCount;\r\n            } else {\r\n                // Set custom size\r\n                renderWidth = bizagi.util.percent2Number(renderWidth);\r\n            }\r\n\r\n            (function (j, innerChild, jCount) {\r\n                $.when(innerChild.ready()).done(function () {\r\n                    var renderedElement = innerChild.getRenderedElement();\r\n                    // Set width\r\n                    if (j != (jCount - 1)) {\r\n                        renderedElement.css({ width: renderWidth + \"%\" });\r\n                    } else {\r\n                        renderedElement.css({ width: renderWidth + \"%\" });\r\n                    }\r\n\r\n                    renderedElement.addClass('ui-panel-area');\r\n\r\n                    // Set class for last render\r\n                    if (j == jCount - 1) {\r\n                        renderedElement.addClass(\"ui-bizagi-render-last\");\r\n                    }\r\n                });\r\n            })(i, child, iCount);\r\n        });\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop Layout Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the layout class to adjust to desktop devices\r\n */\r\n\r\n// Extends from container desktop base\r\nbizagi.rendering.desktop.container.extend(\"bizagi.rendering.desktop.layout\", bizagi.rendering.layout.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.layout.extend(\"bizagi.rendering.desktop.layout\", {}, {});\r\n","/*\r\n*   Name: Bizagi Desktop Accordion Container Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the accordion class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from container desktop base\r\nbizagi.rendering.desktop.container.extend(\"bizagi.rendering.desktop.accordion\", bizagi.rendering.accordion.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.accordion.extend(\"bizagi.rendering.desktop.accordion\", {}, {\r\n\r\n    /* \r\n    *   Template method to implement in each device to customize each container after processed\r\n    */\r\n    postRenderContainer: function (accordion) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(accordion);\r\n\r\n        // Apply accordion widget\r\n        // Enable accordeon\r\n        accordion.accordion({\r\n            autoHeight: false\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the container's behaviour to show layout\r\n    */\r\n    configureLayoutView: function () {\r\n        // Do nothing\r\n    }\r\n});\r\n","/*\r\n*   Name: Bizagi Desktop AccordionItem Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the accordion item class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from container desktop base\r\nbizagi.rendering.desktop.container.extend(\"bizagi.rendering.desktop.accordionItem\", bizagi.rendering.accordionItem.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.accordionItem.extend(\"bizagi.rendering.desktop.accordionItem\", {}, {\r\n\r\n    /* \r\n    *   Change selected item \r\n    */\r\n    setAsActiveContainer: function (argument) {\r\n        var self = this;\r\n    \t\r\n    \t$.when(self.ready())\r\n    \t.done(function () {\r\n            var accordionContainer = self.parent;\r\n\r\n            // Changes item\r\n            accordionContainer.container.accordion(\"option\", \"active\", self.properties.ordinal);\r\n        });\r\n    },\r\n\r\n    /* \r\n    *   Focus on container\r\n    */\r\n    focus: function () {\r\n        var self = this;\r\n\r\n    \tself.activate();\r\n        self.setAsActiveContainer();\r\n\r\n        // Call base\r\n        this._super();\r\n    }        \r\n});\r\n","/*\r\n*   Name: Bizagi Desktop Group Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the group class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from container desktop base\r\nbizagi.rendering.desktop.container.extend(\"bizagi.rendering.desktop.group\", bizagi.rendering.group.prototype);\r\n// Auto extend\r\nbizagi.rendering.desktop.group.extend(\"bizagi.rendering.desktop.group\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each container after processed\r\n     * @param {} group \r\n     * @returns {} \r\n     */\r\n    postRenderContainer: function(group) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var styleSufix = properties.orientation == \"rtl\" ? \"-rtl\" : \"\";\r\n\r\n        // Call base\r\n        self._super(group);\r\n\r\n        var icon = $(\".ui-icon\", $(\".ui-bizagi-container-group-header:first\", self.container));\r\n        var header = $(\".ui-bizagi-container-group-header\", self.container);\r\n\r\n        // Define expanded property\r\n        if (bizagi.util.parseBoolean(properties.collapse)) {\r\n            properties.expanded = false;\r\n            icon.addClass(\"ui-state-collapse\" + styleSufix).removeClass(\"ui-state-expand\" + styleSufix);\r\n        } else {\r\n            properties.expanded = true;\r\n            icon.addClass(\"ui-state-expand\" + styleSufix).removeClass(\"ui-state-collapse\" + styleSufix);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the container's behaviour to add handlers\r\n     * @returns {} \r\n     */\r\n    configureHandlers: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var styleSufix = properties.orientation == \"rtl\" ? \"-rtl\" : \"\";\r\n        var group = self.container;\r\n        var icon;\r\n\r\n        // Delegate event click\r\n        var header = $(\".ui-bizagi-container-group-header:first\", group);\r\n        $(header).click(function(e) {\r\n            if (e.preventDefault)\r\n                e.preventDefault();\r\n\r\n            icon = $(\".ui-icon\", group);\r\n            icon.toggleClass(\"ui-icon-triangle-1-s ui-icon-triangle-1-n\");\r\n\r\n            $(\".ui-bizagi-container-group-wrapper:first\", group).toggle();\r\n\r\n            if (properties.expanded) {\r\n                properties.expanded = false;\r\n                icon.addClass(\"ui-state-collapse\" + styleSufix).removeClass(\"ui-state-expand\" + styleSufix);\r\n                $(this).addClass(\"group-collapse\").removeClass(\"group-expand\");\r\n            } else {\r\n                properties.expanded = true;\r\n                icon.addClass(\"ui-state-expand\" + styleSufix).removeClass(\"ui-state-collapse\" + styleSufix);\r\n                $(this).addClass(\"group-expand\").removeClass(\"group-collapse\");\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n    * Check if group its open\r\n    * \r\n    * @return boolean\r\n    */\r\n    isOpen: function() {\r\n        if (this.properties.expanded) {\r\n            return true;\r\n        } else {\r\n            return false;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Focus on container     \r\n     * @returns {} \r\n     */\r\n    focus: function() {\r\n        // Expand container\r\n        this.expand();\r\n\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * Expands group container \r\n     * @returns {} \r\n     */\r\n    expand: function() {\r\n        var self = this;\r\n        var group = self.container;\r\n        var header = $(\".ui-bizagi-container-group-header:first\", group);\r\n\r\n        if (!self.isOpen())\r\n            $(header).trigger(\"click\");\r\n    },\r\n\r\n    /**\r\n     * Collapses group container \r\n     * @returns {} \r\n     */\r\n    collapse: function() {\r\n        var self = this;\r\n        var group = self.container;\r\n        var header = $(\".ui-bizagi-container-group-header:first\", group);\r\n\r\n        if (self.isOpen())\r\n            $(header).trigger(\"click\");\r\n    },\r\n\r\n    /**     \r\n     * Expands or collapse the container \r\n     * @param {} argument      \r\n     */\r\n    toogleContainer: function(argument) {\r\n        var self = this;\r\n\r\n        if (argument) {\r\n            self.expand();\r\n        } else {\r\n            self.collapse();\r\n        }\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop SearchForm Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the search form class to adjust to desktop devices\r\n */\r\n\r\n// Extends from container desktop form base\r\nbizagi.rendering.desktop.form.extend(\"bizagi.rendering.desktop.searchForm\", bizagi.rendering.searchForm.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.searchForm.extend(\"bizagi.rendering.desktop.searchForm\", {}, {\r\n\r\n    /*\r\n    *   Render the results of the query\r\n    *   Resolved in each device\r\n    */\r\n    renderResult: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Creates grid definition\r\n        var data = {};\r\n        data.properties = {\r\n            displayName: self.getResource(\"render-search-advanced-results-label\"),\r\n            type: 'grid',\r\n            xpath: 'searchForm' + properties.id,\r\n            id: properties.id,\r\n            skipInitialLoad: true,\r\n            rowsPerPage: 10,\r\n            inlineAdd: false,\r\n            allowDelete: false,\r\n            allowAdd: false,\r\n            hideActionsColumn: true,\r\n            floatingHeader: true, \r\n            sortBy: properties.sortBy,\r\n            sortOrder: properties.sortOrder,\r\n            overrideGetRemoteData: function (params) {\r\n                return self.getRemoteData(params);\r\n            }\r\n        };\r\n\r\n        data.elements = [];\r\n\r\n        // Creates columns\r\n        var columns = properties.columns;\r\n        $.each(columns, function (i) {\r\n            var column = {\r\n                render: {}\r\n            };\r\n            //TODO insert dataType and TextFormat properties\r\n            column.render.properties = {\r\n                displayName: columns[i].caption,\r\n                xpath: columns[i].xpath,\r\n                editable: false\r\n            };\r\n            $.extend(column.render.properties, self.parseAdditionalProperties(columns[i].dataType));\r\n            // Next conditional added to print only columns and not labels\r\n            // if type = label then column is not rendered on the results table\r\n            if (columns[i].dataType == 0) {\r\n                column.render.properties.columnVisible = false;\r\n            }\r\n            //if column is number or monetary push allowDecimals property\r\n            if (columns[i].dataType == 7 || columns[i].dataType == 8) {\r\n                column.render.properties.allowDecimals = columns[i].allowDecimals;\r\n            }\r\n\r\n            //if column is real or float set allowDecimals property to true\r\n            if (columns[i].dataType == 10 || columns[i].dataType == 11) column.render.properties.allowDecimals = true;\r\n\r\n            //if column is date push showtime property\r\n            if (columns[i].dataType == 12) {\r\n                column.render.properties.showTime = columns[i].showTime;\r\n            }\r\n\r\n            data.elements.push(column);\r\n        });\r\n\r\n        var grid = self.renderFactory.getRender({\r\n            type: \"grid\",\r\n            data: data,\r\n            parent: self,\r\n            mode: self.getMode(),\r\n            jqgrid: false\r\n        });\r\n\r\n        // Saves reference\r\n        self.resultsGrid = grid;\r\n\r\n        return grid.render();\r\n    },\r\n\r\n    /*\r\n    *   Template method to process each jquery object\r\n    *   must be overriden in each container\r\n    */\r\n    postRenderContainer: function (container) {\r\n        var self = this;\r\n        var searchCriteria = container.find(\".ui-bizagi-container-search-criteria\");\r\n        var results = container.find(\".ui-bizagi-container-search-results\");\r\n        var childrenElements = searchCriteria.children();\r\n        var mode = self.getMode();\r\n\r\n        // Process children elements\r\n        self.container = container;\r\n        $.each(childrenElements, function (i, childElement) {\r\n            childElement = $(childElement);\r\n            var id = Number(childElement.data(\"unique-id\"));\r\n            if (id) {\r\n                var child = self.childrenHash[id];\r\n                if (child) {\r\n                    var type = child.getElementType();\r\n                    if (type == bizagi.rendering.element.ELEMENT_TYPE_RENDER) child.postRenderElement(childElement);\r\n                    if (type == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) child.postRenderContainer(childElement);\r\n                }\r\n            }\r\n        });\r\n\r\n        // Process result\r\n        var grid = $(results.children()[0]);\r\n        self.resultsGrid.postRenderElement(grid);\r\n\r\n        if (mode == \"execution\") {\r\n            // Apply handlers\r\n            self.configureHandlers();\r\n        }\r\n        if (mode == \"design\") {\r\n            // Configure view\r\n            self.configureDesignView();\r\n        }\r\n        if (mode == \"layout\") {\r\n            // Configure view\r\n            self.configureDesignView();\r\n            self.configureLayoutView();\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the container's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        // Saves reference\r\n        self.criteriaContainer = $(\".ui-bizagi-container-search-criteria\", self.container);\r\n        self.resultsContainer = $(\".ui-bizagi-container-search-results\", self.container);\r\n\r\n        // Bind to grid row select event\r\n        self.resultsGrid.bind(\"rowSelected\", function (e, ui) {\r\n            if (self.properties.searchParams.hasOwnProperty('multiSelect')) {\r\n                self.trigger(\"multiSelect\", ui);\r\n            } else {\r\n                // Trigger event to bubble up to main container\r\n                self.trigger(\"instanceSelected\", ui);\r\n            }\r\n        });\r\n\r\n        return self;\r\n    },\r\n\r\n    /*\r\n    *   Refresh the result panel, making it to query data with current criteria\r\n    */\r\n    refreshResults: function () {\r\n        var self = this;\r\n        var resultsGrid = self.resultsGrid;\r\n\r\n        // Makes the grid to refresh\r\n        resultsGrid.refresh();\r\n        $.when(resultsGrid.dataReady())\r\n            .done(function () {\r\n\r\n                // Shows result container\r\n                self.resultsContainer.show();\r\n\r\n                self.resizeResults();\r\n            });\r\n    },\r\n\r\n    /* \r\n    *   Resizes the container to adjust it to the container\r\n    */\r\n    resize: function () {\r\n        var self = this;\r\n        // Resize results\r\n        self.resizeResults();\r\n    },\r\n\r\n    /* \r\n    Resizes the container to split the view\r\n    */\r\n    resizeResults: function () {\r\n        var self = this;\r\n        var resultsGrid = self.resultsGrid;\r\n\r\n        if (self.resultsContainer.is(':visible')) {\r\n            self.criteriaContainer.height(\"auto\");\r\n\r\n        } else {\r\n            self.criteriaContainer.height(\"100%\");\r\n        }\r\n\r\n        // Resize grid results\r\n        resultsGrid.resize({\r\n            width: self.criteriaContainer.width(),\r\n            onSearchFinished: function () {\r\n                var self = this;\r\n                if (self.properties)\r\n                    if (self.properties.records == 0) {\r\n                        $(\".ui-bizagi-container-search-results\", self.container).show();\r\n                        $(\".ui-bizagi-container-search-results .ui-jqgrid-title\", self.container).hide();\r\n                    } else {\r\n                        $(\".ui-bizagi-container-search-results .ui-jqgrid-title\", self.container).show();\r\n                    }\r\n            }\r\n        });\r\n    }\r\n});","/**\r\n *   Name: Bizagi Desktop Render Text Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the text render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.text\", bizagi.rendering.text.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.text.extend(\"bizagi.rendering.desktop.text\", {}, {\r\n\r\n    /**\r\n     *   Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        // Call base\r\n        this._super();\r\n\r\n        // Define max length of element\r\n        if (this.properties.maxLength > 0)\r\n            this.input.attr(\"maxlength\", this.properties.maxLength);\r\n    },\r\n\r\n    /**\r\n     *   Sets the value in the rendered control\r\n     * @param {} value\r\n     * @returns {}\r\n     */\r\n    setDisplayValue: function (value) {\r\n        // Call base\r\n        this._super(value);\r\n\r\n        // Set value in input\r\n        if (!bizagi.util.isEmpty(value) && this.properties.editable) {\r\n            this.input && this.input.val(value);\r\n        } else {\r\n            if (value === null && this.properties.editable) {\r\n                this.input && this.input.val(\"\");\r\n            }\r\n        }\r\n    },\r\n\r\n    attachRetypeDouble: function () {\r\n        var self = this;\r\n        var element = self.element;\r\n\r\n        var input = $(\"input\", element);\r\n        if (!input || input.length == 0) return;\r\n\r\n        // Apply blur handler to check value\r\n        input.blur(function () {\r\n            var control = $(this);\r\n            self.retypeDouble(control);\r\n        });\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n        control.tooltip({disabled: true});\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) == true && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) == true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    retypeDouble: function (control) {\r\n        var self = this;\r\n        var currentValue = control.val();\r\n        var isVisible = $(control).attr(\"type\") !== \"hidden\" && $(control).css(\"display\") !== \"none\" && $(control).css(\"visibility\") !== \"hidden\";\r\n\r\n        if (isVisible && $(this).data(\"newValue\") == undefined) {\r\n\r\n            if (!control.data(\"oldValue\") || $(this).data(\"oldValue\") === \"\") {\r\n                // Check that there is something in the value or if a value has already been set\r\n                if (currentValue === \"\" || currentValue === control.data(\"newValue\")) return;\r\n\r\n                self.createTooltip(control, currentValue, self.getResource(\"render-number-retype\"))\r\n            } else {\r\n                // Check that there is something in the value\r\n                if (currentValue === \"\") return;\r\n\r\n                if (currentValue != control.data(\"oldValue\")) {\r\n                    self.setValue(\"\");\r\n\r\n                    self.createTooltip(control, \"\", self.getResource(\"render-text-retype-error\"))\r\n                } else {\r\n                    control.data(\"newValue\", currentValue);\r\n                    control.data(\"oldValue\", \"\");\r\n\r\n                    // Destroy tooltips\r\n                    control.tooltip(\"destroy\");\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n\r\n        // Add the render value\r\n        var xpath = self.properties.xpath;\r\n\r\n        // replace strange character\r\n        var value = self.getValue();\r\n\r\n        if (value != null && typeof (value) !== \"undefined\" && typeof (value) !== \"number\") {\r\n            value = value.replaceAll(String.fromCharCode(\"030\"), '');\r\n            value = value.replaceAll(String.fromCharCode(\"018\"), '');\r\n            value = value.replaceAll(String.fromCharCode(\"016\"), '');\r\n        }\r\n\r\n        if (self.controlValueIsChanged()) {\r\n            // Filter by valid xpaths and valid values\r\n            if (!bizagi.util.isEmpty(xpath)) {\r\n                if (!bizagi.util.isEmpty(value)) {\r\n                    renderValues[xpath] = value;\r\n                } else if (value === \"\") {\r\n                    renderValues[xpath] = \"\";\r\n                }\r\n            }\r\n        }\r\n\r\n        //Validate if the input has a retype configured and check that both values matches, oterwise delete the original value\r\n        if (!self.validateInputRetype()) {\r\n            renderValues[self.properties.xpath] = \"\";\r\n        }\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: Bizagi Desktop Render Text Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the text render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.extendedText\", bizagi.rendering.extendedText.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.extendedText.extend(\"bizagi.rendering.desktop.extendedText\", {\r\n\r\n    //#region Side effects functions\r\n\r\n    /**\r\n     * Is triggered after the control exists in the DOM\r\n     */\r\n    postRender: function () {\r\n        this._super();\r\n\r\n        if (bizagi.util.isIE8()) {\r\n            this.textarea.attr(\"cols\", \"5000\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Is triggered after the control exists in the DOM when it's readonly\r\n     */\r\n    postRenderReadOnly: function () {\r\n        $(this.getControl()).addClass(\"ui-bizagi-text-extended-readonly\");\r\n    },\r\n\r\n    /**\r\n     *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Define max length of element\r\n        if (properties.maxLength > 0) {\r\n\r\n            self.textarea.attr(\"maxlength\", properties.maxLength);\r\n            self.actualMaxLength = properties.maxLength;\r\n\r\n        }\r\n\r\n        self.ready().done(function () {\r\n            // auto extend\r\n            if (properties.autoExtend) {\r\n                var value = \"\";\r\n                var minHeight = self.textarea.css(\"height\");\r\n                var valMinHeight;\r\n\r\n\r\n                if (properties.maxLines === undefined) {\r\n                    if (typeof minHeight == \"string\" && minHeight.search(\"px\") !== -1) {\r\n                        valMinHeight = Number(minHeight.split(\"px\")[0]);\r\n\r\n                        if (valMinHeight <= 150)\r\n                            minHeight = \"150px\";\r\n                    } else {\r\n                        minHeight = \"150px\";\r\n                    }\r\n                }\r\n\r\n                // set textarea styles\r\n                self.textarea.css({overflow: \"hidden\", resize: \"none\", minHeight: minHeight});\r\n\r\n                setTimeout(function () {\r\n                    self.changeHeightAutoExtended(self.textarea[0]);\r\n                }, 100);\r\n\r\n                self.textarea.bind(\"keyup\", function () {\r\n                    self.changeHeightAutoExtended(this);\r\n                });\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     *   Sets the value in the rendered control\r\n     * @param {} value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var decodedValue = bizagi.util.decodeURI(value);\r\n        value = this.validateValue((typeof (decodedValue) == \"string\" ? decodedValue : \"\"), self.properties.maxLength);\r\n\r\n        // Call base\r\n        self.setValue(value);\r\n        this._super(value);\r\n\r\n        // Set value in input\r\n        var resolvedValue = $.br2nl(value);\r\n        if (self.textarea) self.textarea.val(resolvedValue);\r\n    },\r\n\r\n    /**\r\n     * Gets control's value\r\n     * @param {} renderValues\r\n     */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Add the render value\r\n        var xpath = properties.xpath;\r\n\r\n        // replace strange character\r\n        var value = self.getValue();\r\n\r\n        if (self.getValue() != null && typeof (self.getValue()) != \"undefined\") {\r\n            value = self.getValue().replaceAll(String.fromCharCode(\"030\"), '');\r\n            value = self.getValue().replaceAll(String.fromCharCode(\"018\"), '');\r\n            value = self.getValue().replaceAll(String.fromCharCode(\"016\"), '');\r\n        }\r\n\r\n        if ($.controlValueIsChanged(self)) {\r\n            // Filter by valid xpaths and valid values\r\n            if (!bizagi.util.isEmpty(xpath)) {\r\n                if (!bizagi.util.isEmpty(value)) {\r\n                    renderValues[xpath] = value;\r\n                } else if (value === \"\") {\r\n                    renderValues[xpath] = \"\";\r\n                }\r\n            }\r\n        }\r\n\r\n        //Validate if the input has a retype configured and check that both values matches, oterwise delete the original value\r\n        if (!self.validateInputRetype()) {\r\n            renderValues[properties.xpath] = \"\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Cleans current value\r\n     */\r\n    cleanData: function () {\r\n        this.setValue(\"\");\r\n        this.clearDisplayValue();\r\n    },\r\n\r\n    /**\r\n     *   Sets the value in the rendered control\r\n     */\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var input = control.find(\"textarea\");\r\n\r\n        if (input.length > 0) {\r\n            input.val(self.getValue());\r\n        }\r\n    },\r\n\r\n    /**\r\n     * function virtual implements on children (desktop,smartphone...)\r\n     */\r\n    attachRetypeDouble: function () {\r\n        var self = this;\r\n        var element = self.element;\r\n\r\n        var input = $(\"input, textarea\", element);\r\n        if (!input || input.length == 0) return;\r\n\r\n        // Apply blur handler to check value\r\n        input.blur(function () {\r\n            var control = $(this);\r\n            var previousValue = self.previousValue;\r\n            var value = self.value;\r\n\r\n            if (previousValue != null && value != previousValue) {\r\n                if ($(this).data(\"newValue\") != undefined && control.val() != $(this).data(\"newValue\"))\r\n                    $(this).data().newValue = undefined;\r\n            }\r\n\r\n            self.retypeDouble(control);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Changes required status\r\n     * @param {} argument\r\n     */\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    /**\r\n     * Changes label's required status\r\n     * @param {} argument\r\n     */\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) == true && this.properties.editable) {\r\n                    control.addClass('control-required');\r\n                } else {\r\n                    control.removeClass('control-required');\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) == true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass('control-required');\r\n                } else {\r\n                    control.removeClass('control-required');\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    /**\r\n     * Changes cell's required status\r\n     * @param {} argument\r\n     */\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    /**\r\n     * Validates the double value from retype\r\n     * @param {jQuery Object} control jQuery Object\r\n     */\r\n    retypeDouble: function (control) {\r\n        var self = this;\r\n        var currentValue = control.val();\r\n        var isVisible = $(control).attr(\"type\") != \"hidden\" && $(control).css(\"display\") != \"none\" && $(control).css(\"visibility\") != \"hidden\";\r\n\r\n        if (isVisible && $(this).data(\"newValue\") == undefined) {\r\n\r\n            if (!control.data(\"oldValue\") || $(this).data(\"oldValue\") == \"\") {\r\n                // Check that there is something in the value or if a value has already been set\r\n                if (currentValue == \"\" || currentValue == control.data(\"newValue\")) return;\r\n\r\n                self.createTooltip(control, currentValue, self.getResource(\"render-number-retype\"))\r\n            } else {\r\n                // Check that there is something in the value\r\n                if (currentValue == \"\") return;\r\n\r\n                if (currentValue != control.data(\"oldValue\")) {\r\n                    self.setValue(\"\");\r\n                    self.createTooltip(control, \"\", self.getResource(\"render-text-retype-fail\"))\r\n                } else {\r\n                    control.data(\"newValue\", currentValue);\r\n                    control.data(\"oldValue\", \"\");\r\n                    // Destroy tooltips\r\n                    control.tooltip(\"destroy\");\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Changes control's height when it's auto extended\r\n     * @param {Object} control HTML Object\r\n     */\r\n    changeHeightAutoExtended: function (control) {\r\n        control.style.removeProperty(\"height\");\r\n        control.style.height = control.scrollHeight < (this.properties.maxLines * 20) ? (this.properties.maxLines * 20) : control.scrollHeight + \"px\";\r\n    },\r\n\r\n    //#endregion Side effects functions\r\n});\r\n","/*\r\n*   Name: Bizagi Desktop Render Label Extension\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will redefine the label render class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.label\", bizagi.rendering.label.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.label.extend(\"bizagi.rendering.desktop.label\", {}, {\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     */\r\n    renderReadOnly: function() {\r\n        this.setValue(this.properties.displayName);\r\n        return this._super();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed     \r\n     */\r\n    postRender: function() {\r\n        // Apply a css class\r\n        this.getLabel().addClass(\"ui-bizagi-render-label\");\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values     \r\n     */\r\n    postRenderReadOnly: function() {\r\n        // Apply a css class\r\n        this.getLabel().addClass(\"ui-bizagi-render-label\");\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: BizAgi Desktop Render Query Label Extension\r\n *   Author: Paola Herrera\r\n *   Comments:\r\n *   -   This script will redefine the number render class to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.label.extend(\"bizagi.rendering.desktop.queryLabel\", {}, {\r\n\r\n});\r\n","/*\r\n*   Name: Bizagi Desktop Render Number Extension\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will redefine the number render class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.number\", bizagi.rendering.number.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.number.extend(\"bizagi.rendering.desktop.number\", {}, {\r\n\r\n    /**\r\n     *   Sets the value in the rendered control\r\n     * @param {} value\r\n     * @returns {}\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(value);\r\n\r\n        // Set value in input\r\n        if (value != null && self.properties.editable) {\r\n            self.numericInput.val(value);\r\n\r\n            self.value = self.properties.value = value;\r\n\r\n            // Formats the input\r\n            self.executeFormatCurrencyPlugin();\r\n        }\r\n    },\r\n\r\n    attachRetypeDouble: function () {\r\n        var self = this;\r\n        var element = self.element;\r\n\r\n        var input = $(\"input\", element);\r\n        if (!input || input.length === 0) return;\r\n\r\n        // Apply blur handler to check value\r\n        input.blur(function () {\r\n            var control = $(this);\r\n            var previousValue = self.previousValue;\r\n            var value = self.value;\r\n            var typeControl = self.parent.properties.type;\r\n\r\n            if (typeControl === \"grid\") {\r\n                if (previousValue != null && value !== previousValue) {\r\n                    if ($(this).data(\"newValue\") !== undefined && control.val() !== $(this).data(\"newValue\")) {\r\n                        $(this).data().newValue = undefined;\r\n                    }\r\n                }\r\n                self.retypeDouble(control);\r\n            } else {\r\n                self.retypeDouble(control);\r\n            }\r\n        });\r\n    },\r\n\r\n    retypeDouble: function (control) {\r\n        var self = this;\r\n        var currentValue = control.val();\r\n        var isVisible = $(control).attr(\"type\") !== \"hidden\" && $(control).css(\"display\") !== \"none\" && $(control).css(\"visibility\") !== \"hidden\";\r\n\r\n        if (isVisible && $(this).data(\"newValue\") === undefined) {\r\n\r\n            if (!control.data(\"oldValue\") || $(this).data(\"oldValue\") === \"\") {\r\n\r\n                // Check that there is something in the value or if a value has already been set\r\n                if (currentValue === \"\" || currentValue === control.data(\"newValue\"))\r\n                    return;\r\n\r\n                self.createTooltip(control, currentValue, self.getResource(\"render-number-retype\"))\r\n            } else {\r\n                // Check that there is something in the value\r\n                if (currentValue === \"\") return;\r\n\r\n                if (currentValue !== control.data(\"oldValue\")) {\r\n                    self.setValue(\"\");\r\n\r\n                    self.createTooltip(control, \"\", self.getResource(\"render-text-retype-error\"))\r\n                } else {\r\n                    control.data(\"newValue\", control.val());\r\n                    control.data(\"oldValue\", \"\");\r\n\r\n                    try {\r\n                        // Destroy tooltips\r\n                        control.tooltip(\"destroy\");\r\n                    } catch (e) {\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) === true && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) === true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    }\r\n\r\n});","/*\r\n *   Name: BizAgi Desktop Render Query Number Extension\r\n *   Author: Paola Herrera\r\n *   Comments:\r\n *   -   This script will redefine the number render class to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.number.extend(\"bizagi.rendering.desktop.queryNumber\", {}, {\r\n\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function(value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        this._super(value);\r\n        if (value !== null && properties.editable) {\r\n            self.setValue(self.numericInput.asNumber({\r\n                symbol: properties.symbol,\r\n                positiveFormat: properties.positiveFormat,\r\n                negativeFormat: properties.negativeFormat,\r\n                decimalSymbol: properties.decimalSymbol,\r\n                digitGroupSymbol: properties.digitGroupSymbol,\r\n                groupDigits: properties.groupDigits\r\n            }));\r\n        }\r\n    }\r\n});\r\n\r\n","/*\r\n *   Name: Bizagi Desktop Render Date Extension\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will redefine the Date render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render smartphone base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.date\", bizagi.rendering.date.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.date.extend(\"bizagi.rendering.desktop.date\", {}, {\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n\t\tinitializeData: function(data) {\r\n        var self = this;\r\n\r\n        self.i18n = bizagi.localization.getResource(\"datePickerRegional\");\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = self.properties;\r\n\r\n        // Fix dateFormat for datepicker\r\n        var dateFormat = self.getDateFormat(properties.dateFormat);\r\n\r\n        properties.datePickerFormat = dateFormat.datePickerFormat;\r\n        properties.timePickerFormat = dateFormat.timePickerFormat;\r\n    },\r\n\r\n    /**\r\n     * Translate standar date format to jquery date picker\r\n     *\r\n     */\r\n\t\tgetDateFormat: function(format) {\r\n        var datePickerFormat = format;\r\n        var timePickerFormat = undefined;\r\n        var init;\r\n\r\n        var properties = this.properties;\r\n\r\n        if (format.search(\"h\") != -1 || format.search(\"H\") != -1) {\r\n            if (format.search(\"h\") != -1) {\r\n                init = format.search(\"h\");\r\n            } else {\r\n                init = format.search(\"H\");\r\n            }\r\n\r\n            datePickerFormat = format.substring(0, init - 1);\r\n            timePickerFormat = format.substr(init);\r\n        }\r\n\r\n        // Fix month\r\n        if (datePickerFormat.indexOf(\"MMMM\") >= 0) {\r\n            datePickerFormat = datePickerFormat.replaceAll(\"MMMM\", \"MM\");\r\n        } else if (datePickerFormat.indexOf(\"MMM\") >= 0) {\r\n            // Month name short\r\n            datePickerFormat = datePickerFormat.replaceAll(\"MMM\", \"M\");\r\n        } else if (datePickerFormat.indexOf(\"MM\") >= 0) {\r\n            // Month two digits\r\n            datePickerFormat = datePickerFormat.replaceAll(\"MM\", \"mm\");\r\n        } else if (datePickerFormat.indexOf(\"M\") >= 0) {\r\n            // Month one digits\r\n            datePickerFormat = datePickerFormat.replaceAll(\"M\", \"m\");\r\n        }\r\n\r\n        // Fix years\r\n        if (datePickerFormat.search(\"yyyy\") != -1) {\r\n            datePickerFormat = datePickerFormat.replaceAll(\"yyyy\", \"yy\");\r\n        } else {\r\n            if (datePickerFormat.search(\"yy\") != -1) {\r\n                datePickerFormat = datePickerFormat.replaceAll(\"yy\", \"y\");\r\n            }\r\n        }\r\n\r\n        datePickerFormat = datePickerFormat.replaceAll(\"dddd\", \"DD\"); // Fix days\r\n\r\n        return { datePickerFormat: datePickerFormat, timePickerFormat: timePickerFormat };\r\n    },\r\n\r\n\t\tgetElementsToStylize: function(context) {\r\n        var children = $(context).children();\r\n        if (children.length) {\r\n            return children;\r\n        } else {\r\n            return $(context);\r\n        }\r\n    },\r\n\r\n\t\tgetTimePickerFormat: function(timeFormat) {\r\n        var i = 0;\r\n        var c;\r\n\r\n        // Define return object\r\n        var returnObj = {\r\n            show24Hours: false,\r\n            showSeconds: false,\r\n            showZeroInHour: true, // True to show 0 when hour < 10\r\n            separator: \":\"\r\n        };\r\n\r\n        // Analize format\r\n        var token, lastToken = \"\";\r\n\r\n        while (i < timeFormat.length) {\r\n            // Get next token from format string\r\n            c = timeFormat.charAt(i);\r\n            token = \"\";\r\n            while ((timeFormat.charAt(i) == c) && (i < timeFormat.length)) {\r\n                token += timeFormat.charAt(i++);\r\n            }\r\n\r\n            // Extract contents of value based on format token\r\n            if (token == \"hh\" || token == \"h\") {\r\n                lastToken = token;\r\n                returnObj.show24Hours = false;\r\n                returnObj.showZeroInHour = token == \"h\" ? false : true;\r\n            } else if (token == \"HH\" || token == \"H\") {\r\n                lastToken = token;\r\n                returnObj.show24Hours = true;\r\n                returnObj.showZeroInHour = token == \"H\" ? false : true;\r\n            } else if (token == \"mm\" || token == \"m\") {\r\n                lastToken = token;\r\n            } else if (token == \"ss\" || token == \"s\") {\r\n                lastToken = token;\r\n                returnObj.showSeconds = true;\r\n            } else if (token == \"a\") {\r\n                lastToken = token;\r\n            } else if (lastToken.toUpperCase() == \"H\" || lastToken.toUpperCase() == \"HH\") {\r\n                returnObj.separator = token;\r\n            } else if (lastToken.toUpperCase() == \"S\" || lastToken.toUpperCase() == \"SS\") {\r\n                lastToken = token;\r\n                returnObj.ampmPrefix = token;\r\n            }\r\n        }\r\n\r\n        return returnObj;\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n\t\tpostRender: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var timeControl = self.getTimeControl();\r\n        var dateControl = self.getDateControl();\r\n        var dateContainer = dateControl.parent();\r\n\r\n        // Call base\r\n        this._super();\r\n\r\n        var maxUndefinedYear = parseInt(new Date().getFullYear() + 200).toString();\r\n        var minUndefinedYear = parseInt(new Date().getFullYear() - 200).toString();\r\n\r\n        if (typeof properties.maxValue == \"undefined\") properties.maxValue = \"12/31/\" + maxUndefinedYear + \" 00:00:00\"; //Current year + 200 IE or 9999\r\n        if (typeof properties.minValue == \"undefined\") properties.minValue = \"01/01/\" + minUndefinedYear + \" 00:00:00\"; //Current year - 200 IE or 1753 for SQL Server compat\r\n\r\n        // Apply timeEntry plugin\r\n        if (properties.showTime) {\r\n            if (self.getMode() == \"execution\")\r\n\t\t\t\t\twindow.setTimeout(function() {\r\n                    if (dateControl.parent() && timeControl.parent()) {\r\n                        // RTL adjustments when timecontrol is present\r\n                        if (properties.orientation == \"rtl\") {\r\n                            self.getTimeControl().css(\"paddingLeft\", \"0px\");\r\n                            self.getTimeControl().css(\"paddingRight\", \"4px\");\r\n                        }\r\n                    }\r\n                }, 0);\r\n\r\n            var timeFormatProperties;\r\n\r\n            if (properties.timePickerFormat !== undefined) {\r\n                timeFormatProperties = self.getTimePickerFormat(properties.timePickerFormat);\r\n            } else {\r\n                timeFormatProperties = bizagi.util.dateFormatter.analyzeTimeFormat(properties.timeFormat);\r\n            }\r\n\r\n            timeControl.timeEntry({\r\n                spinnerTexts: [\r\n                    this.getResource(\"render-timeentry-now\"),\r\n                    this.getResource(\"render-timeentry-previous-field\"),\r\n                    this.getResource(\"render-timeentry-next-field\"),\r\n                    this.getResource(\"render-timeentry-increment\"),\r\n                    this.getResource(\"render-timeentry-decrement\")\r\n                ],\r\n                showSeconds: timeFormatProperties.showSeconds,\r\n                show24Hours: timeFormatProperties.show24Hours,\r\n                separator: timeFormatProperties.separator,\r\n                ampmPrefix: timeFormatProperties.ampmPrefix || \"\",\r\n                useMouseWheel: self.getMode() == \"execution\",\r\n                showZeroInHour: timeFormatProperties.showZeroInHour\r\n            });\r\n\r\n            // DEPL: Fix plugin without touching it\r\n            // The plugin is setting the image as an inline style,\r\n            // that means that we can't set it in the css files,\r\n            // so we remove the inline style, and the css will do the rest\r\n            $(\".timeEntry_control\", timeControl)\r\n                .css(\"height\", \"\")\r\n                .css(\"width\", \"\")\r\n                .css(\"display\", \"\")\r\n                .css(\"background-color\", \"\")\r\n                .css(\"background-image\", \"\")\r\n                .css(\"background-position\", \"\")\r\n                .css(\"background-repeat\", \"\");\r\n        }\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n\t\tconfigureHandlers: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var dateControl = self.getDateControl();\r\n        var dateIcon = self.getDateIcon();\r\n        var initYear = 100;\r\n        var endYear = 30;\r\n\r\n        if (!isNaN(Date.parse(properties.minValue))) {\r\n            initYear = new Date().getFullYear() - $.datepicker.parseDate(\"mm/dd/yy\", properties.minValue).getFullYear() || 100;\r\n        }\r\n\r\n        if (!isNaN(Date.parse(properties.maxValue))) {\r\n            endYear = $.datepicker.parseDate(\"mm/dd/yy\", properties.maxValue).getFullYear() - new Date().getFullYear() || 100;\r\n        }\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Set datepicker i18n\r\n        $.datepicker.setDefaults(self.i18n);\r\n\r\n        var options = {\r\n            firstDay: bizagi.override.firstDay || 0,\r\n            yearRange: \"c-\" + initYear + \":c+\" + endYear,\r\n            dateFormat: properties.datePickerFormat,\r\n            changeYear: true,\r\n            changeMonth: true,\r\n            shortYearCutoff: typeof BIZAGI_DEFAULT_DATETIME_INFO != \"undefined\" && typeof BIZAGI_DEFAULT_DATETIME_INFO.twoDigitYearMaxDelta != \"undefined\" ? \"+\" + BIZAGI_DEFAULT_DATETIME_INFO.twoDigitYearMaxDelta : \"+50\",\r\n\t\t\t\tbeforeShow: function() {\r\n                // Set min & max value\r\n                self.properties.editable = true;\r\n                self.changeMinValue(self.properties.minValue);\r\n                self.changeMaxValue(self.properties.maxValue);\r\n                self.setDisplayValue(self.getValue());\r\n\r\n                $(\"#content-wrapper, .bz-rn-grid-data-wraper, .ui-bizagi-dialog-search\").on(\"scroll.datecontrol\", function(e) {\r\n                    $(\".ui-bizagi-render-date\").datepicker(\"hide\");\r\n                });\r\n            },\r\n\t\t\t\tonClose: function() {\r\n                $(\"#content-wrapper, .bz-rn-grid-data-wraper, .ui-bizagi-dialog-search\").off(\"scroll.datecontrol\");\r\n\r\n                if (bizagi.util.isIE()) {\r\n                    window.setTimeout(function (event) {\r\n\t\t\t\t\t\t\t\t$(event).datepicker(\"enable\");\r\n                    }.bind(undefined, this), 500);\r\n                }\r\n            }\r\n        };\r\n\r\n        if (bizagi.util.isIE()) {\r\n            options = $.extend(options, {\r\n\t\t\t\t\tonSelect: function() {\r\n                    $(this).datepicker(\"disable\");\r\n\r\n                    self.getLabel().focus();\r\n                    $(this).change();\r\n                }\r\n            });\r\n        }\r\n\r\n        // Apply datepicker & mask plugin\r\n        dateControl.datepicker(options);\r\n\r\n        // Bind to change event to detect if the user clears the text\r\n\t\t\tdateControl.bind(\"change\", function() {\r\n            var value = dateControl.val();\r\n\r\n            if (bizagi.util.isEmpty(value)) {\r\n                self.setValue(\"\");\r\n            } else if (value.match(/\\d{5,}/)) {\r\n                self.setDisplayValue(self.getDisplayValue());\r\n            } else {\r\n\r\n                var format = self.properties.dateFormat.substring(0, self.properties.dateFormat.search(\"h|H\") != -1 ? self.properties.dateFormat.search(\"h|H\") - 1 : self.properties.dateFormat.length);\r\n\r\n                if (bizagi.util.dateFormatter.getDateFromFormat(value, format.replace((/'\\D+\\.'$/i),\"\"), self.i18n) == 0) {\r\n                    self.setValue(\"\");\r\n                    dateControl.val(\"\");\r\n                }\r\n            }\r\n        });\r\n\r\n        //set the focus on the input when the icon is clicked\r\n\t\t\tdateIcon.bind(\"click\", function() {\r\n            dateControl.focus();\r\n        });\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour when rendering in design mode\r\n    */\r\n\t\tconfigureDesignView: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        if (properties.showTime) {\r\n            control.find(\".timeEntry_control\").unbind(\"mousedown\");\r\n            control.find(\".timeEntry_control\").unbind(\"mouseup\");\r\n            control.find(\".timeEntry_control\").unbind(\"mouseover\");\r\n            control.find(\".timeEntry_control\").unbind(\"mousemove\");\r\n        }\r\n    },\r\n    /*\r\n    *   Gets the date control\r\n    */\r\n\t\tgetDateControl: function() {\r\n        var self = this;\r\n        self.dateControl = $(\".ui-bizagi-render-date\", self.getControl());\r\n        return self.dateControl;\r\n    },\r\n    /*\r\n    *   Gets the date icon\r\n    */\r\n\t\tgetDateIcon: function() {\r\n        var self = this;\r\n        self.dateIcon = $(\".ui-bizagi-wp-app-icon-date\", self.getControl());\r\n        return self.dateIcon;\r\n    },\r\n    /*\r\n    *   Gets the time control\r\n    */\r\n\t\tgetTimeControl: function() {\r\n        var self = this;\r\n        self.timeControl = $(\".ui-bizagi-render-time\", self.getControl());\r\n        return self.timeControl;\r\n    },\r\n\t\t/* \r\n    *   Changes the render min value\r\n    */\r\n\t\tchangeMinValue: function(value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var dateControl = self.getDateControl();\r\n\r\n        // Set value in control\r\n        if (value && properties.editable) {\r\n            if (typeof value === \"number\") {\r\n                value = new Date(value);\r\n                dateControl.datepicker(\"option\", \"minDate\", value); // DateTime Normal\r\n                value = bizagi.util.dateFormatter.formatInvariant(value, properties.showTime); // Set as invariant\r\n            } else {\r\n                dateControl.datepicker(\"option\", \"minDate\", bizagi.util.dateFormatter.getDateFromInvariant(value)); // DateTime Normal\r\n            }\r\n\r\n            properties.minValue = value; // Invarian date\r\n        }\r\n    },\r\n\r\n\t\t/* \r\n    *   Changes the render max value\r\n    */\r\n\t\tchangeMaxValue: function(value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var dateControl = self.getDateControl();\r\n\r\n        // Set value in control\r\n        if (value && properties.editable) {\r\n            if (typeof value === \"number\") {\r\n                value = new Date(value);\r\n                dateControl.datepicker(\"option\", \"maxDate\", value); // DateTime Normal\r\n                value = bizagi.util.dateFormatter.formatInvariant(value, properties.showTime); // Set as invariant\r\n            } else {\r\n                dateControl.datepicker(\"option\", \"maxDate\", bizagi.util.dateFormatter.getDateFromInvariant(value)); // DateTime Normal\r\n            }\r\n\r\n            properties.maxValue = value; // Invarian date\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Sets the value in the rendered control\r\n    */\r\n\t\tsetDisplayValue: function(value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var dateControl = self.getDateControl();\r\n        var timeControl = self.getTimeControl();\r\n\r\n        if (bizagi.util.isNumeric(value) && value !== 0) {\r\n            value = bizagi.util.dateFormatter.formatInvariant(new Date(value), properties.showTime);\r\n        }\r\n\r\n        // Call base\r\n        self._super(value);\r\n\r\n        // Set value in input\r\n        if (value && properties.editable) {\r\n            var dateObj;\r\n            if (properties.timePickerFormat !== undefined) {\r\n                if (self.getMode() != \"execution\") {\r\n                    dateObj = bizagi.util.dateFormatter.getDateFromInvariant(value);\r\n                } else {\r\n                    dateObj = bizagi.util.dateFormatter.getDateFromInvariant(value, true);\r\n                }\r\n            } else {\r\n                if (properties.showTime) {\r\n                    var INVARIANT_FORMAT = \"MM/dd/yyyy H:mm:ss\";\r\n                    if (typeof value == \"string\") {\r\n                        if (value.length == INVARIANT_FORMAT.length || value.length == INVARIANT_FORMAT.length + 1) {\r\n                            dateObj = bizagi.util.dateFormatter.getDateFromInvariant(value, true);\r\n                        } else {\r\n                            dateObj = bizagi.util.dateFormatter.getDateFromInvariant(value);\r\n                            dateObj.setHours(0, 0, 0, 0);\r\n                        }\r\n                    } else {\r\n                        dateObj = bizagi.util.dateFormatter.getDateFromInvariant(value, true);\r\n                    }\r\n                } else {\r\n                    dateObj = bizagi.util.dateFormatter.getDateFromInvariant(value);\r\n                }\r\n            }\r\n\r\n            // Assert that the date could be parsed\r\n            bizagi.assert(dateObj != 0, \"The date could not be parsed\", value);\r\n\r\n            // Just set the value in the input for performance, when initializing the view\r\n            if (self.internalSetInitialValueFlag) {\r\n                if (self.getMode() === \"execution\") {\r\n                    dateControl.datepicker(\"setDate\", dateObj);\r\n                    timeControl.timeEntry(\"setTime\", dateObj);\r\n                    dateControl.attr(\"title\", $(dateControl).val());\r\n                    var inputTimeValue = $(timeControl).val();\r\n                    if (properties.showTime && !bizagi.util.isEmpty(inputTimeValue)) {\r\n                        timeControl.attr(\"title\", inputTimeValue);\r\n                    }\r\n                }\r\n                window.setTimeout(function () {\r\n                    self.checkIcon();\r\n                }, 0);\r\n                return;\r\n            }\r\n\r\n            // Set data in controls\r\n            dateControl.datepicker(\"setDate\", dateObj);\r\n\r\n            if (properties.showTime) {\r\n                timeControl.timeEntry(\"setTime\", dateObj);\r\n                var inputTimeValue = $(timeControl).val();\r\n                if (!bizagi.util.isEmpty(inputTimeValue)) {\r\n                    timeControl.attr(\"title\", inputTimeValue);\r\n                }\r\n            }\r\n            dateControl.attr(\"title\", $(dateControl).val());\r\n\r\n            // Set display value\r\n            properties.displayValue = bizagi.util.dateFormatter.formatDate(dateObj, properties.fullFormat, self.i18n);\r\n            self.checkIcon();\r\n        }\r\n    },\r\n\r\n    // Checks large texts in order to hide the calendar icon or not\r\n    checkIcon: function () {\r\n        var self = this;\r\n        var dateControl = self.getDateControl();\r\n        if (self.getFormContainer())\r\n            if (self.getFormContainer().mode == \"execution\") {\r\n                var displayValue = self.getDateControl().val();\r\n                if (dateControl.width() > 0 && dateControl.width() < 190)\r\n                    if (displayValue.length > 15) {\r\n                        self.dateIcon.hide();\r\n                        dateControl.css(\"padding\", \"1px 5px 1px 4px\");\r\n                    } else {\r\n                        self.dateIcon.show();\r\n                        var currPadding = $(\"input\", self.getControl()).css(\"paddingRight\").replace(\"px\", \"\");\r\n                        if (currPadding > 20 || currPadding == 5) dateControl.css(\"paddingRight\", \"22px\");\r\n                    }\r\n            }\r\n    },\r\n\r\n    removeValidations: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer().parent || self.getFormContainer();\r\n        form.clearValidationMessages();\r\n    },\r\n\r\n    /*\r\n     *   Focus on the current element\r\n     */\r\n    focus: function (time) {\r\n        // Call base\r\n        this._super(time);\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) == true && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) == true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    /*\r\n    *   Formats the date time value to the hidden control\r\n    */\r\n    onChangeHandler: function (isNow) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var dateControl = self.getDateControl();\r\n        var timeControl = self.getTimeControl();\r\n        var currentDate = dateControl.datepicker(\"getDate\");\r\n        var currentDateString = \"\";\r\n\r\n        if (properties.showTime && timeControl.length > 0) {\r\n            var currentTime = timeControl.timeEntry(\"getTime\");\r\n\r\n            // Merge\r\n            if (currentTime) {\r\n                // If no date has been selected then we need to create a new one to hold the time\r\n                if (currentDate == null)\r\n                    currentDate = new Date();\r\n            } else if (currentDate != null) {\r\n                currentTime = new Date(0, 0, 0, 0, 0, 0, 0);\r\n                self.updatingTime = true;\r\n                timeControl.timeEntry(\"setTime\", \"12:00:00 AM\");\r\n            }\r\n\r\n            currentDate.setHours(currentTime.getHours());\r\n            currentDate.setMinutes(currentTime.getMinutes());\r\n            currentDate.setSeconds(currentTime.getSeconds());\r\n        }\r\n\r\n        if (!currentDate || currentDate == 0) {\r\n            self.checkIcon();\r\n            return;\r\n        }\r\n        //Attemp set the value of the datepicker control. If not valid go back to the previous.\r\n        var previousValue = self.value;\r\n\r\n        //sets the value with the current format date, changed to use the same displayValue method\r\n        if (isNow == true) {\r\n            currentDate = new Date();\r\n            currentDateString = bizagi.util.dateFormatter.formatDate(currentDate, \"MM/dd/yyyy HH:mm:ss\");\r\n            self.value = currentDateString;\r\n        } else {\r\n            self.value = bizagi.util.dateFormatter.formatInvariant(currentDate, properties.showTime);\r\n        }\r\n\r\n        var value = self.getValue();\r\n        var objDate = bizagi.util.dateFormatter.getDateFromInvariant(value, true);\r\n        if (typeof timeControl.val() != \"undefined\")\r\n            if (timeControl.val().length == 0) {\r\n                timeControl.timeEntry(\"setTime\", objDate);\r\n            }\r\n\r\n        if (isNow || dateControl.val().length > 0) {\r\n            if (!properties.showTime || (properties.showTime && timeControl.val().length > 0)) {\r\n                if (!self.isValid([])) {\r\n                    var oldVal = self.dateControl.val();\r\n                    var oldValTime = null;\r\n                    if (properties.showTime) {\r\n                        oldValTime = self.getTimeControl().val();\r\n                    }\r\n\r\n                    var message = bizagi.localization.getResource(\"workportal-general-invalid-date\");\r\n\r\n                    message = message.replace(\"{0}\", self.properties.displayName);\r\n\r\n                    if (typeof self.getFormContainer().validationController === \"undefined\")\r\n                        self.getFormContainer().validationController = new bizagi.command.controllers.validation(self.getFormContainer(), self.validations);\r\n\r\n                    var validationController = self.getFormContainer().validationController || self.getFormContainer().parent.validationController;\r\n\r\n                    self.removeValidations();\r\n                    validationController.showValidationMessage(message + \" \" + oldVal + (oldValTime ? \" \" + oldValTime : \"\"));\r\n                }\r\n\r\n                self.value = previousValue;\r\n                currentDateString = bizagi.util.dateFormatter.formatDate(currentDate, \"MM/dd/yyyy HH:mm:ss\");\r\n\r\n                self.setValue(currentDateString);\r\n                self.setDisplayValue(currentDateString);\r\n            } else {\r\n                self.setValue(previousValue);\r\n                self.setDisplayValue(previousValue);\r\n            }\r\n        }\r\n\r\n        // Set display value\r\n        properties.displayValue = bizagi.util.dateFormatter.formatDate(currentDate, properties.fullFormat, self.i18n);\r\n        self.checkIcon();\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Desktop queryDate\r\n *   Author: Ivn Ricardo Taimal Narvez\r\n *   Comments:\r\n *   -\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.date.extend(\"bizagi.rendering.desktop.queryDate\", {}, {\r\n\r\n    /*\r\n     *   Add the render data to the given collection in order to send data to the server\r\n     */\r\n    collectDataQueryForm: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpath = properties.xpath;\r\n        var value = self.getValue();\r\n\r\n        var queryValue = null;\r\n        var changed = self.controlValueIsChanged();\r\n        if (!bizagi.util.isEmpty(xpath)) {\r\n            if (value !== null && typeof (value) !== \"undefined\" && value!==\"\") {\r\n                queryValue=value;\r\n            }\r\n            if (queryValue !== null || properties.included) {\r\n                var searchType = self.properties.typeSearch || self.properties.rangeQuery || \"NONE\";\r\n                searchType = searchType.toUpperCase();\r\n                renderValues.push({ \"value\": queryValue, \"included\": self.properties.included, \"xpath\": properties.xpath, \"searchType\": searchType, \"orderType\": \"NONE\" });\r\n            }\r\n        }\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop Render Yes-No Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the Yes-No render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.yesno\", bizagi.rendering.yesno.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.yesno.extend(\"bizagi.rendering.desktop.yesno\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var control = this.getControl();\r\n\r\n        // Call base \r\n        this._super();\r\n\r\n        // Set control container to behave as a block\r\n        control.addClass(\"ui-bizagi-render-display-block\");\r\n        control.addClass(\"ui-bizagi-render-boolean-yesno\");\r\n\r\n        // Remove data for cell refresh\r\n        if (control[0]) {\r\n            $.removeData(control[0]);\r\n        }\r\n\r\n        // Apply plugins\r\n        control.optiongroup({orientation: this.properties.orientation});\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Bind change event\r\n        control.bind(\"optiongroupchange\", function (evt, ui) {\r\n            // Only change the internal value when it truly changes\r\n            if (bizagi.util.parseBoolean(self.value) !== bizagi.util.parseBoolean(ui.value)) {\r\n                self.setValue(ui.value);\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour\r\n     * when rendering in design mode\r\n     */\r\n    configureDesignView: function () {\r\n        var control = this.getControl();\r\n\r\n        // Unbind plugin handlers\r\n        control.find(\"input\").unbind(\"click\");\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param {} value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var control = this.getControl();\r\n\r\n        // Call base\r\n        this._super(value);\r\n\r\n        // Set value in control\r\n        if (value != null && this.properties.editable) {\r\n            var parsedValue = bizagi.util.parseBoolean(value);\r\n\r\n            if (parsedValue != null) {\r\n                control.optiongroup(\"setValue\", parsedValue.toString());\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Cleans current value\r\n     */\r\n    cleanData: function () {\r\n        var value = {id: \"\", label: \"\"};\r\n\r\n        this.setDisplayValue(value);\r\n        this.setValue(value, false);\r\n        this.clearDisplayValue();\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     */\r\n    clearDisplayValue: function () {\r\n        var selectedItem = this.element.find(\".ui-radio-state-checked\");\r\n        selectedItem.removeClass(\"ui-radio-state-checked\");\r\n    }\r\n});\r\n","/**\r\n *   Name: BizAgi Desktop Render Check Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the Check render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.check\", bizagi.rendering.check.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.check.extend(\"bizagi.rendering.desktop.check\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var $control = this.getControl();\r\n\r\n        // Call base\r\n        this._super();\r\n\r\n        this.input = $control.find(\"label\");\r\n        this.performStyles();\r\n    },\r\n\r\n    postRenderReadOnly: function () {\r\n        var $control = this.getControl();\r\n        this.input = $control.find(\"label\");\r\n\r\n        if (!this.properties.showLetters) {\r\n            this.performStyles();\r\n\r\n            // Set as disabled\r\n            var check = $(\"input\", $control);\r\n            check.attr(\"readonly\", \"readonly\");\r\n            check.attr(\"disabled\", \"disabled\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {jQuery|*}\r\n     */\r\n    renderReadOnly: function () {\r\n        var html = \"\";\r\n\r\n        if (!this.properties.showLetters) {\r\n            html = this._super();\r\n        } else {\r\n            var template = this.renderFactory.getTemplate(\"readonly\");\r\n            var randomId = bizagi.util.randomNumber(100, 10000000);\r\n\r\n            // Render template\r\n            html = $.fasttmpl(template, {\r\n                id: randomId,\r\n                editable: this.properties.editable\r\n            });\r\n        }\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Bind change event\r\n        if (!bizagi.util.isIE()) {\r\n            // PLUGIN IMPLEMENTATION\r\n            self.input.bind(\"checkchange\", function (evt, ui) {\r\n                self.setValue(ui.value);\r\n            });\r\n        } else {\r\n            // NON PLUGIN IMPLEMENTATION\r\n            self.input.bind(\"change\", function (evt, ui) {\r\n                var value = $(\"input\", self.input).is(\":checked\");\r\n\r\n                self.setValue(value);\r\n                self.setDisplayValue(value);\r\n            });\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour when rendering in design mode\r\n     */\r\n    configureDesignView: function () {\r\n        var $control = this.getControl();\r\n\r\n        // Unbind plugin handlers\r\n        $control.find(\"input\").unbind(\"click\");\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var parsedValue = bizagi.util.parseBoolean(value);\r\n\r\n        // Call base\r\n        this._super(parsedValue);\r\n\r\n        if (!this.properties.showLetters) {\r\n\r\n            if (!bizagi.util.isIE()) {\r\n                // PLUGIN IMPLEMENTATION\r\n                if (parsedValue === true) {\r\n                    self.input.check(\"checkItem\");\r\n                } else {\r\n                    self.input.check(\"uncheckItem\");\r\n                }\r\n            } else {\r\n                // NON PLUGIN IMPLEMENTATION\r\n                if (parsedValue === true) {\r\n                    self.input.addClass(\"ui-checkbox-state-checked\");\r\n                    $(\"input\", self.input).attr(\"checked\", \"checked\");\r\n                } else {\r\n                    self.input.removeClass(\"ui-checkbox-state-checked\");\r\n                    $(\"input\", self.input).removeAttr(\"checked\");\r\n                }\r\n            }\r\n        } else {\r\n            self.input.val((this.getDisplayValue()));\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n     * Cleans current value\r\n     */\r\n    cleanData: function () {\r\n        this.setDisplayValue(false);\r\n        this.setValue(false, false);\r\n    },\r\n\r\n    /**\r\n     * Modify styles\r\n     */\r\n    performStyles: function () {\r\n        var self = this;\r\n        var $control = self.getControl();\r\n\r\n        // Set control container to behave as a block\r\n        $control.addClass(\"ui-bizagi-render-display-block\");\r\n        $control.addClass(\"ui-bizagi-render-boolean-yesno\");\r\n\r\n        if (self.properties.required) {\r\n            $(\".ui-bizagi-render-control-required\", $control).css({height: \"22px\"});\r\n        }\r\n\r\n        // Apply plugins\r\n        if (!bizagi.util.isIE()) {\r\n            // JUST FOR NON IE-BROWSERS\r\n            self.input.check();\r\n        } else {\r\n            $control.removeClass();\r\n            $control.addClass(\"ui-bizagi-render-control ui-bizagi-render-boolean-yesno-ie\");\r\n            $control.find(\"label\").addClass(\"checkbox-ie\");\r\n        }\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) == true && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) == true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            }\r\n        }\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    changeFontSize: function (size, isLabelFormat) {\r\n        //this is required Just to avoid change the font size in this control\r\n        if (isLabelFormat) {\r\n            this._super(size, isLabelFormat);\r\n        }\r\n    }\r\n});","/**\r\n *   Name: Bizagi Desktop Render Combo Extension\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will redefine the combo render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.combo\", bizagi.rendering.combo.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.combo.extend(\"bizagi.rendering.desktop.combo\", {}, {\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        // ON desktop implementation we will load the async combos on demand\r\n        properties.loadOnDemand = true;\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {\r\n        this.inputCombo = $(\".ui-selectmenu-value\", this.getControl());\r\n        this.selectedValue = this.properties.value;\r\n\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        self.inputCombo.focus(function () {\r\n            $(this).select();\r\n        });\r\n\r\n        self.inputCombo.blur(function (e) {\r\n            if (!self.isExtraItem()) self.setDisplayValue(self.value);\r\n        });\r\n\r\n        //Triggered only when the form exists inside a dialog and is performed the maximize action\r\n        self.getFormContainer().bind(\"maximazedForm unmaximazedForm\", function () {\r\n            self.resizeCombo();\r\n        });\r\n\r\n        self.inputCombo.click(function () {\r\n            var idDropdown = \"dd-\" + self.inputCombo.attr(\"id\");\r\n\r\n            if ($(\"#\" + idDropdown, self.getControl().parent()).length === 0) {\r\n                self.comboDropDown();\r\n            } else {\r\n                // Close combo if clicked twice\r\n                self.dropDownDestroy($(\"#\" + idDropdown));\r\n            }\r\n            self.inputCombo.focus();\r\n        });\r\n\r\n        // Bind clicks to fake UI in order to simulate select clicks\r\n        if ($(\".ui-selectmenu-btn\", self.control).length > 1 && typeof window.addEventListener != \"undefined\") {\r\n            $(\".ui-selectmenu-btn\", self.control)[0].addEventListener(\"click\", function () {\r\n                self.inputCombo[0].click();\r\n            });\r\n        } else {\r\n            $(\".ui-selectmenu-btn\", self.control).bind(\"click.combo\", function () {\r\n                self.inputCombo.trigger(\"click\");\r\n            });\r\n        }\r\n\r\n        self.inputCombo.keyup(function (e) {\r\n            self.keyUpFunction(e);\r\n        });\r\n\r\n        self.inputCombo.keydown(function (e) {\r\n            self.keyDownFunction(e);\r\n        });\r\n\r\n        // Call base\r\n        self._super();\r\n    },\r\n    /*\r\n    *   Makes the combo drops down, also fetch the data first if the combo is set to load on demand\r\n    */\r\n    comboDropDown: function () {\r\n        var self = this;\r\n\r\n        self.showLoadingData();\r\n\r\n        $.when(self.getData()).done(function (data) {\r\n            self.hideLoadingData();\r\n\r\n            try {\r\n                self.internalComboDropDown(data);\r\n            } catch (e) {\r\n                bizagi.log(e.message);\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Show loading message\r\n    */\r\n    showLoadingData: function () {\r\n        var self = this;\r\n        var body = $(\"body\", document);\r\n        var loading = (self.loading = $(\"<div class='ui-select-dropdown open loading'><ul><li class='ui-bizagi-render-loading ui-bizagi-loading'></li></ul></div>\"));\r\n\r\n        // Add width\r\n        loading.css(\"width\", self.inputCombo.outerWidth() + \"px\");\r\n        $(\"li\", loading).css({padding: 0, margin: 0});\r\n        loading.css(\"overflow\", \"hidden\");\r\n        loading.appendTo(body);\r\n        loading.position({\r\n            my: \"left top\",\r\n            at: \"left bottom\",\r\n            of: self.inputCombo,\r\n            collision: \"none flip\"\r\n        });\r\n    },\r\n    /*\r\n    *   Remove loading message\r\n    */\r\n    hideLoadingData: function () {\r\n        this.loading.remove();\r\n    },\r\n    /*\r\n    *   Draws the mini-popup\r\n    */\r\n    internalComboDropDown: function (data) {\r\n        var self = this;\r\n        var selectTmp = {};\r\n        var objSelected = {};\r\n\r\n        // Remove the old list\r\n        $(\".ui-select-dropdown.open\").remove();\r\n\r\n        /** temp templates **/\r\n        var tempCombo = \"<ul>\" +\r\n            \"   {{each datasource}}{{if typeof hidden == 'undefined'}}\" +\r\n            \"       <li data-value='${id}'>${value}</li>{{/if}}\" +\r\n            \"   {{/each}}\" +\r\n            \"</ul>\";\r\n\r\n        var containerDropdown = $(\"<div class='ui-select-dropdown open bz-combo__list--comfortable'></div>\");\r\n\r\n        /* control reference */\r\n        var containerControl = self.inputCombo.parents(\".ui-bizagi-control\").last();\r\n        var containerRender = containerControl.closest(\".ui-bizagi-render\");\r\n\r\n        var idDropdown = \"dd-\" + self.inputCombo.attr(\"id\");\r\n        var selectedValue = self.findDataByValue(self.inputCombo.val());\r\n        var scrollPosition = 0;\r\n        var orientation = self.properties.orientation === \"rtl\" ? \"ui-bizagi-rtl\" : \"\";\r\n\r\n        //fix for QA-507 only IE\r\n        if (navigator.userAgent.indexOf(\"MSIE\") !== -1 || navigator.appVersion.indexOf(\"Trident/\") > 0) {\r\n            var contFormScroll = containerRender.closest(\".ui-dialog-content\");\r\n            if (contFormScroll.length > 0) {\r\n                contFormScroll.css(\"overflow-y\", \"hidden\");\r\n            }\r\n        }\r\n\r\n        data = data || self.properties.data;\r\n\r\n        self.properties.data = data;\r\n\r\n        self.repositionInterval;\r\n        containerRender.addClass(\"ac-is-visible\");\r\n        containerControl.addClass(\"ac-is-visible ac-clear-floats\");\r\n\r\n        containerDropdown.attr(\"id\", idDropdown);\r\n\r\n        for (var i = 0; i < data.length; i++) {\r\n            if (data[i].value !== null && typeof (data[i].value) == \"boolean\") {\r\n                if (bizagi.util.parseBoolean(data[i].value) === true) {\r\n                    data[i].value = this.getResource(\"render-boolean-yes\");\r\n                } else if (bizagi.util.parseBoolean(data[i].value) === false) {\r\n                    data[i].value = this.getResource(\"render-boolean-no\");\r\n                }\r\n            }\r\n        }\r\n\r\n        if (data.length > 1000) {\r\n            selectTmp = self.getResource(\"render-combo-too-many-elements\");\r\n        } else {\r\n            selectTmp = $.tmpl(tempCombo, {datasource: data});\r\n        }\r\n\r\n        var dropDwn = containerDropdown.append(selectTmp);\r\n        containerControl.append(dropDwn);\r\n\r\n        var objParent = $(\".ui-selectmenu\", self.control);\r\n        $(dropDwn).find(\"li:last-child\").css(\"padding-bottom\", \"13px\");\r\n\r\n        var widthChild = dropDwn.width();\r\n        var widthControl = objParent.width();\r\n\r\n        dropDwn.width(widthControl < widthChild ? widthChild : widthControl);\r\n\r\n        dropDwn.position({\r\n            my: \"left top\",\r\n            at: \"left bottom\",\r\n            of: $(\".ui-selectmenu\", self.control),\r\n            collision: \"fit\"\r\n        }).hide();\r\n\r\n        dropDwn.show();\r\n\r\n        // Fix for QA-507 only IE\r\n        if ((navigator.userAgent.indexOf(\"MSIE\") !== -1 || navigator.appVersion.indexOf(\"Trident/\") > 0) && contFormScroll.length > 0) {\r\n            contFormScroll.css(\"overflow-y\", \"auto\");\r\n        }\r\n\r\n        //SUITE 9379 - ComboBox offset in resizing when the combobox is opened\r\n        self.recalculateComboOffset(dropDwn, objParent);\r\n\r\n        dropDwn.data(\"formWidth\", containerControl.width());\r\n        dropDwn.data(\"parentCombo\", self.control);\r\n\r\n        dropDwn.addClass(orientation);\r\n\r\n        if (selectedValue !== -1 && $(\"li\", dropDwn).length > 0) {\r\n            //Checks if the selected element is empty string, it's normal for cascading combos\r\n            if (selectedValue && selectedValue.id === \"\") {\r\n                objSelected = $(\"li[data-value='']\", dropDwn);\r\n            } else {\r\n                objSelected = $(\"li[data-value='\" + selectedValue.id + \"']\", dropDwn);\r\n            }\r\n\r\n            if (objSelected.length !== 0) {\r\n                objSelected.addClass(\"ui-selected\");\r\n                objSelected.addClass(\"active\");\r\n\r\n                scrollPosition = parseInt(objSelected.position().top);\r\n                dropDwn.scrollTop(scrollPosition);\r\n            }\r\n        }\r\n\r\n        dropDwn.delegate(\"li\", \"click\", function () {\r\n            var valId = $(this).data(\"value\") ? $(this).data(\"value\") : \"\";\r\n            var val = {id: valId, value: $(this).text()};\r\n\r\n            //Prevents stores the value twice when the element seached match with the clicked\r\n            //It helps to keep track the last selected\r\n            var id = self.getValue();\r\n            id = id && id.id ? id.id : 0;\r\n\r\n            if (val.id !== id) {\r\n                self.onComboItemSelected(val);\r\n            } else {\r\n                if (val.value !== self.inputCombo.val()) {\r\n                    self.setDisplayValue({value: val.value});\r\n                }\r\n            }\r\n\r\n            //'select' will stand at first character of the string, 'focus' will stand at the last character of the string\r\n            self.inputCombo.select();\r\n\r\n            // Animation effect\r\n            dropDwn.hide();\r\n            self.dropDownDestroy(dropDwn);\r\n\r\n            $(document).unbind(\"click.closecombo\");\r\n        });\r\n\r\n        // Stop bubbling outside the dropdown\r\n        $.makeArray(dropDwn, self.getControl()).bind(\"click\", function (e) {\r\n            e.preventDefault();\r\n            return false;\r\n        });\r\n\r\n        $(document).one(\"click.closecombo\", function (e) {\r\n            var tg = $(e.target);\r\n            self.dropDownValidClose(tg, dropDwn);\r\n        });\r\n    },\r\n\r\n    /*\r\n     * validate when fire event form document and window\r\n     */\r\n    dropDownValidClose: function (target, dropDown) {\r\n        dropDown.hide();\r\n        this.dropDownDestroy(dropDown);\r\n        $(document).unbind(\"click.closecombo\");\r\n    },\r\n    /*\r\n     * set a new dropdown position\r\n     */\r\n    dropDownReposition: function (dropDown, containerForm) {\r\n        var self = this;\r\n        if (containerForm.width() != dropDown.data(\"formWidth\")) {\r\n            var objParent = $(\".ui-selectmenu\", self.control);\r\n            dropDown.width(self.control.width() < 100 ? 100 : objParent.width());\r\n\r\n            var control = dropDown.data(\"parentCombo\") || objParent;\r\n            dropDown.position({\r\n                my: \"left top\",\r\n                at: \"left bottom\",\r\n                of: $(\".ui-selectmenu-value\", control),\r\n                collision: \"none\"\r\n            });\r\n\r\n            dropDown.data(\"formWidth\", containerForm.width());\r\n        }\r\n    },\r\n    /*\r\n     * destroy dropdown\r\n     */\r\n    dropDownDestroy: function (dropDown) {\r\n        var self = this;\r\n        var control = self.inputCombo ? self.inputCombo : $(\".ui-selectmenu-value\", self.getControl());\r\n        var containerControl = control.closest(\".ui-bizagi-control\");\r\n        var containerRender = containerControl.closest(\".ui-bizagi-render\");\r\n\r\n        // fix for SUITE-9507\r\n        if (containerControl.hasClass(\"ac-is-visible\")) containerControl.removeClass(\"ac-is-visible\");\r\n        if (containerControl.hasClass(\"ac-clear-floats\")) containerControl.removeClass(\"ac-clear-floats\");\r\n        if (containerRender.hasClass(\"ac-is-visible\")) containerRender.removeClass(\"ac-is-visible\");\r\n\r\n        dropDown.remove();\r\n\r\n        $(document).unbind(\"mousedown.closecombo\");\r\n        $(document).unbind(\"mouseup.resizecombo\");\r\n        $(window).unbind(\"resize.resizecombo\");\r\n        $(window).unbind(\"mouseup.closecombo\");\r\n\r\n        if (self.repositionInterval) clearInterval(self.repositionInterval);\r\n    },\r\n\r\n    validateValueInDatasource: function (triggerEvents, isKeyByKey) {\r\n        var self = this;\r\n        var selected = self.inputCombo.val();\r\n        var selectedKey = self.findDataByValue(selected, isKeyByKey);\r\n\r\n        if (!self.value) {\r\n            self.value = {id: \"\"};\r\n        }\r\n\r\n        if (selectedKey.id > 0) {\r\n            if (!triggerEvents) {\r\n                self.setValue({id: selectedKey.id}, false);\r\n                self.setDisplayValue(selectedKey);\r\n            } else {\r\n                self.setValue({id: selectedKey.id});\r\n                self.setDisplayValue(selectedKey);\r\n            }\r\n        } else if (selectedKey.id === \"\") {\r\n            if (self.value.id != selectedKey.id) {\r\n                self.setValue(selectedKey, false);\r\n            }\r\n            self.setDisplayValue(selectedKey);\r\n        } else {\r\n            self.setDisplayValue(self.selectedValue);\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Keydown listener\r\n     */\r\n    keyDownFunction: function (e) {\r\n        var self = this;\r\n        var idDropdown = \"dd-\" + self.inputCombo.attr(\"id\");\r\n        var dropDown = $(\"#\" + idDropdown);\r\n        var active = $(\"li.active\", dropDown);\r\n\r\n        e = e ? e : window.event;\r\n\r\n        // Need to implement hiding select on \"Escape\" and \"Enter\".\r\n        if (e.altKey || e.ctrlKey || e.metaKey) {\r\n            return 1;\r\n        }\r\n\r\n        if (dropDown.length === 0 && !self.properties.data) {\r\n            self.comboDropDown(self.combo);\r\n            dropDown = $(\"#\" + idDropdown);\r\n        }\r\n\r\n        //Tab or Shift + Tab\r\n        if ((e.shiftKey && e.keyCode == 9) || e.keyCode == 9) {\r\n            if (active.length > 0) {\r\n                self.inputCombo.val(active.text());\r\n            }\r\n            self.focusDependant = true;\r\n            self.validateValueInDatasource(true, true);\r\n            dropDown.remove();\r\n            return 1;\r\n            //return 0;\r\n        }\r\n\r\n        if (27 == e.keyCode) {\r\n            self.setDisplayValue(self.selectedValue);\r\n            dropDown.remove();\r\n        }\r\n\r\n        if (9 == e.keyCode || 13 == e.keyCode) {\r\n            if (active.length > 0) {\r\n                self.inputCombo.val(active.text());\r\n            }\r\n            self.validateValueInDatasource(true, true);\r\n            dropDown.remove();\r\n            return 1;\r\n        }\r\n\r\n        if (e.keyCode == \"38\" || e.keyCode == \"37\") {\r\n            // up arrow\r\n            self.selectPreviousElement(dropDown);\r\n            return 0;\r\n        } else if (e.keyCode == \"40\" || e.keyCode == \"39\") {\r\n            // down arrow\r\n            self.selectNextElement(dropDown);\r\n            return 0;\r\n        }\r\n\r\n        if (e.keyCode == 36) {\r\n            self.selectFirstElement(dropDown);\r\n            return 0;\r\n        } else if (e.keyCode == 35) {\r\n            self.selectLastElement(dropDown);\r\n            return 0;\r\n        }\r\n\r\n        self.properties.enableTyping = typeof bizagi.override.typingForCombos == \"boolean\" ? bizagi.override.typingForCombos : self.properties.enableTyping;\r\n\r\n        if (!self.properties.enableTyping) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            return false;\r\n        }\r\n        return 1;\r\n    },\r\n\r\n    /*\r\n     *   KeyUp listener\r\n     */\r\n    keyUpFunction: function (e) {\r\n        var self = this;\r\n        var idDropdown = \"dd-\" + self.inputCombo.attr(\"id\");\r\n        var dropDown = $(\"#\" + idDropdown);\r\n\r\n        e = e ? e : window.event;\r\n\r\n        if (\r\n            e.altKey ||\r\n            e.ctrlKey ||\r\n            e.metaKey ||\r\n            50 == e.keyCode ||\r\n            13 == e.keyCode ||\r\n            9 == e.keyCode ||\r\n            27 == e.keyCode ||\r\n            e.keyCode == 16 ||\r\n            e.keyCode == 36 ||\r\n            e.keyCode == 35 ||\r\n            e.keyCode == 33 ||\r\n            e.keyCode == 34\r\n        ) {\r\n            return 0;\r\n        }\r\n\r\n        if (dropDown.length === 0) {\r\n            self.comboDropDown(self.combo);\r\n            dropDown = $(\"#\" + idDropdown);\r\n        }\r\n\r\n        var isSelectingItem = false;\r\n        if (e.keyCode >= 37 && e.keyCode <= 40) {\r\n            // Keyboard Arrows\r\n            isSelectingItem = true;\r\n        }\r\n        self.selectItemByKeyUp(isSelectingItem);\r\n\r\n        return 1;\r\n    },\r\n    /*\r\n     * Select letter by letter\r\n     */\r\n    selectItemByKeyUp: function (isSelectingItem) {\r\n        var self = this,\r\n            objSelected;\r\n\r\n        if (bizagi.util.parseBoolean(isSelectingItem) == null) {\r\n            isSelectingItem = false;\r\n        }\r\n        var idDropdown = \"dd-\" + self.inputCombo.attr(\"id\");\r\n        var dropDown = $(\"#\" + idDropdown);\r\n\r\n        $(\".active\", dropDown).removeClass(\"active\");\r\n\r\n        var selectedKey = self.findDataByValue(self.inputCombo.val(), true, isSelectingItem);\r\n        if (selectedKey !== -1) {\r\n            objSelected = $(\"li[data-value='\" + selectedKey.id + \"']\", dropDown);\r\n            objSelected.addClass(\"active\");\r\n        } else {\r\n            objSelected = $(\"li.ui-selected\", dropDown);\r\n        }\r\n\r\n        if (dropDown.length > 0 && objSelected.length > 0) {\r\n            scrollPosition = parseInt(objSelected.position().top);\r\n            dropDown.scrollTop(scrollPosition);\r\n        }\r\n    },\r\n\r\n    selectFirstElement: function (dropDown) {\r\n        var self = this;\r\n        var actual = $(\"li:first\", dropDown);\r\n\r\n        $(\"li\", dropDown).removeClass(\"active\");\r\n        actual.addClass(\"active\");\r\n        scrollPosition = actual.position().top;\r\n        dropDown.scrollTop(scrollPosition);\r\n\r\n        self.inputCombo.val($(actual).text());\r\n    },\r\n\r\n    selectLastElement: function (dropDown) {\r\n        var self = this;\r\n        var actual = $(\"li:last\", dropDown);\r\n\r\n        $(\"li\", dropDown).removeClass(\"active\");\r\n        actual.addClass(\"active\");\r\n        scrollPosition = actual.position().top;\r\n        dropDown.scrollTop(scrollPosition);\r\n\r\n        self.inputCombo.val($(actual).text());\r\n    },\r\n\r\n    /*\r\n     * Handler key Up\r\n     */\r\n    selectPreviousElement: function (dropDown) {\r\n        var self = this;\r\n        var scrollPosition = 0;\r\n        var actual = $(\"li.active\", dropDown);\r\n\r\n        if (actual.length === 0) {\r\n            actual = $(\"li:first\", dropDown);\r\n        }\r\n\r\n        var previous = actual.prev();\r\n\r\n        if (previous.length !== 0) {\r\n            actual.removeClass(\"active\");\r\n            $(previous).addClass(\"active\");\r\n            scrollPosition = $(previous).position().top;\r\n\r\n            dropDown.scrollTop(scrollPosition);\r\n            self.inputCombo.val($(previous).text());\r\n        }\r\n    },\r\n\r\n    /*\r\n     *Handler key Down\r\n     */\r\n    selectNextElement: function (dropDown) {\r\n        var self = this;\r\n        var scrollPosition = 0;\r\n        var actual = $(\"li.active\", dropDown);\r\n\r\n        if (actual.length === 0) actual = $(\"li:first\", dropDown);\r\n\r\n        var next = actual.next();\r\n\r\n        if (next.length !== 0) {\r\n            actual.removeClass(\"active\");\r\n            $(next).addClass(\"active\");\r\n            scrollPosition = $(next).position().top;\r\n\r\n            dropDown.scrollTop(scrollPosition);\r\n            self.inputCombo.val($(next).text());\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Handler to react when a combo item is selected\r\n     */\r\n    onComboItemSelected: function (val) {\r\n        var self = this;\r\n        var selectedId = val.id || \"\";\r\n        var selectedLabel = val.value || \"\";\r\n\r\n        self.properties.originalValue = self.getValue();\r\n\r\n        if (selectedId === \"\") {\r\n            self.inputCombo.val(\"\");\r\n        } else {\r\n            self.inputCombo.val(selectedLabel);\r\n        }\r\n\r\n        self.setValue({id: selectedId});\r\n        self.setDisplayValue({id: selectedId, value: selectedLabel});\r\n    },\r\n\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var comboValue = \"\";\r\n        var comboValueValid = true;\r\n        var control;\r\n\r\n        value = self.mapValue(value);\r\n\r\n        if (properties.editable && value !== null) {\r\n            // If set display value were assigned from render action\r\n            if (typeof value === \"object\" && value.label !== undefined) {\r\n                var id = bizagi.util.isNumeric(value.id) ? value.id : value.value;\r\n                                \r\n                var displayValue = value.label;\r\n\r\n                if (!bizagi.util.isString(displayValue) && bizagi.util.isString(value.value)) {\r\n                    displayValue = value.value;\r\n                }\r\n\r\n                comboValue = self.findDataById(id).value || value.label;\r\n                self.setValue({id: id, value: displayValue });\r\n                \r\n            } else {\r\n                if (typeof value === \"number\" || typeof value === \"string\" || value.id) {\r\n                    if (value.id) {\r\n                        var translated = false; //When the parametric entity have a boolean attribute\r\n                        if (value.value != null && typeof value.value === \"boolean\") {\r\n                            translated = true;\r\n                            if (bizagi.util.parseBoolean(value.value) === true) {\r\n                                value.value = this.getResource(\"render-boolean-yes\");\r\n                            } else if (bizagi.util.parseBoolean(value.value) === false) {\r\n                                value.value = this.getResource(\"render-boolean-no\");\r\n                            }\r\n                        } else if (value.value != null && typeof value.value === \"object\") {\r\n                            for (var i = 0; i < value.value.length; i++) {\r\n                                if (value.value[i] != null && typeof (value.value[i]) === \"boolean\") {\r\n                                    if (bizagi.util.parseBoolean(value.value[i]) === true) {\r\n                                        value.value[i] = this.getResource(\"render-boolean-yes\");\r\n                                    } else if (bizagi.util.parseBoolean(value.value[i]) === false) {\r\n                                        value.value[i] = this.getResource(\"render-boolean-no\");\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                        if (translated) {\r\n                            comboValue = value.value;\r\n                        } else {\r\n                            comboValue = self.findDataById(value.id).value || value.value;\r\n                        }\r\n                    } else {\r\n                        comboValue = self.findDataById(Number(value)).value || value.label;\r\n                    }\r\n                } else {\r\n                    comboValue = typeof value.value == \"object\" ? value.value.join(\" - \") : value.value;\r\n                }\r\n\r\n                if (properties.hasLocalData || properties.remoteDataLoaded) {\r\n                    comboValueValid = self.findDataByValue(comboValue);\r\n                    if (comboValueValid === -1) {\r\n                        comboValue = \"\";\r\n                    }\r\n                }\r\n\r\n                if (value && value.id) {\r\n                    // Check if the value is a json object\r\n                    if ((value.id != undefined) && ((typeof value.id === \"number\" && value.id > 0) || (typeof value.id === \"string\" && value.id.length > 0))) {\r\n                        if (self.value.id != value.id) {\r\n                            self.setValue({id: value.id});\r\n                        }\r\n                    } else {\r\n                        if (self.value.id != value) {\r\n                            self.setValue({id: value});\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            if ($.isArray(comboValue)) {\r\n                comboValue = comboValue.join(\" - \");\r\n            }\r\n            if (self.inputCombo) {\r\n                self.inputCombo.val(comboValue);\r\n                $(self.inputCombo).attr(\"title\", comboValue);\r\n            } else {\r\n                control = $(\".ui-selectmenu-value\", self.getControl());\r\n                control && control.val(comboValue);\r\n            }\r\n        } else {\r\n            if (!properties.editable && value !== null) {\r\n                if (typeof value === \"number\" || typeof value === \"string\") {\r\n                    comboValue = self.findDataById(Number(value)).value;\r\n                    control = self.getControl();\r\n                    control.html(\r\n                        \"<label class='readonly-control'>\" +\r\n                        self.escapeValue(self.formatItem(comboValue)) +\r\n                        \"</label>\"\r\n                    );\r\n                } else {\r\n                    if (typeof value === \"object\") {\r\n\r\n                        if (value.label !== undefined) {\r\n                            id = bizagi.util.isNumeric(value.id) ? value.id : value.value;\r\n                            \r\n                            comboValue = self.findDataById(id).value || value.label;\r\n\r\n                            if ($.isArray(comboValue)) {\r\n                                comboValue = comboValue.join(\" - \");\r\n                            }\r\n\r\n                            self.setValue({id: id, value: comboValue});\r\n                        } else {\r\n                            self.setValue({id: value.id, value: value.value});\r\n                        }\r\n\r\n                        self.control.html(\r\n                            \"<label class='readonly-control'>\" +\r\n                            self.escapeValue(self.formatItem(value.label || value.value)) +\r\n                            \"</label>\"\r\n                        );\r\n                    }\r\n                }\r\n            } else {\r\n                if (value === null && properties.editable) {\r\n                    var emptySelection = self.getResource(\"render-combo-empty-selection\");\r\n                    self.inputCombo.val(emptySelection);\r\n                    $(self.inputCombo).attr(\"title\", \"\");\r\n                } else {\r\n                    if (value === null && !properties.editable) {\r\n                        self.getControl().text(\"\");\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        if (self.inputCombo) {\r\n            var emptySelection = bizagi.override.emptyLabelForCombo || self.getResource(\"render-combo-empty-selection\");\r\n            self.inputCombo.val(emptySelection);\r\n        } else if (!self.properties.editable) {\r\n            $(control).html(\"<label class='readonly-control'></label>\");\r\n        }\r\n\r\n        self.value = self.properties.value = self.selectedValue;\r\n    },\r\n    /*\r\n     * Cleans current data\r\n     */\r\n    cleanData: function () {\r\n        this.value = this.properties.value = this.selectedValue = {id: \"\", value: \"\"};\r\n        this.clearDisplayValue();\r\n    },\r\n    /*\r\n     *   Returns the selected value in the template\r\n     */\r\n    getSelectedValue: function () {\r\n        return this.selectedValue;\r\n    },\r\n    /*\r\n     *   Find elements within a data source\r\n     */\r\n    findDataById: function (id) {\r\n        var result = (this.properties.data || []).find(function (value) {\r\n            return value.id == id;\r\n        }) || {};\r\n\r\n        return result;\r\n    },\r\n\r\n    findDataByValue: function (val, keyByKey, equalsToValue) {\r\n        var self = this;\r\n        var result = -1;\r\n\r\n        if (val !== undefined && val !== null && self.properties.data != undefined) {\r\n            if (keyByKey) {\r\n                var value;\r\n                var tvalue;\r\n                var nValue;\r\n                var compareValIn;\r\n                var compareVal;\r\n                var i = -1;\r\n                var dataLength = self.properties.data.length - 1;\r\n\r\n                while (i++ < dataLength) {\r\n                    value = self.properties.data[i];\r\n\r\n                    compareValIn =\r\n                        typeof val == \"object\" ? val.join(\" - \") : typeof val === \"boolean\" ? val.toString() : val;\r\n                    compareVal = $.trim(compareValIn)\r\n                        .substring(0, compareValIn.length)\r\n                        .toLowerCase();\r\n\r\n                    if (typeof value === \"object\" && typeof value.value === \"object\") {\r\n                        tvalue = typeof value.value == \"object\" ? value.value.join(\" - \") : value.value;\r\n                    } else {\r\n                        tvalue = $.trim(value.value);\r\n                    }\r\n\r\n                    nValue = String(tvalue).toLowerCase();\r\n\r\n                    if (equalsToValue) {\r\n                        if (nValue == compareVal && nValue.length == compareVal.length) {\r\n                            result = {id: value.id, value: value.value};\r\n                            i = dataLength;\r\n                        }\r\n                    } else {\r\n                        // Search item by Begin\r\n                        if (nValue.indexOf(compareVal) == 0) {\r\n                            result = {id: value.id, value: value.value};\r\n                            i = dataLength;\r\n                        }\r\n                    }\r\n                }\r\n            } else {\r\n                if (self.getValue()) {\r\n                    result = self.getValue();\r\n\r\n                    if (!result.value) {\r\n                        result.value = self.inputCombo.val();\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    setValue: function (val, triggerEvents) {\r\n        var self = this;\r\n\r\n        if (val === null) val = {id: \"\"};\r\n\r\n        if (!!val) {\r\n            var id = typeof val === \"object\" ? self.getValueFromData(val.id) || \"\" : typeof val === \"number\" || typeof val === \"string\" ? self.getValueFromData(val) : \"\";\r\n            var label = (typeof val.value !== \"undefined\" && val.value !== null) ? val.value : (self.findDataById(id).value || \"\");\r\n            self.selectedValue = {id: id, value: label};\r\n            this._super(self.selectedValue, triggerEvents);\r\n        }\r\n    },\r\n\r\n    getValueFromData: function (dataValue) {\r\n        var value = Number(dataValue);\r\n        if (isNaN(value)) value = dataValue;\r\n        return value;\r\n    },\r\n\r\n    recalculateComboOffset: function (dropDwn, objParent) {\r\n        if (bizagi.util.isIE() && bizagi.util.getInternetExplorerVersion() == 9) {\r\n            if (dropDwn.width() !== objParent.width()) {\r\n                var offset = objParent.width() - dropDwn.width();\r\n                dropDwn.width(objParent.width() + offset);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Workaround: Action isn't a parameter is temporally\r\n     * TODO: Fix after Genome\r\n     * @param {} action\r\n     * @returns {}\r\n     */\r\n    resizeCombo: function () {\r\n        var selectMenu = $(\".ui-selectmenu\", this.control);\r\n        var dropDwn = $(\".ui-select-dropdown.open\", this.element);\r\n        var widthControl = selectMenu.width();\r\n\r\n        if (dropDwn && dropDwn.get(0) && dropDwn.width() !== widthControl) {\r\n            dropDwn.width(widthControl);\r\n        }\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) == true && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) == true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            }\r\n        }\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    }\r\n});\r\n\r\n// We override original select menu refresh position method to adjust custom stuff\r\nvar originalRefreshPositionMethod = $.ui.selectmenu.prototype._refreshPosition;\r\n$.ui.selectmenu.prototype._refreshPosition = function () {\r\n\r\n    // Set initial heigth to zero\r\n    this.list.height(0);\r\n\r\n    // Call original method\r\n    var result = originalRefreshPositionMethod.apply(this, arguments);\r\n\r\n    // Return original response\r\n    this.list.css(\"width\", this.newelement.width() + \"px\");\r\n    return result;\r\n};\r\n","/**\r\n *   Name: Bizagi Desktop Render Cascading combo Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the cascading combo render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.cascadingCombo\", bizagi.rendering.combo.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.cascadingCombo.extend(\"bizagi.rendering.desktop.cascadingCombo\", bizagi.rendering.cascadingCombo.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.cascadingCombo.extend(\"bizagi.rendering.desktop.cascadingCombo\", {\r\n    // Statics\r\n    BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n    BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX\r\n}, {\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.postRender.apply(self, arguments);\r\n        self.processLayout(false, self.properties.valueFormat || {});\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        // Call base\r\n        this._super();\r\n\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.configureHandlers.apply(this, arguments);\r\n    },\r\n\r\n    comboDropDown: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.comboDropDown.apply(this, arguments);\r\n    },\r\n\r\n    showLoadingData: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.showLoadingData.apply(this, arguments);\r\n    },\r\n\r\n    hideLoadingData: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.hideLoadingData.apply(this, arguments);\r\n    },\r\n\r\n    internalComboDropDown: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.internalComboDropDown.apply(this, arguments);\r\n    },\r\n\r\n    resizeCombo: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.resizeCombo.apply(this, arguments);\r\n    },\r\n\r\n    validateValueInDatasource: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.validateValueInDatasource.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    *   Keydown listener\r\n    */\r\n    keyDownFunction: function (e) {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.keyDownFunction.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    *   KeyUp listener\r\n    */\r\n    keyUpFunction: function (e) {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.keyUpFunction.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    * Select letter by letter\r\n    */\r\n    selectItemByKeyUp: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.selectItemByKeyUp.apply(this, arguments);\r\n    },\r\n\r\n    selectFirstElement: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.selectFirstElement.apply(this, arguments);\r\n    },\r\n\r\n    selectLastElement: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.selectLastElement.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    * Handler key Up\r\n    */\r\n    selectPreviousElement: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.selectPreviousElement.apply(this, arguments);\r\n    },\r\n    /*\r\n    *Handler key Down\r\n    */\r\n    selectNextElement: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.selectNextElement.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    *   Sets the value in the rendered control\r\n    */\r\n    setDisplayValue: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.setDisplayValue.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    *   Sets the value in the rendered control\r\n    */\r\n    clearDisplayValue: function () {\r\n        // Call desktop.combo method\r\n        bizagi.rendering.desktop.combo.prototype.clearDisplayValue.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    *   Returns the selected value in the template\r\n    */\r\n    getSelectedValue: function () {\r\n        // Call desktop.combo method\r\n        return bizagi.rendering.desktop.combo.prototype.getSelectedValue.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    *   Handler to react when a combo item is selected\r\n    */\r\n    onComboItemSelected: function () {\r\n        this.itemSelected = true;\r\n        // Call desktop.combo method\r\n        return bizagi.rendering.desktop.combo.prototype.onComboItemSelected.apply(this, arguments);\r\n    },\r\n\r\n    postRenderPrintVersion: function () {\r\n        var control = this.getControl();\r\n\r\n        control.empty();\r\n        control.append(this.value.value);\r\n    },\r\n\r\n    /*\r\n    * validate when fire event form document and window\r\n    */\r\n    dropDownValidClose: function () {\r\n        return bizagi.rendering.desktop.combo.prototype.dropDownValidClose.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    * set a new dropdown position\r\n    */\r\n    dropDownReposition: function (dropDown, containerForm) {\r\n        return bizagi.rendering.desktop.combo.prototype.dropDownReposition.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    * destroy dropdown\r\n    */\r\n    dropDownDestroy: function (dropDown) {\r\n        return bizagi.rendering.desktop.combo.prototype.dropDownDestroy.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    *   Find elements within a data source\r\n    */\r\n    findDataById: function () {\r\n        return bizagi.rendering.desktop.combo.prototype.findDataById.apply(this, arguments);\r\n    },\r\n\r\n    findDataByValue: function () {\r\n        return bizagi.rendering.desktop.combo.prototype.findDataByValue.apply(this, arguments);\r\n    },\r\n\r\n    recalculateComboOffset: function () {\r\n        return bizagi.rendering.desktop.combo.prototype.recalculateComboOffset.apply(this, arguments);\r\n    },\r\n\r\n\r\n    setValue: function (val, triggerEvents) {\r\n        var self = this;\r\n        triggerEvents = triggerEvents !== undefined ? triggerEvents : true;\r\n\r\n        if (val === '') {\r\n            val = {id: \"\", value: \"\"};\r\n        }\r\n\r\n        if (!!val) {\r\n            var id = val.id || \"\";\r\n            var label = val.value || self.findDataById(id).value;\r\n\r\n            self.selectedValue = {id: id, value: label};\r\n\r\n            if (!self.internalSetInitialValueFlag) {\r\n                if (self.value === null || self.value.id !== val.id) {\r\n                    self.triggerHandler(\"select\", [{id: id, value: label}, false]);\r\n                }\r\n            }\r\n\r\n            this._super(self.selectedValue, triggerEvents);\r\n        }\r\n    },\r\n\r\n    /*\r\n     * Cleans current data\r\n     */\r\n    cleanData: function () {\r\n        var self = this;\r\n\r\n        self.value = self.properties.value = self.selectedValue = {id: \"\", value: \"\"};\r\n        self.setValue(self.value, false);\r\n        self.setDisplayValue(self.value);\r\n        self.clearDisplayValue();\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        return bizagi.rendering.desktop.combo.prototype.changeRequired.apply(this, arguments);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        return bizagi.rendering.desktop.combo.prototype.changeRequiredLabel.apply(this, arguments);\r\n    },\r\n\r\n    changeRequiredControl: function (argument) {\r\n        return bizagi.rendering.desktop.combo.prototype.changeRequiredControl.apply(this, arguments);\r\n    }\r\n});\r\n\r\n// We override original select menu refresh position method to adjust custom stuff\r\nvar originalRefreshPositionMethod = $.ui.selectmenu.prototype._refreshPosition;\r\n$.ui.selectmenu.prototype._refreshPosition = function () {\r\n    // Set initial height to zero\r\n    this.list.height(0);\r\n\r\n    // Call original method\r\n    var result = originalRefreshPositionMethod.apply(this, arguments);\r\n\r\n    // Return original response\r\n    this.list.css(\"width\", this.newelement.width() + \"px\");\r\n    return result;\r\n};\r\n","/*\r\n*   Name: BizAgi Desktop querycombo\r\n*   Author: Ivan Ricardo Taimal Narvaez\r\n*   Comments:\r\n*   -\r\n*/\r\n\r\nbizagi.rendering.desktop.combo.extend(\"bizagi.rendering.desktop.queryCombo\", {}, {\r\n    /*\r\n     *  configure Handlers for check, column included in the response\r\n     */\r\n});\r\n\r\n","/**\r\n *   Name: Bizagi Desktop queryCascadingCombo\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -\r\n */\r\n\r\nbizagi.rendering.desktop.cascadingCombo.extend(\"bizagi.rendering.desktop.queryCascadingCombo\", {}, {\r\n    /*\r\n     *  configure Handlers for check, column included in the response\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        this._super(data);\r\n        self.properties.contexttype = self.properties.contexttype || \"metadata\";\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        if (self.parentCombo !== null && self.isDependant) {\r\n            self.parentCombo.isRendered().done(function () {\r\n                $(\".ui-bizagi-render-control-included\", self.parentCombo.getRenderedElement()).hide();\r\n            });\r\n        }\r\n\r\n        this._super();\r\n    },\r\n\r\n    /*\r\n     *   Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        // Check if this is a dependant combo\r\n        var parentCombo = self.parentCombo = self.getParentCombo();\r\n        if (parentCombo !== null) {\r\n            if (parentCombo.properties.type === \"queryCascadingCombo\") {\r\n                self.isDependant = true;\r\n            }\r\n        }\r\n\r\n        // Apply element plugin, set a flag to avoid dependant combo ajax requests\r\n        self.initializingCascadingCombo = true;\r\n\r\n        // Call base\r\n        var result = this._super();\r\n\r\n        if (mode !== \"execution\") {\r\n            self.initializingCascadingCombo = false;\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n     *   Bind the combos to create the cascading feature\r\n     */\r\n    bindDependantCombo: function (dependantCombo) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Check it is a cascading combo\r\n        if (dependantCombo.properties.type === \"queryCascadingCombo\") {\r\n\r\n            // Append to dependant combos\r\n            self.dependants.push(dependantCombo);\r\n\r\n            // When this combo is selected we need to make the other combo to auto fill with an extra filter\r\n            dependantCombo.onChangeFunction = function (event, item, isInitialValue) {\r\n                // Fill items for next combo\r\n\r\n                self.refreshDependantCombo(dependantCombo, item.id, isInitialValue);\r\n\r\n                //if initial value is true, it prevents deleting the next combo\r\n                if (!isInitialValue) {\r\n                    // Clean next inputs\r\n                    dependantCombo.cleanInput();\r\n                }\r\n            };\r\n\r\n            if (!self.isEventBinded(\"select\")) {\r\n                self.bind(\"select\", dependantCombo.onChangeFunction);\r\n            }\r\n\r\n            // After the event binding has been made, we need to fill the new dependant render if this instance (the parent) has a value\r\n            if (!bizagi.util.isEmpty(self.getValue())) {\r\n\r\n                // Auto fill dependant items with current value\r\n                if (properties.hasLocalData) {\r\n                    self.refreshDependantCombo(dependantCombo, self.getValue().id);\r\n                }\r\n\r\n            }\r\n        }\r\n    },\r\n    /*\r\n     *  Method to determine if the render value can be sent to search\r\n     */\r\n    canBeSentQueryForm: function () {\r\n        return true;\r\n    }\r\n});\r\n\r\n","/*\r\n*   Name: Bizagi Render CollectionNavigator\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will define basic stuff for collection navigator renders\r\n*/\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.collectionnavigator\", bizagi.rendering.collectionnavigator.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.collectionnavigator.extend(\"bizagi.rendering.desktop.collectionnavigator\", {}, {\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        data.properties.displayType = \"value\";\r\n\r\n        // Call base\r\n        self._super(data);\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        var control = self.getControl();\r\n        self.navigationControls = control.find(\".bz-collectionnavigator-controls\");\r\n        self.canvas = self.getCanvas();\r\n        $('[title]', control).tooltip();\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        $.when(self.isRendered()).done(function() {\r\n            if (self.hasData())\r\n                self.showRow(self.getFirstRow());\r\n\r\n            self.refreshControls();\r\n        });\r\n\r\n        var controls = self.navigationControls.find(\".bz-navigation-controls\");\r\n        controls.on(\"click\", \"span\", function(ev) {\r\n            var target = ev.currentTarget;\r\n\r\n            if (!$(target).hasClass(\"ui-state-disabled\")) {\r\n                if ($(target).hasClass(\"bz-navigation-next\") && self.isValidRow()) {\r\n                    $.when(self.saveChanges({ checkSave: true })).done(function() {\r\n                        self.showRow(self.getNextRow());\r\n                    });\r\n                } else if ($(target).hasClass(\"bz-navigation-previous\") && self.isValidRow()) {\r\n                    $.when(self.saveChanges({ checkSave: true })).done(function() {\r\n                        self.showRow(self.getPreviousRow());\r\n                    });\r\n                } else if ($(target).hasClass(\"bz-navigation-first\") && self.isValidRow()) {\r\n                    $.when(self.saveChanges({ checkSave: true })).done(function() {\r\n                        self.showRow(self.getFirstRow());\r\n                    });\r\n                } else if ($(target).hasClass(\"bz-navigation-last\") && self.isValidRow()) {\r\n                    $.when(self.saveChanges({ checkSave: true })).done(function() {\r\n                        self.showRow(self.getLastRow());\r\n                    });\r\n                } else if ($(target).hasClass(\"bz-navigation-remove\")) {\r\n                    if (self.hasData()) {\r\n                        self.removeRow();\r\n                    }\r\n                } else if ($(target).hasClass(\"bz-navigation-add\")) {\r\n                    if (self.hasData() && self.isValidRow()) {\r\n                        $.when(self.saveChanges({ checkSave: true })).done(function() {\r\n                            self.addInlineRow();\r\n                        });\r\n                    } else if (!self.hasData()) {\r\n                        self.addInlineRow();\r\n                    }\r\n                } else {\r\n                    return;\r\n                }\r\n            }\r\n        });\r\n\r\n        var currentRow = self.navigationControls.find(\".bz-navigation-current-row\");\r\n        currentRow.on(\"change\", function() {\r\n            if (self.isValidRow()) {\r\n                var value = $(this).val();\r\n                $.when(self.saveChanges()).done(function() {\r\n                    self.updateRow(value);\r\n                });\r\n            }\r\n        });\r\n\r\n        // Add Form\r\n        var add = self.navigationControls.find(\".bz-collectionnavigator-addform\");\r\n        add.on(\"click\", function() {\r\n\r\n            if (self.hasData() && self.isValidRow()) {\r\n                $.when(self.saveChanges()).done(function() {\r\n                    self.addRow();\r\n                });\r\n            } else if (!self.hasData()) {\r\n                self.addRow();\r\n            }\r\n        });\r\n\r\n        // Edit Form\r\n        var edit = self.navigationControls.find(\".bz-collectionnavigator-editform\");\r\n        edit.on(\"click\", function() {\r\n            if (self.isValidRow()) {\r\n                $.when(self.saveChanges()).done(function() {\r\n                    self.editRow();\r\n                });\r\n            }\r\n        });\r\n\r\n        // Detail Form\r\n        var detail = self.navigationControls.find(\".bz-collectionnavigator-detailform\");\r\n        detail.on(\"click\", function() {\r\n            if (self.isValidRow()) {\r\n                $.when(self.saveChanges()).done(function() {\r\n                    self.showDetailForm();\r\n                });\r\n            }\r\n        });\r\n\r\n        //Save Form\r\n        var save = self.navigationControls.find(\".bz-collectionnavigator-save\");\r\n        save.on(\"click\", function() {\r\n            if (self.isValidRow()) {\r\n                var properties = self.properties;\r\n                var refreshForm = !properties.inlineEdit && self.isTherePendingInlineRow();\r\n\r\n                $.when(self.saveChanges()).done(function() {\r\n                    self.showRow(self.getRow());\r\n                });\r\n            }\r\n        });\r\n\r\n        //Cancel\r\n        var cancel = self.navigationControls.find(\".bz-collectionnavigator-cancel\");\r\n        cancel.on(\"click\", function () {\r\n            self.cancelChanges();\r\n        });\r\n\r\n        self.configureButtonsForm();\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed in read-only mode\r\n    */\r\n    postRenderReadOnly: function () {        \r\n        this.postRender();\r\n        this.configureHandlers();\r\n    },\r\n\r\n    /*\r\n    * Each time an action is executed, is necessary to refresh \r\n    * the navigation controls\r\n    */\r\n    refreshControls: function () {\r\n        var self = this;\r\n\r\n        self.refreshForwardButtons();\r\n        self.refreshBackButtons();\r\n        self.refreshPagination();\r\n        self.refreshTotal();\r\n        self.refreshRemoveAction();\r\n    },\r\n    /*\r\n    * Enabled o disabled a control (next or last)\r\n    */\r\n    refreshForwardButtons: function () {\r\n        var self = this;\r\n        var nextControl = self.getInnerControl(\"navigation\", \"next\");\r\n        var lastControl = self.getInnerControl(\"navigation\", \"last\");\r\n        var keys = self.keys.length;\r\n\r\n        if (self.hasData() && (self.pointer < keys - 1)) {\r\n            nextControl.removeClass(\"ui-state-disabled\");\r\n            lastControl.removeClass(\"ui-state-disabled\");\r\n        } else {\r\n            nextControl.addClass(\"ui-state-disabled\");\r\n            lastControl.addClass(\"ui-state-disabled\");\r\n        }\r\n    },\r\n    /*\r\n    * Enabled o disabled a control (previous or first)\r\n    */\r\n    refreshBackButtons: function () {\r\n        var self = this;\r\n        var previousControl = self.getInnerControl(\"navigation\", \"previous\");\r\n        var firstControl = self.getInnerControl(\"navigation\", \"first\");\r\n\r\n        if (self.hasData() && (self.pointer > 0)) {\r\n            previousControl.removeClass(\"ui-state-disabled\");\r\n            firstControl.removeClass(\"ui-state-disabled\");\r\n        } else {\r\n            previousControl.addClass(\"ui-state-disabled\");\r\n            firstControl.addClass(\"ui-state-disabled\");\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Enabled o disabled the remove button\r\n    */\r\n    refreshRemoveAction: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (properties.editable) {\r\n            var removeButton = self.getInnerControl(\"navigation\", \"remove\");\r\n\r\n            if (self.hasData() && !self.isTherePendingInlineRow()) {\r\n                removeButton.removeClass(\"ui-state-disabled\");\r\n            } else {\r\n                removeButton.addClass(\"ui-state-disabled\");\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Updates the current row\r\n    */\r\n    refreshPagination: function() {\r\n        var self = this;\r\n\r\n        var control = self.getInnerControl(\"navigation\", \"current\");\r\n        var keys = self.keys.length;\r\n\r\n        if (keys > 0) {\r\n            control.val(self.pointer + 1);\r\n            control.removeClass(\"ui-state-disabled\");\r\n        } else {\r\n            control.val(self.pointer);\r\n            control.addClass(\"ui-state-disabled\");\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Updates the total of rows in collection\r\n    */\r\n    refreshTotal: function () {\r\n        var self = this;\r\n\r\n        var value = self.getTotalRows();\r\n        var total = self.getInnerControl(\"navigation\", \"total\");\r\n        total.text(value);\r\n    },\r\n\r\n    /*\r\n    * Enabled o disabled the save and cancel actions\r\n    */\r\n    refreshActions: function (eSave, eCancel) {\r\n        var self = this;\r\n        var save = self.navigationControls.find(\".bz-collectionnavigator-save\");\r\n        var cancel = self.navigationControls.find(\".bz-collectionnavigator-cancel\");\r\n\r\n        eSave ? save.removeClass(\"ui-state-disabled\") : save.addClass(\"ui-state-disabled\");\r\n        eCancel ? cancel.removeClass(\"ui-state-disabled\") : cancel.addClass(\"ui-state-disabled\");\r\n    },\r\n\r\n    /*\r\n    * Gets the especific control\r\n    */\r\n    getInnerControl: function (section, action) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n        var group = null;\r\n\r\n        group = $(\"div[data-navigation-id='\" + properties.id + \"']\");\r\n\r\n        if (section) {\r\n            if (action == \"next\") {\r\n                return group.find(\".bz-navigation-next\");\r\n            }\r\n            if (action == \"last\") {\r\n                return group.find(\".bz-navigation-last\");\r\n            }\r\n            if (action == \"previous\") {\r\n                return group.find(\".bz-navigation-previous\");\r\n            }\r\n            if (action == \"first\") {\r\n                return group.find(\".bz-navigation-first\");\r\n            }\r\n            if (action == \"current\") {\r\n                return group.find(\".bz-navigation-current-row\");\r\n            }\r\n            if (action == \"total\") {\r\n                return group.find(\".bz-navigation-total-rows\");\r\n            }\r\n            if (action == \"add\") {\r\n                return group.find(\".bz-navigation-add\");\r\n            }\r\n            if (action == \"remove\") {\r\n                return group.find(\".bz-navigation-remove\");\r\n            }\r\n            if (action == \"save\") {\r\n                return group.find(\".bz-collectionnavigator-save\");\r\n            }\r\n            if (action == \"cancel\") {\r\n                return group.find(\".bz-collectionnavigator-cancel\");\r\n            }\r\n        }\r\n\r\n\r\n        return undefined;\r\n    },\r\n    /*\r\n    * Shows the navigation form, with the data specified in the row[id]\r\n    */\r\n    showRow: function(id, setFocus) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (id) {\r\n            var data = {\r\n                id: id,\r\n                requestedForm: \"navigationForm\",\r\n                url: self.properties.navigationPage,\r\n                editable: properties.editable ? properties.inlineEdit : false\r\n            };\r\n\r\n            $.when(self.renderForm(self.getParameters(data))).done(function(form) {\r\n                self.loadForm(form, setFocus);\r\n                self.refreshControls();\r\n            });\r\n        }\r\n    },\r\n    /*\r\n    * Shows the navigation form, with the data specified in the row[id]\r\n    */\r\n    showDetailForm: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Show dialog with new form after that\r\n        var dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n            title: properties.detailLabel || bizagi.localization.getResource(\"render-grid-details-form\"),\r\n            showSaveButton: false,\r\n            cancelButtonLabel: bizagi.localization.getResource(\"render-form-dialog-box-close\")\r\n        });\r\n\r\n        dialog.render(self.getParameters({ id: self.getRow(), requestedForm: \"detailForm\", url: properties.editPage, editable: false }));\r\n    },\r\n    /*\r\n    * Shows the navigation form inline, with the data specified in the row[id]\r\n    */\r\n    showInlineRow: function(id, setFocus) {\r\n        var self = this;\r\n        var data = {\r\n            id: id,\r\n            requestedForm: \"navigationForm\",\r\n            url: self.properties.navigationPage,\r\n            editable: true\r\n        };\r\n\r\n        self.startLoading();\r\n\r\n        $.when(self.renderForm(self.getParameters(data))).done(function(data) {\r\n            self.loadForm(data, setFocus);\r\n            self.refreshControls();\r\n        }).always(function() {\r\n            self.endLoading();\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Updates the navigation form, with the data specified in the row[id]\r\n    */\r\n    updateRow: function (id) {\r\n        var self = this;\r\n\r\n        if ($.isNumeric(id) && self.isValidKey(id)) {\r\n            id = parseInt(id);\r\n            self.setPointer(id);\r\n            self.showRow(self.getRow());\r\n            self.refreshControls();\r\n        } else {\r\n            self.refreshPagination();\r\n        }\r\n    },\r\n    /*\r\n    * Returns true if the key is within the range. Otherwise it returns false\r\n    */\r\n    isValidKey: function(key) {\r\n        if (key <= 0) return false;\r\n        if (key > this.keys.length) return false;\r\n        return true;\r\n    },\r\n    /*\r\n    * Renders the navigation form\r\n    */\r\n    renderForm: function (params) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n        var form = self.getFormContainer();\r\n\r\n        if (form.isLoaderDeferredSet()) {\r\n            form.appendWaitForLoader({ promise: defer.promise() });\r\n        }\r\n        \r\n        // Load template and data\r\n        $.when(self.dataService.getFormData(params)).pipe(function (data) {\r\n\r\n            // Apply contextType\r\n            data.form.contextType = params.contextType;\r\n\r\n            //delete buttons\r\n            delete data.form.buttons;\r\n\r\n            // Apply editable param\r\n            if (params.editable == false) {\r\n                data.form.properties.editable = false;\r\n            }\r\n\r\n            // The transitions don't apply in collection navigator\r\n            self.removeTransitions(data.form);\r\n            var formContainer = self.getFormContainer();\r\n\r\n            // Render dialog template\r\n            self.form = self.renderFactory.getContainer({\r\n                type: \"form\",\r\n                data: data.form,\r\n                canvas: formContainer.params.canvas || formContainer.container,\r\n                focus: params.focus || false,\r\n                selectedTabs: params.selectedTabs,\r\n                isRefresh: params.isRefresh || false\r\n            });\r\n\r\n            self.form.render();\r\n\r\n            formContainer.rendersById = $.extend(formContainer.rendersById, self.form.rendersById);\r\n         \r\n            // Publish an event to check if the form has been set in the DOM\r\n            self.form.triggerHandler(\"ondomincluded\", self.getFormContainer());\r\n\r\n            // Attach a refresh handler to recreate all the form\r\n            self.form.bind(\"refresh\", function (_, refreshParams) {\r\n                self.showRow(self.getRow());\r\n            });\r\n\r\n            self.bindRenderChangeEvent(self.form.children);\r\n\r\n            defer.resolve(self.form);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n    * This method binds the render change event of each control \r\n    * at the current form\r\n    */\r\n    bindRenderChangeEvent: function (children) {\r\n        var self = this;\r\n        children = children || [];\r\n\r\n        for (var i = 0, l = children.length; i < l; i++) {\r\n            var child = children[i];\r\n            var type = child.getElementType();\r\n            var changes;\r\n\r\n            if (type == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                child.bind(\"renderchange\", function (ev, params) {\r\n                    params = params || {}\r\n                    var render = params.render;\r\n                    var changed = params.changed;\r\n                    var isEmpty;\r\n\r\n                    if (render && (render.properties.type == \"collectionnavigator\" || render.properties.type == \"grid\")) {\r\n                        isEmpty = false;\r\n                        if (!changed && render.properties.type == \"grid\") {\r\n                            changes = [];\r\n                            var temp = $.forceCollectData;\r\n                            $.forceCollectData = false;\r\n                            self.form.hasChanged(changes);\r\n                            $.forceCollectData = temp;\r\n                            isEmpty = changes.length === 0 ? true : false;\r\n                        }\r\n                    } else {\r\n                        changes = [];\r\n                        self.form.hasChanged(changes);\r\n                        isEmpty = changes.length === 0 ? true : false;\r\n                    }\r\n\r\n                    self.refreshActions(!isEmpty, !isEmpty);\r\n                    self.triggerRenderChange();\r\n                });\r\n            } else if (type == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                self.bindRenderChangeEvent(child.children);\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Returns the elements html (canvas), where will be located the navigation form \r\n    */\r\n    getCanvas: function () {       \r\n        var control = this.getControl();\r\n        return control.find(\".bz-collectionnavigator-navigationform\");\r\n    },\r\n    /*\r\n    * Return true if the data of navigation form is valid\r\n    */\r\n    isValidRow: function() {\r\n        if (!this.form) return false;\r\n        return this.form.validationController.performValidations();\r\n    },\r\n\r\n    isSaveEnabled: function() {\r\n        var self = this;\r\n        var save = self.navigationControls.find(\".bz-collectionnavigator-save\");\r\n        var result = !save.hasClass(\"ui-state-disabled\");\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    * Saves changes in navigation form\r\n    */\r\n    saveChanges: function (params) {\r\n        var self = this;\r\n        var data = self.getChanges();\r\n        var arrayCollectionNavigator = [];\r\n        var hasChildren = false;\r\n        var checkSave = params ? (!!params.checkSave) : false;\r\n        var result, checkSaveEnabled;\r\n\r\n        if (self.form) {\r\n            var children = self.getChildCollectionNavigator(self.form.children, arrayCollectionNavigator);\r\n            hasChildren = (children.length > 0) ? true : false;\r\n        \r\n            if (hasChildren) {\r\n                self.saveChangesChildren(arrayCollectionNavigator);\r\n            }\r\n\r\n            checkSaveEnabled = self.isSaveEnabled();\r\n            if (checkSave && !checkSaveEnabled) {\r\n                result = $.Deferred().resolve({ type: \"success\" }).promise();\r\n            } else {\r\n                data.idPageCache = self.form.getPageCache();\r\n                result = self.submitSaveRequest(self.getRow(), data);\r\n            }\r\n            \r\n            return result.pipe(function (response) {\r\n                    response = response || {};\r\n                    if (response.type == \"success\") {\r\n                        // Mark data collected as original values\r\n                        self.form.collectRenderValuesForSubmit();\r\n                        self.removeInlineAddRecord();\r\n                        self.refreshControls();\r\n                        self.refreshActions(false, false);\r\n                        return self.fetchData();\r\n\r\n                    } else {\r\n                        if (response.type == \"validationMessages\") {\r\n                            var form = self.getFormContainer();\r\n                            var message = response.messages.join(\" \");\r\n                            form.failHandler({ message: message });\r\n                        }\r\n                        return false;\r\n                    }\r\n                });\r\n        } else {\r\n            self.removeInlineAddRecord();\r\n            self.refreshControls();\r\n            self.refreshActions(false, false);\r\n        }\r\n\r\n        return true;\r\n    },\r\n    /*\r\n    * Cancel changes\r\n    */\r\n    cancelChanges: function () {\r\n        var self = this;\r\n        self.refreshActions(false, false);\r\n\r\n        if (self.inlineAddRecords.length > 0) {\r\n            self.removeKey();\r\n            self.inlineAddRecords.pop();\r\n            self.submitRollbackRequest({idPageCache:self.form.properties.idPageCache});\r\n            self.refreshTotal();\r\n            self.refreshControls();\r\n\r\n            if (self.getTotalRows() == 0) {\r\n                self.removeNavigationForm();\r\n                self.drawPreview();\r\n            } else {\r\n                self.showRow(self.getRow());\r\n            }\r\n        } else {\r\n            var data = self.getChanges();\r\n            if (!$.isEmptyObject(data)) {\r\n                self.showRow(self.getRow());\r\n            }\r\n        }\r\n\r\n    },\r\n    /*\r\n    * Gets changes of current navigation form\r\n    */\r\n    getChanges: function () {\r\n        var self = this;\r\n        var data = {};\r\n\r\n        if (self.form) {\r\n            self.form.collectRenderValues(data);\r\n        }\r\n\r\n        $.each(data, function (key, value) {\r\n            var renders = self.form.getRenders(key);\r\n            $.each(renders, function (i, render) {\r\n                render.updateOriginalValue();\r\n            });\r\n        });\r\n\r\n        return data;\r\n    },\r\n    /*\r\n    *  Adds a row inline to collection\r\n    */\r\n    addInlineRow: function () {\r\n        var self = this;\r\n        var setFocus = true;\r\n\r\n        // Send add request\r\n        $.when(self.submitAddRequest())\r\n            .done(function (newid) {\r\n                self.refreshActions(true, true);\r\n                self.inlineAddRecords.push(newid);\r\n                self.addKey(newid);\r\n                self.showInlineRow(self.getLastRow(), setFocus);\r\n                self.refreshTotal();\r\n                self.refreshControls();\r\n            });\r\n    },\r\n    /*\r\n    *  Adds a row to collection\r\n    */\r\n    addRow: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Send add request\r\n        $.when(self.submitAddRequest()).done(function(newid) {\r\n\r\n            // Show dialog with new form after that\r\n            var dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n                title: properties.addLabel,\r\n                orientation: properties.orientation || \"ltr\",\r\n                onSave: function(data) {\r\n                    if (properties.contextType) {\r\n                        data[self.dataService.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = properties.contextType;\r\n                    }\r\n                    return self.submitSaveRequest(newid, data);\r\n                }\r\n            });\r\n\r\n            dialog.render(self.getParameters({\r\n                id: newid,\r\n                requestedForm: \"addForm\",\r\n                url: properties.addPage,\r\n                editable: true\r\n            })).done(function() {\r\n                // Set loading status\r\n                self.startLoading();\r\n\r\n                $.when(self.fetchData()).done(function() {\r\n                    self.showRow(self.getLastRow());\r\n                });\r\n\r\n                self.endLoading();\r\n            }).fail(function(error) {\r\n                $.when(self.submitRollbackRequest(error)).done(function() {\r\n                    self.submitInvalidatePageCacheRequest(error);\r\n                });\r\n            });\r\n        });\r\n    },\r\n    /*\r\n    * Edits a row in the collection with Form\r\n    */\r\n    editRow: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var id = self.getRow();\r\n\r\n        // Send edit request\r\n        $.when(self.submitEditRequest(id)).done(function() {\r\n\r\n            // Show dialog with new form\r\n            var dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n                title: properties.editLabel,\r\n                orientation: properties.orientation || \"ltr\",\r\n                onSave: function(data) {\r\n                    return self.submitSaveRequest(id, data);\r\n                }\r\n            });\r\n\r\n            dialog.render(self.getParameters({\r\n                id: id,\r\n                requestedForm: \"editForm\",\r\n                url: self.properties.editPage,\r\n                editable: true\r\n            })).done(function() {\r\n                $.when(self.fetchData()).done(function() {\r\n                    self.showRow(self.getRow());\r\n                });\r\n            }).fail(function(error) {\r\n                $.when(self.submitRollbackRequest(error)).done(function() {\r\n                    self.submitInvalidatePageCacheRequest(error);\r\n                });\r\n            });\r\n        });\r\n    },\r\n    /*\r\n    * removes current row\r\n    */\r\n    removeRow: function() {\r\n        var self = this;\r\n        var id = self.getRow();\r\n\r\n        bizagi.showConfirmationBox(this.getResource(\"render-grid-delete-confirmation\")).done(function() {\r\n            // Do a collection record deletion\r\n            $.when(self.submitDeleteRequest(id)).done(function(data) {\r\n                data = data || {};\r\n                if (data.type == \"success\") {\r\n                    // Set loading status\r\n                    self.startLoading();\r\n\r\n                    self.removeKey();\r\n                    self.refreshTotal();\r\n                    self.refreshControls();\r\n\r\n                    if (self.getTotalRows() == 0) {\r\n                        self.removeNavigationForm();\r\n                        self.drawPreview();\r\n                    } else {\r\n                        self.showRow(self.getRow());\r\n                    }\r\n\r\n                    self.endLoading();\r\n                }\r\n            });\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Removes of local list the rows added inline\r\n    */\r\n    removeInlineAddRecord: function () {\r\n        var self = this;\r\n\r\n        if (self.isTherePendingInlineRow()) {\r\n            self.inlineAddRecords.pop();\r\n        }\r\n    },\r\n    /*\r\n    * Loads form in canvas\r\n    */\r\n    loadForm: function (form, setFocus) {\r\n        var self = this;\r\n\r\n        self.removeNavigationForm();\r\n        var buttons = form.container.find(\".ui-bizagi-button-container\");\r\n        buttons.remove();\r\n        self.addNavigationForm(form.container);\r\n\r\n        if (setFocus) {\r\n            self.focusFirstControl(form);\r\n        }\r\n    },\r\n    /*\r\n    * Method to process button actions in the form\r\n    */\r\n    configureButtonsForm: function() {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var originalProcessButton = form.processButton;\r\n        \r\n\r\n        form.processButton = function(buttonProperties) {\r\n            \r\n            // Deferred is defined in order to avoid a permanent overlay after submitting with custom buttons\r\n            var deferred = $.Deferred();\r\n            var valid = true;\r\n            if (!self.form || buttonProperties.action == \"\") {\r\n                form.originalProcessButton.apply(form, [buttonProperties]).done(function() {\r\n                    deferred.resolve();\r\n                }).fail(function(){\r\n                    deferred.reject();\r\n                });\r\n            } else if (buttonProperties.action == \"save\") {\r\n                $.when(self.saveChanges({ checkSave: true })).done(function() {\r\n                    form.originalProcessButton.apply(form, [buttonProperties]);\r\n                    deferred.resolve();\r\n                }).fail(function(error) {\r\n                    self.processFailMessage(error);\r\n                    deferred.resolve();\r\n                });\r\n            } else if (buttonProperties.action == \"next\" || buttonProperties.action == \"createnewcase\") {\r\n                // Process to save form\r\n\r\n                valid = self.isValid([]);\r\n                if (buttonProperties.validate && valid) {\r\n                    $.when(self.saveChanges()).done(function() {\r\n                        form.originalProcessButton.apply(form, [buttonProperties]);\r\n                        deferred.resolve();\r\n                    }).fail(function(error) {\r\n                        self.processFailMessage(error);\r\n                        deferred.resolve();\r\n                    });\r\n                } else {\r\n                    if (valid) {\r\n                        $.when(self.saveChanges()).done(function() {\r\n                            form.originalProcessButton.apply(form, [buttonProperties]);\r\n                            deferred.resolve();\r\n                        }).fail(function(error) {\r\n                            self.processFailMessage(error);\r\n                            deferred.resolve();\r\n                        });\r\n                    } else {\r\n                        form.originalProcessButton.apply(form, [buttonProperties]);\r\n                        deferred.resolve();\r\n                    }\r\n                }\r\n            } else if (buttonProperties.action == \"nextWithoutValidations\") {                \r\n                $.when(self.saveChanges()).done(function() {\r\n                    form.originalProcessButton.apply(form, [buttonProperties]);\r\n                    deferred.resolve();\r\n                }).fail(function(error) {\r\n                    self.processFailMessage(error);\r\n                    deferred.resolve();\r\n                });\r\n            }\r\n            return deferred.promise();\r\n        };\r\n    },\r\n    /*\r\n    * Removes navigation form\r\n    */\r\n    removeNavigationForm: function () {        \r\n        this.canvas.children().remove();\r\n    },\r\n    /*\r\n    * Adds navigation form\r\n    */\r\n    addNavigationForm: function (content) {        \r\n        this.canvas.append(content);\r\n    },\r\n    /*\r\n    *   Method to fetch data from the server and then update the data\r\n    */\r\n    fetchData: function () {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        // Start loading to avoid multiple calls to the server\r\n        self.startLoading();\r\n        $.when(self.getRemoteData()).done(function (data) {\r\n                self.endLoading();\r\n                if (self.disposed) return;\r\n                if (data) {\r\n                    self.refresh(data);\r\n                    defer.resolve();\r\n                } else {\r\n                    defer.reject();\r\n                }\r\n            });\r\n\r\n        return defer.promise();\r\n    },\r\n    /*\r\n    * Verify if data is different the filter\r\n    */\r\n    refresh: function (data) {\r\n        var self = this;\r\n        var keys = self.getKeys(data.rows);\r\n        self.keys = keys;\r\n\r\n        if (keys.indexOf(self.getRow()) == -1) {\r\n            self.totalRows = keys.length;\r\n            self.pointer = (self.pointer > 0) ? self.pointer - 1 : self.pointer;\r\n            if (self.totalRows == 0) {\r\n                self.removeNavigationForm();\r\n                self.drawPreview();\r\n                self.refreshControls();\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    * Sets the focus to the first control\r\n    */\r\n    focusFirstControl: function (form, time) {\r\n        // Configures effect\r\n        var effect = function () {\r\n            var defaultControl = $(\"input:visible, select:visible, option:visible, textarea:visible\", form.container).not(\".ui-bizagi-render-date,.ui-bizagi-render-search\");\r\n            if (defaultControl.length > 0) {\r\n                // Focus control\r\n                var innerControl = defaultControl[0];\r\n                try {\r\n                    innerControl.focus();\r\n                } catch (e) {\r\n                }\r\n            }\r\n        };\r\n\r\n        // Run effect\r\n        if (time > 0) {\r\n            setTimeout(effect, time);\r\n        } else {\r\n            effect();\r\n        }\r\n    },\r\n    /*\r\n    * Return array with children of type collectionnavigator\r\n    */\r\n    getChildCollectionNavigator: function(children, arrayCollectionNavigator) {\r\n        var self = this;\r\n        children = children || [];\r\n\r\n        for (var i = 0, l = children.length; i < l; i++) {\r\n            var child = children[i];\r\n            var type = child.getElementType();\r\n            if (type == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                if (child.properties.type == \"collectionnavigator\" || child.properties.type == \"grid\") {\r\n                    arrayCollectionNavigator.push(child);\r\n                }\r\n            } else if (type == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                self.getChildCollectionNavigator(child.children, arrayCollectionNavigator);\r\n            }\r\n        }\r\n        return arrayCollectionNavigator\r\n    },\r\n    /*\r\n    *save changes for children of type collectionnavigator\r\n    */\r\n    saveChangesChildren: function (arrayCollectionNavigator) {\r\n        for (var i = 0, l = arrayCollectionNavigator.length; i < l; i++) {\r\n            if (arrayCollectionNavigator[i].properties.type == \"collectionnavigator\") {\r\n                arrayCollectionNavigator[i].saveChanges();\r\n            }\r\n        }\r\n    },\r\n\r\n    drawControls: function (html) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        html = $(html);\r\n        var controls = self.collectionControls = $(\".bz-collectionnavigator-controls\", html);\r\n\r\n        self.drawForms(controls);\r\n        self.drawControl(controls);\r\n\r\n        if (properties.editable)\r\n            self.drawActions(controls);\r\n\r\n        return html[0].outerHTML;\r\n    },\r\n    /*  render several actions in the navigation palete\r\n    *  ex. save, cancel \r\n    */\r\n    drawActions: function (controls) {\r\n        var self = this;\r\n        var actions = $(\".actions-group\", controls);\r\n    \r\n        var template = self.renderFactory.getTemplate(\"collectionnavigator-actions\");\r\n        var html = $.tmpl(template);\r\n        html.appendTo(actions);\r\n\r\n        return controls;\r\n    },\r\n\r\n    /*\r\n    * Render navigation controls (next, previous, last, first. etc )\r\n    */\r\n    drawControl: function (controls) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var editable = properties.editable;\r\n        var control = $(\".control-group\", controls);\r\n\r\n        var template = self.renderFactory.getTemplate(\"collectionnavigator-control\");\r\n        var html = $.tmpl(template, {\r\n            inlineAdd: editable && properties.inlineAdd,\r\n            allowDelete: editable && properties.allowDelete,\r\n            total: self.totalRows\r\n        });\r\n\r\n        html.appendTo(control);\r\n\r\n        return controls;\r\n    },\r\n\r\n    /*\r\n    * Draw forms options (add form, edit form, navigation form)\r\n    */\r\n    drawForms: function(controls) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var withAddForm = properties.withAddForm;\r\n        var withEditForm = properties.withEditForm;\r\n        var allowDetail = properties.allowDetail;        \r\n        var html = null;\r\n        var forms = $(\".bz-navigation-group\", controls);\r\n\r\n        if (properties.editable && (withAddForm || withEditForm || allowDetail)) {\r\n            forms.addClass(\"group-visible\");\r\n\r\n            if (withAddForm) {\r\n                html = self.getActionsTemplate(\"add\");\r\n                html.appendTo(forms);\r\n            }\r\n\r\n            if (withEditForm) {\r\n                html = self.getActionsTemplate(\"edit\");\r\n                html.appendTo(forms);\r\n            }\r\n\r\n            if (allowDetail) {\r\n                html = self.getActionsTemplate(\"details\");\r\n                html.appendTo(forms);\r\n            }\r\n\r\n        } else {\r\n            forms.addClass(\"group-no-visible\");\r\n        }\r\n\r\n\r\n        return controls;\r\n    },\r\n\r\n    /*\r\n    * This method removes the transitions\r\n    */\r\n    removeTransitions: function (data) {\r\n        data = data || {};\r\n\r\n        if (data.transitions) {\r\n            delete data.transitions;\r\n        }\r\n    },\r\n\r\n    collectData: function (renderValues) {\r\n        var saveDeferred;\r\n        if (this.isRendered()) {\r\n            saveDeferred = this.saveChanges({ checkSave: true });\r\n\r\n            renderValues.deferreds = renderValues.deferreds || [];\r\n            renderValues.deferreds.push(saveDeferred);\r\n        }\r\n    },\r\n\r\n    getActionsTemplate: function(type) {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"collectionnavigator-form-button\");\r\n        var html = null;\r\n\r\n        switch (type) {\r\n            case \"add\":                \r\n                html = $.tmpl(template, {\r\n                    actionClass: \"bz-collectionnavigator-addform\",\r\n                    buttonClass: \"ui-icon bz-collectionnavigator-addform-icon\",\r\n                    title: bizagi.localization.getResource(\"render-collection-navigator-add-form\")\r\n                });\r\n                break;\r\n            case \"edit\":                \r\n                html = $.tmpl(template, {\r\n                    actionClass: \"bz-collectionnavigator-editform\",\r\n                    buttonClass: \"ui-icon bz-collectionnavigator-editform-icon\",\r\n                    title: bizagi.localization.getResource(\"render-collection-navigator-edit-form\")\r\n                });\r\n                break;\r\n            case \"details\":                \r\n                html = $.tmpl(template, {\r\n                    actionClass: \"bz-collectionnavigator-detailform\",\r\n                    buttonClass: \"ui-icon bz-collectionnavigator-detailform-icon\",\r\n                    title: bizagi.localization.getResource(\"render-collection-navigator-details-form\")\r\n                });\r\n                break;\r\n            }\r\n\r\n        return html;\r\n    }\r\n\r\n});","/*\r\n *   Name: Bizagi Desktop Render ECM file upload control\r\n *   Author: Edward Morales\r\n *   Comments:\r\n *   -   This script extend some functionalities of file upload control\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.ecm\", {    \r\n    // Statics\r\n    BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n    BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\r\n    BA_PAGE_CACHE: bizagi.render.services.service.BA_PAGE_CACHE    \r\n}, bizagi.rendering.ecm.prototype)\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.ecm.extend(\"bizagi.rendering.desktop.ecm\", {}, {\r\n    renderControl: function (listControl, fileProperties) {\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var dateFormat = this.getResource(\"dateFormat\");\r\n        var timeFormat = this.getResource(\"timeFormat\");\r\n        var mode = self.getMode();\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        properties.maxSize = Number(properties.maxSize) || (typeof (BIZAGI_SETTINGS) !== \"undefined\" && typeof (BIZAGI_SETTINGS.UploadMaxFileSize) !== \"undefined\" ? Number(BIZAGI_SETTINGS.UploadMaxFileSize) : properties.maxSize = Number(properties.maxSize) || 4091904);\r\n        properties.maxFiles = Number(properties.maxfiles) || 999;\r\n        properties.validExtensions = properties.validExtensions || \"\";\r\n\r\n        if (properties.validExtensions.length > 0 && properties.validExtensions.indexOf(\".\") < 0) {\r\n            var singleExtensions = properties.validExtensions.split(\";\");\r\n\r\n            for (var i = 0, length = singleExtensions.length; i < length; i++) {\r\n                singleExtensions[i] = \"*.\" + singleExtensions[i];\r\n            }\r\n\r\n            properties.validExtensions = singleExtensions.join(\";\");\r\n        }\r\n\r\n        properties.addUrl = properties.addUrl || self.dataService.getUploadAddUrl();\r\n        properties.deleteUrl = properties.deleteUrl || undefined;\r\n        properties.allowDelete = bizagi.util.parseBoolean(properties.allowDelete) !== null ? bizagi.util.parseBoolean(properties.allowDelete) : true;\r\n        properties.q_xpath = bizagi.util.encodeXpath(self.getUploadXpath());\r\n\r\n        // We will hold here the value to display\r\n        properties.displayValue = \"\";\r\n        properties.showTime = properties.showTime !== undefined ? bizagi.util.parseBoolean(properties.showTime) : false;\r\n        properties.dateFormat = properties.dateFormat || dateFormat;\r\n        properties.timeFormat = properties.timeFormat || timeFormat;\r\n        properties.fullFormat = properties.dateFormat;\r\n\r\n        // Fix dateFormat for datepicker\r\n        properties.datePickerFormat = properties.dateFormat.replaceAll(\"M\", \"m\"); // Fix months\r\n        properties.datePickerFormat = properties.datePickerFormat.replaceAll(\"yyyy\", \"yy\"); // Fix years\r\n        properties.datePickerFormat = properties.datePickerFormat.replaceAll(\"dddd\", \"DD\"); // Fix days\r\n        properties.datePickerFormat = properties.datePickerFormat.replaceAll(\"mmmm\", \"MM\"); // Fix days\r\n\r\n        // Set files property\r\n        self.files = properties.value || [];\r\n        self.filesCount = self.files.length;\r\n\r\n        // define xpath context if coming from grid column\r\n        properties.xpathContext = this.parent.properties.xpathContext || properties.xpathContext || \"\";\r\n\r\n        // Set control container to behave as a block\r\n        control.addClass(\"ui-bizagi-render-display-block\");\r\n        control.addClass(\"ui-bizagi-render-upload\");\r\n        control.addClass(\"ui-bizagi-render-ecm\");\r\n        $(control).closest(\".ui-bizagi-control-wrapper\").addClass(\"ui-bizagi-control-wrapper-ecm\");\r\n\r\n        // First run show render options\r\n        self.properties.showRenderOptions = true;\r\n\r\n        // Call service and render control\r\n        if (mode == \"execution\") {\r\n            self.renderUploadItem();\r\n        } else {\r\n            control.append(\"<div class='ui-icon ecm-file'></div>\");\r\n        }\r\n\r\n        // Check number of files and hide or show button to upload\r\n        self.checkMaxFiles();\r\n\r\n        \r\n        self.preventDefaultForAnchorTag();\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        data = self.buildAddParams();\r\n        data.networkSpeed = networkSpeed();\r\n\r\n        $(\".biz-render-ecm-upload-wrapper\", control).bizagiUpload({\r\n            renderReference: this,\r\n            dialogTemplate: self.renderFactory.getTemplate(\"upload.ecm.dialog\"),\r\n\r\n            properties: data,\r\n            uploadedFiles: self.filesCount,\r\n            isECM: true,\r\n\r\n            onUploadFileCompletedCallback: self.onUploadFileCompleted,\r\n            dialogTitle: self.getResource(\"render-upload-link-label\")\r\n        });\r\n    },\r\n\r\n    configureUploadHandlers: function (reference, extraData, control) {\r\n        var self = reference;\r\n        var properties = self.properties;\r\n        var data = self.buildUpgradeParams(control);\r\n\r\n        $(control).bizagiUpload({\r\n            renderReference: self,\r\n            dialogTemplate: self.renderFactory.getTemplate(\"upload.ecm.dialog\"),\r\n\r\n            properties: data,\r\n            uploadedFiles: self.filesCount,\r\n            isECM: true,\r\n            isUpdatingECM: true,\r\n\r\n            onUploadFileCompletedCallback: self.onUpdateUploadFileCompleted,\r\n            dialogTitle: self.getResource(\"render-upload-link-label\")\r\n        });\r\n\r\n    },\r\n\r\n    onUpdateUploadFileCompleted: function (renderReference, data, control, response) {\r\n        var self = renderReference;\r\n\r\n        control.empty();\r\n        self.waiting(control, true);\r\n        self.filesCount++;\r\n\r\n        self.renderFileLayout(self, data, control, response);\r\n    },\r\n\r\n    renderUploadItem: function (listControl, fileProperties) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var control = self.getControl();\r\n        var template = self.renderFactory.getTemplate(\"upload-ecm-view-default\");\r\n        var properties = self.properties;\r\n\r\n        properties.value = (fileProperties) ? [[fileProperties.idFileUpload, fileProperties.fileName]] : self.value;\r\n\r\n        // If there's an error it displays a dialog and stops this method\r\n        if (typeof (fileProperties) != \"undefined\" && typeof (fileProperties.status) != \"undefined\" && fileProperties.status == \"error\") {\r\n            bizagi.showMessageBox(fileProperties.message);\r\n            return;\r\n        }\r\n\r\n        $.when($.tmpl(template, properties, {\r\n            getFileExtension: self.getFileExtension,\r\n            isImage: self.isImage,\r\n            allowSendInMail: properties.allowSendInMail\r\n        })).done(function (controlContent) {\r\n            // Append content\r\n            if (listControl && listControl.length > 0) {\r\n                controlContent.insertAfter(listControl.last());\r\n            } else {\r\n                control.append(controlContent);\r\n            }\r\n\r\n            //Remove load information tab\r\n            control.find(\".uploadifyQueueItem\").remove();\r\n\r\n            // Load metadata for each file\r\n            if (self.properties.value != undefined) {\r\n                $.each(self.properties.value, function (key, value) {\r\n                    var data = {};\r\n\r\n                    data.idFileUpload = value[0] || value.uploadId;\r\n                    data.fileName = value[1] || value.fileName;\r\n                    data.idPageCache = self.properties.idPageCache;\r\n                    data.xpathContext = self.getXpathContext();\r\n\r\n                    data.xPath = self.properties.xpath;\r\n                    data.idAttrib = self.properties.idAttrib;\r\n\r\n                    if (mode == \"execution\") {\r\n                        self.renderFileLayout(self, data, $(\".\" + self.properties.id + \"-\" + data.idFileUpload, control), fileProperties);\r\n                    }\r\n                });\r\n            }\r\n\r\n            // set event sendmail\r\n            if (self.properties.allowSendInMail) {\r\n                self.bindEmailDialog();\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Bind dialog for send email\r\n     */\r\n    bindEmailDialog: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var xpathContext = self.getXpathContext() || \"\";\r\n        var xpath = self.properties.xpath;\r\n\r\n        $(\".ui-bizagi-render-ecm-sendmail\", control).bizagiSendEmail({\r\n            tmpl: self.renderFactory.getTemplate(\"dialog-send-email\"),\r\n            value: self.value,\r\n            self: self,\r\n            dataService: self.dataService,\r\n            properties: self.properties,\r\n            xpath: xpath,\r\n            xpathContext: xpathContext\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Render file layout     \r\n     */\r\n    renderFileLayout: function (self, data, fileControl, fileProperties) {\r\n        self = self || this;\r\n        var form = self.getFormContainer();\r\n        var metadataTemplate = self.renderFactory.getTemplate(\"upload-ecm-view-default-metadata\");\r\n\r\n        var imageConfig = { zIndex: $.getMaxZindex() + 1 };\r\n        var originalData = $.extend({}, data);\r\n        var metadataParams = fileProperties ? [fileProperties] : self.dataService.metadataECMMultiaction().getFileProperties(originalData);\r\n\r\n        $.when(self.dataService.metadataECMMultiaction().getECMMetadata(data), metadataParams)\r\n            .done(function (metaData, fileProperties) {\r\n\r\n                self.waiting(fileControl, true);\r\n\r\n                if (Array.isArray(fileProperties)) {\r\n                    fileProperties = fileProperties[0];\r\n                }\r\n\r\n                if (Array.isArray(metaData)) {\r\n                    metaData = metaData[0];\r\n                }\r\n\r\n                fileProperties.data = data;\r\n\r\n                // Make xpath context\r\n                fileProperties.xpathContext = fileProperties.xpathContext || form.properties.xpathContext || \"\";\r\n                fileProperties.xpath = self.properties.xpath;\r\n\r\n                metaData.filename = data.fileName;\r\n                metaData.url = self.buildItemUrl(fileProperties);\r\n\r\n                // Define File Properties\r\n                metaData.ecm_ecmStatus = fileProperties.ecmStatus;\r\n                metaData.ecm_isVisible = fileProperties.isVisible;\r\n                metaData.ecm_allowUpdateMetadata = fileProperties.allowUpdateMetadata;\r\n                metaData.ecm_allowDelete = fileProperties.allowDelete;\r\n                metaData.ecm_allowUpdateContent = fileProperties.allowUpdateContent;\r\n                metaData.ecm_allowView = fileProperties.allowView;\r\n                metaData.ecm_allowCheckOut = fileProperties.allowCheckOut;\r\n                metaData.ecm_allowCancelCheckOut = fileProperties.allowCancelCheckOut;\r\n                metaData.ecm_allowEdit = fileProperties.allowEdit;\r\n                metaData.idFileUploads = fileProperties.idFileUpload;\r\n                metaData.xpath = fileProperties.xpath;\r\n                metaData.value = bizagi.util.parseBoolean(fileProperties.value);\r\n\r\n                // Check if file its image\r\n                var container = fileControl.parent().find('.extension:last');\r\n                if (self.isImage(metaData.filename)) {\r\n                    // Append image\r\n                    container.empty();\r\n                    container.append('<img>');\r\n                    var image = container.find('img');\r\n\r\n                    // Add class thumbnail\r\n                    container.addClass('thumb-image');\r\n\r\n                    image.attr({ src: metaData.url, width: 32, height: 32 });\r\n\r\n                    image.imageZoom(imageConfig);\r\n\r\n                    $(\".checkuot , .readonly\", fileControl.parent()).off(\"click\").on('click', function () {\r\n                        image.click();\r\n                    });\r\n                } else {\r\n                    fileControl.parent().find('li:first').off(\"click\").on('click', function (e) {\r\n                        e.stopPropagation();\r\n                        window.open(metaData.url);\r\n                    });\r\n                }\r\n\r\n                // Check if file is visible\r\n                if (fileProperties.isVisible) {\r\n                    fileControl.empty();\r\n\r\n                    var dataItem = $.extend(metaData, {\r\n                        showMetadata: self.properties.showMetadata,\r\n                        orientation: form.properties.orientation || \"ltr\"\r\n                    });\r\n\r\n                    $.when($.tmpl(metadataTemplate, dataItem).appendTo(fileControl)).done(function () {\r\n                        // Bind options\r\n                        $(\".ecm-options-slide li\", fileControl).hover(function () {\r\n                            $(this).toggleClass(\"ecm-options-slide-hover\");\r\n                        });\r\n\r\n                        // Check if file its image\r\n                        if (self.isImage(metaData.filename)) {\r\n                            $(\".filename a\", fileControl).imageZoom(imageConfig);\r\n                        }\r\n\r\n                        // Set global events\r\n                        self.setControlEvents(fileControl, data);\r\n\r\n                        // Make Instance of file upload\r\n                        if (metaData.ecm_allowUpdateContent) {\r\n                            self.configureUploadHandlers(self, data, fileControl, fileProperties);\r\n                        }\r\n\r\n                        // Verify security of file\r\n                        switch (fileProperties.ecmStatus) {\r\n                            case 1: //LOCAL\r\n                                break;\r\n                            case 2: //PERSISTED\r\n                                fileControl.parent().find(\".checkuot\").css(\"visibility\", \"hidden\");\r\n                                fileControl.parent().find(\".checkuot\").hide();\r\n\r\n                                break;\r\n                            case 3: //DELETED\r\n                                break;\r\n                            case 4: //READONLY\r\n                                // Hide control options\r\n                                $(\".emc-options\", fileControl).hide();\r\n\r\n                                // Disable event to edit meta data                                \r\n                                fileControl.parent().find(\".readonly\").css(\"visibility\", \"visible\");\r\n                                fileControl.parent().find(\".readonly\").show();\r\n                                break;\r\n                            case 5: //CHECKEDOUT\r\n                                fileControl.parent().find(\".checkuot\").css(\"visibility\", \"visible\");\r\n                                fileControl.parent().find(\".checkuot\").show();\r\n                                break;\r\n                            case 6: //UNDEFINED\r\n                                bizagi.debug(\"ECM control return undefined status\", fileProperties);\r\n                                break;\r\n                            default:\r\n                                fileControl.parent().find(\".checkuot\").css(\"visibility\", \"hidden\").hide();\r\n                                fileControl.parent().find(\".readonly\").css(\"visibility\", \"hidden\").hide();\r\n                                break;\r\n                        }\r\n\r\n                        // Set Events\r\n                        // Check if the control its readonly\r\n                        if (bizagi.util.parseBoolean(self.properties.editable)) {\r\n                            var multiClickControl = true;\r\n                            fileControl.data(\"pluginAvailable\", false);\r\n\r\n                            $(\".emc-options\", fileControl).on('click', function (evt) {\r\n                                evt.stopPropagation();\r\n\r\n                                // Block multi click\r\n                                if (multiClickControl) {\r\n                                    multiClickControl = false;\r\n\r\n                                    var toggleOptions = function (fileControl) {\r\n                                        var def = new $.Deferred();\r\n                                        var modalEcm = $(\".modal-ecm\", fileControl);\r\n                                        var control = self.control;\r\n                                        // Show slide options\r\n                                        if (modalEcm.is(\":visible\")) {\r\n                                            $(\".modal-ecm\", control).hide();\r\n                                            $(\".ecm-options-slide\", modalEcm).hide();\r\n                                            modalEcm.hide();\r\n                                            def.resolve(true);\r\n                                        } else {\r\n\r\n                                            var displayOptionsContent = function () {\r\n                                                $(\".modal-ecm\", control).hide();\r\n                                                $(\".ecm-options-slide\", modalEcm).show();\r\n\r\n                                                modalEcm.show().position({\r\n                                                    my: \"center top\",\r\n                                                    at: \"center bottom\",\r\n                                                    of: $(\".emc-options\", fileControl),\r\n                                                    collision: \"none\"\r\n                                                });\r\n                                            }\r\n\r\n                                            //  Hides the control when click somewhere else\r\n                                            self.configureToggleHandlers();\r\n\r\n                                            def.resolve(true);\r\n\r\n                                            //Check if is the ECM is Async \r\n                                            if (self.properties.isAsync !== undefined) {\r\n\r\n                                                if (!metaData.ecm_allowUpdateContent)\r\n                                                    $(\".ecm-options-upgrade\", modalEcm).hide();\r\n\r\n                                                //it's a flag to prevent multiple sever queries\r\n                                                if (self.asynCheckEnabled === undefined) {\r\n\r\n                                                    self.asynCheckEnabled = true;\r\n\r\n                                                    self.asyncCheckTimeout = setTimeout(function () {\r\n                                                        //Clear the flag, to enable the interaction\r\n                                                        self.asynCheckEnabled = undefined;\r\n                                                        self.asyncCheckTimeout = undefined;\r\n                                                    }, 2000);\r\n\r\n                                                    //Checks if the control already have check if the file is on ECM\r\n                                                    if (!data.IsFileOnECM) {\r\n\r\n                                                        //Pre hide the elements, so when the services response, show or hide the elements we need\r\n                                                        $(\".ecm-options-checkout\", modalEcm).hide();\r\n                                                        $(\".ecm-options-cancelcheckout\", modalEcm).hide();\r\n                                                        $(\".ecm-options-upgrade\", modalEcm).hide();\r\n\r\n                                                        //invokes the server to retrieve the file status\r\n                                                        $.when(self.dataService.isFileOnECM({ \"idUpload\": data.idFileUpload }))\r\n                                                            .done(function (result) {\r\n\r\n                                                                //Checks the service response, and show/hide the desired controls\r\n                                                                if (result.IsFileOnECM) {\r\n\r\n                                                                    if (metaData.ecm_allowUpdateContent)\r\n                                                                        $(\".ecm-options-upgrade\", modalEcm).show();\r\n\r\n                                                                    if (metaData.ecm_allowCheckOut)\r\n                                                                        $(\".ecm-options-checkout\", modalEcm).show();\r\n\r\n                                                                    if (metaData.ecm_allowCancelCheckOut)\r\n                                                                        $(\".ecm-options-cancelcheckout\", modalEcm).show();\r\n                                                                }\r\n\r\n                                                                //Stores the server response, so if the response is true, prevents the service recall\r\n                                                                data.IsFileOnECM = result.IsFileOnECM;\r\n\r\n                                                                //Show the content\r\n                                                                displayOptionsContent();\r\n\r\n                                                            }).fail(function (error) {\r\n                                                                bizagi.log(\"isFileOnECM error\");\r\n                                                            });\r\n                                                    } else {\r\n                                                        displayOptionsContent();\r\n                                                    }\r\n                                                }\r\n                                            } else {\r\n                                                displayOptionsContent();\r\n                                            }\r\n                                        }\r\n\r\n                                        return def.promise();\r\n                                    };\r\n\r\n                                    $.when(toggleOptions(fileControl)).done(function () {\r\n                                        multiClickControl = true;\r\n                                    });\r\n                                }\r\n                            });\r\n                        } else {\r\n                            $(\".emc-options\", fileControl).hide();\r\n                            $(self.getControl()).trigger('ecmLoaded', { container: container });\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n    },\r\n\r\n    /*\r\n    * Bind events for control\r\n    */\r\n    setControlEvents: function (control, params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var globalControl = self.getControl();\r\n\r\n        // Bind for delete options\r\n        $(\".ecm-options-delete\", control).on('click', function (e) {\r\n            e.stopPropagation();\r\n\r\n            $(\".emc-options\", control).click();\r\n            var message = $(\".biz-render-ecm-delete-confirmation\", globalControl).first().clone();\r\n            message.dialog({\r\n                resizable: false,\r\n                modal: true,\r\n                title: self.getResource(\"render-ecm-confirm-title\"),\r\n                buttons: [\r\n                    {\r\n                        text: self.getResource(\"render-ecm-confirm-bt-delete\"),\r\n                        click: function () {\r\n                            delete params.prepare; // Ensure run Ajax\r\n                            self.dataService.deleteECMFile(params);\r\n                            $(this).dialog(\"close\");\r\n                            control.parent(\"ul\").hide(\"highlight\", {}, 100);\r\n\r\n                            //Set files in a temporal array\r\n                            var files = [].concat(self.files);\r\n\r\n                            //Remove element form files array\r\n                            for (var i = 0; i < files.length; i++) {\r\n                                if (files[i][0] == params.idFileUpload) files.splice(i, 1);\r\n                            }\r\n\r\n                            //Set Value\r\n                            self.setValue(files);\r\n\r\n                            // Check maxFiles\r\n                            self.checkMaxFiles();\r\n                        }\r\n                    },\r\n                    {\r\n                        text: self.getResource(\"render-ecm-confirm-bt-cancel\"),\r\n                        click: function () {\r\n                            $(this).dialog(\"close\");\r\n                        }\r\n                    }\r\n                ]\r\n            });\r\n        });\r\n\r\n        // Bind for cancelcheckout options\r\n        $(\".ecm-options-cancelcheckout\", control).on('click', function (e) {\r\n            e.stopPropagation();\r\n\r\n            //Close popup\r\n            $(\".emc-options\", control).click();\r\n\r\n            self.waiting(control, false);\r\n            control.find(\".filename\").empty();\r\n\r\n            delete params.prepare; // Ensure run Ajax\r\n            $.when(self.dataService.cancelCheckOut(params))\r\n                .done(function (fileProperties) {\r\n                    self.renderFileLayout(self, params, control, fileProperties);\r\n                });\r\n        });\r\n\r\n        // Bind for checkout options\r\n        $(\".ecm-options-checkout\", control).off('click').on('click', function (e) {\r\n            e.stopPropagation();\r\n\r\n            //Close popup\r\n            $(\".meta-data-wrapper\", control).click();\r\n            self.waiting(control, false);\r\n            control.find(\".filename\").empty();\r\n            \r\n            delete params.prepare; // Ensure run Ajax\r\n            $.when(self.dataService.checkOutFile(params)).done(\r\n                function (fileProperties) {\r\n                    self.renderFileLayout(self, params, control, fileProperties);\r\n                });\r\n        });\r\n\r\n        // Bind for edit metadata\r\n        // Check if the ECM status is READONLY = 4\r\n        if ($(\".ecm-metadata-value\", control).data(\"ecmstatus\") != 4 && $(\".ecm-metadata-value\", control).data(\"allowupdatemetadata\")) {\r\n            $(\".ecm-metadata-value\", control).bind('activeeditmode', function (e) {\r\n                e.stopPropagation();\r\n\r\n                // Check read only\r\n                if (!$(this).data(\"readonly\")) {\r\n                    // Check propagation\r\n                    if ($(this).data(\"edit-mode\") == \"false\" || $(this).data(\"edit-mode\") == \"\") {\r\n                        $(this).data(\"edit-mode\", \"true\");\r\n\r\n                        switch ($(this).data(\"metadatatype\")) {\r\n                            case \"STRING\":\r\n                                self.makeStringMetaDataControler($(this), control);\r\n                                break;\r\n                            case \"INTEGER\":\r\n                                self.makeStringMetaDataControler($(this), control, function (value) {\r\n                                    // validation function\r\n                                    var valueMatch = value.match(/\\d+/);\r\n                                    return (valueMatch != null && valueMatch[0] == valueMatch['input']);\r\n                                });\r\n                                break;\r\n                            case \"DATETIME\":\r\n                                self.makeDatetimeMetaDataControler($(this), control);\r\n                                break;\r\n                            case \"DECIMAL\":\r\n                                self.makeStringMetaDataControler($(this), control, function (value, separator) {\r\n                                    // validation function\r\n                                    var numericFormat = self.getResource('numericFormat');\r\n\r\n                                    var reg = new RegExp(\"\\\\d+(\\\\\" + numericFormat.decimalSymbol + \"\\\\d)*\");\r\n                                    var valueMatch = value.match(reg);\r\n                                    try {\r\n                                        var lastChar = value.substr(value.length - 1, 1);\r\n                                    } catch (e) {\r\n                                        return false;\r\n                                    }\r\n                                    return (valueMatch != null && (valueMatch[0] == valueMatch['input'] || lastChar == numericFormat.decimalSymbol));\r\n                                });\r\n                                break;\r\n                            case \"BOOL\":\r\n                                self.makeBooleanMetaDataControler($(this), control);\r\n                                break;\r\n                            default:\r\n                                self.makeStringMetaDataControler($(this), control);\r\n                                break;\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        // Set events for done and cancel button\r\n        $(\".ecm-metadata-done\", control).on('click', function (e) {\r\n            e.stopPropagation();\r\n            var control = $(this).parent('td');\r\n            var ecmMetaDataFieldEdit = $(\".ecm-metadata-field-edit\", control);\r\n            var metadatavalue = \"\";\r\n            var metadatapostvalue = \"\";\r\n\r\n            // Define metadataValue\r\n            switch (control.data('metadatatype')) {\r\n                case 'STRING':\r\n                case 'DECIMAL':\r\n                case 'INTEGER':\r\n                    metadatavalue = $(\".ecm-metadata-input\", control).val();\r\n                    metadatapostvalue = $(\".ecm-metadata-input\", control).val();\r\n                    break;\r\n                case 'BOOL':\r\n                    metadatavalue = $(\".biz-render-ecm-upload-boolean input:checked\", control).val();\r\n                    metadatapostvalue = bizagi.util.parseBoolean(metadatavalue) ? 'True' : 'False';\r\n                    metadatavalue = (metadatavalue == 'False') ? self.getResource('render-boolean-no') : self.getResource('render-boolean-yes');\r\n                    break;\r\n                case 'DATETIME':\r\n                    metadatavalue = $(\".ecm-metadata-input\", control).val();\r\n                    if (metadatavalue) {\r\n                        var date = bizagi.util.dateFormatter.getDateFromFormat(metadatavalue, self.properties.datePickerFormat);\r\n                        metadatapostvalue = bizagi.util.dateFormatter.formatInvariant(date, true);\r\n                    }\r\n                    break;\r\n            }\r\n            // Update metadata\r\n            control.data('value', metadatapostvalue);\r\n\r\n            var spanMetaDataValue = $(\"<span></span>\").addClass(\"ecm-metadata-text\").text(metadatavalue);\r\n            ecmMetaDataFieldEdit.replaceWith(spanMetaDataValue);\r\n\r\n            // Show and hide elements\r\n            $(\".ecm-metadata-edit\", control).css('display', 'block');\r\n            $(\".ecm-metadata-done\", control).hide();\r\n            $(\".ecm-metadata-cancel\", control).hide();\r\n            control.data(\"edit-mode\", \"false\");\r\n        });\r\n\r\n        $(\".ecm-options-edit\", control).on('click', function (evt, data) {\r\n            var modalEcm = control;\r\n            var validateData = data && data.checkData || false;\r\n\r\n            evt.stopPropagation();\r\n\r\n            // Close popup            \r\n            if ($(\".emc-options\", control).css(\"display\") === \"block\")\r\n                $(\".modal-ecm\", control).hide();\r\n\r\n            // If data is valid then return \t\r\n            if (validateData && self.isValidFields(modalEcm)) return;\r\n\r\n            if ($(\".ecm-options-edit\", modalEcm).data('editmode') == 'true') {\r\n                return;\r\n            } else {\r\n                $(\".ecm-options-edit\", modalEcm).data('editmode', 'true'); // Active edit mode\r\n            }\r\n\r\n            var template = self.renderFactory.getTemplate(\"upload-ecm-view-default-edit-buttons\");\r\n            var metadata = [];\r\n\r\n            // Render template\r\n            var editButtons = $.tmpl(template);\r\n\r\n            // Enable edit mode for all elements available in the control\r\n            $(\".ecm-metadata-value[data-allowUpdateMetadata=true]\", control).trigger('activeeditmode');\r\n\r\n            // Show save and cancel buttons\r\n            editButtons.insertAfter($('table', control));\r\n            $(\".biz-render-ecm-metadata-edit\", control).show(500);\r\n\r\n            // Set events to save and cancel buttons\r\n            // Save button\r\n            $(\".biz-render-ecm-metadata-edit button:first\", control).on('click', function (evt) {\r\n                var error = false;\r\n                var modalEcm = control;\r\n\r\n                evt.stopPropagation();\r\n\r\n                // verify all mandatory fields\r\n                $.each($(\".ecm-metadata-value[data-mandatory='true']\", control), function (key, field) {\r\n                    var type = $(field).data('metadatatype');\r\n                    var actualValue;\r\n\r\n                    if (type == \"BOOL\") {\r\n                        actualValue = $(\".biz-render-ecm-upload-boolean input:checked\", field).val();\r\n                    } else {\r\n                        actualValue = $(field).find('.ecm-metadata-field-edit').val();\r\n                    }\r\n\r\n                    if (actualValue === \"\" || actualValue === null) {\r\n                        $(field).find('input').attr('placeholder', self.getResource(\"render-ecm-tooltip-mandatory\"));\r\n                        $(field).parent().find('.ecm-metadata-key').addClass(\"mandatory-error\");\r\n                        $(field).parent().effect('highlight', 500);\r\n\r\n                        error = true;\r\n                    } else {\r\n                        $(field).parent().find('.ecm-metadata-key').removeClass(\"mandatory-error\");\r\n                    }\r\n                });\r\n\r\n                if (error) return;\r\n\r\n                $(\".ecm-metadata-done\", control).click();\r\n                $(\".biz-render-ecm-metadata-edit\", control).hide(300, function () {\r\n                    $(\".biz-render-ecm-metadata-edit\", control).remove();\r\n                });\r\n\r\n                $.each($(\".ecm-metadata-value\", control), function (key, value) {\r\n                    // uses the key as an index for the  ecm-metadata-key and ecm-metadata-value\r\n                    metadata.push({\r\n                        idMetadata: $($(\".ecm-metadata-key\", control)[key]).data(\"idmetadata\"),\r\n                        value: $(value).data(\"value\")\r\n                    });\r\n                });\r\n\r\n                params.metaValues = JSON.encode({ metadataValues: metadata });\r\n\r\n                delete params.prepare; // Ensure run Ajax\r\n                $.when(self.dataService.updateECMMetadata(params)).done(function(fileProperties) {\r\n                    $(\".ecm-options-edit\", modalEcm).data('editmode', 'false');\r\n                });\r\n            });\r\n\r\n            // Cancel button\r\n            $(\".biz-render-ecm-metadata-edit button:last\", control).on('click', function (evt) {\r\n                var modalEcm = control;\r\n\r\n                evt.stopPropagation();\r\n\r\n                $(\".ecm-metadata-cancel\", control).click();\r\n                $(\".biz-render-ecm-metadata-edit button:first\", control).unbind('click');\r\n                if ($('.ecm-options-slide', modalEcm).is(':visible')) {\r\n                    $(\".emc-options\", control).click();\r\n                }\r\n                $(\".biz-render-ecm-metadata-edit\", control).hide(500, function () {\r\n                    $(\".biz-render-ecm-metadata-edit\", control).remove();\r\n                });\r\n                $(\".ecm-options-edit\", modalEcm).data('editmode', 'false');\r\n            });\r\n\r\n        });\r\n\r\n        $(\".ecm-metadata-cancel\", control).on('click', function (e) {\r\n            e.stopPropagation();\r\n            var control = $(this).parent('td');\r\n            var inputMetaDataValue = $(\".ecm-metadata-field-edit\", control);\r\n            var spanMetaDataValue = $(\"<span></span>\").addClass(\"ecm-metadata-text\").text(inputMetaDataValue.data('original-value'));\r\n\r\n            inputMetaDataValue.replaceWith(spanMetaDataValue);\r\n\r\n            // Show and hide elements\r\n            $(\".ecm-metadata-edit\", control).css('display', 'block');\r\n            $(\".ecm-metadata-done\", control).hide();\r\n            $(\".ecm-metadata-cancel\", control).hide();\r\n\r\n            control.data(\"edit-mode\", \"false\");\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Make input field for edit string metadata\r\n    */\r\n    makeStringMetaDataControler: function (field, control, validationFunction) {\r\n        var spanMetaDataValue = $(\".ecm-metadata-text\", field);\r\n        var inputMetaDataValue = $(\"<input></input>\").addClass(\"ecm-metadata-field-edit ecm-metadata-input\").val(spanMetaDataValue.text());\r\n\r\n        // Persist in data tag the original value\r\n        inputMetaDataValue.data('original-value', spanMetaDataValue.text());\r\n\r\n        // Change element\r\n        spanMetaDataValue.replaceWith(inputMetaDataValue);\r\n\r\n        inputMetaDataValue.focus();\r\n\r\n        // Show and hide elements\r\n        $(\".ecm-metadata-edit\", field).hide();\r\n        $(\".ecm-metadata-done\", field).css('visibility', 'visible').show();\r\n        $(\".ecm-metadata-cancel\", field).css('visibility', 'visible').show();\r\n\r\n        // Set event for enter key press\r\n        $(\".ecm-metadata-input\", field).bind(\"keyup\", function (e) {\r\n            var inputValue = inputMetaDataValue.val();\r\n            if (validationFunction) {\r\n                if (validationFunction(inputValue) || inputValue == \"\") {\r\n                    inputMetaDataValue.data(\"latestdonevalue\", inputValue);\r\n                } else {\r\n                    inputMetaDataValue.val(inputMetaDataValue.data(\"latestdonevalue\") || \"\");\r\n                }\r\n            }\r\n        });\r\n    },\r\n    /*\r\n    * Make input field for edit string metadata\r\n    */\r\n    makeDatetimeMetaDataControler: function (field, control) {\r\n        var self = this;\r\n        var spanMetaDataValue = $(\".ecm-metadata-text\", field);\r\n        var inputMetaDataValue = $(\"<input></input>\").addClass(\"ecm-metadata-field-edit ecm-metadata-input\").val(spanMetaDataValue.text());\r\n\r\n        // Persist in data tag the original value\r\n        inputMetaDataValue.data('original-value', spanMetaDataValue.text());\r\n\r\n        // Change element\r\n        spanMetaDataValue.replaceWith(inputMetaDataValue);\r\n        inputMetaDataValue.datepicker({\r\n            dateFormat: self.properties.datePickerFormat,\r\n            changeYear: true,\r\n            onSelect: function (dateText, inst) {\r\n                inputMetaDataValue.val(dateText + \" 00:00 AM\");\r\n            }\r\n        });\r\n\r\n        // Show and hide elements\r\n        $(\".ecm-metadata-edit\", field).hide();\r\n        $(\".ecm-metadata-done\", field).css('visibility', 'visible').show();\r\n        $(\".ecm-metadata-cancel\", field).css('visibility', 'visible').show();\r\n\r\n        // Set event for enter key press\r\n        $(\".ecm-metadata-input\", field).bind(\"keypress\", function (e) {\r\n            if (e.keyCode == 13) {\r\n                $(\".ecm-metadata-done\", control).trigger('click');\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Make input field for edit string metadata     \r\n     */\r\n    makeDecimalMetaDataControler: function (field, control) {\r\n        var self = this;\r\n        var separator = self.getResource('decimalSymbol');\r\n        self.makeStringMetaDataControler($(this), control, function (value, separator) {\r\n            // validation function\r\n            var reg = new RegExp(\"\\\\d+(\\\\\" + separator + \"\\\\d)*\");\r\n            var valueMatch = value.match(reg);\r\n            return (valueMatch != null && (valueMatch[0] == valueMatch['input'] || valueMatch[1] == undefined));\r\n        });\r\n\r\n    },\r\n\r\n    /**\r\n     * Make input field for edit string metadata     \r\n     */\r\n    makeBooleanMetaDataControler: function (field, control) {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"upload-ecm-view-default-yesno\");\r\n        var spanMetaDataValue = $(\".ecm-metadata-text\", field);\r\n        var metadatavalue = $(field).data(\"value\") || false;\r\n        var checked = bizagi.util.parseBoolean(metadatavalue) ? true : false;\r\n        var randomNumber = Math.ceil(Math.random() * 100);\r\n\r\n        var inputMetaDataValue = $.tmpl(template, { id: self.properties.id, checked: checked, rnd: randomNumber });\r\n\r\n        // Persist in data tag the original value\r\n        inputMetaDataValue.data('original-value', spanMetaDataValue.text());\r\n\r\n        // Change element\r\n        spanMetaDataValue.replaceWith(inputMetaDataValue);\r\n\r\n        // Show and hide elements\r\n        $(\".ecm-metadata-edit\", field).hide();\r\n        $(\".ecm-metadata-done\", field).css('visibility', 'visible').show();\r\n        $(\".ecm-metadata-cancel\", field).css('visibility', 'visible').show();\r\n\r\n    },\r\n\r\n    /**\r\n     * Check if file its image or not     \r\n     */\r\n    isImage: function (file) {\r\n        var extension = this.getFileExtension(file);\r\n        var image = [\"JPG\", \"JPEG\", \"GIF\", \"PNG\", \"BMP\"];\r\n\r\n        return ($.inArray(extension.toUpperCase(), image) > -1) ? true : false;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed in read-only mode     \r\n     */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var mode = self.getMode();\r\n\r\n        if (mode != \"execution\") {\r\n            control.append(\"<div class='ui-icon upload-file'></div>\");\r\n            return;\r\n        }\r\n\r\n        // Set control container to behave as a block\r\n        control.addClass(\"ui-bizagi-render-display-block\");\r\n        control.addClass(\"ui-bizagi-render-upload\");\r\n\r\n        // Remove upload wrapper\r\n        $(\".biz-render-ecm-upload-wrapper\", control).remove();\r\n\r\n        // First run show render options\r\n        self.properties.showRenderOptions = false;\r\n\r\n        // Call service and render control\r\n        self.renderUploadItem();\r\n\r\n        $(\".emc-options\", control).remove();\r\n    },\r\n\r\n    /**\r\n     * Build add params to send to the server\r\n     */\r\n    buildAddParams: function () {\r\n        var properties = this.properties;\r\n        var form = this.getFormContainer();\r\n\r\n        var data = {\r\n            url: properties.addUrl,\r\n            xPath: properties.xpath,\r\n            idAttrib: properties.idAttrib,\r\n            xpathContext: properties.xpathContext,\r\n            metaValues: [],\r\n            idPageCache: properties.idPageCache,\r\n            idSession: form.properties.sessionId,\r\n            folder: BIZAGI_PATH_TO_BASE,\r\n            contexttype: properties.contexttype,\r\n            validExtensions: properties.validExtensions,\r\n            maxSize: properties.maxSize\r\n        };\r\n\r\n        var scriptData = {};\r\n        $.extend(scriptData, scriptData, data);\r\n        data.scriptData = scriptData;\r\n\r\n        return data;\r\n    },\r\n\r\n    /**\r\n     * Build add params to send to the server     \r\n     */\r\n    buildUpgradeParams: function (fileControl) {\r\n        var properties = this.properties;\r\n        var form = this.getFormContainer();\r\n\r\n        var data = {\r\n            url: properties.editUrl,\r\n            xPath: properties.xpath,\r\n            idFileUpload: $(\".ecm-options-upgrade > input\", fileControl).data(\"idfileupload\"),\r\n            idPageCache: properties.idPageCache,\r\n            idAttrib: properties.idAttrib,\r\n            xpathContext: this.getXpathContext(),\r\n            idSession: form.properties.sessionId,\r\n            folder: BIZAGI_PATH_TO_BASE,\r\n            validExtensions: properties.validExtensions,\r\n            maxSize: properties.maxSize\r\n        };\r\n\r\n        var scriptData = {};\r\n        $.extend(scriptData, scriptData, data);\r\n        data.scriptData = scriptData;\r\n\r\n        return data;\r\n    },\r\n\r\n    /**\r\n     * Check if the max files condition is true to hide the upload link    \r\n     */\r\n    checkMaxFiles: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n        var uploadWrapper = $(\".biz-render-ecm-upload-wrapper\", control);\r\n        var fileInput = $(\"a\", uploadWrapper);\r\n\r\n        if (properties.maxFiles > 0 && self.filesCount >= properties.maxFiles) {\r\n            uploadWrapper.hide();\r\n        } else if (self.filesCount < properties.maxFiles) {\r\n            // Show upload link\r\n            uploadWrapper.show();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Handler to process server response after a file has been uploaded     \r\n     */\r\n    onUploadFileCompleted: function (renderReference, result) {\r\n        var self = renderReference;\r\n        var control = self.getControl();\r\n\r\n        if (result.type != \"error\") {\r\n\r\n            self.properties.showRenderOptions = false;\r\n            var controlList = $(\".biz-render-ecm-view-default\", control);\r\n            controlList = (controlList.length > 0) ? controlList : $(\".biz-render-ecm-delete-confirmation\", control);\r\n\r\n            // Increment counter\r\n            self.filesCount = self.filesCount + 1;\r\n\r\n            // Check maxFiles\r\n            self.checkMaxFiles();\r\n\r\n            //Set files in temporal array\r\n            var files = [].concat(self.files);\r\n            files.push([result.idFileUpload, result.fileName]);\r\n\r\n            //Set Value\r\n            self.setValue(files, false);\r\n\r\n            // Trigger change\r\n            self.triggerRenderChange();\r\n\r\n            self.renderUploadItem(controlList, result);\r\n        } else {\r\n            // Show server error\r\n            bizagi.showMessageBox(result.message);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Check if all meta data fields that's right     \r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var message = [];\r\n        var error = false;\r\n        var properties = self.properties;\r\n        var bValid = true;\r\n\r\n        var isNewRow = self.grid && self.grid.isFromCreatedRow.apply(self);\r\n        var isValidBase = (properties.required || properties.editable) && !isNewRow ? self._super(invalidElements) : true;\r\n\r\n        if (properties.required) {\r\n            bValid = isNewRow ? true : isValidBase;\r\n\r\n            if (self.filesCount == 0 && bValid) {\r\n\r\n                invalidElements.push({\r\n                    xPath: properties.xpath,\r\n                    message: self.getResource('render-required-text').replaceAll('#label#', properties.displayName)\r\n                });\r\n\r\n                bValid = false;\r\n            }\r\n        }\r\n\r\n        if (properties.editable) {\r\n            bValid = isNewRow ? true : isValidBase;\r\n\r\n            if (!isNewRow) {\r\n                var $arrayEcmControls = $(\"ul:visible\", control).find(\".ecm-metadata-value[data-mandatory='true']\");\r\n\r\n                $.each($arrayEcmControls, function (key, value) {\r\n                    if ($('.ecm-metadata-text', value).text() == \"\") {\r\n                        message.push($(value).data(\"mandatoryfield\"));\r\n                        error = true;\r\n                    }\r\n                });\r\n            }\r\n        }\r\n\r\n        if (error) {\r\n            var errorMessage = self.getResource('render-required-text').replaceAll('#label#', message.join(', '));\r\n            invalidElements.push({ xPath: properties.xpath, message: errorMessage });\r\n\r\n            // If it has error, enable editable view. Then, open popup\r\n            if ($(\".ecm-options-edit\", control).data('editmode') != \"true\") {\r\n                $(\".ecm-options-edit\", control).trigger('click', { checkData: true });\r\n            }\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /*\r\n     * Cleans current value\r\n     */\r\n    cleanData: function () {\r\n        this.setValue(null);\r\n        this.clearDisplayValue();\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control     \r\n     */\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var arrayItems = control.find(\".biz-render-ecm-view-default\");\r\n        var length = arrayItems.length - 1;\r\n\r\n        $.each(arrayItems, function (index, value) {\r\n            var item = $(value);\r\n            var file = item.data();\r\n\r\n            if (file) {\r\n                $.when(self.deleteUploadItem(item, file.id)).done(function () {\r\n                    // Detach item\r\n                    item.remove();\r\n\r\n                    // Trigger change\r\n                    self.triggerRenderChange();\r\n                });\r\n            }\r\n        });\r\n\r\n        // Remove items\r\n        arrayItems.hide();\r\n\r\n        // Check maxFiles\r\n        self.filesCount = 0;\r\n        self.checkMaxFiles();\r\n    },\r\n\r\n    /**\r\n     * Add waiting message     \r\n     */\r\n    waiting: function (ctrl, visible) {\r\n        ctrl.find(\".ecm-file-name\").css(\"visibility\", visible ? \"visible\" : \"hidden\");\r\n        ctrl.find(\"table\").css(\"visibility\", visible ? \"visible\" : \"hidden\");\r\n        ctrl.css(\"background\", visible ? \"\" : \"transparent\");\r\n\r\n        if (visible) {\r\n            ctrl.removeClass(\"waiting\")\r\n        } else {\r\n            ctrl.addClass(\"waiting\")\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Hides the control when click somewhere else          \r\n     */\r\n    configureToggleHandlers: function () {\r\n        $(document.body).off(\"click\").on(\"click\", function (e) {\r\n            if (!$(e.target).hasClass(\"emc-options\") && !$(e.target).hasClass(\"ui-icon-gear\")) {\r\n                $(\".modal-ecm\", this).hide();\r\n                $(\"#content-wrapper, .bz-rn-grid-data-wraper\").unbind('scroll');\r\n                $(document.body).unbind('click');\r\n            }\r\n        });\r\n\r\n        $(\"#content-wrapper, .bz-rn-grid-data-wraper, .ui-bizagi-dialog-search\").off(\"scroll\").on(\"scroll\", function (e) {\r\n            if (!$(e.target).hasClass(\"emc-options\") && !$(e.target).hasClass(\"ui-icon-gear\")) {\r\n                $(\".modal-ecm\", this).hide();\r\n                $(document.body).unbind('click');\r\n                $(\"#content-wrapper, .bz-rn-grid-data-wraper\").unbind('scroll');\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Validate required field     \r\n     */\r\n    isValidFields: function (metadataContext) {\r\n        var isValid = true;\r\n        var $arrayEcmControls = $(metadataContext).find(\".ecm-metadata-value[data-mandatory='true']\");\r\n\r\n        $.each($arrayEcmControls, function (key, value) {\r\n            var currentField = $('.ecm-metadata-text', value).text();\r\n            if (bizagi.util.isEmpty(currentField)) {\r\n                isValid = false;\r\n                return;\r\n            }\r\n        });\r\n\r\n        return isValid;\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: Bizagi Desktop Render Grid Extension\r\n *   Author: oscaro\r\n *   Comments:\r\n *   -   This script will redefine the grid render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.grid.bizagi\", bizagi.rendering.grid.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.grid.bizagi.extend(\"bizagi.rendering.desktop.grid.bizagi\", {}, {\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        self.showActionColumn(data);\r\n\r\n        // Create a single instance for each cell\r\n        data.properties.singleInstance = false;\r\n\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Create a data-structure to keep track of each cell properties\r\n        this.cellMetadata = {};\r\n\r\n        // Create a collection to save grid cell changes to execute after it is loaded\r\n        this.pendingActions = [];\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        // set collapse grid\r\n        this.collapseState = properties.collapseState;\r\n\r\n        // Just apply display-type: vertical, align it to the left\r\n        properties.displayType = \"vertical\";\r\n        properties.labelAlign = \"left\";\r\n    },\r\n\r\n    /*\r\n      If grid has allow some action (Delete, Edit or Detail action), show the action column in grid render.\r\n     */\r\n    showActionColumn: function (data) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var form = self.getFormContainer();\r\n        var editableGrid = bizagi.util.parseBoolean(data.properties.editable) != null ? bizagi.util.parseBoolean(data.properties.editable) : true;\r\n        var columnActions = bizagi.util.parseBoolean(data.properties.columnActions) != null ? bizagi.util.parseBoolean(data.properties.columnActions) : false;\r\n\r\n        // If print version mode then columns actions are disabled\r\n        if (form.getParams() && form.getParams().printversion) {\r\n            columnActions = false;\r\n        }\r\n\r\n        self.columnActionParams = {\r\n            columnActions: columnActions,\r\n            allowDelete: (typeof data.properties.allowDelete == \"undefined\" && editableGrid) ? true : false,\r\n            allowEdit: (typeof data.properties.allowEdit == \"undefined\" && editableGrid) ? true : false,\r\n            allowDetail: (typeof data.properties.allowDetail == \"undefined\") ? false : true,\r\n            withEditForm: (typeof data.properties.withEditForm == \"undefined\") ? false : true\r\n        };\r\n\r\n        if (!data.properties.hideActionsColumn && mode === \"execution\") {\r\n            var actionsColumn = {\r\n                \"render\": {\r\n                    \"properties\": {\r\n                        \"id\": \"e51580f3-fd6c-49c0-8c69-73dff93723e5\",\r\n                        \"type\": \"columnActions\",\r\n                        \"xpath-column\": \"constant(\\\"\\\")\",\r\n                        \"displayName\": \"\",\r\n                        \"submitOnChange\": false,\r\n                        \"totalize\": {\r\n                            \"format\": {}\r\n                        },\r\n                        \"hasTotalizer\": false,\r\n                        \"preventDefault\": true,\r\n                        \"columnwidth\": \"24px\",\r\n                        \"headerStyles\": {\r\n                            \"header\": \"width: 24px\",\r\n                            \"label\": \"width: 24px\"\r\n                        },\r\n                        \"cssclass\": \"bz-grid-header-actions\"\r\n                    }\r\n                }\r\n            };\r\n\r\n            data.elements.splice(0, 0, actionsColumn);\r\n\r\n            self.spliceRowData(data.properties.data, 1);\r\n            self.spliceRowDataVisible(data.properties.data, 1);\r\n            self.spliceRowDataEditable(data.properties.data, 1);\r\n        }\r\n    },\r\n    /*\r\n     *   hasActions\r\n     */\r\n    hasActions: function (columnActionParams) {\r\n        var self = this;\r\n        if (typeof self.columnActionParams === \"undefined\") {\r\n            return false;\r\n        }\r\n        return self.columnActionParams.columnActions && (self.columnActionParams.allowDelete || (self.columnActionParams.allowEdit && self.columnActionParams.withEditForm) || self.columnActionParams.allowDetail);\r\n    },\r\n\r\n    getGridTemplate: function () {\r\n        return this.renderFactory.getTemplate(\"grid.bizagi\");\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        // Call base \r\n        this._super();\r\n\r\n        // Find component holder\r\n        var grid = self.grid = $(\">div\", control);\r\n        // Build column metadata\r\n        var columns = self.buildColumnModel();\r\n\r\n        // Hide common label\r\n        self.getLabel().hide();\r\n\r\n        // Reset new records\r\n        self.cleanNewRecords();\r\n\r\n        self.applyGridPlugin();\r\n\r\n        // Set initial data\r\n        if (properties.data) {\r\n            if (properties.data === \"\" || (properties.data.rows).length === 0 && properties.data.page > 1) {\r\n                self.fetchData(undefined, self.sortBy, self.sortType);\r\n\r\n            } else {\r\n                self.updateData(properties.data);\r\n\r\n                // Trigger change in order to start up the actions when the controls is ready\r\n                $.when(self.ready())\r\n                    .done(function () {\r\n                        self.triggerRenderChange({changed: false});\r\n                    });\r\n            }\r\n        }\r\n\r\n        self.initialLoadDone = true;\r\n        for (var i in self.pendingActions) {\r\n            if (typeof self.pendingActions[i].method == \"function\") {\r\n                self.pendingActions[i].method.apply(self, self.pendingActions[i].arguments);\r\n            }\r\n        }\r\n\r\n        // Set tooltip\r\n        var buttonsComponent = $(\"[data-bizagi-component='buttons'] li[title!='']\", self.getControl());\r\n        buttonsComponent.tooltip();\r\n\r\n        buttonsComponent = $(\"[data-bizagi-component='cellContent'] button[title!='']\", self.getControl());\r\n        buttonsComponent.tooltip();\r\n\r\n        // Add tooltips to header\r\n        var columComponent = $(\"[data-bizagi-component='columns'] th > div[title!='']\", self.getControl());\r\n        columComponent.tooltip();\r\n\r\n        //apply columns width\r\n        self.applyColumnsWidth(grid, columns);\r\n    },\r\n\r\n    /**\r\n     * WARNING: This method here is required in order to avoid changes in the font weigth for the grid\r\n     */\r\n    changeFontBold: function () {\r\n        return this;\r\n    },\r\n\r\n    /*\r\n    * Apply grid plugin\r\n    */\r\n    applyGridPlugin: function () {\r\n        var self = this;\r\n        var grid = self.grid;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n\r\n        var pager = self.renderFactory.getTemplate(\"bizagi.grid.pagination\");\r\n\r\n        var form = self.getFormContainer();\r\n        var canvas = form.container;\r\n        if (form.params && form.params.context == \"search\" && form.parent && form.parent.params && form.parent.params.canvas) {\r\n            canvas = form.parent.params.canvas\r\n        } else if (form.params && form.params.canvas) {\r\n            canvas = form.params.canvas;\r\n        }\r\n\r\n        var scrollableArea = canvas.css('overflow-y') == 'scroll' || canvas.css('overflow-y') == 'auto' ? canvas : canvas.scrollParent();\r\n\r\n        grid.bizagi_grid_desktop({\r\n            columns: self.buildColumnModel(),\r\n            showSummary: properties.showSummary,\r\n            title: properties.displayName,\r\n            mode: self.getMode(),\r\n            scrollableArea: scrollableArea,\r\n            floatingHeader: properties.floatingHeader || false,\r\n            tableCssClass: \"\",\r\n            sortBy: properties.sortBy || \"\",\r\n            collapse: (mode !== \"execution\") ? false : true, // por defecto las grillas seran colapsables en ejecucion\r\n            collapseState: (mode !== \"execution\") ? false : self.collapseState,\r\n            buttonsPst: (mode !== \"execution\") ? false : properties.buttonsPst,\r\n            sortOrder: properties.sortOrder || \"\",\r\n            smartPagination: true,\r\n            sortType: bizagi.override.gridDefaultSortBy || \"asc\",\r\n            headerStyles: self.getHeaderStyles(),\r\n            orientation: properties.orientation || \"ltr\",\r\n            template: {\r\n                grid: self.renderFactory.getTemplate(\"bizagi.grid.grid\"),\r\n                gridRtl: self.renderFactory.getTemplate(\"bizagi.grid.grid.rtl\"),\r\n                waiting: self.renderFactory.getTemplate(\"bizagi.grid.waiting\"),\r\n                table: self.renderFactory.getTemplate(\"bizagi.grid.table\"),\r\n                emptyTable: self.renderFactory.getTemplate(\"bizagi.grid.table.empty\"),\r\n                column: self.renderFactory.getTemplate(\"bizagi.grid.column\"),\r\n                specialColumn: self.renderFactory.getTemplate(\"bizagi.grid.column.special\"),\r\n                row: self.renderFactory.getTemplate(\"bizagi.grid.row\"),\r\n                rowButtons: self.renderFactory.getTemplate(\"bizagi.grid.row.buttons\"),\r\n                rowButtonsRtl: self.renderFactory.getTemplate(\"bizagi.grid.row.buttons.rtl\"),\r\n                cell: self.renderFactory.getTemplate(\"bizagi.grid.cell\"),\r\n                specialCell: self.renderFactory.getTemplate(\"bizagi.grid.cell.special\"),\r\n                pager: pager,\r\n                buttons: self.renderFactory.getTemplate(\"bizagi.grid.buttons\"),\r\n                buttonsRtl: self.renderFactory.getTemplate(\"bizagi.grid.buttons.rtl\"),\r\n                dynamicPager: self.renderFactory.getTemplate(\"bizagi.grid.dynamicpager\"),\r\n                summary: self.renderFactory.getTemplate(\"bizagi.grid.summary\"),\r\n                summaryCell: self.renderFactory.getTemplate(\"bizagi.grid.summaryCell\"),\r\n                exportOptions: self.renderFactory.getTemplate(\"bizagi.grid.exportOptions\")\r\n            },\r\n            actions: {\r\n                add: properties.allowAdd,\r\n                edit: (properties.allowEdit && properties.withEditForm && properties.data != null),\r\n                remove: properties.allowDelete,\r\n                details: properties.allowDetail,\r\n                inlineAdd: properties.inlineAdd,\r\n                allowMore: properties.allowMore,\r\n                enableXlsExport: properties.enableXlsExport,\r\n                enablePdfExport: properties.enablePdfExport\r\n            },\r\n            tooltips: {\r\n                addLabel: properties.addLabel,\r\n                editLabel: properties.editLabel,\r\n                deleteLabel: properties.deleteLabel,\r\n                detailLabel: properties.detailLabel,\r\n                exportOptionsLabel: properties.exportOptionsLabel\r\n            },\r\n            isValid: function () {\r\n                // Validate records \r\n                var errorsMessage = [];\r\n                var form = self.getFormContainer();\r\n\r\n                // fix for SUITE-8696\r\n                if (form.validationController !== undefined) {\r\n                    form.validationController.clearValidationMessages();\r\n                }\r\n\r\n                self.isValid(errorsMessage);\r\n\r\n                if (errorsMessage.length > 0) {\r\n                    // Show validation message\r\n                    for (var i = 0; i < errorsMessage.length; i++) {\r\n                        form.validationController.showValidationMessage(errorsMessage[i].message, errorsMessage[i].xpath);\r\n                    }\r\n\r\n                    return false;\r\n                } else {\r\n                    return true;\r\n                }\r\n            },\r\n            pageRequested: function (ui) {\r\n                if (mode != \"execution\") return;\r\n\r\n                if (self.changes && Object.keys(self.changes).length >= 1) {\r\n                    $.when(self.getFormContainer().saveForm()).done(function () {\r\n                        self.sortRequestedPage(ui);\r\n                    });\r\n                } else {\r\n                    self.sortRequestedPage(ui);\r\n                }\r\n            },\r\n            sortRequested: function (ui) {\r\n                if (mode != \"execution\" || typeof ui.sortBy === \"undefined\") return;\r\n\r\n                // Get column sort xpath\r\n                var sortName;\r\n                var getColumn = self.getColumn(ui.sortBy);\r\n                if (getColumn) {\r\n                    sortName = getColumn.getSortName();\r\n                } else {\r\n                    getColumn = self.getColumn(ui.sortBy.split(\".\")[0]);\r\n\r\n                    if (getColumn) {\r\n                        sortName = getColumn.getSortName();\r\n                    }\r\n                }\r\n\r\n                if (ui.sortBy.split(\".\").length > 1) {\r\n                    if (ui.sortBy.split(\".\")[0] == sortName) {\r\n                        sortName = ui.sortBy;\r\n                    }\r\n                }\r\n\r\n                // Perform the sort\r\n                self.fetchData(ui.page, sortName, ui.sortType);\r\n            },\r\n            drawCell: function (ui) {\r\n                return self.drawCell(ui.column, ui.key, ui.value, ui.isNewRow);\r\n            },\r\n            cellReady: function (ui) {\r\n                return self.onCellReady(ui.column, ui.key, ui.cell, ui.isNewRow);\r\n            },\r\n            rowSelected: function (ui) {\r\n                if (mode != \"execution\") return;\r\n\r\n                self.triggerHandler(\"rowSelected\", {id: ui.key});\r\n            },\r\n            addRow: function () {\r\n                if (mode != \"execution\") return;\r\n\r\n                self.addRow.apply(self, arguments);\r\n            },\r\n            editRow: function (ui) {\r\n                if (mode != \"execution\") return;\r\n\r\n                if (self.properties.withEditForm)\r\n                    self.editRow(ui.key);\r\n            },\r\n            deleteRow: function (ui) {\r\n                if (mode != \"execution\") return;\r\n\r\n                self.deleteRow(ui.key);\r\n            },\r\n            moreRows: function (ui) {\r\n                if (mode != \"execution\") return;\r\n\r\n                self.moreRows(ui);\r\n            },\r\n            saveAddedRows: function (ui) {\r\n                $.when(self.saveInlineAddedRows(ui.keys)).done(function () {\r\n                    //save edited inline rows\r\n                    if (self.properties.inlineEdit) {\r\n                        self.saveRows();\r\n                    }\r\n                });\r\n            },\r\n            beforeInlineAdd: function () {\r\n                self.inlineAddDeferred = new $.Deferred();\r\n            },\r\n            afterInlineAdd: function () {\r\n                if (self.inlineAddDeferred) {\r\n                    self.inlineAddDeferred.resolve();\r\n                    self.properties.canBeExported = $(\"li[data-action='save']\", self.grid).is(\":visible\") ? false : true;\r\n                }\r\n            },\r\n            showFormDetails: function (id) {\r\n                self.showFormDetails(id.key);\r\n            },\r\n            cancelEdition: function (ui) {\r\n                ui.refresh = true;\r\n                self.removeNewRecords(ui);\r\n            },\r\n            removeNewRecords: function (ui) {\r\n                self.removeNewRecords(ui);\r\n            },\r\n            showGridExportOptions: function () {\r\n                self.showGridExportOptions();\r\n            },\r\n            performExportGrid: function (printParams) {\r\n                self.performExportGrid(printParams);\r\n            },\r\n            performCollapseGrid: function () {\r\n                self.performCollapseGrid();\r\n            },\r\n            rowdblclick: function (ui) {\r\n                if (mode != \"execution\") return;\r\n                \r\n                if (self.canEditRow())\r\n                    self.editRow(ui.businessKey);\r\n            }           \r\n            \r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Triggers the grid plugin event\r\n    */\r\n    triggerGridPluginHandler: function () {\r\n        try {\r\n            var args = Array.prototype.slice.call(arguments, 0);\r\n            return this.grid.bizagi_grid_desktop.apply(this.grid, args);\r\n        } catch (e) {\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Method to render non editable values\r\n    */\r\n    postRenderReadOnly: function () {\r\n        // Do the same as the post-render            \r\n        this.postRender();\r\n    },\r\n    /**\r\n     *   Creates the column model required to initialize the grid plugin\r\n     */\r\n    buildColumnModel: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var columns = self.columns;\r\n\r\n        // Create id column first\r\n        var keyColumn = {\r\n            name: \"id\",\r\n            index: 0,\r\n            label: \"id\",\r\n            hidden: true,\r\n            key: true,\r\n            tooltip: \"\"\r\n        };\r\n\r\n        // Add to column model\r\n        var columnModel = [];\r\n        columnModel.push(keyColumn);\r\n\r\n        $.each(columns, function (index, column) {\r\n\r\n            // Set grid column\r\n            column.columnIndex = index + 1;\r\n\r\n            var columnLabel = !bizagi.util.isEmpty(column.properties.displayName) ? column.properties.displayName : \" \";\r\n            var gridColumn = {\r\n                name: column.properties.xpath,\r\n                index: index + 1,\r\n                label: columnLabel,\r\n                key: false,\r\n                tooltip: column.properties.tooltip || \"\",\r\n                hidden: (!column.properties.visible || column.properties.type == \"columnHidden\" || column.properties.columnVisible == false),\r\n                summarizeBy: (column.properties.totalize && column.properties.totalize.operation ? column.properties.totalize.operation : undefined),\r\n                bizAgiProperties: column.properties\r\n            };\r\n\r\n            columnModel.push(gridColumn);\r\n        });\r\n\r\n        return columnModel;\r\n    },\r\n    /**\r\n     * Makes the grid to refresh\r\n     */\r\n    refresh: function () {\r\n        var self = this;\r\n        if (self.parent && self.parent.properties && self.parent.properties.searchParams && self.parent.properties.searchParams.searchTriggeredBy) {\r\n            self.fetchData(1);\r\n        } else {\r\n            self.fetchData();\r\n        }\r\n    },\r\n    /*\r\n    *   Holds the execution until the grid data is ready after a load operation\r\n    */\r\n    dataReady: function () {\r\n        return this.dataReadyDeferred != null ? this.dataReadyDeferred.promise() : null;\r\n    },\r\n    /*\r\n    * Update data from local changes\r\n    */\r\n    loadChanges: function (rows) {\r\n        var self = this;\r\n        var idRow = [];\r\n        var i;\r\n\r\n        // get data from the rows\r\n        for (i = 0; i < rows.length; i++) {\r\n            idRow.push([rows[i][0], i]); // save id and index\r\n        }\r\n\r\n        for (i = 0; i < idRow.length; i++) {\r\n            var properties = self.changes[idRow[i][0]];\r\n            var index;\r\n\r\n            // search for changes\r\n            if (properties !== undefined) {\r\n                var xpath;\r\n\r\n                index = idRow[i][1];\r\n\r\n                // update all properties in data\r\n                for (xpath in properties) {\r\n                    if (properties.hasOwnProperty(xpath)) {\r\n                        self.assignValue(xpath, rows, index, properties);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    assignValue: function (xpath, rows, index, properties) {\r\n        var self = this;\r\n        var columnData = self.getColumn(xpath);\r\n        var type = columnData.properties.type;\r\n        var columnNumber = columnData.columnIndex;\r\n\r\n        switch (type) {\r\n            case \"columnCombo\":\r\n                var newValue = rows[index][columnNumber];\r\n                var isArray = bizagi.util.isArray(newValue);\r\n\r\n                if (!isArray || (isArray && !newValue.length)) {\r\n                    rows[index][columnNumber] = properties[xpath];\r\n                }\r\n                break;\r\n            default:\r\n                rows[index][columnNumber] = properties[xpath];\r\n                break;\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Method to set data and update the grid\r\n    */\r\n    updateData: function (data) {\r\n        var self = this;\r\n        var grid = self.grid;\r\n        var columns = self.columns;\r\n\r\n        // Set value in control\r\n        if (data) {\r\n            self.properties.data = data;\r\n            self.setCellOverrides(data, columns);\r\n            self.triggerGridPluginHandler(\"setData\", data);\r\n\r\n            //apply columns width\r\n            self.applyColumnsWidthUpdate(grid, columns);\r\n\r\n            self.processLayout(isLabelFormat, self.properties.textFormat || {});\r\n            self.processLayout(!isLabelFormat, self.properties.valueFormat || {});\r\n        }\r\n    },\r\n    /*\r\n    *   Method to fetch data from the server and then update the data\r\n    */\r\n    fetchData: function (page, sortBy, sortType) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        self.dataReadyDeferred = new $.Deferred();\r\n        self.sortBy = sortBy;\r\n        self.sortType = sortType;\r\n\r\n        // Define defaults\r\n        page = page || (properties.page || 1);\r\n        sortBy = sortBy || properties.sortBy || \"\";\r\n        sortType = sortType || (properties.sortOrder || \"asc\");\r\n\r\n        // Update control properties\r\n        properties.page = page;\r\n        properties.sortBy = sortBy;\r\n        properties.sortType = sortType;\r\n        properties.sort = sortBy + \" \" + sortType;\r\n\r\n        // Start loading to avoid multiple calls to the server\r\n        self.startLoading();\r\n\r\n        $.when(self.getRemoteData())\r\n            .then(function (data) {\r\n                self.endLoading();\r\n                if (self.disposed) return;\r\n                if (data) {\r\n\r\n                    if (!properties.hideActionsColumn) {\r\n                        self.spliceRowData(data, 1);\r\n                        self.spliceRowDataVisible(data, 1);\r\n                        self.spliceRowDataEditable(data, 1);\r\n                    }\r\n\r\n                    $.each(self.columns, function (i, column) {\r\n                        var columnProperties = column.properties;\r\n                        if (columnProperties.type === \"columnLabel\") {\r\n                            self.spliceRowData(data, i + 1);\r\n                        }\r\n                    });\r\n                    if (self.isRTL()) {\r\n                        //remove one extra column from backend. A unnecessary guid to Front-End.\r\n                        //In BPM Project a note says:\r\n                        ////NOTES: At this time there is no way to know whether an Entity has Localized attributes,\r\n                        ////so, the Query Engine will always get Guid values for every Parametric Entity\r\n                        data.rows = self.removeRemainingColumns(data.rows, self.columns.length);\r\n\r\n                        data.rows = self.changeOrderData(data.rows);\r\n                    }\r\n                    self.loadChanges(data.rows);\r\n                    self.updateData(data);\r\n\r\n                    if (self.properties.changed !== false || self.properties.method === \"delete\") {\r\n                        self.triggerRenderChange({changed: false});\r\n                        delete self.properties.changed;\r\n                        delete self.properties.method;\r\n                    }\r\n                    if (self.properties.textFormat && typeof (self.properties.textFormat.color) != \"undefined\") {\r\n                        $(\".bz-rn-grid-header-title\", self.grid).style(\"color\", self.properties.textFormat.color, \"important\");\r\n                    }\r\n                    if (self.properties.textFormat && typeof (self.properties.textFormat.background) != \"undefined\") {\r\n                        $(\".bz-rn-grid-cn-header\", self.grid).css(\"backgroundColor\", self.properties.textFormat.background);\r\n                        $(\".bz-rn-grid-container-foother\", self.grid).css(\"backgroundColor\", self.properties.textFormat.background);\r\n                    }\r\n                    $(\"th\", self.grid).css(\"fontWeight\", \"400\");\r\n                    self.dataReadyDeferred.resolve();\r\n                }\r\n            }).fail(function (data) {\r\n            self.endLoading();\r\n        });\r\n    },\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready to save\r\n    */\r\n    isReadyToSave: function () {\r\n        var self = this;\r\n\r\n        // Save pending inline add rows\r\n        if (self.grid && self.properties.inlineAdd && self.properties.allowEdit) {\r\n            var newKeys = self.triggerGridPluginHandler(\"getNewRowKeys\");\r\n            var errorsMessage = [];\r\n            var form = self.getFormContainer();\r\n\r\n            // Save new rows then save the whole screen\r\n            if (newKeys && newKeys.length > 0 && self.isValid(errorsMessage)) {\r\n                self.properties.alreadySaved = true;\r\n                return self.saveInlineAddedRows(newKeys, true);\r\n            }\r\n\r\n            if (errorsMessage.length > 0) {\r\n                // Show validation message\r\n                var errDef = $.Deferred();\r\n                for (var i = 0; i < errorsMessage.length; i++) {\r\n                    form.validationController.showValidationMessage(errorsMessage[i].message, errorsMessage[i].xpath);\r\n                }\r\n                errDef.reject(\"error\");\r\n                return errDef.promise();\r\n            }\r\n        }\r\n\r\n        return null;\r\n    },\r\n    /*\r\n    *   Add the render data to the given collection in order to send data to the server\r\n    */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var errorsMessage = [];\r\n        var saveDeferred;\r\n\r\n        // Save pending inline add rows\r\n        if (self.grid && (self.properties.inlineAdd || self.properties.inlineEdit)) {\r\n\r\n            try {\r\n                var newKeys = self.triggerGridPluginHandler(\"getNewRowKeys\");\r\n            } catch (e) {\r\n                newKeys = [];\r\n            }\r\n\r\n            // Save new rows then save the whole screen\r\n            if (newKeys && newKeys.length > 0 && !self.properties.alreadySaved && self.isValid(errorsMessage)) {\r\n                saveDeferred = self.saveInlineAddedRows(newKeys, true);\r\n\r\n                // Add to deferred collections in order to sync when saving\r\n                renderValues.deferreds = renderValues.deferreds || [];\r\n                renderValues.deferreds.push(saveDeferred);\r\n            }\r\n\r\n            if ((newKeys && newKeys.length > 0 && !self.isValid(errorsMessage) && saveDeferred)) {\r\n                self.cleanNewRecords();\r\n            }\r\n\r\n            // Remove adding keys from current changes\r\n            for (var i = 0; i < newKeys.length; i++) {\r\n                if (self.changes[newKeys[i]]) {\r\n                    delete self.changes[newKeys[i]];\r\n                }\r\n            }\r\n\r\n        }\r\n\r\n        // Call base method\r\n        self._super(renderValues);\r\n    },\r\n\r\n    sortRequestedPage: function (ui) {\r\n        var self = this;\r\n        var sortName;\r\n        var getColumn = self.getColumn(ui.sortBy);\r\n\r\n        if (getColumn) {\r\n            sortName = getColumn.getSortName();\r\n        } else {\r\n            getColumn = self.getColumn(ui.sortBy.split(\".\")[0]);\r\n            if (getColumn) {\r\n                sortName = getColumn.getSortName();\r\n            }\r\n        }\r\n\r\n        if (ui.sortBy.split(\".\").length > 1) {\r\n            if (ui.sortBy.split(\".\")[0] == sortName) {\r\n                sortName = ui.sortBy;\r\n            }\r\n        }\r\n\r\n        self.fetchData(ui.page, sortName, ui.sortType);\r\n    },\r\n    /*\r\n    *   Customizes the content drawing inside the cell\r\n    */\r\n    drawCell: function (column, key, value, isNewRow) {\r\n        var self = this;\r\n        if (column.key) {\r\n            return value;\r\n        }\r\n\r\n        // Get render column\r\n        var cellOverride = self.getCellOverride(key, column.index - 1);\r\n        var columnIndex = column.index - 1;\r\n        var renderColumn = self.columns[columnIndex];\r\n\r\n        // Fix issue suite-8559, data with null records        \r\n        self.newRecords = self.newRecords || {};\r\n\r\n        // Get cell properties\r\n        if (!self.cellMetadata[key]) {\r\n            self.cellMetadata[key] = {};\r\n        }\r\n        if (!self.cellMetadata[key][columnIndex]) {\r\n            self.cellMetadata[key][columnIndex] = {};\r\n        }\r\n        var properties = self.cellMetadata[key][columnIndex].properties || renderColumn.originalProperties;\r\n        var visible = properties.visible !== undefined ? properties.visible : true;\r\n        var editable = properties.editable !== undefined ? properties.editable : true;\r\n\r\n\r\n        // Apply overrides from cellOverrides\r\n        visible = cellOverride.visible;\r\n        editable = (properties.editable) ? cellOverride.editable : false;\r\n\r\n        // Show editable cell when we are performing inline add operation\r\n        if (isNewRow && column.bizAgiProperties.type !== \"columnFormLink\") { /*FIX: QAF-1883*/\r\n            editable = true;\r\n        }\r\n\r\n        renderColumn.properties.displayType = 'value';\r\n\r\n        if (column.bizAgiProperties.type === \"columnActions\") {\r\n            editable = true;\r\n        }\r\n\r\n        // If the cell we are drawing is the summary cell, we need to make it readonly\r\n        if (key == \"summary\") {\r\n            editable = false;\r\n        }\r\n\r\n        // Do the render\r\n        if (visible) {\r\n            if (editable) {\r\n                return self.drawEditableCell(renderColumn, properties, key, value, isNewRow);\r\n            } else {\r\n                return self.drawReadonlyCell(renderColumn, properties, key, value);\r\n            }\r\n        } else {\r\n            return \"<label></label>\";\r\n        }\r\n    },\r\n    /*\r\n    *   Draws the editable version for the cell\r\n    */\r\n    drawEditableCell: function (renderColumn, properties, key, value, isNewRow) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        // Set editable\r\n        var originalEditable = renderColumn.properties.editable;\r\n        renderColumn.properties.editable = true;\r\n\r\n        // Fix problem when required property lose\r\n        renderColumn.overrideProperties({required: properties.required});\r\n\r\n        // Render cell\r\n        $.when(renderColumn.render(key, value)).done(function (cell) {\r\n            // Register array with new records, just when this is a newrecord\r\n            if (isNewRow && !self.newRecords[key]) {\r\n                self.newRecords[key] = {};\r\n            }\r\n\r\n            // convert all row visible\r\n            for (var j = 0; j < self.columns.length; j++) {\r\n                self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n                self.getCellOverride(key, j).visible = (self.getCellOverride(key, j).visible != undefined) ? self.getCellOverride(key, j).visible : true;\r\n            }\r\n\r\n            // Add change handler\r\n            renderColumn.getDecorated(key).bind(\"renderchange\", function (render, args) {\r\n                self.onCellChange(renderColumn, cell, key, args);\r\n            });\r\n\r\n            // Resolve cell\r\n            defer.resolve(cell);\r\n        });\r\n\r\n        // Restore editable\r\n        renderColumn.properties.editable = originalEditable;\r\n\r\n        // Return promise\r\n        return defer.promise();\r\n    },\r\n    /*\r\n    *   Draws the readonly version for the cell\r\n    */\r\n    drawReadonlyCell: function (renderColumn, properties, key, value) {\r\n        var self = this;\r\n        var result = \"\";\r\n\r\n        // Use totalizer format when printing summary row\r\n        if (key == \"summary\") {\r\n            var originalFormat = renderColumn.properties.textFormat;\r\n            if (renderColumn.properties.totalize) {\r\n                renderColumn.properties.textFormat = renderColumn.properties.totalize.format;\r\n            }\r\n\r\n            result = renderColumn.renderSummary(key, value);\r\n\r\n            // Restore column format\r\n            renderColumn.properties.textFormat = originalFormat;\r\n        } else {\r\n            result = renderColumn.renderReadOnly(key, value);\r\n        }\r\n        return result;\r\n    },\r\n    /*\r\n    *   Defines the handler when a cell changes its value\r\n    */\r\n    onCellChange: function (renderColumn, cell, key, args) {\r\n        var self = this;\r\n        var _value = renderColumn.getValue(key);\r\n        var compositeValue = renderColumn.getCompositeValue(key);\r\n\r\n        var isNewRecord = self.triggerGridPluginHandler(\"isNewRecord\", key);\r\n        var newKeys;\r\n        var errorsMessage = [];\r\n        var trigger = isNewRecord ? false : true;\r\n        var dataType = renderColumn.properties.type;\r\n\r\n        try {\r\n            if (dataType == \"columnDate\" && renderColumn.data.properties.showTime == true) {\r\n\r\n                if (!bizagi.util.isEmpty(_value)) {\r\n                    var date = bizagi.util.dateFormatter.getDateFromInvariant(_value, true);\r\n                    _value = bizagi.util.dateFormatter.formatInvariant(date, true);\r\n                } else if (_value === \"\") {\r\n                    _value = \"\";\r\n                }\r\n            } else {\r\n\r\n                if (dataType == \"columnDate\") {\r\n\r\n                    if (!bizagi.util.isEmpty(_value)) {\r\n                        var date = bizagi.util.dateFormatter.getDateFromInvariant(_value, false);\r\n                        date.setHours(0, 0, 0, 0);\r\n                        _value = bizagi.util.dateFormatter.formatInvariant(date, true);\r\n                    } else if (_value === \"\") {\r\n                        _value = \"\";\r\n                    }\r\n\r\n                } else {\r\n                    if (dataType === \"columnSearch\") {\r\n\r\n                        var isSubmitOnChange = false;\r\n\r\n                        if (self.properties.submitOnChange)\r\n                            isSubmitOnChange = renderColumn.properties.advancedSearch || false;\r\n\r\n                        if (isNewRecord && self.properties.inlineAdd && isSubmitOnChange) {\r\n                            self.collectGridChange($.extend(args, {\r\n                                id: key,\r\n                                xpath: renderColumn.properties.xpath || renderColumn.properties.id,\r\n                                value: _value,\r\n                                compositeValue: compositeValue,\r\n                                columnIndex: renderColumn.columnIndex,\r\n                                trigger: trigger\r\n                            }));\r\n\r\n                            try {\r\n                                newKeys = self.triggerGridPluginHandler(\"getNewRowKeys\");\r\n                            } catch (e) {\r\n                                newKeys = [];\r\n                            }\r\n\r\n                            args.render.startActionExecution();\r\n\r\n                            var saveDeferred = self.saveInlineAddedRows(newKeys, true);\r\n                            // Remove adding keys from current changes\r\n                            for (var i = 0; i < newKeys.length; i++) {\r\n                                if (self.changes[newKeys[i]]) {\r\n                                    delete self.changes[newKeys[i]];\r\n                                }\r\n                            }\r\n\r\n                            $.when(saveDeferred).done(function () {\r\n                                //Save edited rows\r\n                                if (!bizagi.util.isEmpty(self.changes)) {\r\n                                    self.saveRows();\r\n                                }\r\n\r\n                                args.render.endActionExecution();\r\n                            });\r\n\r\n                            return;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            var isExclusiveControl = dataType == \"columnBoolean\" && renderColumn.properties.isExclusive;\r\n\r\n            if (!isExclusiveControl && (self.properties.allowEdit || isNewRecord)) {\r\n                self.collectGridChange($.extend(args, {\r\n                    id: key,\r\n                    xpath: renderColumn.properties.xpath || renderColumn.properties.id,\r\n                    value: _value,\r\n                    compositeValue: compositeValue,\r\n                    columnIndex: renderColumn.columnIndex,\r\n                    trigger: trigger\r\n                }));\r\n            }\r\n\r\n            if (isExclusiveControl && self.properties.allowEdit) {\r\n                self.triggerGridPluginHandler(\"deleteCellExclusiveValues\", renderColumn.columnIndex);\r\n            }\r\n\r\n            // Update change in grid's component data\r\n            self.triggerGridPluginHandler(\"changeCellValue\", key, renderColumn.columnIndex, _value);\r\n\r\n            // If the column has totalizers then we need to refresh the summary\r\n            if (renderColumn.properties.totalize && renderColumn.properties.totalize.operation) {\r\n                self.triggerGridPluginHandler(\"refreshSummary\", renderColumn.columnIndex);\r\n            }\r\n        } catch (error) {\r\n            bizagi.log(error.message);\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Executes when the cell is ready and inserted into the DOM\r\n    */\r\n    onCellReady: function (column, key, cell, isNewRow) {\r\n        var self = this;\r\n\r\n        // Get render column\r\n        var columnIndex = column.index - 1;\r\n        var cellOverride = self.getCellOverride(key, columnIndex);\r\n        var renderColumn = self.columns[columnIndex];\r\n        var properties = self.cellMetadata[key][columnIndex].properties || renderColumn.originalProperties;\r\n        var visible = properties.visible !== undefined ? properties.visible : true;\r\n        var editable = properties.editable !== undefined ? properties.editable : true;\r\n\r\n        // apply overrides\r\n        visible = cellOverride.visible;\r\n\r\n        if (column.bizAgiProperties.columnwidth) {\r\n            $(cell).css({\r\n                \"min-width\": column.bizAgiProperties.columnwidth,\r\n                \"max-width\": column.bizAgiProperties.columnwidth\r\n            });\r\n        }\r\n\r\n        // If the cell we are drawing is the summary cell, we need to make it readonly\r\n        if (key == \"summary\")\r\n            editable = false;\r\n\r\n        // Show editable cell when we are performing inline add operation\r\n        if (isNewRow) {\r\n            editable = true;\r\n        }\r\n\r\n        // Show editable cell when we are performing inline add operation\r\n        if (column.bizAgiProperties.type === \"columnActions\") {\r\n            editable = true;\r\n        }\r\n\r\n        if (visible) {\r\n\r\n            if (editable) {\r\n\r\n                // Set editable\r\n                var originalEditable = renderColumn.properties.editable;\r\n                renderColumn.properties.editable = editable;\r\n\r\n                // Set xpath context for submitonchange action\r\n                if (renderColumn.properties.submitOnChange) {\r\n                    var control = renderColumn.getDecorated(key);\r\n                    if (control) {\r\n                        control.properties.submitOnChangexpathContext = self.properties.xpath + \"[]\";\r\n                        control.properties.submitOnChangexpathContextRow = self.properties.xpath + \"[id=\" + key + \"]\";\r\n                    }\r\n                }\r\n\r\n                // Execute cell post render\r\n                renderColumn.postRender(key, cell);\r\n\r\n                // Restore editable\r\n                renderColumn.properties.editable = originalEditable;\r\n\r\n            } else {\r\n\r\n                if (key == \"summary\") {\r\n                    //apply styles to summary cells\r\n                    if (!renderColumn.postRenderSummary(key, cell)) {\r\n                        self.applySummaryColumnStyles(cell, properties);\r\n                    }\r\n\r\n                } else {\r\n                    // Call post-render\r\n                    renderColumn.postRenderReadOnly(key, cell);\r\n                }\r\n\r\n            }\r\n\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Get aligning class\r\n    */\r\n    getAlignClass: function (alignType) {\r\n        switch (alignType) {\r\n            case 'right':\r\n                return \"ui-bizagi-grid-align-right\";\r\n                break;\r\n            case 'left':\r\n                return \"ui-bizagi-grid-align-left\";\r\n                break;\r\n            case 'center':\r\n                return \"ui-bizagi-grid-align-center\";\r\n                break;\r\n            case 'justify':\r\n                return \"ui-bizagi-grid-align-justify\";\r\n                break;\r\n        }\r\n\r\n    },\r\n    /**\r\n     *  Adds a row to the grid\r\n     */\r\n    addRow: function (addFormDialog) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var reverseButtons = properties.orientation == \"rtl\" ? true : false;\r\n        var buttons = [];\r\n\r\n        if (addFormDialog) {\r\n            // Send add request\r\n            if (addFormDialog.open) {\r\n                return;\r\n            } else {\r\n                addFormDialog.open = true;\r\n            }\r\n        }\r\n        $.when(self.submitAddRequest())\r\n            .done(function (newid) {\r\n\r\n                // Show dialog with new form after that\r\n                var dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n                    title: properties.addLabel,\r\n                    orientation: properties.orientation || \"ltr\",\r\n                    maximized: bizagi.override.maximizeGridPopup || false,\r\n                    onSave: function (data) {\r\n                        if (properties.contextType) {\r\n                            data[self.dataService.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = properties.contextType;\r\n                        }\r\n                        return self.submitSaveRequest(newid, data);\r\n                    },\r\n                    onCancel: function () {\r\n                    }\r\n                });\r\n\r\n                buttons[0] = {\r\n                    text: bizagi.localization.getResource(\"render-form-dialog-box-save\"),\r\n                    click: function (data) {\r\n                        if (properties.contextType) {\r\n                            data[self.dataService.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = properties.contextType;\r\n                        }\r\n                        return self.submitSaveRequest(newid, data);\r\n                    }\r\n                }\r\n\r\n                buttons[1] = {\r\n                    text: bizagi.localization.getResource(\"render-form-dialog-box-cancel\"),\r\n                    click: function () {\r\n                        self.submitRollbackRequest();\r\n                    }\r\n                }\r\n\r\n                if (reverseButtons)\r\n                    buttons.reverse();\r\n\r\n                var recordXpath = properties.xpath + \"[id=\" + newid + \"]\";\r\n                dialog.render({\r\n                    idRender: properties.id,\r\n                    recordXPath: recordXpath,\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: properties.idPageCache,\r\n                    requestedForm: \"addForm\",\r\n                    contextType: properties.contextType,\r\n                    url: properties.addPage,\r\n                    mainForm: self.getFormContainer ? self.getFormContainer() : null\r\n                })\r\n                    .done(function () {\r\n                        // Set loading status\r\n                        self.startLoading();\r\n\r\n                        if (!properties.submitOnChange) {\r\n                            // Reload grid\r\n                            self.fetchData();\r\n\r\n                        } else {\r\n                            // Submits the entire form\r\n                            self.submitOnChange().always(function () {\r\n                                self.endLoading();\r\n                            });\r\n                        }\r\n                    })\r\n                    .fail(function (data) {\r\n                        addFormDialog.open = false;\r\n                        $.when(self.submitRollbackRequest(data)).done(function () {\r\n                            self.submitInvalidatePageCacheRequest(data);\r\n                        });\r\n                    });\r\n            });\r\n    },\r\n\r\n    /* Return true of the grid is editable and has edit form*/\r\n    canEditRow: function(){\r\n        var self = this;\r\n        var properties = self.properties;\r\n        return properties.allowEdit && properties.withEditForm && properties.data != null;\r\n    },\r\n    /**\r\n     *  Edits a row in the grid with Form\r\n     *\r\n     */\r\n    editRow: function (id) {\r\n\r\n        if (id == 0 || id == undefined) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"render-grid-message-no-selected-row\"), bizagi.localization.getResource(\"render-grid-header-no-selected-row\"));\r\n            return;\r\n        }\r\n\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        //Checks if there is any pending changes in the selected row\r\n        if (self.changes[id] !== undefined) {\r\n\r\n            var data = $.extend(self.changes[id], {});\r\n            data.idPageCache = properties.idPageCache;\r\n            data.disableServerGridValidations = true;\r\n\r\n            $(\".ui-tooltip\").remove();\r\n\r\n            $.when(self.submitSaveRequest(id, data)).done(function () {\r\n\r\n                // Set loading status\r\n                self.startLoading();\r\n\r\n                if (!properties.submitOnChange) {\r\n                    // Reload grid\r\n                    self.fetchData();\r\n\r\n                } else {\r\n                    // Submits the entire form\r\n                    self.submitForGridChange().always(function () {\r\n                        self.endLoading();\r\n\r\n                        // Send edit request\r\n                        self.executeSubmitEditRequest(id);\r\n                    });\r\n                }\r\n            });\r\n        } else {\r\n            self.executeSubmitEditRequest(id);\r\n        }\r\n    },\r\n\r\n\r\n    /*\r\n    * Gets the format header and builds a object with a css string for label and header\r\n    */\r\n    getHeaderStyles: function () {\r\n        var self = this;\r\n        var label = \"\";\r\n        var header = \"\";\r\n        var properties = self.properties;\r\n\r\n        if (properties.headerFormat) {\r\n            var format = properties.headerFormat;\r\n\r\n            if (format.color) {\r\n                label += \"color: \" + format.color + \" !important;\";\r\n            }\r\n\r\n            if (format.background) {\r\n                header += \"background-color: \" + format.background + \";\";\r\n            }\r\n\r\n            label += \"font-weight: \" + ((format.bold) ? \"bold; \" : \"normal; \");\r\n\r\n            if (format.italic) {\r\n                label += \"font-style: italic; \";\r\n            }\r\n\r\n            if (format.underline || format.strikethru) {\r\n                var strikethru = bizagi.util.parseBoolean(format.strikethru) ? \"line-through \" : \"\";\r\n                var underline = bizagi.util.parseBoolean(format.underline) ? \"underline \" : \"\";\r\n\r\n                label += \"text-decoration: \" + strikethru + underline + \";\";\r\n            }\r\n\r\n            if (format.size && format.size != \"0\") {\r\n                var newFontSize = (100 + Number(format.size) * 10) + \"%\";\r\n                label += \"font-size: \" + newFontSize + \";\";\r\n            }\r\n\r\n        }\r\n\r\n        return {label: label, header: header};\r\n    },\r\n\r\n    /**\r\n     * Deprecated method\r\n     *\r\n     * Edit record without form\r\n     * @param int id\r\n     * @returns\r\n     */\r\n    editInlineRow: function (id) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        if (id == 0 || id == undefined) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"render-grid-message-no-selected-row\"), bizagi.localization.getResource(\"render-grid-header-no-selected-row\"));\r\n            return;\r\n        }\r\n\r\n        // Show save and cancel buttons\r\n        var buttons = $(\"[data-bizagi-component=buttons]\", control);\r\n        buttons.find(\"[data-action=save]\").css(\"display\", \"inline-block\");\r\n        buttons.find(\"[data-action=cancel]\").css(\"display\", \"inline-block\");\r\n\r\n        // Change row to editable\r\n        self.changeRowEditable(id, true);\r\n\r\n    },\r\n    /*\r\n    * Change all cells in the row\r\n    */\r\n    changeRowEditable: function (id, editable) {\r\n    },\r\n    /*\r\n    *   Changes the background for a cell\r\n    */\r\n    changeCellBackgroundColor: function (key, xpath, argument) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n            var control = self.getControlCell(key, xpath);\r\n            if (control) {\r\n                control.changeCellBackgroundColor(argument);\r\n            }\r\n        } else {\r\n            self.pendingActions.push({\r\n                method: self.changeCellBackgroundColor,\r\n                arguments: arguments\r\n            });\r\n        }\r\n\r\n\r\n    },\r\n    /*\r\n    *   Changes the background for a cell\r\n    */\r\n    changeCellColor: function (key, xpath, argument) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n            var control = self.getControlCell(key, xpath);\r\n            if (control)\r\n                control.changeCellColor(argument);\r\n        } else {\r\n            self.pendingActions.push({\r\n                method: self.changeCellColor,\r\n                arguments: arguments\r\n            });\r\n        }\r\n    },\r\n    /*\r\n    *   Changes the visibility for a cell\r\n    */\r\n    changeCellVisibility: function (key, xpath, argument) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n\r\n            var control = self.getControlCell(key, xpath);\r\n            if (control) {\r\n                control.changeCellVisibility(argument);\r\n                for (var j = 0; j < self.columns.length; j++) {\r\n                    if (self.columns[j].properties.xpath == xpath) {\r\n                        break;\r\n                    }\r\n                }\r\n                self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n                self.getCellOverride(key, j).visible = argument;\r\n            }\r\n        } else {\r\n            self.pendingActions.push({\r\n                method: self.changeCellVisibility,\r\n                arguments: arguments\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Changes the editability for a cell\r\n    */\r\n    changeCellEditability: function (key, xpath, argument) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n\r\n            var control = self.getControlCell(key, xpath);\r\n            if (control && control.control) {\r\n                control.changeEditabilityCellControl(argument, key, xpath);\r\n                for (var j = 0; j < self.columns.length; j++) {\r\n                    if (self.columns[j].properties.xpath == xpath) {\r\n                        break;\r\n                    }\r\n                }\r\n                self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n                self.getCellOverride(key, j).editable = argument;\r\n            }\r\n        } else {\r\n            self.pendingActions.push({\r\n                method: self.changeEditability,\r\n                arguments: arguments\r\n            });\r\n        }\r\n    },\r\n    /*\r\n    *  Clean data of cell\r\n    */\r\n    cleanCellData: function (key, xpath) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n            var control = self.getControlCell(key, xpath);\r\n            if (control) {\r\n                control.cleanData();\r\n                for (var j = 0; j < self.columns.length; j++) {\r\n                    if (self.columns[j].properties.xpath == xpath) {\r\n                        break;\r\n                    }\r\n                }\r\n                var rows = self.properties.data.rows, i = 0, rowLength = rows.length;\r\n                for (; i < rowLength; i++) {\r\n                    if (Number(key) === rows[i][0]) {\r\n                        rows[i][j + 1] = \"\";\r\n                        break;\r\n                    }\r\n                }\r\n                self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n                self.getCellOverride(key, j).value = null;\r\n            }\r\n        } else {\r\n            self.pendingActions.push({\r\n                method: self.cleanData,\r\n                arguments: \"\"\r\n            });\r\n        }\r\n    },\r\n    /*\r\n    *  Changes the required for cell\r\n    */\r\n    changeCellRequired: function (key, xpath, argument) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n            var control = self.getControlCell(key, xpath);\r\n            if (control) {\r\n                control.changeCellRequired(argument);\r\n                for (var j = 0; j < self.columns.length; j++) {\r\n                    if (self.columns[j].properties.xpath == xpath) {\r\n                        break;\r\n                    }\r\n                }\r\n                self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n                self.getCellOverride(key, j).required = argument;\r\n            }\r\n        } else {\r\n            self.pendingActions.push({method: self.changeCellRequired, arguments: arguments});\r\n        }\r\n    },\r\n    /*\r\n    *  Changes the required for cell\r\n    */\r\n    changeCellValue: function (key, xpath, argument) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n            var control = self.getControlCell(key, xpath);\r\n            if (control) {\r\n                control.setDisplayValue(argument);\r\n                /*ISUPP 3866 */\r\n                var _value = control.column.getValue(key);\r\n                var compositeValue = control.column.getCompositeValue(key);\r\n                control.setDisplayValue(argument);\r\n                var trigger = false;\r\n                control.triggerHandler(\"renderchange\", {render: self, changed: true});\r\n                self.collectGridChange({\r\n                    id: key,\r\n                    xpath: xpath,\r\n                    value: _value,\r\n                    compositeValue: compositeValue,\r\n                    columnIndex: control.column,\r\n                    trigger: trigger\r\n                });\r\n            }\r\n        } else {\r\n            self.pendingActions.push({\r\n                method: self.setDisplayValue,\r\n                arguments: arguments\r\n            });\r\n        }\r\n\r\n    },\r\n    /*\r\n     *   Changes the max value for a cell\r\n     */\r\n    changeCellMaxValue: function (key, xpath, argument) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n            var control = self.getControlCell(key, xpath);\r\n            if (control) {\r\n                control.changeMaxValue(argument);\r\n            }\r\n        } else {\r\n            self.pendingActions.push({\r\n                method: self.changeMaxValue,\r\n                arguments: arguments\r\n            });\r\n        }\r\n\r\n\r\n    },\r\n    /*\r\n     *   Changes the min value for a cell\r\n     */\r\n    changeCellMinValue: function (key, xpath, argument) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n            var control = self.getControlCell(key, xpath);\r\n            if (control) {\r\n                control.changeMinValue(argument);\r\n            }\r\n        } else {\r\n            self.pendingActions.push({\r\n                method: self.changeMinValue,\r\n                arguments: arguments\r\n            });\r\n        }\r\n    },\r\n    /**\r\n     *  Deletes  a row to the grid\r\n     */\r\n    deleteRow: function (id) {\r\n        var self = this;\r\n\r\n        if (!id || id == 0) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"render-grid-message-no-selected-row\"), bizagi.localization.getResource(\"render-grid-header-no-selected-row\"));\r\n            return;\r\n        }\r\n\r\n        bizagi.showConfirmationBox(this.getResource(\"render-grid-delete-confirmation\"))\r\n            .done(function () {\r\n\r\n                $.when(self.saveRows()).done(function () {\r\n                    // Do a grid record deletion\r\n                    $.when(self.submitDeleteRequest(id)).done(function (data) {\r\n                        // Remove temporal record\r\n                        self.removeNewRecords({keys: [id]});\r\n\r\n                        // Check if the answer of request was valid\r\n                        // if there an rule validation on delete action, the answer could be invalid\r\n                        // data.type == \"validationMessage\"\r\n                        if (data.type == \"success\") {\r\n                            // Trigger the event\r\n                            //'key' must be included to trigger a single call to actions and validations\r\n                            //line 310 bizagi.command.controllers.action\r\n                            self.triggerRenderChange({rowDeleted: true, changed: false, key: id});\r\n                        }\r\n\r\n                        // Reload grid\r\n                        self.properties.changed = false;\r\n                        self.properties.method = \"delete\";\r\n\r\n                        self.calculateFetchData(data, id);\r\n                    });\r\n                });\r\n\r\n            });\r\n    },\r\n\r\n    calculateFetchData: function (data, id) {\r\n        var self = this, rows;\r\n        var properties = self.properties;\r\n\r\n        if (data.type === \"success\") {\r\n            rows = properties.data && properties.data.rows;\r\n            if (rows.length === 1 && rows[0][0] === Number(id)) {\r\n                if (properties.page > 1) {\r\n                    return self.fetchData(properties.page - 1);\r\n                }\r\n            }\r\n        }\r\n\r\n        return self.fetchData();\r\n    },\r\n\r\n    saveRows: function () {\r\n        var self = this;\r\n        var data = {};\r\n        var form = self.getFormContainer();\r\n\r\n        self.collectData(data);\r\n\r\n        if ($.isEmptyObject(data)) {\r\n            return;\r\n        } else {\r\n            return self.dataService.submitData({\r\n                action: \"save\",\r\n                data: data,\r\n                xpathContext: form.properties.xpathContext,\r\n                idPageCache: form.properties.idPageCache\r\n            });\r\n        }\r\n    },\r\n\r\n    moreRows: function (ui) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (typeof properties.originalrowsPerPage === \"undefined\") {\r\n            properties.originalrowsPerPage = properties.rowsPerPage;\r\n        }\r\n        properties.rowsPerPage += properties.originalrowsPerPage;\r\n\r\n        var dataToSend = {};\r\n        self.collectData(dataToSend);\r\n\r\n        if (jQuery.isEmptyObject(dataToSend)) {\r\n            self.moreRowsCommon(ui);\r\n            return;\r\n        }\r\n        // Send the data\r\n        self.dataService.submitData({\r\n            action: \"SUBMITDATA\",\r\n            data: dataToSend,\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache\r\n        }).done(function () {\r\n            self.moreRowsCommon(ui);\r\n        });\r\n\r\n    },\r\n\r\n    moreRowsCommon: function (ui) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        self.fetchData(ui.page, ui.sortBy, ui.sortType);\r\n\r\n        $.when(self.dataReadyDeferred).done(function () {\r\n\r\n            if (properties.records != 0)\r\n                if (properties.records + 1 <= properties.rowsPerPage) {\r\n                    $(\".ui-bizagi-grid-dynamic-pager\", self.getControl()).hide();\r\n                }\r\n\r\n        });\r\n    },\r\n\r\n    executeSubmitEditRequest: function (id) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var reverseButtons = properties.orientation == \"rtl\" ? true : false;\r\n        var buttons = [];\r\n\r\n        var showSaveButton = self.getFormContainer().properties.displayAsReadOnly == true ? false : true;\r\n\r\n        $.when(self.submitEditRequest(id))\r\n            .done(function () {\r\n                // Show dialog with new form after that\r\n                var recordXpath = properties.xpath + \"[id=\" + id + \"]\";\r\n\r\n                var dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n                    title: properties.editLabel,\r\n                    showSaveButton: showSaveButton,\r\n                    orientation: properties.orientation || \"ltr\",\r\n                    maximized: bizagi.override.maximizeGridPopup || false,\r\n                    onSave: function (data) {\r\n                        return self.submitSaveRequest(id, data);\r\n                    }, //Setup the print functionality\r\n                    extraButtons: (bizagi.override.enablePrintFromEditForm) ? {\r\n                        \"workportal-widget-dialog-box-print\": function () {\r\n                            self.printFormCommand = new bizagi.workportal.command.printform(self.renderFactory);\r\n\r\n                            var printParams = {\r\n                                idRender: properties.id,\r\n                                recordXPath: recordXpath,\r\n                                xpathContext: properties.xpathContext,\r\n                                idPageCache: properties.idPageCache,\r\n                                requestedForm: \"editForm\",\r\n                                contextType: properties.contextType\r\n                            };\r\n\r\n                            self.printFormCommand.print(printParams);\r\n                        }\r\n                    } : {}\r\n                });\r\n\r\n                buttons[0] = {\r\n                    text: bizagi.localization.getResource(\"render-form-dialog-box-save\"),\r\n                    click: function (data) {\r\n                        return self.submitSaveRequest(id, data);\r\n                    }\r\n                };\r\n\r\n                if (reverseButtons)\r\n                    buttons.reverse();\r\n\r\n                dialog.render({\r\n                    idRender: properties.id,\r\n                    recordXPath: recordXpath,\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: properties.idPageCache,\r\n                    requestedForm: \"editForm\",\r\n                    url: properties.editPage,\r\n                    contextType: properties.contextType\r\n                })\r\n                    .done(function () {\r\n                        // Set loading status\r\n                        self.startLoading();\r\n\r\n                        if (!properties.submitOnChange) {\r\n                            // Reload grid\r\n                            self.fetchData();\r\n\r\n                        } else {\r\n                            // Submits the entire form\r\n                            self.submitOnChange().always(function () {\r\n                                self.endLoading();\r\n                            });\r\n                        }\r\n\r\n                    })\r\n                    .fail(function (data) {\r\n                        $.when(self.submitRollbackRequest(data)).done(function () {\r\n                            self.submitInvalidatePageCacheRequest(data);\r\n                        });\r\n                    });\r\n            });\r\n    },\r\n    /**\r\n     *  Show details with record information\r\n     */\r\n    showFormDetails: function (id) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (id == 0 || id == undefined) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"render-grid-message-no-selected-row\"), bizagi.localization.getResource(\"render-grid-header-no-selected-row\"));\r\n            return;\r\n        }\r\n\r\n        var dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n            title: properties.detailLabel || bizagi.localization.getResource(\"render-grid-details-form\"),\r\n            showSaveButton: false,\r\n            maximized: bizagi.override.maximizeGridPopup || false,\r\n            cancelButtonLabel: bizagi.localization.getResource(\"render-form-dialog-box-close\")\r\n        });\r\n\r\n        // Show dialog with new form after that\r\n        var recordXpath = properties.xpath + \"[id=\" + id + \"]\";\r\n\r\n        dialog.render({\r\n            idRender: properties.id,\r\n            recordXPath: recordXpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            requestedForm: \"detailForm\",\r\n            url: properties.editPage,\r\n            editable: false\r\n        });\r\n    },\r\n    /*\r\n    *   Retrieve the data for the new rows and push them into the server\r\n    */\r\n    saveInlineAddedRows: function (keys, hasRefresh) {\r\n        var self = this;\r\n        var queue = [];\r\n        hasRefresh = hasRefresh !== undefined ? hasRefresh : true;\r\n        self.dataReadyDeferred = new $.Deferred();\r\n\r\n        for (var i = 0; i < keys.length; i++) {\r\n            queue.push(self.prepareAddAction(keys[i]));\r\n        }\r\n\r\n        // Set Flag to prevent duplicate records (modal window)\r\n        self.properties.alreadySaved = true;\r\n\r\n        // Perform the batch\r\n        return $.when.apply($, queue).done(function (response) {\r\n            //Remove new records\r\n            self.cleanNewRecords();\r\n\r\n            // Refresh\r\n            if (hasRefresh) {\r\n                self.properties.changed = false;\r\n                self.refresh();\r\n            }\r\n            $.when(self.dataReady()).done(function () {\r\n                self.triggerRenderChange({changed: false});\r\n            });\r\n        });\r\n    },\r\n    /*\r\n    *   Prepares the add action\r\n    */\r\n    prepareAddAction: function (key) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Build submit data\r\n        var submitData = self.changes[key];\r\n\r\n        return self.dataService.multiaction().addGridRecordData({\r\n            url: properties.addUrl,\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contexttype,\r\n            idPageCache: properties.idPageCache,\r\n            submitData: submitData\r\n        });\r\n    },\r\n    /*\r\n    * Removes invalid records\r\n    */\r\n    removeNewRecords: function (ui) {\r\n        var self = this;\r\n        var hasRefresh = false;\r\n\r\n        if (ui && ui.refresh) {\r\n            hasRefresh = (self.changes && Object.keys(self.changes).length > 0) && !self.isValid([]);\r\n        }\r\n\r\n        if (ui && ui.keys) {\r\n            $.each(ui.keys, function (_, key) {\r\n                if (self.newRecords[key]) {\r\n                    delete self.newRecords[key];\r\n                }\r\n            });\r\n        }\r\n\r\n        // Refresh grid\r\n        if (hasRefresh) {\r\n            self.properties.changed = false;\r\n            self.refresh();\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Show the print menu options\r\n    */\r\n    showGridExportOptions: function () {\r\n        var self = this, content, exportPst, changes, container;\r\n        var form = self.getFormContainer();\r\n        var expMenuDirection = (self.properties.buttonsPst === true) ? \"top\" : \"bottom\";\r\n        if (self.properties.orientation == \"rtl\") {\r\n\r\n            content = self.getControl();\r\n            exportPst = (self.properties.buttonsPst === true) ? $('.ui-bizagi-grid-export-options-wrapper-rtl', content).outerHeight() : -1 * $('.ui-bizagi-grid-export-options-content-rtl', content).outerHeight();\r\n            changes = [];\r\n\r\n            //Adjust the print options wrapper to the required position, upper the print options button        \r\n            $('.ui-bizagi-grid-export-options-content-rtl', content).css(\r\n                expMenuDirection, exportPst\r\n            );\r\n\r\n            if ($('.ui-bizagi-grid-export-options-content-rtl', content).hasClass('hidden')) {\r\n                $('.ui-bizagi-grid-export-options-content-rtl', content).removeClass('hidden');\r\n                $('.ui-bizagi-grid-export-options-content-rtl', content).show();\r\n            } else {\r\n                $('.ui-bizagi-grid-export-options-content-rtl', content).addClass('hidden');\r\n                self.grid.find(\".bz-rn-grid-data-wraper\").removeClass(\"bz-rn-grid-data-wraper-fix-w8-scroll\");\r\n            }\r\n            if (form) {\r\n                container = $(form.container);\r\n\r\n                if ((self.hasChanged(changes) && self.properties.alreadySaved === false && form.properties.editable) || (self.properties.canBeExported === false && form.properties.editable)) {\r\n                    if (self.properties.alreadySaved === false && !$(\"li[data-action='save']\", self.grid).is(\":visible\")) {\r\n                        self.properties.canBeExported = true;\r\n                    } else {\r\n                        //when the table has totalizer counts as change,  although that is not a change\r\n                        if (!(Object.keys(self.changes).length == 1 && self.changes.summary)) {\r\n                            $(\"#print-grid-save-first\", content).show();\r\n                            $(\"#print-grid-pdf\", content).hide();\r\n                            $(\"#print-grid-xls\", content).hide();\r\n                        }\r\n                    }\r\n                } else {\r\n                    self.properties.canBeExported = true;\r\n                }\r\n            }\r\n        } else {\r\n\r\n            content = self.getControl();\r\n            exportPst = (self.properties.buttonsPst === true) ? $('.ui-bizagi-grid-export-options-wrapper', content).outerHeight() : -1 * $('.ui-bizagi-grid-export-options-content', content).outerHeight();\r\n            changes = [];\r\n\r\n            //Adjust the print options wrapper to the required position, upper the print options button        \r\n            $('.ui-bizagi-grid-export-options-content', content).css(\r\n                expMenuDirection, exportPst\r\n            );\r\n\r\n            if ($('.ui-bizagi-grid-export-options-content', content).hasClass('hidden')) {\r\n                $('.ui-bizagi-grid-export-options-content', content).removeClass('hidden');\r\n                $('.ui-bizagi-grid-export-options-content', content).show();\r\n            } else {\r\n                $('.ui-bizagi-grid-export-options-content', content).addClass('hidden');\r\n                self.grid.find(\".bz-rn-grid-data-wraper\").removeClass(\"bz-rn-grid-data-wraper-fix-w8-scroll\");\r\n            }\r\n            if (form) {\r\n                container = $(form.container);\r\n\r\n                if ((self.hasChanged(changes) && self.properties.alreadySaved === false && form.properties.editable) || (self.properties.canBeExported === false && form.properties.editable)) {\r\n                    if (self.properties.alreadySaved === false && !$(\"li[data-action='save']\", self.grid).is(\":visible\")) {\r\n                        self.properties.canBeExported = true;\r\n                    } else {\r\n                        //when the table has totalizer counts as change,  although that is not a change\r\n                        if (!(Object.keys(self.changes).length == 1 && self.changes.summary)) {\r\n                            $(\"#print-grid-save-first\", content).show();\r\n                            $(\"#print-grid-pdf\", content).hide();\r\n                            $(\"#print-grid-xls\", content).hide();\r\n                        }\r\n                    }\r\n                } else {\r\n                    self.properties.canBeExported = true;\r\n                }\r\n            }\r\n\r\n        }\r\n\r\n    },\r\n\r\n    /*\r\n    * Executes collapse grid\r\n    */\r\n    performCollapseGrid: function () {\r\n        var self = this;\r\n\r\n        if (self.properties.orientation == \"rtl\") {\r\n            content = self.getControl(),\r\n                $gridWrapper = $(\".bz-rn-grid-wrapper\", content),\r\n                $collapseIcon = $(\".bz-rn-grid-cn-header-rtl .ui-icon\", content);\r\n\r\n            $collapseIcon.toggleClass(\"ui-state-collapse\").toggleClass(\"ui-state-expand\");\r\n            $gridWrapper.toggleClass(\"bz-rn-grid-body-collapse\");\r\n\r\n            self.collapseState = $gridWrapper.hasClass(\"bz-rn-grid-body-collapse\");\r\n            self.triggerGridPluginHandler(\"updateCollapseState\", self.collapseState);\r\n            self.updateCollapseState();\r\n\r\n        } else {\r\n            content = self.getControl(),\r\n                $gridWrapper = $(\".bz-rn-grid-wrapper\", content),\r\n                $collapseIcon = $(\".bz-rn-grid-cn-header .ui-icon\", content);\r\n            $header = $(\".bz-rn-grid-cn-header\", content);\r\n            $header.toggleClass(\"bz-rn-grid-header-state-collapsed\").toggleClass(\"bz-rn-grid-header-state-active\");\r\n\r\n            $collapseIcon.toggleClass(\"ui-state-collapse\").toggleClass(\"ui-state-expand\");\r\n            $gridWrapper.toggleClass(\"bz-rn-grid-body-collapse\");\r\n\r\n            self.collapseState = $gridWrapper.hasClass(\"bz-rn-grid-body-collapse\");\r\n            self.triggerGridPluginHandler(\"updateCollapseState\", self.collapseState);\r\n            self.updateCollapseState();\r\n        }\r\n    },\r\n    /*\r\n     * Update collapse grid state\r\n     */\r\n    updateCollapseState: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        params = {};\r\n\r\n        $.extend(params, {\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contextType,\r\n            idPageCache: properties.idPageCache,\r\n            collapseState: self.collapseState\r\n        });\r\n\r\n        // example of process property value\r\n        return self.dataService.multiaction().getCollapseData(params);\r\n    },\r\n    /*\r\n    *Executes the grid export\r\n    * @param params (Object) exportType: \"pdfExport\" Handles the print functionality showing a message warning the user\r\n    * to install Adobe Acrobat, if he haven't installed\r\n    */\r\n    performExportGrid: function (params) {\r\n        var self = this;\r\n        var result = true;\r\n        var filePrintUrl = self.getGridExportUrl(params);\r\n\r\n        if (params.exportType == \"pdfExport\") {\r\n            var isAcrobatInstalled = self.checkAdobePlugin();\r\n            if ($.browser.msie && !isAcrobatInstalled) {\r\n                result = false;\r\n\r\n                $.when(bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-acrobat-message\")))\r\n                    .done(function () {\r\n                        self.downloadExportedGrid(filePrintUrl);\r\n                    });\r\n            }\r\n        }\r\n\r\n        if (result)\r\n            self.downloadExportedGrid(filePrintUrl);\r\n    },\r\n\r\n    /*\r\n    * Updates manually the affected cell \r\n    * @param key: the key of the affected cells's column\r\n    * @param newValue: the new value to store in the affected cell\r\n    * @param columnIndex: the column index of the cells's column\r\n    */\r\n    updateAffectedCellManually: function (key, newValue, columnIndex) {\r\n        var self = this;\r\n        var i = self.columns.length;\r\n        var rowIndex = self.getRowIndexByKey(key);\r\n\r\n        //updates the value manually if is different than the current\r\n        if (typeof (rowIndex) !== \"undefined\" && self.properties.data.rows[rowIndex][columnIndex] !== newValue) {\r\n            self.properties.data.rows[rowIndex][columnIndex] = newValue;\r\n\r\n            //Refresh the summary\r\n            var summary = $(\".ui-bizagi-grid-summary\", self.grid);\r\n            summary.empty();\r\n            summary.html(self.grid.bizagi_grid_desktop(\"drawSummary\"));\r\n            self.grid.bizagi_grid_desktop(\"postRenderSummary\", summary);\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Get the row index using the key as a reference\r\n    */\r\n    getRowIndexByKey: function (key) {\r\n        var self = this;\r\n        var i = self.properties.data.rows.length;\r\n\r\n        while (i-- > 0) {\r\n            if (key == self.properties.data.rows[i][0]) {\r\n                return i;\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Checks if the Adobe Acrobat is installed\r\n    */\r\n    checkAdobePlugin: function (filePrintUrl) {\r\n        var installed;\r\n        try {\r\n            installed = new ActiveXObject('AcroPDF.PDF');\r\n        } catch (e) {\r\n            bizagi.log(e);\r\n        }\r\n\r\n        if (!installed) {\r\n            try {\r\n                // Older Ie\r\n                installed = new ActiveXObject('PDF.PdfCtrl');\r\n            } catch (e) {\r\n                bizagi.log(e);\r\n            }\r\n        }\r\n\r\n        return installed;\r\n    },\r\n    /*\r\n    *   open a new window whith the created file\r\n    */\r\n    downloadExportedGrid: function (filePrintUrl) {\r\n        window.open(filePrintUrl);\r\n    },\r\n\r\n    /*\r\n    *\r\n    */\r\n    formatGrid: function (control) {\r\n        //var control = printContent,\r\n        var tableControl = $('.ui-bizagi-grid-table', control);\r\n        var pageContent = $('.ui-pg-table', control);\r\n        var closeButton = $('.ui-jqgrid-titlebar-close', control);\r\n\r\n        $(\"th.ui-bizagi-column-hidden, td.ui-bizagi-grid-key, .bz-rn-grid-container-foother\", control).remove();\r\n\r\n        //Remove click event\r\n        $(\"[data-action], ul li, .ui-bizagi-grid-column, tr, th\", tableControl).unbind(\"click\");\r\n\r\n        // Remove close button\r\n        $(closeButton).remove();\r\n    },\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready\r\n    */\r\n    ready: function () {\r\n        var self = this;\r\n        var parentPromise = self._super();\r\n        var inlineAddPromise = self.inlineAddDeferred ? self.inlineAddDeferred.promise() : null;\r\n        return $.when(parentPromise, inlineAddPromise);\r\n    },\r\n\r\n    /*\r\n    * Apply Columns Width in postrender\r\n    */\r\n    applyColumnsWidth: function (grid, columns) {\r\n\r\n        for (var i = 0; i < columns.length; i++) {\r\n            var column = grid.find(\".resizableColumn\")[i];\r\n\r\n            if (column) {\r\n                var columnIndex = $(column).find(\">.ui-bizagi-grid-column\");\r\n                var index = columnIndex.length == 1 ? Number($(column).find(\">.ui-bizagi-grid-column\").data(\"column-index\")) : i;\r\n                var columnWidth = columns[index].bizAgiProperties.columnwidth;\r\n                var widthToApply = \"auto\";\r\n\r\n                if (columns[index].bizAgiProperties && columnWidth && columnWidth != \"auto\") {\r\n                    widthToApply = columnWidth;\r\n                }\r\n                $(column).css(\"width\", widthToApply);\r\n                $(column).find(\".ui-bizagi-grid-column\").css(\"width\", \"auto\");\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Apply Columns Width in update (add or delete a row)\r\n    */\r\n    applyColumnsWidthUpdate: function (grid, columns) {\r\n\r\n        var self = this, index = null, column = null, columnIndex = null, columnWidth = null, widthToApply = null;\r\n        var resizableColumns = grid.find(\".resizableColumn\");\r\n        var length = resizableColumns.length;\r\n\r\n        for (var i = 0; i < length; i++) {\r\n            column = resizableColumns[i];\r\n            columnIndex = $(column).find(\">.ui-bizagi-grid-column\");\r\n            index = columnIndex.length == 1 ? (Number($(column).find(\">.ui-bizagi-grid-column\").data(\"column-index\")) - 1) : i;\r\n\r\n            columnWidth = columns[index].properties.columnwidth;\r\n            widthToApply = \"auto\";\r\n\r\n            if (columns[index].properties && columnWidth && columnWidth != \"auto\") {\r\n                widthToApply = columnWidth;\r\n            }\r\n\r\n            $(column).css(\"width\", widthToApply);\r\n            $(column).find(\".ui-bizagi-grid-column\").css(\"width\", \"auto\");\r\n        }\r\n\r\n    },\r\n\r\n    /*\r\n    *   Apply summary column styles to a specified element\r\n    */\r\n    applySummaryColumnStyles: function (element, properties) {\r\n        var self = this;\r\n        var elementChild = element.find(\".ui-bizagi-grid-summary-readonly\");\r\n\r\n        if (properties.totalize != null && properties.totalize.format != null) {\r\n            var format = properties.totalize.format;\r\n            var textDecorator = \"\";\r\n\r\n            // Set cell back color\r\n            if (format.background) {\r\n                element.css(\"background-color\", format.background);\r\n                element.css(\"background-image\", \"none\");\r\n            }\r\n            if (format.size && format.size != \"0\") {\r\n                var size = format.size.toString();\r\n                var operator = size.substring(0, 1);\r\n                var value = size.substring(1, size.length);\r\n                value = operator == \"+\" ? 100 + (10 * Number(value)) : 100 - (10 * Number(value));\r\n                elementChild.css(\"font-size\", value + \"%\");\r\n            }\r\n            if (format.italic) {\r\n                elementChild.css(\"font-style\", \"italic\");\r\n            }\r\n            if (format.color) {\r\n                elementChild.css(\"color\", format.color);\r\n            }\r\n            if (format.underline) {\r\n                textDecorator += \"underline \";\r\n            }\r\n            if (format.strikethru) {\r\n                textDecorator += \"line-through\";\r\n            }\r\n            if (format.bold == true || format.bold == undefined) {\r\n                elementChild.css(\"font-weight\", \"bold\");\r\n            }\r\n            elementChild.css(\"text-decoration\", textDecorator);\r\n        }\r\n    },\r\n\r\n    /* Return the icons container*/\r\n    getContainerIcons: function () {\r\n        return $(\"> .ui-bizagi-control > .ui-bizagi-control-wrapper > .ui-bizagi-render-icons\", this.element);\r\n    },\r\n\r\n    /**\r\n     * Customizes render color\r\n     * @param color\r\n     * @param isLabelFormat\r\n     */\r\n    changeColor: function (color, isLabelFormat) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var label = self.getLabel();\r\n        var isLabelFormat = (typeof isLabelFormat !== \"undefined\" || isLabelFormat != null) ? isLabelFormat : true;\r\n\r\n        if (control && label) {\r\n            if (color != \"none\") {\r\n                // Hide - show the render\r\n                if (self.properties.displayType === \"value\" || !isLabelFormat) {\r\n                    self.getElementsToStylize(self.getControl()).css(\"color\", color, \"!important\");\r\n                    self.getControl().find(\"*\")\r\n                        .each(function (i, element) {\r\n                            self.getElementsToStylize(element).css(\"color\", color, \"!important\");\r\n                        });\r\n                } else {\r\n                    self.element.each(function () {\r\n                        this.style.setProperty('color', color, 'important');\r\n                    });\r\n\r\n                    // Container of header\r\n                    self.getControl().find(\"[data-bizagi-component=header] span\").each(function () {\r\n                        this.style.setProperty('color', color, 'important');\r\n                    });\r\n\r\n                    self.getLabel().find(\"label\").css(\"color\", color, \"!important\");\r\n\r\n                    if (!self.properties.editable) {\r\n                        var $tableContext = self.getControl();\r\n\r\n                        self.getElementsToStylize($tableContext).css(\"color\", color, \"!important\");\r\n\r\n                        // Container of content\r\n                        if ((bizagi.override && bizagi.override.enableColorHeaderGrid === true) && self.hasColorHeader()) {\r\n                            $tableContext = $tableContext.find(\"[data-bizagi-component=rows]\");\r\n                        }\r\n\r\n                        self.getElementsToStylize($(\"label\", $tableContext).css(\"color\", color, \"!important\"));\r\n                    }\r\n\r\n                }\r\n            } else {\r\n                this._super(color, isLabelFormat);\r\n            }\r\n        }\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Smartphone Render Grouped Grid Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the Grouped Grid render class to adjust to smartphone devices\r\n */\r\n\r\n// Extends from Grid desktop base\r\nbizagi.rendering.desktop.grid.bizagi.extend(\"bizagi.rendering.desktop.grid.grouped\", {}, {\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        data.properties.hideActionsColumn = true;\r\n        data.properties = self.convertProperties(data.properties);\r\n        // Parse data through group engine\r\n\r\n        // Create a single instance for each cell\r\n        data.properties.singleInstance = false;\r\n\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Create a data-structure to keep track of each cell properties\r\n        this.cellMetadata = {};\r\n\r\n        // Create a collection to save grid cell changes to execute after it is loaded\r\n        this.pendingActions = [];\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        properties.withEditForm = properties.allowEdit;\r\n\r\n\r\n        // set collapse grid\r\n        this.collapseState = properties.collapseState;\r\n\r\n        // Just apply display-type: vertical, align it to the left\r\n        properties.displayType = \"vertical\";\r\n        properties.labelAlign = \"left\";\r\n\r\n    },\r\n\r\n    /*\r\n    *   Customizes the content drawing inside the cell\r\n    */\r\n    drawCell: function (column, key, value, isNewRow) {\r\n        var self = this;\r\n        if (column.key) {\r\n            return value;\r\n        }\r\n\r\n        // Get render column\r\n        var cellOverride = self.getCellOverride(key, column.index - 1);\r\n        var columnIndex = column.index - 1;\r\n        var renderColumn = self.columns[columnIndex];\r\n\r\n        // Fix issue suite-8559, data with null records\r\n        /* console.log(self.newRecords);*/\r\n        self.newRecords = self.newRecords || {};\r\n\r\n        // Get cell properties\r\n        if (!self.cellMetadata[key]) {\r\n            self.cellMetadata[key] = {};\r\n        }\r\n        if (!self.cellMetadata[key][columnIndex]) {\r\n            self.cellMetadata[key][columnIndex] = {};\r\n        }\r\n        var properties = self.cellMetadata[key][columnIndex].properties || renderColumn.originalProperties;\r\n        var visible = properties.visible !== undefined ? properties.visible : true;\r\n        var editable = properties.editable !== undefined ? properties.editable : true;\r\n\r\n        // Apply overrides from cellOverrides\r\n        visible = cellOverride.visible;\r\n        editable = (properties.editable) ? cellOverride.editable : false;\r\n\r\n        // Show editable cell when we are performing inline add operation\r\n        if (isNewRow)\r\n            editable = true;\r\n\r\n        renderColumn.properties.displayType = 'value';\r\n\r\n        // If the cell we are drawing is the summary cell, we need to make it readonly\r\n        if (typeof key === \"string\" && key.indexOf(\"summary\") >= 0) {\r\n            editable = false;\r\n        }\r\n        // Do the render\r\n        if (visible) {\r\n            if (editable)\r\n                return self.drawEditableCell(renderColumn, properties, key, value, isNewRow);\r\n            else\r\n                return self.drawReadonlyCell(renderColumn, properties, key, value);\r\n\r\n        } else {\r\n            return \"<label></label>\";\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Draws the readonly version for the cell\r\n    */\r\n    drawReadonlyCell: function (renderColumn, properties, key, value) {\r\n        var self = this;\r\n        var result = \"\";\r\n\r\n        // Use totalizer format when printing summary row\r\n        if (typeof key === \"string\" && key.indexOf(\"summary\") >= 0) {\r\n            var originalFormat = renderColumn.properties.textFormat;\r\n            if (renderColumn.properties.totalize) {\r\n                renderColumn.properties.textFormat = renderColumn.properties.totalize.format;\r\n            }\r\n\r\n            result = renderColumn.renderSummary(key, value);\r\n\r\n            // Restore column format\r\n            renderColumn.properties.textFormat = originalFormat;\r\n        } else {\r\n            result = renderColumn.renderReadOnly(key, value);\r\n        }\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    *   Executes when the cell is ready and inserted into the DOM\r\n    */\r\n    onCellReady: function (column, key, cell, isNewRow) {\r\n        var self = this;\r\n\r\n        // Get render column\r\n        var columnIndex = column.index - 1;\r\n        var renderColumn = self.columns[columnIndex];\r\n        var properties = self.cellMetadata[key][columnIndex].properties || renderColumn.originalProperties;\r\n        var visible = properties.visible !== undefined ? properties.visible : true;\r\n        var editable = properties.editable !== undefined ? properties.editable : true;\r\n\r\n        // If the cell we are drawing is the summary cell, we need to make it readonly\r\n        if (typeof key === \"string\" && key.indexOf(\"summary\") >= 0)\r\n            editable = false;\r\n\r\n        // Show editable cell when we are performing inline add operation\r\n        if (isNewRow) {\r\n            editable = true;\r\n        }\r\n\r\n        if (visible) {\r\n\r\n            if (editable) {\r\n\r\n                // Set editable\r\n                var originalEditable = renderColumn.properties.editable;\r\n                renderColumn.properties.editable = editable;\r\n\r\n                // Set xpath context for submitonchange action\r\n                if (renderColumn.properties.submitOnChange) {\r\n                    var control = renderColumn.getDecorated(key);\r\n                    if (control) {\r\n                        control.properties.submitOnChangexpathContext = self.properties.xpath + \"[]\";\r\n                    }\r\n                }\r\n\r\n                // Execute cell post render\r\n                renderColumn.postRender(key, cell);\r\n\r\n                // Restore editable\r\n                renderColumn.properties.editable = originalEditable;\r\n\r\n            } else {\r\n\r\n                if (typeof key === \"string\" && key.indexOf(\"summary\") >= 0) {\r\n                    //apply styles to summary cells\r\n                    if (!renderColumn.postRenderSummary(key, cell)) {\r\n                        self.applySummaryColumnStyles(cell, properties);\r\n                    }\r\n\r\n                } else {\r\n                    // Call post-render\r\n                    renderColumn.postRenderReadOnly(key, cell);\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    // Reserverd to make convertions of control properties\r\n    convertProperties: function (properties) {\r\n\r\n        // Change inline add\r\n        properties.inlineAdd = false;\r\n\r\n        // Change inline edit\r\n        properties.inlineEdit = false;\r\n\r\n        return properties;\r\n    },\r\n\r\n    /**\r\n     * WARNING: This method here is required in order to avoid changes in the font weigth for the grid\r\n     */\r\n    changeFontBold: function () {\r\n        return this;\r\n    },\r\n\r\n    /*\r\n    * Applies grid plugin \r\n    */\r\n    applyGridPlugin: function () {\r\n        var self = this,\r\n            grid = self.grid,\r\n            properties = self.properties,\r\n            mode = self.getMode();\r\n\r\n        var pager = self.renderFactory.getTemplate(\"bizagi.grid.pagination\");\r\n\r\n        var scrollableArea = self.getFormContainer().params.canvas.scrollParent();\r\n        // Apply grid plugin\r\n        grid.bizagi_grid_grouped_desktop({\r\n            columns: self.buildColumnModel(),\r\n            showSummary: properties.showSummary,\r\n            title: properties.displayName,\r\n            mode: self.getMode(),\r\n            scrollableArea: scrollableArea,\r\n            floatingHeader: properties.floatingHeader || false,\r\n            tableCssClass: \"\",\r\n            sortBy: properties.sortBy || \"\",\r\n            sortOrder: properties.sortOrder || \"\",\r\n            smartPagination: true,\r\n            collapse: (mode !== \"execution\") ? false : true, // por defecto las grillas seran colapsables en ejecucion\r\n            collapseState: (mode !== \"execution\") ? false : self.collapseState,\r\n            buttonsPst: (mode !== \"execution\") ? false : properties.buttonsPst,\r\n            sortType: bizagi.override.gridDefaultSortBy || \"asc\",\r\n            headerStyles: self.getHeaderStyles(),\r\n            groupByColumns: self.groupByColumns() || [],\r\n            template: {\r\n                grid: self.renderFactory.getTemplate(\"bizagi.grid.grid\"),\r\n                waiting: self.renderFactory.getTemplate(\"bizagi.grid.waiting\"),\r\n                table: self.renderFactory.getTemplate(\"bizagi.grid.grouped.table\"),\r\n                emptyTable: self.renderFactory.getTemplate(\"bizagi.grid.table.empty\"),\r\n                column: self.renderFactory.getTemplate(\"bizagi.grid.grouped.column\"),\r\n                specialColumn: self.renderFactory.getTemplate(\"bizagi.grid.column.special\"),\r\n                row: self.renderFactory.getTemplate(\"bizagi.grid.grouped.row\"),\r\n                headerRow: self.renderFactory.getTemplate(\"bizagi.grid.grouped.header.row\"),\r\n                rowButtons: self.renderFactory.getTemplate(\"bizagi.grid.row.buttons\"),\r\n                cell: self.renderFactory.getTemplate(\"bizagi.grid.cell\"),\r\n                emptyCell: self.renderFactory.getTemplate(\"bizagi.grid.grouped.emptyCell\"),\r\n                specialCell: self.renderFactory.getTemplate(\"bizagi.grid.cell.special\"),\r\n                pager: pager,\r\n                buttons: self.renderFactory.getTemplate(\"bizagi.grid.buttons\"),\r\n                dynamicPager: self.renderFactory.getTemplate(\"bizagi.grid.dynamicpager\"),\r\n                summary: self.renderFactory.getTemplate(\"bizagi.grid.grouped.summary\"),\r\n                summaryCell: self.renderFactory.getTemplate(\"bizagi.grid.grouped.summaryCell\"),\r\n                exportOptions: self.renderFactory.getTemplate(\"bizagi.grid.exportOptions\")\r\n            },\r\n            actions: {\r\n                add: properties.allowAdd,\r\n                edit: (properties.allowEdit && properties.withEditForm && properties.data != null),\r\n                remove: properties.allowDelete,\r\n                details: properties.allowDetail,\r\n                inlineAdd: properties.inlineAdd,\r\n                allowMore: properties.allowMore,\r\n                enableXlsExport: properties.enableXlsExport,\r\n                enablePdfExport: properties.enablePdfExport\r\n            },\r\n            tooltips: {\r\n                addLabel: properties.addLabel,\r\n                editLabel: properties.editLabel,\r\n                deleteLabel: properties.deleteLabel,\r\n                detailLabel: properties.detailLabel,\r\n                exportOptionsLabel: properties.exportOptionsLabel\r\n            },\r\n            isValid: function () {\r\n                // Validate records\r\n                var errorsMessage = [];\r\n                var form = self.getFormContainer();\r\n\r\n                // fix for SUITE-8696\r\n                if (form.validationController !== undefined) {\r\n                    form.validationController.clearValidationMessages();\r\n                }\r\n\r\n                self.isValid(errorsMessage);\r\n\r\n                if (errorsMessage.length > 0) {\r\n                    // Show validation message\r\n                    for (var i = 0; i < errorsMessage.length; i++) {\r\n                        form.validationController.showValidationMessage(errorsMessage[i].message, errorsMessage[i].xpath);\r\n                    }\r\n\r\n                    return false;\r\n                } else {\r\n                    return true;\r\n                }\r\n            },\r\n            pageRequested: function (ui) {\r\n                if (mode !== \"execution\") return;\r\n\r\n                var sortName;\r\n                var getColumn = self.getColumn(ui.sortBy);\r\n                if (getColumn) {\r\n                    sortName = getColumn.getSortName();\r\n                } else {\r\n                    getColumn = self.getColumn(ui.sortBy.split(\".\")[0]);\r\n                    if (getColumn) {\r\n                        sortName = getColumn.getSortName();\r\n                    }\r\n                }\r\n\r\n                if (ui.sortBy.split(\".\").length > 1) {\r\n                    if (ui.sortBy.split(\".\")[0] == sortName) {\r\n                        sortName = ui.sortBy;\r\n                    }\r\n                }\r\n\r\n                self.fetchData(ui.page, sortName, ui.sortType);\r\n\r\n            },\r\n            sortRequested: function (ui) {\r\n                if (mode !== \"execution\") return;\r\n\r\n                // Get column sort xpath\r\n                var sortName;\r\n                var getColumn = self.getColumn(ui.sortBy);\r\n                if (getColumn) {\r\n                    sortName = getColumn.getSortName();\r\n                } else {\r\n                    getColumn = self.getColumn(ui.sortBy.split(\".\")[0]);\r\n                    if (getColumn) {\r\n                        sortName = getColumn.getSortName();\r\n                    }\r\n                }\r\n\r\n                if (ui.sortBy.split(\".\").length > 1) {\r\n                    if (ui.sortBy.split(\".\")[0] == sortName) {\r\n                        sortName = ui.sortBy;\r\n                    }\r\n                }\r\n\r\n                // Perform the sort\r\n                self.fetchData(ui.page, sortName, ui.sortType);\r\n            },\r\n            drawCell: function (ui) {\r\n                return self.drawCell(ui.column, ui.key, ui.value, ui.isNewRow);\r\n            },\r\n            cellReady: function (ui) {\r\n                return self.onCellReady(ui.column, ui.key, ui.cell, ui.isNewRow);\r\n            },\r\n            rowSelected: function (ui) {\r\n                if (mode !== \"execution\") return;\r\n                self.triggerHandler(\"rowSelected\", {id: ui.key});\r\n            },\r\n            addRow: function () {\r\n                if (mode !== \"execution\") return;\r\n                self.addRow.apply(self, arguments);\r\n            },\r\n            editRow: function (ui) {\r\n                if (mode !== \"execution\") return;\r\n\r\n                if (self.properties.withEditForm) {\r\n                    self.editRow(ui.key);\r\n                }\r\n            },\r\n            deleteRow: function (ui) {\r\n                if (mode !== \"execution\") return;\r\n                self.deleteRow(ui.key);\r\n            },\r\n            moreRows: function (ui) {\r\n                if (mode !== \"execution\") return;\r\n                self.moreRows(ui);\r\n            },\r\n            saveAddedRows: function (ui) {\r\n                self.saveInlineAddedRows(ui.keys);\r\n            },\r\n            beforeInlineAdd: function () {\r\n                self.inlineAddDeferred = new $.Deferred();\r\n            },\r\n            afterInlineAdd: function () {\r\n                if (self.inlineAddDeferred) {\r\n                    self.inlineAddDeferred.resolve();\r\n                }\r\n            },\r\n            showFormDetails: function (id) {\r\n                self.showFormDetails(id.key);\r\n            },\r\n            cancelEdition: function (ui) {\r\n                self.removeNewRecords(ui);\r\n            },\r\n            removeNewRecords: function (ui) {\r\n                self.removeNewRecords(ui);\r\n            },\r\n            showGridExportOptions: function () {\r\n                self.showGridExportOptions();\r\n            },\r\n            performExportGrid: function (printParams) {\r\n                self.performExportGrid(printParams);\r\n            },\r\n            performCollapseGrid: function () {\r\n                self.performCollapseGrid();\r\n            },\r\n            rowdblclick: function (ui) {\r\n                if (mode != \"execution\") return;\r\n                \r\n                if (self.canEditRow())\r\n                    self.editRow(ui.businessKey);\r\n            } \r\n        });\r\n\r\n    },\r\n\r\n    /*\r\n    * Returns an array with the position of columns set to group by property\r\n    */\r\n    groupByColumns: function () {\r\n        var self = this;\r\n        var groupByColumns = [];\r\n\r\n        for (var i = 0, l = self.columns.length; i < l; i++) {\r\n            var column = self.columns[i];\r\n            if (column.properties.groupBy) {\r\n                groupByColumns.push(i + 1);\r\n            }\r\n        }\r\n\r\n        return groupByColumns;\r\n    },\r\n\r\n    /*\r\n    *\r\n    */\r\n    triggerGridPluginHandler: function () {\r\n        var self = this;\r\n        var args = Array.prototype.slice.call(arguments, 0);\r\n\r\n        return self.grid.bizagi_grid_grouped_desktop.apply(self.grid, args);\r\n    },\r\n\r\n\r\n    /*\r\n    *   Method to fetch data from the server and then update the data\r\n    */\r\n    fetchData: function (page, sortBy, sortType) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        self.dataReadyDeferred = new $.Deferred();\r\n\r\n        // Define defaults\r\n        page = page || (properties.page || 1);\r\n        sortBy = sortBy || (properties.sortBy || \"id\");\r\n        sortType = sortType || (properties.sortOrder || \"asc\");\r\n\r\n        // Update control properties\r\n        properties.page = page;\r\n        properties.sortBy = sortBy;\r\n        properties.sortType = sortType;\r\n        properties.sort = sortBy + \" \" + sortType;\r\n\r\n        // Start loading to avoid multiple calls to the server\r\n        self.startLoading();\r\n\r\n        $.when(self.getRemoteData()).then(function (data) {\r\n            self.endLoading();\r\n            if (self.disposed) return;\r\n            if (data) {\r\n                self.loadChanges(data.rows);\r\n                self.updateData(data);\r\n                self.triggerRenderChange();\r\n                self.dataReadyDeferred.resolve();\r\n            }\r\n        });\r\n    }\r\n});","/**\r\n *   Name: Bizagi Desktop Render Search Extension\r\n *   Author: Bizagi UI Forms\r\n *   Comments:\r\n *   -   This script will redefine the search render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.search\", bizagi.rendering.search.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.search.extend(\"bizagi.rendering.desktop.search\", {\r\n    ADVANCED_SEARCH_ID: -1,\r\n    ADVANCED_ADDITION_ID: -2,\r\n    CLEAR_SEARCH_ID: -3,\r\n    NO_RESULTS_SEARCH_ID: -4,\r\n    SEARCH_DELAY: 750,\r\n    SEARCH_MAX_RECORDS: 50\r\n}, {\r\n    /**\r\n     *   Update or init the element data\r\n     * @param {} data submitData\r\n     * @returns {}\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.searchImage = properties.searchImage || this.dataService.getSearchDefaultImage();\r\n\r\n        // Store reference of all ajax request in order to run only one instance of them\r\n        var deferredReference = null;\r\n    },\r\n\r\n    /**\r\n     *   Template method to implement in each device to customize each render after processed\r\n     * @returns {}\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Apply plugin\r\n        self.searchInput = $(\"input\", control);\r\n        self.advancedSearch = $(\"button\", control);\r\n\r\n        if (self.properties.advancedSearch) {\r\n            control.addClass('ui-bizagi-advanced-search');\r\n        }\r\n\r\n        self.applyAutocompletePlugin();\r\n    },\r\n\r\n    postRenderReadOnly: function () {\r\n        this.setDisplayValue(this.properties.value);\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     * @returns {}\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Bind select event\r\n        var searchInput = self.searchInput;\r\n        searchInput.bind(\"autocompleteselect\", function (e, ui) {\r\n            // ui.item.id == self.Class.CLEAR_SEARCH_ID || was taken off in order to allow rule execution when clicking on clear\r\n            if (ui.item.id == self.Class.ADVANCED_SEARCH_ID || ui.item.id == self.Class.ADVANCED_ADDITION_ID || ui.item.id == self.Class.CLEAR_SEARCH_ID || ui.item.id == self.Class.NO_RESULTS_SEARCH_ID)\r\n                return false;\r\n\r\n            self.setValue(ui.item);\r\n            self.selectedValue = ui.item.value;\r\n\r\n            // Format additional label\r\n            ui.item.value = self.formatItem(ui.item.value);\r\n\r\n            //IE 8 Focus fix - SUITE-9517\r\n            if (document.selection) {\r\n                // Set focus on the element\r\n                searchInput.focus();\r\n\r\n                // Create empty selection range\r\n                var oSel = document.selection.createRange();\r\n\r\n                // Move selection start and end to 0 position\r\n                oSel.moveStart(\"character\", -self.selectedValue.length);\r\n\r\n                // Move selection start and end to desired position\r\n                oSel.moveStart(\"character\", 0);\r\n                oSel.moveEnd(\"character\", self.selectedValue.length);\r\n                oSel.select();\r\n            }\r\n\r\n            return true;\r\n        });\r\n\r\n        self.bind(\"onSearchError\", function (e, data) {\r\n            var form = self.getFormContainer();\r\n            form.clearValidationMessages();\r\n\r\n            try {\r\n                //Add information of cotrol\r\n                var msgObj = self.properties.displayName + \": \";\r\n                msgObj += JSON.parse(data.responseText).message;\r\n                form.addValidationMessage(msgObj, \"\", \"ui-icon-alert\");\r\n            } catch (e) {\r\n                // If data does not json string, show data content\r\n                form.addValidationMessage(data);\r\n            }\r\n\r\n            self.hideAutocompleteLoading();\r\n        });\r\n\r\n        // Bind click event\r\n        searchInput.click(function () {\r\n            // close if already visible\r\n            if (searchInput.autocomplete(\"widget\").is(\":visible\")) {\r\n                searchInput.autocomplete(\"close\");\r\n                return;\r\n            }\r\n\r\n            searchInput.autocomplete(\"search\", $(searchInput).val());\r\n        });\r\n\r\n        // Bind click event\r\n        self.advancedSearch.click(function () {\r\n            self.showSearchDialog();\r\n        });\r\n\r\n        // Allow delete item If It's a suggest and \"allow clear\" property is enable\r\n        if (!self.properties.advancedSearch) {\r\n            var suggestFocus = function (event) {\r\n                var value = $.trim(this.value);\r\n\r\n                if (this.value === \"\" && self.properties.allowClear) {\r\n                    var value = {id: \"\"};\r\n\r\n                    self.setDisplayValue(value);\r\n                    self.setValue(value, false);\r\n                } else {\r\n                    self.setDisplayValue(self.getValue());\r\n                }\r\n            };\r\n\r\n            searchInput.on(\"blur\", suggestFocus);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Apply autocomplete capabilities to a single input\r\n     * @returns {}\r\n     */\r\n    applyAutocompletePlugin: function () {\r\n        var self = this;\r\n        var searchInput = self.searchInput;\r\n        var orientation = self.getFormContainer().properties.orientation;\r\n        var alignForSuggest = orientation == \"rtl\" ? \"right\" : \"left\";\r\n        var rtlClassForSuggest = orientation == \"rtl\" ? \" suggest-rtl\" : \"\";\r\n\r\n        // Apply autocomplete plugin\r\n        searchInput.autocomplete({\r\n            autoFocus: true,\r\n            messages: {\r\n                noResults: null, //\"No search results.\",\r\n                results: function () {\r\n                }\r\n            },\r\n            search: function (event, ui) {\r\n            },\r\n            source: function (req, add) {\r\n                // active search\r\n                self.activeRequestTerm = req.term;\r\n\r\n                // Check local storage\r\n                var now = new Date().getTime();\r\n                var parseRequest = encodeURIComponent(req.term);\r\n                var expireKey = self.properties.xpath + \"_\" + parseRequest + \"_expire\";\r\n                var requestKey = self.properties.xpath + \"_\" + parseRequest;\r\n                var expire = bizagi.util.getItemLocalStorage(expireKey);\r\n\r\n                if (expire && self.properties.enableLocalStorage && now < expire) {\r\n                    try {\r\n                        var data = JSON.parse(bizagi.util.getItemLocalStorage(requestKey));\r\n                        add(data);\r\n                        self.hideAutocompleteLoading();\r\n                    } catch (e) {\r\n                        self.processRequest(req, add);\r\n                    }\r\n                } else {\r\n                    self.processRequest(req, add);\r\n                }\r\n            },\r\n            open: function () {\r\n                var suggestMenu = searchInput.data(\"ui-autocomplete\").menu.element;\r\n                var suggestStyles = {top: 0, left: 0};\r\n                var suggestContainer = searchInput.closest(\".ui-bizagi-control\");\r\n                var controlContainer = suggestContainer.parent();\r\n                var itemWidth = self.calculateSuggestionWidth();\r\n                var menu = searchInput.data(\"ui-autocomplete\").menu;\r\n\r\n                $('li', suggestMenu).each(function () {\r\n                    $(this).addClass(rtlClassForSuggest);\r\n\r\n                    if ($(this).index() % 2 < 1) $(this).addClass(\"biz-ui-even\");\r\n                });\r\n\r\n                // Fix position to prevent the scroll of autocomplete\r\n                suggestMenu.css(suggestStyles);\r\n                suggestContainer.addClass(\"ac-is-visible\");\r\n                controlContainer.addClass(\"ac-is-visible ac-clear-floats\");\r\n\r\n                suggestMenu.appendTo(suggestContainer).position({\r\n                    my: alignForSuggest + \" top\",\r\n                    at: alignForSuggest + \" bottom\",\r\n                    of: this,\r\n                    collision: \"flipfit\"\r\n                });\r\n\r\n                suggestMenu.css(\"z-index\", $.getMaxZindex() + 10);\r\n\r\n                // Add data to check if element is visible\r\n                suggestMenu.attr(\"visible\", true);\r\n\r\n                // Apply with to menu and items\r\n                $(\".ui-bizagi-render-search-item\", suggestMenu).width(itemWidth);\r\n                suggestMenu.width(itemWidth);\r\n                self.hideAutocompleteLoading();\r\n            },\r\n            close: function () {\r\n                searchInput.data(\"ui-autocomplete\").menu.element.attr(\"visible\", false);\r\n            },\r\n            delay: this.Class.SEARCH_DELAY\r\n        });\r\n\r\n        // Special rendering\r\n        searchInput.data(\"ui-autocomplete\")._renderItem = function (ul, item) {\r\n            // Render for clear search\r\n            if (item.id == self.Class.CLEAR_SEARCH_ID) {\r\n                return self.renderClearItem(ul, item).appendTo(ul);\r\n            }\r\n            // Render for advanced search\r\n            if (item.id == self.Class.ADVANCED_SEARCH_ID) {\r\n                return self.renderAdvancedItem(ul, item).appendTo(ul);\r\n            }\r\n\r\n            // Render for allow addition\r\n            if (item.id == self.Class.ADVANCED_ADDITION_ID) {\r\n                return self.renderAddItem(ul, item).appendTo(ul);\r\n            }\r\n\r\n            // Normal rendering\r\n            return self.renderSearchItem(item).appendTo(ul);\r\n        };\r\n    },\r\n\r\n    /**\r\n     *   Renders a search item\r\n     * @param {} item\r\n     * @returns {}\r\n     */\r\n    renderSearchItem: function (item) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"searchItem\");\r\n\r\n        var searchItem = $.tmpl(template, {\r\n            image: properties.searchImage,\r\n            label: item.label,\r\n            orientation: self.properties.orientation || \"lrt\"\r\n        });\r\n\r\n        searchItem.data(\"item.autocomplete\", item);\r\n\r\n        return searchItem;\r\n    },\r\n\r\n    /**\r\n     * Renders the advanced item\r\n     * @returns {}\r\n     */\r\n    renderAdvancedItem: function () {\r\n        var self = this;\r\n        var searchItem = self.renderSearchItem({\r\n            id: self.Class.ADVANCED_SEARCH_ID,\r\n            label: this.getResource(\"render-search-advanced-label\")\r\n        });\r\n\r\n        // Bind click event\r\n        searchItem.click(function () {\r\n            self.showSearchDialog();\r\n        });\r\n\r\n        return searchItem;\r\n    },\r\n\r\n    /**\r\n     * Renders the advanced item\r\n     * @returns {}\r\n     */\r\n    renderClearItem: function () {\r\n        var self = this;\r\n        var searchItem = self.renderSearchItem({\r\n            id: self.Class.CLEAR_SEARCH_ID,\r\n            label: this.getResource(\"render-search-clear-label\")\r\n        });\r\n\r\n        // Bind click event\r\n        searchItem.click(function () {\r\n            var value = {id: \"\"};\r\n\r\n            self.setDisplayValue(value);\r\n            self.setValue(value);\r\n\r\n            // Submit info to server\r\n            self.readyActionExecution().done(function () {\r\n                if (self.properties.submitOnChange) {\r\n                    self.submitData();\r\n                }\r\n            });\r\n        });\r\n\r\n        return searchItem;\r\n    },\r\n\r\n    /**\r\n     * Renders the add item\r\n     * @returns {}\r\n     */\r\n    renderAddItem: function () {\r\n        var data = {id: this.Class.ADVANCED_ADDITION_ID, label: this.getResource(\"render-search-add-label\")};\r\n        var searchItem = this.renderSearchItem(data);\r\n\r\n        return searchItem;\r\n    },\r\n\r\n    /**\r\n     *   Process the request data for the autocomplete control\r\n     * @param {} req\r\n     * @param {} add\r\n     * @returns {}\r\n     */\r\n    processRequest: function (req, add) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        // Create array for response objects\r\n        var suggestions = [];\r\n\r\n        if (self.properties.allowSuggest && (req.term.length >= self.properties.searchLength)) {\r\n            self.showAutocompleteLoading();\r\n\r\n            // Update term property to reflect the search\r\n            properties.term = req.term;\r\n\r\n            /**\r\n             * Cancel previous request in order to improve the performance\r\n             */\r\n            if (this.deferredReference && typeof this.deferredReference.reject === \"function\" && this.deferredReference.state() !== \"resolved\") {\r\n                this.deferredReference.reject({hideStatus: true});\r\n            }\r\n\r\n            self.deferredReference = this.getData().done(function (data) {\r\n\r\n                if (data && data.length > 0) {\r\n                    data = data.slice(0, properties.maxRecords);\r\n\r\n                    if (data.length > self.Class.SEARCH_MAX_RECORDS) {\r\n                        data = data.slice(0, self.Class.SEARCH_MAX_RECORDS);\r\n\r\n                        suggestions.push({\r\n                            id: self.Class.NO_RESULTS_SEARCH_ID,\r\n                            label: self.getResource(\"render-search-maximum-records-allowed\"),\r\n                            value: \"\"\r\n                        });\r\n                    } else {\r\n                        data = data.slice(0, properties.maxRecords);\r\n                    }\r\n\r\n                    $.each(data, function (i, val) {\r\n                        if (properties.maxRecords == 0 || i < properties.maxRecords) {\r\n                            var parseValue = bizagi.util.highlightMatches(val, req.term);\r\n\r\n                            suggestions.push({id: val.id, label: parseValue, value: val.value});\r\n                        }\r\n                    });\r\n                } else {\r\n                    suggestions.push({\r\n                        id: self.Class.NO_RESULTS_SEARCH_ID,\r\n                        label: self.getResource(\"render-grid-no-records\"),\r\n                        value: \"\"\r\n                    });\r\n                }\r\n\r\n                addToSuggestions(suggestions, req.term);\r\n\r\n                self.hideAutocompleteLoading();\r\n            });\r\n        } else {\r\n            addToSuggestions(suggestions, req.term);\r\n        }\r\n\r\n        /*\r\n        *   Method to add the special items to the suggestions\r\n        */\r\n        function addToSuggestions(allSuggestions, request) {\r\n            // Add the clear option\r\n            if (properties.allowClear && self.value !== undefined) {\r\n                allSuggestions.push({id: self.Class.CLEAR_SEARCH_ID, label: \"\", value: \"\"});\r\n            }\r\n            // Add additional option if advanced search is on\r\n            if (properties.advancedSearch) {\r\n                allSuggestions.push({id: self.Class.ADVANCED_SEARCH_ID, label: \"\", value: \"\"});\r\n            }\r\n\r\n            // Add additional option if allow addition is on\r\n            if (properties.allowAdd) {\r\n                allSuggestions.push({id: self.Class.ADVANCED_ADDITION_ID, label: \"\", value: \"\"});\r\n            }\r\n\r\n            // Create local storage to improve the speed\r\n            var expireTime = new Date().getTime() + self.properties.expireCache;\r\n            var parseRequest = encodeURIComponent(request);\r\n\r\n            if (self.properties.enableLocalStorage) {\r\n                var expireKey = self.properties.xpath + \"_\" + parseRequest + \"_expire\";\r\n                var requestKey = self.properties.xpath + \"_\" + parseRequest;\r\n\r\n                bizagi.util.setItemLocalStorage(expireKey, expireTime);\r\n                bizagi.util.setItemLocalStorage(requestKey, JSON.encode(allSuggestions));\r\n            }\r\n\r\n            // Pass array to callback\r\n            add(allSuggestions);\r\n        }\r\n    },\r\n\r\n    /**\r\n     *   Returns the desired width for the suggestion menu\r\n     * @returns {}\r\n     */\r\n    calculateSuggestionWidth: function () {\r\n        var suggestMenu = this.searchInput.data(\"ui-autocomplete\").menu.element;\r\n        return suggestMenu.width();\r\n    },\r\n    /**\r\n     *   Sets the value in the rendered control\r\n     * @param {} value\r\n     * @returns {}\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var label = \"\";\r\n\r\n        value = self.mapValue(value);\r\n\r\n        if (value != undefined && value != null) {\r\n            if (properties.editable) {\r\n                if (typeof (value.value) !== \"undefined\" && value.value) {\r\n                    self.searchInput.val(self.formatItem(value.value));\r\n\r\n                    self.setValue({id: self.getValueId(value), label: self.getValueLabel(value)});\r\n                } else if (value.additionallabel && value.label) {\r\n                    label = value.label + \" - \" + value.additionallabel;\r\n                    self.searchInput.val(label);\r\n                } else if (value.label) {\r\n                    self.searchInput.val(value.label);\r\n                } else if (value && typeof value.id !== \"undefined\" && value.id === \"\") {\r\n                    self.searchInput.val(\"\");\r\n                } else if (typeof value != \"object\") {\r\n                    self.searchInput.val(value);\r\n                }\r\n            } else {\r\n                var control = self.getControl();\r\n\r\n                label = value.label || value.value;\r\n\r\n                if (typeof (label) !== \"undefined\") {\r\n                    if (typeof label == \"object\") {\r\n                        label = label.join(\" - \");\r\n                    }\r\n                } else {\r\n                    label = \"\";\r\n                }\r\n\r\n                if (typeof (label) === \"string\") {\r\n                    if (value.additionallabel) {\r\n                        label += \" - \" + value.additionallabel;\r\n                    }\r\n\r\n                    label = bizagi.util.sanitizeHTML(label);\r\n                }\r\n\r\n                control.html(label);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     *   Returns the value to display, ex. non-editable renders\r\n     * @returns {}\r\n     */\r\n    getDisplayValue: function () {\r\n        return this.selectedValue;\r\n    },\r\n\r\n    /**\r\n     * Open Add new record dialog\r\n     * @returns {}\r\n     */\r\n    showAddRecordDialog: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var buttons = {\r\n            text: bizagi.localization.getResource(\"render-form-dialog-box-add\"),\r\n            click: function () {\r\n                // Show dialog with add form\r\n                var dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n                    showSaveButton: properties.editable,\r\n                    title: bizagi.localization.getResource(\"render-dialog-entity\"),\r\n                    orientation: self.properties.orientation || \"ltr\",\r\n                    onSave: function (data) {\r\n                        // Remove pagecache from data\r\n                        var idPageCache = data.idPageCache;\r\n                        var defer = $.Deferred();\r\n\r\n                        var params = {\r\n                            action: \"SAVE\",\r\n                            data: data,\r\n                            idPageCache: idPageCache,\r\n                            guidEntity: properties.entity,\r\n                            contexttype: \"entity\"\r\n                        };\r\n\r\n                        // Check if the add form has data\r\n                        var formData = {};\r\n                        // Turn on flag to force to collect all data on the form\r\n                        $.forceCollectData = true;\r\n\r\n                        dialog.form.collectRenderValues(formData);\r\n\r\n                        // Turn off flag\r\n                        $.forceCollectData = false;\r\n\r\n                        if (!bizagi.util.isMapEmpty(formData)) {\r\n                            $.when(self.dataService.submitData(params)).done(function (response) {\r\n\r\n                                // Set the previous added record to search grid form\r\n                                function dataHasXpath(xpath) {\r\n                                    var render = self.searchDialog.currentSearchForm.getRender(xpath);\r\n\r\n                                    if (typeof render == \"object\" && render != null) {\r\n                                        return {\"found\": true, \"obj\": render};\r\n                                    }\r\n\r\n                                    return {\"found\": false, \"obj\": {}};\r\n                                }\r\n\r\n                                for (var i in formData) {\r\n                                    var mapping = dataHasXpath(i);\r\n                                    if (mapping.found) {\r\n                                        mapping.obj.setValue(formData[i]);\r\n                                        self.setDisplayValueToControl(mapping.obj, dialog.form, i, formData);\r\n                                    }\r\n                                }\r\n\r\n                                self.searchDialog.currentSearchForm.performSearch({\r\n                                    allowFullSearch: properties.allowFullSearch,\r\n                                    maxRecords: properties.maxRecords\r\n                                });\r\n\r\n                                defer.resolve(data);\r\n                                dialog.closeDialogBox();\r\n                            }).fail(function (jqXHR, type, message) {\r\n                                if (type == \"parsererror\") {\r\n                                    defer.resolve({\r\n                                        type: \"error\",\r\n                                        message: message.message\r\n                                    });\r\n                                } else {\r\n                                    defer.reject(arguments);\r\n                                }\r\n                            });\r\n                        } else {\r\n                            // Form has not data\r\n                            bizagi.showMessageBox(self.getResource(\"render-search-advanced-no-filters\"), \"\", \"error\");\r\n                            defer.resolve();\r\n                        }\r\n\r\n                        return defer.promise();\r\n                    },\r\n                    close: function () {\r\n                        dialog.dialog('destroy');\r\n                        dialog.remove();\r\n                    }\r\n                });\r\n                dialog.render({\r\n                    idRender: properties.id,\r\n                    idPageCache: properties.idPageCache,\r\n                    requestedForm: \"addForm\",\r\n                    guidEntity: properties.entity,\r\n                    contextType: 'entity'\r\n                }).fail(function () {\r\n\r\n                });\r\n            }\r\n        };\r\n\r\n        return {buttons: buttons};\r\n    },\r\n\r\n    /**\r\n     * Set display value by control type, when add new record\r\n     * @param renderControlSearchForm\r\n     * @param addForm\r\n     * @param xpath\r\n     * @param formData\r\n     */\r\n    setDisplayValueToControl: function (renderControlSearchForm, addForm, xpath, formData) {\r\n        if (renderControlSearchForm.properties.type === \"searchSuggest\") {\r\n            renderControlSearchForm.setDisplayValue(addForm.getRender(xpath).getDisplayValue());\r\n        } else {\r\n            renderControlSearchForm.setDisplayValue(formData[xpath]);\r\n        }\r\n    },\r\n\r\n    /**\r\n     *   Opens the search dialog\r\n     * @returns {}\r\n     */\r\n    showSearchDialog: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var extraButtons;\r\n        var contextType = (properties.searchForms.length > 0 && properties.searchForms[0].type === \"searchForm\") ? \"metadata\" : \"entity\";\r\n\r\n        // Define add button\r\n        if (properties.allowNew) {\r\n            extraButtons = self.showAddRecordDialog();\r\n        }\r\n\r\n        // Show search dialog\r\n        self.searchDialog = new bizagi.rendering.dialog.search(self.dataService, self.renderFactory, properties.searchForms, {\r\n            allowFullSearch: properties.allowFullSearch,\r\n            maxRecords: properties.maxRecords,\r\n            orientation: properties.orientation || \"ltr\"\r\n        }, extraButtons);\r\n\r\n        self.searchDialog.render({\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            contexttype: contextType,\r\n            orientation: properties.orientation || \"ltr\"\r\n        }).done(function (item) {\r\n            // Set data\r\n            self.setValue(item);\r\n\r\n            self.readyActionExecution().done(function () {\r\n                var form = self.getFormContainer();\r\n\r\n                if (!self.properties.submitOnChange) {\r\n                    $.when(form.submitData()).done(function () {\r\n                        self.refreshControl();\r\n                    });\r\n                }\r\n            });\r\n\r\n        });\r\n    },\r\n\r\n    showAutocompleteLoading: function () {\r\n        $(\"i\", this.getControl()).addClass(\"ui-autocomplete-loading\");\r\n    },\r\n\r\n    hideAutocompleteLoading: function () {\r\n        $(\"i\", this.getControl()).removeClass(\"ui-autocomplete-loading\");\r\n    },\r\n\r\n    /**\r\n     * Cleans current data\r\n     * @returns {}\r\n     */\r\n    cleanData: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var value = {id: \"\"};\r\n\r\n        self.setDisplayValue(value);\r\n        self.setValue(value, false);\r\n\r\n        if (!self.properties.editable) {\r\n            $(control).html(\"<label class='readonly-control'></label>\");\r\n        }\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) == true && this.properties.editable) {\r\n                    control.addClass('control-required');\r\n                } else {\r\n                    control.removeClass('control-required');\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) == true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass('control-required');\r\n                } else {\r\n                    control.removeClass('control-required');\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n    \r\n    /**\r\n     * Get valid id of control\r\n     * @param value\r\n     * @returns {number}\r\n     */\r\n    getValueId: function (value) {\r\n        var currentId = value.id || \"\";\r\n\r\n        // Check if it's a virtual entity\r\n        if (bizagi.util.isString(currentId) && (/idEntity(.*)businessKey/ig.test(currentId))) return currentId;\r\n        return bizagi.util.isNumeric(currentId) ? currentId : value.value;\r\n    },\r\n\r\n    /**\r\n     * Check valid label of control\r\n     * @param value\r\n     */\r\n    getValueLabel: function(value) {\r\n        var displayValue = value.label;\r\n\r\n        if (!bizagi.util.isString(displayValue) && bizagi.util.isString(value.value)) {\r\n            displayValue = value.value;\r\n        }\r\n\r\n        return displayValue;\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop Render Letter Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the letter render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.letter\", bizagi.rendering.letter.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.letter.extend(\"bizagi.rendering.desktop.letter\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render\r\n     * after processed\r\n     */\r\n    postRender: function () {\r\n        var button = $(\":button\", this.getControl());\r\n\r\n        // Stylize button\r\n        button.button();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's\r\n     * behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var button = $(\":button\", self.getControl());\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Bind event\r\n        button.click(function () {\r\n            // Save the form prior opening the dialog\r\n            $.when(self.saveForm()).done(function () {\r\n                // Show letter dialog\r\n                self.showLetterDialog();\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     *  Method to render non editable values\r\n     */\r\n    postRenderReadOnly: function () {\r\n\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour\r\n     * to add handlers when the control is readonly\r\n     */\r\n    configureHandlersReadOnly: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var url = self.dataService.getLetterNotEditableUrl({\r\n            idRender: self.properties.id,\r\n            xpath: self.getXpath(),\r\n            xpathContext: self.getContextXpath(),\r\n            idPageCache: self.properties.idPageCache\r\n        });\r\n\r\n        // Bind click\r\n        $(\".ui-bizagi-render-letter-readonly\", control).click(function () {\r\n            // Save the form prior opening the link\r\n            $.when(self.saveForm()).done(function () {\r\n                $.when(self.getCanGenerateLetter())\r\n                    .done(function (wasGenerated) {\r\n                        // Save content in server\r\n                        if (wasGenerated && bizagi.util.parseBoolean(wasGenerated.canGenerate))\r\n                        // Open the url in a new window\r\n                            window.open(url);\r\n                        else {\r\n                            bizagi.showMessageBox(bizagi.localization.getResource(\"render-letter-not-generated\"));\r\n                        }\r\n                    });\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Shows letter dialog\r\n     */\r\n    showLetterDialog: function () {\r\n        var self = this;\r\n        var dialog = new bizagi.rendering.dialog.letter(self.dataService, self.renderFactory);\r\n\r\n        $.when(self.getCanGenerateLetter())\r\n            .done(function (wasGenerated) {\r\n                // Save content in server\r\n                if (wasGenerated && bizagi.util.parseBoolean(wasGenerated.canGenerate)) {\r\n                    $.when(self.getLetterContent())\r\n                        .pipe(function (content) {\r\n                            return dialog.render(content);\r\n                        }).done(function (newContent) {\r\n                        // Save content in server\r\n                        self.saveLetterContent(newContent);\r\n                    });\r\n                } else {\r\n                    bizagi.showMessageBox(bizagi.localization.getResource(\"render-letter-not-generated\"));\r\n                }\r\n            });\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop Render Button Extension\r\n *   Author: Bizagi UI Forms\r\n *   Comments:\r\n *   -   This script will redefine the button render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base \r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.button\", bizagi.rendering.render.base.prototype);\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.button.extend(\"bizagi.rendering.desktop.button\", bizagi.rendering.button.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.button.extend(\"bizagi.rendering.desktop.button\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     * @returns {}\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var button = $(\":button\", control);\r\n        var buttonInput = $(control.find(\"input\"));\r\n\r\n        // Stylize button\r\n        button.button();\r\n\r\n        buttonInput.addClass(\"ui-button--ellipsis\");\r\n        buttonInput.attr(\"title\", $(control.find(\"input\")).val());\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     * @returns {}\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var button = $(\":button\", self.getControl());\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Bind event\r\n        button.on(\"click\", function () {\r\n            //disable button to avoid multiple clicks\r\n            $(\"input\", self.element).attr(\"disabled\", true);\r\n\r\n            // Process button actions\r\n            self.processButton();\r\n\r\n            setTimeout(function () {\r\n                //allow button to be clickeable again\r\n                $(\"input\", self.element).removeAttr(\"disabled\");\r\n            }, 1500);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {}\r\n     */\r\n    postRenderReadOnly: function () {\r\n        // Execute the same as post-render\r\n        this.postRender();\r\n\r\n        // Set as disabled\r\n        var button = $(\":button\", this.getControl());\r\n        button.button(\"option\", \"disabled\", \"true\");\r\n    },\r\n\r\n    /**\r\n     * Process the button actions workflow\r\n     * @returns {}\r\n     */\r\n    processButton: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n\r\n        if (properties.editable) {\r\n\r\n            if (typeof (self.getFormContainer) != \"undefined\")\r\n\r\n                var form = self.getFormContainer();\r\n\r\n            if (bizagi.override.validateGridsOnButtonClick != false && mode == \"execution\" && form &&\r\n                !form.hasValidGrids([])) {\r\n                form.validationController.performValidations();\r\n            } else {\r\n                // Check if action need conformation\r\n                if (properties.needsUserConfirmation) {\r\n                    var htmlMessage = $(\"<div>\").append(properties.userConfirmationMessage);\r\n                    var defer = $.Deferred();\r\n\r\n                    $(htmlMessage).dialog({\r\n                        modal: true,\r\n                        width: 500,\r\n                        height: 250,\r\n                        draggable: false,\r\n                        resizable: true,\r\n                        maximize: false,\r\n                        title: properties.caption || properties.displayName,\r\n                        buttons: [{\r\n                            text: bizagi.localization.getResource(\"confirmation-box-ok\"),\r\n                            click: function () {\r\n                                defer.resolve();\r\n                                self.triggerRenderChange({pressed: true});\r\n                                $(this).dialog(\"close\");\r\n                            }\r\n                        }, {\r\n                            text: bizagi.localization.getResource(\"confirmation-box-cancel\"),\r\n                            click: function () {\r\n                                defer.reject();\r\n                                $(this).dialog(\"close\");\r\n                            }\r\n                        }]\r\n                    });\r\n\r\n                    if (!properties.preventDefault) {\r\n                        $.when(defer.promise()).done(function () {\r\n                            self.runButtonAction();\r\n                        });\r\n                    }\r\n                } else {\r\n                    if (!properties.preventDefault)\r\n                        self.runButtonAction();\r\n\r\n                    // Trigger change\r\n                    self.triggerRenderChange({pressed: true});\r\n                }\r\n            }\r\n        }\r\n    }\r\n});\r\n\r\n","/*\r\n *   Name: Bizagi Desktop Render fileprint Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the fileprint render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.fileprint\", bizagi.rendering.fileprint.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.fileprint.extend(\"bizagi.rendering.desktop.fileprint\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var button = $(\":button\", this.getControl());\r\n\r\n        // Stylize button\r\n        button.button();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var button = $(\":button\", self.getControl());\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        if(properties.filesCount > 0) {\r\n            // Bind event\r\n            button.click(function () {\r\n                // Process button actions\r\n                self.processButton();\r\n            });\r\n        } else {\r\n            button.button(\"option\", \"disabled\", \"true\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {}\r\n     */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var typeForm = form.properties.typeForm;\r\n\r\n        // Execute the same as post-render\r\n        this.postRender();\r\n\r\n        // Set as disabled\r\n        var button = $(\":button\", this.getControl());\r\n\r\n        if (typeForm == \"SummaryForm\" || typeForm == \"GlobalForm\") {\r\n            self.configureHandlers();\r\n        } else {\r\n            button.button(\"option\", \"disabled\", \"true\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Process the button actions workflow\r\n     */\r\n    processButton: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var typeForm = form.properties.typeForm;\r\n        \r\n        if (properties.editable || typeForm == \"SummaryForm\" || typeForm == \"GlobalForm\") {\r\n            self.runButtonAction();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * This url must be absolute, in portal and sharepoint not apply relative\r\n     * @param {} fileType\r\n     */\r\n    getAbsoluteFilePrintUrl: function (fileType) {\r\n        var time = (new Date()).getTime();\r\n        var filePrintUrl = this.getFilePrintUrl(fileType);\r\n\r\n        if (filePrintUrl.indexOf('http') != -1)\r\n            return filePrintUrl + \"&_=\" + time;\r\n\r\n        filePrintUrl = filePrintUrl.replace(bizagi.services.ajax.pathToBase, \"\");\r\n        filePrintUrl = bizagiConfig.proxyPrefix + filePrintUrl + \"&_=\" + time;\r\n\r\n        if (bizagi.getXSRFToken() != null)\r\n            filePrintUrl += \"&xsrf=\" + bizagi.getXSRFToken();\r\n\r\n        return filePrintUrl;\r\n    },\r\n\r\n    runButtonAction: function() {\r\n        var self = this;\r\n        self.getFormContainer().clearValidationMessages();\r\n\r\n        var control = self.getControl();\r\n        var fileObject = $(\".fileobj\");\r\n\r\n        if (bizagi.util.isIE() && !bizagi.util.isIE10() && !bizagi.util.isIE11()) {\r\n\r\n            var isAcrobatInstalled = self.checkAdobePlugin();\r\n\r\n            if (!isAcrobatInstalled) {\r\n                $.when(bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-acrobat-message\")))\r\n                    .done(function() {\r\n                        window.open(self.getAbsoluteFilePrintUrl(\"inline\"));\r\n                    });\r\n            } else {\r\n                var template = \"\";\r\n                var counter = 0;\r\n                var message = bizagi.localization.getResource(\"webpart-render-loading\");\r\n\r\n                fileObject.remove();\r\n                template = self.renderFactory.getTemplate(\"fileprint-object\");\r\n\r\n                control.append(\"<label id='loadingMsg'> \" + message + \"</label>\");\r\n                control.append($.tmpl(template, { url: self.getAbsoluteFilePrintUrl(\"inline\") }));\r\n\r\n                var mycounter = setInterval(function() {\r\n\r\n                    if (document.all[\"fileobj\"] && document.all[\"fileobj\"].readyState > 0) {\r\n\r\n                        $(\"#loadingMsg\").remove();\r\n                        $(\".fileobj:last\", control).focus();\r\n\r\n                        if (typeof ($(\".fileobj:last\", control)[0].print) != \"undefined\") {\r\n                            $(\".fileobj:last\", control)[0].print();\r\n                        } else {\r\n                            window.open(self.getAbsoluteFilePrintUrl(\"attachment\"));\r\n                        }\r\n\r\n                        window.clearInterval(mycounter);\r\n                    } else if (counter >= 10) {\r\n\r\n                        $(\"#loadingMsg\").remove();\r\n\r\n                        $.when(bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-print-too-slow\")))\r\n                            .done(function() {\r\n                                var wnd = window.open(self.getAbsoluteFilePrintUrl(\"inline\"));\r\n\r\n                                wnd.onload = function() {\r\n                                    if (typeof (wnd.print) != \"undefined\") {\r\n                                        wnd.print();\r\n                                        wnd.close();\r\n                                    } else {\r\n                                        window.open(self.getAbsoluteFilePrintUrl(\"attachment\"));\r\n                                    }\r\n                                };\r\n                            });\r\n\r\n                        self.saveForm();\r\n                        window.clearInterval(mycounter);\r\n                    }\r\n                    counter += 1;\r\n                }, 1000);\r\n            }\r\n        } else {\r\n\r\n            if ($.browser.mozilla) {\r\n                window.open(self.getAbsoluteFilePrintUrl(\"attachment\"));\r\n            } else {\r\n                // Remove previous iframe\r\n                $(\"iframe\", control).remove();\r\n\r\n                // Render new iframe\r\n                var idFrame = \"bz-render-fileprint-iframe-\" + new Date().getTime();\r\n                var tmpl = self.renderFactory.getTemplate(\"fileprint-iframe\");\r\n                var iframe = $.tmpl(tmpl, { url: self.getAbsoluteFilePrintUrl(\"inline\"), id: idFrame });\r\n\r\n                control.append(iframe);\r\n\r\n                // Print iframe\r\n                var frm = document.getElementById(idFrame).contentWindow;\r\n                if (typeof (frm.print) != \"undefined\" && !bizagi.util.isIE()) {\r\n                    frm.print();\r\n                } else {\r\n                    window.open(self.getAbsoluteFilePrintUrl(\"attachment\"));\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    checkAdobePlugin: function () {\r\n        var installed;\r\n\r\n        try {\r\n            installed = new ActiveXObject('AcroPDF.PDF');\r\n        } catch (e) {\r\n            bizagi.log(e);\r\n        }\r\n\r\n        if (!installed) {\r\n            try {\r\n                // Older IE\r\n                installed = new ActiveXObject('PDF.PdfCtrl');\r\n            } catch (e) {\r\n                bizagi.log(e);\r\n            }\r\n        }\r\n\r\n        return installed;\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop Render Link Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the link render class to adjust to desktop devices\r\n */\r\n\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.link\", bizagi.rendering.render.base.prototype);\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.link.extend(\"bizagi.rendering.desktop.link\", bizagi.rendering.link.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.link.extend(\"bizagi.rendering.desktop.link\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     * @returns {}\r\n     */\r\n    postRender: function () {\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     * @returns {}\r\n     */\r\n    configureHandlers: function () {\r\n        this.attachEvents()\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour\r\n     * to add handlers when the control is readonly\r\n     */\r\n    configureHandlersReadOnly: function () {\r\n        this.attachEvents();\r\n    },\r\n\r\n    /**\r\n     * Solve action to link\r\n     * @param args\r\n     */\r\n    linkSolver: function (args) {\r\n        args = args || {};\r\n        var self = this;\r\n        var url = args.url || \"\";\r\n        var target = args.target || \"_blank\";\r\n\r\n        if (bizagi.override.linkPrefix === true && url) {\r\n            if (url.indexOf(\"http\") === -1 && url.indexOf(\"\\\\\\\\\") === -1) {\r\n                url = \"//\" + bizagi.util.trim(url);\r\n            }\r\n        }\r\n\r\n        switch (args.linkType) {\r\n            case \"newwindow\":\r\n                var windowParamsPatter = \"width=%s,height=%s,resizable,scrollbars=yes,status=1,toolbar=yes\";\r\n                var windowParams = printf(windowParamsPatter, window.screen.width, window.screen.height);\r\n                self.windowObjReference = window.open(url, target, windowParams);\r\n                break;\r\n            case \"newtab\":\r\n                self.windowObjReference = window.open(url, target);\r\n                break;\r\n            default:\r\n                self.windowObjReference = window.open(url, target);\r\n                break;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {}\r\n     */\r\n    postRenderReadOnly: function () {\r\n        // Execute the same as post-render\r\n        this.postRender();\r\n    },\r\n\r\n    /**\r\n     * Configure event handlers\r\n     */\r\n    attachEvents: function (){\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var link = $(\".ui-bizagi-render-link\", control);\r\n\r\n        if (properties.value) {\r\n            // Modify href\r\n            link.attr(\"href\", properties.value);\r\n            link.attr(\"target\", \"_blank\");\r\n\r\n            link.click(function () {\r\n                //if the container form of this component is detail, executes the link\r\n                self.linkSolver({linkType: properties.linktarget, url: properties.value});\r\n                return false;\r\n            });\r\n        } else {\r\n            link.addClass(\"ui-state-disabled\");\r\n        }\r\n\r\n        \r\n        self.preventDefaultForAnchorTag();\r\n    },\r\n\r\n    processLayout: function (isLabelFormat) {\r\n        if(!isLabelFormat){\r\n             this._super(isLabelFormat, this.properties.textFormat);\r\n        } else {\r\n            if(typeof this.properties.textFormat.background !== \"undefined\"){\r\n                this._super(isLabelFormat, { background: this.properties.textFormat.background });\r\n            }\r\n        }\r\n    },\r\n\r\n    getElementsToStylize: function($context){\r\n        return $(\".ui-bizagi-render-link\", $context); \r\n    }\r\n});\r\n","/*\r\n*   Name: Bizagi Desktop Render Template Text Extension\r\n*   Author: Andres Fernando Munoz\r\n*   Comments:\r\n*   -   This script will redefine the layout render class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.layoutRender\", bizagi.rendering.layoutRender.prototype);","/*\r\n *   Name: BizAgi Render Layout Label Class\r\n *   Author: Mauricio Snchez\r\n *   Comments:\r\n *   -   This script will define basic stuff for labels inside templates\r\n */\r\n\r\nbizagi.rendering.desktop.layoutRender.extend(\"bizagi.rendering.desktop.layoutPlaceholder\", bizagi.rendering.layoutPlaceholder.prototype);\r\n","/*\r\n*   Name: BizAgi Render Layout Boolean Class\r\n*   Author: Alexander Mejia\r\n*   Comments:\r\n*   -   This script will define basic stuff for boolean renders inside templates\r\n*/\r\n\r\nbizagi.rendering.desktop.layoutRender.extend(\"bizagi.rendering.desktop.layoutBoolean\", bizagi.rendering.layoutBoolean.prototype);","/*\r\n*   Name: Bizagi render layout image\r\n*   Author: Andres Fernando Munoz\r\n*   Comments:\r\n*   -   This script will redefine the non editable image render class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from layoutRender desktop base\r\nbizagi.rendering.desktop.layoutRender.extend(\"bizagi.rendering.desktop.layoutImage\", bizagi.rendering.layoutImage.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.layoutImage.extend(\"bizagi.rendering.desktop.layoutImage\", {}, {\r\n    /**\r\n     * Gets the url to get the array image\r\n     */\r\n\r\n    postRender: function(){\r\n        \r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        if (self.value && typeof self.value.value !== \"undefined\" && self.value.value !== \"\" && self.value.value !== null) {\r\n            //Get image of customer in binary format\r\n            var url = self.getImageUri();\r\n            $.ajax({\r\n                url: url,\r\n                type: \"GET\",\r\n                dataType: \"binary\",\r\n                processData: false,\r\n                success: function (blob) {\r\n\r\n                    if (typeof blob == \"string\") {\r\n                        var xhr = arguments[2];\r\n                        var contentType = xhr.getResponseHeader('Content-type');\r\n                        blob = bizagi.util.byteArrayToBlob(bizagi.util.stringToByteArray(blob), contentType);\r\n                    }\r\n\r\n                    var urlCreator = window.URL || window.webkitURL;\r\n                    var imageUrl = urlCreator.createObjectURL(blob);\r\n\r\n                    $(control).find('img').attr(\"src\", imageUrl);\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    getImageUri: function () {\r\n        var self = this;\r\n\r\n        var templateControl = self.parent.parent;\r\n        var renderParams = templateControl.properties.paramsRender || {};\r\n\r\n        var map = {\r\n            entity: self.value.guid,\r\n            surrogateKey: self.value.surrogateKey,\r\n            xpath: self.properties.xpath,\r\n            width: 96,\r\n            height: 96,\r\n            hash: self.value.value,\r\n            idcase: renderParams.idRender ? bizagi.context.idCase : \"_\",\r\n            idworkitem: renderParams.idRender ? bizagi.context.idWorkitem : \"_\",\r\n            contextxpath: renderParams.idRender ? renderParams.xpathActions : \"_\"\r\n        };\r\n\r\n        return self.dataService.serviceLocator.getUrl(\"render-entity-layout-imageByteArray\").replaceMultiple(map);\r\n    }\r\n});","/**\r\n * Name: Bizagi Desktop Render Link Extension\r\n * Author: Andres Fernando Munoz\r\n * Comments:\r\n * -   This script will redefine the non editable link render class to adjust to desktop devices\r\n * -   This control is based on the link render control\r\n */\r\n\r\n// Extends from layoutRender desktop base\r\nbizagi.rendering.desktop.layoutRender.extend(\"bizagi.rendering.desktop.layoutLink\", bizagi.rendering.layoutLink.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.layoutLink.extend(\"bizagi.rendering.desktop.layoutLink\", {}, { \r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var element = self.element;\r\n\r\n        // Call base\r\n        self._super();\r\n        if (element) {\r\n            $(element).on('click', $.proxy(self.onClickElement, self));\r\n        }\r\n    },\r\n    /**\r\n     * When click over link\r\n     */\r\n    onClickElement: function () {\r\n        var self = this;\r\n        var properties = self.properties || {};\r\n        var args = {\r\n            displayName: properties.displayName,\r\n            reference: properties.reference,\r\n            referenceType: properties.referenceType,\r\n            xpath: properties.xpath,\r\n            contextEvent: self.getFormContainer().getContextEvent ? self.getFormContainer().getContextEvent() : ''\r\n        };\r\n        self.triggerGlobalHandler(\"DATA-NAVIGATION\", args);\r\n    }\r\n});\r\n","/*\r\n *   Name: Bizagi Desktop Render Template Label Extension\r\n *   Author: Mauricio Snchez\r\n *   Comments:\r\n *   -   This script will redefine the label render class inside templates to adjust to desktop devices\r\n */\r\n\r\n// Extends from layoutRender desktop base\r\nbizagi.rendering.desktop.layoutRender.extend(\"bizagi.rendering.desktop.layoutLabel\", bizagi.rendering.layoutLabel.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.layoutLabel.extend(\"bizagi.rendering.desktop.layoutLabel\", {}, { \r\n\r\n\tsetValue: function(val,triggerEvents) {\r\n\t\tvar self = this;\r\n\t\tself.properties.displayName = val;\r\n\t\tthis._super(val, triggerEvents);\r\n\t\tvar control = self.getControl();\r\n\t\tif(control) {\r\n\t\t\t$(\".ui-bizagi-render-label\", control).text(val);\r\n\t\t}\r\n\t}\r\n});\r\n","/*\r\n*   Name: Bizagi Desktop Render Template Text Extension\r\n*   Author: Mauricio Sanchez\r\n*   Comments:\r\n*   -   This script will redefine the text render class inside templates to adjust to desktop devices\r\n*/\r\n\r\n// Extends from layoutRender desktop base\r\nbizagi.rendering.desktop.layoutRender.extend(\"bizagi.rendering.desktop.layoutText\", bizagi.rendering.layoutText.prototype);","/*\r\n*   Name: Bizagi Desktop Render Template dateTime Extension\r\n*   Author: Andres Fernando Munoz\r\n*   Comments:\r\n*   -   This script will redefine the date time render class inside templates to adjust to desktop devices\r\n*/\r\n\r\n // Extends from layoutRender desktop base\r\n bizagi.rendering.desktop.layoutRender.extend(\"bizagi.rendering.desktop.layoutDateTime\", bizagi.rendering.layoutDateTime.prototype);","/**\r\n * Name: Bizagi Desktop Render Template number Extension\r\n * Author: Mauricio Sanchez\r\n * Comments:\r\n * - This script will redefine the number render class inside templates to adjust to desktop devices\r\n */\r\n\r\n// Extends from layoutRender desktop base\r\nbizagi.rendering.desktop.layoutRender.extend(\"bizagi.rendering.desktop.layoutNumber\", bizagi.rendering.layoutNumber.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.layoutNumber.extend(\"bizagi.rendering.desktop.layoutNumber\", {}, {  \r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     */\r\n    setValue: function(val, triggerEvents) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        if (self.getMode() === \"execution\") {\r\n            val = (val === null || val === \"\") ? \"\" : self.getDisplayValue(val);\r\n        }\r\n\r\n        self.properties.displayName = val;\r\n\r\n        this._super(val, triggerEvents);\r\n        if(control) {\r\n            $(\".ui-bizagi-render-number\", control).text(val);\r\n        }\r\n    }\r\n});","/**\r\n * Name: Bizagi Desktop Render Template Money Extension\r\n * Author: Andres Fernando Munoz\r\n * Comments:\r\n * - This script will redefine the money render class inside templates to adjust to desktop devices\r\n */\r\n\r\n// Extends from layoutRender desktop base\r\nbizagi.rendering.desktop.layoutRender.extend(\"bizagi.rendering.desktop.layoutMoney\", bizagi.rendering.layoutNumber.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.layoutMoney.extend(\"bizagi.rendering.desktop.layoutMoney\", bizagi.rendering.layoutMoney.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.layoutMoney.extend(\"bizagi.rendering.desktop.layoutMoney\", {}, {\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     */\r\n    setValue: function(val, triggerEvents) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        if (self.getMode() === \"execution\") {\r\n            val = (val === null || val === \"\") ? \"\" : self.getDisplayValue(val);\r\n        }\r\n        self.properties.displayName = val;\r\n\r\n        this._super(val, triggerEvents);\r\n        if(control) {\r\n            $(\".ui-bizagi-render-number\", control).text(val);\r\n        }\r\n    }\r\n});","/*\r\n *   Name: Bizagi Desktop Render Layout Upload\r\n *   Author: Bizagi\r\n *   Comments:\r\n *   -   This script will define the upload on entity template\r\n */\r\n\r\n // Extends from layoutRender desktop base\r\nbizagi.rendering.desktop.layoutRender.extend(\"bizagi.rendering.desktop.layoutUpload\", bizagi.rendering.layoutUpload.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.layoutUpload.extend(\"bizagi.rendering.desktop.layoutUpload\", {}, {\r\n\r\n    /**\r\n     *   Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this,\r\n            properties = self.properties,\r\n            defer = $.Deferred();\r\n        var mode = self.getMode();\r\n        if (mode === \"execution\")\r\n        {\r\n            $.when(self.getValueFilesByData(bizagi.clone(properties))).done(function(properties, valueResult){\r\n                self.properties = properties;\r\n                self.files = valueResult.files;\r\n                defer.resolve(self.getHTMLFiles(properties));\r\n            });\r\n        }\r\n        else{\r\n            self.files = [];\r\n            defer.resolve(self.getHTMLFiles());\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    getHTMLFiles: function(){\r\n        var self = this;\r\n        self.filesCount = self.files.length;\r\n\r\n        var template = self.renderFactory.getTemplate(\"layout-upload\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            xpath: bizagi.util.encodeXpath(self.getUploadXpath()),\r\n            noFiles: (self.filesCount == 0)\r\n        });\r\n\r\n        // Render current children\r\n        var items = \"\";\r\n        for (var i = 0; i < self.filesCount; i++) {\r\n            var file = { id: self.files[i][0], fileName: self.files[i][1] };\r\n            items += self.renderUploadItem(file);\r\n        }\r\n        html = self.replaceFilesHtml(html, items);\r\n        return html;\r\n    },\r\n\r\n\r\n    /**\r\n     *   Replaces a {{files}} tag in the container for the specified \"replace\" element\r\n     */\r\n    replaceFilesHtml: function (html, replace) {\r\n        return html.replace(\"{{files}}\", replace);\r\n    },\r\n\r\n    /**\r\n     *   Renders a single upload item\r\n     */\r\n    renderUploadItem: function (file) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n\r\n        var template = self.renderFactory.getTemplate(\"layout-uploadItem\");\r\n        var url = self.buildItemUrl(file);\r\n\r\n        // Don't render urls when not running in execution mode\r\n        if (mode != \"execution\")\r\n            url = \"javascript:void(0);\";\r\n\r\n        return $.fasttmpl(template, {\r\n            url: url,\r\n            allowDelete: properties.allowDelete,\r\n            filename: file.fileName,\r\n            id: file.id,\r\n            mode: mode,\r\n            editable: properties.editable\r\n        });\r\n    },\r\n\r\n    /**\r\n     *   Builds the upload item url\r\n     */\r\n    buildItemUrl: function (file) {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        var form = self.getFormContainer();\r\n\r\n        return self.dataService.getUploadFileEntityUrl({\r\n            isContextContainerWidgetRender: self.isContextContainerWidgetRender(),\r\n            xpath: self.getUploadXpath(),\r\n            fileId: file.id,\r\n            idRender: form.properties.paramsRender.idRender || \"undefined\",\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: form.properties.paramsRender.idPageCache || \"undefined\",\r\n            xpathActions: form.properties.paramsRender.xpathActions || \"undefined\",\r\n            sessionId: form.properties.sessionId,\r\n            surrogatekey: self.properties.value.surrogateKey,\r\n            guidentity: self.properties.value.guid\r\n        });\r\n    }\r\n});","/**\r\n *   Name: Bizagi Desktop Render Form Link Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the link render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.formLink\", {\r\n    BA_ACTION_PARAMETER_PREFIX: \"p_\",\r\n    BA_CONTEXT_PARAMETER_PREFIX: \"h_\",\r\n    BA_PAGE_CACHE: \"pageCacheId\"\r\n}, bizagi.rendering.formLink.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.formLink.extend(\"bizagi.rendering.desktop.formLink\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        this.attachEvents();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour\r\n     * to add handlers when the control is readonly\r\n     */\r\n    configureHandlersReadOnly: function () {\r\n        this.attachEvents();\r\n    },\r\n\r\n    openLinkRule: function (property, elLink) {\r\n        var self = this;\r\n        var def = new $.Deferred();\r\n\r\n        // Save form data\r\n        self.getPropertyValue(property, {})\r\n            .done(function (dataRuleResp) {\r\n                if (dataRuleResp.messages != null) {\r\n                    var message = dataRuleResp.messages[0];\r\n                    var form = self.getFormContainer();\r\n\r\n                    form.validationController.showErrorMessage(message);\r\n                    def.reject();\r\n                } else {\r\n                    if (property === \"entryrule\")\r\n                        self.openLink(elLink);\r\n                }\r\n                def.resolve();\r\n            }).fail(function (error) {\r\n            def.reject();\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    getPropertyValue: function (propertyName, params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n\r\n        self.dataService.multiaction().getPropertyData({\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            property: propertyName,\r\n            extra: params,\r\n            dataType: params ? params.dataType : null\r\n        }).done(function (data) {\r\n            if (data.type === \"error\") {\r\n                // Workflow engine error, we gotta show it with error\r\n                self.getFormContainer().addErrorMessage(data.message);\r\n                defer.reject(data);\r\n            } else {\r\n                defer.resolve(data);\r\n            }\r\n        }).fail(function (jqXHR, textStatus, errorThrown) {\r\n            self.getFormContainer().addErrorMessage(jqXHR.message);\r\n            defer.reject(jqXHR, textStatus, errorThrown);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     */\r\n    postRenderReadOnly: function () {\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * Submits a link save request for the displayed form\r\n     * @param data\r\n     * @param defClose\r\n     * @returns {*} Returns a deferred\r\n     */\r\n    submitSaveRequest: function (data, defClose) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Don't send request when the link is not editable\r\n        if (!properties.editable && !properties.value)\r\n            return null;\r\n\r\n        var xpath = self.getFormLinkXpath();\r\n        var xpathContext = xpath;\r\n\r\n        if (typeof (properties.xpathContext) !== \"undefined\" && properties.xpathContext !== \"\") {\r\n            xpathContext = xpath ? properties.xpathContext + \".\" + xpath : properties.xpathContext;\r\n        }\r\n\r\n        return self.dataService.saveLinkForm({\r\n            url: properties.saveUrl,\r\n            idRender: properties.id,\r\n            xpathContext: xpathContext,\r\n            submitData: data\r\n        });\r\n    },\r\n\r\n    getDisplayAsReadOnlyValue: function () {\r\n        var self = this;\r\n        return self.getFormContainer() && self.getFormContainer().properties.displayAsReadOnly;\r\n    },\r\n\r\n    closeExitRule: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var def = new $.Deferred();\r\n\r\n        if (properties.hasexitrule && !self.getDisplayAsReadOnlyValue()) {\r\n            $.when(self.openLinkRule(\"exitrule\")).done(function (result) {\r\n                def.resolve(result);\r\n            }).fail(function () {\r\n                def.reject();\r\n            });\r\n        } else {\r\n            def.resolve();\r\n        }\r\n\r\n        return def.promise();\r\n    },\r\n    /**\r\n     * Opens the link display form inside a dialog\r\n     * @param elLink\r\n     */\r\n    openLink: function (elLink) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n\r\n        if (typeof (properties.canBeSaved) == \"undefined\") {\r\n            properties.canBeSaved = true;\r\n        }\r\n\r\n        // When the link is not editable, then the form can't have save button\r\n        if (properties.editable === false) {\r\n            properties.canBeSaved = false;\r\n        }\r\n\r\n        if (form.properties.displayAsReadOnly) {\r\n            properties.canBeSaved = false;\r\n        }\r\n\r\n        $.when(self.getFormContainer().properties.editable ? form.submitData() : undefined).done(function () {\r\n            // Send edit request\r\n            $.when(self.submitEditRequest()).done(function () {\r\n                elLink.prop(\"disabled\", false);\r\n\r\n                // Show dialog with new form after that\r\n                self.dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n                    showSaveButton: properties.canBeSaved,\r\n                    maximized: properties.maximized,\r\n                    title: properties.displayName,\r\n                    orientation: properties.orientation || \"ltr\",\r\n                    onSave: function (data) {\r\n                        var def = new $.Deferred();\r\n\r\n                        var deferredsToWait = null;\r\n                        if (data && data.deferreds) {\r\n                            deferredsToWait = $.when.apply($, data.deferreds);\r\n                            delete data.deferreds;\r\n                        }\r\n\r\n                        $.when(deferredsToWait).then(function () {\r\n\r\n                            self.submitSaveRequest(data, def.promise()).done(function (result) {\r\n                                var executeSubmitOnChange = true;\r\n                                if (result && result.type === \"validationMessages\") {\r\n                                    executeSubmitOnChange = false;\r\n                                    def.resolve(result);\r\n                                }\r\n                                if (properties.hasexitrule) {\r\n                                    self.closeExitRule().done(function () {\r\n                                        if (executeSubmitOnChange) {\r\n                                            $.when(self.submitCommitRequest(), self.submitDataRequest()).done(function () {\r\n                                                var defer = null;\r\n                                                if (properties.hasentryrule) {\r\n                                                    defer = self.submitCommitRequest();\r\n                                                }\r\n                                                $.when(defer).done(function () {\r\n                                                    form.refreshForm();\r\n                                                });\r\n                                            });\r\n                                            def.resolve(result);\r\n                                        }\r\n                                    }).fail(function () {\r\n                                        def.reject();\r\n                                    });\r\n                                } else if (executeSubmitOnChange) {\r\n                                    if (executeSubmitOnChange) {\r\n                                        def.resolve(result);\r\n                                        self.submitCommitRequest().done(function(){\r\n                                            self.submitDataRequest().done(function () {\r\n                                                form.refreshForm();\r\n                                            });\r\n                                        });\r\n\r\n                                        if (properties.hasentryrule)\r\n                                            self.submitCommitRequest();\r\n                                    }\r\n                                }\r\n                            });\r\n\r\n                        });\r\n\r\n                        return def.promise();\r\n                    },\r\n                    close: function () {\r\n                    }\r\n                });\r\n\r\n                self.renderFormLinkDialog();\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Render Dialog\r\n     */\r\n    renderFormLinkDialog: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        // DiegoP: Commented the following lines because it was generating a side effect bug, and it was only intended for plans\r\n        // The idea is that when we use plans, it opens a form link (of the parent activity), and the whole page must be optional (without required fields)\r\n        // but now  when the there is a formlink inside the parent form; it's opening the target form  but the required fields are still required\r\n        // var required = bizagi.util.parseBoolean(properties.required) !== null ? bizagi.util.parseBoolean(properties.required) : true;\r\n\r\n        self.dialog.render({\r\n            idRender: properties.id,\r\n            xpathContext: self.getFormLinkXpathContext(),\r\n            idPageCache: properties.idPageCache,\r\n            recordXPath: self.getFormLinkXpath(),\r\n            requestedForm: \"linkform\",\r\n            editable: properties.editable,\r\n            //required: required,\r\n            url: properties.editPage,\r\n            mainForm: self.getFormContainer ? self.getFormContainer() : null\r\n        }).fail(function (data) {\r\n            // Sends a rollback request to delete checkpoints\r\n            $.when(self.submitRollbackRequest(data)).done(function () {\r\n                //Sends additional rollback request to delete checkpoint from entry rule\r\n                if (properties.hasentryrule){\r\n                    $.when(self.submitRollbackRequest(data)).done(function () {\r\n                        self.submitInvalidatePageCacheRequest(data);\r\n                    });\r\n                }\r\n                else{\r\n                    self.submitInvalidatePageCacheRequest(data);\r\n                }\r\n            });\r\n        });\r\n    },\r\n\r\n    getFormLinkXpathContext: function () {\r\n        var self = this;\r\n        var xpathContext = self.properties.xpathContext;\r\n        var parentXpathContext = self.getXpathContext();\r\n\r\n        if (parentXpathContext && xpathContext) {\r\n            if (xpathContext.indexOf(parentXpathContext) === 0) {\r\n                return xpathContext;\r\n            } else {\r\n                return parentXpathContext + \".\" + xpathContext;\r\n            }\r\n        } else {\r\n            return xpathContext;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Configure event handlers\r\n     */\r\n    attachEvents: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var link = $(\".ui-bizagi-render-link\", control);\r\n        var properties = self.properties;\r\n\r\n        // Define dialog\r\n        self.dialog = null;\r\n\r\n        // Bind click event\r\n        link.click(function () {\r\n            // Open the link inside a dialog\r\n            var elLink = $(this);\r\n            if (properties.hasentryrule && !self.getDisplayAsReadOnlyValue()) {\r\n                var form = self.getFormContainer();\r\n                elLink.prop(\"disabled\", true);\r\n\r\n                $.when(form.submitData()).done(function () {\r\n                    self.submitCheckpointRequest();\r\n                    self.openLinkRule(\"entryrule\", elLink);\r\n                });\r\n            } else {\r\n                elLink.prop(\"disabled\", true);\r\n                self.openLink(elLink);\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Customizes render color\r\n     * @param color\r\n     */\r\n    changeColor: function (color) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var label = self.getLabel();\r\n\r\n        if (control && label) {\r\n            if (color !== \"none\") {\r\n                self.getControl().find(\"a\").css(\"color\", color, \"!important\");\r\n\r\n                if (typeof (self.getControl().find(\"a\").style) == \"function\") {\r\n                    self.getControl().find(\"a\").style(\"color\", color, \"!important\");\r\n                }\r\n            } else {\r\n                self.getControl().find(\"a\").css(\"color\", \"\");\r\n\r\n                if (typeof (self.getControl().find(\"a\").style) == \"function\") {\r\n                    self.getControl().find(\"a\").style(\"color\", \"\");\r\n                }\r\n            }\r\n        }\r\n        self._super(color);\r\n    },\r\n    \r\n    changeFontBold: function (){\r\n        var self = this;\r\n        var control = self.getControl().children();\r\n        var textFormat = self.properties.textFormat;\r\n        if(typeof textFormat.bold !== \"undefined\"){\r\n            if (typeof control == \"object\" && control.length > 0) {\r\n                self.getElementsToStylize(control).css(\"font-weight\", \"bold\", \"!important\");\r\n            }    \r\n        }\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Render Geolocation control\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for form link renders\r\n */\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.geolocation\", bizagi.rendering.geolocation.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.geolocation.extend(\"bizagi.rendering.desktop.geolocation\", {}, {\r\n\r\n    /**\r\n     * Method to customize each render after processed in read-only mode\r\n     */\r\n    renderReadOnly: function () {\r\n        return this.renderControl();\r\n    },\r\n\r\n    postRenderReadOnly: function () {\r\n        this.postRender();\r\n    },\r\n\r\n    postRender: function () {\r\n        // Call base\r\n        this._super();\r\n\r\n        this.cordinate = $(\".ui-geolocation-cordinate\", this.getControl());\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        if (self.isExecutionMode()) {\r\n            var control = self.getControl();\r\n\r\n            // If the control doesn't have a value set the position\r\n            if (self.value == null) {\r\n                self.setDisplayValue().then(function () {\r\n                }).fail(function (msg) {\r\n                    self.cordinate.html(\"<span style='color: red'>\" + msg + \"</span>\");\r\n                });\r\n            }\r\n\r\n            $(\".ui-bizagi-render-geolocation\", control).bind(\"click\", function () {\r\n                self.cordinate.empty();\r\n                // This retun a promise if is usefull\r\n                self.setDisplayValue().then(function () {\r\n                }).fail(function (msg) {\r\n                    self.cordinate.html(\"<span style='color: red'>\" + msg + \"</span>\");\r\n                });\r\n            });\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     * @returns {*}\r\n     */\r\n\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var input = control.find(\"span\");\r\n\r\n        if (input.length > 0) {\r\n            input.val(\"\");\r\n        }\r\n    },\r\n\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var def = new $.Deferred();\r\n\r\n        if (value != null && value !== \"\") {\r\n            self.cordinate.html(self.performPrecision(value));\r\n\r\n            // Set internal value\r\n            self.setValue(value, false);\r\n            def.resolve();\r\n        } else {\r\n\r\n            var onSuccess = function (position) {\r\n                var coordinate = position.coords.latitude + \" \" + position.coords.longitude;\r\n\r\n                self.cordinate.html(self.performPrecision(coordinate));\r\n\r\n                // Set internal value\r\n                self.setValue(coordinate, false);\r\n                def.resolve();\r\n            };\r\n\r\n            // onError Callback receives a PositionError object\r\n            var onError = function (msg) {\r\n                self.cordinate.html(self.properties.value);\r\n                def.reject(msg);\r\n            };\r\n\r\n            self.getCurrentPosition(onSuccess, onError);\r\n        }\r\n\r\n        return def.promise();\r\n    }\r\n\r\n});","/**\r\n  *   Name: Bizagi Desktop Render HIdden Extension\r\n  *   Author: UI Forms Team\r\n  *   Comments:\r\n  *   -   This script will redefine the hidden render class to adjust to desktop devices\r\n  */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.hidden\", bizagi.rendering.hidden.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.hidden.extend(\"bizagi.rendering.desktop.hidden\", {}, {\r\n\r\n});","/*\r\n*   Name: Bizagi Desktop Render Money Extension\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will redefine the money render class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.money\", bizagi.rendering.number.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.money.extend(\"bizagi.rendering.desktop.money\", bizagi.rendering.money.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.money.extend(\"bizagi.rendering.desktop.money\", {}, {\r\n\r\n    /*\r\n    *   Sets the value in the rendered control\r\n    */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        this._super(value);\r\n\r\n        // Set value in input\r\n        if (value !== undefined && value !== null && properties.editable) {\r\n            self.numericInput.val(value);\r\n\r\n            // Formats the input\r\n            self.executeFormatCurrencyPlugin();\r\n        }\r\n    },\r\n\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) === true && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) === true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop Render Query Money Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the query money render class to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.money.extend(\"bizagi.rendering.desktop.queryMoney\", {}, {\r\n\r\n    /*\r\n   *   Adds the format currency plugin\r\n   */\r\n    attachFormatCurrency: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        if (properties.showSymbol) {\r\n            if (properties.symbol == '') {\r\n                if (typeof (bizagi) != \"undefined\")\r\n                    if (properties.dataType == 8 && typeof (bizagi.currentUser) != \"undefined\") {\r\n                        if (typeof (bizagi.currentUser.symbol) != \"undefined\") properties.symbol = bizagi.currentUser.symbol;\r\n                    }\r\n            }\r\n        }\r\n\r\n        // Call base\r\n        this._super();\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop Render list Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the list render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.radio\", bizagi.rendering.combo.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.radio.extend(\"bizagi.rendering.desktop.radio\", bizagi.rendering.radio.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.radio.extend(\"bizagi.rendering.desktop.radio\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Call base \r\n        self._super();\r\n\r\n        // Set control container to behave as a block\r\n        control.addClass(\"ui-bizagi-render-display-block\");\r\n        control.addClass(\"ui-bizagi-render-boolean-yesno\");\r\n\r\n        self.properties.unique = Math.ceil(Math.random() * 1000);\r\n\r\n\r\n        // Apply plugin\r\n        self.radiogroup = $(\".ui-bizagi-render-radio\", control);\r\n        self.radiogroup.optiongroup({orientation: self.properties.orientation});\r\n        if (self.selectedValue) {\r\n            self.radiogroup.optiongroup(\"setValue\", self.selectedValue);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Bind handler\r\n        self.radiogroup.bind(\"optiongroupchange\", function (event, ui) {\r\n            // Updates internal value\r\n            self.onOptionGroupChange(ui);\r\n        });\r\n    },\r\n\r\n    onOptionGroupChange: function (ui) {\r\n        var self = this;\r\n        var newValue = {id: ui.value, value: ui.text};\r\n        self.selectedValue = newValue.value;\r\n        self.setValue(newValue);\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour when rendering in design mode\r\n     */\r\n    configureDesignView: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Unbind plugin handlers\r\n        control.find(\"input\").unbind(\"click\");\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (properties.editable) {\r\n            if (value !== undefined && value.id != \"\") {\r\n                self.radiogroup.optiongroup(\"setValue\", value.id || value.value);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     */\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        if (self.radiogroup) {\r\n            if ($.data(self.radiogroup[0])['ui-optiongroup']) {\r\n                self.radiogroup.optiongroup(\"setValue\", 0);\r\n            } else {\r\n                $(control).html(\"<label class='readonly-control'></label>\");\r\n            }\r\n        } else if (!self.properties.editable) {\r\n            $(control).html(\"<label class='readonly-control'></label>\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Returns the selected value in the template\r\n     * @returns {*}\r\n     */\r\n    getSelectedValue: function () {\r\n        var self = this;\r\n        return self.selectedValue;\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: BizAgi Desktop Render Query Radio Extension\r\n *   Author: Paola Herrera\r\n *   Comments:\r\n *   -   This script will redefine the query list render class to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.radio.extend(\"bizagi.rendering.desktop.queryRadio\", {}, {\r\n    /*\r\n     *   Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Call base\r\n        this._super();\r\n\r\n        // Remove yesno class\r\n        control.removeClass(\"ui-bizagi-render-boolean-yesno\");\r\n    }\r\n});\r\n\r\n","/*\r\n* *   Name: BizAgi Desktop Render Query State Extension\r\n*   Author: Paola Herrera\r\n*   Comments:\r\n*   -   This script will redefine the query list render class to adjust to desktop devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.radio.extend(\"bizagi.rendering.desktop.queryState\", {}, {\r\n\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        var horizontal =(typeof data.properties.horizontal !== \"undefined\") ? bizagi.util.parseBoolean(data.properties.horizontal) : true;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.horizontal =horizontal;\r\n        if(typeof properties.defaultValue == \"undefined\" && properties.value === null ){\r\n            self.setValue({ id: \"0\" }, false);\r\n        }\r\n    },\r\n    /*\r\n     *   Returns the internal value\r\n     */\r\n    getValue: function () {\r\n        if(this.value && this.value.id && !isNaN(this.value.id)){\r\n            return {id: parseInt(this.value.id),value:this.value.value};\r\n        }else{\r\n            return this.value;\r\n        }\r\n    },\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function (value) {\r\n        value.id= value.id+\"\";\r\n        this._super(value);\r\n    }\r\n\r\n});\r\n\r\n","/*\r\n* *   Name: BizAgi Desktop Render Query Case State Extension\r\n*   Author: Ivn Ricardo Taimal Narvez\r\n*   Comments:\r\n*   -   This script will redefine the query list render class to adjust to desktop devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.radio.extend(\"bizagi.rendering.desktop.queryCaseState\", {}, {\r\n\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        var horizontal =(typeof data.properties.horizontal !== \"undefined\") ? bizagi.util.parseBoolean(data.properties.horizontal) : true;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.horizontal =horizontal;\r\n        if(typeof properties.defaultValue == \"undefined\" && properties.value === null ){\r\n            self.setValue({ id: \"0\" }, false);\r\n        }\r\n    },\r\n    /*\r\n     *   Returns the internal value\r\n     */\r\n    getValue: function () {\r\n        if(this.value && this.value.id && !isNaN(this.value.id)){\r\n            return {id: parseInt(this.value.id),value:this.value.value};\r\n        }else{\r\n            return this.value;\r\n        }\r\n    },\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function (value) {\r\n        value.id= value.id+\"\";\r\n        this._super(value);\r\n    }\r\n});\r\n\r\n","/*\r\n *   Name: BizAgi Desktop Render queryGrid Extension\r\n *   Author: Ivn Ricardo Taimal Narvez\r\n *   Comments:\r\n *   -   This script will redefine the queryGrid render class to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.panel.extend(\"bizagi.rendering.desktop.queryGrid\", {}, {\r\n\r\n    /*\r\n     *   Update or init the element data,  concat children xpath\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        console.log('sucede initializeData queryGrid');\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Set defaults\r\n        var properties = self.properties;\r\n        properties.uniqueId = Math.ceil(Math.random() * 1000000);\r\n        properties.editable = (typeof properties.editable != \"undefined\") ? bizagi.util.parseBoolean(properties.editable) : true;\r\n        properties.visible = (typeof properties.visible != \"undefined\") ? bizagi.util.parseBoolean(properties.visible) : true;\r\n\r\n        // Override orientation from parent if not set\r\n        properties.orientation = properties.orientation || (self.parent ? self.parent.properties.orientation : \"ltr\");\r\n\r\n        // Save original properties\r\n        this.originalProperties = JSON.parse(JSON.encode(properties));\r\n\r\n        // Create children\r\n        this.children = [];\r\n        this.childrenHash = {};\r\n        if (data.elements) {\r\n            $.each(data.elements, function (i, element) {\r\n                element.render.properties.xpath= self.properties.xpath+\".\"+element.render.properties.xpath;\r\n                if (element.render) {\r\n                    self.createRenderElement(element);\r\n                }\r\n                else if (element.container) {\r\n                    self.createContainerElement(element);\r\n                }\r\n                else if (element.form) {\r\n                    self.createFormElement(element);\r\n                }\r\n            });\r\n        }\r\n    }\r\n});\r\n","/*  \r\n*   Name: Bizagi Desktop Render list Extension\r\n*   Author: Bizagi UI Forms\r\n*   Comments:\r\n*   -   This script will redefine the list render class to adjust to desktop devices\r\n*/\r\n\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.list\", bizagi.rendering.render.base.prototype);\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.list.extend(\"bizagi.rendering.desktop.list\", bizagi.rendering.combo.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.list.extend(\"bizagi.rendering.desktop.list\", bizagi.rendering.list.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.list.extend(\"bizagi.rendering.desktop.list\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     * @returns {} \r\n     */\r\n    postRender: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n\r\n        // Call base \r\n        self._super();\r\n\r\n        // Set control container to behave as a block\r\n        control.addClass(\"ui-bizagi-render-display-block\");\r\n        control.addClass(\"ui-bizagi-render-boolean-yesno\");\r\n\r\n        // Apply plugin\r\n        self.list = $(\".ui-bizagi-render-list\", control);\r\n\r\n        self.list.selectable2({\r\n            closest: false,\r\n            multiple: false,\r\n            select: function(e, ui) {\r\n\r\n                if (e.isPropagationStopped()) return;\r\n\r\n                var selected = $(\"li[tabindex='0']\", this);\r\n                var value = $(selected).data(\"value\");\r\n                var label = $(selected).text();\r\n\r\n                // Updates internal value\r\n                var newValue = { id: value, value: label };\r\n                self.setValue(newValue);\r\n                self.selectedValue = newValue.value;\r\n                self.focusSelectedItem(selected);\r\n\r\n                e.stopPropagation();\r\n            }\r\n        });\r\n\r\n        // Apply list size\r\n        if (properties.listSize > 0) {\r\n            var listSize = Number(properties.listSize) * 23;\r\n            self.list.height(listSize + \"px\");\r\n        }\r\n    },\r\n\r\n    focusSelectedItem: function(elList) {\r\n        var self = this;\r\n\r\n        $.when(self.ready()).done(function() {\r\n            elList.focus(0);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour\r\n     * to add handlers     \r\n     * @returns {} \r\n     */\r\n    configureHandlers: function() {        \r\n        // Call base\r\n        this._super();        \r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour\r\n     * when rendering in design mode\r\n     * @returns {} \r\n     */\r\n    configureDesignView: function() {\r\n        var self = this;        \r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Un-bind selection handlers\r\n        if (self.properties.editable) {\r\n            self.list.unbind(\"mousedown.selectable\");\r\n            self.list.unbind(\"focus.selectable\");\r\n            self.list.unbind(\"blur.selectable\");\r\n            self.list.unbind(\"keydown.selectable\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param {} value \r\n     * @returns {} \r\n     */\r\n    setDisplayValue: function(value) {\r\n        var self = this;\r\n        value = this.mapValue(value);\r\n\r\n        if (self.properties.editable) {\r\n            if (value !== undefined && value.id !== \"\") {\r\n                self.list.selectable2(\"select\", \"[id='ui-bizagi-list-\" + value.id + \"']\");\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @returns {} \r\n     */\r\n    clearDisplayValue: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var selected = control.find(\".ui-state-active\");\r\n\r\n        if (selected.length > 0) {\r\n            // Updates internal value\r\n            var newValue = self.getValue();\r\n\r\n            self.selectedValue = newValue.value;\r\n            selected.removeClass(\"ui-state-focus ui-selected ui-state-active\");\r\n        } else if (!self.properties.editable) {\r\n            $(control).html(\"<label class='readonly-control'></label>\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Returns the selected value in the template\r\n     * @returns {} \r\n     */\r\n    getSelectedValue: function() {        \r\n        return this.selectedValue;\r\n    },\r\n\r\n    /**\r\n     * Cleans current data\r\n     * @returns {} \r\n     */\r\n    cleanData: function() {\r\n        var self = this;\r\n        self.value = self.properties.value = self.selectedValue = { id: \"\", value: \"\" };\r\n        self.clearDisplayValue();\r\n    },\r\n\r\n    getLabel: function(){\r\n        return $(\"label\", this._super());\r\n    },\r\n\r\n    getElementsToStylize: function($context){\r\n        return $(\"ul li\", $context);\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop Render MultiSelect Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the multiSelect render class to adjust to desktop devices\r\n */\r\n\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.multiSelect\", bizagi.rendering.render.base.prototype);\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.multiSelect.extend(\"bizagi.rendering.desktop.multiSelect\", bizagi.rendering.multiSelect.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.multiSelect.extend(\"bizagi.rendering.desktop.multiSelect\", {\r\n    MORE_OPTION_WIDTH: 40\r\n}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        this.isNewRenderForm = true;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var $control = this.getControl();\r\n        this.multiSelect = $(\".bz-multiselect\", $control);\r\n\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * Returns the html templated element\r\n     * @returns {*}\r\n     */\r\n    renderElement: function () {\r\n        return this._super(\"render-base\");\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        var $control = this.getControl();\r\n        this.multiSelect = $(\".bz-multiselect\", $control);\r\n\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n\r\n        // Set internal value\r\n        self._super(value);\r\n\r\n        setTimeout(function () {\r\n            self.addSelectedElements();\r\n        }, 100);\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var $control = self.getControl();\r\n\r\n        $(\".bz-multiselect\", $control)\r\n            .on(\"click, mousedown.multiselect\", function(evt){\r\n                if($(evt.target).hasClass(\"bz-multiselect__tags\") || $(evt.target).hasClass(\"bz-multiselect__arrow\")){\r\n                    self.onToggleDataView(evt)\r\n                }\r\n            });\r\n        \r\n        $('ul.bz-multiselect__tags', $control)\r\n            .on(\"click\", \"li div.bz-btn-icn\", this.onUnselectElement.bind(this))\r\n            .on(\"click\", \"li.bz-multiselect__plus\", this.onShowSelectedElements.bind(this));\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers when the control is readonly\r\n     */\r\n    configureHandlersReadOnly: function () {\r\n        var $control = this.getControl();\r\n\r\n        $('ul.bz-multiselect__tags', $control)\r\n            .on(\"click\", \"li.bz-multiselect__plus\", this.onShowSelectedElements.bind(this));\r\n    },\r\n\r\n    /**\r\n     * addSelectedElements\r\n     */\r\n    addSelectedElements: function () {\r\n        var self = this;\r\n        var $control = this.getControl();\r\n        var values = this.getDataValue() || [];\r\n        var totalValues = values.length;\r\n        var $tagsContainer = $('ul.bz-multiselect__tags', $control);\r\n        var editable = this.properties.editable;\r\n        var template = this.renderFactory.getTemplate(\"list-multiselect-tag\");\r\n\r\n        $tagsContainer.empty();\r\n\r\n        if (totalValues > 0) {\r\n\r\n            if (this.getFormContainer().params.printversion) {\r\n                $control.html(values.map(function (el) {\r\n                    return self.formatItem(el.value);\r\n                }).join(\", \"));\r\n            } else {\r\n\r\n                for (var i = 0; i < totalValues; i++) {\r\n                    var item = values[i];\r\n                    var data = {id: item.id, value: item.value, editable: editable};\r\n                    var $ChildToAdd = $.tmpl(template, data, {\r\n                        formatItem: self.formatItem\r\n                    });\r\n\r\n                    $tagsContainer.append($ChildToAdd);\r\n\r\n                    // Process the control in the layout\r\n                    this.processControlLayout(this.properties.valueFormat || {});\r\n\r\n                    if (!this.canAddMoreItems($tagsContainer)) {\r\n                        // Remove last item added\r\n                        $tagsContainer\r\n                            .children()\r\n                            .last()\r\n                            .remove();\r\n\r\n                        // Add the view mode item\r\n                        var $viewMore = $.tmpl(this.renderFactory.getTemplate(\"list-multiselect-view-more\"), {\r\n                            value: totalValues - i,\r\n                            index: i\r\n                        });\r\n\r\n                        $tagsContainer.append($viewMore);\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n     * Get data and render the float list view\r\n     */\r\n    renderFloatView: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"list-multiselect-item\");\r\n\r\n        self.updateArrow();\r\n\r\n        $.when(self.getData()).done(function (data) {\r\n            try {\r\n                var params = {datasource: data};\r\n                var options = {\r\n                    selected: self.getDataValue(),\r\n                    isChecked: function (id) {\r\n                        return self.markAsChecked.call(this, id);\r\n                    },\r\n                    formatItem: self.formatItem\r\n                };\r\n\r\n                var $floatList = self.showFloatListView(template, params, options);\r\n                self.floatListHandlers($floatList);\r\n\r\n            } catch (e) {\r\n                bizagi.log(e.message);\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Show float list view\r\n     * @param template\r\n     * @param data\r\n     * @param options\r\n     */\r\n    showFloatListView: function (template, data, options) {\r\n        var self = this;\r\n        var $control = self.getControl();\r\n        var $containerControl = $control.closest(\".ui-bizagi-control-wrapper\");\r\n        var $containerRender = $containerControl.closest(\".bz-form-old-item\");\r\n\r\n        var $floatList = $.tmpl(template, data, options);\r\n        var widthControl = self.multiSelect.width();\r\n\r\n        $containerRender.addClass(\"bz-multiselect__visible\");\r\n        $containerControl.addClass(\"bz-multiselect__visible bz-multiselect__floats\");\r\n        $containerControl.append($floatList);\r\n\r\n        $floatList.width(widthControl);\r\n\r\n        $floatList.position({\r\n            my: \"left top\",\r\n            at: \"left bottom\",\r\n            of: self.multiSelect,\r\n            collision: \"fit\"\r\n        }).hide();\r\n\r\n        // Display view\r\n        $floatList.show();\r\n\r\n        // Stop bubbling outside the dropdown\r\n        $floatList.on(\"mousedown\", function (ev) {\r\n            ev.preventDefault();\r\n            return false;\r\n        });\r\n\r\n        // Add global handler to close the float view\r\n        setTimeout(function(){\r\n            $(document).one(\"mousedown.multiselect\", function (evt) {\r\n                $floatList.trigger('closeView');\r\n            });\r\n        }, 0);\r\n\r\n        return $floatList;\r\n    },\r\n\r\n    /**\r\n     * Destroy the float list view\r\n     * @param $list\r\n     */\r\n    destroyFloatView: function ($list) {\r\n        var $control = this.getControl();\r\n        var $containerControl = $control.closest(\".ui-bizagi-control-wrapper\");\r\n        var $containerRender = $containerControl.closest(\".bz-form-old-item\");\r\n\r\n        if ($containerControl.hasClass(\"bz-multiselect__visible\"))\r\n            $containerControl.removeClass(\"bz-multiselect__visible\");\r\n\r\n        if ($containerControl.hasClass(\"bz-multiselect__floats\"))\r\n            $containerControl.removeClass(\"bz-multiselect__floats\");\r\n\r\n        if ($containerRender.hasClass(\"bz-multiselect__visible\"))\r\n            $containerRender.removeClass(\"bz-multiselect__visible\");\r\n\r\n        $list.remove();\r\n    },\r\n\r\n    /**\r\n     * Update the float list view\r\n     */\r\n    closeFloatView: function () {\r\n        var $control = this.getControl();\r\n        var $containerControl = $control.closest(\".ui-bizagi-control-wrapper\");\r\n        var $containerRender = $containerControl.closest(\".bz-form-old-item\");\r\n\r\n        var $listView = $($containerRender).find(\".bz-multiselect__content\");\r\n\r\n        $listView.hide();\r\n\r\n        this.updateArrow();\r\n        this.destroyFloatView($listView)\r\n    },\r\n\r\n    updateArrow: function () {\r\n        var $control = this.getControl();\r\n\r\n        $control.find(\".bz-multiselect__arrow\")\r\n            .toggleClass(\"bz-multiselect__arrow-collapse\");\r\n    },\r\n\r\n    floatViewIsCollapsed: function () {\r\n        var $listView = $(\".bz-multiselect__content\", this.element);\r\n\r\n        return $listView && $listView.length > 0;\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) === true && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) === true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    onUnselectElement: function (ev) {\r\n        var $element = $(ev.target);\r\n        var idToRemove = $element.data(\"id\");\r\n\r\n        // Remove element\r\n        this.removeElement({id: idToRemove});\r\n        this.addSelectedElements();\r\n    },\r\n\r\n    onShowSelectedElements: function (ev) {\r\n        var self = this;\r\n        var $element = $(ev.currentTarget);\r\n        var index = $element.data('index');\r\n\r\n        var valuesToShow = (this.getDataValue() || []).slice(index);\r\n        var template = this.renderFactory.getTemplate(\"list-multiselect-tags\");\r\n        var $listView = this.showFloatListView(template, {\r\n            datasource: valuesToShow,\r\n            editable: self.properties.editable\r\n        }, {\r\n            formatItem: self.formatItem\r\n        });\r\n\r\n        var $tagElements = $('ul.bz-multiselect__tags', $listView);\r\n\r\n        $tagElements.on(\"click, mousedown\", \"li div.bz-btn-icn\", function (ev) {\r\n            self.onUnselectElement(ev);\r\n            $listView.remove();\r\n            ev.stopPropagation();\r\n        });\r\n\r\n        $listView.on(\"closeView\", function () {\r\n            $tagElements.off(\"click\", \"li div.bz-btn-icn\", self.onUnselectElement.bind(self))\r\n            $listView.remove();\r\n        });\r\n\r\n    },\r\n\r\n    onToggleDataView: function (evt) {\r\n        this.floatViewIsCollapsed() ? this.closeFloatView() : this.renderFloatView();\r\n    },\r\n\r\n    floatListHandlers: function ($floatListContext) {\r\n        var self = this;\r\n        var $listContainer = $floatListContext.find(\".bz-multiselect__list li\");\r\n        var checkbox = $listContainer.find(\"input[type=checkbox]\");\r\n\r\n        $floatListContext.find(\".bz-multiselect__search_input\").bind(\"change keypress keyup mousedown\", function (evt) {\r\n            evt.stopPropagation();\r\n\r\n            self.filterList(this.value, $listContainer);\r\n        });\r\n\r\n        checkbox.change(function () {\r\n            var $context = $(this);\r\n            var isChecked = $context.is(\":checked\");\r\n            var id = $context.data(\"id\");\r\n            var element = self.findItemById(id);\r\n            var value = element.value;\r\n\r\n            var newValue = {id: id, value: value};\r\n\r\n            if (isChecked) {\r\n                self.addElement(newValue);\r\n            } else {\r\n                self.removeElement(newValue);\r\n            }\r\n\r\n            self.addSelectedElements();\r\n        });\r\n\r\n        $floatListContext.on(\"closeView\", function () {\r\n            self.closeFloatView();\r\n\r\n            $(document).unbind(\"mousedown.multiselect\");\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Template method to get the label element\r\n     * @returns {jQuery|HTMLElement}\r\n     */\r\n    getLabel: function () {\r\n        return $(\"label\", this._super());\r\n    }\r\n\r\n});\r\n\r\n","/*\r\n *   Name: BizAgi Desktop Render Query List Extension\r\n *   Author: Paola Herrera\r\n *   Comments:\r\n *   -   This script will redefine the query list render class to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.list.extend(\"bizagi.rendering.desktop.queryList\", {}, {\r\n\r\n});\r\n\r\n","/**\r\n *   Name: BizAgi Desktop Render Query MultiSelect Extension\r\n *   Author: Alexander Mejia\r\n *   Comments:\r\n *   -   This script will redefine the query multi select render class to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.multiSelect.extend(\"bizagi.rendering.desktop.queryMultiSelect\", {}, {\r\n\r\n    /**\r\n     * Fetch the data into a deferred\r\n     * @returns {*[]}\r\n     */\r\n    getData: function () {\r\n        var properties = this.properties;\r\n\r\n        return properties.data || [];\r\n    }\r\n});\r\n\r\n","/*\r\n*   Name: BizAgi User Field render Desktop Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define the basic behaviour for userfields\r\n*/\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.userfieldWrapper\", bizagi.rendering.userfieldWrapper.prototype);\r\n\r\nbizagi.rendering.desktop.userfieldWrapper.extend(\"bizagi.rendering.desktop.userfieldWrapper\", {}, {\r\n\r\n    /**\r\n     *  Load userfield\r\n     */\r\n    getUserfieldControl: function () {\r\n        var self = this;\r\n        var sControl = self.userfieldName;\r\n        var mode = self.getMode();       \r\n        var exists = (mode !== \"execution\") || eval(\"bizagi.rendering.desktop.\" + sControl + \" !== undefined\");\r\n        var def = new $.Deferred();\r\n        if (exists) {\r\n            // Creates the userfield instance\r\n            // Set true argument for tabItem\r\n            $.when(self.parent.ready()).done(function () {\r\n                def.resolve(self.createUserfieldInstance(sControl));\r\n            });\r\n\r\n        } else {\r\n            // Call ajax service in order to retrieve user field definitions\r\n            $.when(self.dataService.getUserfieldDefinition({ userfield: self.userfieldGuid, device: \"desktop\" })).pipe(function (data) {\r\n                // Load userfield in memory\r\n                self.loadUserfield(data);\r\n\r\n                // Creates the userfield instance\r\n                def.resolve(self.createUserfieldInstance(sControl));\r\n            });\r\n        }\r\n\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Creates the userfield instance when the userfield prototype is loaded in memory \r\n     */\r\n    createUserfieldInstance: function (sControl) {\r\n        var self = this;\r\n        var control;\r\n        try {\r\n            // Create a dynamic function to avoid problem with eval calls when minifying the code\r\n            var dynamicFunction = \"var baDynamicFn = function(renderParams){ \\r\\n\";\r\n            dynamicFunction += \"return new bizagi.rendering.desktop.\" + sControl + \"(renderParams);\\r\\n\";\r\n            dynamicFunction += \"}\\r\\n\";\r\n            dynamicFunction += \"baDynamicFn\";\r\n            dynamicFunction = eval(dynamicFunction);\r\n\r\n            // Call the dynamic function\r\n            control = dynamicFunction(self.initialParams);\r\n        } catch (e) {\r\n            // If the call fails, return the default user field\r\n            control = self.getUserFieldInstance(self.initialParams);\r\n        }\r\n        control.properties.isUserField = true;\r\n\r\n        // Save userfield instance\r\n        self.userfieldInstance = control;\r\n\r\n        // Create proxy methods from the wrapper to the userfield instance\r\n        self.replicateUserfieldMethods(control);\r\n\r\n        // Replicate renderchange event from wrapped element to grid if applies\r\n        self.userfieldInstance.bind(\"renderchange\", function () {\r\n            self.triggerHandler(\"renderchange\", arguments);\r\n        });\r\n\r\n        return control;\r\n    },\r\n\r\n    /**\r\n     * Load userfield into memory\r\n     */\r\n    loadUserfield: function (data) {\r\n        var self = this;\r\n        self.properties.styleGuid = self.properties.styleGuid || Math.guid();\r\n\r\n        try {\r\n            // Parse data\r\n            try { data = eval(data); } catch (e) { bizagi.log(\"Could not parse result userfield \" + self.userfieldName, e.message); }\r\n\r\n            // Iterate elements\r\n            $.each(data, function (index, val) {\r\n                if (val.type == \"js\") {\r\n                    try { \r\n                        function replaceWithDevice(str)\r\n                        {\r\n                            return str.replace(/bizagi.rendering/gi, \"bizagi.rendering.desktop\");\r\n                        }\r\n                        val.content = val.content.replace(/bizagi\\.rendering\\.[^\\s]+\\.extend(\\s|\\n|\\s)*\\((\\s|\\n|\\s)*\\\"bizagi\\.rendering\\.[^\\s]+\\\"/gmi, replaceWithDevice);\r\n                        window.eval(val.content);\r\n                    } catch (ex) { bizagi.log(\"Could not parse result userfield3 \" + self.userfieldName, ex.message); };\r\n                }\r\n                if (val.type == \"css\") {\r\n                    bizagi.util.loadStyle(val.content, self.properties.styleGuid);\r\n                }\r\n            });\r\n\r\n            // Replicate userfield methods to the wrapper\r\n            var control = eval(\"bizagi.rendering.\" + self.userfieldName);\r\n\r\n        } catch (e) { bizagi.log(\"Could not parse result userfield \" + self.userfieldName, e.message); };\r\n    },\r\n\r\n    getUserFieldInstance: function (params) {\r\n        var mode = this.getMode();\r\n        // If the call fails, return the default user field\r\n        return  (mode === \"execution\") ?\r\n                new bizagi.rendering.desktop.defaultUserField(params) :\r\n                new bizagi.rendering.desktop.designUserField(params);\r\n    }\r\n});\r\n\r\n// Auto-extension\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.basicUserField\", bizagi.rendering.userfieldDefinition.prototype);\r\n\r\nbizagi.rendering.desktop.basicUserField.extend(\"bizagi.rendering.desktop.basicUserField\", bizagi.rendering.basicUserField.prototype);\r\n\r\nbizagi.rendering.desktop.basicUserField.extend(\"bizagi.rendering.desktop.basicUserField\", {}, {\r\n\t/*\r\n\t* Shows a jquery dialog\r\n\t*/\r\n    showDialog: function (url, params) {\r\n        var self = this;\r\n        var formDialog = $(\"<div class='iframeContent'><iframe scrolling='yes' id='innerFrameContent' src='\" + url + \"' style='width:100%;height:100%;border:0'  /></div>\");\r\n        var iframe = $(\"#innerFrameContent\", formDialog);\r\n\r\n        // The following procedure adds the \"closeWindow\" function, this will serve as callback from the\r\n        // window, also it's going to serve as brigde to update data back into bizagi fields.\r\n        iframe.load(function () {\r\n            iframe.callInside(function (params) {\r\n                // This script will execute inside the iframe context\r\n                this.BACloseWindow = function (controls, submitForm) {\r\n                    // close dialog\r\n                    params.formDialog.dialog(\"close\");\r\n\r\n                    // Executes the callback to assign values and submit form (if requested)\r\n                    params.formDialog.callback(controls, submitForm);\r\n                };\r\n\r\n            }, {\r\n                    formDialog: formDialog,\r\n                    container: self\r\n                });\r\n            // Callback function which will update the values in bizagi\r\n            formDialog.callback = function (controls, submitForm) {\r\n                $.each(controls, function (index, item) {\r\n                    if (!item.xpath) {\r\n                        bizagi.showMessageBox('Error calling closeWindow, the xpath was not defined.', 'Userfield error');\r\n                    }\r\n                    if (!item.value) {\r\n                        bizagi.showMessageBox('Error calling closeWindow, the value was not defined.', 'Userfield error');\r\n                    }\r\n\r\n                    self.getFormContainer().getRender(item.xpath).setDisplayValue(item.value);\r\n                });\r\n                // If the closeWindow was call with \"submitForm\" then execute the submit on change\r\n                if (submitForm) {\r\n                    self.submitOnChange();\r\n                }\r\n            };\r\n        });\r\n        formDialog.dialog({ height: params.height, width: params.width, title: params.title });\r\n    },\r\n\r\n\t/*\r\n\t*   Shows a browser popup\r\n\t*/\r\n    showPopup: function (url, params) {\r\n        var self = this;\r\n        // Callback function which will update the values in bizagi\r\n        var callbackFn = function (controls, submitForm) {\r\n            $.each(controls, function (index, item) {\r\n                if (!item.xpath) {\r\n                    bizagi.showMessageBox('Error calling closeWindow, the xpath was not defined.', 'Userfield error');\r\n                }\r\n                if (!item.value) {\r\n                    bizagi.showMessageBox('Error calling closeWindow, the value was not defined.', 'Userfield error');\r\n                }\r\n\r\n                self.getFormContainer().getRender(item.xpath).setDisplayValue(item.value);\r\n            });\r\n            // If the closeWindow was call with \"submitForm\" then execute the submit on change\r\n            if (submitForm) {\r\n                self.submitOnChange();\r\n            }\r\n        };\r\n\r\n        bizagi.showPopup(url, params, callbackFn);\r\n    }\r\n});\r\n\r\n/*\r\n*   Default implementation for user fields\r\n*/\r\nbizagi.rendering.desktop.basicUserField.extend(\"bizagi.rendering.desktop.defaultUserField\", {}, {\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    getEditableControl: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var controlName = properties.control;\r\n        self.input = $(\"<label>Userfield: \" + controlName + \" not found</label>\").appendTo(control);\r\n    },\r\n\r\n    /*\r\n\t*  Dont send the data to the server\r\n\t*/\r\n    collectData: function (renderValues) {\r\n    },\r\n\r\n    getDisplayValue: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var controlName = properties.control;\r\n        return \"Userfield: \" + controlName + \" not found\";\r\n    },\r\n\r\n    getReadonlyControl: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var controlName = properties.control;\r\n        var mycontrol = $(\"<label>Userfield: \" + controlName + \" not found</label>\").appendTo(control);\r\n        return mycontrol;\r\n    }\r\n});","/**\r\n *   Name: Bizagi Desktop Render Document Generator Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the document generator render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.document\", bizagi.rendering.document.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.document.extend(\"bizagi.rendering.desktop.document\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        self.applyDocumentTemplatesFormat();\r\n\r\n        if (self.properties.allowSendInMail) {\r\n            self.bindEmailDialog();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {string}\r\n     */\r\n    renderReadOnly: function () {\r\n        return \"\";\r\n    },\r\n\r\n    /**\r\n     * Bind dialog for send email\r\n     */\r\n    bindEmailDialog: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var xpathContext = self.properties.xpathContext || \"\";\r\n        var xpath = self.properties.xpath;\r\n\r\n        $(\".ui-bizagi-render-documentgenerator-sendmail\", control).bizagiSendEmail({\r\n            tmpl: self.renderFactory.getTemplate(\"dialog-send-email\"),\r\n            value: self.value,\r\n            self: self,\r\n            dataService: self.dataService,\r\n            properties: self.properties,\r\n            xpath: xpath,\r\n            xpathContext: xpathContext\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Put formating to the documents that are generated by the control\r\n     */\r\n    applyDocumentTemplatesFormat: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Set control container to behave as a block\r\n        control.addClass(\"ui-bizagi-render-display-block\");\r\n        // Resolve the type of the document based on the extension and put the icon to acconding to it\r\n        var documentList = $(\".ui-bizagi-document-upload-item\", control);\r\n\r\n        $.each(documentList, function (index, value) {\r\n            $(\".ui-bizagi-document-type\", value).addClass(\"ui-bizagi-document-extension\");\r\n            //add the tooltip to the document preview icon\r\n            var previewTooltip = $(\".ui-bizagi-document-preview\", value);\r\n            previewTooltip.attr(\"title\", self.resources.getResource('render-document-preview-tooltip'));\r\n            previewTooltip.tooltip();\r\n\r\n            // Disable preview\r\n            var returnType = self.returnCssTypeFile($(\"a > span\", value).html());\r\n            $(\".ui-bizagi-document-type\", value).addClass(returnType);\r\n            $(\".ui-bizagi-button\", value).remove();\r\n            $(\".ui-bizagi-document-preview\", value).attr(\"display\", \"none\");\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to correct the visualization of the link in the print mode.\r\n     * @param control\r\n     */\r\n    updateControlForPrintMode: function (control) {\r\n\r\n        //clear item that be dont render\r\n        $('.ui-bizagi-render-button', control).each(function () {\r\n            $(this).remove();\r\n        });\r\n\r\n        $('.ui-bizagi-div-error-container', control).each(function () {\r\n            $(this).remove();\r\n        });\r\n\r\n        $('.ui-bizagi-document-preview', control).each(function () {\r\n            $(this).remove();\r\n        });\r\n\r\n        $('.ui-bizagi-document-type', control).each(function () {\r\n            $(this).remove();\r\n        });\r\n\r\n        $('a', control).each(function () {\r\n            $(this).attr('target', '_blank').attr('title', $('span', this).html()).css('text-decoration', 'none');\r\n        });\r\n\r\n        $('ol', control).each(function () {\r\n            $(this).removeClass('ui-bizagi-container-documents');\r\n            $(this).addClass('ui-bizagi-container-documents-print');\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Previews the document inside a dialog\r\n     * @param url\r\n     * @param filename\r\n     */\r\n    showDocumentPreview: function (url, filename) {\r\n\r\n        url = url + \"&h_disposition=inline\";\r\n        var MSIEmatch = navigator.userAgent.match('MSIE (.)');\r\n        navigator.sayswho = (function () {\r\n            var N = navigator.appName, ua = navigator.userAgent, tem;\r\n            var M = ua.match(/(opera|chrome|safari|firefox|msie)\\/?\\s*(\\.?\\d+(\\.\\d+)*)/i);\r\n            if (M && (tem = ua.match(/version\\/([\\.\\d]+)/i)) != null) M[2] = tem[1];\r\n            M = M ? [M[1], M[2]] : [N, navigator.appVersion, '-?'];\r\n\r\n            return M;\r\n        })();\r\n\r\n        var self = this;\r\n        var dialogBox = $(\"<div style='overflow:hidden;'></div>\");\r\n        dialogBox.empty();\r\n        dialogBox.appendTo(\"body\", window.document);\r\n\r\n        // Create embed object\r\n        if (!$.browser.mozilla && !$.browser.msie) {\r\n            var template = self.renderFactory.getTemplate(\"document-item-preview\");\r\n        } else {\r\n            var template = self.renderFactory.getTemplate(\"document-item-preview-object\");\r\n        }\r\n\r\n        dialogBox.append($.fasttmpl(template, {\r\n            url: url\r\n        }));\r\n\r\n        // Create dialog buttons\r\n        var buttons = {};\r\n        buttons[self.getResource(\"confirmation-box-ok\")] = function () {\r\n            dialogBox.dialog('destroy');\r\n            dialogBox.remove();\r\n        };\r\n\r\n        if (navigator.sayswho[0] != \"Firefox\") {\r\n            buttons[self.getResource(\"render-actions-print\")] = function () {\r\n                // Print the document\r\n                var count = 0;\r\n                var printFn = function (pdf) {\r\n                    //Wait until PDF is ready to print    \r\n                    if (!document.getElementById('ui-bizagi-document-pdf-preview') && count < 5) {\r\n                        count += 1;\r\n                        setTimeout(function () {\r\n                            printFn(pdf);\r\n                        }, 1000);\r\n                    } else {\r\n                        if (!$.browser.mozilla && !$.browser.msie) {\r\n                            document.getElementById('ui-bizagi-document-pdf-preview').focus();\r\n                            document.getElementById('ui-bizagi-document-pdf-preview').contentWindow.print();\r\n                        } else {\r\n                            $(\".ui-bizagi-document-pdf-preview\").focus();\r\n                            $(\".ui-bizagi-document-pdf-preview\")[0].print();\r\n                        }\r\n                    }\r\n                };\r\n                printFn($(\"#ui-bizagi-document-pdf-preview\", dialogBox)[0]);\r\n            };\r\n        }\r\n\r\n        // Create dialog\r\n        dialogBox.dialog({\r\n            width: 800,\r\n            height: 600,\r\n            title: filename,\r\n            maximized: false,\r\n            modal: true,\r\n            buttons: buttons,\r\n            close: function () {\r\n                dialogBox.dialog('destroy');\r\n                dialogBox.remove();\r\n            }\r\n        });\r\n\r\n    },\r\n\r\n    /**\r\n     * Redraw documents when needed\r\n     * @param documents\r\n     * @param noFiles\r\n     * @param downloadalldocuments\r\n     */\r\n    redrawDocuments: function (documents, noFiles, downloadalldocuments) {\r\n        var self = this;\r\n\r\n        self._super(documents, noFiles, downloadalldocuments);\r\n        // Add icons\r\n        self.applyDocumentTemplatesFormat();\r\n    },\r\n\r\n    /**\r\n     * Shows the document if the flag is set.\r\n     */\r\n    autoOpenDocuments: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n        if (properties.autoOpen) {\r\n            if (properties.downloadalldocuments) {\r\n                //Show only the joined document\r\n                var joinedDocument = $(\".ui-bizagi-document-upload-item[data-joined=true]\", control);\r\n                if (joinedDocument && joinedDocument.length === 1) {\r\n                    self.showDocumentPreview($(\"> a\", joinedDocument).attr(\"href\"), joinedDocument.attr(\"data-filename\"));\r\n                }\r\n            } else {\r\n                // Auto-open documents if flag is set\r\n                $.each($(\".ui-bizagi-document-upload-item\", control), function () {\r\n                    // show only preview for files that are pdf\r\n                    var extension = $(this).attr(\"data-filename\").substr(($(this).attr(\"data-filename\").lastIndexOf('.') + 1));\r\n                    if (extension.toUpperCase() === \"PDF\" && !$(this).attr(\"data-joined\"))\r\n                        self.showDocumentPreview($(\"> a\", this).attr(\"href\"), $(this).attr(\"data-filename\"));\r\n                });\r\n            }\r\n        }\r\n    }\r\n});\r\n","/**\r\n *   Name: BizAgi Render Image\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the image render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.image\", {\r\n    // Statics\r\n    BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n    BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\r\n    BA_PAGE_CACHE: bizagi.render.services.service.BA_PAGE_CACHE\r\n}, bizagi.rendering.image.prototype);\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.image.extend(\"bizagi.rendering.desktop.image\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n        var template = self.renderFactory.getTemplate(\"images\");\r\n        var containerHeight;\r\n        var imgWidth = self.properties.width;\r\n        var imgHeight = self.properties.height;\r\n\r\n        // Flash to define flash version\r\n        self.properties.flashVersion = false;\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            xpath: bizagi.util.encodeXpath(self.getUploadXpath()),\r\n            editable: properties.editable,\r\n            url: self.properties.url,\r\n            allowDelete: properties.allowDelete,\r\n            mode: mode\r\n        });\r\n\r\n        $(\".image-wrapper\", control).empty().append(html);\r\n\r\n        //If is not any image include, load the default properies of the controls\r\n        if (mode === \"design\" || mode === \"layout\" || self.properties.url.length === 0) {\r\n\r\n            setTimeout(function () {\r\n                if (imgHeight === \"auto\") {\r\n\r\n                    // if null means that container is the form\r\n                    if (self.parent.properties.type === \"grid\") {\r\n                        containerHeight = $(control).height() + \"px\";\r\n                        bizagi.util.cssExtended($(\".image-wrapper\", control), 'width:100%!important');\r\n                    } else {\r\n                        var parent = (self.parent.properties.type === \"panel\") ? self.parent.parent : self.parent;\r\n                        var height = control.height();\r\n\r\n                        containerHeight = parent.container.height() - 17;\r\n\r\n                        var containerChildsSize = self.parent.getChildreCount();\r\n                        var containerChildsHeightSum = self.parent.getChildrenSumHeight(\"image\");\r\n\r\n                        if (typeof (self.getFormContainer().properties) !== \"undefined\" &&\r\n                            self.parent.properties.id == self.getFormContainer().properties.id) {\r\n                            containerHeight = 50;\r\n                        } else if (containerChildsSize > 1) {\r\n                            containerHeight = containerHeight - (containerChildsHeightSum - height);\r\n                        }\r\n\r\n                        $(\".image-wrapper\", control).height(containerHeight);\r\n                    }\r\n\r\n                    imgHeight = containerHeight;\r\n\r\n                }\r\n\r\n                $('a', control).css({width: imgWidth, height: imgHeight});\r\n\r\n                $(\".resizable_img\", control).css({width: imgWidth, height: imgHeight});\r\n            }, 150);\r\n\r\n            if ($(\".resizable_img\", control).hasClass('background-image')) {\r\n                //Creates an image node to store the sample image, and resize it to the control required dimensions\r\n\r\n                // Image url pattern\r\n                var pattern = /url\\(|\\)|\"|'/g;\r\n                var baseImageURL = $(\".resizable_img\", control).css('background-image').replace(pattern, \"\");\r\n\r\n                // Creates the image node with the base image URL\r\n                var resizableImgNode = $('<img src=' + baseImageURL + '>');\r\n\r\n                resizableImgNode.css({width: imgWidth, height: imgHeight});\r\n\r\n                // Append the created node\r\n                $(\".resizable_img\", control).append(resizableImgNode);\r\n\r\n                //Reset the styles, and make room to the created image node\r\n                $(\".resizable_img\", control).css({\r\n                    'background-image': 'none',\r\n                    'border-top-width': '0',\r\n                    'border-left-width': '0',\r\n                    'border-right-width': '0',\r\n                    'border-down-width': '0',\r\n                    'padding': '0',\r\n                    'display': 'inline-block'\r\n                });\r\n            }\r\n\r\n            // Otherwise, set the styles to adjust the image in the center, regardless his dimesions\r\n        } else {\r\n            var isImageGreaterThanContainer = false;\r\n            var controlWidth = control.width();\r\n\r\n            setTimeout(function () {\r\n                var isAuto = self.properties.isAutoWidth;\r\n\r\n                if (isAuto && self.parent.properties.type === \"grid\") {\r\n                    if ($(\".img\", control).width() < controlWidth) {\r\n                        imgWidth = $(\".img\", control).width();\r\n                    } else if ($(\".img\", control).width() >= controlWidth) {\r\n                        imgWidth = controlWidth - 20;\r\n                        isImageGreaterThanContainer = true;\r\n                    }\r\n\r\n                    $('a', control).css({height: \"auto\"});\r\n                } else {\r\n                    $('a', control).css({width: imgWidth, height: \"auto\"});\r\n                }\r\n\r\n                $(\".img, .ui-bizagi-render-image-wrapper .image-file\", control)\r\n                    .css({width: imgWidth, height: \"auto\"});\r\n                $(\".ui-bizagi-render-upload-wrapper\", control).addClass(\"uploaded\");\r\n\r\n                var wSize = 48;\r\n                if ((self.properties.width + \"\").indexOf(\"px\") !== -1) {\r\n                    wSize = (self.properties.width + \"\").replace(\"px\", \"\");\r\n                }\r\n\r\n                $(\".ui-bizagi-render-image-wrapper .image-file\", control).addClass('w-size-' + wSize);\r\n                $(\"img\", control).css(\"width\", imgWidth);\r\n                $(\"img\", control).css(\"height\", \"auto\");\r\n\r\n\r\n                if (isAuto && Number($('a', control).css(\"width\").slice(0, -2)) >\r\n                    Number($(\".img\", control).css(\"width\").slice(0, -2))) {\r\n                    $('a', control).css({width: $(\".img\", control).css(\"width\")});\r\n                }\r\n\r\n                if (isAuto && isImageGreaterThanContainer && self.parent.properties.type === \"grid\") {\r\n                    $('a', control).closest(\".ui-bizagi-render\").css(\"text-align\", \"left\");\r\n                }\r\n\r\n            }, 50);\r\n        }\r\n\r\n        self.preventDefaultForAnchorTag();\r\n\r\n        // Resolve a deferred after the postRender\r\n        if (self.isPostRendered) self.isPostRendered.resolve();\r\n\r\n    },\r\n\r\n    /**\r\n     * isReadyToSave\r\n     * @returns {*}\r\n     */\r\n    isReadyToSave: function () {\r\n        return this.ready();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        self.deleteHandler();\r\n       \r\n        $(\".ui-bizagi-render-image-wrapper\", control).bizagiUpload({\r\n            renderReference: this,\r\n            dialogTemplate: self.renderFactory.getTemplate(\"image-dialog\"),\r\n            properties: {\r\n                scriptData: self.buildAddParams(),\r\n                url: properties.addUrl,\r\n                xpath: properties.xpath,\r\n                validExtensions: properties.validExtensions,\r\n                maxSize: properties.maxSize\r\n            },\r\n            onUploadFileCompletedCallback: self.onUploadFileCompleted,\r\n            dialogTitle: self.getResource(\"render-upload-link-label\")\r\n        });\r\n\r\n        // Bind handlers\r\n        //  * Item Mouse over\r\n        control.delegate(\".ui-bizagi-render-upload-item\", \"mouseover\", function () {\r\n            var item = $(this);\r\n            $(\".ui-bizagi-render-upload-icon\", item).css(\"display\", \"inline-block\");\r\n            item.removeClass(\"ui-state-default\").addClass(\"ui-state-hover\");\r\n        });\r\n\r\n        //  * Item Mouse out\r\n        control.delegate(\".ui-bizagi-render-upload-item\", \"mouseout\", function () {\r\n            var item = $(this);\r\n            $(\".ui-bizagi-render-upload-icon\", item).css(\"display\", \"none\");\r\n            item.addClass(\"ui-state-default\").removeClass(\"ui-state-hover\");\r\n        });\r\n\r\n    },\r\n\r\n    deleteHandler: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n\r\n        $(\".delete-button\", control).bind(\"click\", function (e) {\r\n            e.stopPropagation();\r\n            $.when(self.dataService.deleteImage({\r\n                url: properties.deleteUrl,\r\n                idRender: properties.id,\r\n                xpath: properties.xpath,\r\n                xpathContext: properties.xpathContext,\r\n                idPageCache: properties.idPageCache,\r\n                contexttype: properties.contexttype\r\n            })).done(function () {\r\n                self.refreshControl();\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour when rendering in design mode\r\n     */\r\n    configureDesignView: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        $(\"*:not(.ui-bizagi-render-control-required)\", control).css({\r\n            padding: \"0px\",\r\n            margin: \"0px\",\r\n            border: \"0px\",\r\n            'line-height': '0px',\r\n            position: 'relative',\r\n            display: 'inline-block',\r\n            top: '0'\r\n        });\r\n\r\n        $(\".image-file\", control).css({width: self.properties.width, height: self.properties.height});\r\n    },\r\n\r\n    renderReadOnly: function () {\r\n        return this.renderControl();\r\n    },\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var template = self.renderFactory.getTemplate(\"images\");\r\n        var mode = self.getMode();\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            xpath: bizagi.util.encodeXpath(self.getUploadXpath()),\r\n            editable: false,\r\n            url: self.properties.url,\r\n            allowDelete: false,\r\n            mode: mode\r\n        });\r\n\r\n        $(\".ui-bizagi-render-upload-wrapper\", control).empty().append(html);\r\n\r\n        $(\"a,.img, .ui-bizagi-render-image-wrapper .image-file, .ui-bizagi-render-image-wrapper\", control).css({\r\n            width: self.properties.width,\r\n            height: self.properties.height\r\n        });\r\n    },\r\n\r\n    getTemplateItem: function () {\r\n        return this.renderFactory.getTemplate(\"image-item\");\r\n    },\r\n\r\n    /**\r\n     * Opens a dialog in order to upload file per file\r\n     */\r\n    openUploadDialog: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var doc = window.document;\r\n\r\n        var dialogBox = self.dialogBox = $(\"<div class='ui-bizagi-component-loading'/>\");\r\n        dialogBox.empty();\r\n        dialogBox.appendTo(\"body\", doc);\r\n\r\n        // Define buttons\r\n        var buttons = {};\r\n\r\n        // Select button\r\n        buttons[self.getResource(\"render-upload-dialog-select\")] = function (e) {\r\n            //e.stopPropagation();\r\n            if (self.checkMaxSize() && self.checkFileTypes()) {\r\n                $.when(self.processUploadFile()).done(function (data) {\r\n                    self.onUploadFileCompleted(data);\r\n                    self.closeUploadDialog();\r\n                });\r\n            }\r\n        };\r\n\r\n        // Cancel button\r\n        buttons[self.getResource(\"text-cancel\")] = function () {\r\n            self.closeUploadDialog();\r\n        };\r\n\r\n        // Creates a dialog\r\n        dialogBox.dialog({\r\n            width: 500,\r\n            height: 200,\r\n            title: self.getResource(\"render-upload-link-label\"),\r\n            modal: true,\r\n            buttons: buttons,\r\n            close: function () {\r\n                self.closeUploadDialog();\r\n            },\r\n            resizeStop: function (event, ui) {\r\n                if (self.form) {\r\n                    self.form.resize(ui.size);\r\n                }\r\n            }\r\n        });\r\n\r\n        // Render template\r\n        var dialogTemplate = self.renderFactory.getTemplate(\"image-dialog\");\r\n        $.tmpl(dialogTemplate, {\r\n            scriptData: self.buildAddParams(),\r\n            url: properties.addUrl,\r\n            xpath: properties.xpath,\r\n            validExtensions: properties.validExtensions.replace(\";\", \",\"),\r\n            maxSize: properties.maxSize\r\n        }).appendTo(dialogBox);\r\n        $('.ui-bizagi-loading-message').remove();\r\n\r\n    },\r\n\r\n    /**\r\n     * Close the upload dialog\r\n     */\r\n    closeUploadDialog: function () {\r\n        var self = this;\r\n        self.dialogBox.dialog('destroy');\r\n        self.dialogBox.remove();\r\n    },\r\n\r\n    /**\r\n     * Handler to process server response after a file has been uploaded\r\n     * @param renderReference\r\n     * @param response\r\n     */\r\n    onUploadFileCompleted: function (renderReference, response) {\r\n        var self = renderReference;\r\n        var control = self.getControl();\r\n        var imageWrapper = $(\".ui-bizagi-render-image-wrapper\", control);\r\n        var result = JSON.parse(response);\r\n        var imgWidth = 0;\r\n        var controlWidth = control.width();\r\n        var isImageLoaded = control.find(\".img\").size() > 0;\r\n        var widthBase = control.find(\".resizable_img\").width();\r\n\r\n        if (self.properties.isAutoWidth) {\r\n            imgWidth = self.properties.type != \"image\" ? control.width() : \"99%\";\r\n        } else {\r\n            imgWidth = self.properties.width;\r\n        }\r\n\r\n        // Set width\r\n        $(\".uploadifyQueueItem\", control).css({width: self.properties.width});\r\n\r\n        if (result.type !== \"error\") {\r\n            $.when(self.renderUploadItem()).done(function (htmlImage) {\r\n                // Empty container and add new image\r\n                $(imageWrapper).empty();\r\n                $(imageWrapper).append(htmlImage);\r\n                self.deleteHandler();\r\n\r\n                // Trigger change\r\n                self.triggerRenderChange();\r\n\r\n                setTimeout(function () {\r\n                    var isImageGreaterThanContainer = false;\r\n                    var isAuto = self.properties.isAutoWidth;\r\n\r\n                    if (isAuto && self.parent.properties.type === \"grid\") {\r\n\r\n                        if ($(\".img\", control).width() < controlWidth) {\r\n                            imgWidth = $(\".img\", control).width();\r\n                        } else if ($(\".img\", control).width() >= controlWidth) {\r\n                            imgWidth = controlWidth - 20;\r\n                            isImageGreaterThanContainer = true;\r\n                        }\r\n\r\n                        if (!isImageLoaded) {\r\n                            $('a', control).closest(\"td\").css(\"width\", widthBase);\r\n                        }\r\n\r\n                        $('a', control).css({height: \"auto\"});\r\n\r\n                    } else {\r\n                        $('a', control).css({width: imgWidth, height: \"auto\"});\r\n                    }\r\n\r\n                    $(\".img, .ui-bizagi-render-image-wrapper .image-file\", control)\r\n                        .css({width: imgWidth, height: \"auto\"});\r\n\r\n                    $(\".ui-bizagi-render-upload-wrapper\", control).addClass(\"uploaded\");\r\n\r\n                    var wSize = 48;\r\n                    if ((self.properties.width + \"\").indexOf(\"px\") !== -1) {\r\n                        wSize = (self.properties.width + \"\").replace(\"px\", \"\");\r\n                    }\r\n\r\n                    $(\".ui-bizagi-render-image-wrapper .image-file\", control).addClass('w-size-' + wSize);\r\n\r\n                    $(\"img\", control).css(\"width\", imgWidth);\r\n                    $(\"img\", control).css(\"height\", \"auto\");\r\n                    $('.image-wrapper', control).css(\"height\", \"auto\");\r\n\r\n\r\n                    if (isAuto && Number($('a', control).css(\"width\").slice(0, -2)) >\r\n                        Number($(\".img\", control).css(\"width\").slice(0, -2))) {\r\n                        $('a', control).css({width: $(\".img\", control).css(\"width\")});\r\n                    }\r\n\r\n                    if (self.parent.properties.type === \"grid\" && isAuto) {\r\n                        if (isImageGreaterThanContainer) {\r\n                            $('a', control).closest(\".ui-bizagi-render\").css(\"text-align\", \"left\");\r\n                        } else {\r\n                            if (self.properties.columnAlign) {\r\n                                $('a', control).closest(\".ui-bizagi-render\")\r\n                                    .css(\"text-align\", self.properties.columnAlign);\r\n                                $('.image-wrapper', control).css(\"text-align\", self.properties.columnAlign);\r\n                            } else {\r\n                                $('a', control).closest(\".ui-bizagi-render\").css(\"text-align\", \"center\");\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                }, 50);\r\n\r\n                //Set Value\r\n                self.setValue([true]);\r\n\r\n            });\r\n        } else {\r\n            // Show server error\r\n            bizagi.showMessageBox(result.message);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Build add params to send to the server\r\n     * @returns {Array}\r\n     */\r\n    buildAddParams: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n\r\n        var data = [];\r\n        var action = \"savefile\";\r\n\r\n        if (properties.isUserPreference) {\r\n            action = \"SAVEUSERIMAGE\";\r\n            data.push({key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\", value: \"entity\"});\r\n            data.push({key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"surrogateKey\", value: self.currentUser});\r\n        }\r\n\r\n        data.push({key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\", value: self.getUploadXpath()});\r\n        data.push({key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\", value: properties.id});\r\n        data.push({key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\", value: properties.xpathContext});\r\n        data.push({\r\n            key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE,\r\n            value: properties.idPageCache\r\n        });\r\n        data.push({key: self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\", value: form.properties.sessionId});\r\n        data.push({key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\", value: action});\r\n\r\n        if (properties.contexttype) {\r\n            data.push({key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\", value: properties.contexttype});\r\n        }\r\n\r\n        try {\r\n            if (typeof (BIZAGI_SESSION_NAME) !== \"undefined\") {\r\n                data.push({key: BIZAGI_SESSION_NAME, value: form.properties.sessionId});\r\n            } else {\r\n                data.push({key: \"JSESSIONID\", value: form.properties.sessionId});\r\n            }\r\n        } catch (e) {\r\n            data.push({key: \"JSESSIONID\", value: form.properties.sessionId});\r\n        }\r\n\r\n        return data;\r\n    },\r\n\r\n    checkMaxSize: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var dialogBox = self.dialogBox;\r\n        var fileControl = $(\"input[type=file]\", dialogBox).get(0) || {};\r\n\r\n        // Dont exist any fucking way to know file size in IEx, just skip this validation\r\n        if (fileControl.files != undefined) {\r\n            if (fileControl.files.length > 0) {\r\n                if (fileControl.files[0].size > properties.maxSize) {\r\n                    self.showError(self.getResource(\"render-upload-alert-maxsize\").replace(\"{0}\", properties.maxSize));\r\n                    return false;\r\n                }\r\n                return true;\r\n            } else {\r\n                self.showError(self.getResource(\"render-required-upload\").replace(\"#label#\", \"\"));\r\n                return false;\r\n            }\r\n        } else {\r\n            if (bizagi.util.isIE()) {\r\n                if (fileControl.value === \"\" || !fileControl.value) {\r\n                    self.showError(self.getResource(\"render-required-upload\").replace(\"#label#\", \"\"));\r\n                    return false;\r\n                } else {\r\n                    return true;\r\n                }\r\n            } else {\r\n                return true;\r\n            }\r\n        }\r\n    },\r\n\r\n    checkFileTypes: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var dialogBox = self.dialogBox;\r\n        var file = $(\"input[type=file]\", dialogBox).val();\r\n\r\n        if (properties.validExtensions && properties.validExtensions.length > 0) {\r\n            var validExtensions = properties.validExtensions.replaceAll(\"*.\", \"\").split(\";\");\r\n            if (!self.stringEndsWithValidExtension(file, validExtensions, true)) {\r\n                self.showError(self.getResource(\"render-upload-allowed-extensions\") + properties.validExtensions);\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    },\r\n\r\n    stringEndsWithValidExtension: function (stringToCheck, acceptableExtensionsArray, required) {\r\n        if (required == false && stringToCheck.length == 0) return true;\r\n\r\n        for (var i = 0; i < acceptableExtensionsArray.length; i++) {\r\n            if (acceptableExtensionsArray[i].toLowerCase() == \"*\") return true\r\n            if (stringToCheck.toLowerCase().endsWith(acceptableExtensionsArray[i].toLowerCase())) return true;\r\n        }\r\n\r\n        return false;\r\n    },\r\n\r\n    showError: function (message) {\r\n        var self = this;\r\n        var errorContainer = $(\"#alert-file-upload\", self.dialogBox);\r\n\r\n        // Empty container\r\n        errorContainer.empty();\r\n        errorContainer.show();\r\n\r\n        errorContainer.html(message);\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) == true && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) == true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    /**\r\n     * Process an upload file into the server\r\n     * @returns {*}\r\n     */\r\n    processUploadFile: function () {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n        var dialogBox = self.dialogBox;\r\n        var uploadForm = $(\"form\", dialogBox);\r\n        var uploadIFrame = $(\"iframe\", uploadForm);\r\n\r\n        // When the iframe loads the user we need to evaluate the response and close the dialog\r\n        var timeoutFn = function () {\r\n            try {\r\n                var response = \"\";\r\n                if (uploadIFrame[0].contentWindow) {\r\n                    var iframeContent = bizagi.util.isIE8() ? $(uploadIFrame[0].contentWindow.document.body)\r\n                        : $(uploadIFrame[0].contentWindow.eval(\"document.body\"));\r\n\r\n                    response = iframeContent.text();\r\n                }\r\n                if (response.length > 0) {\r\n                    defer.resolve(response);\r\n                } else {\r\n                    setTimeout(timeoutFn, 50);\r\n                }\r\n            } catch (error) {\r\n                // Nothing to do, just close the window and show error message\r\n                self.closeUploadDialog();\r\n                bizagi.showMessageBox(error.toString());\r\n            }\r\n        };\r\n\r\n        // Execute the timed function in order to check when the response has arrived\r\n        timeoutFn();\r\n\r\n        // Submit the form\r\n        uploadForm.submit();\r\n\r\n        return defer.promise();\r\n    }\r\n});\r\n","/*\r\n *   Name: Bizagi Desktop Render Yes-No Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the Yes-No render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.searchList\", bizagi.rendering.searchList.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.searchList.extend(\"bizagi.rendering.desktop.searchList\", {\r\n    SEARCH_MIN_LENGTH: 2\r\n}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     * @returns {}\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Call base \r\n        self._super();\r\n\r\n        // Apply plugin\r\n        self.searchInput = $(\"input\", control);\r\n        $(control).find(\"input\").css({\"width\": \"100%\", \"padding-right\": \"25px\"});\r\n\r\n        self.applyAutocompletePlugin();\r\n        self.attachKeyEvents();\r\n    },\r\n\r\n    /**\r\n     * Attaches key events to the control\r\n     * @returns {}\r\n     */\r\n    attachKeyEvents: function () {\r\n        var self = this;\r\n\r\n        self.element.keydown(function (e) {\r\n            e = window.event || e;\r\n            var keyUnicode = e.charCode || e.keyCode;\r\n\r\n            if (e !== undefined) {\r\n                switch (keyUnicode) {\r\n                    case 8: // Backspace\r\n                        var caretPos = $(\"input:first\", self.element)[0].selectionStart;\r\n\r\n                        if (caretPos === 0) {\r\n                            self.removeLastElement();\r\n                            $(\"li:nth-last-child(2)\", self.element).remove();\r\n                            $(\".biz-render-input-search\", self.getControl()).focus();\r\n                        }\r\n\r\n                        break;\r\n                }\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Apply autocomplete capabilities to a single input\r\n     * @returns {}\r\n     */\r\n    applyAutocompletePlugin: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var searchInput = self.searchInput;\r\n\r\n        searchInput.autocomplete({\r\n            autoFocus: true,\r\n            messages: {\r\n                noResults: null, //\"No search results.\",\r\n                results: function () {\r\n                }\r\n            },\r\n            source: function (req, add) {\r\n                // active search\r\n                self.activeRequestTerm = req.term;\r\n\r\n                // Check local storage\r\n                var now = new Date().getTime();\r\n                var parseRequest = encodeURIComponent(req.term);\r\n                var expireKey = self.properties.xpath + \"_\" + parseRequest + \"_expire\";\r\n                var requestKey = self.properties.xpath + \"_\" + parseRequest;\r\n                var expire = bizagi.util.getItemLocalStorage(expireKey);\r\n\r\n                if (expire && self.properties.enableLocalStorage && now < expire) {\r\n                    try {\r\n                        var data = JSON.parse(bizagi.util.getItemLocalStorage(requestKey));\r\n                        add(data);\r\n                        self.hideAutocompleteLoading();\r\n                    } catch (e) {\r\n                        self.processRequest(req, add);\r\n                    }\r\n                } else {\r\n                    self.processRequest(req, add);\r\n                }\r\n            },\r\n            select: function (event, ui) {\r\n                var selectedValues = JSON.parse(self.getValue()).value;\r\n                var isNewItem = true;\r\n                if (typeof ui.item.id == \"undefined\") {\r\n                    isNewItem = false;\r\n                } else {\r\n                    $.each(selectedValues, function (i, val) {\r\n                        if (ui.item.id == val.id) {\r\n                            isNewItem = false;\r\n                            return isNewItem;\r\n                        }\r\n                    });\r\n                }\r\n\r\n                if (isNewItem) {\r\n                    self.appendFoundItem(event, ui);\r\n                    self.changeRequired(false);\r\n                }\r\n\r\n                searchInput.autocomplete('close');\r\n                ui.item.value = \"\";\r\n            },\r\n            open: function () {\r\n                var suggestMenu = searchInput.data(\"ui-autocomplete\").menu.element;\r\n                var suggestStyles = {top: 0, left: 0};\r\n                var suggestContainer = searchInput.closest(\".ui-bizagi-control\");\r\n                var controlContainer = suggestContainer.parent();\r\n                var itemWidth = self.calculateSuggestionWidth();\r\n\r\n                $('li', suggestMenu).each(function () {\r\n                    if ($(this).index() % 2 < 1)\r\n                        $(this).addClass('biz-ui-even');\r\n                });\r\n\r\n                // Fix position to prevent the scroll of autocomplete\r\n                suggestMenu.css(suggestStyles);\r\n                suggestContainer.addClass(\"ac-is-visible\");\r\n                controlContainer.addClass(\"ac-is-visible ac-clear-floats\");\r\n\r\n                suggestMenu.appendTo(suggestContainer).position({\r\n                    my: \"left top\",\r\n                    at: \"left bottom\",\r\n                    of: this,\r\n                    collision: \"flipfit\"\r\n                });\r\n\r\n                suggestMenu.css(\"z-index\", $.getMaxZindex() + 10);\r\n\r\n                // Add data to check if element is visible\r\n                suggestMenu.attr(\"visible\", true);\r\n\r\n                // Apply width to menu and items\r\n                $(\".ui-bizagi-render-search-item\", suggestMenu).width(itemWidth);\r\n                suggestMenu.width(itemWidth);\r\n                self.hideAutocompleteLoading();\r\n\r\n            },\r\n            close: function () {\r\n                searchInput.data(\"ui-autocomplete\").menu.element.attr(\"visible\", false);\r\n            },\r\n            delay: this.Class.SEARCH_DELAY,\r\n            minLength: self.Class.SEARCH_MIN_LENGTH\r\n        });\r\n\r\n\r\n        // Special rendering\r\n        searchInput.data(\"ui-autocomplete\")._renderItem = function (ul, item) {\r\n            // Normal rendering\r\n            return self.renderSearchItem(item).appendTo(ul);\r\n        };\r\n\r\n        // Set close event\r\n        $('[data-action=remove]', control).click(function () {\r\n            self.deleteItem($(this));\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Append matched element\r\n     * @param {} event\r\n     * @param {} ui\r\n     * @returns {}\r\n     */\r\n    appendFoundItem: function (event, ui) {\r\n        var self = this;\r\n        var control = this.getControl();\r\n        var ul = $('.biz-render-input-search', control).closest('ul');\r\n        var last = $('li:last', ul);\r\n        var newElement;\r\n\r\n        // Format additional label\r\n        ui.item.value = self.formatItem(ui.item.value);\r\n\r\n        var element = self.renderFactory.getTemplate(\"searchListTag\");\r\n    \r\n        newElement = $.fasttmpl(element,\r\n            {\r\n                id: ui.item.id, \r\n                value: ui.item.value,\r\n                editable: true\r\n            },\r\n            {\r\n                formatItem: self.formatItem\r\n            });\r\n\r\n        // Append new li with match word\r\n        $(last).before(newElement);\r\n\r\n        // Set close event\r\n        $('[data-action=remove]', ul).click(function () {\r\n            self.deleteItem($(this));\r\n        });\r\n\r\n        // Set selected flag\r\n        $('.biz-render-input-search', control).data('selected', '1');\r\n\r\n        // Set focus on input field\r\n        $('.biz-render-input-search', control).focus();\r\n\r\n        // Remove selected css class from all elements\r\n        $('li', ul).removeClass('selected');\r\n\r\n        // Set value\r\n        this.addElement({id: ui.item.id, value: ui.item.value});\r\n\r\n    },\r\n\r\n    deleteItem: function (element) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var li = element.parent('.bz-pill');\r\n\r\n        // Remove from main memory and set the new value\r\n        this.removeElement({id: li.data('id')});\r\n\r\n        // Remove list element\r\n        li.remove();\r\n\r\n        //Changing required label\r\n        var list = JSON.parse(this.value);\r\n        if (list.value.length === 0)\r\n            self.changeRequired(self.properties.required);\r\n\r\n        // Set focus on input element\r\n        $('.biz-render-input-search', control).focus();\r\n    },\r\n\r\n    /* \r\n     *   Renders a search item\r\n     */\r\n    renderSearchItem: function (item) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"searchItem\");\r\n\r\n        var searchItem = $.tmpl(template, {\r\n            image: properties.searchImage,\r\n            label: item.label,\r\n            orientation: self.properties.orientation || \"lrt\"\r\n        });\r\n\r\n        searchItem.data(\"item.autocomplete\", item);\r\n\r\n        return searchItem;\r\n    },\r\n\r\n    /* \r\n     *   Process the request data for the autocomplete control\r\n     */\r\n    processRequest: function (req, add) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        self.showAutocompleteLoading();\r\n        // Create array for response objects\r\n        var suggestions = [];\r\n\r\n        if ((req.term.length >= this.Class.SEARCH_MIN_LENGTH)) {\r\n\r\n            // Update term property to reflect the search\r\n            properties.term = req.term;\r\n            $.when(this.getData()).done(function (data) {\r\n                data = data.slice(0, properties.maxRecords);\r\n\r\n                if (data.length > 50) {\r\n                    data = data.slice(0, 50);\r\n\r\n                    suggestions.push({\r\n                        id: self.Class.NO_RESULTS_SEARCH_ID,\r\n                        label: self.getResource(\"render-search-maximum-records-allowed\"),\r\n                        value: ''\r\n                    });\r\n                } else data = data.slice(0, properties.maxRecords);\r\n                if (data && data.length > 0) {\r\n                    $.each(data, function (i, val) {\r\n                        if (properties.maxRecords == 0 || i < properties.maxRecords) {\r\n                            var parseValue = bizagi.util.highlightMatches(val, req.term);\r\n\r\n                            suggestions.push({id: val.id, label: parseValue, value: val.value});\r\n                        }\r\n                    });\r\n                } else {\r\n                    suggestions.push({\r\n                        id: self.Class.NO_RESULTS_SEARCH_ID,\r\n                        label: self.getResource(\"render-grid-no-records\"),\r\n                        value: ''\r\n                    });\r\n                }\r\n\r\n                addToSuggestions(suggestions, req.term);\r\n\r\n                self.hideAutocompleteLoading();\r\n\r\n                /*\r\n                 *   Method to add the special items to the suggestions\r\n                 */\r\n                function addToSuggestions(allSuggestions, request) {\r\n\r\n                    // Create local storage to improve the speed\r\n                    var expireTime = new Date().getTime() + self.properties.expireCache;\r\n                    var parseRequest = encodeURIComponent(request);\r\n\r\n                    if (self.properties.enableLocalStorage) {\r\n                        var expireKey = self.properties.xpath + \"_\" + parseRequest + \"_expire\";\r\n                        var requestKey = self.properties.xpath + \"_\" + parseRequest;\r\n\r\n                        bizagi.util.setItemLocalStorage(expireKey, expireTime);\r\n                        bizagi.util.setItemLocalStorage(requestKey, JSON.encode(allSuggestions));\r\n                    }\r\n                    // Pass array to callback\r\n                    add(allSuggestions);\r\n                }\r\n            });\r\n\r\n        }\r\n    },\r\n\r\n    showAutocompleteLoading: function () {\r\n        $('i', this.getControl()).addClass('ui-autocomplete-loading');\r\n    },\r\n\r\n    hideAutocompleteLoading: function () {\r\n        $('i', this.getControl()).removeClass('ui-autocomplete-loading');\r\n    },\r\n    /**\r\n     * Returns the desired width for the suggestion menu\r\n     * @returns {}\r\n     */\r\n    calculateSuggestionWidth: function () {\r\n        var self = this;\r\n        var suggestMenu = self.searchInput.data(\"ui-autocomplete\").menu.element;\r\n\r\n        return suggestMenu.width();\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param {} value\r\n     * @returns {}\r\n     */\r\n    setDisplayValue: function (value) {\r\n        if (value !== undefined) {\r\n            if (this.properties.editable) {\r\n                this.searchInput.val(value.label);\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Returns the value to display, ex. non-editable renders\r\n     */\r\n    getDisplayValue: function () {\r\n        return this.selectedValue;\r\n    },\r\n    /*\r\n     *   Method to render non editable values\r\n     */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n\r\n        var stringValue = properties.value.map(function (el) {\r\n            return self.formatItem(el.value);\r\n        }).join(\", \");\r\n\r\n        var tempHTML = \"<label class='readonly-control'>${value}</label>\";\r\n        var templateWithValues = $.tmpl(tempHTML, {value: stringValue});\r\n\r\n        control.empty();\r\n        control.append(templateWithValues);\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) === true && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) === true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            }\r\n        }\r\n        this.triggerRenderValidate();\r\n    },\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Desktop Render Association Extension\r\n *   Author: Edward Morales\r\n *   Comments:\r\n *   -   This script will redefine the Association control\r\n */\r\n\r\n // Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.association\", bizagi.rendering.render.base.prototype);\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.association.extend(\"bizagi.rendering.desktop.association\", bizagi.rendering.association.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.association.extend(\"bizagi.rendering.desktop.association\", {}, {\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"association\");\r\n        var control = self.getControl();\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Set close event to element into self.properties.value\r\n        $(\"ol .deleteBotton\", control).bind(\"click\", function () {\r\n            self.closeElement($(this).parent(\"li\"));\r\n        });\r\n\r\n        // Apply accordion control\r\n        $(\".bz-render-association-accordion\", control).togglepanels({\r\n            header: \"> div > h3\",\r\n            autoHeight: false,\r\n            animated: false\r\n        });\r\n\r\n        $.when(self.isRendered())\r\n            .done(function () {\r\n                var firstGroup = $(\".bz-render-association-accordion h3\", control).first();\r\n                firstGroup.click();\r\n            });\r\n\r\n\r\n        if (self.properties.allowFlip) {\r\n            // Bind event for flip botton\r\n            $(\".bz-render-association .flip-arrow\", control).bind(\"click\", function () {\r\n                $(control).empty();\r\n                // Define flipped\r\n                self.properties.flipped = !self.properties.flipped;\r\n\r\n                // Send flip data to server\r\n                self.properties.flipstate = self.properties.flipped;\r\n\r\n                self.dataService.getFlipAssociation(self.properties);\r\n\r\n                // Render template  \r\n                $.tmpl(template, self.properties, {\r\n                    getColumnData: self.getColumnData,\r\n                    getRightAssociation: self.getRightAssociation\r\n                }).appendTo(control);\r\n\r\n                self.internalPostRender();\r\n            });\r\n        }\r\n\r\n        $(\".bz-render-association bz-render-association-check-mask, .bz-render-association .bz-render-association-check\", control).bind(\"click\", function (e) {\r\n            e.stopPropagation();\r\n            var input = $(this);\r\n            var idLeft = $(this).parents(\"ol\").data(\"id\");\r\n            var idRight = $(this).data(\"id\");\r\n\r\n            if (input.prop(\"checked\")) {\r\n                // check element\r\n                input.prop(\"checked\", true);\r\n\r\n                // Add element to global value\r\n                self.addElement(idLeft, idRight);\r\n            } else {\r\n                // uncheck\r\n                input.prop(\"checked\", false);\r\n\r\n                // Remove from JSON\r\n                self.removeElement(idLeft, idRight);\r\n            }\r\n        });\r\n\r\n        $(\".bz-render-association .bz-render-association-left-container li\", control).bind(\"click\", function (e, ui) {\r\n            e.stopPropagation();\r\n\r\n            var input = ($(this).find(\"input\").length > 0) ? $(this).find(\"input\") : $(this);\r\n            var mask = $(\".bz-render-association-check-mask\", $(this));\r\n            var idLeft = $(this).parent(\"ol\").data(\"id\");\r\n            var idRight = $(this).data(\"id\") || $(this).parents(\"li\").data(\"id\");\r\n\r\n            if (input.prop(\"checked\")) {\r\n                // uncheck\r\n                input.removeAttr(\"checked\");\r\n                mask.removeClass(\"checked\");\r\n                mask.addClass(\"unchecked\");\r\n\r\n                // Remove from JSON\r\n                self.removeElement(idLeft, idRight);\r\n\r\n            } else {\r\n                // check element\r\n                input.prop(\"checked\", true);\r\n                mask.removeClass(\"unchecked\");\r\n                mask.addClass(\"checked\");\r\n\r\n                // Add element to global value\r\n                self.addElement(idLeft, idRight);\r\n            }\r\n\r\n        });\r\n    },\r\n\r\n    /**\r\n    * Set Bind event to delete botton\r\n    */\r\n    setBindToClose: function (element) {\r\n        var self = this;\r\n        element.find(\".deleteBotton\").bind(\"click\", function () {\r\n            self.closeElement($(this).parent(\"li\"));\r\n        });\r\n    },\r\n\r\n    /**\r\n    * Execute close action\r\n    */\r\n    closeElement: function (element) {\r\n        var self = this;\r\n        var ol = element.parent(\"ol\");\r\n        // Remove from JSON\r\n        self.removeElement($(ol).data(\"id\"), element.data(\"id\"));\r\n\r\n        // Remove element\r\n        element.hide(\"highlight\", 1000, function () {\r\n            $(this).remove();\r\n        });\r\n    },\r\n\r\n\r\n\r\n    /*\r\n    *   Method to render non editable values\r\n    */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var template = self.renderFactory.getTemplate(\"association\");\r\n\r\n        self.properties.classCss = \"read-only\";\r\n\r\n        // Make json base, create self.properties.formatJson\r\n        self.makeJsonBase();\r\n        \r\n        // Render template  \r\n        $.tmpl(template, self.properties, {\r\n            getColumnData: self.getColumnData,\r\n            getRightAssociation: self.getRightAssociation,\r\n            getLeftName: self.getLeftName\r\n        }).appendTo(control);        \r\n        \r\n        // Apply accordion control\r\n        $(\".bz-render-association-accordion\", control).togglepanels({\r\n            header: \"> div > h3\",\r\n            autoHeight: false\r\n        });\r\n\r\n        $.when(self.isRendered())\r\n            .done(function () {\r\n                var firstGroup = $(\".bz-render-association-accordion h3\", control).first();\r\n                firstGroup.click();\r\n            });\r\n        \r\n        if (self.properties.allowFlip) {\r\n            // Bind event for flip botton\r\n            $(\".bz-render-association .flip-arrow\", control).bind(\"click\", function () {\r\n                $(control).empty();\r\n                // Define flipped\r\n                self.properties.flipped = !self.properties.flipped;\r\n\r\n                self.postRenderReadOnly();\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Add the render data to the given collection in order to send data to the server\r\n    */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n\r\n        // Call base method\r\n        self._super(renderValues);\r\n    },\r\n\r\n    /*\r\n    * Method to render non editable values\r\n    */\r\n    renderReadOnly: function() {\r\n        var result = this.getValue();\r\n        return typeof (result) === \"object\" ? \"\" : result;\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop Render Upload Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the upload render class in order to provide a compatibility to browsers without flash installed\r\n */\r\n\r\n// Extends from render base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.upload\", bizagi.rendering.render.base.prototype);\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.upload.extend(\"bizagi.rendering.desktop.upload\", {\r\n    // Statics\r\n    BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n    BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\r\n    BA_PAGE_CACHE: bizagi.render.services.service.BA_PAGE_CACHE\r\n}, bizagi.rendering.upload.prototype);\r\n\r\n// Extends itself\r\nbizagi.rendering.desktop.upload.extend(\"bizagi.rendering.desktop.upload\", {}, {\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"upload\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            xpath: bizagi.util.encodeXpath(self.getUploadXpath()),\r\n            editable: properties.editable,\r\n            haveFiles: self.filesCount != 0,\r\n            allowSendInMail: properties.allowSendInMail\r\n        });\r\n\r\n        // Render current children\r\n        var items = \"\";\r\n        for (var i = 0; i < self.filesCount; i++) {\r\n            var file = {id: self.files[i][0], fileName: self.files[i][1]};\r\n            var item = self.renderUploadItem(file);\r\n            items += item;\r\n        }\r\n\r\n        html = self.replaceFilesHtml(html, items);\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Returns the html templated element\r\n     * @returns {*}\r\n     */\r\n    renderElement: function () {\r\n        return this._super(\"render-base\");\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        self.isClicked = false;\r\n        if (self.properties.allowSendInMail) self.bindEmailDialog();\r\n\r\n        self.checkMaxFiles();\r\n\r\n        self.preventDefaultForAnchorTag();\r\n    },\r\n\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        self._super();\r\n\r\n        if (self.properties.allowSendInMail)\r\n            self.bindEmailDialog();\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) === true && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) === true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    /**\r\n     * Adds a validation message to the render TODO:Remover al genomizar\r\n     * @param message\r\n     */\r\n    setValidationMessage: function (message) {\r\n        this._super(message);\r\n        var iconError = $(\".ui-bizagi-render-icon-error\", this.element);\r\n        $(iconError).parent().removeClass(\"ui-hidden\");\r\n    },\r\n\r\n    /**\r\n     * Bind dialog for send email\r\n     */\r\n    bindEmailDialog: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var xpathContext = self.getXpathContext() || \"\";\r\n        var xpath = self.properties.xpath;\r\n        var template = self.properties.orientation === \"rtl\" ? \"dialog-send-email-rtl\" : \"dialog-send-email\";\r\n\r\n        $(\".ui-bizagi-render-upload-sendmail\", control).bizagiSendEmail({\r\n            tmpl: self.renderFactory.getTemplate(template),\r\n            value: self.value,\r\n            self: self,\r\n            dataService: self.dataService,\r\n            properties: self.properties,\r\n            xpath: xpath,\r\n            xpathContext: xpathContext\r\n        });\r\n\r\n    },\r\n\r\n    bindExternalPopup: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var params = self.getParams();\r\n        var properties = self.properties;\r\n        var isInGrid = self.grid ? true : false;\r\n\r\n        var options = {\r\n            idCase: params.idCase || bizagi.context.idCase,\r\n            idWorkitem: params.idWorkitem || bizagi.context.idWorkitem,\r\n            field: properties.xpath.split(\".\")[properties.xpath.split(\".\").length - 1]\r\n        };\r\n\r\n        var xpathContext = self.getXpathContext();\r\n\r\n        if (isInGrid || xpathContext != \"\") {\r\n            if (typeof xpathContext == \"string\") {\r\n                $.extend(options, {xPath: xpathContext.split(\"[\")[0] + \".\" + properties.xpath});\r\n            } else {\r\n                $.extend(options, {xPath: self.grid.properties.xpath + \".\" + properties.xpath});\r\n            }\r\n        } else {\r\n            $.extend(options, {xPath: properties.xpath});\r\n        }\r\n\r\n        $(\".ui-bizagi-render-upload-sendmail\", control).tooltip();\r\n\r\n        $(\".ui-bizagi-render-upload-sendmail\", control).click(function () {\r\n            var url = \"App/Upload/SendAttachedDocs.aspx?\";\r\n            url += \"idCase=\" + options.idCase;\r\n            url += \"&idWorkitem=\" + options.idWorkitem;\r\n            url += \"&xPath=\" + options.xPath;\r\n            url += \"&field=\" + options.field;\r\n\r\n            self.dataService.getCaseNumber({\r\n                idCase: options.idCase\r\n            }).done(function (response) {\r\n                var caseNumber = response.caseNumber;\r\n                caseNumber = caseNumber ? caseNumber : options.idCase;\r\n                url += \"&radNumber=\" + caseNumber;\r\n\r\n                // fix for SUITE-8927\r\n                var values = [];\r\n                if (self.value) {\r\n                    for (var i = 0; i < self.value.length; i++) {\r\n                        values.push(self.value[i][1]);\r\n                    }\r\n                }\r\n\r\n                self.currentPopup = \"genericiframe\";\r\n                $(document).triggerHandler(\"showDialogWidget\", {\r\n                    widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME,\r\n                    widgetURL: url,\r\n                    injectCss: [\".ui-bizagi-old-render*\", \".ui-bizagi-old-render-upload\"],\r\n                    modalParameters: {\r\n                        title: \"Send attached documents\",\r\n                        id: \"sendEmail\"\r\n                    },\r\n                    afterLoad: function (params) {\r\n                        var input = document.getElementById(\"btnClose\");\r\n                        if (input) {\r\n                            input.style.display = \"none\";\r\n                        }\r\n                        input = document.getElementById(\"btnCloseConfirm\");\r\n                        if (input) {\r\n                            input.style.display = \"none\";\r\n                        }\r\n\r\n                        // fix for SUITE-8927\r\n                        if (params) {\r\n                            if (params.values) {\r\n                                var values = params.values;\r\n                                var labels = document.getElementsByTagName(\"label\");\r\n                                if (labels) {\r\n                                    for (var i = 0; i < labels.length; i++) {\r\n                                        var label = labels[i];\r\n                                        // fix for SUITE-8927\r\n                                        if (label.innerText !== undefined) {\r\n                                            if (values.indexOf(label.innerText) === -1) {\r\n                                                if (label.control) {\r\n                                                    label.control.checked = false;\r\n                                                    label.parentElement.style.display = \"none\";\r\n                                                } else {\r\n                                                    label.previousSibling.checked = false;\r\n                                                    label.parentElement.style.display = \"none\";\r\n                                                }\r\n\r\n                                            }\r\n                                        }\r\n                                        if (label.textContent !== undefined) {\r\n                                            if (values.indexOf(label.textContent) === -1) {\r\n                                                if (label.control) {\r\n                                                    label.control.checked = false;\r\n                                                    label.parentElement.style.display = \"none\";\r\n                                                } else {\r\n                                                    label.previousSibling.checked = false;\r\n                                                    label.parentElement.style.display = \"none\";\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    afterLoadParams: {\r\n                        values: values\r\n                    }\r\n                });\r\n            });\r\n\r\n        });\r\n\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        self.pluginUpload = $(\".ui-bizagi-render-upload-wrapper\", control).bizagiUpload({\r\n            renderReference: this,\r\n            dialogTemplate: self.renderFactory.getTemplate(\"upload.dialog\"),\r\n            properties: {\r\n                url: properties.addUrl,\r\n                xpath: properties.xpath,\r\n                idRender: properties.id,\r\n                xpathContext: self.getXpathContext() || properties.xpathContext,\r\n                idPageCache: properties.idPageCache,\r\n                idSession: properties.sessionId,\r\n                validExtensions: properties.validExtensions,\r\n                maxSize: properties.maxSize,\r\n                contexttype: properties.contexttype,\r\n                networkSpeed: networkSpeed()\r\n            },\r\n            onUploadFileCompletedCallback: self.onUploadFileCompleted,\r\n            onChangeFile: self.onChangeFile,\r\n            onCheckMaxSize: self.checkMaxSize,\r\n            onValidate: self.validate,\r\n            maxAllowedFiles: properties.maxfiles,\r\n            uploadedFiles: self.filesCount,\r\n            dialogTitle: self.getResource(\"render-upload-link-label\")\r\n        });\r\n\r\n        control.delegate(\".bz-btn-icn--delete\", \"click\", function () {\r\n            var item = $(this).closest(\".ui-bizagi-render-upload-item\");\r\n            var file = item.data();\r\n            $.when(self.deleteUploadItem(item, file.id)).done(function () {\r\n                // Remove item\r\n                item.hide();\r\n\r\n                // Detach item\r\n                item.remove();\r\n\r\n                // Check maxFiles\r\n                self.checkMaxFiles();\r\n\r\n                //Set Value\r\n                self.setValue(self.files, false);\r\n\r\n                // Trigger change\r\n                self.triggerRenderChange();\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Opens a dialog in order to upload file per file\r\n     */\r\n    openUploadDialog: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var doc = window.document;\r\n\r\n        // Reset Flag\r\n        self.isClicked = false;\r\n\r\n        var dialogBox = self.dialogBox = $(\"<div class='ui-bizagi-component-loading'/>\");\r\n        dialogBox.empty();\r\n        dialogBox.appendTo(\"body\", doc);\r\n\r\n        // Define buttons\r\n        var buttons = {};\r\n\r\n        // Select button\r\n        buttons[self.getResource(\"render-upload-dialog-select\")] = function (e) {\r\n            e.stopPropagation();\r\n            if (!self.isClicked) {\r\n                self.isClicked = true;\r\n                if (self.checkMaxSize() && self.checkFileTypes() && !self.maxFilesLimit()) {\r\n                    $.when(self.processUploadFile()).done(function (data) {\r\n                        self.onUploadFileCompleted(data);\r\n                        self.closeUploadDialog();\r\n                    });\r\n                } else {\r\n                    self.isClicked = false;\r\n                }\r\n            }\r\n        };\r\n\r\n        // Cancel button\r\n        buttons[self.getResource(\"text-cancel\")] = function () {\r\n            self.closeUploadDialog();\r\n        };\r\n\r\n        // Creates a dialog\r\n        dialogBox.dialog({\r\n            width: 500,\r\n            height: 350,\r\n            title: self.getResource(\"render-upload-link-label\"),\r\n            modal: true,\r\n            buttons: buttons,\r\n            close: function () {\r\n                self.closeUploadDialog();\r\n            },\r\n            resizeStop: function (event, ui) {\r\n                if (self.form) {\r\n                    self.form.resize(ui.size);\r\n                }\r\n            }\r\n        });\r\n\r\n        // Render template\r\n        var dialogTemplate = self.renderFactory.getTemplate(\"upload.dialog\");\r\n        $.tmpl(dialogTemplate, {\r\n            url: properties.addUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            idSession: properties.sessionId,\r\n            validExtensions: properties.validExtensions.replace(\";\", \",\"),\r\n            maxSize: properties.maxSize,\r\n            contexttype: properties.contexttype\r\n        }).appendTo(dialogBox);\r\n        $(\".ui-bizagi-loading-message\").remove();\r\n    },\r\n\r\n    /**\r\n     * Process an upload file into the server\r\n     * @returns {*}\r\n     */\r\n    processUploadFile: function () {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n        var dialogBox = self.dialogBox;\r\n        var uploadForm = $(\"form\", dialogBox);\r\n        var uploadIFrame = $(\"iframe\", uploadForm);\r\n\r\n        // When the iframe loads the user we need to evaluate the response and close the dialog\r\n        var timeoutFn = function () {\r\n            try {\r\n                var response = \"\";\r\n                if (uploadIFrame[0].contentWindow) {\r\n                    var iframeContent = bizagi.util.isIE8() ? $(uploadIFrame[0].contentWindow.document.body)\r\n                        : $(uploadIFrame[0].contentWindow.eval(\"document.body\"));\r\n\r\n                    response = iframeContent.text();\r\n                }\r\n                if (response.length > 0) {\r\n                    defer.resolve(response);\r\n                } else {\r\n                    setTimeout(timeoutFn, 50);\r\n                }\r\n            } catch (e) {\r\n                // Nothing todo, just close the window and show error message\r\n                self.closeUploadDialog();\r\n                window.alert(\"Error:\" + e.toString());\r\n            }\r\n        };\r\n\r\n        // Execute the timed function in order to check when the response has arrived\r\n        timeoutFn();\r\n\r\n        // Submit the form\r\n        uploadForm.submit();\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Close the upload dialog\r\n     */\r\n    closeUploadDialog: function () {\r\n        var self = this;\r\n        self.isClicked = false;\r\n        self.dialogBox.dialog(\"destroy\");\r\n        self.dialogBox.remove();\r\n    },\r\n\r\n    /**\r\n     * Verify if control reached maximum number of files\r\n     */\r\n    maxFilesLimit: function () {\r\n        return this.filesCount >= this.properties.maxfiles;\r\n    },\r\n\r\n    /**\r\n     * Check if the max files condition is true to hide the upload link\r\n     */\r\n    checkMaxFiles: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n        var uploadField = $(\".ui-bizagi-render-upload-wrapper\", control);\r\n\r\n        if (self.maxFilesLimit()) {\r\n            //Hide upload element             \r\n            bizagi.util.cssExtended(uploadField.find(\"a\"), \"display:none!important\");\r\n\r\n            //Disable the control, to prevent further click events\r\n            self.enabled = false;\r\n\r\n        } else {\r\n            // show upload element\r\n            bizagi.util.cssExtended(uploadField.find(\"a\"), \"display:block!important\");\r\n\r\n            //Enable the control, to prevent further click events\r\n            self.enabled = true;\r\n        }\r\n\r\n        //Checks if the files count is equals to 0, to show the no files dialog\r\n        if (self.filesCount == 0) {\r\n            $(\".no-files\", control).css(\"display\", \"block\");\r\n        } else {\r\n            $(\".no-files\", control).hide();\r\n        }\r\n    },\r\n\r\n    onChangeFile: function (files) {\r\n        var self = this;\r\n        var i = 0;\r\n        var length;\r\n        var file;\r\n        var maxSize = self.properties.maxSize;\r\n\r\n        if (files) {\r\n\r\n            length = files.length;\r\n\r\n            for (; i < length;) {\r\n\r\n                file = files[i++];\r\n\r\n                if (file.size > maxSize) {\r\n                    self.previousCheck = false;\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n\r\n        self.previousCheck = true;\r\n    },\r\n\r\n    /**\r\n     * Resolves default value align for each display type\r\n     * @param displayType\r\n     * @returns {string}\r\n     */\r\n    getDefaultValueAlign: function () {//displayType is not more important for align values \r\n        return \"\";\r\n    },\r\n\r\n    /**\r\n     * Handler to process server response after a file has been uploaded\r\n     * @param renderReference\r\n     * @param response\r\n     */\r\n    onUploadFileCompleted: function (renderReference, response) {\r\n        var self = renderReference;\r\n        var control = self.getControl();\r\n        var uploadWrapper = $(\".ui-bizagi-render-upload-wrapper\", control);\r\n\r\n        // Pre-parse response because in IE sometimes the server returns the JSON enclosed with some weird <FONT> tags\r\n        response = response.replace(/<.+>({.*})\\r?\\n?.*<.+>/gm, \"$1\");\r\n\r\n        // Check if previous call return a valid json\r\n        try {\r\n            var result = JSON.parse(response);\r\n        } catch (e) {\r\n            // Invalid json, try to catch error response\r\n            var errorList = [\r\n                {\r\n                    toFind: \"Maximum request length\",\r\n                    message: self.getResource(\"render-upload-alert-maxsize\").replace(\"{0}\", self.properties.maxSize)\r\n                }\r\n            ];\r\n\r\n            $.each(errorList, function (key, validation) {\r\n                if (response.indexOf(validation.toFind) >= 0 && !result) {\r\n                    result = {type: \"error\", message: validation.message};\r\n                }\r\n            });\r\n\r\n            if (!result) {\r\n                // Dont mapped \r\n                result = {type: \"error\", message: \"Error:\" + result};\r\n            }\r\n        }\r\n\r\n        if (result.type != \"error\") {\r\n            // Locate it before the upload wrapper\r\n            var newItem = self.renderUploadItem({id: result.id, fileName: result.fileName});\r\n            $(newItem).insertBefore(uploadWrapper);\r\n\r\n            self.processControlLayout(self.properties.valueFormat);\r\n\r\n            // Increment counter\r\n            self.filesCount = self.filesCount + 1;\r\n\r\n            //Copy the files value but not its reference\r\n            var files = self.files.slice();\r\n\r\n            //Add the new item to this temporal array\r\n            files.push([result.id, result.fileName]);\r\n\r\n            // Check maxFiles\r\n            self.checkMaxFiles();\r\n            //Set Value\r\n            self.setValue(files, false);\r\n\r\n\r\n            // Trigger change\r\n            self.triggerRenderChange();\r\n\r\n            if (typeof (self.grid) != \"undefined\" && typeof (self.grid.properties) != \"undefined\") {\r\n                self.grid.properties.canBeExported = true;\r\n            }\r\n        } else {\r\n\r\n            //HTTP Error 404.13 is launched when the max file size configurated for iis is reached. the Request to the server is blocked \r\n            if (result.message === \"Error:undefined\" && response.indexOf(\"HTTP Error 404.13\") > -1)\r\n                result.message = self.getResource(\"render-upload-iis-maxsize\");\r\n            // Show server error\r\n            bizagi.showMessageBox(result.message);\r\n        }\r\n    },\r\n\r\n    //#region Render-Base    \r\n\r\n    changeFontItalic: function ($element, italic) {\r\n\r\n        this._super($element, italic);\r\n\r\n        if ($element.hasClass(\"ui-bizagi-render-control\") && bizagi.util.parseBoolean(italic)) {\r\n            this.getElementsToStylize(control).css(\"padding\", \"0 .1em\");\r\n        }\r\n\r\n        return this;\r\n    },\r\n\r\n    getElementsToStylize: function (context) {\r\n        return $(\".ui-bizagi-render-upload-item .bz-file-name, .no-files\", context);\r\n    },\r\n\r\n    //#endregion\r\n\r\n    /**\r\n     * checkMaxSize\r\n     * @param {object} renderReference\r\n     */\r\n    checkMaxSize: function (renderReference) {\r\n        var self = renderReference;\r\n        var properties = self.properties;\r\n        var dialogBox = self.dialogBox;\r\n        var fileControl = $(\"input[type=file]\", dialogBox).get(0);\r\n\r\n        // Dont exist any fucking way to know file size in IEx, just skip this validation\r\n        if (fileControl.files != undefined) {\r\n            if (fileControl.files.length > 0) {\r\n                if (fileControl.files[0].size === 0) {\r\n                    self.showError(self.getResource(\"render-upload-error-file-empty\")\r\n                        .replace(\"%s\", fileControl.files[0].name));\r\n                    return false;\r\n                }\r\n                if (fileControl.files[0].size > properties.maxSize) {\r\n                    self.showError(self.getResource(\"render-upload-alert-maxsize\").replace(\"{0}\", properties.maxSize));\r\n                    return false;\r\n                }\r\n                return true;\r\n            } else {\r\n                self.showError(self.getResource(\"render-required-upload\").replace(\"#label#\", \"\"));\r\n                return false;\r\n            }\r\n        } else {\r\n            if (bizagi.util.isIE()) {\r\n                if (fileControl.value === \"\" || !fileControl.value) {\r\n                    self.showError(self.getResource(\"render-required-upload\").replace(\"#label#\", \"\"));\r\n                    return false;\r\n                } else {\r\n                    if (self.previousCheck) {\r\n                        return true;\r\n                    } else {\r\n                        if (document.documentMode > 9) {\r\n                            self.showError(self.getResource(\"render-upload-alert-maxsize\")\r\n                                .replace(\"{0}\", properties.maxSize));\r\n                            return false;\r\n                        } else {\r\n                            return true;\r\n                        }\r\n                    }\r\n                }\r\n            } else {\r\n                return true;\r\n            }\r\n        }\r\n    },\r\n\r\n    checkFileTypes: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var dialogBox = self.dialogBox;\r\n        var file = $(\"input[type=file]\", dialogBox).val();\r\n\r\n        if (properties.validExtensions && properties.validExtensions.length > 0) {\r\n            var validExtensions = properties.validExtensions.replaceAll(\"*.\", \"\").split(\";\");\r\n            if (!self.stringEndsWithValidExtension(file, validExtensions, true)) {\r\n                self.showError(self.getResource(\"render-upload-allowed-extensions\") + properties.validExtensions);\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * Additional validations\r\n     * @param renderReference\r\n     * @returns {boolean}\r\n     */\r\n    validate: function (renderReference) {\r\n        var self = renderReference;\r\n        var properties = self.properties;\r\n        var fileControl = $(\"input[type=file]\", self.dialogBox).get(0) || {};\r\n\r\n        //Verifies that the file name is not repeated\r\n        if (self.files) {\r\n            for (var i = 0; i < self.files.length; i++) {\r\n                var fileName = self.files[i][1];\r\n                if (fileName.toUpperCase() == fileControl.files[0].name.toUpperCase()) {\r\n                    self.showError(self.getResource(\"render-upload-error-file-exists\"));\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    stringEndsWithValidExtension: function (stringToCheck, acceptableExtensionsArray, required) {\r\n        if (required == false && stringToCheck.length == 0) return true;\r\n\r\n        for (var i = 0; i < acceptableExtensionsArray.length; i++) {\r\n            if (acceptableExtensionsArray[i].toLowerCase() == \"*\") return true\r\n            if (stringToCheck.toLowerCase().endsWith(acceptableExtensionsArray[i].toLowerCase())) return true;\r\n        }\r\n\r\n        return false;\r\n    },\r\n\r\n    showError: function (message) {\r\n        var self = this;\r\n        var errorContainer = $(\"#alert-file-upload\", self.dialogBox);\r\n\r\n        // Empty container\r\n        errorContainer.empty();\r\n        errorContainer.show();\r\n\r\n        errorContainer.html(message);\r\n    },\r\n\r\n    /**\r\n     * Cleans current value\r\n     */\r\n    cleanData: function () {\r\n        var self = this;\r\n\r\n        self.setValue(null);\r\n        self.clearDisplayValue();\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     */\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        var arrayItems = control.find(\".ui-bizagi-render-upload-item\");\r\n        var length = arrayItems.length - 1;\r\n\r\n        $.each(arrayItems, function (index, value) {\r\n            var item = $(value);\r\n            var file = item.data();\r\n\r\n            if (file) {\r\n                $.when(self.deleteUploadItem(item, file.id)).done(function () {\r\n                    // Detach item\r\n                    item.remove();\r\n\r\n                    // Trigger change\r\n                    self.triggerRenderChange();\r\n                });\r\n            }\r\n        });\r\n\r\n        // Remove items\r\n        arrayItems.hide();\r\n\r\n        // Check maxFiles\r\n        self.filesCount = 0;\r\n        self.checkMaxFiles();\r\n\r\n    },\r\n\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties, control, item;\r\n\r\n        if (properties.editable) {\r\n            if (value && value.length === 0) {\r\n                control = self.getControl();\r\n                item = control.find(\".ui-bizagi-render-upload-item\");\r\n                item.hide();\r\n                item.remove();\r\n                self.checkMaxFiles();\r\n            }\r\n        }\r\n\r\n        self._super(value);\r\n    },\r\n\r\n    getLabel: function(){\r\n        return $(\"label\", this._super());\r\n    }\r\n\r\n});","/**\r\n * Description of file\r\n * @author: Jeison Borja\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.getUser\", bizagi.rendering.getUser.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.getUser.extend(\"bizagi.rendering.desktop.getUser\", {}, {\r\n    \r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var opt = {};\r\n        self.input = $(\".ui-bizagi-render-text\", self.getControl());\r\n\r\n        if (self.properties.value != null && self.properties.value.length > 0) {\r\n            self.setDisplayValue(self.properties.value[0]);\r\n        }\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        self.bindSearchUserPlugin(control);\r\n        $('#btn-clear-user', control).on('click', function () {\r\n            self.clearValue();\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Set display value\r\n     */\r\n    setDisplayValue: function (data, triggerEvents) {\r\n        var self = this;\r\n        triggerEvents = triggerEvents == false ? triggerEvents : true;\r\n        var value = (typeof (data) !== \"undefined\") ? data.value : null;\r\n\r\n        if (self.properties.editable) {\r\n            self.input.val(value);\r\n        }\r\n\r\n        self.setValue(data, triggerEvents);\r\n    },\r\n\r\n    /**\r\n     * Clear data control\r\n     */\r\n    clearValue: function () {\r\n        var self = this;\r\n\r\n        if (self.input) {\r\n            self.setDisplayValue(\"\",false);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Binds the search user plugin\r\n     */\r\n    bindSearchUserPlugin: function (control) {\r\n        var self = this;\r\n        var options = {\r\n            title: self.getResource(\"render-plugin-search-users-title\"),\r\n            maximize: false,\r\n            filters: [\"domain\", \"userName\", \"fullName\"],\r\n            displayNames: [\r\n                self.getResource(\"render-plugin-search-users-domain\"),\r\n                self.getResource(\"render-plugin-search-users-user-name\"),\r\n                self.getResource(\"render-plugin-search-users-full-name\")],\r\n            searchButtonName: self.getResource(\"render-plugin-search-users-search-button-name\"),\r\n            clearButtonName: self.getResource(\"render-plugin-search-users-clear-button-name\"),\r\n            valuesToSelect: [\"iduser\", \"user\"], //\"iduser\",\"username\",\"user\",\"domain\",\"email\"\r\n            selectItem: function () {\r\n                var deferred = $.Deferred();\r\n                deferred.done(function (data) {\r\n                    self.onItemSelectedSuccess(data);\r\n                }).fail(function (error) {\r\n                    bizagi.log(error);\r\n                });\r\n                return deferred;\r\n            },\r\n            searchUsers: function (filterData) {\r\n                if (self.properties.allowDelegatedUser) {\r\n                    return self.dataService.getUsersListFromPreferences(filterData);\r\n                } else {\r\n                    return self.dataService.getUsersListForStakeholders(filterData);\r\n                }\r\n            },\r\n            getTableTemplate: function (usersResults, currentPage, pagination, pagesArray) {\r\n                var content = self.renderFactory.getTemplate(\"bizagi.plugin.search.user\");\r\n                var usersTableTmpl = $.tmpl(content, {\r\n                    users: usersResults,\r\n                    links: [self.getResource(\"render-plugin-search-users-select-link\")],\r\n                    page: currentPage,\r\n                    pagination: pagination,\r\n                    pagesArray: pagesArray\r\n                });\r\n                return usersTableTmpl;\r\n            },\r\n            showError: function (error) {\r\n                bizagi.log(error);\r\n            },\r\n            showMessageBox: function (message) {\r\n                bizagi.showMessageBox(bizagi.localization.getResource(message), \"Bizagi\", \"warning\");\r\n            }\r\n        };\r\n\r\n        if (self.properties.allowDelegatedUser) {\r\n            options.editingUser = self.properties.idUser;\r\n        }\r\n\r\n        opt = options;\r\n\r\n        // Allows add new user when creating the pluggin\r\n        var params = self.getParams();\r\n        if (typeof params.isEntityForm !== \"undefined\" && params.isEntityForm) {\r\n            options.allowAddUser = bizagi.menuSecurity.UserAdmin || false;\r\n            options.dataService = self.dataService;\r\n            options.renderFactory = self.renderFactory;\r\n        }\r\n\r\n        $('#btn-get-user', control).bizagiSearchUser(options);\r\n    },\r\n\r\n    /**\r\n     * returns the opt var for unit testing\r\n     */\r\n    getOptions: function () {\r\n        return opt;\r\n    },\r\n    /**\r\n     *\r\n     * @param itemSelected\r\n     */\r\n    onItemSelectedSuccess: function (itemSelected) {\r\n        var self = this;\r\n        var data = {\r\n            id: itemSelected.iduser, \r\n            value: itemSelected.user \r\n        };\r\n\r\n        self.setDisplayValue(data);\r\n    },\r\n    \r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) == true && this.properties.editable) {\r\n                    control.addClass('control-required');\r\n                } else {\r\n                    control.removeClass('control-required');\r\n                }\r\n            }\r\n            else {\r\n                if (bizagi.util.parseBoolean(argument) == true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass('control-required');\r\n                } else {\r\n                    control.removeClass('control-required');\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    changeRequiredControl: function (argument) {\r\n        this.changeRequiredLabel(argument);\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Desktop Render Query Process Extension\r\n *   Author: Jeison Borja\r\n *   Comments:\r\n *   -   This script will redefine the query process render class to adjust to desktop devices\r\n */\r\n// Extends itself\r\n\r\n // Extends from render Desktop base\r\n bizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.queryProcess\", bizagi.rendering.queryProcess.prototype);\r\n // Extends itself\r\n bizagi.rendering.desktop.queryProcess.extend(\"bizagi.rendering.desktop.queryProcess\", {}, {\r\n    /*\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n    // Call base\r\n        this._super();\r\n        var template = self.renderFactory.getTemplate(\"queryProcessWrapper\");\r\n        var control = self.getControl();\r\n        self.getElement(\"row\").bind(\"click\", function(){\r\n            var wrapper = self.getWrapper();\r\n            if(wrapper.properties.visible){\r\n                wrapper.element.hide();\r\n                wrapper.element.css(\"visibility\",\"hidden\");\r\n                wrapper.element.empty();\r\n            }else{\r\n                wrapper.element.show();\r\n                wrapper.element.css(\"visibility\",\"visible\");\r\n                var data = self.loadData(\"aplications\");\r\n                self.renderData(data, wrapper.element);\r\n            }\r\n        });\r\n\r\n    },\r\n\r\n    /**\r\n     * get wrapper html and their properties\r\n     *\r\n     * @return {element: html, properties{visible:boolean}}\r\n     */\r\n    getWrapper: function(){\r\n        var self = this;\r\n        var wrapperElement = self.getElement(\"wrapper\");\r\n        var result = {\r\n            element: wrapperElement,\r\n            properties:{}\r\n        };\r\n        // Check visibility\r\n        result.properties.visible = (wrapperElement.css(\"visibility\") === \"visible\")?true: false;\r\n        return result;\r\n    },\r\n\r\n    /**\r\n     * @return {key(row|wrapper): html element}\r\n     */\r\n    getElement: function(key){\r\n        var control = this.getControl();\r\n        var objectMapper = {\r\n            row : $(\".ui-selectmenu-btn , .ui-bizagi-container-query-process :input[type=text]\", control),\r\n            wrapper: $(\".ui-selectmenu-wrapper\", control),\r\n            linkApplication: $(\".linkApplication\", control)\r\n        };\r\n\r\n        return objectMapper[key];\r\n    },\r\n\r\n    /**\r\n     * get data from server\r\n     * @return {applications:[{id:integer, appName: string},...] }\r\n     */\r\n    loadData: function(type){\r\n        if(type == \"aplications\"){\r\n            var result = {\r\n                items: [\r\n                    {\r\n                        id:1,\r\n                        displayName: \"My App 1\"\r\n                    },\r\n                    {\r\n                        id:2,\r\n                        displayName: \"My App 2\"\r\n                    },\r\n                    {\r\n                        id:3,\r\n                        displayName: \"My App 3\"\r\n                    }\r\n                ]\r\n            };\r\n        }\r\n\r\n        if(type == \"process\"){\r\n            var result = {\r\n                items: [\r\n                    {\r\n                        id:4,\r\n                        displayName: \"My Category 1\",\r\n                        process: false\r\n                    },\r\n                    {\r\n                        id:5,\r\n                        displayName: \"My Process 1\",\r\n                        process: true\r\n                    },\r\n                    {\r\n                        id:6,\r\n                        displayName: \"My Category 2\",\r\n                        process: false\r\n                    }\r\n                ]\r\n            };\r\n        }\r\n        return result;\r\n    },\r\n\r\n    /**\r\n     * Render data within canvas\r\n     * @param data\r\n     * @param canvas\r\n     */\r\n    renderData: function(data, canvas){\r\n        var self = this;\r\n        $(canvas).empty();\r\n        if(data.items[0].process===undefined){\r\n            canvas.append('<a class=\"linkApplication\" data-idcategory=\"0\" data-typeitem=\"process\"><i class=\"biz-ico biz-wp-tree-icon biz-wp-tree-image-process\"></i>All process </a>');\r\n        }\r\n        $.each(data.items, function(key,value){\r\n            canvas.append('<a class=\"linkApplication\" data-idCategory=\"'+value.id+'\"><i  name=\"app\" class=\"biz-wp-tree-icon biz-wp-tree-expand-icon\"></i><i class=\"biz-ico biz-wp-tree-icon\"></i>'+value.displayName+'</a>');\r\n            var itemElement =   $('[data-idCategory='+value.id+']',canvas);\r\n            if(value.process){\r\n                var iconProcess =   itemElement.find('i').last();\r\n                iconProcess.addClass('biz-wp-tree-image-process');\r\n                itemElement.find('i').first().remove();\r\n                itemElement.css('margin-left','25px');\r\n                itemElement.attr('data-typeItem','process');\r\n           }\r\n           else{\r\n               // item category\r\n               if(value.process==false){\r\n                   var iconCategory =   itemElement.find('i').last();\r\n                   iconCategory.addClass('biz-wp-tree-image-category');\r\n                   itemElement.attr('data-typeItem','category');\r\n               }\r\n               else{\r\n                   //item application\r\n                   var iconApp =   itemElement.find('i').last();\r\n                   iconApp.addClass('biz-wp-tree-image-application');\r\n                   itemElement.attr('data-typeItem','app');\r\n               }\r\n               var idParent   = ($(canvas).attr('class')!=\"ui-selectmenu-wrapper\") ? $(canvas).attr('id').replace('category_','') : \"\";\r\n               var idContCategory   = (idParent!=\"\") ? \"category_\"+idParent+\"-\"+value.id : \"category_\"+value.id;\r\n               canvas.append(\"<div class='ui-bizagi-contCategory' id='\"+idContCategory+\"'></div>\");\r\n           }\r\n        });\r\n        self.setupLinks(canvas);\r\n    },\r\n\r\n    setupLinks: function(canvas){\r\n        var self = this;\r\n        $(\".linkApplication\", canvas).on(\"click\", function(){\r\n            var idCategory      = $(this).attr(\"data-idCategory\");\r\n            var idParent   = ($(canvas).attr('class')!=\"ui-selectmenu-wrapper\") ? $(canvas).attr('id').replace('category_','') : \"\";\r\n            var elementRender   = (idParent!=\"\") ? $(\"#category_\"+idParent+\"-\"+idCategory) : $(\"#category_\"+idCategory);\r\n            if($(this).attr('data-typeItem')=='process'){\r\n                var processSelect   =   $(this).text();\r\n                var wrapper  =   self.getWrapper();\r\n                wrapper.element.hide();\r\n                wrapper.element.css(\"visibility\",\"hidden\");\r\n                var parentType  = '';\r\n                var item        = this;\r\n                var routeProcess= [];\r\n                if($(this).attr(\"data-idcategory\")>0){\r\n                    while (parentType != \"app\" ||parentType == null) {\r\n                        item = $(item).closest('div').prev();\r\n                        parentType = item[0].getAttribute(\"data-typeItem\");\r\n                        routeProcess.push(item.text());\r\n                    }\r\n                }\r\n                wrapper.element.empty();\r\n                routeProcess = routeProcess.reverse().join(\" > \");\r\n                routeProcess = (routeProcess==\"\")?processSelect: routeProcess+=  ' > '+processSelect;\r\n\r\n                $('.ui-bizagi-container-query-process :input[type=text]').val(routeProcess);\r\n            }\r\n            else{\r\n                var iconProcess =    $(this).find('i').first();\r\n                if(elementRender.css(\"visibility\") === \"visible\"){\r\n                    iconProcess.addClass('biz-wp-tree-expand-icon');\r\n                    iconProcess.removeClass('biz-wp-tree-collapse-icon');\r\n                    elementRender.hide();\r\n                    elementRender.css(\"visibility\",\"hidden\");\r\n                    elementRender.empty();\r\n                }\r\n                else{\r\n                    var data        = self.loadData(\"process\");\r\n                    iconProcess.removeClass('biz-wp-tree-expand-icon');\r\n                    iconProcess.addClass('biz-wp-tree-collapse-icon');\r\n                    elementRender.show();\r\n                    elementRender.css(\"visibility\",\"visible\");\r\n                    self.renderData(data, elementRender);\r\n                }\r\n            }\r\n        });\r\n    }\r\n});","/*\r\n *   Name: BizAgi Render Query Search User\r\n *   Author: Jeison Borja\r\n *   Comments:\r\n *   -   This script will define desktop stuff for query search user renders\r\n *   Modified by: Andrs F. Muoz\r\n *   Comments:\r\n *   - This control Implemments the search users plugin\r\n */\r\n\r\n // Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.querySearchUser\", bizagi.rendering.querySearchUser.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.querySearchUser.extend(\"bizagi.rendering.desktop.querySearchUser\", {}, {\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        // Call base\r\n        self.input = $(\".ui-bizagi-render-text\", self.getControl());\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function (value) {\r\n        if (typeof value === \"object\"){\r\n            if(typeof value[0] === \"object\" && value[0].label !== undefined){\r\n                value = value[0].label;\r\n            }\r\n            else{\r\n                value = value.label;\r\n            }\r\n        }\r\n        else{\r\n            value = '';\r\n        }\r\n\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        // Call base\r\n        this._super(value);\r\n\r\n        // Set value in input\r\n        if (!bizagi.util.isEmpty(value) && properties.editable) {\r\n            self.input.val(value);\r\n        }\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        self.bindSearchUserPlugin(control);\r\n    },\r\n\r\n    /*\r\n     * Binds the search user plugin\r\n     */\r\n    bindSearchUserPlugin: function (control) {\r\n        var self = this;\r\n        var options = {\r\n            title: self.getResource(\"render-plugin-search-users-title\"),\r\n            filters:[\"domain\", \"userName\",\"fullName\"],\r\n            displayNames:[\r\n                self.getResource(\"render-plugin-search-users-domain\"),\r\n                self.getResource(\"render-plugin-search-users-user-name\"),\r\n                self.getResource(\"render-plugin-search-users-full-name\")],\r\n            searchButtonName: self.getResource(\"render-plugin-search-users-search-button-name\"),\r\n            clearButtonName: self.getResource(\"render-plugin-search-users-clear-button-name\"),\r\n            valuesToSelect: [\"iduser\",\"username\"],//\"iduser\",\"username\",\"user\",\"domain\",\"email\"\r\n            selectItem: function(){\r\n                var deferred = $.Deferred();\r\n                deferred.done(function (data) {\r\n                    self.onItemSelectedSuccess(data);\r\n                }).fail(function (error) {\r\n                    bizagi.log(error);\r\n                });\r\n                return deferred;\r\n            },\r\n            searchUsers: function(filterData){\r\n                return self.dataService.getUsersList(filterData);\r\n            },\r\n            getTableTemplate: function(usersResults,currentPage,pagination,pagesArray){\r\n                var content = self.renderFactory.getTemplate(\"bizagi.plugin.search.user\");\r\n                var usersTableTmpl = $.tmpl(content, { users: usersResults, links: [self.getResource(\"render-plugin-search-users-select-link\")], page: currentPage, pagination: pagination, pagesArray: pagesArray });\r\n                return usersTableTmpl;\r\n            },\r\n            showError: function(error){\r\n                bizagi.log(error);\r\n            },\r\n            showMessageBox: function(message){\r\n                bizagi.showMessageBox(bizagi.localization.getResource(message), \"Bizagi\", \"warning\");\r\n            }\r\n        };\r\n\r\n        opt = options;\r\n\r\n        $('#btn-get-user',control).bizagiSearchUser(options);\r\n    },\r\n    /*\r\n    * returns the opt var for unit testing\r\n    * */\r\n    getOptions: function(){\r\n        return opt;\r\n    },\r\n\r\n    onItemSelectedSuccess: function(itemSelected){\r\n        var self = this;\r\n        var control = self.getControl();\r\n        $(\".ui-bizagi-render-text\",control).val(itemSelected.username);\r\n        var item = {};\r\n        item.id = itemSelected.iduser;\r\n        item.label = itemSelected.username;\r\n        item.value = itemSelected.username;\r\n        self.setValue(item);\r\n    }\r\n});","/*\r\n *   Name: Bizagi Render ComboSelected class\r\n *   Author: Paola Herrera\r\n *   Comments:\r\n *   -   This script will define basic stuff for comboSelected renders\r\n */\r\n\r\n  // Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.comboSelected\", bizagi.rendering.comboSelected.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.comboSelected.extend(\"bizagi.rendering.desktop.comboSelected\", {}, {\r\n\r\n    /*\r\n    * Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {\r\n        // Call base\r\n        this._super();\r\n        var control = this.getControl();\r\n\r\n        // Value data into selectedItemsToUpdate\r\n        this.showInitialData(this.properties.value);\r\n\r\n        //Show initial value or nothing\r\n        if (this.selectedItemsToUpdate.length >= 0) {\r\n            $.each(this.selectedItemsToUpdate, function (index, value) {\r\n                $(\"#listBoxComboData\", control).append(\"<option value='\" + value.id + \"'>\" + value.value + \" </option>\");\r\n            });\r\n        }\r\n\r\n        $(control).closest(\".ui-bizagi-render-control\").addClass(\"ui-bizagi-render-comboselected\")\r\n    },\r\n\r\n    orderArrayList: function () {\r\n        var arrayOrderList = this.properties.value;\r\n        var orderList = arrayOrderList.sort(function (a, b) {\r\n\r\n            var nA = (a.value !== undefined && a.value !== null) ? a.value.toLowerCase() : \"\";\r\n            var nB = (b.value !== undefined && b.value !== null) ? b.value.toLowerCase() : \"\";\r\n\r\n            if (nA < nB)\r\n                return -1;\r\n            else if (nA > nB)\r\n                return 1;\r\n            return 0;\r\n        });\r\n        this.properties.value = orderList;\r\n    },\r\n\r\n    /*\r\n    * Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        //Event to move right the elements\r\n        $(\"#move_right\", control).click(function (e) {\r\n        //if(self.selectedItemsToUpdate.length == 0) self.showListBoxComboData();\r\n            self.addItem();\r\n            var input = $(\"#bz-render-comboSelected-listBoxResults .ui-bizagi-render-text\", control);\r\n            self.filterFunction(input.val(), self.rightValues, $(\"#bz-render-comboSelected-listBoxResults select\", control));\r\n            input.focus();\r\n        });\r\n\r\n        //Event to move left the elements\r\n        $(\"#move_left\", control).click(function (e) {\r\n            self.removeItem();\r\n            var input = $(\"#bz-render-comboSelected-selectOptions .ui-bizagi-render-text\", control);\r\n            self.filterFunction(input.val(),  self.leftValues, $(\"#bz-render-comboSelected-selectOptions select\", control));\r\n            input.focus();\r\n        });\r\n\r\n        $(\"#bz-render-comboSelected-selectOptions .ui-bizagi-render-text\", control).bind(\"keyup input\", function (e) {\r\n            self.filterFunction(this.value, self.leftValues, $(\"#bz-render-comboSelected-selectOptions select\", control));\r\n        });\r\n\r\n        $(\"#bz-render-comboSelected-listBoxResults .ui-bizagi-render-text\", control).bind(\"keyup input\", function (e) {\r\n            self.filterFunction(this.value, self.rightValues, $(\"#bz-render-comboSelected-listBoxResults select\", control));\r\n        });\r\n    },\r\n\r\n    filterFunction: function(filter, list, selectInput) {\r\n        var self = this;\r\n        $(selectInput).empty();\r\n        //Add the values thath match\r\n        $.each(list, function(i, value){\r\n            var index = value.value.toUpperCase().indexOf(filter.toUpperCase());\r\n            if (index !== -1) {\r\n                self.binaryInsert(value, selectInput);\r\n            }\r\n        });\r\n    },\r\n    /**\r\n     * Return the index of the found item, if no item found it return the bitwise index.\r\n     * @param {Object} item - Item to search.\r\n     * @param {Number} item.id - ID item to search.\r\n     * @param {String} item.value - Value item to search.\r\n     * @param {Object} array - jQuery selection of <select>, with <option>'s array.\r\n     */\r\n    binarySearch: function(item, array) { \r\n        var left = 0, right = array.children().length - 1, middle, current;\r\n        while (left <= right) {\r\n            middle = (left + right) >>> 1;\r\n            current = array.children()[middle].text;\r\n            if (item.value > current) {\r\n                left = middle + 1;\r\n            } else if (item.value < current) {\r\n                right = middle - 1;\r\n            } else {\r\n                return middle;\r\n            }\r\n        }\r\n        return ~left;\r\n    },\r\n    /**\r\n     * Inserts an item into the array in alphabetical order\r\n     * @param {Object} item - Item to insert.\r\n     * @param {Number} item.id - ID item to insert.\r\n     * @param {String} item.value - Value item to insert.\r\n     * @param {Object} array - jQuery selection with the <select> to append the item.\r\n     */\r\n    binaryInsert: function(item, array) {\r\n        var element = $(\"<option value='\" + item.id + \"'>\" + item.value + \" </option>\");\r\n        var index = this.binarySearch(item, array);\r\n        if (index < 0) {\r\n            index = ~index;\r\n        }\r\n        if (array.children().length !== 0 && index < array.children().length) {\r\n            array.find(\"option:eq(\"+ index +\")\").before(element);\r\n        } else {\r\n            array.append(element);\r\n        }\r\n        return index;\r\n    },\r\n\r\n    changeRequired: function(argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function(argument) {\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) == true && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) == true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"control-required\");\r\n                } else {\r\n                    control.removeClass(\"control-required\");\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    /*\r\n    * Override display value\r\n    */\r\n    setDisplayValue: function (value) {\r\n        // Set internal value\r\n        this.setValue(value, false);\r\n    },\r\n\r\n    /*\r\n    * Add item to listBoxComboData and selectedItemsToUpdate array\r\n    */\r\n    addItem: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var dataSelected = $(\"#selectionData option:selected\", control);\r\n        var dataResults = $(\"#listBoxComboData\", control);\r\n        $.each(dataSelected, function(i, item) {\r\n            var newItem = {\r\n                id: parseInt(item.value),\r\n                value: item.text\r\n            };\r\n            var inArray = $.grep(self.selectedItemsToUpdate, function(e) {\r\n                return e.id == newItem.id;\r\n            })\r\n            if (inArray.length <= 0) {\r\n                self.binaryInsert(newItem, dataResults);\r\n                self.selectedItemsToUpdate.push(newItem);\r\n\r\n                self.rightValues.push(newItem);\r\n                self.leftValues =  $.grep(self.leftValues, function(el){\r\n                    return el.id != newItem.id;\r\n                });\r\n            }\r\n        });\r\n        dataSelected.remove();\r\n        self.setValue(self.selectedItemsToUpdate);\r\n    },\r\n\r\n    /*\r\n    * Remove item from listBoxComboData and selectedItemsToUpdate array\r\n    */\r\n    removeItem: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        var dataSelectedToRemove = $(\"#listBoxComboData option:selected\", control);\r\n        var dataOptions = $(\"#selectionData\", control);\r\n\r\n        $.each(dataSelectedToRemove, function (i, item) {\r\n            var removeItem = { \r\n                id: parseInt(item.value),\r\n                value: item.text\r\n            };\r\n            var inArray = $.grep(dataOptions, function (e) {\r\n                return e.id == removeItem.id;\r\n            });\r\n            if (inArray.length <= 0) {\r\n                self.binaryInsert(removeItem, dataOptions);\r\n                self.leftValues.push(removeItem);\r\n                self.rightValues = $.grep(self.rightValues, function (e) {\r\n                    return e.id != removeItem.id;\r\n                });\r\n\r\n                self.selectedItemsToUpdate = $.grep(self.selectedItemsToUpdate, function (e) {\r\n                    return e.id != removeItem.id;\r\n                });\r\n            }\r\n        });\r\n\r\n        dataSelectedToRemove.remove();\r\n        self.setValue(self.selectedItemsToUpdate);\r\n    },\r\n\r\n    /*\r\n    * Show listBoxComboData and move_left button from control view\r\n    */\r\n    showListBoxComboData: function () {\r\n        var control = this.getControl();\r\n        $(\"#move_left\", control).show();\r\n        $(\"#bz-render-comboSelected-listBoxResults\", control).show();\r\n    },\r\n\r\n    /*\r\n    *   Sets the value in the rendered control\r\n    */\r\n    showInitialData: function (val) {\r\n        var self = this;\r\n        self.orderArrayList();\r\n        self.selectedItemsToUpdate = [];\r\n\r\n        if (!!val) {\r\n            $.each(val, function (index, value) {\r\n                self.selectedItemsToUpdate.push({\r\n                    id: value.id,\r\n                    value: value.value\r\n                });\r\n            });\r\n        }\r\n    },\r\n\r\n    renderReadOnly: function(){\r\n        var htmlControl = this.renderFactory.getTemplate(\"render-comboSelectedReadOnly\");\r\n        this.showInitialData(this.properties.value);\r\n        return $.fasttmpl(htmlControl, { datasource: this.selectedItemsToUpdate });\r\n    },\r\n\r\n    /*\r\n    * Has Value\r\n    */\r\n    hasValue: function () {\r\n        var data =  (typeof this.value === \"string\")? JSON.parse(this.value).value: this.value;\r\n        return !bizagi.util.isEmpty(data);\r\n    },\r\n\r\n    /*\r\n    *   Sets the internal value\r\n    */\r\n    setValue: function (value, triggerEvents) {\r\n        // Set previous value\r\n        this.properties.previousValue = this.properties.originalValue = JSON.stringify({ \"value\": this.value });\r\n\r\n        // Change internal value\r\n        this.value = this.properties.value = JSON.stringify({ \"value\": value });\r\n\r\n        if (this.properties.required && this.getMode() == \"execution\") {\r\n\r\n            if (this.checkRequired([])) {\r\n                this.changeRequiredLabel(false);\r\n            } else {\r\n                this.changeRequiredLabel(true);\r\n            }\r\n        }\r\n\r\n        triggerEvents = triggerEvents !== undefined ? triggerEvents : true;\r\n        // Trigger events\r\n        if (triggerEvents && !this.internalSetInitialValueFlag) {\r\n            this.triggerRenderChange();\r\n            this.triggerRenderValidate();\r\n        }\r\n    }\r\n});","/**\r\n *   Name: Bizagi Rendering Users Form\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script override rendering.form to create and update users\r\n */\r\n\r\n// Extends from container desktop form base\r\nbizagi.rendering.desktop.form.extend(\"bizagi.rendering.desktop.usersForm\", {}, {\r\n\r\n    init: function (params) {\r\n\r\n        var self = this;\r\n\r\n        // Set observable element\r\n        this.form = this.getFormContainer();\r\n        this.observableElement = $({});\r\n        this.collectedValues = {};\r\n        self._super(params);\r\n    },\r\n\r\n    /*\r\n    * Reimplement loading for users form\r\n    */\r\n    startLoading: function () {\r\n        var self = this;\r\n        var waitingTemplate = self.renderFactory.getTemplate(\"form-waiting\");\r\n\r\n        if (self.waitingOverlay && self.waitingMessage)\r\n            return;\r\n\r\n        var $canvas = $(self.params.canvas).closest(\".ui-dialog\");\r\n        var position = $canvas.offset();\r\n\r\n        self.waitingOverlay = $('<div class=\"ui-widget-overlay\" />').appendTo($canvas);\r\n        self.waitingMessage = $.tmpl(waitingTemplate).appendTo($('body', $(document)));\r\n\r\n        self.waitingMessage.css({\r\n            \"top\": position.top + (Math.ceil(($canvas.height() - self.waitingMessage.outerHeight()) / 2)) + \"px\",\r\n            \"left\": position.left + (Math.ceil(($canvas.width() - self.waitingMessage.outerWidth()) / 2)) + \"px\"\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Method to process button actions in the form\r\n    */\r\n    processButtons: function () {\r\n        var self = this;\r\n        var buttons = self.getButtons();\r\n\r\n        // Don't process buttons if they are undefined in the template\r\n        if (!buttons || buttons.length == 0) {\r\n            return;\r\n        }\r\n\r\n        if (self.properties.orientation == \"rtl\") {\r\n            self.buttons.reverse();\r\n        }\r\n\r\n        // Attach a handler for each button\r\n        buttons.click(function () {\r\n            var button = $(this);\r\n            var ordinal = button.attr(\"ordinal\");\r\n            var buttonProperties = self.buttons[ordinal];\r\n\r\n            // Execute button\r\n            self.processButton(buttonProperties);\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Reimplement process button actions in users forms\r\n    */\r\n    processButton: function (buttonProperties) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // First hide and clear validation box\r\n        self.validationController.clearValidationMessages();\r\n\r\n        $.when(self.ready()).done(function () {\r\n\r\n            var params = {\r\n                formAction: \"cancel\",\r\n                sendMail: false\r\n            };\r\n            switch (buttonProperties.action) {\r\n                case \"save\":\r\n\r\n                    var sendMailControl = self.form.getRender('sendMail');\r\n                    var passwordControl = self.form.getRender('password');\r\n\r\n                    var params = {\r\n                        formAction: \"save\",\r\n                        sendMail: (sendMailControl && sendMailControl.getValue()) || false,\r\n                        password: passwordControl === null ? \"\" : passwordControl.getValue()\r\n                    };\r\n\r\n                    if (sendMailControl && passwordControl && params.sendMail && params.password === \"\") {\r\n                        $.when(self.dataService.getConfiguration()).done(function (response) {\r\n                            if (response.redirectErrorPage) {\r\n                                window.location.href = response.redirectErrorPage;\r\n                                return;\r\n                            }\r\n\r\n                            var minLength = response.passwordMinLength;\r\n                            var maxLength = response.passwordMaxLength;\r\n                            self.generateRandomPassword(passwordControl, minLength, maxLength);\r\n                            params.password = passwordControl.getValue();\r\n                            self.processSave(params);\r\n                        }).fail(function (response) {\r\n                            self.generateRandomPassword(passwordControl, 8, 12);\r\n                            params.password = passwordControl.getValue();\r\n                            self.processSave(params);\r\n\r\n                            var obj = JSON.parse(response.responseText)\r\n                            self.validationController.showValidationMessage(obj.message);\r\n                        });\r\n                    } else {\r\n                        self.processSave(params);\r\n                    }\r\n                    break;\r\n                case \"cancel\":\r\n                    self.triggerHandler(\"endUsersForm\", params);\r\n                    break;\r\n            }\r\n\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Process save actions\r\n    */\r\n    processSave: function (params) {\r\n\r\n        var self = this;\r\n\r\n        // validate the form\r\n        var valid = self.validationController.performValidations();\r\n\r\n        if (valid) {\r\n            self.startLoading();\r\n\r\n            var saveDeferred;\r\n            $.extend(self.collectedValues, self.collectRenderValuesForSubmit());\r\n\r\n            var userFormData = {\r\n                action: \"SAVEUSER\",\r\n                contexttype: \"entity\",\r\n                data: {},\r\n                idPageCache: self.idPageCache\r\n            };\r\n\r\n            delete self.collectedValues.sendMail;\r\n            delete self.collectedValues['@Metadata.Stakeholders'];\r\n\r\n            if (self.params.action === \"add\") {\r\n                saveDeferred = self.createUser(userFormData, params);\r\n            }\r\n            else if (self.params.action === \"edit\") {\r\n                saveDeferred = self.updateUser(userFormData);\r\n            }\r\n\r\n            $.extend(params, userFormData.data);\r\n            $.when(saveDeferred).done(function (response) {\r\n                self.triggerHandler(\"endUsersForm\", params);\r\n            }).fail(function (response) {\r\n                var obj = JSON.parse(response.responseText)\r\n\r\n                self.endLoading();\r\n                self.validationController.showValidationMessage(obj.message);\r\n                self.triggerHandler(\"endUsersForm\", $.extend(params, { error: obj }));\r\n            });\r\n        }\r\n        else {\r\n            self.validationController.expandNotificationBox();\r\n        }\r\n    },\r\n\r\n    /**\r\n    * Generates a random password between 8 and 12 characters\r\n    * */\r\n    generateRandomPassword: function (passwordControl, minLength, maxLenth) {\r\n        var self = this;\r\n        var length = self.getLengthPassword(minLength, maxLenth);\r\n\r\n        var chars = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghiklmnopqrstuvwxyz\";\r\n        var randomPassword = '';\r\n        for (var i = 0; i < length; i++) {\r\n            var randomPosition = Math.floor(Math.random() * chars.length);\r\n            randomPassword += chars.substring(randomPosition, randomPosition + 1);\r\n        }\r\n        passwordControl.saveValue(randomPassword);\r\n    },\r\n\r\n    /**\r\n    * Generates a random length between minLength and maxLenth if both are defined, or between 8 and 12\r\n    * */\r\n    getLengthPassword: function (minLength, maxLenth) {\r\n        minLength = (minLength && maxLenth) ? minLength : 8;\r\n        maxLenth = (maxLenth && minLength) ? maxLenth : 12;\r\n        return Math.floor(Math.random() * (maxLenth - (minLength - 1))) + minLength;\r\n    },\r\n\r\n    /*\r\n    * Create User\r\n    */\r\n    createUser: function (userFormData, params) {\r\n\r\n        var self = this;\r\n        var collectedData = self.collectedValues;\r\n\r\n        var expiredAccountControl = self.form.getRender('expiredAccount');\r\n        var lockedAccountControl = self.form.getRender('lockedAccount');\r\n        var domain = self.form.getRender('domain');\r\n\r\n        //Add these parameters for the collected data\r\n        collectedData.expiredAccount = (expiredAccountControl) ? expiredAccountControl.getValue() : null;\r\n        collectedData.lockedAccount = (lockedAccountControl) ? lockedAccountControl.getValue() : null;\r\n        collectedData.domain = (domain) ? domain.getValue() : \"\";\r\n\r\n        // Data for first calling\r\n        $.extend(userFormData, {\r\n            data: {\r\n                domain: collectedData.domain,\r\n                fullName: collectedData.fullName,\r\n                userName: collectedData.userName\r\n            }\r\n        });\r\n\r\n        return $.when(self.dataService.submitData(userFormData)).pipe(function (response) {\r\n\r\n            // After save the action change to be edition\r\n            self.params.action = \"edit\";\r\n            self.params.userId = response.idEntity;\r\n\r\n            delete collectedData.userName;\r\n            delete collectedData.domain;\r\n\r\n            $.extend(userFormData, {\r\n                data: collectedData,\r\n                surrogatekey: response.idEntity\r\n            });\r\n\r\n            $.extend(params, {\r\n                userId: response.idEntity\r\n            });\r\n\r\n            return self.dataService.submitData(userFormData);\r\n        });\r\n\r\n    },\r\n\r\n    /*\r\n    * Update user \r\n    */\r\n    updateUser: function (userFormData) {\r\n        var self = this;\r\n        var collectedData = self.collectedValues;\r\n\r\n        $.extend(userFormData, {\r\n            surrogatekey: self.params.userId,\r\n            data: collectedData\r\n        });\r\n\r\n        return self.dataService.submitData(userFormData);\r\n\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: BizAgi Desktop Stakeholder\r\n *   Author: Fabian Moreno\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.stakeholder\", bizagi.rendering.stakeholder.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.stakeholder.extend(\"bizagi.rendering.desktop.stakeholder\", {}, {\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var bizagiControl = $('.ui-bizagi-render-stakeholder-container').closest('.ui-bizagi-control.ui-bizagi-render-align-left ');\r\n\r\n        // Hide initial control label\r\n        bizagiControl.css('width', '100%');\r\n        bizagiControl.prev().css('display', 'none');\r\n\r\n        self.maxElemShow = 10;\r\n        self.maxPageToShow = 5;\r\n        self.selectedItems = [];\r\n        self.valueXpath;\r\n        self.guidEntity;\r\n        self.currentPage;\r\n\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        //Event to associate stakeholder\r\n        $(\"#ui-bizagi-render-stakeholder-add\", control).click($.proxy(self.addInstance, self));\r\n        $(\".ui-bizagi-render-stakeholder-entity-row\", control).click($.proxy(self.addGrid, self));\r\n        $(\".ui-bizagi-render-stakeholder-back\", control).click($.proxy(self.goToBack, self));\r\n        $(\".ui-bizagi-render-stakeholder-link\", control).click($.proxy(self.removeAssociated, self));\r\n        $(\".ui-bizagi-render-stakeholder-search\", control).keyup($.proxy(self.onKeyUpFilter, self));\r\n\r\n        control.on(\"click\", \"table .sortColumnsData-stakeholder\", function (e) {\r\n            var currentTarget = $(e.currentTarget);\r\n            var paramField = currentTarget.data(\"orderfield\");\r\n            var orderType = currentTarget.data(\"ordertype\");\r\n\r\n            self.gridDataService(self.currentPage, null, paramField, (orderType === \"DESC\") ? \"ASC\" : \"DESC\");\r\n        });\r\n    },\r\n\r\n    /**\r\n     *\r\n     */\r\n    goToBack: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        if (self.status === \"step1\") {\r\n            $(\"#ui-bizagi-render-stakeholder-entity-list\", control).hide();\r\n            $(\"#ui-bizagi-render-stakeholder-add-instance\", control).hide();\r\n\r\n            $(\"#ui-bizagi-render-stakeholder-associated-list\", control).show();\r\n            $(\".ui-bizagi-render-stakeholder-associated\", control).show();\r\n            $(\"#ui-bizagi-render-stakeholder-add\", control).show();\r\n\r\n            $(\".ui-bizagi-render-stakeholder-back\", control).hide();\r\n\r\n            self.status = null;\r\n        }\r\n        else if (self.status === \"step2\") {\r\n            $(\"#ui-bizagi-render-stakeholder-grid\", control).hide();\r\n            $(\"#ui-bizagi-render-stakeholder-add-instance\", control).show();\r\n\r\n            self.status = \"step1\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     *\r\n     */\r\n    addInstance: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        self.status = \"step1\";\r\n        $(\"#ui-bizagi-render-stakeholder-associated-list\", control).hide();\r\n        $(\".ui-bizagi-render-stakeholder-associated\", control).hide();\r\n        $(\"#ui-bizagi-render-stakeholder-add\", control).hide();\r\n        $(\"#ui-bizagi-render-stakeholder-entity-list\", control).show();\r\n        $(\"#ui-bizagi-render-stakeholder-add-instance\", control).show();\r\n        $(\".ui-bizagi-render-stakeholder-back\", control).show();\r\n        $(\".ui-bizagi-render-stakeholder-entity-row\").removeClass(\"ui-bizagi-render-stakeholder-selected\");\r\n\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param e\r\n     */\r\n    addGrid: function (e) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        self.valueXpath = $( e.currentTarget).attr( \"data-value\" );\r\n        self.guidEntity = $( e.currentTarget).attr( \"guid-entity\" );\r\n\r\n        self.status = \"step2\";\r\n        $(\".ui-bizagi-render-stakeholder-entity-row\").removeClass(\"ui-bizagi-render-stakeholder-selected\");\r\n        $(e.currentTarget).addClass(\"ui-bizagi-render-stakeholder-selected\");\r\n\r\n        $(\"#ui-bizagi-render-stakeholder-add-instance\", control).hide();\r\n        $(\"#ui-bizagi-render-stakeholder-grid\", control).show();\r\n\r\n        $(\".ui-bizagi-render-stakeholder-search\", control).val(\"\");\r\n\r\n        self.gridDataService(null, \"\", \"\", \"DESC\");\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param currentPage\r\n     * @param filter\r\n     * @param sort\r\n     * @param orderType\r\n     */\r\n    gridDataService: function (currentPage, filter, sort, orderType) {\r\n        var self = this;\r\n\r\n        self.getData(self.valueXpath, currentPage, filter, sort, orderType).done(function (data) {\r\n            self.onGetData(data, orderType);\r\n        }).fail(function (e) {\r\n            self.onGetDataFail(e);\r\n        });\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param data\r\n     */\r\n    onGetData : function(data, orderType){\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var tempGrid = self.renderFactory.getTemplate(\"stakeholder-grid\");\r\n        self.currentPage  = data.page;\r\n\r\n        if(data.rows.length > 0){\r\n            var dataColumns = data.rows[0][1];\r\n\r\n            //preprocess columns because more template simple\r\n            var tempColumns = dataColumns.slice(1, dataColumns.length);\r\n            var columns = [];\r\n            for(iColumn = 0; iColumn < tempColumns.length; iColumn++){\r\n                var objectColumn = {\r\n                    name: tempColumns[iColumn][0],\r\n                    displayName: tempColumns[iColumn][1],\r\n                    orderType: orderType\r\n                };\r\n                columns.push(objectColumn);\r\n            }\r\n\r\n\r\n            var idData = self.selectedItems[self.valueXpath];\r\n\r\n            $.each( data.rows, function (key, value) {\r\n                var item = value[2][0][0];\r\n                if((!idData && (item != undefined)) || (idData && (item == idData.id)))\r\n                {\r\n                    self.selectedItems[self.valueXpath] = {\"id\" : value[0], \"idInstance\": item, \"nameInstance\" : value[2][0][1]};\r\n                    return;\r\n                }\r\n            });\r\n\r\n            if(self.selectedItems[self.valueXpath] && self.selectedItems[self.valueXpath].idUser == \"null\")\r\n            {\r\n                delete self.selectedItems[self.valueXpath];\r\n            }\r\n\r\n            //preprocess data.rows because more template simple\r\n            var newDataRows = [];\r\n            for(var iRow = 0; iRow < data.rows.length; iRow++){\r\n                var stateInstance = \"\";\r\n                var tooltipLink = \"\";\r\n\r\n                if(data.rows[iRow][2][0][0] && data.rows[iRow][2][0][0] != self.properties.idUser){\r\n                    stateInstance = \"associatedWithAnotherUser\";\r\n                    tooltipLink = bizagi.localization.getResource(\"render-stakeholder-link-tooltip-associate-another-user\").replace(\"{0}\", data.rows[iRow][2][0][1]);\r\n                }\r\n                else if(data.rows[iRow][2][0][0] == self.properties.idUser){\r\n                    stateInstance = \"associateMe\";\r\n                    tooltipLink = bizagi.localization.getResource(\"render-stakeholder-link-tooltip-associate\");\r\n                }\r\n                else{\r\n                    stateInstance = \"unassociated\";\r\n                    tooltipLink = bizagi.localization.getResource(\"render-stakeholder-link-tooltip-unassociate\");\r\n                }\r\n\r\n                var rowTemplate = {};\r\n                rowTemplate.columns = [];\r\n                rowTemplate.columns.push({\r\n                    stateInstance: stateInstance,\r\n                    value: data.rows[iRow][0],\r\n                    tooltipLink: tooltipLink\r\n                });\r\n\r\n                for(var iColumn = 0; iColumn < data.rows[iRow][2].length; iColumn++){\r\n                    if(iColumn > 0){\r\n                        rowTemplate.columns.push({value: data.rows[iRow][2][iColumn]});\r\n                    }\r\n                }\r\n\r\n                newDataRows.push(rowTemplate);\r\n            }\r\n\r\n            var gridTmp = $.tmpl(tempGrid, {\r\n                datasource: newDataRows,\r\n                columns: columns,\r\n                tooltipUnassociated: bizagi.localization.getResource(\"render-stakeholder-link-tooltip-unassociate\")\r\n            });\r\n\r\n            $(\".ui-bizagi-render-stakeholder-items-grid-content\", control).empty().append(gridTmp);\r\n\r\n            var tempPagination = self.renderFactory.getTemplate(\"stakeholder-paginator\");\r\n\r\n            //Keep in track the total Records\r\n            self.totalRecords = data.records;\r\n            //keep in track the total pages\r\n            self.totalPages = data.total;\r\n            var pageToshow = (self.maxPageToShow > self.totalPages) ? self.totalPages : self.maxPageToShow;\r\n            var pagerData = {};\r\n\r\n            // show or hide \"load more\" button\r\n            pagerData.pagination = (self.totalPages > 1);\r\n            pagerData.page = data.page;\r\n            pagerData.pages = {};\r\n\r\n            for (var i = 1; i <= pageToshow; i++) {\r\n                pagerData[\"pages\"][i] = {\r\n                    \"pageNumber\": i\r\n                };\r\n            }\r\n\r\n            //load and append the paginator to the result table\r\n            paginationHtml = $.tmpl(tempPagination, pagerData).html();\r\n            $(\".ui-bizagi-render-stakeholder-paginator\", control).empty().append(paginationHtml);\r\n\r\n            var $pager = $(\".ui-bizagi-render-stakeholder-paginator ul\", control);\r\n\r\n            $pager.bizagiPagination({\r\n                maxElemShow: self.maxPageToShow,\r\n                totalPages: self.totalPages,\r\n                actualPage: self.currentPage,\r\n                listElement: $pager,\r\n                clickCallBack: function (options) {\r\n                    self.gridDataService(options.page);\r\n                }\r\n            });\r\n\r\n            self.setRowsEvents();\r\n\r\n\r\n        }\r\n        else{//hay datos en data.rows//No\r\n            $(\".ui-bizagi-render-stakeholder-items-grid-content\", control).empty();\r\n            $(\".ui-bizagi-render-stakeholder-paginator\", control).empty();\r\n        }\r\n\r\n    },\r\n\r\n\r\n    /**\r\n     *\r\n     * @param e\r\n     */\r\n    onGetDataFail : function(e){\r\n        console.log(\"process property value error: \" + e);\r\n    },\r\n\r\n    /**\r\n     *\r\n     */\r\n    setRowsEvents: function () {\r\n        var self = this;\r\n        $(\".ui-bizagi-render-stakeholder-table-link\").click($.proxy(self.onLinkClick, self));\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param e\r\n     */\r\n    onLinkClick : function(e){\r\n        var self = this;\r\n        var idUser;\r\n        var idEntity = $( e.currentTarget).attr( \"data-value\" );\r\n\r\n\r\n        function executeLinkClickIfProceed(event){\r\n            if ($(event.currentTarget).hasClass(\"ui-bizagi-render-stakeholder-table-link-close\")) {\r\n                $(\".ui-bizagi-render-stakeholder-table-link\").removeClass(\"ui-bizagi-render-stakeholder-table-link-close\");\r\n                idUser = \"null\";\r\n            }\r\n            else {\r\n                $(\".ui-bizagi-render-stakeholder-table-link\").removeClass(\"ui-bizagi-render-stakeholder-table-link-close\");\r\n                $(event.currentTarget).addClass(\"ui-bizagi-render-stakeholder-table-link-close\");\r\n                idUser = self.properties.idUser;\r\n            }\r\n\r\n            self.selectedItems[self.valueXpath] = {\"id\" : idEntity, \"idUser\" : idUser};\r\n\r\n            //if idUser is null, remove associated Stakeholder\r\n            self.associatedUser(idEntity, self.guidEntity, idUser).done(function () {\r\n                self.refreshStakeholderValue();\r\n\r\n                //if only target contents ui-bizagi-render-stakeholder-table-stakeholder-associated-other-user\r\n                //set association stakeholder to user\r\n                if ($(event.currentTarget).hasClass(\"ui-bizagi-render-stakeholder-table-stakeholder-associated-other-user\")) {\r\n                    $(\".ui-bizagi-render-stakeholder-table-link\").removeClass(\"ui-bizagi-render-stakeholder-table-stakeholder-associated-other-user\");\r\n                    $(event.currentTarget).addClass(\"ui-bizagi-render-stakeholder-table-link-close\");\r\n                    idUser = self.properties.idUser;\r\n                    self.associatedUser(idEntity, self.guidEntity, idUser).done(function () {\r\n                        self.refreshStakeholderValue();\r\n                    }).fail(function (e) {\r\n                        self.onStakeAssociatedFail(e);\r\n                    });\r\n                }\r\n\r\n            }).fail(function (e) {\r\n                self.onStakeAssociatedFail(e);\r\n            });\r\n        }\r\n\r\n        //Confirm to delete stakeholder association with another user.\r\n        if($(e.currentTarget).hasClass(\"ui-bizagi-render-stakeholder-table-link-close\") && $(e.currentTarget).hasClass(\"ui-bizagi-render-stakeholder-table-stakeholder-associated-other-user\")){\r\n            var confirmationMsg = bizagi.localization.getResource(\"render-stakeholder-delete-associate-instance-other-user-confirm-msg\");\r\n            $.when(bizagi.showConfirmationBox(confirmationMsg, \"Bizagi\", \"warning\"))\r\n                .done(function () {\r\n                    executeLinkClickIfProceed(e);\r\n                });\r\n        }\r\n        else{\r\n            executeLinkClickIfProceed(e);\r\n        }\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param e\r\n     */\r\n    removeAssociated: function (e) {\r\n        var self = this;\r\n\r\n        var idEntity = $( e.currentTarget).attr( \"data-value\" );\r\n        self.guidEntity = $( e.currentTarget).attr( \"guid-entity\" );\r\n        var state = \"null\";\r\n        self.selectedItems[self.valueXpath] = {\"id\" : idEntity, \"idUser\" : state};\r\n\r\n        self.associatedUser(idEntity, self.guidEntity, state).done(function () {\r\n            self.refreshStakeholderValue();\r\n        }).fail(function (e) {\r\n            self.onStakeAssociatedFail(e);\r\n        });\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param e\r\n     */\r\n    onKeyUpFilter : function (e) {\r\n        var self = this;\r\n        if(e.keyCode == 13)\r\n        {\r\n            var filter = $(e.target).val();\r\n            self.gridDataService(null,  filter);\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n     *\r\n     */\r\n    refreshStakeholderValue : function(){\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        self.refreshStakeholderList().done(function (data) {\r\n            //Update Stakeholder List\r\n            self.setValue(data);\r\n            control.empty().append(self.renderControl());\r\n            self.configureHandlers();\r\n        }).fail(function (e) {\r\n            self.onStakeAssociatedFail(e);\r\n        });\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param e\r\n     */\r\n    onStakeAssociatedFail : function(e){\r\n        console.log(\"stakeholder associated error: \" + e);\r\n    },\r\n\r\n    /**\r\n     * Override display value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n\r\n        // Set internal value\r\n        self.setValue(value);\r\n    },\r\n\r\n    /**\r\n     *   Sets the internal value\r\n     */\r\n    setValue: function (value) {\r\n        var self = this;\r\n\r\n        // Set previous value\r\n        self.properties.previousValue = self.properties.originalValue = JSON.stringify({ \"value\": self.value });\r\n\r\n        // Change internal value\r\n        self.value = self.properties.value = JSON.stringify({ \"value\": value });\r\n    }\r\n});\r\n","/*\r\n *   Name: Bizagi Render userPassword class\r\n *   Author: Paola Herrera\r\n *   Comments:\r\n *   -   This script will define basic stuff for userPassword renders\r\n */\r\n\r\n // Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.userPassword\", bizagi.rendering.userPassword.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.userPassword.extend(\"bizagi.rendering.desktop.userPassword\", {}, {\r\n    /*\r\n    * Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        // Call base\r\n        this._super();\r\n\r\n        self.input = control.find(\"input\");\r\n\r\n        // Define max length of element\r\n        if (self.properties.maxLength > 0) {\r\n            self.input.attr(\"maxlength\", self.properties.maxLength);\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Attach change event\r\n        self.input.bind(\"change\", function () {\r\n\r\n            var inputValue = self.input.val();\r\n\r\n            if (inputValue !== \"\") {\r\n                // Updates internal value\r\n                self.saveValue(inputValue);\r\n            } else { \r\n                self.setValue(inputValue)\r\n            }\r\n\r\n        }).keypress(function (e) {\r\n            e = window.event || e;\r\n            var keyUnicode = e.charCode || e.keyCode;\r\n            if (e !== undefined) {\r\n                if (keyUnicode == 13) {\r\n                    $(this).trigger(\"change\");\r\n                }\r\n            }\r\n        });\r\n    },\r\n\r\n    saveValue: function (inputValue) {\r\n        var self = this;\r\n\r\n        var C = CryptoJS;\r\n        var userFormsSpanner = C.enc.Utf8.parse('pc30n84e15lvdD68');\r\n        var userFormsCode = CryptoJS.enc.Latin1.parse('1v00628X62bJE2mi');\r\n\r\n        var aes = C.algo.AES.createEncryptor(userFormsSpanner, {\r\n            mode: C.mode.CBC,\r\n            padding: C.pad.Pkcs7,\r\n            iv: userFormsCode\r\n        });\r\n\r\n        var resultMain = aes.finalize(inputValue);\r\n        var resultMainFinal = C.enc.Base64.stringify(resultMain);\r\n\r\n        self.setValue(resultMainFinal);\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed in read-only mode\r\n    */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        var tempHTML = \"<label class='readonly-control'></label>\";\r\n        var spanTmp = $.tmpl(tempHTML, {});\r\n\r\n        control.append(spanTmp);\r\n    }\r\n});","/*\r\n*   Name: Bizagi Desktop grid Actions Extension\r\n*    Author: Cristian Olaya\r\n*           Ivn Ricardo Taimal\r\n*\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.render.extend(\"bizagi.rendering.desktop.gridActions\", {}, {\r\n\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"gridActions\");\r\n        var hasActions = self.grid && self.grid.hasActions() || false;\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {hasActions: hasActions});\r\n        return html;\r\n    }\r\n    \r\n});\r\n","/*\r\n *   Name: Bizagi Rendering Desktop numberScientificNotation\r\n *   Author: Laura Ariza\r\n *   Comments:\r\n *   -   This script define a render control that support scientific notation format\r\n */\r\n\r\n// Extends from render desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.numberScientificNotation\", bizagi.rendering.numberScientificNotation.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.numberScientificNotation.extend(\"bizagi.rendering.desktop.numberScientificNotation\", {}, {\r\n\r\n    /*\r\n    * Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function() {\r\n        var self = this;\r\n\r\n        self._super();\r\n\r\n        // Attach Format Currency Plugin to format the input\r\n        self.attachFormatScientificNotation();\r\n    },\r\n\r\n\r\n    setDisplayValue: function(value) {\r\n        var self = this;\r\n\r\n        value = bizagi.util.scientificNotationFormat(value.replace(self.properties.decimalSymbol, '.'));\r\n        // Set value in input\r\n        if (value != null && self.properties.editable) {\r\n            self.numericInput.val(value.replace('.', self.properties.decimalSymbol));\r\n            self.setValue(value);\r\n\r\n        }\r\n        // Call base\r\n        this._super(value.replace('.', self.properties.decimalSymbol));\r\n    },\r\n\r\n    attachFormatScientificNotation: function() {\r\n        var self = this;\r\n\r\n        // Attach events\r\n        self.numericInput.blur(function() {\r\n            var inputValue = self.numericInput.val();\r\n            var scientificNotationNumber =\r\n                bizagi.util.scientificNotationFormat(inputValue, self.properties.decimalSymbol);\r\n            // Updates internal value\r\n            self.setValue(scientificNotationNumber);\r\n            self.numericInput.val(scientificNotationNumber);\r\n        });\r\n    }\r\n\r\n});","/**\r\n * Desktop definition of Action Launcher\r\n *\r\n * @author: Edward Morales\r\n */\r\n\r\n // Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.actionLauncher\", bizagi.rendering.actionLauncher.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.actionLauncher.extend(\"bizagi.rendering.desktop.actionLauncher\", {}, {\r\n    /**\r\n     * Render a specific implementation for Desktop device\r\n     */\r\n    postRender: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n        var html, template;\r\n        var data = {};\r\n        var def = new $.Deferred();\r\n\r\n        if(mode == \"design\" || !self.properties.surrogatedKey) {\r\n            return \"\";\r\n        }\r\n\r\n        self.configureQueueVisibility();\r\n\r\n        function appendContent(template, templateArguments) {\r\n            var control = self.getControl();\r\n            var actionsContainer = $(\".bz-action-launcher-actions-container\", control);\r\n            html = $.fasttmpl(template, templateArguments);\r\n            actionsContainer.append(html);\r\n\r\n            if(templateArguments.template) {\r\n                actionsContainer\r\n                        .find('.actions-container.actions-container-template')\r\n                        .append(templateArguments.template)\r\n            }\r\n            self.configureHandlers();\r\n            def.resolve(actionsContainer);\r\n        }\r\n\r\n        /**\r\n         * Define params to get list of actions\r\n         */\r\n        $.when(self.dataService.multiaction().getActions(self.processPropertyValueArgs))\r\n                .pipe(function(actions) {\r\n                    actions = self.getPropertiesActionLaucher(actions);\r\n                    data.actions = actions;\r\n\r\n                    return (properties.templatetype != 'none') ? self.dataService.multiaction().getPropertyData(self.processPropertyValueDataTmplArgs) : null;\r\n                })\r\n                .done(function(templateData) {\r\n                    var response = data.actions;\r\n                    self.deferredActions.resolve(response);\r\n                    self.totalActions = bizagi.clone(response);\r\n                    var actions = bizagi.clone(response);\r\n                    var templateArguments = {};\r\n\r\n                    var moreActionsManager = self.moreActionsManager(actions);\r\n                    var isMoreActions = moreActionsManager.isMoreActions;\r\n                    actions = moreActionsManager.actions;\r\n                    self.lessActions = bizagi.clone(actions);\r\n\r\n                    if(properties.isHorizontal) {\r\n                        if(properties.templatetype != 'none') {\r\n                            $.when(self.engine.render($.extend(templateData, { isDefaultTemplate: properties.templatetype == 'default' }), self.processPropertyValueDataTmplArgs))\r\n                                    .done(function (template) {\r\n                                        templateArguments = {\r\n                                            actions: self.getPropertiesActionLaucher(actions),\r\n                                            template: template,\r\n                                            isMoreActions: isMoreActions,\r\n                                            moreActions: self.moreActions,\r\n                                            allowactions: properties.allowactions\r\n                                        };\r\n                                        template = self.renderFactory.getTemplate(\"render-actionLauncher-horizontal\");\r\n                                        appendContent(template, templateArguments);\r\n                                    });\r\n                        } else {\r\n                            templateArguments = {\r\n                                actions: self.getPropertiesActionLaucher(actions),\r\n                                isMoreActions: isMoreActions,\r\n                                template: false,\r\n                                moreActions: self.moreActions,\r\n                                allowactions: properties.allowactions\r\n                            };\r\n                            template = self.renderFactory.getTemplate(\"render-actionLauncher-horizontal\");\r\n                            appendContent(template, templateArguments);\r\n                        }\r\n\r\n                    } else {\r\n                        var actionsVertical = isMoreActions ? self.lessActions : self.totalActions;\r\n                        templateArguments = {\r\n                            actions: self.getPropertiesActionLaucher(actionsVertical),\r\n                            allowSearch: properties.allowSearch,\r\n                            isMoreActions: isMoreActions,\r\n                            isExpanded: false,\r\n                            moreButtonTitle: self.getResource(\"render-action-launcher-more-actions\")\r\n                        };\r\n                        template = self.renderFactory.getTemplate(\"render-actionLauncher-vertical\");\r\n                        appendContent(template, templateArguments);\r\n                    }\r\n                })\r\n                .fail(function(error) {\r\n                    def.fail(error);\r\n                });\r\n\r\n        self.engine.subscribe('onLoadDataNavigation', function (ev, params) {\r\n            bizagi.loader.start(\"entity-engine-view\").then(function () {\r\n                $(document).triggerHandler(\"showDialogWidget\", {\r\n                    widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_DIALOGNAV,\r\n                    data: params,\r\n                    modalParameters: {\r\n                        title: params.data.displayName,\r\n                        refreshInbox: false\r\n                    },\r\n                    maximizeOnly: false\r\n                });\r\n            });\r\n        });\r\n\r\n        return def.promise();\r\n    },   \r\n\r\n    /**\r\n     * Check maxitems action and create sub list of actions\r\n     * in order to create contextual menu with them\r\n     * @param actions\r\n     * @return {{isMoreActions: boolean, actions: *}}\r\n     */\r\n    moreActionsManager: function(actions) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var isMoreActions = (actions.length > properties.maxItems) || false;\r\n        if(isMoreActions) {\r\n            var moreActionsTemp = actions.splice(0, properties.maxItems);\r\n            self.moreActions = bizagi.clone(actions);\r\n            actions = moreActionsTemp;\r\n        }\r\n\r\n        return {isMoreActions: isMoreActions, actions: actions};\r\n    },\r\n\r\n    /**\r\n     * Add binding to html elements\r\n     */\r\n    configureHandlers: function() {\r\n        var self = this;\r\n        var formContainer = self.getFormContainer();\r\n        if(typeof formContainer.params.printversion === \"undefined\" || formContainer.params.printversion == false) {\r\n            var control = self.getControl();\r\n            var actionLauncherControls = $(\".action-launcher-control\", control);\r\n            var moreVerticalButton = $(\".action-launcher-more-vertical\", control);\r\n            var properties = self.properties;\r\n\r\n            self.configureMoreActionsHandler();\r\n            /**\r\n             * Binding for a tooltip when max items is exceeded horizontal\r\n             */\r\n            moreVerticalButton.on(\"click\", function(event) {\r\n                var $button = $(this);\r\n                var isExpanded = false;\r\n                var moreButtonTitle = \"\";\r\n                var actionsVertical = {};\r\n                if($button.hasClass(\"expanded\")) {\r\n                    isExpanded = false;\r\n                    actionsVertical = self.lessActions;\r\n                    moreButtonTitle = self.getResource(\"render-action-launcher-more-actions\");\r\n                } else {\r\n                    isExpanded = true;\r\n                    actionsVertical = self.totalActions;\r\n                    moreButtonTitle = self.getResource(\"render-action-launcher-less-actions\");\r\n                }\r\n\r\n                var templateArguments = {\r\n                    actions: self.getPropertiesActionLaucher(actionsVertical),\r\n                    allowSearch: properties.allowSearch,\r\n                    isMoreActions: true,\r\n                    isExpanded: isExpanded,\r\n                    moreButtonTitle: moreButtonTitle\r\n                };\r\n                var template = self.renderFactory.getTemplate(\"render-actionLauncher-vertical\");\r\n                appendContent(template, templateArguments);\r\n\r\n                function appendContent(template, templateArguments) {\r\n                    var control = self.getControl();\r\n                    var actionsContainer = $(\".bz-action-launcher-actions-container\", control);\r\n                    actionsContainer.empty();\r\n                    var html = $.fasttmpl(template, templateArguments);\r\n                    actionsContainer.append(html);\r\n                    self.configureHandlers();\r\n                }\r\n\r\n            });\r\n\r\n            /**\r\n             * Binding for click action on buttons\r\n             */\r\n            actionLauncherControls.on(\"click\", function() {\r\n                var action = {\r\n                    guidProcess: $(this).data(\"guidprocess\"),\r\n                    guidAction: $(this).data(\"guidaction\"),\r\n                    displayName: $(this).data(\"display-name\"),\r\n                    actionType: $(this).data(\"action-type\"),\r\n                    xpathContext: $(this).data(\"xpathcontext\"),\r\n                    readOnlyForm: $(this).data(\"readonlyform\") || self.isReadOnlyForm(),\r\n                    guidEntity: self.properties.guidEntity,\r\n                    xpathActions: self.properties.xpathActions || \"\"\r\n                };\r\n                self.onActionClicked(action);\r\n            });\r\n\r\n            /**\r\n             * Catch the typed text in the search field and filter the action list\r\n             */\r\n            $.expr[\":\"].FilterAction = function(entity, i, array) {\r\n                var search = array[3];\r\n                if(!search) {\r\n                    return false;\r\n                }\r\n                return new RegExp(search, \"i\").test($(entity).text());\r\n            };\r\n            $(\"input#ui-bizagi-render-action-launcher-filter-input\", control).keyup(function() {\r\n                var search = $(this).val();\r\n                $(\".ui-bizagi-render-actionLauncher-vertical-item\", control).show(0);\r\n                if(!moreVerticalButton.hasClass(\"expanded\")) {\r\n                    moreVerticalButton.trigger(\"click\");\r\n                    $(\"input#ui-bizagi-render-action-launcher-filter-input\").val(search);\r\n                    $(\"input#ui-bizagi-render-action-launcher-filter-input\").focus();\r\n                }\r\n                if(search) {\r\n                    $(\".ui-bizagi-render-actionLauncher-vertical-item\", control).not(\":FilterAction(\" + search + \")\").hide(0);\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    isReadOnlyForm: function () {\r\n        var self = this;\r\n        var resultReadOnly = false;\r\n\r\n        if(self.typeForm == \"GlobalForm\" || self.typeForm == \"SummaryForm\") {\r\n            resultReadOnly = true;\r\n        }\r\n\r\n        return resultReadOnly;\r\n    },\r\n\r\n    configureMoreActionsHandler: function() {\r\n        var self = this,\r\n                control = self.getControl();\r\n        var moreButton = $(\".action-launcher-more\", control);\r\n\r\n        bizagi.loader.startAndThen(\"kendo\").then(function () {\r\n            self.tooltip = moreButton.kendoTooltip({\r\n                autoHide: false,\r\n                content: function (event) {\r\n                    var tmpl = self.renderFactory.getTemplate(\"render-actionLauncher-horizontal-more\");\r\n                    var html = $.fasttmpl(tmpl, { actions: self.getPropertiesActionLaucher(self.moreActions) });\r\n                    return html;\r\n                },\r\n                show: function () {\r\n                    //add custom styles tooltip\r\n                    $(\"div[role='tooltip']\").addClass(\"bizagi-custom-tooltip-more-actions\");\r\n                    $(\".action-launcher-control-more\").off(\"click\").on(\"click\", function (event) {\r\n                        var action = {\r\n                            guidProcess: $(this).data(\"guidprocess\"),\r\n                            guidAction: $(this).data(\"guidaction\"),\r\n                            displayName: $(this).data(\"display-name\"),\r\n                            actionType: $(this).data(\"action-type\"),\r\n                            xpathContext: $(this).data(\"xpathcontext\"),\r\n                            readOnlyForm: $(this).data(\"readonlyform\") || false,\r\n                            xpathActions: self.properties.xpathActions || \"\"\r\n                        };\r\n                        self.onActionClicked(action);\r\n                        self.tooltip.hide();\r\n                    });\r\n                },\r\n                width: 185\r\n            }).data(\"kendoTooltip\");\r\n        });\r\n    },\r\n\r\n    onActionClicked: function(action) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var multipleSelection = (typeof properties.multipleSelection == \"undefined\") ? true : properties.multipleSelection;\r\n\r\n        if(multipleSelection) {\r\n            // If this is a form and has been queued, so open it\r\n            if(action.actionType == \"Form\" && self.countSameActions(action) >= 1 && !action.xpathContext) {\r\n                //Open action\r\n                $(\".action-to-execute-control[data-guidaction='\" + action.guidAction + \"'] label\", control).click();\r\n            } else {\r\n                $.when(self.actionManager(action)).done(function(act) {\r\n                    self.executeAction(act);\r\n                });\r\n            }\r\n        }\r\n        else if(self.getValue().length > 0) {\r\n            self.showConfirmationDialog(action);\r\n        }\r\n        else {\r\n            $.when(self.actionManager(action)).done(function(act) {\r\n                self.executeAction(act);\r\n            });\r\n        }\r\n    },\r\n\r\n    notifyExecution: function(data, action) {\r\n        var self = this;\r\n        var notifications = new bizagi.INotifications();\r\n        if(data.response == \"success\") {\r\n            notifications.showSucessMessage(printf(self.getResource(\"render-action-launcher-success-excecution\"), action.displayName), null, {});\r\n        } else {\r\n            notifications.showErrorMessage(printf(self.getResource(\"render-action-launcher-failed-excecution\"), action.displayName), null, {});\r\n        }\r\n    },\r\n\r\n    processActionForm: function(action) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var additionalXpaths = self.properties.additionalXpath.join(\",\");\r\n        var xpathContext = (action.xpathContext) ? self.properties.xpathActions + \".\" + action.xpathContext : self.properties.xpathActions;\r\n        var def = new $.Deferred();\r\n\r\n        // Show dialog with new form after that\r\n        var dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n            title: properties.detailLabel || bizagi.localization.getResource(\"render-grid-details-form\"),\r\n            showSaveButton: true,\r\n            cancelButtonLabel: bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n            onSave: function(data) {\r\n                // Submit the form\r\n                return self.dataService.multiaction().submitData({\r\n                    action: \"SAVE\",\r\n                    data: data,\r\n                    xpathContext: dialog.form.properties.xpathContext, //self.properties.xpathContext,\r\n                    idPageCache: dialog.form.properties.idPageCache,\r\n                    isOfflineForm: false,\r\n                    isActionStartForm: true\r\n                }).pipe(function(savedData) {\r\n                    if(!action.editMode && self.countSameActions(action) == 0) {\r\n                        action.idStartScope = savedData.IdScope;\r\n                        //self.addActionToQueue(action);\r\n                    }\r\n                    def.resolve(savedData.IdScope);\r\n                });\r\n            },\r\n            onCancel: function(data) {\r\n\r\n            }\r\n        });\r\n\r\n        var paramsRender = {\r\n            \"idForm\": action.guidProcess,\r\n            \"contextType\": \"start\",\r\n            \"idCase\": self.properties.caseId,\r\n            \"idWorkitem\": form.properties.typeForm != \"SummaryForm\" ? bizagi.context.idWorkitem : undefined,\r\n            \"additionalXpaths\": additionalXpaths,\r\n            \"xpathContext\": xpathContext,\r\n            \"idStartScope\": action.idStartScope,\r\n            \"surrogateKey\": self.properties.surrogatedKey,\r\n            \"readOnlyForm\": action.readOnlyForm,\r\n            \"recordXpath\": action.recordXpath\r\n        };\r\n        if (action.actionType === \"Form\") {\r\n            paramsRender.contextType = \"entitytemplate\";\r\n            paramsRender.xpathContext = undefined;\r\n            paramsRender.guidEntity = action.guidEntity;\r\n            paramsRender.rewriteContextType = true;\r\n        } \r\n\r\n        dialog.render(paramsRender);\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    processActionFormCollection: function(action) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var additionalXpaths = self.properties.additionalXpath.join(\",\");\r\n        var def = new $.Deferred();\r\n        var xpathContext = (action.xpathContext) ? self.properties.xpathActions + \".\" + action.xpathContext : self.properties.xpathActions;\r\n        var xpathPattern = \"%s[id=%s]\";\r\n        var xpathPatternWithoutkey = \"%s[]\";\r\n        var xpathContextWithKey = (xpathContext != \"\") ? printf(xpathPattern, xpathContext, action.idEntity) : xpathContext;\r\n        var xpathContextWithoutKey = (xpathContext != \"\") ? printf(xpathPatternWithoutkey, xpathContext) : xpathContext;\r\n\r\n        var dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n            title: properties.detailLabel || bizagi.localization.getResource(\"render-grid-details-form\"),\r\n            showSaveButton: true,\r\n            cancelButtonLabel: bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n            onSave: function(data) {\r\n                if(action.editMode) {\r\n                    return self.dataService.multiaction().submitData({\r\n                        action: \"SAVE\",\r\n                        data: data,\r\n                        xpathContext: xpathContextWithKey,\r\n                        idPageCache: data.idPageCache,\r\n                        isOfflineForm: false,\r\n                        isActionStartForm: true\r\n                    }).pipe(function(savedData) {\r\n                        def.resolve(savedData.IdScope);\r\n                    });\r\n                } else {\r\n                    return self.dataService.addGridRecordData({\r\n                        idRender: properties.id,\r\n                        //xpath: properties.xpath,\r\n                        xpathContext: xpathContext,\r\n                        contexttype: \"start\",\r\n                        idPageCache: data.idPageCache,\r\n                        submitData: data\r\n                    }).pipe(function(savedData) {\r\n                        action.idStartScope = savedData.IdScope;\r\n                        action.idEntity = savedData.IdEntity;\r\n                        self.addActionToQueue(action);\r\n                        def.resolve(savedData.IdScope);\r\n                    });\r\n                }\r\n            },\r\n            onCancel: function(data) {\r\n\r\n            }\r\n        });\r\n\r\n        dialog.render({\r\n            \"idForm\": action.guidProcess,\r\n            \"contextType\": \"start\",\r\n            \"idCase\": bizagi.context.idCase,\r\n            \"additionalXpaths\": additionalXpaths,\r\n            \"xpathContext\": (action.editMode) ? xpathContextWithKey : xpathContextWithoutKey,\r\n            \"idStartScope\": action.idStartScope,\r\n            \"surrogateKey\": self.properties.surrogatedKey,\r\n            \"readOnlyForm\": action.readOnlyForm,\r\n            \"recordXpath\": action.recordXpath\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Process a start form\r\n     * @param args\r\n     * @return {*}\r\n     */\r\n    processStartForm: function(args) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var def = new $.Deferred();\r\n        args = args || {};\r\n\r\n\r\n        var dialog = new bizagi.rendering.dialog.startForm(self.dataService, self.renderFactory, {\r\n            //showSaveButton: properties.editable,\r\n            maximized: properties.maximized,\r\n            title: args.title || \"\",\r\n            saveButtonLabel: (self.typeForm == \"GlobalForm\" || this.typeForm == \"SummaryForm\") ? bizagi.localization.getResource(\"render-form-button-create\") : bizagi.localization.getResource(\"render-form-dialog-box-save\"),\r\n            onSave: function(data) {\r\n                form.startLoading();\r\n\r\n                // Submit the form\r\n                return self.dataService.multiaction().submitData({\r\n                    action: \"SAVE\",\r\n                    data: data,\r\n                    xpathContext: self.properties.xpathContext,\r\n                    idPageCache: data.idPageCache,\r\n                    isOfflineForm: false,\r\n                    isActionStartForm: true\r\n                }).pipe(function(savedData) {\r\n                    form.endLoading();\r\n                    def.resolve(savedData.IdScope);\r\n                });\r\n            }\r\n        });\r\n\r\n        dialog.render({\r\n            guidprocess: args.guidprocess,\r\n            idStartScope: args.idStartScope,\r\n            idCase: self.properties.caseId,\r\n            idWorkitem: form.properties.typeForm != \"SummaryForm\" ? bizagi.context.idWorkitem : undefined,\r\n            additionalXpaths: self.properties.additionalXpath.join(\",\"),\r\n            surrogatedKey: self.properties.surrogatedKey,\r\n            recordXpath: args.recordXpath,\r\n            mappingstakeholders: true\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    executeAction: function(action) {\r\n        var self = this;\r\n\r\n        if(self.typeForm == \"GlobalForm\" || self.typeForm == \"SummaryForm\") {\r\n            $.when(bizagi.showConfirmationBox(bizagi.localization.getResource(\"render-action-launcher-immediatly-action-confirmation\"), null, false)).done(function(response) {\r\n                self.executeActionImmediately(action);\r\n            });\r\n        }\r\n        else {\r\n            self.addActionToQueue(action);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Show confirmation dialog\r\n     * @param action\r\n     */\r\n    showConfirmationDialog: function(action) {\r\n        var self = this;\r\n        self.confirmTemplate = self.renderFactory.getTemplate(\"render-actionLauncher-confirm\");\r\n        var message = bizagi.localization.getResource(\"render-action-launcher-single-action-confirmation\");\r\n        var confirmContent = $.tmpl(self.confirmTemplate, {confirmationMessage: message});\r\n        var confirmContentParams = {\r\n            resizable: false,\r\n            modal: true,\r\n            title: \"Bizagi\",\r\n            buttons: []\r\n        };\r\n        confirmContentParams.buttons = [\r\n            {\r\n                text: bizagi.localization.getResource(\"render-boolean-yes\"),\r\n                click: function() {\r\n                    self.setValue([]);\r\n                    $.when(self.actionManager(action)).done(function(act) {\r\n                        self.executeAction(act);\r\n                    });\r\n                    $(this).dialog(\"close\");\r\n                }\r\n            },\r\n            {\r\n                text: bizagi.localization.getResource(\"render-boolean-no\"),\r\n                click: function() {\r\n                    $(this).dialog(\"close\");\r\n                }\r\n            }\r\n        ];\r\n        $(confirmContent).dialog(confirmContentParams);\r\n    },\r\n\r\n    /**\r\n     * Render actual value of control and set events\r\n     * @param data\r\n     */\r\n    setDisplayValue: function(data) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var actionsToExecuteContainer = $(\".bz-action-launcher-actions-to-execute-container\", control);\r\n        var template = self.renderFactory.getTemplate(\"render-actionLauncher-actions-to-execute\");\r\n\r\n        self.configureQueueVisibility();\r\n        $.when(self.deferredActions).done(function(listOfActions) {\r\n            var getMappingAction = function(guidAction) {\r\n                var mapping = [];\r\n                $.each(listOfActions, function(key, value) {\r\n                    if(value[4] == guidAction) {\r\n                        mapping = value;\r\n                    }\r\n                });\r\n                return mapping;\r\n\r\n            };\r\n            $.each(data, function(key, value) {\r\n                var mapping = getMappingAction(value.guidAction);\r\n                data[key].displayName = mapping[1];\r\n                data[key].guidProcess = mapping[0];\r\n                data[key].actionType = mapping[3];\r\n                data[key].xpathContext = mapping[5];\r\n                data[key].readOnlyForm = mapping[6];\r\n\r\n                if(data[key].params && data[key].params.idStartScope) {\r\n                    data[key].idStartScope = data[key].params.idStartScope;\r\n                }\r\n                if(data[key].params && data[key].params.idPageCache) {\r\n                    data[key].idPageCache = data[key].params.idPageCache;\r\n                }\r\n                if(data[key].params && data[key].params.idEntity) {\r\n                    data[key].idEntity = data[key].params.idEntity;\r\n                }\r\n            });\r\n            $.when($.fasttmpl(template, {actions: data})).done(function(html) {\r\n                actionsToExecuteContainer.empty();\r\n                actionsToExecuteContainer.append(html);\r\n                var removeActionSelector = $(\".action-to-execute-control i\", actionsToExecuteContainer);\r\n                var openActionSelector = $(\".action-to-execute-control label\", actionsToExecuteContainer);\r\n                removeActionSelector.bind(\"click\", function() {\r\n                    var index = $(this).parent().data(\"index\");\r\n                    self.removeActionToQueue(index);\r\n                });\r\n                openActionSelector.bind(\"click\", function() {\r\n                    var target = $(this).parent();\r\n                    var type = target.data(\"actiontype\");\r\n                    var guidprocess = target.data(\"guidprocess\");\r\n                    var idStartScope = target.data(\"idstartscope\");\r\n                    var title = target.data(\"title\");\r\n                    var xpathContext = target.data(\"xpathcontext\");\r\n                    var readOnlyForm = target.data(\"readonlyform\") || false;\r\n                    var idEntity = target.data(\"identity\") || \"\";\r\n                    var guidAction = target.data(\"guidaction\");\r\n                    var recordXpath = xpathContext || self.properties.xpathContext;\r\n                    switch(type) {\r\n                        case \"Process\":\r\n                            if(idStartScope) {\r\n                                self.processStartForm({\r\n                                    guidprocess: guidprocess,\r\n                                    idStartScope: idStartScope,\r\n                                    title: title,\r\n                                    xpathContext: xpathContext,\r\n                                    recordXpath: recordXpath\r\n                                });\r\n                            }\r\n                            break;\r\n                        case \"Form\":\r\n\r\n                            var action = {\r\n                                guidProcess: guidprocess,\r\n                                idStartScope: idStartScope,\r\n                                editMode: true,\r\n                                xpathContext: xpathContext,\r\n                                readOnlyForm: readOnlyForm,\r\n                                idEntity: idEntity,\r\n                                recordXpath: recordXpath\r\n                            };\r\n\r\n                            if(action.xpathContext) {\r\n                                self.processActionFormCollection(action);\r\n                            } else {\r\n                                //Add parameters if action form\r\n                                var extraParameters = {};\r\n                                var dataAction = self.value.filter(function (item) {\r\n                                    return item.guidAction == guidAction;\r\n                                });\r\n                                if (dataAction.length > 0) {\r\n                                    extraParameters = {\r\n                                        actionType: \"Form\",\r\n                                        contextType: \"entitytemplate\",\r\n                                        guidEntity: self.properties.guidEntity || dataAction[0].guidEntity\r\n                                    }\r\n                                }\r\n                                self.processActionForm($.extend(action, extraParameters));\r\n                            }\r\n                            break;\r\n                        case \"Rule\":\r\n                            // Rules dont have forms or something like that\r\n                            break;\r\n                    }\r\n                });\r\n            });\r\n        });\r\n    },\r\n    /**\r\n     * Show container if it has actions\r\n     */\r\n    configureQueueVisibility: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var actionsToExecuteContainer = $(\".bz-action-launcher-actions-to-execute-container\", control);\r\n        var actionsToExecuteTitle = $(\".actions-to-execute-title\", control);\r\n        if(self.getValue().length > 0) {\r\n            actionsToExecuteContainer.show();\r\n            actionsToExecuteTitle.show();\r\n        } else {\r\n            actionsToExecuteContainer.hide();\r\n            actionsToExecuteTitle.hide();\r\n        }\r\n    }\r\n});","/**\r\n * Desktop definition of range control\r\n *\r\n * @author: Andres Fernando Munoz\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.range\", bizagi.rendering.range.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.range.extend(\"bizagi.rendering.desktop.range\", {}, {\r\n\r\n    /**\r\n     * Render a specific implementation for Desktop device\r\n     */\r\n    postRender: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n    },\r\n    /**\r\n     * Render actual value of control and set events\r\n     * @param data\r\n     */\r\n    setDisplayValue: function(data) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n    }\r\n\r\n});","/**\r\n * Desktop definition of range date control\r\n *\r\n * @author: Andres Fernando Munoz\r\n */\r\n\r\n// Extends from range desktop base\r\nbizagi.rendering.desktop.range.extend(\"bizagi.rendering.desktop.rangeDate\", bizagi.rendering.rangeDate.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.rangeDate.extend(\"bizagi.rendering.desktop.rangeDate\", {}, {\r\n\r\n    /**\r\n     * Render a specific implementation for Desktop device\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        self.defineRangeControl();\r\n    }\r\n});","/**\r\n * Desktop definition of range money control\r\n *\r\n * @author: Andres Fernando Munoz\r\n */\r\n\r\n// Extends from range desktop base\r\nbizagi.rendering.desktop.range.extend(\"bizagi.rendering.desktop.rangeMoney\", bizagi.rendering.rangeMoney.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.rangeMoney.extend(\"bizagi.rendering.desktop.rangeMoney\", {}, {\r\n\r\n\t/**\r\n\t * Render a specific implementation for Desktop device\r\n\t */\r\n\tpostRender: function() {\r\n        var self = this;\r\n        self.defineRangeControl();\r\n\t},\r\n\r\n\t/**\r\n\t * Render actual value of control and set events\r\n\t * @param data\r\n\t */\r\n\tsetDisplayValue: function(data) {\r\n\t\tvar self = this;\r\n\t\tvar control = self.getControl();\r\n\t}\r\n});","/**\r\n * Desktop definition of range number control\r\n *\r\n * @author: Andres Fernando Munoz\r\n */\r\n\r\n // Extends from range desktop base\r\nbizagi.rendering.desktop.range.extend(\"bizagi.rendering.desktop.rangeNumber\", bizagi.rendering.rangeNumber.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.rangeNumber.extend(\"bizagi.rendering.desktop.rangeNumber\", {}, {\r\n\r\n\t/**\r\n\t * Render a specific implementation for Desktop device\r\n\t */\r\n\tpostRender: function() {\t    \r\n\t    this.defineRangeControl();\r\n\t}\r\n});","/**\r\n * Desktop definition of entity template\r\n *\r\n * @author: Andrs Fernando Muoz\r\n * based on action launcher control\r\n */\r\n\r\nbizagi.rendering.desktop.actionLauncher.extend(\"bizagi.rendering.desktop.entityTemplate\", {}, {\r\n\r\n    /**\r\n     *\r\n     * @param data\r\n     */\r\n    initializeData: function(data) {\r\n        var self = this,\r\n            data = data || {},\r\n            properties = data.properties || {};\r\n\r\n        self._super(data);\r\n        self.properties.allowactions = (typeof properties.allowactions != \"undefined\") ? bizagi.util.parseBoolean(properties.allowactions) : false;\r\n        self.properties.templatetype = (typeof properties.templatetype != \"undefined\") ? properties.templatetype : 'default';\r\n    },\r\n\r\n    /**\r\n     * Render a specific implementation for Desktop device\r\n     */\r\n    postRender: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n        var html, template;\r\n        var control = self.getControl();\r\n\r\n        if (mode == \"design\" || !self.properties.surrogatedKey) {\r\n            return \"\";\r\n        }\r\n\r\n        self.configureQueueVisibility();\r\n\r\n        // Define params to get template\r\n        $.when(self.dataService.multiaction().getPropertyData(self.processPropertyValueDataTmplArgs))\r\n            .done(function (templateData) {\r\n\r\n                // Put the guidTemplate in the request for the multiaction loadtemplate.\r\n                if (typeof templateData.templateGuid !== \"undefined\" && templateData.templateGuid) {\r\n                    templateData.isDefaultTemplate = false;\r\n                    templateData.guidTemplate = templateData.templateGuid;\r\n                    delete templateData[\"templateGuid\"];\r\n                }\r\n\r\n                $.when(self.engine.render(templateData, self.processPropertyValueDataTmplArgs)).done(function (template) {\r\n                    var htmlTemplate = template;\r\n                    var actionsContainer = $(\".bz-action-launcher-actions-container\", control);\r\n                    template = self.renderFactory.getTemplate(\"render-actionLauncher-horizontal\");\r\n\r\n                    if (properties.allowactions) {\r\n                        $.when(self.dataService.multiaction().getActions(self.processPropertyValueArgs)).done(function(response) {\r\n                            self.deferredActions.resolve(response);\r\n                            var actions = bizagi.clone(response);\r\n                            var moreActionsManager = self.moreActionsManager(actions);\r\n                            var isMoreActions = moreActionsManager.isMoreActions;\r\n                            actions = moreActionsManager.actions;\r\n\r\n                            var html = $.fasttmpl(template, {actions: actions, template: true, isMoreActions: isMoreActions, allowactions: properties.allowactions});\r\n                            actionsContainer.append(html);\r\n                            actionsContainer.find('.actions-container.actions-container-template').append(htmlTemplate);\r\n\r\n                            self.configureHandlers();\r\n                        }).fail(function(error) {\r\n                            //TODO: do something\r\n                        });\r\n                    }\r\n                    else {\r\n                        var html = $.fasttmpl(template, {template: true, allowactions: properties.allowactions});\r\n\r\n                        actionsContainer.append(html);\r\n                        actionsContainer.find('.actions-container.actions-container-template').append(htmlTemplate);\r\n                    }\r\n                });\r\n            }).fail(function(error) {\r\n            //TODO: do something\r\n        });\r\n        self.engine.subscribe('onLoadDataNavigation', function (ev, params) {\r\n            bizagi.loader.start(\"entity-engine-view\").then(function () {\r\n                $(document).triggerHandler(\"showDialogWidget\", {\r\n                    widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_DIALOGNAV,\r\n                    data: params,\r\n                    modalParameters: {\r\n                        refreshInbox: false,\r\n                        title: params.data.displayName\r\n                    },\r\n                    maximizeOnly: false\r\n                });\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Add binding to html elements\r\n     */\r\n    configureHandlers: function() {\r\n        var self = this;\r\n        var formContainer = self.getFormContainer();\r\n        if(typeof formContainer.params.printversion === \"undefined\" || formContainer.params.printversion == false) {\r\n            var control = self.getControl();\r\n            var properties = self.properties;\r\n            var entityTemplateControls = $(\".action-launcher-control\", control);\r\n\r\n            // Binding for a tooltip when max items is excedded\r\n            self.configureMoreActionsHandler();\r\n\r\n            // Binding for click action on buttons\r\n            entityTemplateControls.on(\"click\", function() {\r\n                var action = {\r\n                    guidProcess: $(this).data(\"guidprocess\"),\r\n                    guidAction: $(this).data(\"guidaction\"),\r\n                    displayName: $(this).data(\"display-name\"),\r\n                    actionType: $(this).data(\"action-type\"),\r\n                    xpathContext: $(this).data(\"xpathcontext\"),\r\n                    xpathActions: self.properties.xpathActions || \"\"\r\n                };\r\n\r\n                if (action.actionType === \"Form\") {\r\n                    action.xpathContext = undefined;\r\n                    action.contextType = \"entitytemplate\";\r\n                    action.guidEntity = self.properties.guidEntity;\r\n                }\r\n                self.onActionClicked(action);\r\n            });\r\n        }\r\n\r\n\r\n    }\r\n});","/*  \r\n *   Name: BizAgi Desktop Render list Extension\r\n *   Author: Ivn Ricardo Taimal Narvez\r\n *   Comments:\r\n *   -   This script will redefine the list render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from render Desktop base\r\nbizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.checkList\", bizagi.rendering.checkList.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.checkList.extend(\"bizagi.rendering.desktop.checkList\", {}, {\r\n\r\n    /*\r\n     *   Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        // Call base \r\n        this._super();\r\n        // Set control container to behave as a block\r\n        control.addClass(\"ui-bizagi-render-display-block\");\r\n        self.properties.unique = Math.ceil(Math.random() * 1000);\r\n        // Apply plugin\r\n        $(\".ui-bizagi-render-checkList-label\", self.checkListGroup).check();\r\n    },\r\n\r\n    /*\r\n     *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        // Call base\r\n        self._super();\r\n        // Bind change event\r\n        if (!bizagi.util.isIE()) {\r\n            // PLUGIN IMPLEMENTATION\r\n            //todo: change bind type for IE\r\n            $(\"input[type=checkbox]\", self.checkListGroup).bind(\"change\", function (evt, ui) {\r\n                var itemId = $(this).data(\"item-guid\");\r\n                var checked = $(this).is(\":checked\");\r\n                self.updateDisplay($(this),checked);\r\n                self.onCheckListGroupChange(itemId, checked);\r\n            });\r\n        } else {\r\n            // NON PLUGIN IMPLEMENTATION\r\n            $(\"input[type=checkbox]\", self.checkListGroup).bind(\"change\", function (evt, ui) {\r\n                var itemId = $(this).data(\"item-guid\");\r\n                var checked = $(this).is(\":checked\");\r\n                self.updateDisplay($(this),checked);\r\n                self.onCheckListGroupChange(itemId, checked);\r\n            });\r\n        }\r\n    },\r\n\r\n    updateDisplay: function (element,checked) {\r\n        var self = this;\r\n        var item = element.closest(\".ui-bizagi-render-checkList-item\");\r\n        if (checked) {\r\n            item.addClass('checked');\r\n        } else {\r\n            item.removeClass('checked');\r\n        }\r\n    },\r\n\r\n    onCheckListGroupChange: function (itemId, checked) {\r\n        var self = this;\r\n        var item;\r\n        var items = $.grep(self.properties.items, function (element, index) {\r\n            return element.guid === itemId;\r\n        });\r\n        if (items && items.length > 0) {\r\n            item = items[0];\r\n        }\r\n        item.checked = checked;\r\n    },\r\n\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        if (!bizagi.util.isIE()) {\r\n            // PLUGIN IMPLEMENTATION\r\n            $(\"input[type=checkbox]\", self.checkListGroup).check(\"uncheckItem\");\r\n        }\r\n        else {\r\n            // NON PLUGIN IMPLEMENTATION\r\n            $(\"input[type=checkbox]\", self.checkListGroup).removeAttr(\"checked\");\r\n        }\r\n    },\r\n\r\n    setDisplayValue : function (value){\r\n        var self = this;\r\n    }\r\n\r\n});\r\n","/*  \r\n *   Name: BizAgi Desktop Render list Extension\r\n *   Author: Ivn Ricardo Taimal Narvez\r\n *   Comments:\r\n *   -   This script will redefine the list render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from base list\r\nbizagi.rendering.desktop.checkList.extend(\"bizagi.rendering.desktop.activityCheckList\", {}, {\r\n\r\n    /*\r\n     *   Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        // Call base\r\n        this._super();\r\n        self.addButton = $(\".ui-bizagi-render-checkList-add-item\", self.element);\r\n        self.newItemName = $(\".ui-bizagi-render-checkList-input-name\", self.control);\r\n        self.separator = $(\".ui-bizagi-render-checkList-separator\", self.element);\r\n        self.goalActivity = $(\".ui-bizagi-render-checkList-goal-activity\", self.element);\r\n        self.additionalElements(); \r\n        self.notifyLoadItems();\r\n\r\n    },\r\n\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"checkList-disabled\");\r\n        return $.fasttmpl(template, { items: this.value });\r\n    },\r\n\r\n    additionalElements: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var activityWorkTitle = this.getResource(\"render-activity-check-list-activitywork\") + \" (\" + self.properties.activityWork + \"%)\";\r\n        var activityFormTitle = this.getResource(\"render-activity-check-list-form\");\r\n\r\n        if (!(self.addButton && self.addButton.length > 0)) {\r\n            var $divContainer = $(\"<div/>\").addClass(\"ui-bizagi-render-checkList-add-item\");\r\n            $divContainer.append($(\"<h4 />\").text(bizagi.localization.getResource(\"workportal-project-plan-activity-work-title\")));\r\n            $divContainer.append($(\"<button class=''/>\").text(\"+ \" +  bizagi.localization.getResource(\"workportal-project-plan-activity-action-add\")));\r\n            self.element.prepend($divContainer);\r\n        }\r\n        if (!(self.separator && self.separator.length > 0)) {\r\n            self.element.append($(\"<div/>\").addClass(\"ui-bizagi-render-checkList-separator\").append($(\"<span/>\")));\r\n        }\r\n        if (!(self.goalActivity && self.goalActivity.length > 0)) {\r\n            if(self.properties.activityDescription && self.properties.activityDescription !== \"\"){\r\n                self.element.prepend($(\"<div/>\").addClass(\"ui-bizagi-render-checkList-goal-activity\").append(\"<h3><span class='ui-bizagi-wp-bold'>\" +\r\n                bizagi.localization.getResource(\"workportal-project-plan-activity-goal\") +\r\n                \": </span><span>\" + self.properties.activityDescription  + \"</span></h3>\"));\r\n            }\r\n        }\r\n    },\r\n\r\n    notifyLoadItems: function(){\r\n        var self = this;\r\n        setTimeout(function(){\r\n            self.triggerGlobalHandler(\"onLoadDataItemsFromFormActivityPlan\", { \"items\": self.properties.items, \"activityWork\": self.properties.activityWork });\r\n        }, 100);\r\n    },\r\n\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        this._super();\r\n        $(\".ui-bizagi-render-checkList-add-item button\", self.element).unbind(\"click\").click(function () {\r\n            var itemSelected = $(\".ui-bizagi-render-checkList-item.selected\", self.control);\r\n            if (itemSelected.length <= 0) {\r\n                self.prepareNewItem();\r\n            } else {\r\n                $(\".ui-bizagi-render-checkList-input-name\", itemSelected).focus();\r\n            }\r\n        });\r\n\r\n        $(\".item-button.delete\", self.checkListGroup).bind(\"click\", function (evt, ui) {\r\n            var itemId = $(this).closest(\".ui-bizagi-render-checkList-item\").data(\"item-guid\");\r\n            self.deleteItem(itemId);\r\n        });\r\n\r\n        $(\"label.item-name\", self.checkListGroup).bind(\"click\", function (evt, ui) {\r\n            var itemSelected = $(this).closest(\".ui-bizagi-render-checkList-item\");\r\n            var itemId = itemSelected.data(\"item-guid\");\r\n            self.selectItem(itemId);\r\n        });\r\n    },\r\n\r\n    selectItem: function (itemId) {\r\n        var self = this;\r\n        for (var i = 0; i < self.properties.items.length; i++) {\r\n            if (self.properties.items[i].guid === itemId) {\r\n                self.properties.items[i].selected = true;\r\n            } else {\r\n                self.properties.items[i].selected = false;\r\n            }\r\n        }\r\n        self.repaintControl();\r\n        var itemSelected = $(\".ui-bizagi-render-checkList-item.selected\");\r\n        var itemSelectedName = $(\".ui-bizagi-render-checkList-input-name\", itemSelected);\r\n        var itemContent = itemSelectedName.val();\r\n        itemSelectedName.focus();\r\n        itemSelectedName[0].setSelectionRange(itemContent.length, itemContent.length);\r\n        self.configureHandlers();\r\n        self.addSelectedHandlers();\r\n    },\r\n\r\n    deleteItem: function (itemId) {\r\n        var self = this;\r\n        for (var i = 0; i < self.properties.items.length ; i++) {\r\n            if (self.properties.items[i].guid === itemId) {\r\n                self.properties.items.splice(i,1);\r\n                break;\r\n            }\r\n        }\r\n        self.setValue(self.properties.items);\r\n        self.repaintControl();\r\n        self.configureHandlers();\r\n        self.refreshValue(self.properties.items);\r\n    },\r\n\r\n    prepareNewItem: function () {\r\n        var self = this;\r\n        var newItem = {\r\n            guid: Math.guid(),\r\n            resolved: false,\r\n            name: \"\",\r\n            selected: true\r\n        };\r\n        self.properties.items.push(newItem);\r\n        self.repaintControl();\r\n        self.configureHandlers();\r\n        self.addSelectedHandlers();\r\n    },\r\n\r\n    addSelectedHandlers: function () {\r\n        var self = this;\r\n        var itemSelected = $(\".ui-bizagi-render-checkList-item.selected\", self.control);\r\n        var itemSelectedName = $(\".ui-bizagi-render-checkList-input-name\", itemSelected);\r\n        itemSelectedName.focus();\r\n        itemSelectedName.blur(function () {\r\n            var newItemName = itemSelectedName.val();\r\n            if (newItemName && newItemName !== \"\") {\r\n                self.addItem();\r\n            }\r\n            else {\r\n                self.properties.items.splice(self.properties.items.length - 1, 1);\r\n                self.setValue(self.properties.items);\r\n                self.repaintControl();\r\n                self.configureHandlers();\r\n            }\r\n        });\r\n        itemSelectedName.keypress(function (event) {\r\n            if (event.which == 13) {\r\n                event.preventDefault();\r\n                var newItemName = itemSelectedName.val();\r\n                if (newItemName && newItemName !== \"\") {\r\n                    self.addItem();\r\n                    self.prepareNewItem();\r\n                }\r\n            }\r\n        });\r\n    },\r\n\r\n    addItem: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var itemSelected = $(\".ui-bizagi-render-checkList-item.selected\", self.control);\r\n        var itemSelectedName = $(\".ui-bizagi-render-checkList-input-name\", itemSelected);\r\n        var newItemName = itemSelectedName.val();\r\n        self.addButton.show();\r\n        $.each(self.properties.items, function (index, item) {\r\n            if (item.selected) {\r\n                item.name = newItemName;\r\n                item.selected = false;\r\n            }\r\n        });\r\n        self.updateOriginalValue();\r\n        self.setValue(self.properties.items);\r\n        self.repaintControl();\r\n        self.configureHandlers();\r\n        self.refreshValue(self.properties.items);\r\n    },\r\n\r\n    repaintControl: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var checkListHtml = self.renderControl();\r\n        $(\".ui-bizagi-render-checkList\", self.control).replaceWith(checkListHtml);\r\n        self.postRender();\r\n    },\r\n\r\n    onCheckListGroupChange: function (itemId, checked) {\r\n        var self = this;\r\n        var item;\r\n        var items = $.grep(self.properties.items, function (element, index) {\r\n            return element.guid === itemId;\r\n        });\r\n        if (items && items.length > 0) {\r\n            item = items[0];\r\n        }\r\n        item.resolved = checked;\r\n        self.setValue(self.properties.items);\r\n        self.refreshValue(self.properties.items);\r\n    },\r\n\r\n    refreshValue: function(items){\r\n        var self = this,\r\n            control = self.getControl(),\r\n            length = items.length,\r\n            completed = 0;\r\n\r\n        for (var i = 0; i < length; i++) { \r\n            if (items[i].resolved) {\r\n                completed += 1;\r\n            }\r\n        }\r\n\r\n        if (length > 0) {\r\n            self.properties.activityWork = Math.floor(100 * completed / length);\r\n        }\r\n        else {\r\n            self.properties.activityWork = 0;\r\n        }\r\n\r\n        var html = this.getResource(\"render-activity-check-list-activitywork\") + \" (\" + self.properties.activityWork + \"%)\";\r\n        $(\".ui-bizagi-render-checkList-activity-work span\", self.element).html(html);\r\n        self.triggerGlobalHandler(\"onLoadDataItemsFromFormActivityPlan\", { \"items\": self.properties.items, \"activityWork\": self.properties.activityWork });\r\n    },\r\n\r\n    getValue: function (data) {\r\n        var self = this;\r\n        return self.value || [];\r\n    },\r\n\r\n    controlValueIsChanged: function () {\r\n        var self = this;\r\n        var originalValue = JSON.stringify(self.properties.originalValue);\r\n        var newValue = JSON.stringify(self.value);\r\n        return originalValue !== newValue;\r\n    },\r\n\r\n    /**\r\n     * Validate if all checked items on activity\r\n     * @returns {boolean}\r\n     */\r\n    allCheckedItems: function (){\r\n        var self = this;\r\n        var response = false;\r\n        if(Array.isArray(self.value)){\r\n            response = self.value.every(function(item){\r\n                return item.resolved == true;\r\n            });\r\n        }\r\n        return response;\r\n    },\r\n\r\n    /*\r\n     *   Updates original value for some comparisons\r\n     */\r\n    updateOriginalValue: function () {\r\n        var self = this;\r\n        self.properties.originalValue = bizagi.clone(self.value);\r\n    },\r\n    /*\r\n     *   Add the render data to the given collection in order to send data to the server\r\n     */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Add the render value\r\n        var xpath = properties.xpath;\r\n        var value = self.getValue();\r\n        var idActivity = self.properties.idActivity;\r\n\r\n        var validationResolvedItems = true;\r\n        var lastActionButton = self.getFormContainer().getLastActionButton();\r\n        if(lastActionButton && lastActionButton.action == \"next\"){\r\n            validationResolvedItems = self.allCheckedItems();\r\n        }\r\n\r\n        if (self.controlValueIsChanged() && validationResolvedItems) {\r\n            // Filter by valid xpaths and valid values\r\n            if (!bizagi.util.isEmpty(xpath) && !bizagi.util.isEmpty(idActivity)) {\r\n                if (Array.isArray(value)) {\r\n                    var data = {\r\n                        idActivity: idActivity,\r\n                        items: value\r\n                    };\r\n                    renderValues[properties.xpath] = JSON.stringify(data);\r\n                } else if (value === \"\") {\r\n                    renderValues[properties.xpath] = \"\";\r\n                }\r\n            }\r\n        }\r\n    },\r\n    isValid: function (invalidElements) {\r\n        var self = this,\r\n            properties = self.properties,\r\n            message;\r\n        var items = self.getValue();\r\n        var valid = true;\r\n        message = self.getResource(\"render-activity-check-list-validation\");\r\n        for (var i = 0; i < items.length; i+=1) {\r\n            var item = items[i];\r\n            if (!item.resolved) {\r\n                invalidElements.push({\r\n                    xpath: properties.xpath,\r\n                    message: message\r\n                });\r\n                valid = false;\r\n                break;\r\n            }\r\n        }\r\n        return valid;\r\n    }\r\n\r\n});\r\n","/**\r\n * Device definition of Polymorphic launcher\r\n *\r\n * @author: Edward J Morales\r\n */\r\n\r\n // Extends from render desktop base\r\n bizagi.rendering.desktop.render.extend(\"bizagi.rendering.desktop.polymorphicLauncher\", bizagi.rendering.polymorphicLauncher.prototype);\r\n // Extends itself\r\n bizagi.rendering.desktop.polymorphicLauncher.extend(\"bizagi.rendering.desktop.polymorphicLauncher\", {}, {\r\n\t/**\r\n\t * Render a specific implementation for Desktop device\r\n\t */\r\n\tpostRender: function() {\r\n\t\tvar self = this;\r\n\t\tvar properties = self.properties;\r\n\t\tvar mode = self.getMode();\r\n\t\tvar html, template;\r\n\t\tvar def = new $.Deferred();\r\n\r\n\t\tif(mode == \"design\" || !self.properties.surrogatedKey) {\r\n\t\t\treturn \"\";\r\n\t\t}\r\n\r\n\t\tself.configureQueueVisibility();\r\n\r\n\t\t/**\r\n\t\t * Render a template\r\n\t\t * @param template\r\n\t\t * @param templateArguments\r\n\t\t */\r\n\t\tfunction appendContent(template, templateArguments) {\r\n\t\t\tvar control = self.getControl();\r\n\t\t\tvar actionsContainer = $(\".bz-action-launcher-actions-container\", control);\r\n\t\t\thtml = $.fasttmpl(template, templateArguments);\r\n\t\t\tactionsContainer.append(html);\r\n\t\t\tif(self.properties.readOnly !== true) {\r\n\t\t\t\tself.configureHandlers();\r\n\t\t\t}\r\n\r\n\t\t\tdef.resolve(actionsContainer);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Define params to get list of actions\r\n\t\t */\r\n\t\t$.when(self.dataService.multiaction().getPolymorphicActions(self.processPropertyValueArgs)).done(function(response) {\r\n\t\t\t// Convert default response to tree data structure\r\n\t\t\tresponse = self.dataService.serializePolymorphicActions(response);\r\n\r\n\r\n\t\t\tself.totalActions = bizagi.clone(response);\r\n\t\t\tvar actions = bizagi.clone(response);\r\n\r\n\t\t\tself.lessActions = bizagi.clone(actions);\r\n\r\n\r\n\t\t\t// NOTE: Code extracted\r\n\t\t\tvar templateArguments = {\r\n\t\t\t\tactions: actions,\r\n\t\t\t\tallowSearch: properties.allowSearch,\r\n\t\t\t\ttreeActionsList: self.getTreeItems(actions)\r\n\t\t\t};\r\n\t\t\ttemplate = self.renderFactory.getTemplate(\"render-polymorphicLauncher-vertical-tree\");\r\n\r\n\t\t\tappendContent(template, templateArguments);\r\n\r\n\t\t}).fail(function(error) {\r\n\t\t\tdef.fail(error);\r\n\t\t});\r\n\r\n\t\treturn def.promise();\r\n\t},\r\n\r\n\t/**\r\n\t * Get rendered html of each node of constructors\r\n\t * @param actions\r\n\t * @param level\r\n\t * @return {string}\r\n\t */\r\n\tgetTreeItems: function(actions, level) {\r\n\t\tvar self = this;\r\n        var item = \"<ul>\";\r\n\t\tvar templateTreeItem = self.renderFactory.getTemplate(\"render-polymorphicLauncher-vertical-tree-item\");\r\n\t\tactions = actions || {};\r\n\t\tlevel = level || 1;\r\n\r\n\t\t$.each(actions, function(key, value) {\r\n\t\t\titem += $.fasttmpl(templateTreeItem, value);\r\n\r\n\t\t\tif(value.children) {\r\n\t\t\t\titem += self.getTreeItems(value.children, level + 1);\r\n\t\t\t}\r\n\t\t});\r\n        item += \"</ul>\";\r\n\t\treturn item;\r\n\t},\r\n\r\n\t/**\r\n\t * Add binding to html elements\r\n\t */\r\n\tconfigureHandlers: function() {\r\n\t\tvar self = this;\r\n\t\tvar control = self.getControl();\r\n        var formContainer = self.getFormContainer();\r\n        if(typeof formContainer.params.printversion === \"undefined\" || formContainer.params.printversion == false) {\r\n            var actionLauncherControls = $(\".ui-bizagi-render-polymorphicLauncher-list li>span\", control);\r\n\r\n            //Binding for click action on buttons\r\n            actionLauncherControls.on(\"click\", function() {\r\n                var $targetData = $(this).parent();\r\n                var action = {\r\n                    guidEntity: $targetData.data(\"guidentity\"),\r\n                    guidObject: $targetData.data(\"guidobject\"),\r\n                    guidConstructor: $targetData.data(\"guidconstructor\"),\r\n                    displayName: $targetData.data(\"display-name\"),\r\n                    actionType: $targetData.data(\"action-type\"),\r\n                    xpathContext: $targetData.data(\"xpathcontext\")\r\n                };\r\n                self.onActionClicked(action);\r\n            });\r\n            //Catch the typed text in the search field and filter the action list\r\n            $.expr[\":\"].FilterAction = function(entity, i, array) {\r\n                var search = array[3];\r\n                if(!search) {\r\n                    return false;\r\n                }\r\n                return new RegExp(search, \"i\").test($(entity).text());\r\n            };\r\n            $(\"input#ui-bizagi-render-action-launcher-filter-input\", control).keyup(function() {\r\n                var search = $(this).val();\r\n\r\n                if(search) {\r\n                    // Hide all nodes\r\n                    $(\"li\", control).hide(0);\r\n                    // Show only the nodes that match with the respective search pattern\r\n                    $(\"li[data-hasconstructor='true']\", control).filter(\":FilterAction(\" + search + \")\").show(0, function() {\r\n                        var actualValue = $(\"label\", this).html();\r\n                        var $node = $(this);\r\n                        var path = $node.data(\"parents\") + $node.data(\"title\");\r\n                        // Set value to cache\r\n                        if(!$node.data(\"cachedvalue\")) {\r\n                            $node.data(\"cachedvalue\", actualValue);\r\n                        }\r\n                        $(\"label\", this).html(path);\r\n                    });\r\n                } else {\r\n                    $(\"li\", control).show(0, function() {\r\n                        var cachedValue = $(this).data(\"cachedvalue\");\r\n                        $(\"label\", this).html(cachedValue);\r\n                    });\r\n                }\r\n            });\r\n        }\r\n\t},\r\n\r\n\t/**\r\n\t * Execute an Action\r\n\t * @param action\r\n\t */\r\n\tonActionClicked: function(action) {\r\n\t\tvar self = this;\r\n\r\n\t\t$.when(self.actionManager(action)).done(function(act) {\r\n\t\t\tself.executeAction(act);\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Show a message when action has been executed\r\n\t * @param status\r\n\t * @param action\r\n\t */\r\n\tnotifyExecution: function(status, action) {\r\n\t\tvar self = this;\r\n\t\tvar notifications = new bizagi.INotifications();\r\n\t\tif(status == \"success\") {\r\n\t\t\tnotifications.showSucessMessage(printf(self.getResource(\"render-action-launcher-success-excecution\"), action.displayName), null, {});\r\n\t\t} else {\r\n\t\t\tnotifications.showErrorMessage(printf(self.getResource(\"render-action-launcher-failed-excecution\"), action.displayName), null, {});\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Show a dialog with a form\r\n\t * @param action\r\n\t * @return {*}\r\n\t */\r\n\tprocessActionForm: function(action) {\r\n\t\tvar self = this;\r\n\t\tvar properties = self.properties;\r\n\t\tvar form = self.getFormContainer();\r\n\t\tvar additionalXpaths = self.properties.additionalXpath.join(\",\");\r\n\t\tvar def = new $.Deferred();\r\n\t\tvar xpathContext = action.xpathContext || \"\";\r\n\t    var surrogatedKey;\r\n\t\tif (self.properties.type !== \"polymorphicLauncher\") {\r\n\t\t    surrogatedKey = (typeof self.properties.surrogatedKey == \"object\" && self.properties.surrogatedKey.length > 1) ? self.properties.surrogatedKey : self.properties.surrogatedKey[0];\r\n\t\t}\r\n\t\t\r\n\t\tvar recordXpath = self.properties.recordXpath;\r\n\t\t\r\n\t\t// Show dialog with new form after that\r\n\t\tvar dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n\t\t\ttitle: properties.detailLabel || bizagi.localization.getResource(\"render-grid-details-form\"),\r\n\t\t\tshowSaveButton: true,\r\n\t\t\tcancelButtonLabel: bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n\t\t\tonSave: function(data) {\r\n\t\t\t\tvar pageCache = data.idPageCache;\r\n\t\t\t\tdata.idPageCache = null;\r\n\t\t\t\t// Submit the form\r\n\t\t\t\treturn self.dataService.multiaction().submitData({\r\n\t\t\t\t\taction: \"SAVE\",\r\n\t\t\t\t\tdata: data,\r\n\t\t\t\t\txpathContext: dialog.form.properties.xpathContext, //self.properties.xpathContext,\r\n\t\t\t\t\tidPageCache: pageCache,\r\n\t\t\t\t\tisOfflineForm: false,\r\n\t\t\t\t\tisActionStartForm: true\r\n\t\t\t\t}).pipe(function(savedData) {\r\n\t\t\t\t\tif(!action.editMode && self.countSameActions(action) == 0) {\r\n\t\t\t\t\t\taction.idStartScope = savedData.IdScope;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdef.resolve(savedData.IdScope);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tonCancel: function(data) {\r\n\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tdialog.render({\r\n\t\t\t\"idForm\": action.guidObject,\r\n\t\t\t\"contextType\": \"entity\",\r\n\t\t\t\"guidEntity\": action.guidEntity,\r\n\t\t\t\"idCase\": self.properties.caseId,\r\n\t\t\t\"idWorkitem\": form.properties.typeForm != \"SummaryForm\" ? bizagi.context.idWorkitem : undefined,\r\n\t\t\t\"additionalXpaths\": additionalXpaths,\r\n\t\t\t//\"xpathContext\": xpathContext,\r\n\t\t\t\"idStartScope\": action.idStartScope,\r\n\t\t\t\"surrogateKey\": surrogatedKey,\r\n\t\t\t\"recordXpath\": recordXpath\r\n\t\t});\r\n\r\n\t\treturn def.promise();\r\n\t},\r\n\r\n\t/**\r\n\t * Process a start form\r\n\t * @param args\r\n\t * @return {*}\r\n\t */\r\n\tprocessStartForm: function(args) {\r\n\t\tvar self = this;\r\n\t\tvar properties = self.properties;\r\n\t\tvar form = self.getFormContainer();\r\n\t\tvar def = new $.Deferred();\r\n\t    var surrogatedKey;\r\n\t\tif (self.properties.type !== \"polymorphicLauncher\") {\r\n\t\t    surrogatedKey = (typeof self.properties.surrogatedKey == \"object\" && self.properties.surrogatedKey.length > 1) ? self.properties.surrogatedKey : self.properties.surrogatedKey[0];\r\n\t\t}\r\n\t\targs = args || {};\r\n\r\n\t\tvar dialog = new bizagi.rendering.dialog.startForm(self.dataService, self.renderFactory, {\r\n\t\t\t//showSaveButton: properties.editable,\r\n\t\t\tmaximized: properties.maximized,\r\n\t\t\ttitle: args.title || \"\",\r\n\t\t\tsaveButtonLabel: (self.typeForm == \"GlobalForm\" || this.typeForm == \"SummaryForm\") ? bizagi.localization.getResource(\"render-form-button-create\") : bizagi.localization.getResource(\"render-form-dialog-box-save\"),\r\n\t\t\tonSave: function(data) {\r\n\t\t\t\tform.startLoading();\r\n\r\n\t\t\t\t// Submit the form\r\n\t\t\t\treturn self.dataService.multiaction().submitData({\r\n\t\t\t\t\taction: \"SAVE\",\r\n\t\t\t\t\tdata: data,\r\n\t\t\t\t\txpathContext: self.properties.xpathContext,\r\n\t\t\t\t\tidPageCache: data.idPageCache,\r\n\t\t\t\t\tisOfflineForm: false,\r\n\t\t\t\t\tisActionStartForm: true\r\n\t\t\t\t}).pipe(function(savedData) {\r\n\t\t\t\t\tform.endLoading();\r\n\t\t\t\t\tdef.resolve(savedData.IdScope);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tdialog.render({\r\n\t\t\tguidprocess: args.guidprocess,\r\n\t\t\tidStartScope: args.idStartScope,\r\n\t\t\tidCase: self.properties.caseId,\r\n            idWorkitem: form.properties.typeForm != \"SummaryForm\" ? bizagi.context.idWorkitem : undefined,\r\n\t\t\tadditionalXpaths: self.properties.additionalXpath.join(\",\"),\r\n\t\t\tsurrogatedKey: surrogatedKey,\r\n            recordXpath: args.recordXpath,\r\n            mappingstakeholders: true\r\n\t\t});\r\n\r\n\t\treturn def.promise();\r\n\t},\r\n\r\n\t/**\r\n\t * Execute and action if a form is global form or summary, or send to queue\r\n\t * @param action\r\n\t */\r\n\texecuteAction: function(action) {\r\n\t\tvar self = this;\r\n\r\n\t\tif (self.typeForm == \"GlobalForm\" || self.typeForm == \"SummaryForm\") {\r\n\t\t\t$.when(bizagi.showConfirmationBox(bizagi.localization.getResource(\"render-action-launcher-immediatly-action-confirmation\"), null, false)).done(function(response) {\r\n\t\t\t\tself.executeActionImmediately(action);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tself.addActionToQueue(action);\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Show confirmation dialog\r\n\t * @param action\r\n\t */\r\n\tshowConfirmationDialog: function(action) {\r\n\t\tvar self = this;\r\n\t\tself.confirmTemplate = self.renderFactory.getTemplate(\"render-polymorphicLauncher-confirm\");\r\n\t\tvar message = bizagi.localization.getResource(\"render-action-launcher-single-action-confirmation\");\r\n\t\tvar confirmContent = $.tmpl(self.confirmTemplate, {confirmationMessage: message});\r\n\t\tvar confirmContentParams = {\r\n\t\t\tresizable: false,\r\n\t\t\tmodal: true,\r\n\t\t\ttitle: \"Bizagi\",\r\n\t\t\tbuttons: []\r\n\t\t};\r\n\t\tconfirmContentParams.buttons = [\r\n\t\t\t{\r\n\t\t\t\ttext: bizagi.localization.getResource(\"render-boolean-yes\"),\r\n\t\t\t\tclick: function() {\r\n\t\t\t\t\tself.setValue([]);\r\n\t\t\t\t\t$.when(self.actionManager(action)).done(function(act) {\r\n\t\t\t\t\t\tself.executeAction(act);\r\n\t\t\t\t\t});\r\n\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttext: bizagi.localization.getResource(\"render-boolean-no\"),\r\n\t\t\t\tclick: function() {\r\n\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t];\r\n\t\t$(confirmContent).dialog(confirmContentParams);\r\n\t},\r\n\r\n\t/**\r\n\t * Render actual value of control and set events\r\n\t * @param data\r\n\t */\r\n\tsetDisplayValue: function(data) {\r\n\t\tvar self = this;\r\n\t\tvar control = self.getControl();\r\n\t\tvar actionsToExecuteContainer = $(\".bz-action-launcher-actions-to-execute-container\", control);\r\n\t\tvar template = self.renderFactory.getTemplate(\"render-polymorphicLauncher-actions-to-execute\");\r\n\t\tself.configureQueueVisibility();\r\n\r\n\t\t$.when($.fasttmpl(template, {actions: data})).done(function(html) {\r\n\t\t\tactionsToExecuteContainer.empty();\r\n\t\t\tactionsToExecuteContainer.append(html);\r\n\t\t\tvar removeActionSelector = $(\".action-to-execute-control i\", actionsToExecuteContainer);\r\n\t\t\tvar openActionSelector = $(\".action-to-execute-control label\", actionsToExecuteContainer);\r\n\t\t\tremoveActionSelector.bind(\"click\", function() {\r\n\t\t\t\tvar index = $(this).parent().data(\"index\");\r\n\t\t\t\tself.removeActionToQueue(index);\r\n\t\t\t});\r\n\t\t\topenActionSelector.bind(\"click\", function() {\r\n\t\t\t\tvar $target = $(this).parent();\r\n\t\t\t\tvar type = $target.data(\"actiontype\");\r\n\t\t\t\tvar guidprocess = $target.data(\"guidprocess\");\r\n\t\t\t\tvar idStartScope = $target.data(\"idstartscope\");\r\n\t\t\t\tvar title = $target.data(\"title\");\r\n\t\t\t    var xpathContext = $target.data(\"xpathcontext\");\r\n\t\t\t\tvar idEntity = $target.data(\"identity\") || \"\";\r\n\t\t\t\tvar guidEntity = $target.data(\"guidentity\");\r\n                var recordXpath = xpathContext || self.properties.xpathContext;\r\n\r\n\t\t\t\tswitch(type) {\r\n\t\t\t\t\tcase \"Process\":\r\n\t\t\t\t\t\tif(idStartScope) {\r\n\t\t\t\t\t\t\tself.processStartForm({\r\n\t\t\t\t\t\t\t\tguidprocess: guidprocess,\r\n\t\t\t\t\t\t\t\tidStartScope: idStartScope,\r\n\t\t\t\t\t\t\t\ttitle: title,\r\n\t\t\t\t\t\t\t\txpathContext: xpathContext,\r\n                                recordXpath: recordXpath\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Form\":\r\n\t\t\t\t\t\tvar action = {\r\n\t\t\t\t\t\t\tguidProcess: guidprocess,\r\n\t\t\t\t\t\t\tidStartScope: idStartScope,\r\n\t\t\t\t\t\t\teditMode: true,\r\n\t\t\t\t\t\t\txpathContext: xpathContext,\r\n\t\t\t\t\t\t\tidEntity: idEntity,\r\n\t\t\t\t\t\t\tguidEntity: guidEntity,\r\n\t\t\t\t\t\t\tguidObject: guidprocess\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\tself.processActionForm(action);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Rule\":\r\n\t\t\t\t\t\t// Rules dont have forms or something like that\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Show container if it has actions\r\n\t */\r\n\tconfigureQueueVisibility: function() {\r\n\t\tvar self = this;\r\n\t\tvar control = self.getControl();\r\n\t\tvar actionsToExecuteContainer = $(\".bz-action-launcher-actions-to-execute-container\", control);\r\n\t\tvar actionsToExecuteTitle = $(\".actions-to-execute-title\", control);\r\n\t\tif(self.getValue().length > 0) {\r\n\t\t\tactionsToExecuteContainer.show();\r\n\t\t\tactionsToExecuteTitle.show();\r\n\t\t} else {\r\n\t\t\tactionsToExecuteContainer.hide();\r\n\t\t\tactionsToExecuteTitle.hide();\r\n\t\t}\r\n\t}\r\n});","/*\r\n*   Name: BizAgi Desktop Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from columns desktop base\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.combo\", bizagi.rendering.columns.combo.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.columns.combo.extend(\"bizagi.rendering.desktop.columns.combo\", {}, {\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell, tableCell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell, tableCell);\r\n\r\n        var self = this,\r\n            mode = self.getMode();\r\n\r\n        // Apply styles to input\r\n        var input = $(\".ui-selectmenu-status\", cell);\r\n        this.applyColumnStyles(input);\r\n\r\n        // Remove padding for td\r\n        if (this.properties.editable && tableCell) {\r\n            tableCell.addClass(\"ui-bizagi-cell-combo\");\r\n        }\r\n\r\n        if (mode === \"execution\") {\r\n\r\n            var decorated = this.getDecorated(surrogateKey),\r\n                control = decorated.getControl();\r\n\r\n            // Check if its new row\r\n            if (control.parents(\"tr\").data(\"new-row\")) {\r\n                //Set the column with this attribute, so when the control is evaluated in isValid(), validated\r\n                //also if it is required, and belongs from a new row\r\n                self.isNewRow = true;\r\n            } else {\r\n                self.isNewRow = false;\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function (surrogateKey, cell, tableCell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell, tableCell);\r\n\r\n        // Apply styles to input\r\n        var input = $(\".ui-selectmenu-status\", cell);\r\n        this.applyColumnStyles(input);\r\n\r\n        // Add padding for td\r\n        if (tableCell)\r\n            tableCell.removeClass(\"ui-bizagi-cell-combo\");\r\n    },\r\n\r\n    /*\r\n     *   Apply custom overrides to each decorated instance\r\n     */\r\n    applyOverrides: function(decorated) {\r\n        var self = this;\r\n        this._super(decorated);\r\n        // Hacks the upload render to add features\r\n        decorated.getUploadXpath = this.getUploadXpath;\r\n\r\n        decorated.cleanData = function() {\r\n            var self = this;\r\n\r\n            self.value = self.properties.value = self.selectedValue = { id: 0, value: self.getResource(\"render-combo-empty-value\") };\r\n            self.setValue(self.value);\r\n            var control = self.getControl();\r\n            var input = control.find(\"input\");\r\n            if (input) {\r\n                input.val(self.getValue().value);\r\n            }\r\n        };\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop Render Document Generator Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the document generator render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from columns desktop base\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.document\", bizagi.rendering.columns.document.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.columns.document.extend(\"bizagi.rendering.desktop.columns.document\", {}, {\r\n\r\n    /**\r\n     * Apply custom overrides to each decorated instance\r\n     * @param decorated\r\n     */\r\n    applyOverrides: function (decorated) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        self._super(decorated);\r\n\r\n        decorated.getControlHtml = self.getControlHtml;\r\n\r\n        if (mode !== \"design\") {\r\n            self.surrogateKey = decorated.surrogateKey;\r\n\r\n            decorated.getXpath = this.getXpath;\r\n            decorated.getDocumentXpath = this.getDocumentXpath;\r\n            decorated.getContextXpath = this.getContextXpath;\r\n            decorated.documentTemplateGenerate = this.documentTemplateGenerate;\r\n            decorated.preRenderControl = this.preRenderControl;\r\n            decorated.deleteDocumentTemplate = this.deleteDocumentTemplate;\r\n            decorated.getTemplateItem = this.getTemplateItem;\r\n            decorated.properties.xpathContext = self.getContextXpath();\r\n        }\r\n    },\r\n\r\n    getTemplateItem: function () {\r\n        return \"document-column-item\";\r\n    },\r\n\r\n    /**\r\n     * Creates the event of generation of templates.\r\n     */\r\n    documentTemplateGenerate: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        self.startLoading();\r\n        //Get the context xPath\r\n        properties.xpathcontext = self.getContextXpath();\r\n        properties.xpath = self.getDocumentXpath(properties.xpath);\r\n        properties.buttonExecuted = true;\r\n\r\n        var grid = self.parent;\r\n        var form = self.getFormContainer();\r\n\r\n        $.when(form.submitData())\r\n            .done(function () {\r\n                $.when(self.dataService.generateDocumentTemplate(properties))\r\n                    .done(function (response) {\r\n                        $.when(grid.refresh())\r\n                            .done(function () {\r\n                                self.autoOpenDocuments();\r\n                            });\r\n\r\n                        self.endLoading();\r\n                    }).fail(function () {\r\n                    self.showErrorMessage();\r\n                    self.endLoading();\r\n                });\r\n            }).fail(function (message) {\r\n            // Add error messages\r\n            self.getFormContainer().addErrorMessage(message);\r\n            self.endLoading();\r\n        });\r\n\r\n        properties.buttonExecuted = false;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @param template\r\n     * @param mode\r\n     * @param downloadalldocuments\r\n     * @param allowGenerate\r\n     * @param properties\r\n     * @param noFiles\r\n     * @returns {*}\r\n     */\r\n    getControlHtml: function (template, mode, downloadalldocuments, allowGenerate, properties, noFiles) {\r\n        var self = this;\r\n        var isInlineRow = true;\r\n\r\n        for (var i = 0; i < self.parent.properties.data.rows.length; i++) {\r\n            if (self.parent.properties.data.rows[i][0] == self.surrogateKey) {\r\n                isInlineRow = false;\r\n                break;\r\n            }\r\n        }\r\n\r\n        var html = $.fasttmpl(template, {\r\n            noActivateButton: isInlineRow,\r\n            editable: mode !== \"execution\",\r\n            downloadalldocuments: downloadalldocuments,\r\n            required: properties.required,\r\n            allowgenerate: allowGenerate,\r\n            xpath: self.getXpath(properties.xpath),\r\n            append: properties.append ? properties.append : false,\r\n            caption: properties.caption,\r\n            noFiles: noFiles,\r\n            allowSendInMail: properties.allowSendInMail,\r\n            mode: mode\r\n        });\r\n\r\n        return html.replace(\"ui-bizagi-document-upload-item-design\", \"ui-bizagi-document-upload-item-design-column\");\r\n    },\r\n\r\n    /**\r\n     * Apply custom overrides to each decorated instance\r\n     * @param xpath\r\n     * @returns {string}\r\n     */\r\n    getXpath: function (xpath) {\r\n        var xpathPath = xpath;\r\n        var index = xpathPath.indexOf(this.grid.properties.xpath);\r\n\r\n        if (index != -1) {\r\n            xpathPath = xpathPath.substr(index + this.grid.properties.xpath.length + 1);\r\n        }\r\n\r\n        return this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"].\" + xpathPath;\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used\r\n     * @param xpath\r\n     * @returns {*|string}\r\n     */\r\n    getDocumentXpath: function (xpath) {\r\n        var xpathPath = xpath;\r\n        var index = xpathPath.indexOf(this.grid.properties.xpath);\r\n\r\n        if (index != -1) {\r\n            xpathPath = xpathPath.substr(index + this.grid.properties.xpath.length + 1);\r\n        }\r\n\r\n        return xpathPath;\r\n    },\r\n\r\n    /**\r\n     * Post process the element after it has been rendered\r\n     * @param surrogateKey\r\n     * @param cell\r\n     * @param tableCell\r\n     */\r\n    postRenderReadOnly: function (surrogateKey, cell, tableCell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell, tableCell);\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used\r\n     * @returns {string}\r\n     */\r\n    getContextXpath: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var xpathContext = (form.properties.xpathContext) ? form.properties.xpathContext + \".\" : \"\";\r\n        return xpathContext + this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"]\";\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    preRenderControl: function () {\r\n        if (this.value != undefined && this.properties.value != undefined) {\r\n            this.properties.value = this.value;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Creates the event of generation of templates.\r\n     * @param filename\r\n     */\r\n    deleteDocumentTemplate: function (filename) {\r\n        var self = this;\r\n        var grid = self.parent;\r\n        var params = {};\r\n\r\n        params.xpath = self.properties.xpath + \"[fileName='\" + filename + \"']\";\r\n        params.idRender = self.properties.id;\r\n        params.xpathContext = self.getContextXpath();\r\n        params.idPageCache = self.properties.idPageCache;\r\n\r\n        $.when(self.dataService.deleteUploadFile(params)).done(function () {\r\n            grid.refresh();\r\n        });\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Desktop Letter Column Decorator Extension\r\n*   Author: Alexander Mejia\r\n*   Comments:\r\n*   -   This script will redefine the letter column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from columns desktop base\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.letter\", bizagi.rendering.columns.letter.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.columns.letter.extend(\"bizagi.rendering.desktop.columns.letter\", {}, {\r\n\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n\r\n        //Call base\r\n        self._super(decorated);\r\n\r\n        // Hacks some methods to add features\r\n        decorated.getContextXpath = self.getContextXpath;\r\n        decorated.getXpath = self.getXpath;\r\n        decorated.getControl = self.getControl;\r\n        decorated.setDisplayValue = self.setDisplayValue;\r\n\r\n        decorated.postRenderReadOnly = function (element) {\r\n            var html = decorated.renderReadOnly.apply(decorated);\r\n            var control = $(\".ui-bizagi-cell\", element);\r\n            control.append(html);\r\n        };\r\n    },\r\n\r\n    /*\r\n    *   Returns the current context xpath  \r\n    */\r\n    getContextXpath: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var properties = self.properties;\r\n\r\n        if (mode === \"execution\") {\r\n\r\n            return (properties.xpathContext && properties.xpathContext.length > 0) ?\r\n                properties.xpathContext + \".\" + self.grid.properties.xpath + \"[id=\" + self.surrogateKey + \"]\" :\r\n                self.grid.properties.xpath + \"[id=\" + self.surrogateKey + \"]\";\r\n        }\r\n\r\n        return \"\";\r\n\r\n    },\r\n\r\n    /*\r\n    *   Returns the current xpath  \r\n    */\r\n    getXpath: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var xpathPath = properties.xpath;\r\n        var index = xpathPath.indexOf(self.grid.properties.xpath);\r\n        if (index != -1) { xpathPath = xpathPath.substr(index + self.grid.properties.xpath.length + 1); }\r\n\r\n        return xpathPath;\r\n    },\r\n\r\n    /* \r\n    * Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell) {\r\n\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        this.setSurrogateKey(surrogateKey);\r\n        if (mode == \"execution\") {\r\n\r\n            var decorated = this.getDecorated(surrogateKey);\r\n            var control = decorated.getControl();\r\n\r\n            // Check if its new row\r\n            if (control.parents(\"tr\").data(\"new-row\")) {\r\n                // Show message:  Please save record before to generate a letter\r\n                control.html(bizagi.localization.getResource('render-grid-column-letter-mandatory-key'));\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Template method to get the control element\r\n    *   This will execute under the decorated element context\r\n    */\r\n    getControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (properties.editable) { return $(\".ui-bizagi-render-control\", self.element); }\r\n\r\n        return $(\".ui-bizagi-cell\", self.element);\r\n    },\r\n\r\n    /*\r\n    * Override function\r\n    */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        // Set internal value\r\n        self.setValue(value, false);\r\n    }\r\n\r\n\r\n\r\n});\r\n","/*\r\n*   Name: Bizagi Desktop Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from columns desktop base\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.search\", bizagi.rendering.columns.search.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.columns.search.extend(\"bizagi.rendering.desktop.columns.search\", {}, {\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        var decorated = this.getDecorated(surrogateKey);\r\n        decorated.refreshControl = this.refreshControl;\r\n        // Apply styles to input\r\n        var input = $(\".ui-selectmenu-status\", decorated.getControl());\r\n        this.applyColumnStyles(input);\r\n\r\n        // Remove padding for td\r\n        if (this.properties.editable) {\r\n            decorated.getControl().addClass(\"ui-bizagi-cell-search\");\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function (surrogateKey, cell, tableCell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        // Apply styles to input\r\n        var input = $(\".ui-selectmenu-status\", cell);\r\n        this.applyColumnStyles(input);\r\n    },\r\n\r\n    refreshControl: function () {\r\n        this.grid.refreshCell({key: this.surrogateKey, column: this.properties.xpath, xpathContext: this.getFormContainer().properties.xpathContext});\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: Bizagi Desktop Date Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the date column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from columns desktop base\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.date\", bizagi.rendering.columns.date.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.columns.date.extend(\"bizagi.rendering.desktop.columns.date\", {}, {\r\n\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function(decorated) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        self._super(decorated);\r\n\r\n        // Hacks the getControl method in the decorated render to add features\r\n        if (decorated) {\r\n            decorated.showTime = false;\r\n\r\n            if (mode === \"execution\") {\r\n                decorated.changeMinValue = function(value) {\r\n                    // resolve array minvalue\r\n                    var properties = this.properties;\r\n                    var dateControl = this.getDateControl();\r\n                    var calculateValue = self.resolveValue(this, value);\r\n\r\n                    // Set value in control\r\n                    if (value && properties.editable) {                        \r\n\r\n                        if (typeof (calculateValue) === \"number\") {\r\n                            calculateValue = new Date(calculateValue)\r\n                            dateControl.datepicker(\"option\", \"minDate\", calculateValue); // DateTime Normal\r\n                            calculateValue = bizagi.util.dateFormatter.formatInvariant(calculateValue, properties.showTime); // Set as invariant\r\n                        } else {\r\n                            dateControl.datepicker(\"option\", \"minDate\", bizagi.util.dateFormatter.getDateFromInvariant(calculateValue)); // DateTime Normal\r\n                        }\r\n\r\n                        properties.minValue = value; // Invarian date   \r\n                        decorated.properties.minValue = calculateValue;\r\n                    }\r\n                };\r\n\r\n                decorated.changeMaxValue = function(value) {\r\n                    // resolve array minvalue\r\n                    var properties = this.properties;\r\n                    var dateControl = this.getDateControl();\r\n                    var calculateValue = self.resolveValue(this, value);\r\n\r\n                    // Set value in control\r\n                    if (value && properties.editable) {\r\n                        if (typeof (calculateValue) === \"number\") {\r\n                            calculateValue = new Date(calculateValue)\r\n                            dateControl.datepicker(\"option\", \"maxDate\", calculateValue); // DateTime Normal\r\n                            calculateValue = bizagi.util.dateFormatter.formatInvariant(calculateValue, properties.showTime); // Set as invariant\r\n                        } else {\r\n                            dateControl.datepicker(\"option\", \"maxDate\", bizagi.util.dateFormatter.getDateFromInvariant(calculateValue)); // DateTime Normal\r\n                        }\r\n\r\n                        properties.maxValue = value; // Invarian date       \r\n                        decorated.properties.maxValue = calculateValue;\r\n                    }\r\n                };\r\n            }\r\n        }\r\n        if (mode != \"design\") {\r\n            decorated.getDateControl = function() {\r\n                var self = this;\r\n                return self.dateControl = $(\".ui-bizagi-render-date\", self.getControl());\r\n            };\r\n        }\r\n\r\n    },\r\n\r\n    resolveValue: function (context, value) {\r\n        var result = \"\";\r\n        if (bizagi.util.isString(value) || bizagi.util.isNumeric(value)) {\r\n            result = value;\r\n        }\r\n\r\n        if (bizagi.util.isArray(value)) {\r\n            var indexes = context.grid.getIndexes();\r\n            var surrogateKey = context.surrogateKey;\r\n            var index = indexes.indexOf(surrogateKey);\r\n            if (index !== -1) {\r\n                result = value[index];\r\n            }\r\n        }\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var decorated = this.getDecorated(surrogateKey);\r\n        // Call base\r\n        decorated.properties.showTime = false;\r\n        decorated.properties.showTime = properties.showTime;\r\n\r\n        // Apply styles to input\r\n        var input = $(\"input\", cell);\r\n        this.applyColumnStyles(input);\r\n    },\r\n\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function (surrogateKey, cell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var decorated = this.getDecorated(surrogateKey);\r\n        // Call base, but resuming the original show time property when rendering not editable\r\n        decorated.properties.showTime = properties.showTime;\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Desktop Text Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the text column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.text\", {}, {\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        // Apply styles to input\r\n        var input = $(\"input, textarea\", cell);\r\n        this.applyColumnStyles(input);\r\n    },\r\n\r\n    postRenderReadOnly: function (surrogateKey, cell) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (properties.autoExtend) {\r\n            var readOnly = cell.find(\".ui-bizagi-cell-readonly\");\r\n            if (readOnly.length > 0) {\r\n                readOnly.css(\"max-height\", \"none\");\r\n            }\r\n        }\r\n\r\n        self._super(surrogateKey, cell);\r\n    },\r\n\r\n    attachRetypeDouble: function () {\r\n        var self = this;\r\n        var element = self.element;\r\n\r\n        var input = $(\"input\", element);\r\n        if (!input || input.length == 0) return;\r\n\r\n        // Apply blur handler to check value\r\n        input.blur(function () {\r\n            var control = $(this);\r\n            var previousValue = self.previousValue;\r\n            var value = self.value;\r\n            \r\n            if (previousValue != null && value != previousValue) {\r\n                if ($(this).data(\"newValue\") != undefined && control.val() != $(this).data(\"newValue\")) {\r\n                    $(this).data().newValue = undefined;\r\n                }\r\n            }\r\n            self.retypeDouble(control);\r\n           \r\n        });\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Desktop Seacrh List Column Decorator Extension\r\n*   Author: Paola Herrera\r\n*   Comments:\r\n*   -   This script will redefine the text column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.searchList\", {}, {\r\n\r\n    /*\r\n     *   Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Set base column styles\r\n        var properties = this.properties;\r\n    },\r\n    /*\r\n     *   Returns the in-memory processed element\r\n     *   so the caller could append it to any place\r\n     */\r\n    render: function (surrogateKey, value, tableCell) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var properties = self.properties;\r\n\r\n        // If the control needs to recalculate data, reset it on the decorated render\r\n        if (properties.recalculate) {\r\n            decorated.resetData();\r\n        }\r\n\r\n        // Change the xpath context\r\n        var xpathContext = properties.xpathContext.length > 0 ? properties.xpathContext + \".\" + self.grid.properties.xpath + \"[id=\" + surrogateKey + \"]\" : self.grid.properties.xpath + \"[id=\" + surrogateKey + \"]\";\r\n        decorated.properties.xpathContext = xpathContext;\r\n\r\n        // Render the control\r\n        var result = this._super(surrogateKey, value, tableCell);\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n     *   Sets the internal value, only must be called internally\r\n     */\r\n    setValue: function (surrogateKey, value) {\r\n        var self = this;\r\n\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        if (decorated != \"undefined\" && decorated != null) {\r\n\r\n            decorated.properties.originalValue = value;\r\n            decorated.properties.previousValue = value;\r\n\r\n            if ((value === null || value === undefined) && self.properties.defaultvalue !== undefined && decorated.grid != undefined) {\r\n                value = self.setDefaultValue(surrogateKey, decorated);\r\n            }\r\n\r\n            if (value === null || value === undefined) value = [];\r\n\r\n            decorated.properties.value = value;\r\n            decorated.setValue(value, false);\r\n        }\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Desktop Number Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the number column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.number\", {}, {\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        // Apply styles to input\r\n        var input = $(\"input\", cell);\r\n        this.applyColumnStyles(input);\r\n    },\r\n    renderSummary: function (key, value) {\r\n        var self = this;\r\n        return self.renderReadOnly(key, value);\r\n    },\r\n    postRenderSummary: function (key, value) {\r\n        var self = this;\r\n        self.postRenderReadOnly(key, value);\r\n        return true;\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Desktop NumberScientificNotation Column Decorator Extension\r\n *   Author: Laura Ariza\r\n *   Comments:\r\n *   -   This script define a render control that support scientific notation format in a column\r\n */\r\n\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.numberScientificNotation\", {}, {\r\n    /*\r\n     *   Post process the element after it has been rendered\r\n     */\r\n    postRender: function (surrogateKey, cell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        // Apply styles to input\r\n        var input = $(\"input\", cell);\r\n        this.applyColumnStyles(input);\r\n    },\r\n    renderSummary: function (key, value) {\r\n        var self = this;\r\n        return self.renderReadOnly(key, value);\r\n    },\r\n    postRenderSummary: function (key, value) {\r\n        var self = this;\r\n        self.postRenderReadOnly(key, value);\r\n        return true;\r\n    }\r\n});","/*\r\n *   Name: Bizagi Desktop Upload Column Decorator Extension\r\n *   Author: Bizagi UI Forms\r\n *   Comments:\r\n *   -   This script will redefine the upload column decorator class to adjust to desktop devices\r\n */\r\n\r\n// Extends from column\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.upload\", {}, {\r\n\r\n    /**\r\n     * Apply custom overrides to each decorated instance\r\n     * @param {} decorated \r\n     * @returns {} \r\n     */\r\n    applyOverrides: function(decorated) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        self._super(decorated);\r\n\r\n        // Hacks the upload render to add features\r\n        decorated.getUploadXpath = self.getUploadXpath;\r\n\r\n        // Hack apply upload plugin method in order to execute it only when the control is inserted in the DOM\r\n        if (mode != \"design\" && mode != \"layout\") {\r\n\r\n            var originalMethod = decorated.applyUploadPlugin;\r\n\r\n            decorated.getXpathContext = function() {\r\n                var surrogateKey = this.surrogateKey || \"\";\r\n                var that = this;\r\n                var xpath = that.grid.properties.xpath + \"[id=\" + that.surrogateKey + \"]\";\r\n\r\n                return that.properties.xpathContext.length > 0 ? that.properties.xpathContext + \".\" + xpath : xpath;\r\n            };\r\n\r\n            decorated.applyUploadPlugin = function() {\r\n                var control = this.getControl();\r\n\r\n                originalMethod.apply(decorated, arguments);\r\n\r\n                control.undelegate(\".ui-bizagi-render-upload-item\", \"mouseover\");\r\n                control.undelegate(\".ui-bizagi-render-upload-item\", \"mouseout\");\r\n\r\n                $(\".ui-bizagi-render-upload-icon\", control).css(\"display\", \"inline-block\");\r\n\r\n                // fix to firefox and chrome\r\n                $(\".ui-bizagi-render-upload-wrapper object\", control).css({ position: 'relative' });\r\n\r\n                $(\".ui-bizagi-render-upload-queue\", control).css({ 'max-width': \"150px\" });\r\n\r\n            };\r\n\r\n            decorated.postRender = function() {\r\n                var self = this;\r\n                var control = self.getControl();\r\n\r\n                if (self.properties.allowSendInMail) {\r\n                    self.bindEmailDialog();\r\n                }\r\n\r\n                //Set control container to behave as a block \r\n                control.addClass(\"ui-bizagi-render-display-block\");\r\n                control.addClass(\"ui-bizagi-render-upload\");\r\n                self.checkMaxFiles();\r\n            };\r\n\r\n            decorated.buildItemUrl = function(file) {\r\n                var self = this;\r\n                var properties = self.properties;\r\n                var form = self.getFormContainer();\r\n\r\n                return self.dataService.getUploadFileUrl({\r\n                    idRender: properties.id,\r\n                    xpath: self.getUploadXpath(),\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: properties.idPageCache,\r\n                    fileId: file.id,\r\n                    sessionId: form.properties.sessionId,\r\n                    contexttype: properties.contexttype\r\n                });\r\n            };\r\n        }\r\n\r\n        decorated.buildItemUrl = function(file) {\r\n            var self = this;\r\n            var properties = self.properties;\r\n            var form = self.getFormContainer();\r\n            var xpathContext = self.getXpathContext();\r\n            var contextXpath = \"\";\r\n\r\n            return self.dataService.getUploadFileUrl({\r\n                idRender: properties.id,\r\n                xpath: properties.xpath,\r\n                xpathContext: xpathContext,\r\n                idPageCache: properties.idPageCache,\r\n                fileId: file.id,\r\n                sessionId: form.properties.sessionId,\r\n                contexttype: properties.contexttype\r\n            });\r\n        };\r\n\r\n        decorated.processUploadFile = function() {\r\n            var self = this;\r\n            var dialogBox = self.dialogBox;\r\n            var defer = new $.Deferred();\r\n            var uploadForm = $(\"form\", dialogBox);\r\n            var uploadIFrame = $(\"iframe\", uploadForm);\r\n            var xpathContext = self.getXpathContext();\r\n\r\n            // Change xpath context within form element\r\n            $(\"[name=h_xpathContext]\", uploadForm).val(xpathContext);\r\n\r\n\r\n            // When the iframe loads the user we need to evaluate the response and close the dialog\r\n            var timeoutFn = function() {\r\n                try {\r\n                    var response = \"\";\r\n                    if (uploadIFrame[0].contentWindow) {\r\n                        var iframeContent = bizagi.util.isIE8() ? $(uploadIFrame[0].contentWindow.document.body)\r\n                            : $(uploadIFrame[0].contentWindow.eval(\"document.body\"));\r\n\r\n                        response = iframeContent.text();\r\n                    }\r\n                    if (response.length > 0) {\r\n                        defer.resolve(response);\r\n                    } else {\r\n                        setTimeout(timeoutFn, 50);\r\n                    }\r\n                } catch (e) {\r\n                    // Nothing todo, just close the window and show error message\r\n                    self.closeUploadDialog();\r\n                    window.alert(e.toString());\r\n                }\r\n            };\r\n\r\n            // Execute the timed function in order to check when the response has arrived\r\n            timeoutFn();\r\n\r\n            // Submit the form\r\n            uploadForm.submit();\r\n\r\n            return defer.promise();\r\n        };\r\n    },\r\n\r\n    /**\r\n     * Returns the in-memory processed element when the element is read-only\r\n     * @param {} surrogateKey \r\n     * @param {} value \r\n     * @returns {} \r\n     */\r\n    renderReadOnly: function(surrogateKey, value) {\r\n        var self = this;\r\n        var cell;\r\n\r\n        var decorated = this.getDecorated(surrogateKey);\r\n        self.setValue(surrogateKey, value);\r\n        self.setSurrogateKey(surrogateKey);\r\n\r\n        self.applyOverrides(decorated);\r\n        // Set grid and id references to the control in order to render the content\r\n        decorated.grid = this.grid;\r\n        decorated.column = this;\r\n        decorated.surrogateKey = surrogateKey;\r\n\r\n        // Set ready deferred\r\n        self.readyDeferred = new $.Deferred();\r\n\r\n        // We need to render the inner control as read-only\r\n        if (decorated.files.length > 0) {\r\n            // Changes editable to false to render read-only\r\n            var editable = this.properties.editable;\r\n            decorated.properties.editable = false;\r\n            cell = decorated.render(\"cell.upload\");\r\n            decorated.properties.editable = editable;\r\n        }\r\n\r\n        // Attach rendered handler\r\n        self.bind(\"rendered\", function() {\r\n            self.readyDeferred.resolve();\r\n        });\r\n\r\n        return cell;\r\n    },\r\n\r\n    /**\r\n     * Post process the element after it has been rendered\r\n     * @param {} surrogateKey \r\n     * @param {} cell \r\n     * @returns {} \r\n     */\r\n    postRenderReadOnly: function(surrogateKey, cell) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(surrogateKey, cell);\r\n\r\n\r\n        var decorated = self.getDecorated(surrogateKey);\r\n\r\n        if (decorated.files.length == 0) {\r\n            var message = self.getResource(\"render-upload-no-files\");\r\n            $(\".ui-bizagi-cell-readonly\", cell).html(message);\r\n\r\n            // Set cell icon to the right\r\n            var cellIcon = $(\".ui-bizagi-cell-icon\", cell);\r\n            cellIcon.addClass(\"ui-bizagi-cell-icon-right\");\r\n        } else {\r\n            // Just draw render if the cell layout has been filled\r\n            if (cell && cell.length > 0) {\r\n                // Apply styles to cell\r\n                self.applyColumnStyles(cell);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Post process the element after it has been rendered\r\n     * @param {} surrogateKey \r\n     * @param {} cell \r\n     * @returns {} \r\n     */\r\n    postRender: function(surrogateKey, cell) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        // Call base\r\n        self._super(surrogateKey, cell);\r\n\r\n        self.setSurrogateKey(surrogateKey);\r\n\r\n        if (mode != \"design\") {\r\n\r\n            var decorated = this.getDecorated(surrogateKey);\r\n            var control = decorated.getControl();\r\n\r\n            // Check if its new row\r\n            if (control.parents(\"tr\").data(\"new-row\")) {\r\n                // Show message:  Please save record before to upload a file\r\n                control.html(bizagi.localization.getResource('render-grid-column-upload-mandatory-key'));\r\n\r\n                //Set the column with this attribute, so when the control is evaluated in isValid(), validated\r\n                //also if it is required, and belongs from a new row\r\n                self.isNewRow = true;\r\n            } else {\r\n                self.isNewRow = false;\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used  \r\n     * @returns {} \r\n     */\r\n    getUploadXpath: function() {\r\n        return this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"].\" + this.properties.xpath;\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: Bizagi Desktop Radio Column Decorator Extension\r\n *   Author: Bizagi UI Forms\r\n *   Comments:\r\n *   -   This script will redefine the Radio column decorator class to adjust to desktop devices\r\n */\r\n\r\n// Extends from column\r\nbizagi.rendering.desktop.columns.combo.extend(\"bizagi.rendering.desktop.columns.radio\", {}, {\r\n    /*\r\n     *   Apply custom overrides to each decorated instance\r\n     */\r\n    applyOverrides: function (decorated) {\r\n        var self = this;\r\n        this._super(decorated);\r\n        // Hacks the upload render to add features\r\n        decorated.getUploadXpath = this.getUploadXpath;\r\n\r\n        decorated.cleanData = function () {\r\n            var self = this;\r\n            var value = { id: \"\", label: \"\" };\r\n            var selectedItem = self.element.find(\".ui-radio-state-checked\");\r\n\r\n            selectedItem.removeClass(\"ui-radio-state-checked\");\r\n            self.setDisplayValue(value);\r\n            self.setValue(value);\r\n        };\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Desktop Radio Column Decorator Extension\r\n*   Author: Maria Camila Angel\r\n*   Comments:\r\n*   -   This script will redefine the text column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.desktop.columns.combo.extend(\"bizagi.rendering.desktop.columns.list\", {}, {\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n        var self = this;\r\n        this._super(decorated);\r\n        // Hacks the upload render to add features\r\n        decorated.getUploadXpath = this.getUploadXpath;\r\n\r\n        decorated.cleanData = function () {\r\n            var self = this;\r\n            var control = self.getControl();\r\n            var selected = control.find(\".ui-state-active\");\r\n            var newValue = self.getValue();\r\n\r\n            self.value = self.properties.value = self.selectedValue = { id: \"\", value: \"\" };\r\n            self.selectedValue = newValue.value;\r\n            selected.removeClass(\"ui-state-focus ui-selected ui-state-active\");\r\n        };\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Desktop Text Column Decorator Extension\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will redefine the image column decorator class to adjust to desktop devices\r\n */\r\n\r\n// Extends from column\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.image\", {}, {\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n        this._super(decorated);\r\n\r\n\r\n        // Hacks the upload render to add features\r\n        decorated.getUploadXpath = this.getUploadXpath;\r\n\r\n        // hack apply upload plugin method in order to execute it only when the control is inserted in the DOM\r\n        var originalApplyUploadPlugin = decorated.applyUploadPlugin;\r\n        if (decorated.properties.flashVersion) {\r\n            decorated.applyUploadPlugin = function () {\r\n                var uploadRender = this,\r\n                        control = uploadRender.getControl();\r\n                originalApplyUploadPlugin.apply(decorated, arguments);\r\n                control.undelegate(\".ui-bizagi-render-upload-item\", \"mouseover\");\r\n                control.undelegate(\".ui-bizagi-render-upload-item\", \"mouseout\");\r\n                $(\".ui-bizagi-render-upload-icon\", control).css(\"display\", \"inline-block\");\r\n\r\n                // fix to firefox and chrome\r\n                $(\".ui-bizagi-render-upload-wrapper object\", control).css({\r\n                    position: 'relative'\r\n                });\r\n            };\r\n        }\r\n\r\n\r\n        // Hack renderControl and post render to avoid processing when using inline add\r\n        var originalRenderControl = decorated.renderControl;\r\n        var originalInternalPostRender = decorated.internalPostRender;\r\n        //var originalPostRender = decorated.postRender;\r\n        decorated.renderControl = function () {\r\n            return \"\";\r\n        };\r\n\r\n        decorated.internalPostRender = function () {\r\n            var control = decorated.getControl();\r\n\r\n            // Check if its new row\r\n            if (control.parents(\"tr\").data(\"new-row\")) {\r\n                // Show message:  Please save record before to upload a file\r\n                control.html(bizagi.localization.getResource('render-grid-column-upload-mandatory-key'));\r\n\r\n                //Set the column with this attribute, so when the control is evaluated in isValid(), validated\r\n                //also if it is required, and belongs from a new row\r\n                self.isNewRow = true;\r\n            } else {\r\n\r\n                self.isNewRow = false;\r\n\r\n                $.when(originalRenderControl.apply(decorated, arguments)).done(function (html) {\r\n                    if (control.hasClass(\"ui-bizagi-render-control\") ||\r\n                        control.hasClass(\"ui-bizagi-cell-readonly\")) {\r\n                        control.append(html);\r\n                        originalInternalPostRender.apply(decorated, arguments);\r\n                    }\r\n                });\r\n            }\r\n        };\r\n        \r\n        decorated.buildAddParams = function () {\r\n            var self = this,\r\n                properties = self.properties,\r\n                form = self.getFormContainer();\r\n\r\n            var data = [];\r\n\r\n            data.push({ key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\", value: properties.xpath });\r\n            data.push({ key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\", value: properties.id });\r\n            data.push({ key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\", value: properties.xpathContext });\r\n            data.push({ key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE, value: properties.idPageCache });\r\n            data.push({ key: self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\", value: form.properties.sessionId });\r\n            data.push({ key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\", value: 'savefile' });\r\n            (properties.contexttype) ? data.push({ key: self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\", value: properties.contexttype }) : \"\";\r\n\r\n            try {\r\n                (BIZAGI_SESSION_NAME != undefined) ? data.push({ key: BIZAGI_SESSION_NAME, value: form.properties.sessionId }) : data.push({ key: \"JSESSIONID\", value: form.properties.sessionId });\r\n            } catch (e) {\r\n                data.push({ key: \"JSESSIONID\", value: form.properties.sessionId });\r\n            }\r\n\r\n            return data;\r\n        };\r\n\r\n        decorated.refreshControl = this.refreshControl;\r\n\r\n        // Change xpath context\r\n        if (mode === \"execution\") {\r\n            if (properties.xpathContext.length > 0) {\r\n                decorated.properties.xpathContext = properties.xpathContext + \".\" + self.grid.properties.xpath + \"[id=\" + decorated.surrogateKey + \"]\";\r\n            } else {\r\n                decorated.properties.xpathContext = self.grid.properties.xpath + \"[id=\" + decorated.surrogateKey + \"]\";\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    *   Returns the xpath to be used  \r\n    */\r\n    getUploadXpath: function () {\r\n        return this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"].\" + this.properties.xpath;\r\n    }, \r\n\r\n    refreshControl: function(){\r\n        this.grid.refreshCell({key: this.surrogateKey, column: this.properties.xpath, xpathContext: this.getFormContainer().properties.xpathContext});\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: Bizagi Desktop Text Column Decorator Extension\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will redefine the text column decorator class to adjust to desktop devices\r\n */\r\n\r\n// Extends from column\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.uploadecm\", {}, {\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n        var self = this;\r\n        this._super(decorated);\r\n\r\n        // Hacks the upload render to add features\r\n        decorated.getUploadXpath = this.getUploadXpath;\r\n\r\n        // hack apply upload plugin method in order to execute it only when the control is inserted in the DOM\r\n        var originalMethod = decorated.applyUploadPlugin;\r\n        decorated.applyUploadPlugin = function () {\r\n            var uploadRender = this;\r\n            var control = uploadRender.getControl();\r\n\r\n            originalMethod.apply(decorated, arguments);\r\n            control.undelegate(\".ui-bizagi-render-upload-item\", \"mouseover\");\r\n            control.undelegate(\".ui-bizagi-render-upload-item\", \"mouseout\");\r\n            $(\".ui-bizagi-render-upload-icon\", control).css(\"display\", \"inline-block\");\r\n\r\n            // fix to firefox and chrome\r\n            $(\".ui-bizagi-render-upload-wrapper object\", control).css({\r\n                position: 'relative'\r\n            });\r\n        };\r\n\r\n        decorated.buildItemUrl = function (file) {\r\n            var self = this;\r\n            var properties = self.properties;\r\n            var form = self.getFormContainer();\r\n            var columnXpath = self.getUploadXpath(self.surrogateKey);\r\n\r\n            columnXpath = columnXpath.split(\".\");\r\n\r\n            var nameFile = columnXpath[columnXpath.length - 1];\r\n            var xpathContext = self.getXpathContext(self.surrogateKey);\r\n\r\n            return self.dataService.getUploadFileUrl({\r\n                idRender: properties.id,\r\n                xpath: nameFile,\r\n                xpathContext: xpathContext,\r\n                idPageCache: properties.idPageCache,\r\n                fileId: file.idFileUpload,\r\n                sessionId: form.properties.sessionId,\r\n                contexttype: properties.contexttype\r\n            });\r\n        };\r\n\r\n        decorated.buildAddParams = function () {\r\n            var self = this;\r\n            var properties = self.properties;\r\n            var form = self.getFormContainer();\r\n            var data = {};\r\n\r\n            var columnXpath = self.getUploadXpath(self.surrogateKey);\r\n            columnXpath = columnXpath.split(\".\");\r\n            var nameFile = columnXpath[columnXpath.length - 1];\r\n            var xpathContext = self.getXpathContext(self.surrogateKey);\r\n\r\n            data.url = properties.addUrl;\r\n            data.xpath = properties.xpath;\r\n            data.idAttrib = properties.idAttrib;\r\n            data.xpathContext = xpathContext;\r\n            data.metaValues = [];\r\n            data.idPageCache = properties.idPageCache;\r\n            data.idSession = form.properties.sessionId;\r\n            data.contexttype = \"entity\";\r\n            data.validExtensions = properties.validExtensions;\r\n            data.maxSize = properties.maxSize;\r\n\r\n            return data;\r\n        };\r\n\r\n\r\n        decorated.getXpathContext = function () {\r\n            var self = this;            \r\n            var xpath = self.grid.properties.xpath + \"[id=\" + self.surrogateKey + \"]\";\r\n\r\n            return self.properties.xpathContext.length > 0 ? self.properties.xpathContext + \".\" + xpath : xpath;\r\n        };\r\n\r\n\r\n    },\r\n    /*\r\n    *   Returns the in-memory processed element when the element is read-only\r\n    */\r\n    renderReadOnly: function (surrogateKey, value) {\r\n        var self = this;\r\n        var cell;\r\n\r\n        var decorated = this.getDecorated(surrogateKey);\r\n        decorated.setValue(value);\r\n        self.setValue(surrogateKey, value);\r\n        self.setSurrogateKey(surrogateKey);\r\n\r\n        self.applyOverrides(decorated);\r\n        // Set grid and id references to the control in order to render the content\r\n        decorated.grid = this.grid;\r\n        decorated.column = this;\r\n        decorated.surrogateKey = surrogateKey;\r\n\r\n        // Set ready deferred\r\n        self.readyDeferred = new $.Deferred();\r\n\r\n        // We need to render the inner control as read-only\r\n        if (decorated.files.length > 0) {\r\n            // Changes editable to false to render read-only\r\n            var editable = this.properties.editable;\r\n            decorated.properties.editable = false;\r\n            cell = decorated.render(\"cell.upload\");\r\n        }\r\n\r\n        // Attach rendered handler\r\n        self.bind(\"rendered\", function () {\r\n            self.readyDeferred.resolve();\r\n        });\r\n\r\n        return cell;\r\n    },\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function (surrogateKey, cell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        var self = this;\r\n        var decorated = this.getDecorated(surrogateKey);\r\n        if (decorated.files.length == 0) {\r\n            var message = self.getResource(\"render-upload-no-files\");\r\n            $(\".ui-bizagi-cell-readonly\", cell).html(message);\r\n\r\n            // Set cell icon to the right\r\n            var cellIcon = $(\".ui-bizagi-cell-icon\", cell);\r\n            cellIcon.addClass(\"ui-bizagi-cell-icon-right\");\r\n        } else {\r\n            // Just draw render if the cell layout has been filled\r\n            if (cell && cell.length > 0) {\r\n                // Apply styles to cell\r\n                self.applyColumnStyles(cell);\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell) {                \r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        this.setSurrogateKey(surrogateKey);\r\n        if (mode == \"execution\") {\r\n\r\n            var decorated = this.getDecorated(surrogateKey);\r\n            var control = decorated.getControl();\r\n\r\n            // Check if its new row\r\n            if (control.parents(\"tr\").data(\"new-row\")) {\r\n                // Show message:  Please save record before to upload a file\r\n                control.html(bizagi.localization.getResource('render-grid-column-upload-mandatory-key'));\r\n\r\n                // Set the column with this attribute, so when the control is evaluated in isValid(), validated\r\n                // also if it is required, and belongs from a new row\r\n                self.isNewRow = true;\r\n            } else {\r\n                self.isNewRow = false;\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    *   Returns the xpath to be used  \r\n    */\r\n    getUploadXpath: function(surrogateKey) {\r\n        var self = this;        \r\n        surrogateKey = this.surrogateKey || surrogateKey || \"\";\r\n        var xpath = self.grid.properties.xpath + \"[id=\" + self.surrogateKey + \"].\" + self.properties.xpath;\r\n\r\n        return self.properties.xpathContext.length > 0 ? self.properties.xpathContext + \".\" + xpath : xpath;\r\n    }\r\n\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Desktop Link Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the link column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.link\", {}, {\r\n\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n        this._super(decorated);\r\n        decorated.getControl = this.getControl;\r\n        // Hacks the getControl method in the decorated render to add features\r\n        if (decorated.properties.type == \"columnFormLink\") {\r\n            decorated.getFormLinkXpath = this.getFormLinkXpath;\r\n        }\r\n        // Hack renderControl and post render to avoid processing when using inline add\r\n        var originalRenderControl = decorated.renderControl;\r\n        originalInternalPostRender = decorated.internalPostRender;\r\n        decorated.internalPostRender = function () {\r\n            var control = decorated.getControl();\r\n            // Check if its new row\r\n            if (control.parents(\"tr\").data(\"new-row\")) {\r\n                // Show message:  Please save record before to upload a file\r\n                control.html('<label style=\"font-weight: normal;\">'+bizagi.localization.getResource('render-grid-column-button-mandatory-key')+'</label>');\r\n                //Set the column with this attribute, so when the control is evaluated in isValid(), validated\r\n                //also if it is required, and belongs from a new row\r\n                self.isNewRow = true;\r\n            } else {\r\n                self.isNewRow = false;\r\n                $.when(originalRenderControl.apply(decorated, arguments)).done(function (html) {\r\n                    if (control.hasClass(\"ui-bizagi-render-control\") ||\r\n                        control.hasClass(\"ui-bizagi-cell-readonly\")) {\r\n                        originalInternalPostRender.apply(decorated, arguments);\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Template method to get the control element\r\n    *   This will execute under the decorated element context\r\n    */\r\n    getControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (properties.editable) {\r\n            return $(\".ui-bizagi-render-control\", self.element);\r\n        } else {\r\n            if($(\".ui-bizagi-cell-readonly\", self.element).length > 0){\r\n                return $(\".ui-bizagi-cell-readonly\", self.element);\r\n            }\r\n            else{\r\n                return $(\".ui-bizagi-render-control\", self.element);\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Returns the in-memory processed element\r\n    *   so the caller could append it to any place\r\n    */\r\n    render: function (surrogateKey, value, tableCell, caller) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n\r\n        // Change the xpath context\r\n        decorated.properties.xpathContext = self.grid.properties.xpath + \"[id=\" + surrogateKey + \"]\";\r\n\r\n        if (self.grid.properties.xpathContext && decorated.properties.xpathContext.indexOf(self.grid.properties.xpathContext) == -1)\r\n            decorated.properties.xpathContext = self.grid.properties.xpathContext + \".\" + decorated.properties.xpathContext;\r\n\r\n        // Render the control\r\n        var result = this._super(surrogateKey, value, tableCell, caller);\r\n\r\n        return result;\r\n    },\r\n    /*\r\n    *   Returns the cell html to be inserted in the table\r\n    */\r\n    renderReadOnly: function (surrogateKey, value, tableCell) {\r\n        var self = this;\r\n\r\n        // Render the control editable\r\n        if (typeof (self.properties.canBeSaved) == \"undefined\") self.properties.canBeSaved = (self.properties.editable == true);\r\n        var result = this.render(surrogateKey, value, tableCell, \"CALLER_RENDER_READ_ONLY_COLUMNSLINK\");\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function (surrogateKey, cell, tableCell) {\r\n        var self = this;\r\n\r\n        // Render the control editable\r\n        this.postRender(surrogateKey, cell, tableCell);\r\n    },\r\n\r\n    /*\r\n    *   Get Form Link xpath to use\r\n    */\r\n    getFormLinkXpath: function () {\r\n        // Calculate layout properties to maximized property\r\n        this.properties.maximized = bizagi.util.parseBoolean(this.properties.maximized) != null ? bizagi.util.parseBoolean(this.properties.maximized) : false;\r\n        this.calculateInitialLayoutProperties();\r\n\r\n        if (!this.properties.xpath){\r\n            return;\r\n        }\r\n        return this.properties.xpath;\r\n    }\r\n\r\n\r\n});\r\n","/**\r\n * Grid control Column Button\r\n *\r\n * @author Edward Morales\r\n */\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.button\", {}, {\r\n    applyOverrides: function (decorated) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n        this._super(decorated);\r\n\r\n        decorated.configureHandlers = function () {\r\n            var self = this;\r\n            var control = decorated.getControl();\r\n            var button = $(\":button\", control);\r\n\r\n            button.bind(\"click\", function (e) {\r\n                decorated.processButton.apply(self);\r\n\r\n            });\r\n        };\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        this.setSurrogateKey(surrogateKey);\r\n        if (mode == \"execution\") {\r\n\r\n            var decorated = this.getDecorated(surrogateKey);\r\n            var control = decorated.getControl();\r\n\r\n            // Check if its new row\r\n            if (control.parents(\"tr\").data(\"new-row\")) {\r\n                // Show message:  Please save record before to click the button\r\n                control.html(bizagi.localization.getResource('render-grid-column-button-mandatory-key'));\r\n\r\n                //Set the column with this attribute, so when the control is evaluated in isValid(), validated\r\n                //also if it is required, and belongs from a new row\r\n                self.isNewRow = true;\r\n            } else {\r\n                self.isNewRow = false;\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function (surrogateKey, cell) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n        \r\n    },\r\n    /*\r\n    *   Returns the in-memory processed element when the element is read-only\r\n    */\r\n    renderReadOnly: function (surrogateKey, value) {\r\n        var self = this;\r\n        var cell;\r\n\r\n        var decorated = this.getDecorated(surrogateKey);\r\n        self.setSurrogateKey(surrogateKey);\r\n\r\n        self.applyOverrides(decorated);\r\n        // Set grid and id references to the control in order to render the content\r\n        decorated.grid = this.grid;\r\n        decorated.column = this;\r\n        decorated.surrogateKey = surrogateKey;\r\n\r\n        // Set ready deferred\r\n        self.readyDeferred = new $.Deferred();\r\n\r\n        // We need to render the inner control as read-only\r\n        \r\n        // Changes editable to false to render read-only\r\n        var editable = this.properties.editable;\r\n        decorated.properties.editable = false;\r\n        cell = decorated.render(\"cell.button\");\r\n        decorated.properties.editable = editable;\r\n        \r\n\r\n        // Attach rendered handler\r\n        self.bind(\"rendered\", function () {\r\n            self.readyDeferred.resolve();\r\n        });\r\n\r\n        return cell;\r\n    }\r\n});","/**\r\n *   Name: Bizagi Desktop Actions Column Decorator Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the text column decorator class to adjust to desktop devices\r\n */\r\n\r\n// Extends from column\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.actions\", {}, {\r\n\r\n    /*\r\n     *   Post process the element after it has been rendered\r\n     */\r\n    postRender: function (surrogateKey, cell) {\r\n        // Call base\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        this._super(surrogateKey, cell);\r\n\r\n        self.configureHandlersActions(surrogateKey);\r\n\r\n        $(\".ui-bizagi-render\", cell).css(\"overflow\", \"auto\");\r\n\r\n\r\n        if (mode == \"execution\") {\r\n            var decorated = this.getDecorated(surrogateKey);\r\n            var control = decorated.getControl();\r\n            // Check if its new row\r\n            if (control.parents(\"tr\").data(\"new-row\")) {\r\n                control.html(self.renderDraftControl());\r\n            }\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n     * Configure additional Handlers\r\n     * @param surrogateKey\r\n     */\r\n    configureHandlersActions: function (surrogateKey) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var viewMore = decorated.element.find(\".gn-bz-grid__more\");\r\n        var items = [];\r\n\r\n        // Add selection events for the draft rows\r\n        decorated.element.on(\"click\", \".gn-bz-grid__delete\", function (events) {\r\n            var $context = $(this).closest(\"tr[data-new-row='true']\");\r\n\r\n            $context.trigger(\"delete-row\");\r\n        });\r\n\r\n        if (self.grid.columnActionParams.allowDetail) {\r\n            items.push({\r\n                name: self.parent.properties.detailLabel,\r\n                icon: \"icon-detail\",\r\n                fn: function () {\r\n                    self.grid.showFormDetails(surrogateKey);\r\n                }\r\n            });\r\n        }\r\n\r\n        if (self.grid.columnActionParams.allowEdit && self.grid.columnActionParams.withEditForm) {\r\n            items.push({\r\n                name: self.parent.properties.editLabel,\r\n                icon: \"icon-edit\",\r\n                fn: function () {\r\n                    self.grid.editRow(surrogateKey);\r\n                }\r\n            });\r\n        }\r\n\r\n        if (self.grid.columnActionParams.allowDelete) {\r\n            items.push({\r\n                name: self.parent.properties.deleteLabel,\r\n                icon: \"icon-delete\",\r\n                fn: function () {\r\n                    self.grid.deleteRow(surrogateKey);\r\n                }\r\n            });\r\n        }\r\n\r\n        viewMore.overflowMenu({items: items});\r\n    },\r\n\r\n    renderDraftControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"gridActions-delete\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {});\r\n        return html;\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: BizAgi Desktop Actions Column Decorator Extension\r\n *   Author: Cristian Olaya\r\n *           Ivn Ricardo Taimal\r\n *   Comments:\r\n *   -   This script will redefine the text column decorator class to adjust to desktop devices\r\n */\r\n\r\n// Extends from column\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.exclusiveCheck\", {}, {\r\n\r\n    /*\r\n     *   Returns the in-memory processed element\r\n     *   so the caller could append it to any place\r\n     */\r\n    render: function (surrogateKey, value) {\r\n\r\n        var self = this;\r\n        // Set flag to check when a render has changed\r\n        self.changed = false;\r\n        var properties = self.properties;\r\n        // Set grid and id references to the control in order to render the content\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        decorated.grid = self.grid;\r\n        decorated.column = this;\r\n        decorated.surrogateKey = surrogateKey;\r\n\r\n        // Set cell value\r\n\r\n        var mode = self.getMode();\r\n\r\n        if (self.grid.exclusiveChanges[self.properties.xpath]) {\r\n            if (self.grid.exclusiveChanges[self.properties.xpath].key === surrogateKey) {\r\n                self.setValue(surrogateKey, self.grid.exclusiveChanges[self.properties.xpath].value);\r\n            }\r\n            else {\r\n                self.setValue(surrogateKey, false);\r\n            }\r\n        }\r\n        else {\r\n            if (self.grid.originalEnabledChecks && self.grid.originalEnabledChecks.length > 1) {\r\n                self.setValue(surrogateKey, false);\r\n            }\r\n            else {\r\n                self.setValue(surrogateKey, value);\r\n            }\r\n        }\r\n\r\n        // Override render properties\r\n        self.overrideDecoratedRenderProperties(surrogateKey);\r\n\r\n\r\n        // If the render is not editable return the readonly version of the column\r\n        if (!properties.editable)\r\n            return self.renderReadOnly.apply(self, arguments);\r\n\r\n        // Returns the decorated render inside a custom layout for columns\r\n        self.readyDeferred = new $.Deferred();\r\n        var cell = decorated.render(\"cell\");\r\n\r\n        // If the render changes set the flag on\r\n        decorated.bind(\"renderchange\", function () {\r\n            self.changed = true;\r\n            var lastKey = self.grid.exclusiveChanges[self.properties.xpath] ? self.grid.exclusiveChanges[self.properties.xpath].key : -1;\r\n            if (lastKey !== surrogateKey) {\r\n                self.clearOtherRows(surrogateKey, self.properties.xpath);\r\n            }\r\n            var simpleXpathArray = self.properties.xpath.split(\".\");\r\n            self.grid.exclusiveChanges[self.properties.xpath] = {\r\n                xpath: self.properties.xpath,\r\n                simpleXpath: simpleXpathArray[simpleXpathArray.length - 1],\r\n                value: self.getValue(surrogateKey),\r\n                key: surrogateKey\r\n            };\r\n        });\r\n\r\n        self.bind(\"rendered\", function () {\r\n            self.readyDeferred.resolve();\r\n        });\r\n\r\n        return cell;\r\n    },\r\n\r\n    /*\r\n     *   Post process the element after it has been rendered\r\n     */\r\n    postRender: function (surrogateKey, cell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        this.setSurrogateKey(surrogateKey);\r\n        if (mode == \"execution\") {\r\n\r\n            var decorated = this.getDecorated(surrogateKey);\r\n            var control = decorated.getControl();\r\n\r\n            // Check if its new row\r\n            if (control.parents(\"tr\").data(\"new-row\")) {\r\n                // Show a disabled check box\r\n                control.html('<input type=\"checkbox\" name=\"exclusiveCheck\" title=\"' + bizagi.localization.getResource('render-grid-column-button-mandatory-key') + '\" disabled=\"disabled\" style=\"width:16.5px;height:16.5px;\">');\r\n\r\n                //Set the column with this attribute, so when the control is evaluated in isValid(), validated\r\n                //also if it is required, and belongs from a new row\r\n                self.isNewRow = true;\r\n            } else {\r\n                self.isNewRow = false;\r\n            }\r\n        }\r\n    },\r\n\r\n    clearOtherRows: function (surrogateKey, xpath) {\r\n        var self = this;\r\n        var enabledChecks = self.grid.enabledChecks;\r\n\r\n        if (!enabledChecks) {\r\n            self.grid.enabledChecks = {};\r\n            self.grid.enabledChecks[xpath] = [];\r\n            enabledChecks = self.grid.enabledChecks;\r\n        }\r\n\r\n        for (var j = 0; j < self.grid.properties.data.rows.length; j++) {\r\n            var rowIndex = self.grid.properties.data.rows[j][0];\r\n            if (rowIndex !== surrogateKey) {\r\n                var decorated = self.getDecorated(rowIndex);\r\n                decorated.setDisplayValue(false);\r\n                self.setValue(rowIndex, false);\r\n                enabledChecks[xpath].push([rowIndex]);\r\n            }\r\n        }\r\n    }\r\n});\r\n","/*\r\n*   Name: Bizagi Desktop Column Decorator Extension\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from columns desktop base\r\nbizagi.rendering.desktop.columns.column.extend(\"bizagi.rendering.desktop.columns.readonly\", bizagi.rendering.columns.readonly.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.columns.readonly.extend(\"bizagi.rendering.desktop.columns.readonly\", {}, {\r\n\r\n});","/*\r\n*   Name: BizAgi Desktop querySuggest\r\n*   Author: Ivan Ricardo Taimal Narvaez\r\n*   Comments:querySuggest\r\n*   -\r\n*/\r\n\r\nbizagi.rendering.desktop.search.extend(\"bizagi.rendering.desktop.querySuggest\", {}, {\r\n//h_contexttype:metadata\r\n\r\n    /*\r\n     *   Fetch the data into a deferred\r\n     */\r\n    getData: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n        var form = self.getFormContainer();\r\n        var contextType = form.getContextType() || form.params.contexttype || false;\r\n        params = params || {};\r\n\r\n        // Verify context type\r\n        if (self.properties.contexttype) {\r\n            params.h_contexttype = self.properties.contexttype;\r\n        } else if (contextType) {\r\n            params.h_contexttype = contextType;\r\n        }\r\n\r\n        // QA-471 When the contexttype is metadata it does not\r\n        // send xpathcontext\r\n        if(params && params.h_contexttype && params.h_contexttype === 'metadata'){\r\n            properties.xpathContext = '';\r\n        }\r\n\r\n        // Resolve with remote data\r\n        self.dataService.multiaction().getSearchData({\r\n            url: properties.dataUrl,\r\n            contexttype:'metadata',\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            term: (properties.allowFullSearch) ? \"%\" + properties.term : properties.term,\r\n            extra: params\r\n        }).done(function (data) {\r\n            // Resolve with fetched data\r\n            properties.data = data;\r\n            defer.resolve(properties.data);\r\n        }).fail(function (data) {\r\n            var hideStatus = data.hideStatus || false;\r\n            defer.resolve({});\r\n            if (!hideStatus) {\r\n                self.trigger(\"onSearchError\", data);\r\n            }\r\n        });\r\n        return defer.promise(defer);\r\n    },\r\n\r\n    /* Renders the advanced item */\r\n    renderClearItem: function () {\r\n        var self = this;\r\n        var searchItem = self.renderSearchItem({\r\n            id: self.Class.CLEAR_SEARCH_ID,\r\n            label: this.getResource(\"render-search-clear-label\")\r\n        });\r\n\r\n        // Bind click event\r\n        searchItem.click(function () {\r\n            self.setValue({ id: \"\" });\r\n            self.setDisplayValue(\"\");\r\n        });\r\n\r\n        return searchItem;\r\n    }\r\n});\r\n\r\n","/*\r\n*   Name: BizAgi Desktop queryExtendedText\r\n*   Author: Ivan Ricardo Taimal Narvaez\r\n*   Comments:queryExtendedText\r\n*   -\r\n*/\r\n\r\nbizagi.rendering.desktop.extendedText.extend(\"bizagi.rendering.desktop.queryExtendedText\", {}, {\r\n\r\n});\r\n\r\n","/*\r\n*   Name: BizAgi Desktop querySuggest\r\n*   Author: Ivan Ricardo Taimal Narvaez\r\n*   Comments:queryText\r\n*   -\r\n*/\r\n\r\nbizagi.rendering.desktop.text.extend(\"bizagi.rendering.desktop.queryText\", {}, {\r\n\r\n});\r\n\r\n","/*\r\n*   Name: BizAgi Desktop queryCheck\r\n*   Author: Ivan Ricardo Taimal Narvaez\r\n*   Comments:queryCheck\r\n*   -\r\n*/\r\n\r\nbizagi.rendering.desktop.check.extend(\"bizagi.rendering.desktop.queryCheck\", {}, {\r\n     /*\r\n     *   Returns the internal value\r\n     */\r\n    getValue: function () {\r\n        return  bizagi.util.parseBoolean(this.value);\r\n    }\r\n});\r\n\r\n","/*\r\n*   Name: BizAgi Desktop queryYesNo\r\n*   Author: Ivan Ricardo Taimal Narvaez\r\n*   Comments:queryYesNo\r\n*   -\r\n*/\r\n\r\nbizagi.rendering.desktop.yesno.extend(\"bizagi.rendering.desktop.queryYesNo\", {}, {\r\n    /*\r\n     *   Returns the internal value\r\n     */\r\n    getValue: function () {\r\n        return  bizagi.util.parseBoolean(this.value);\r\n    }\r\n});\r\n\r\n","/*\r\n*   Name: BizAgi Desktop querySearch\r\n*   Author: Ivan Ricardo Taimal Narvaez\r\n*   Comments:querySearch\r\n*   -\r\n*/\r\n\r\nbizagi.rendering.desktop.search.extend(\"bizagi.rendering.desktop.querySearch\", {}, {\r\n     /*\r\n     *   Opens the search dialog\r\n     */\r\n    showSearchDialog: function () {\r\n        var self = this,\r\n            properties = self.properties,\r\n            extraButtons,\r\n            contextType = (properties.searchForms.length > 0 && properties.searchForms[0].type == \"searchForm\") ? \"metadata\" : \"entity\";\r\n\r\n        // Define add button\r\n        if (properties.allowNew) {\r\n            extraButtons = self.showAddRecordDialog();\r\n        }\r\n\r\n        // Show search dialog\r\n        self.searchDialog = new bizagi.rendering.dialog.search(self.dataService, self.renderFactory, properties.searchForms, {\r\n            allowFullSearch: properties.allowFullSearch,\r\n            maxRecords: properties.maxRecords\r\n        }, extraButtons);\r\n\r\n        self.searchDialog.render({\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            contexttype: contextType\r\n        }).done(function (item) {\r\n            data={id:item.id,value:item.id};\r\n            // Set data\r\n            self.setDisplayValue(data);\r\n            self.setValue(data);\r\n        });\r\n    }\r\n});\r\n\r\n","/**\r\n*   Name: Bizagi Desktop queryForm Extension\r\n*   Author: UI Forms Team\r\n *   Comments:\r\n*   -   This script will redefine the container class to adjust to desktop devices\r\n*   -   Will apply a desktop form template\r\n*/\r\n\r\n// Extends from form desktop base\r\nbizagi.rendering.desktop.form.extend(\"bizagi.rendering.desktop.queryForm\", {}, {\r\n\r\n    /*\r\n     *    Create a function to hide check all element in view when no contains check elements\r\n     */\r\n    postRenderContainer: function (container) {\r\n        var self = this;\r\n        var checkIncluded = [];\r\n        var checkIncludedAll = self.container.find(\".ui-bizagi-render-control-included-all\");\r\n        // Call base\r\n        self._super(container);\r\n        checkIncluded = self.container.find(\".ui-bizagi-render-control-included\");\r\n        if(checkIncluded.length <= 0 ){\r\n            checkIncludedAll.parent().hide();\r\n        }\r\n    },\r\n    /*\r\n    *    Creates a json array with key values to send to the server\r\n    */\r\n    collectRenderValuesForSubmit: function (request) {\r\n        var self = this;\r\n        var data = [];\r\n        // Collect data in array\r\n        self.collectRenderValuesQueryForm(data);\r\n\r\n        // Mark data collected as original values\r\n        $.each(data, function (i, item) {\r\n            var renders = self.getRenders(item.xpath);\r\n            $.each(renders, function (i, render) {\r\n                render.updateOriginalValue();\r\n            });\r\n        });\r\n        request.parameters = data;\r\n        return request;\r\n    },\r\n\r\n    getSearchParams: function (request) {\r\n        var self = this;\r\n        self.validationController = new bizagi.command.controllers.validation(self, self.validations);\r\n        var valid = self.validationController.performValidations();\r\n        if (valid) {\r\n            return self.collectRenderValuesForSubmit(request);\r\n        } else {\r\n            self.validationController.expandNotificationBox();\r\n            return null;\r\n        }\r\n    },\r\n    /*\r\n    *  configure Handlers for check  all column included in the response\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        self._super();\r\n        var checkIncludedAll = self.container.find(\".ui-bizagi-render-control-included-all\");\r\n        checkIncludedAll.tooltip({ position: { my: \"right-20 center\", at: \"right center\" }, tooltipClass: 'bz-wp-queryForm-check-all'});\r\n        checkIncludedAll.change(function () {\r\n            var newValue = checkIncludedAll.is(\":checked\");\r\n\r\n            var checkedChildren = function (target) {\r\n                $.each(target.children, function (i, item) {\r\n                    if (item.element) {\r\n                        if(item.properties.visible===true && item.properties.includedInResult===true){\r\n                            item.properties.included = newValue;\r\n                            var checkIncluded = item.element.find(\".ui-bizagi-render-control-included\");\r\n                            checkIncluded.prop(\"checked\", newValue);\r\n                        }\r\n                    }\r\n                    else if (item.children) {\r\n                        checkedChildren(item);\r\n                    }\r\n                });\r\n            };\r\n\r\n            checkedChildren(self);\r\n        });\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Desktop FormTemplate Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the form template class to adjust to desktop devices\r\n */\r\n\r\n// Extends from desktop form base\r\nbizagi.rendering.desktop.form.extend(\"bizagi.rendering.desktop.formTemplate\", bizagi.rendering.formTemplate.prototype);\r\n// Extends itself\r\nbizagi.rendering.desktop.formTemplate.extend(\"bizagi.rendering.desktop.formTemplate\", {}, {});\r\n","/*\r\n *   Name: Bizagi Desktop Render Factory\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define a render factory to create desktop versions of each render type\r\n */\r\n\r\nbizagi.rendering.base.factory.extend(\"bizagi.rendering.desktop.factory\", {}, {\r\n    /**\r\n     * Constructor\r\n     */\r\n    init: function (dataService) {\r\n        // Call base\r\n        this._super(dataService);\r\n\r\n        // Desktop implementation\r\n        this.printVersion = false;\r\n    },\r\n\r\n    /**\r\n     * Load all the templates used for rendering\r\n     */\r\n    loadTemplates: function () {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        $.when(\r\n            // Icons\r\n            self.loadTemplate(\"icons\", bizagi.getTemplate(\"common.bizagi.rendering.icons\")),\r\n\r\n            // Common\r\n            self.loadTemplate(\"form-error\", bizagi.getTemplate(\"bizagi.rendering.desktop.form-error\")),\r\n            self.loadTemplate(\"form-waiting\", bizagi.getTemplate(\"bizagi.rendering.desktop.form-waiting\")),\r\n            self.loadTemplate(\"info-message\", bizagi.getTemplate(\"common.bizagi.desktop.info-message\")),\r\n            // Containers\r\n            self.loadTemplate(\"form\", bizagi.getTemplate(\"bizagi.rendering.desktop.form\") + \"#ui-bizagi-render-form\"),\r\n            self.loadTemplate(\"form-process-path\", bizagi.getTemplate(\"bizagi.rendering.desktop.form\") + \"#ui-bizagi-render-form-process-path\"),\r\n            self.loadTemplate(\"panel\", bizagi.getTemplate(\"bizagi.rendering.desktop.panel\")),\r\n            self.loadTemplate(\"contentPanel\", bizagi.getTemplate(\"bizagi.rendering.desktop.contentPanel\")),\r\n            self.loadTemplate(\"tab\", bizagi.getTemplate(\"bizagi.rendering.desktop.tab\")),\r\n            self.loadTemplate(\"tabItem\", bizagi.getTemplate(\"bizagi.rendering.desktop.tabItem\")),\r\n            self.loadTemplate(\"collectionnavigator\", bizagi.getTemplate(\"bizagi.rendering.desktop.collectionnavigator\") + \"#ui-bizagi-render-collectionnavigator\"),\r\n            self.loadTemplate(\"collectionnavigator-form-button\", bizagi.getTemplate(\"bizagi.rendering.desktop.collectionnavigator\") + \"#ui-bizagi-render-collectionnavigator-form-button\"),\r\n            self.loadTemplate(\"collectionnavigator-control\", bizagi.getTemplate(\"bizagi.rendering.desktop.collectionnavigator\") + \"#ui-bizagi-render-collectionnavigator-control\"),\r\n            self.loadTemplate(\"collectionnavigator-actions\", bizagi.getTemplate(\"bizagi.rendering.desktop.collectionnavigator\") + \"#ui-bizagi-render-collectionnavigator-actions\"),\r\n            self.loadTemplate(\"collectionnavigator-preview\", bizagi.getTemplate(\"bizagi.rendering.desktop.collectionnavigator\") + \"#ui-bizagi-render-collectionnavigator-preview\"),\r\n            self.loadTemplate(\"collectionnavigator-execution\", bizagi.getTemplate(\"bizagi.rendering.desktop.collectionnavigator\") + \"#ui-bizagi-render-collectionnavigator-execution\"),\r\n            self.loadTemplate(\"horizontal\", bizagi.getTemplate(\"bizagi.rendering.desktop.horizontal\")),\r\n            self.loadTemplate(\"accordion\", bizagi.getTemplate(\"bizagi.rendering.desktop.accordion\")),\r\n            self.loadTemplate(\"accordionItem\", bizagi.getTemplate(\"bizagi.rendering.desktop.accordionItem\")),\r\n            self.loadTemplate(\"group\", bizagi.getTemplate(\"bizagi.rendering.desktop.group\")),\r\n            self.loadTemplate(\"searchForm\", bizagi.getTemplate(\"bizagi.rendering.desktop.searchForm\")),\r\n            // Renders\r\n            self.loadTemplate(\"render\", bizagi.getTemplate(\"bizagi.rendering.desktop.render\")),\r\n            self.loadTemplate(\"render-base\", bizagi.getTemplate(\"bizagi.rendering.desktop.render.base\")),\r\n\r\n            self.loadTemplate(\"render-layout\", bizagi.getTemplate(\"bizagi.rendering.desktop.render.layout\")),\r\n\r\n            self.loadTemplate(\"render-userPassword\", bizagi.getTemplate(\"bizagi.rendering.desktop.userPassword\") + \"#bz-rendering-userPassword\"),\r\n            self.loadTemplate(\"render-getUser\", bizagi.getTemplate(\"bizagi.rendering.desktop.getUser\") + \"#bz-rendering-getUser\"),\r\n            self.loadTemplate(\"render-user-email\", bizagi.getTemplate(\"bizagi.rendering.desktop.userEmail\") + \"#bz-rendering-user-email\"),\r\n            self.loadTemplate(\"render-comboSelected\", bizagi.getTemplate(\"bizagi.rendering.desktop.comboSelected\") + \"#bz-rendering-comboSelected\"),\r\n            self.loadTemplate(\"render-comboSelectedReadOnly\", bizagi.getTemplate(\"bizagi.rendering.desktop.comboSelected\") + \"#bz-rendering-comboSelected-ReadOnly\"),\r\n            self.loadTemplate(\"render-querySearchUser\", bizagi.getTemplate(\"bizagi.rendering.desktop.querySearchUser\") + \"#ui-bizagi-render-querySearchUser\"),\r\n            self.loadTemplate(\"text\", bizagi.getTemplate(\"bizagi.rendering.desktop.text\") + \"#ui-bizagi-render-text\"),\r\n            self.loadTemplate(\"text-read-only\", bizagi.getTemplate(\"bizagi.rendering.desktop.text\") + \"#ui-bizagi-render-text-read-only\"),\r\n            self.loadTemplate(\"extendedText\", bizagi.getTemplate(\"bizagi.rendering.desktop.extendedText\")),\r\n            self.loadTemplate(\"number\", bizagi.getTemplate(\"bizagi.rendering.desktop.number\")),\r\n            self.loadTemplate(\"numberScientificNotation\", bizagi.getTemplate(\"bizagi.rendering.desktop.numberScientificNotation\") + \"#bz-rendering-numberScientificNotation\"),\r\n            self.loadTemplate(\"date\", bizagi.getTemplate(\"bizagi.rendering.desktop.date\")),\r\n            self.loadTemplate(\"yesno\", bizagi.getTemplate(\"bizagi.rendering.desktop.yesno\")),\r\n            self.loadTemplate(\"check\", bizagi.getTemplate(\"bizagi.rendering.desktop.check\")),\r\n            self.loadTemplate(\"combo\", bizagi.getTemplate(\"bizagi.rendering.desktop.combo\")),\r\n            self.loadTemplate(\"list\", bizagi.getTemplate(\"bizagi.rendering.desktop.list\")),\r\n            self.loadTemplate(\"geolocation\", bizagi.getTemplate(\"bizagi.rendering.desktop.geolocation\")),\r\n            self.loadTemplate(\"radio\", bizagi.getTemplate(\"bizagi.rendering.desktop.radio\")),\r\n            self.loadTemplate(\"image\", bizagi.getTemplate(\"bizagi.rendering.desktop.image\") + \"#ui-bizagi-render-image\"),\r\n            self.loadTemplate(\"images\", bizagi.getTemplate(\"bizagi.rendering.desktop.image\") + \"#ui-bizagi-render-images\"),\r\n            self.loadTemplate(\"image-dialog\", bizagi.getTemplate(\"bizagi.rendering.desktop.image\") + \"#ui-bizagi-render-image-dialog\"),\r\n            self.loadTemplate(\"image-item\", bizagi.getTemplate(\"bizagi.rendering.desktop.image\") + \"#ui-bizagi-render-image-item\"),\r\n            self.loadTemplate(\"upload-ecm-view-default\", bizagi.getTemplate(\"bizagi.rendering.desktop.ecm\") + \"#biz-render-ecm-view-default\"),\r\n            self.loadTemplate(\"upload-ecm-view-default-metadata\", bizagi.getTemplate(\"bizagi.rendering.desktop.ecm\") + \"#biz-render-ecm-view-default-metadata\"),\r\n            self.loadTemplate(\"upload-ecm-view-default-yesno\", bizagi.getTemplate(\"bizagi.rendering.desktop.ecm\") + \"#biz-render-ecm-view-default-yesno\"),\r\n            self.loadTemplate(\"upload-ecm-view-default-edit-buttons\", bizagi.getTemplate(\"bizagi.rendering.desktop.ecm\") + \"#biz-render-ecm-view-default-edit-buttons\"),\r\n            self.loadTemplate(\"document\", bizagi.getTemplate(\"bizagi.rendering.desktop.document\") + \"#bz-document-generator\"),\r\n            self.loadTemplate(\"document-item\", bizagi.getTemplate(\"bizagi.rendering.desktop.document\") + \"#bz-document-generator-item\"),\r\n            self.loadTemplate(\"document-column-item\", bizagi.getTemplate(\"bizagi.rendering.desktop.document\") + \"#bz-document-generator-column-item\"),\r\n            self.loadTemplate(\"document-item-preview\", bizagi.getTemplate(\"bizagi.rendering.desktop.document\") + \"#bz-document-generator-item-preview\"),\r\n            self.loadTemplate(\"document-item-preview-object\", bizagi.getTemplate(\"bizagi.rendering.desktop.document\") + \"#bz-document-generator-item-preview-object\"),\r\n            self.loadTemplate(\"uploadItem\", bizagi.getTemplate(\"bizagi.rendering.desktop.uploadItem\")),\r\n            self.loadTemplate(\"upload\", bizagi.getTemplate(\"bizagi.rendering.desktop.upload\")),\r\n            self.loadTemplate(\"upload.dialog\", bizagi.getTemplate(\"bizagi.rendering.desktop.upload.dialog\")),\r\n            self.loadTemplate(\"upload.template.dialog\", bizagi.getTemplate(\"bizagi.rendering.desktop.upload.template.dialog\")),\r\n            self.loadTemplate(\"upload.ecm.dialog\", bizagi.getTemplate(\"bizagi.rendering.desktop.upload.ecm.dialog\")),\r\n            self.loadTemplate(\"dialog-send-email\", bizagi.getTemplate(\"bizagi.rendering.desktop.dialog-sendEmail\") + \"#dialog-send-email\"),\r\n            self.loadTemplate(\"dialog-send-email-rtl\", bizagi.getTemplate(\"bizagi.rendering.desktop.dialog-sendEmail\") + \"#dialog-send-email-rtl\"),\r\n            self.loadTemplate(\"grid\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid\")),\r\n            self.loadTemplate(\"cell\", bizagi.getTemplate(\"bizagi.rendering.desktop.cell\")),\r\n            self.loadTemplate(\"cell.readonly\", bizagi.getTemplate(\"bizagi.rendering.desktop.cell.readonly\")),\r\n            self.loadTemplate(\"cell.summary\", bizagi.getTemplate(\"bizagi.rendering.desktop.cell.summary\")),\r\n            self.loadTemplate(\"cell.upload\", bizagi.getTemplate(\"bizagi.rendering.desktop.cell.upload\")),\r\n            self.loadTemplate(\"cell.button\", bizagi.getTemplate(\"bizagi.rendering.desktop.cell.button\")),\r\n            self.loadTemplate(\"search\", bizagi.getTemplate(\"bizagi.rendering.desktop.search\")),\r\n            self.loadTemplate(\"searchItem\", bizagi.getTemplate(\"bizagi.rendering.desktop.searchItem\")),\r\n            self.loadTemplate(\"searchList\", bizagi.getTemplate(\"bizagi.rendering.desktop.searchList\") + \"#bz-searchList\"),\r\n            self.loadTemplate(\"searchListTag\", bizagi.getTemplate(\"bizagi.rendering.desktop.searchList\") + \"#bz-searchList-tag\"),\r\n            self.loadTemplate(\"letter\", bizagi.getTemplate(\"bizagi.rendering.desktop.letter\")),\r\n            self.loadTemplate(\"letter.readonly\", bizagi.getTemplate(\"bizagi.rendering.desktop.letter.readonly\")),\r\n            self.loadTemplate(\"letter.dialog\", bizagi.getTemplate(\"bizagi.rendering.desktop.dialog-letter\")),\r\n            self.loadTemplate(\"button\", bizagi.getTemplate(\"bizagi.rendering.desktop.button\")),\r\n            self.loadTemplate(\"fileprint\", bizagi.getTemplate(\"bizagi.rendering.desktop.fileprint\") + \"#ui-bizagi-render-fileprint\"),\r\n            self.loadTemplate(\"fileprint-object\", bizagi.getTemplate(\"bizagi.rendering.desktop.fileprint\") + \"#ui-bizagi-render-fileprint-object\"),\r\n            self.loadTemplate(\"fileprint-iframe\", bizagi.getTemplate(\"bizagi.rendering.desktop.fileprint\") + \"#ui-bizagi-render-fileprint-iframe\"),\r\n            self.loadTemplate(\"link\", bizagi.getTemplate(\"bizagi.rendering.desktop.link\")),\r\n            self.loadTemplate(\"formLink\", bizagi.getTemplate(\"bizagi.rendering.desktop.formLink\")),\r\n            self.loadTemplate(\"association\", bizagi.getTemplate(\"bizagi.rendering.desktop.association\")),\r\n            self.loadTemplate(\"stakeholder\", bizagi.getTemplate(\"bizagi.rendering.desktop.stakeholder\") + \"#bz-rendering-stakeholder\"),\r\n            self.loadTemplate(\"stakeholder-grid\", bizagi.getTemplate(\"bizagi.rendering.desktop.stakeholder\") + \"#bz-rendering-stakeholder-grid\"),\r\n            self.loadTemplate(\"stakeholder-paginator\", bizagi.getTemplate(\"bizagi.rendering.desktop.stakeholder\") + \"#bz-rendering-stakeholder-paginator\"),\r\n            self.loadTemplate(\"queryProcess\", bizagi.getTemplate(\"bizagi.rendering.desktop.queryProcess\") + \"#ui-bizagi-render-query-process\"),\r\n            self.loadTemplate(\"checkList\", bizagi.getTemplate(\"bizagi.rendering.desktop.checkList\") + \"#bz-rendering-checkList\"),\r\n            self.loadTemplate(\"checkList-disabled\", bizagi.getTemplate(\"bizagi.rendering.desktop.checkList\") + \"#bz-rendering-checkList-disabled\"),\r\n            self.loadTemplate(\"readonly\", bizagi.getTemplate(\"bizagi.rendering.desktop.readonly\")),\r\n\r\n            //render layout controls\r\n            self.loadTemplate(\"layout-link\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.link\")),\r\n            self.loadTemplate(\"layout-image\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.image\") + \"#ui-bizagi-render-layout-image\"),\r\n            self.loadTemplate(\"layout-image64\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.image\") + \"#ui-bizagi-render-layout-image64\"),\r\n            self.loadTemplate(\"layout-label\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.label\")),\r\n            self.loadTemplate(\"layout-text\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.text\")),\r\n            self.loadTemplate(\"layout-upload\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.upload\")),\r\n            self.loadTemplate(\"layout-uploadItem\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.uploadItem\")),\r\n            self.loadTemplate(\"layout-date-time\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.dateTime\")),\r\n            self.loadTemplate(\"layout-number\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.number\")),\r\n            self.loadTemplate(\"layout-money\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.money\")),\r\n            self.loadTemplate(\"layout-placeholder\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.placeholder\")),\r\n            self.loadTemplate(\"layout-boolean\", bizagi.getTemplate(\"bizagi.rendering.desktop.layout.yesno\")),\r\n\r\n            //action launcher\r\n            self.loadTemplate(\"render-actionLauncher\", bizagi.getTemplate(\"bizagi.rendering.desktop.actionLauncher\") + \"#bz-rendering-actionLauncher\"),\r\n            self.loadTemplate(\"render-actionLauncher-horizontal\", bizagi.getTemplate(\"bizagi.rendering.desktop.actionLauncher\") + \"#bz-rendering-actionLauncher-horizontal\"),\r\n            self.loadTemplate(\"render-actionLauncher-horizontal-more\", bizagi.getTemplate(\"bizagi.rendering.desktop.actionLauncher\") + \"#bz-rendering-actionLauncher-horizontal-more\"),\r\n            self.loadTemplate(\"render-actionLauncher-vertical\", bizagi.getTemplate(\"bizagi.rendering.desktop.actionLauncher\") + \"#bz-rendering-actionLauncher-vertical\"),\r\n            self.loadTemplate(\"render-actionLauncher-actions-to-execute\", bizagi.getTemplate(\"bizagi.rendering.desktop.actionLauncher\") + \"#bz-rendering-actionLauncher-actions-to-execute\"),\r\n            self.loadTemplate(\"render-actionLauncher-design\", bizagi.getTemplate(\"bizagi.rendering.desktop.actionLauncher\") + \"#bz-rendering-actionLauncher-design\"),\r\n            self.loadTemplate(\"render-actionLauncher-confirm\", bizagi.getTemplate(\"bizagi.rendering.desktop.actionLauncher\") + \"#bz-rendering-actionLauncher-confirm\"),\r\n\r\n            self.loadTemplate(\"render-polymorphicLauncher\", bizagi.getTemplate(\"bizagi.rendering.desktop.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher\"),\r\n            self.loadTemplate(\"render-polymorphicLauncher-vertical-tree\", bizagi.getTemplate(\"bizagi.rendering.desktop.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-vertical-tree\"),\r\n            self.loadTemplate(\"render-polymorphicLauncher-vertical-tree-item\", bizagi.getTemplate(\"bizagi.rendering.desktop.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-vertical-tree-item\"),\r\n            self.loadTemplate(\"render-polymorphicLauncher-actions-to-execute\", bizagi.getTemplate(\"bizagi.rendering.desktop.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-actions-to-execute\"),\r\n            self.loadTemplate(\"render-polymorphicLauncher-design\", bizagi.getTemplate(\"bizagi.rendering.desktop.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-design\"),\r\n            self.loadTemplate(\"render-polymorphicLauncher-confirm\", bizagi.getTemplate(\"bizagi.rendering.desktop.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-confirm\"),\r\n\r\n\r\n            (bizagi.override.enablePrintFromEditForm) ? self.loadTemplate(\"print-frame\", bizagi.getTemplate(\"bizagi.workportal.desktop.widget.print\") + \"#bz-wp-widget-print-frame\") : null, (bizagi.override.enablePrintFromEditForm) ? self.loadTemplate(\"print-frame-header\", bizagi.getTemplate(\"bizagi.workportal.desktop.widget.print\") + \"#bz-wp-widget-print-frame-header\") : null,\r\n\r\n            //Bizagi grid\r\n            self.loadTemplate(\"grid.bizagi\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.component\")),\r\n            self.loadTemplate(\"bizagi.grid.grid\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid\"),\r\n            self.loadTemplate(\"bizagi.grid.grid.rtl\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-rtl\"),\r\n            self.loadTemplate(\"bizagi.grid.waiting\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-waiting\"),\r\n            self.loadTemplate(\"bizagi.grid.table\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-table\"),\r\n            self.loadTemplate(\"bizagi.grid.table.empty\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-table-empty\"),\r\n            self.loadTemplate(\"bizagi.grid.column\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-column\"),\r\n            self.loadTemplate(\"bizagi.grid.column.special\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-column-special\"),\r\n            self.loadTemplate(\"bizagi.grid.row\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-row\"),\r\n            self.loadTemplate(\"bizagi.grid.row.buttons\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-row-buttons\"),\r\n            self.loadTemplate(\"bizagi.grid.row.buttons.rtl\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-row-buttons-rtl\"),\r\n            self.loadTemplate(\"bizagi.grid.cell\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-cell\"),\r\n            self.loadTemplate(\"bizagi.grid.cell.special\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-cell-special\"),\r\n            //Grig Pager based on inboxgrid pager\r\n            self.loadTemplate(\"bizagi.grid.pagination\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-pagination\"),\r\n            self.loadTemplate(\"bizagi.grid.pager\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-pager\"),\r\n            self.loadTemplate(\"bizagi.grid.buttons\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-buttons\"),\r\n            self.loadTemplate(\"bizagi.grid.buttons.rtl\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-buttons-rtl\"),\r\n            self.loadTemplate(\"bizagi.grid.dynamicpager\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-dynamic-pager\"),\r\n            self.loadTemplate(\"bizagi.grid.summary\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-summary\"),\r\n            self.loadTemplate(\"bizagi.grid.summaryCell\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-summary-cell\"),\r\n            // Grouped grid\r\n            self.loadTemplate(\"bizagi.grid.grouped.table\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-grouped-table\"),\r\n            self.loadTemplate(\"bizagi.grid.grouped.column\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-grouped-column\"),\r\n            self.loadTemplate(\"bizagi.grid.grouped.row\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-grouped-row\"),\r\n            self.loadTemplate(\"bizagi.grid.grouped.header.row\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-grouped-header-row\"),\r\n            self.loadTemplate(\"bizagi.grid.grouped.summary\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-grouped-summary\"),\r\n            self.loadTemplate(\"bizagi.grid.grouped.summaryCell\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-grouped-summary-cell\"),\r\n            self.loadTemplate(\"bizagi.grid.grouped.emptyCell\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-grouped-empty-cell\"),\r\n            //plugin search user\r\n            self.loadTemplate(\"bizagi.plugin.search.user\", bizagi.getTemplate(\"bizagi.plugin.searchuser\") + \"#ui-bizagi-plugin-search-user\"),\r\n            self.loadTemplate(\"gridActions\", bizagi.getTemplate(\"bizagi.rendering.desktop.gridActions\") + \"#ui-bizagi-grid-actions-more\"),\r\n            self.loadTemplate(\"gridActions-delete\", bizagi.getTemplate(\"bizagi.rendering.desktop.gridActions\") + \"#ui-bizagi-grid-actions-delete\"),\r\n\r\n            // List multi-select\r\n            self.loadTemplate(\"list-multiselect\", bizagi.getTemplate(\"bizagi.rendering.desktop.multiSelect\") + \"#bz-list-multiselect\"),\r\n            self.loadTemplate(\"list-multiselect-item\", bizagi.getTemplate(\"bizagi.rendering.desktop.multiSelect\") + \"#bz-list-multiselect-item\"),\r\n            self.loadTemplate(\"list-multiselect-tag\", bizagi.getTemplate(\"bizagi.rendering.desktop.multiSelect\") + \"#bz-list-multiselect-tag\"),\r\n            self.loadTemplate(\"list-multiselect-tags\", bizagi.getTemplate(\"bizagi.rendering.desktop.multiSelect\") + \"#bz-list-multiselect-tags\"),\r\n            self.loadTemplate(\"list-multiselect-view-more\", bizagi.getTemplate(\"bizagi.rendering.desktop.multiSelect\") + \"#bz-list-multiselect-view-more\"),\r\n\r\n\r\n            //Range control\r\n            self.loadTemplate(\"render-range\", bizagi.getTemplate(\"bizagi.rendering.desktop.range\") + \"#bz-rendering-range\"),\r\n\r\n            self.loadTemplate(\"bizagi.grid.exportOptions\", bizagi.getTemplate(\"bizagi.rendering.desktop.grid.bizagi\") + \"#ui-bizagi-grid-export-options\")).done(function () {\r\n            var tmplIcons = $.fasttmpl(self.getTemplate(\"icons\"));\r\n            var svgStoreCounter = $(\"head\").find('#genome-forms-icons').length;\r\n\r\n            if (svgStoreCounter === 0) {\r\n                $(\"head\").append(tmplIcons);\r\n            }\r\n\r\n            // Resolve when all templates are loaded\r\n            defer.resolve();\r\n\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Load javascripts after render has been rendered\r\n     */\r\n    loadOverrides: function () {\r\n        // Load custom javascript overrides\r\n        if (bizagi.enableCustomizations) {\r\n            return bizagi.util.loadFile({\r\n                src: bizagi.getJavaScript(\"bizagi.rendering.desktop.overrides\"),\r\n                type: \"js\"\r\n            });\r\n        }\r\n\r\n        return;\r\n    },\r\n\r\n    getContainer: function (params) {\r\n        var self = this;\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var containerParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (type == \"form\") {\r\n            return new bizagi.rendering.desktop.form(containerParams);\r\n        }\r\n\r\n        if (type == \"template\") {\r\n            return new bizagi.rendering.desktop.formTemplate(containerParams);\r\n        }\r\n\r\n        if (type == \"queryForm\") {\r\n            return new bizagi.rendering.desktop.queryForm(containerParams);\r\n        }\r\n\r\n        if (type == \"layout\") {\r\n            return new bizagi.rendering.desktop.layout(containerParams);\r\n        }\r\n\r\n        if (type == \"usersForm\") {\r\n            return new bizagi.rendering.desktop.usersForm(containerParams);\r\n        }\r\n\r\n        if (type == \"panel\") {\r\n            return new bizagi.rendering.desktop.panel(containerParams);\r\n        }\r\n\r\n        if (type == \"contentPanel\" || type == \"contentpanel\") {\r\n            return new bizagi.rendering.desktop.contentPanel(containerParams);\r\n        }\r\n\r\n        if (type == \"nestedForm\") {\r\n            return new bizagi.rendering.desktop.nestedForm(containerParams);\r\n        }\r\n\r\n        if (type == \"tab\") {\r\n            return new bizagi.rendering.desktop.tab(containerParams);\r\n        }\r\n\r\n        if (type == \"tabItem\" || type == \"tabitem\") {\r\n            return new bizagi.rendering.desktop.tabItem(containerParams);\r\n        }\r\n\r\n        if (type == \"horizontal\") {\r\n            return new bizagi.rendering.desktop.horizontal(containerParams);\r\n        }\r\n\r\n        if (type == \"accordion\") {\r\n            return new bizagi.rendering.desktop.accordion(containerParams);\r\n        }\r\n\r\n        if (type == \"accordionItem\") {\r\n            return new bizagi.rendering.desktop.accordionItem(containerParams);\r\n        }\r\n\r\n        if (type == \"group\") {\r\n            return new bizagi.rendering.desktop.group(containerParams);\r\n        }\r\n\r\n        if (type == \"searchForm\") {\r\n            containerParams.context = \"search\";\r\n            containerParams.contexttype = \"metadata\";\r\n            return new bizagi.rendering.desktop.searchForm(containerParams);\r\n        }\r\n\r\n        if (type == \"mobileform\") {\r\n            return new bizagi.rendering.mobileform(containerParams);\r\n        }\r\n        if (type == \"mobilegroup\") {\r\n            return new bizagi.rendering.mobilegroup(containerParams);\r\n        }\r\n\r\n        if (type == \"mobiletext\") {\r\n            return new bizagi.rendering.mobiletext(renderParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n\r\n    /*\r\n     *   Returns the appropiate render based on the render type\r\n     */\r\n    getRender: function (params) {\r\n        var self = this;\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var properties = data.properties;\r\n        var renderParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (!type)\r\n            type = \"label\";\r\n\r\n        if (type === \"text\") {\r\n            var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\r\n\r\n            // Creates one extended render\r\n            if (isExtended) {\r\n                return new bizagi.rendering.desktop.extendedText(renderParams);\r\n            }\r\n\r\n            // Creates one normal text render\r\n            return new bizagi.rendering.desktop.text(renderParams);\r\n        }\r\n\r\n        if (type === \"association\") {\r\n            return new bizagi.rendering.desktop.association(renderParams);\r\n        }\r\n\r\n        if (type === \"label\") {\r\n            return new bizagi.rendering.desktop.label(renderParams);\r\n        }\r\n\r\n        if (type === \"hidden\") {\r\n            return new bizagi.rendering.desktop.hidden(renderParams);\r\n        }\r\n\r\n        if (type === \"number\") {\r\n            // Number Scientific Notation\r\n            if (properties && properties.dataType === 29) {\r\n                return new bizagi.rendering.desktop.numberScientificNotation(renderParams);\r\n            }\r\n\r\n            return new bizagi.rendering.desktop.number(renderParams);\r\n        }\r\n\r\n        if (type === \"money\") {\r\n            return new bizagi.rendering.desktop.money(renderParams);\r\n        }\r\n\r\n        if (type === \"date\") {\r\n            return new bizagi.rendering.desktop.date(renderParams);\r\n        }\r\n\r\n        if (type === \"boolean\") {\r\n            var display = data.properties.display || \"option\";\r\n\r\n            // Creates one check render\r\n            if (display === \"check\") {\r\n                return new bizagi.rendering.desktop.check(renderParams);\r\n            }\r\n\r\n            // Creates one yes-no render\r\n            return new bizagi.rendering.desktop.yesno(renderParams);\r\n        }\r\n\r\n        if (type === \"combo\") {\r\n            return new bizagi.rendering.desktop.combo(renderParams);\r\n        }\r\n\r\n        if (/^cascadingcombo$/i.test(type)) {\r\n            return new bizagi.rendering.desktop.cascadingCombo(renderParams);\r\n        }\r\n\r\n        if (type === \"list\") {\r\n            return new bizagi.rendering.desktop.list(renderParams);\r\n        }\r\n\r\n        if (type === \"radio\") {\r\n            return new bizagi.rendering.desktop.radio(renderParams);\r\n        }\r\n\r\n        if (type === \"image\") {\r\n            return new bizagi.rendering.desktop.image(renderParams);\r\n        }\r\n\r\n        if (type === \"uploadecm\") {\r\n            // Check if its ECM file            \r\n            return new bizagi.rendering.desktop.ecm(renderParams);\r\n        }\r\n\r\n        if (type === \"upload\") {\r\n            return new bizagi.rendering.desktop.upload(renderParams);\r\n        }\r\n\r\n        if (type === \"grid\") {\r\n            return new bizagi.rendering.desktop.grid.bizagi(renderParams);\r\n        }\r\n\r\n        if (type === \"groupedgrid\") {\r\n            return new bizagi.rendering.desktop.grid.grouped(renderParams);\r\n        }\r\n\r\n        if (type === \"search\") {\r\n            return new bizagi.rendering.desktop.search(renderParams);\r\n        }\r\n\r\n        if (type === \"suggest\") {\r\n            renderParams.data.properties.enableQuerySuggestBehavior = true;\r\n            return new bizagi.rendering.desktop.search(renderParams);\r\n        }\r\n\r\n        if (type === \"searchList\") {\r\n            return new bizagi.rendering.desktop.searchList(renderParams);\r\n        }\r\n\r\n        if (type == \"multiSelect\") {\r\n            return new bizagi.rendering.desktop.multiSelect(renderParams);\r\n        }\r\n\r\n        if (type === \"letter\") {\r\n            return new bizagi.rendering.desktop.letter(renderParams);\r\n        }\r\n\r\n        if (type === \"button\") {\r\n            return new bizagi.rendering.desktop.button(renderParams);\r\n        }\r\n\r\n        if (type === \"formLink\") {\r\n            return new bizagi.rendering.desktop.formLink(renderParams);\r\n        }\r\n\r\n        if (type === \"link\") {\r\n            return new bizagi.rendering.desktop.link(renderParams);\r\n        }\r\n\r\n        if (type === \"actionLauncher\") {\r\n            return new bizagi.rendering.desktop.actionLauncher(renderParams);\r\n        }\r\n\r\n        if (type === \"entityTemplate\") {\r\n            return new bizagi.rendering.desktop.entityTemplate(renderParams);\r\n        }\r\n\r\n        if (type === \"polymorphicLauncher\") {\r\n            return new bizagi.rendering.desktop.polymorphicLauncher(renderParams);\r\n        }\r\n\r\n        if (type === \"userfield\") {\r\n            return new bizagi.rendering.desktop.userfieldWrapper(renderParams);\r\n        }\r\n        // Check layout renders (starts with \"layout\")\r\n        if (type.indexOf(\"layout\") === 0) {\r\n            return self.getLayoutRender(params);\r\n        }\r\n\r\n        // Check search renders (starts with \"search\")\r\n        if (type.indexOf(\"search\") === 0) {\r\n            return self.getSearchRender(params);\r\n        }\r\n\r\n        // Check query renders (starts with \"query\")\r\n        if (type.indexOf(\"query\") === 0) {\r\n            return self.getQueryRender(params);\r\n        }\r\n\r\n        // Check range renders (starts with \"range\")\r\n        if (type.indexOf(\"range\") === 0) {\r\n            return self.getRangeRender(params);\r\n        }\r\n\r\n        if (type === \"document\") {\r\n            return new bizagi.rendering.desktop.document(renderParams);\r\n        }\r\n\r\n        if (type === \"image\") {\r\n            return new bizagi.rendering.desktop.image(renderParams);\r\n        }\r\n\r\n        if (type === \"fileprint\") {\r\n            return new bizagi.rendering.desktop.fileprint(renderParams);\r\n        }\r\n\r\n        if (type === \"geolocation\") {\r\n            return new bizagi.rendering.desktop.geolocation(renderParams);\r\n        }\r\n\r\n        if (type === \"collectionnavigator\") {\r\n            return new bizagi.rendering.desktop.collectionnavigator(renderParams);\r\n        }\r\n\r\n        if (type === \"activityCheckList\") {\r\n            return new bizagi.rendering.desktop.activityCheckList(renderParams);\r\n        }\r\n\r\n        if (type === \"getUser\") {\r\n            return new bizagi.rendering.desktop.getUser(renderParams);\r\n        }\r\n\r\n        if (type == \"userPassword\") {\r\n            return new bizagi.rendering.desktop.userPassword(renderParams);\r\n        }\r\n\r\n        if (type == \"comboSelected\") {\r\n            return new bizagi.rendering.desktop.comboSelected(renderParams);\r\n        }\r\n\r\n        if (type == \"stakeholder\") {\r\n            return new bizagi.rendering.desktop.stakeholder(renderParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n\r\n    /**\r\n     * Returns the appropiate column based on the render type\r\n     */\r\n    getColumn: function (params) {\r\n        var self = this;\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var properties = data.properties;\r\n        var columnParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService,\r\n            singleInstance: bizagi.util.isEmpty(params.singleInstance) ? true : params.singleInstance\r\n        });\r\n\r\n        if (type === \"columnText\") {\r\n            var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\r\n\r\n            if (isExtended) {\r\n                // Creates one extended render\r\n                columnParams.decorated = bizagi.rendering.desktop.extendedText;\r\n            } else {\r\n                // Creates one normal text render\r\n                columnParams.decorated = bizagi.rendering.desktop.text;\r\n            }\r\n            return new bizagi.rendering.desktop.columns.text(columnParams);\r\n        }\r\n\r\n        if (type === \"columnSearchList\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.searchList;\r\n            return new bizagi.rendering.desktop.columns.searchList(columnParams);\r\n        }\r\n\r\n        if (type === \"columnNumberScientificNotation\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.numberScientificNotation;\r\n            return new bizagi.rendering.desktop.columns.numberScientificNotation(columnParams);\r\n        }\r\n\r\n        if (type === \"columnNumber\") {\r\n            if (properties && properties.dataType === 29) {\r\n                columnParams.decorated = bizagi.rendering.desktop.numberScientificNotation;\r\n                return new bizagi.rendering.desktop.columns.numberScientificNotation(columnParams);\r\n            } else {\r\n                columnParams.decorated = bizagi.rendering.desktop.number;\r\n                return new bizagi.rendering.desktop.columns.number(columnParams);\r\n            }\r\n        }\r\n\r\n        if (type === \"columnMoney\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.money;\r\n            return new bizagi.rendering.desktop.columns.number(columnParams);\r\n        }\r\n\r\n        if (type === \"columnDate\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.date;\r\n            return new bizagi.rendering.desktop.columns.date(columnParams);\r\n        }\r\n\r\n        if (type === \"columnBoolean\") {\r\n            var display = data.properties.display || \"option\";\r\n\r\n            if (display === \"check\") {\r\n                // Creates one check render\r\n                columnParams.decorated = bizagi.rendering.desktop.check;\r\n                if (params.data.properties.isExclusive) {\r\n                    return new bizagi.rendering.desktop.columns.exclusiveCheck(columnParams);\r\n                }\r\n            } else {\r\n                // Creates one yes-no render\r\n                columnParams.decorated = bizagi.rendering.desktop.yesno;\r\n            }\r\n\r\n            return new bizagi.rendering.desktop.columns.column(columnParams);\r\n        }\r\n\r\n        if (type === \"columnCombo\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.combo;\r\n            return new bizagi.rendering.desktop.columns.combo(columnParams);\r\n        }\r\n\r\n        if (type === \"columnRadio\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.radio;\r\n            return new bizagi.rendering.desktop.columns.radio(columnParams);\r\n        }\r\n\r\n        if (type === \"columnList\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.list;\r\n            return new bizagi.rendering.desktop.columns.list(columnParams);\r\n        }\r\n\r\n        if (type === \"columnHidden\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.hidden;\r\n            return new bizagi.rendering.desktop.columns.column(columnParams);\r\n        }\r\n\r\n        if (type === \"columnUpload\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.upload;\r\n            return new bizagi.rendering.desktop.columns.upload(columnParams);\r\n        }\r\n\r\n        if (type === \"columnImage\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.image;\r\n            return new bizagi.rendering.desktop.columns.image(columnParams);\r\n        }\r\n\r\n        if (type === \"columnUploadEcm\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.ecm;\r\n            return new bizagi.rendering.desktop.columns.uploadecm(columnParams);\r\n        }\r\n\r\n        if (type === \"columnLink\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.link;\r\n            return new bizagi.rendering.desktop.columns.link(columnParams);\r\n        }\r\n\r\n        if (type === \"columnFormLink\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.formLink;\r\n            return new bizagi.rendering.desktop.columns.link(columnParams);\r\n        }\r\n\r\n        if (type === \"columnUserfield\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.userfieldWrapper;\r\n            return new bizagi.rendering.desktop.columns.column(columnParams);\r\n        }\r\n\r\n        if (type === \"columnSearch\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.search;\r\n            return new bizagi.rendering.desktop.columns.search(columnParams);\r\n        }\r\n\r\n        if (type === \"columnLabel\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.label;\r\n            return new bizagi.rendering.desktop.columns.column(columnParams);\r\n        }\r\n\r\n        if (type === \"columnReadonly\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.label;\r\n            return new bizagi.rendering.desktop.columns.readonly(columnParams);\r\n        }\r\n\r\n        if (type === \"columnDocument\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.document;\r\n            return new bizagi.rendering.desktop.columns.document(columnParams);\r\n        }\r\n\r\n        if (type === \"columnLetter\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.letter;\r\n            return new bizagi.rendering.desktop.columns.letter(columnParams);\r\n        }\r\n\r\n        if (type === \"columnButton\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.button;\r\n            return new bizagi.rendering.desktop.columns.button(columnParams);\r\n        }\r\n\r\n        if (type === \"columnActions\") {\r\n            columnParams.decorated = bizagi.rendering.desktop.gridActions;\r\n            return new bizagi.rendering.desktop.columns.actions(columnParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n\r\n    /**\r\n     * Returns the appropiatelayout render based on the type\r\n     * @param {} params\r\n     * @returns {}\r\n     */\r\n    getLayoutRender: function (params) {\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var renderParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (type === \"layoutImage\") {\r\n            return new bizagi.rendering.desktop.layoutImage(renderParams);\r\n        }\r\n\r\n        if (type === \"layoutLink\") {\r\n            return new bizagi.rendering.desktop.layoutLink(renderParams);\r\n        }\r\n\r\n        if (type === \"layoutLabel\") {\r\n            return new bizagi.rendering.desktop.layoutLabel(renderParams);\r\n        }\r\n\r\n        if (type === \"layoutText\") {\r\n            return new bizagi.rendering.desktop.layoutText(renderParams);\r\n        }\r\n\r\n        if (type === \"layoutDateTime\") {\r\n            return new bizagi.rendering.desktop.layoutDateTime(renderParams);\r\n        }\r\n\r\n        if (type === \"layoutNumber\") {\r\n            return new bizagi.rendering.desktop.layoutNumber(renderParams);\r\n        }\r\n\r\n        if (type === \"layoutMoney\") {\r\n            return new bizagi.rendering.desktop.layoutMoney(renderParams);\r\n        }\r\n\r\n        if (type === \"layoutPlaceholder\") {\r\n            return new bizagi.rendering.desktop.layoutPlaceholder(renderParams);\r\n        }\r\n\r\n        if (type === \"layoutBoolean\") {\r\n            return new bizagi.rendering.desktop.layoutBoolean(renderParams);\r\n        }\r\n\r\n        if (type === \"layoutUpload\") {\r\n            return new bizagi.rendering.desktop.layoutUpload(renderParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Returns the appropiate search render based on the type\r\n    */\r\n    getSearchRender: function (params) {\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var searchParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (type == \"searchText\") {\r\n            var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\r\n\r\n            if (isExtended) {\r\n                // Creates one extended render\r\n                return new bizagi.rendering.desktop.extendedText(searchParams);\r\n            }\r\n\r\n            // Creates one normal text render\r\n            return new bizagi.rendering.desktop.text(searchParams);\r\n        }\r\n\r\n        if (type == \"searchBoolean\") {\r\n            var display = data.properties.display || \"option\";\r\n\r\n            if (display == \"check\") {\r\n                // Creates one check render\r\n                return new bizagi.rendering.desktop.check(searchParams);\r\n            }\r\n\r\n            // Creates one yes-no render\r\n            return new bizagi.rendering.desktop.yesno(searchParams);\r\n        }\r\n\r\n        if (type == \"searchNumber\") {\r\n            if (data.properties.dataType == 29) {\r\n                // Creates a Scientific Notation render\r\n                return new bizagi.rendering.desktop.numberScientificNotation(searchParams);\r\n            }\r\n            return new bizagi.rendering.desktop.number(searchParams);\r\n        }\r\n\r\n        if (type == \"searchMoney\") {\r\n            return new bizagi.rendering.desktop.money(searchParams);\r\n        }\r\n\r\n        if (type == \"searchDate\") {\r\n            return new bizagi.rendering.desktop.date(searchParams);\r\n        }\r\n\r\n        if (type == \"searchCombo\") {\r\n            return new bizagi.rendering.desktop.combo(searchParams);\r\n        }\r\n\r\n        if (type == \"searchSuggest\") {\r\n            return new bizagi.rendering.desktop.search(searchParams);\r\n        }\r\n\r\n        if (type == \"searchLabel\") {\r\n            return new bizagi.rendering.desktop.label(searchParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Returns the appropiate query render based on the type\r\n    */\r\n    getQueryRender: function (params) {\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var renderParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (type == \"queryText\") {\r\n            var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\r\n\r\n            // Creates one extended render\r\n            if (isExtended) {\r\n                return new bizagi.rendering.desktop.queryExtendedText(renderParams);\r\n            }\r\n\r\n            // Creates one normal text render\r\n            return new bizagi.rendering.desktop.queryText(renderParams);\r\n        }\r\n\r\n        if (type == \"queryBoolean\") {\r\n            var display = data.properties.display || \"option\";\r\n\r\n            // Creates one check render\r\n            if (display == \"check\") {\r\n                return new bizagi.rendering.desktop.queryCheck(renderParams);\r\n            }\r\n\r\n            // Creates one yes-no render\r\n            return new bizagi.rendering.desktop.queryYesNo(renderParams);\r\n        }\r\n\r\n        if (type == \"queryNumber\") {\r\n\r\n            return new bizagi.rendering.desktop.queryNumber(renderParams);\r\n        }\r\n\r\n        if (type == \"queryMoney\") {\r\n            return new bizagi.rendering.desktop.queryMoney(renderParams);\r\n        }\r\n\r\n        if (type == \"queryDate\") {\r\n            return new bizagi.rendering.desktop.queryDate(renderParams);\r\n        }\r\n\r\n        if (type == \"queryCombo\") {\r\n            return new bizagi.rendering.desktop.queryCombo(renderParams);\r\n        }\r\n\r\n        if (type == \"queryCascadingCombo\") {\r\n            return new bizagi.rendering.desktop.queryCascadingCombo(renderParams);\r\n        }\r\n\r\n        if (type == \"querySuggest\") {\r\n            return new bizagi.rendering.desktop.querySuggest(renderParams);\r\n        }\r\n\r\n        if (type == \"queryLabel\") {\r\n            return new bizagi.rendering.desktop.queryLabel(renderParams);\r\n        }\r\n\r\n        if (type == \"queryList\") {\r\n            return new bizagi.rendering.desktop.queryList(renderParams);\r\n        }\r\n\r\n        if (type == \"queryMultiSelect\") {\r\n            return new bizagi.rendering.desktop.queryMultiSelect(renderParams);\r\n        }\r\n\r\n        if (type == \"querySearch\") {\r\n            return new bizagi.rendering.desktop.querySearch(renderParams);\r\n        }\r\n\r\n        if (type == \"queryRadio\") {\r\n            return new bizagi.rendering.desktop.queryRadio(renderParams);\r\n        }\r\n\r\n        if (type == \"queryState\") {\r\n            return new bizagi.rendering.desktop.queryState(renderParams);\r\n        }\r\n\r\n        if (type == \"queryCaseState\") {\r\n            return new bizagi.rendering.desktop.queryCaseState(renderParams);\r\n        }\r\n\r\n        if (type == \"queryProcess\") {\r\n            return new bizagi.rendering.desktop.queryProcess(renderParams);\r\n        }\r\n\r\n        if (type == \"querySearchUser\") {\r\n            return new bizagi.rendering.desktop.querySearchUser(renderParams);\r\n        }\r\n\r\n        if (type == \"queryHidden\") {\r\n            return new bizagi.rendering.desktop.hidden(renderParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Returns the appropiate search render based on the type\r\n    */\r\n    getRangeRender: function (params) {\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var renderParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (type === \"rangeDate\") {\r\n            return new bizagi.rendering.desktop.rangeDate(renderParams);\r\n        }\r\n\r\n        if (type === \"rangeMoney\") {\r\n            return new bizagi.rendering.desktop.rangeMoney(renderParams);\r\n        }\r\n\r\n        if (type === \"rangeNumber\") {\r\n            return new bizagi.rendering.desktop.rangeNumber(renderParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    }\r\n\r\n});\r\n"]}