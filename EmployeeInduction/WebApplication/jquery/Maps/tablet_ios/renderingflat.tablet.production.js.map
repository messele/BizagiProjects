{"version":3,"sources":["jquery/common/bizagi.grid/js/bizagi.grid.js","jquery/common/bizagi.grid/js/tablet/bizagi.grid.tablet.js","jquery/common/bizagi/js/bizagi.util.js","jquery/renderingflat/js/common/bizagi.rendering.util.js","jquery/rendering/js/plugins/common/jquery.mask.js","jquery/rendering/js/plugins/common/jquery.numeric.js","jquery/rendering/js/plugins/common/jquery.formatCurrency.js","jquery/common/base/js/lib/mobile/jquery.timeago.js","jquery/common/base/js/lib/mobile/jquery.tabs.js","jquery/common/base/js/lib/mobile/jquery.helptext.js","jquery/rendering/js/services/bizagi.render.services.endPoints.js","jquery/rendering/js/services/bizagi.render.services.context.js","jquery/rendering/js/services/bizagi.render.services.service.js","jquery/rendering/js/services/bizagi.render.services.multiactionservice.js","jquery/rendering/js/services/bizagi.render.services.metadataMultiactionservice.js","jquery/rendering/js/base/command/bizagi.command.controllers.controller.js","jquery/rendering/js/base/command/bizagi.command.controllers.validation.js","jquery/rendering/js/base/command/bizagi.command.controllers.action.js","jquery/renderingflat/js/base/command/bizagi.command.controllers.action.js","jquery/rendering/js/base/bizagi.rendering.element.js","jquery/rendering/js/base/container/bizagi.rendering.container.js","jquery/renderingflat/js/tablet/container/bizagi.rendering.tablet.container.js","jquery/rendering/js/base/render/bizagi.rendering.render.js","jquery/rendering/js/base/render/bizagi.rendering.render.base.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.render.js","jquery/rendering/js/base/container/bizagi.rendering.form.js","jquery/rendering/js/base/container/bizagi.rendering.formTemplate.js","jquery/rendering/js/base/container/bizagi.rendering.layout.js","jquery/rendering/js/base/container/bizagi.rendering.accordion.js","jquery/rendering/js/base/container/bizagi.rendering.accordionItem.js","jquery/rendering/js/base/render/bizagi.rendering.collectionnavigator.js","jquery/rendering/js/base/container/bizagi.rendering.group.js","jquery/rendering/js/base/container/bizagi.rendering.horizontal.js","jquery/rendering/js/base/container/bizagi.rendering.panel.js","jquery/rendering/js/base/container/bizagi.rendering.contentPanel.js","jquery/rendering/js/base/container/bizagi.rendering.searchForm.js","jquery/rendering/js/base/container/bizagi.rendering.tab.js","jquery/rendering/js/base/container/bizagi.rendering.tabItem.js","jquery/rendering/js/base/container/bizagi.rendering.nestedForm.js","jquery/rendering/js/base/render/bizagi.rendering.actionLauncher.js","jquery/rendering/js/base/render/bizagi.rendering.entityTemplate.js","jquery/rendering/js/base/render/bizagi.rendering.polymorphicLauncher.js","jquery/rendering/js/base/render/bizagi.rendering.combo.js","jquery/rendering/js/base/render/bizagi.rendering.check.js","jquery/rendering/js/base/render/bizagi.rendering.number.js","jquery/rendering/js/base/render/bizagi.rendering.numberScientificNotation.js","jquery/rendering/js/base/render/bizagi.rendering.date.js","jquery/rendering/js/base/render/bizagi.rendering.extendedText.js","jquery/rendering/js/base/render/bizagi.rendering.grid.js","jquery/rendering/js/base/render/bizagi.rendering.hidden.js","jquery/rendering/js/base/render/bizagi.rendering.label.js","jquery/rendering/js/base/render/bizagi.rendering.search.js","jquery/rendering/js/base/render/bizagi.rendering.text.js","jquery/rendering/js/base/render/bizagi.rendering.button.js","jquery/rendering/js/base/render/bizagi.rendering.fileprint.js","jquery/rendering/js/base/render/bizagi.rendering.link.js","jquery/rendering/js/base/render/bizagi.rendering.checkList.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.render.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.image.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.link.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.label.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.text.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.upload.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.boolean.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.dateTime.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.number.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.money.js","jquery/rendering/js/base/render/layout/bizagi.rendering.layout.placeholder.js","jquery/rendering/js/base/render/bizagi.rendering.geolocation.js","jquery/rendering/js/base/render/bizagi.rendering.association.js","jquery/rendering/js/base/render/bizagi.rendering.upload.js","jquery/rendering/js/base/render/bizagi.rendering.ecm.js","jquery/rendering/js/base/render/bizagi.rendering.yesno.js","jquery/rendering/js/base/render/bizagi.rendering.letter.js","jquery/rendering/js/base/render/bizagi.rendering.formLink.js","jquery/rendering/js/base/render/bizagi.rendering.document.js","jquery/rendering/js/base/render/bizagi.rendering.cascadingCombo.js","jquery/rendering/js/base/render/bizagi.rendering.list.js","jquery/rendering/js/base/render/bizagi.rendering.multiSelect.js","jquery/rendering/js/base/render/bizagi.rendering.searchList.js","jquery/rendering/js/base/render/bizagi.rendering.money.js","jquery/rendering/js/base/render/bizagi.rendering.radio.js","jquery/rendering/js/base/render/bizagi.rendering.userfield.js","jquery/rendering/js/base/render/bizagi.rendering.image.js","jquery/rendering/js/base/render/column/bizagi.rendering.columns.column.js","jquery/rendering/js/base/render/column/bizagi.rendering.columns.readonly.js","jquery/rendering/js/base/render/column/bizagi.rendering.columns.combo.js","jquery/rendering/js/base/render/column/bizagi.rendering.columns.date.js","jquery/rendering/js/base/render/column/bizagi.rendering.columns.search.js","jquery/rendering/js/base/render/bizagi.rendering.range.js","jquery/rendering/js/base/render/bizagi.rendering.rangeDate.js","jquery/rendering/js/base/render/bizagi.rendering.rangeMoney.js","jquery/rendering/js/base/render/bizagi.rendering.rangeNumber.js","jquery/renderingflat/js/tablet/container/slide/bizagi.rendering.tablet.slide.form.js","jquery/renderingflat/js/tablet/container/slide/bizagi.rendering.tablet.slide.view.js","jquery/renderingflat/js/tablet/container/slide/bizagi.rendering.tablet.slide.view.grid.js","jquery/renderingflat/js/tablet/container/slide/bizagi.rendering.tablet.slide.view.upload.js","jquery/renderingflat/js/tablet/container/slide/bizagi.rendering.tablet.slide.view.search.js","jquery/renderingflat/js/tablet/container/slide/bizagi.rendering.tablet.slide.startForm.js","jquery/renderingflat/js/tablet/container/bizagi.rendering.tablet.form.js","jquery/renderingflat/js/tablet/container/bizagi.rendering.tablet.panel.js","jquery/renderingflat/js/tablet/container/bizagi.rendering.tablet.tab.js","jquery/renderingflat/js/tablet/container/bizagi.rendering.tablet.tabItem.js","jquery/renderingflat/js/tablet/container/bizagi.rendering.tablet.horizontal.js","jquery/renderingflat/js/tablet/container/bizagi.rendering.tablet.accordion.js","jquery/renderingflat/js/tablet/container/bizagi.rendering.tablet.accordionItem.js","jquery/renderingflat/js/tablet/container/bizagi.rendering.tablet.group.js","jquery/renderingflat/js/tablet/container/bizagi.rendering.tablet.searchForm.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.polymorphicLauncher.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.actionLauncher.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.entityTemplate.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.text.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.extendedText.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.label.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.number.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.numberScientificNotation.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.date.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.yesno.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.check.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.combo.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.upload.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.upload.offline.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.grid.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.grid.offline.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.search.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.letter.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.button.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.fileprint.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.link.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.checkList.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.activityCheckList.js","jquery/renderingflat/js/tablet/render/layout/bizagi.rendering.tablet.layout.image.js","jquery/renderingflat/js/tablet/render/layout/bizagi.rendering.tablet.layout.link.js","jquery/renderingflat/js/tablet/render/layout/bizagi.rendering.tablet.layout.label.js","jquery/renderingflat/js/tablet/render/layout/bizagi.rendering.tablet.layout.text.js","jquery/renderingflat/js/tablet/render/layout/bizagi.rendering.tablet.layout.dateTime.js","jquery/renderingflat/js/tablet/render/layout/bizagi.rendering.tablet.layout.number.js","jquery/renderingflat/js/tablet/render/layout/bizagi.rendering.tablet.layout.money.js","jquery/renderingflat/js/tablet/render/layout/bizagi.rendering.tablet.layout.upload.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.formLink.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.hidden.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.money.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.radio.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.cascadingCombo.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.list.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.multiSelect.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.association.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.ecm.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.searchList.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.userfield.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.image.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.image.native.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.document.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.rangeDate.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.rangeMoney.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.rangeNumber.js","jquery/renderingflat/js/tablet/render/bizagi.rendering.tablet.geolocation.js","jquery/renderingflat/js/tablet/render/column/bizagi.rendering.tablet.columns.column.js","jquery/renderingflat/js/tablet/render/column/bizagi.rendering.tablet.columns.combo.js","jquery/renderingflat/js/tablet/render/column/bizagi.rendering.tablet.columns.document.js","jquery/renderingflat/js/tablet/render/column/bizagi.rendering.tablet.columns.date.js","jquery/renderingflat/js/tablet/render/column/bizagi.rendering.tablet.columns.text.js","jquery/renderingflat/js/tablet/render/column/bizagi.rendering.tablet.columns.number.js","jquery/renderingflat/js/tablet/render/column/bizagi.rendering.tablet.columns.numberScientificNotation.js","jquery/renderingflat/js/tablet/render/column/bizagi.rendering.tablet.columns.image.js","jquery/renderingflat/js/tablet/render/column/bizagi.rendering.tablet.columns.upload.js","jquery/renderingflat/js/tablet/render/column/bizagi.rendering.tablet.columns.link.js","jquery/renderingflat/js/tablet/render/column/bizagi.rendering.tablet.columns.uploadecm.js","jquery/renderingflat/js/tablet/render/column/bizagi.rendering.tablet.columns.button.js","jquery/renderingflat/js/tablet/render/column/bizagi.rendering.tablet.columns.radio.js","jquery/renderingflat/js/tablet/render/column/bizagi.rendering.tablet.columns.list.js","jquery/renderingflat/js/tablet/render/column/bizagi.rendering.tablet.columns.search.js","jquery/renderingflat/js/tablet/render/column/bizagi.rendering.tablet.columns.exclusiveCheck.js","jquery/rendering/js/base/bizagi.rendering.base.factory.js","jquery/renderingflat/js/tablet/bizagi.rendering.tablet.factory.js","jquery/rendering/js/bizagi.rendering.device.factory.js","jquery/rendering/js/bizagi.rendering.facade.js"],"names":["$","widget","options","id","columns","sortBy","sortType","showSummary","collapse","collapseState","data","indexedData","maxColumns","buttonsPst","title","tableCssClass","headerStyles","floatingHeader","template","grid","waiting","table","emptyTable","column","specialColumn","row","rowButtons","cell","specialCell","pager","buttons","dynamicPager","summary","summaryCell","actions","add","edit","remove","details","allowMore","enableXlsExport","enablePdfExport","mode","_init","self","this","element","page","changes","totalRows","totalPages","selectedRow","components","asyncCells","scrollableArea","columnByIndex","columnByName","columnKeyIndex","each","i","key","label","name","tooltip","index","split","addClass","attr","calculateKeyIndex","startLoading","bUseTimeout","waitingFn","waitingTimeout","append","fasttmpl","setTimeout","endLoading","clearTimeout","empty","setData","refresh","getData","rows","j","getChanges","_cleanComponents","_cleanButtons","draw","refreshSummary","columnIndex","_getComponent","drawing","refreshSummaryCell","drawSummary","postRenderSummary","getCell","cells","is","children","find","html","drawSummaryCell","replaceWith","onCellReady","changeCellValue","value","deleteCellExclusiveValues","orientation","gridRtl","isDesign","drawTable","appendTo","postRender","attachPaginator","attachHandlers","$tableContainer","$table","offset","parseInt","css","replace","stickyTableHeaders","fixedOffset","zIndex","cacheHeaderHeight","bind","trigger","length","hide","_getButton","show","_replaceElement","drawHeader","drawBody","drawPager","drawButtons","drawGridExportOptions","drawRowButtons","drawDynamicPager","isExactMatch","exactMatch","drawColumn","_canShowButtons","drawSpecialColumn","columnProperties","bizAgiProperties","cssClass","cssclass","header","columntitlealign","extend","isKey","sortActive","sortOrder","columnCssClass","headerLabelStyles","drawRow","rowData","isNewRow","newRow","rnd","Math","floor","random","businessKey","drawCell","_canShowRowButtons","drawSpecialCell","cellAlign","columnAlign","hidden","summarizeBy","result","onDrawCell","calculateSummary","undefined","done","state","resolveResult","messageValidation","promise","drawGroupHeader","drawFooter","pages","total","push","number","active","records","tooltips","parameters","buttonsRtl","exportOptions","rtl","postRenderRow","_triggerHandler","asyncResult","when","selectDynamicPager","onDynamicPager","changePage","currentPage","Number","newPage","onPageRequested","isValid","type","indexOf","sortAttribute","sortColumn","onSortRequested","selectRow","onRowUnselected","selectedBusinessKey","onRowSelected","unselectRow","operation","defaultvalue","columnValues","map","max","min","columnValue","Array","processAction","action","params","onEditRow","onDeleteRow","onShowMore","onShowDetails","onAddRow","onShowExportGridOptions","_buildRefreshParameters","onCollapseGrid","onDrawControl","onDrawGroupHeader","sortColumnIndex","callback","call","component","foundComponent","button","jQuery","ui","bizagi_grid","_super","isOfflineForm","bizagi","util","parseBoolean","pageNumber","totalizer","on","evt","$context","target","parents","hasClass","onRemoveNewRow","closest","stopPropagation","_addColumnActions","totalData","prototype","apply","arguments","_showRowButtons","_hideRowButtons","xpath","pagination","renderPages","window","document","removeClass","getNewRowKeys","onSaveAddedRows","onCancelEdition","isNewRecord","addInlineRow","createAddRowData","ceil","inlineAdd","savedRows","detach","keys","newRowKeys","items","localization","getResource","fn","e","overflowMenu","cancelNewRow","newRows","RegExp","context","smartphone","tablet","DEVICES","printf","msg","arg","args","slice","a","val","shift","charCodeAt","round","String","bizagiQueue","queue","callbacks","addParallel","execute","starter","Deferred","queueLength","pipe","deferred","resolve","fail","deviceEnum","callInside","fx","tagName","toLowerCase","contentWindow","browser","msie","execScript","toString","webkit","mozilla","eval","callInsidePopup","ready","CSSStyleDeclaration","getPropertyValue","getAttribute","setProperty","styleName","priority","setAttribute","rule","escape","cssText","removeProperty","removeAttribute","getPropertyPriority","test","text","style","get","nl2br","br2nl","controlValueIsChanged","control","properties","getValue","compareValue","originalValue","forceCollectData","includes","Date","getTime","getMaxZindex","elm","maxZindex","zindex","equalizeHeights","selector","heights","outerHeight","autoSave","deferredSave","detectDevice","_data","anonymizedUserInformation","username","email","domain","picture","isAnonymized","datepickerResource","closeText","prevText","nextText","currentText","monthNames","monthNamesShort","dayNames","dayNamesShort","dayNamesMin","weekHeader","dateFormat","firstDay","isRTL","showMonthAfterYear","yearSuffix","liveProcessesEvents","newLiveProcess","createEvent","initEvent","routeEvents","route","saveEvent","lastWidget","nextWidget","liveSave","widgetName","deferredLiveSave","indeX","location","href","workportal","widgets","BIZAGI_WORKPORTAL_WIDGET_PROFLY","saveLivePromise","dispatchEvent","md5","message","CryptoJS","s","p","m","l","lib","n","r","Base","b","h","mixIn","hasOwnProperty","init","$super","create","clone","q","WordArray","words","sigBytes","t","stringify","concat","clamp","g","v","enc","Hex","k","join","parse","substr","Latin1","fromCharCode","u","Utf8","decodeURIComponent","Error","unescape","encodeURIComponent","BufferedBlockAlgorithm","reset","_nDataBytes","_append","_process","blockSize","_minBufferSize","_doProcessBlock","splice","Hasher","cfg","_doReset","update","finalize","_doFinalize","_createHelper","_createHmacHelper","HMAC","algo","abs","sin","MD5","_hash","w","f","x","y","z","A","B","C","D","c","d","HmacMD5","multiReplace","mapDataToReplace","reg","replaceAll","pcFrom","pcTo","replaceAllGlobalRegExp","temp","re","capitalize","charAt","toUpperCase","startsWith","str","getInitials","initials","sign","isNaN","obj","JSON","encode","measureString","string","fontSize","width","trim","endsWith","suffix","isIE7","isIE","documentMode","isIE8","isIE9","isIE10","isIE11","navigator","userAgent","match","isIE11OrLower","isIE10OrLower","isEdge","appName","getIEVersion","sAgent","indexMSIE","version","substring","isChrome","vendor","isFirefox","minVersion","ua","M","tem","exec","appVersion","getBrowser","bw","emptyNavigatorInfo","info","language","setIphoneXOverrides","isNativePluginSupported","bizagiapp","isIphoneX","isiOSDevice","isString","Object","isObject","isArray","isNull","isBoolean","getInternetExplorerVersion","isNumeric","parseFloat","isFinite","isGUID","mustImplement","notImplementedMethod","console","log","exe","encodeXpath","isEmpty","isEmptyObject","isEmptyCombo","object","property","other","decodeURI","infinityControl","finishDecoded","decodedValue","hasNonVisibleChars","ch","percent2Number","isObjectEmpty","isMapEmpty","replaceSelector","container","elementToReplace","unwrap","hasScroll","el","direction","identicalObjects","obj1","obj2","countProps","count","isScrolledIntoView","elem","layout","scrollTop","elemTop","top","height","centerElementIntoScroll","actualScroll","elementTop","elementHeight","newTop","encodeHtml","decodeHtmlEntities","getHashParams","hash","loadFile","defer","url","src","loader","then","initWebpart","webpart","device","initialized","initializing","loadingDeferred","getQueryString","pairs","pos","argname","extendQueryString","additionalParams","plainUrl","existingParams","newParams","param","getStackTrace","callstack","isCallstackPopulated","dont","exist","stack","lines","len","opera","entry","currentFunction","callee","caller","fname","highLightElement","autoScrollBottom","elScrollHeight","scrollHeight","autoScrollInterval","autoScroll","itemScroll","limitTop","limitBottom","idInterval","outSide","clearInterval","mousemove","event","pageY","autoScrollTopInterval","autoScrollBottomInterval","classCSS","setInterval","valueMaxScrollBottom","innerHeight","removeAutoScroll","unbind","getMaxZIndex","showPopup","callbackFn","left","newWindow","open","BAPopupWindow","BAPopupCallback","BACloseWindow","controls","submitForm","close","showQuirksModePopup","quirksModePage","BIZAGI_PATH_TO_BASE","BAQuirksPopupWindow","windowParams","popupWindow","quirksOnLoad","loadedBody","iframe","afterLoad","userParams","callbackParams","loadingFunction","body","createPopup","popupName","onClose","popupTitle","overlay","popup","closeButton","popupContent","additionalClass","center","closeHandler","click","fullPopup","content","createOkCancelPopup","onOk","onCancel","buttonsContainer","buttonOk","buttonCancel","okHandler","cancelHandler","ok","cancel","dialog","modal","closeQuirksModePopup","quirksPopup","getStyle","pathName","getFontFace","getAllChildrens","matchStyles","stringCss","awesomeBrowser","file","styleSheets","rules","cssRules","BIZAGI_ENVIRONMENT","cssTextOriginal","selectorText","lastLevel","styleSheet","suckBrowser","cookie","expires","days","setDate","getDate","raw","toUTCString","path","secure","decode","randomNumber","setContext","reloadCSS","queryString","_name","_call","_params","_singleton","singleton","_timeOut","timeout","_maxIterations","iterations","_context","_killWhenExitContext","killWhenExitContext","timeOut","maxIterations","itsRunning","timeInit","executeTimeOut","now","actualIterations","ieFunction","pointer","timeOutRunning","isDate","dateField","timeField","resultDate","hasTime","resultTime","arrayDate","unicode2htmlencode","input","htmlHex","getHeadElement","hd","getElementsByTagName","docEl","documentElement","createElement","insertBefore","firstChild","loadStyle","styleText","layoutGuid","node","getElementById","createTextNode","childNodes","nodeValue","replaceChild","appendChild","loadIconStyle","icon","userfieldname","innerHTML","formatDecimalAndMoneyCell","tableData","externalMoneyFormat","moneyFormat","decimalFormat","externalDecimalFormat","decimalSymbol","decimalSeparator","digitGroupSymbol","groupSeparator","roundToDecimalPlace","decimalDigits","symbol","colorize","groupDigits","negativeFormat","positiveFormat","columnTitle","fields","formatMoney","numberValue","formatDecimal","override","removeTrailingZeros","positive","BIZAGI_DEFAULT_CURRENCY_INFO","formatBoolean","formatInvariantBoolean","htmlContent","not","$element","format","formatCurrency","formatMonetaryCells","tmpResult","intSection","decimalSection","decimalResult","isNegative","decimalDigitPosition","fixDecimalDigits","getOnlyNumbersByString","stringValue","toFixed","formatInvariantMoney","defaultFormat","allowDecimals","formatInvariantNumber","numberFormat","thousands","containsLetter","NaN","formatNumber","percentage","formatInvariantDate","dateTimeFormat","isValidDate","getFormatDate","formatDate","dateFormatter","formatDateFromInvariantStringDate","stringInvariantDate","dateValue","defaultFormatDate","H","getHours","getMinutes","getSeconds","ms","getMilliseconds","formatValueByDataType","dataType","replaceLineBreak","formatMonetaryCell","formatDecimalCell","parseDate","valueOf","LZ","getDateFromFormat","getRelativeTime","date","onlyUnitsTime","time","kendo","diff","timeDiff","getTimeDiffDescription","unit","timeDivisor","unitAmount","resourceAgo","compareDates","date1","dateformat1","date2","dateformat2","d1","d2","getDifferenceBetweenDates","i18n","token","i_format","getFullYear","getMonth","E","getDay","isValidResource","months","i_val","year","getYear","month","hh","mm","ss","ampm","_getInt","month_name","day_name","ff","_isInteger","_val","minlength","maxlength","_token","preferEuro","generalFormats","monthFirst","dateFirst","checkList","analyzeTimeFormat","timeFormat","returnObj","show24Hours","showSeconds","separator","lastToken","getDateFromInvariant","showTime","INVARIANT_FORMAT","setHours","formatInvariant","getDateFromISO","ISO_FORMAT","formatISO","formatISO8601","dateObject","restartTimeToMidnight","isFormatISO8601","stringDate","sleep","delay","start","getDateFormatByDatePickerJqueryUI","browserSupportLocalStorage","setItemLocalStorage","localStorage","setItem","getItemLocalStorage","getItem","removeItemLocalStorage","removeItem","clearLocalStorage","clear","bizagiConfig","showConsoleLog","stopLoading","elementToapply","isEventSupported","eventName","isSupported","needsFallback","circularDependencies","Function","list","lastNodeAdded","addNode","OBJ","foundObjChildNode","_search","_addNode","nodeObj","timeStamp","addChild","resolved","seen","_getFirstNodeWithChilds","_resolve","childs","hasObject","error","dependencyFrom","dependencyFromObj","dependencyTo","dependencyToObj","standardError","status","responseText","makeErrorMessage","multiactionError","toSearch","collection","messageTmpl","cssExtended","instance","cssToAdd","cssExtendedApplyChanges","option","$this","attrToAdd","tmpStyle","arrProperties","resultProperties","cssProperty","canvas","parent","sortJSON","way","sort","shortNumber","newNumber","lenghtNumber","escapeHtml","div","showNotification","div_sync","fadeIn","stop","fadeOut","isModeOnline","dispose","arrayEach","array","getStandardNotation","tmp","decimalNumber","exponentialNumber","scientificNotationFormat","sdLimit","expMinLimit","expMaxLimit","sNregex","sNFormat","exp","prefix","originalPointIndex","tempParts","significantDigits","intPart","from","to","significantFlag","firstDigit","restDigits","stripslashes","isHTMLValidText","resetData","sessionStorage","isAuthenticate","changeData","isMobileDevice","isTabletDevice","isAndroidTabletDevice","isiOSTabletDevice","isSmartphoneDevice","isAndroidSmartphoneDevice","isiOSSmartphoneDevice","formContainer","getFormContainer","formParams","getParams","detectAndroidVersion","indexAndroid","androidVersion","getPathUrl","solvedUrl","locationParts","pathname","basePath","protocol","host","pathToBaseBackwards","getAndroidVersion","mobileImagePath","image","dataImage","photoSplit","resource","b64toBlob","b64Data","contentType","sliceSize","byteCharacters","atob","byteArrays","byteNumbers","byteArray","Uint8Array","Blob","stringToByteArray","hasOfflineFormsEnabled","BIZAGI_ENABLE_OFFLINE_FORMS","isFlatDesignEnabled","BIZAGI_ENABLE_FLAT","isMobileGridEnabled","BIZAGI_ENABLE_MOBILE_GRID","isNativeHeaderEnabled","NATIVE_HEADER_ENABLE","isQuickSearchEnabled","BIZAGI_ENABLE_QUICK_SEARCH","isOAuth2Enabled","BIZAGI_AUTH_TYPE","getNativeComponent","BIZAGI_NATIVE_COMPONENT","isVersionSupported","supported","BIZAGI_SERVER_VERSION","isCordovaSupported","isTabletNativeSupported","isSmartphoneNativeSupported","cordova","plugins","Keyboard","hideKeyboardAccessoryBar","detectRealDevice","settedDevice","BIZAGI_DEFAULT_DEVICE","isAndroid","isAndroidDevice","getChannelType","BIZAGI_SERVER_CHANNEL","channel","isDataUrl","getDataUrl","currentUrl","tempUrl","processFailMessage","tmp_block_header","disableWorkPortalMenu","blockHeight","prependTo","position","background","opacity","z-index","enableWorkPortalMenu","downloadFile","completeuRL","ulrToDownload","arrayURL","executeActionRoutingFromWorkportal","idCase","idWorkItem","controllers","menu","publish","BIZAGI_WORKPORTAL_ACTION_ROUTING","getMessageFromNetworkState","sanitizeHTML","textContent","arrayUnique","debounce","func","wait","immediate","callNow","isNativeImageEditorSupported","enableImageEditor","errorMessage","validateUrlWellFormed","decodedDisplayValue","valueToDisplay","setCaretPosition","ctrl","setSelectionRange","focus","createTextRange","range","moveEnd","moveStart","select","getCaretPosition","oField","iCaretPos","selection","oSel","createRange","selectionStart","escapeRegex","getFeatureObject","arr","featureObjectCache","features","getConfigFeatures","pivot","getFeatureObjectIte","bizagiConfiguration","BIZAGI_MOBILE_FEATURES","resetConfigFeatures","isFailResponse","code","formatItem","highlightMatches","item","term","parseValue","regEx","getDesktopResolution","resolution","devicePixelRatio","screenWidth","screen","screenHeight","deviceXDPI","logicalXDPI","getDeviceCode","BIZAGI_DEVICE_MARKET_NAME","normalizeType","hideOrShowXToCloseDialog","isEnableFeature","feature","ps","parentNode","prop","getComputedStyle","scroll","scrollerParent","HTMLElement","SVGElement","scrollingElement","startkendo","kendoMobileApplication","mobile","Application","skin","browserHistory","progress","started","bizagiNavigate","navigate","isSharepointContext","BIZAGI_SHAREPOINT_CONTEXT","isEmptyValue","guid","scenarioInfo","getFileScenario","category","scenario","BIZAGI_SMARTPHONE_PATH","b64EncodeUnicode","btoa","p1","pasteEventName","caret","begin","end","mask","placeholder","_prepareBuffer","_bindEvents","_checkVal","allowPartials","destroy","removeData","res","buffer","tests","formatted","_setData","eventsBound","_escapeMask","defs","definitions","partialPosition","firstNonMaskPos","maskEscaped","ignore","focusText","_writeBuffer","change","keyCode","SHIFT","SPACE","BACKSPACE","DELETE","_clearBuffer","_shiftL","ESCAPE","charCode","which","ctrlKey","altKey","metaKey","_seekNext","_shiftR","next","completed","originalPos","allow","lastMatch","literals","replacements","getter","defaults","#","*","selectionEnd","duplicate","numeric","decimal","keypress","nodeName","shiftKey","blur","numericSN","getRegionOrCulture","region","regionInfo","regions","culture","generateRegex","settings","destination","global","eventOnDecimalsEntered","regex","num","multiCeroPattern","search","numParts","isPositive","hasDecimals","decimals","originalDecimals","money","$destination","toNumber","method","asNumber","parseType","validateParseType","timeago","timestamp","$t","refreshMillis","allowFuture","localeTitle","cutoff","strings","prefixAgo","prefixFromNow","suffixAgo","suffixFromNow","seconds","minute","minutes","hour","hours","day","years","wordSeparator","numbers","inWords","datetime","distanceMillis","$l","substitute","stringOrFunction","isFunction","iso8601","isTime","bztabs","activeTab","tabNumber","activate","popUp","beforeActivate","tabCountPopup","tabHeader","tabCountReal","widthRow","prepend","tabCurrent","eq","widthTabSelected","updateTabSize","first","origin","changeTab","preventDefault","dataRef","tempTabs","moveAtTheEnd","currentTarget","tabChildren","toggle","domIncluded","headerWidth","innerWidth","totalWidth","outerWidth","pop","last","helpText","dir","useWithBlock","$html","render","services","endPoints","getEndPoints","renderHandlerPathRest","renderUploadHandlerPathRest","renderFileHandlerPathRest","letterHandlerPathRest","multiActionHandlerPathRest","metadataHandlerPathRest","form-get-data","proxyPrefix","form-submit-data","form-submit-data-upload","render-property-refresh","render-multiaction","render-upload-cancel-image","render-upload-data-url","render-upload-add-url","render-upload-delete-url","render-ecm-upload-url","render-multiaction-metadata","render-grid-edit-url","render-grid-save-url","render-grid-add-url","render-grid-rollback-url","render-grid-commit-url","render-grid-checkpoint-url","render-save-entity","render-stakeholder-associated","render-search-default-image","render-search-form-get-data","render-search-advanced-url","render-letter-notEditable-url","render-letter-content-url","render-letter-save-url","render-letter-content-icons","render-userfield-definition","render-document-generate","render-document-generateAllDocuments","render-processes-startform","render-processes-getstartform","render-entity-layout-image64","render-entity-layout-imageByteArray","getXSRFToken","render-entity-layout-upload-files","case-handler-getCaseSummary","case-handler-getCaseSummaryByGuid","case-handler-getCaseAssignees","case-handler-getWorkItems","case-handler-getWorkItemsByGuid","admin-getUsersList","admin-getUsersList-FromPreferences","admin-getUsersList-ForStakeholders","admin-getUsersForAssignation","admin-users-config","admin-usersform","admin-GenerateDataToSendByEmail","admin-sendUserEmail","alert","sharepointProxyPrefix","Class","getUrl","service","setProxyPrefix","BA_ACTION_PARAMETER_PREFIX","BA_CONTEXT_PARAMETER_PREFIX","BA_PAGE_CACHE","serviceLocator","multiactionService","multiactionservice","enableECMMetadataMultiaction","multiactionMetadataService","metadatamultiactionservice","userfieldRequests","deviceType","desktop","deviceCode","multiaction","metadataECMMultiaction","getFormData","idProcess","idForm","idEntity","surrogateKey","idRender","xpathContext","requestedForm","recordXPath","summaryForm","idWorkitem","idTask","idPageCache","contextType","guidEntity","isRefresh","isActionStartForm","additionalXpaths","idStartScope","readOnlyForm","printversion","recordXpath","downloadOfflineForm","editable","BA_ALL_PARAMETER_PREFIX","prepare","chrono","initAndStart","ajax","serviceType","response","stopAndLog","form","transformGridDataToReadOnly","allowAdd","allowDelete","allowEdit","allowGrouping","allowSearch","getSearchFormData","idSearchForm","processDataValues","o","submitData","resolveData","contexttype","transitions","surrogatekey","forcePlanCompletion","actionType","debug","newName","getPropertyData","extra","sessionId","guidentity","pxpath","prows","ppage","pfilter","psort","porder","pcaseId","pguidEntity","psurrogatedKey","pactionXpath","ptemplateGuid","pparameters","beforeSend","xhr","multiactionConnection","getSearchData","getCollapseData","getGridData","order","searchFilter","getGridDataExclusivesSelected","xpathfilter","getUploadCancelImage","pathToBase","getUploadFileUrl","fileId","verifyPathToBase","getUploadFileEntityUrl","isContextContainerWidgetRender","xpathActions","getUploadAddUrl","getUploadAddFileUrl","isUserPreferences","deleteImage","deleteUploadFile","getECMMetadata","idFileUpload","xPath","idAttrib","interceptor","intercept","source","checkOutFile","cancelCheckOut","deleteECMFile","updateECMFileContent","metaValues","updateECMMetadata","getFileProperties","uploadECMFile","fileUpload","fileName","getECMFileUrl","p_sessionId","isFileOnECM","idUpload","read","editGridRecord","addGridRecord","addGridRecordData","saveGridRecord","disableServerGridValidations","deleteGridRecord","getFlipAssociation","flipstate","parseJSON","rollbackGridAction","getSearchDefaultImage","processDataCriteria","criteria","submitSearch","allowFullSearch","maxRecords","associateStakeholder","associatedUser","refreshAssociateStakeholder","getLetterNotEditableUrl","getLetterContent","getCanGenerateLetter","saveLetterContent","fullUrl","getLetterEditorIconsPath","executeButton","getFilePrintUrl","disposition","editLinkForm","saveLinkForm","rollbackLinkForm","commitLinkForm","commitGridAction","sendCheckpoint","sendCheckpointAction","getUserfieldDefinition","userfield","guidUserfield","refreshControl","refreshGridCell","typeRender","executeRule","executeInterface","interface","executeSAPConnector","guidsap","executeConnector","guidConnector","generateDocumentTemplate","h_pageCacheId","contextXpath","xpathcontext","groupMappingId","groupMapping","xpathAttribute","controlId","getAllDocumentsDownloadUrl","getCaseNumber","isMobile","getCaseAssignees","getWorkitems","onlyUserWorkItems","getGridExportUrl","exportType","sendEmail","subject","selected","invalidatePageCache","getUsersList","getUsersListFromPreferences","getUsersListForStakeholders","getUsersForAssignation","getUsersForm","generateDataToSendByEmail","idUser","password","sendUserEmail","eMailTo","getConfiguration","getTemplate","forcePersonalizedColumns","templateType","templateGuid","isDefaultTemplate","hasStartForm","guidWFClass","getStartForm","guidprocess","surrogatedKey","mappingstakeholders","cache","editActionForm","getActions","extendParams","ptags","pmaxitems","executeActions","pguidConstructor","pguidAction","getPolymorphicActions","serializePolymorphicActions","values","getParents","fillTree","child","displayName","hasConstructor","guidObject","guidConstructor","getEntityImage64","entity","getFilesDataForLayoutUploadControl","processUploadFile","verifyMobilePathToBase","formData","processData","batch","batchTimer","replicateServiceMethods","getService","proxyMethod","makeCircularDependenciesError","h_action","detectCircularDependencies","batchTimeout","tag","singleAction","resolveDependencies","reject","fire","rejectDeferreds","responses","finalResponse","THROW_ERROR","buildConditions","conditions","bGridDetected","bCheckEditability","operator","expressions","buildConditionOperator","sJsCondition","expression","simple","bGDetected","searchGridReferenceInCondition","buildSimpleCondition","complex","conditionsOperator","condition","sXpath","sArgument","ensureValueJs","ensureEditable","renderId","detectedArgumentType","detectConditionArgumentType","argumentType","buildXpath","boolean","argument","buildArgument","getRender","getRenderById","gridXpath","processGridXpath","remainingXpath","getColumn","renderType","isRelatedEntityRender","setSeconds","setMilliseconds","isEditable","showRenderNotFoundError","isVisible","visible","isParentVisible","evalGridXpath","evalXpath","gridColumn","cellValue","getCellCurrentValue","display","renderToEval","renders","getRenders","rendersToEval","bIsGrid","isFileUploaded","isValidEmail","isButtonPressed","pressed","isGridButtonPressed","arrGridXpath","isChanged","grep","onDeletedGridRow","rowDeleted","idMatches","showContainerNotFoundError","containerId","getCurrentDate","currentDate","matches","searchForGridReference","commands","command","searchForGridReferenceInCommand","bGridReferenceFound","searchGridReferenceInXpath","getGridControl","getControlCell","controller","validations","mainForm","enableDebug","validationBox","bizagi_notifications","expand","triggerGlobalHandler","itemIcon","minimized","clearEnabled","onNotificationClick","buildValidations","fnValidations","buildAllValidations","showErrorMessage","showErrorAlertDialog","showValidationMessage","showAlertMessage","showInfoMessage","itemAdditionalClass","performValidationFn","clearValidationMessages","validating","performValidations","countValidationMessages","hideValidationMessages","setValidationMessage","one","showValidationMessages","expandNotificationBox","autofocus","isExpandedNotificationBox","invalidElements","bRendersValid","validateRenders","bFormValid","triggerHandler","sJSCode","enabled","buildValidation","validationCommand","logError","sStatement","evalValidation","sJsValidation","gridReference","tokens","sGridStatement","bValid","forEach","showValidationMessageById","globalDependencies","initialCallFunctions","initialCallFunctionsDeferred","buildActions","internalSubmitActions","initialCallTimeout","initialCallIncrements","actionsHistory","period","processInternalSubmitAction","buildAction","isSummaryOrGlobalForm","typeForm","evalClientAction","serverCommand","elseCommands","isClientAction","dontExecute","hashes","executeOnlyClientActions","hashC","unbindActions","handle","refreshActions","newActions","_","dependencies","dependenciesId","dependencyAlreadyAdded","renderById","inArray","buildFunction","ev","changed","gridColumns","searchGridColumns","sJsAction","sJsElseAction","bAutomaticRestore","bCondition","queueAction","isServerCommand","buildCommand","buildRestoreCommand","elseCommand","commandType","isRecentAction","runAction","detectCommandArgumentType","controlType","ruleObj","guidRule","xpathContextRow","interfaceObj","guidInterface","connectorObj","restoreRender","originalProperties","textFormat","changeRenderBackground","changeRenderForeground","color","changeRenderVisibility","changeRenderEditability","changeRenderRequired","required","restoreContainer","getContainer","changeContainerBackground","backgroundColor","changeContainerVisibility","toogleContainer","changeContainerEditability","isGridComponent","lenIndex","indexes","getIndexes","changeCellBackgroundColor","changeBackgroundColor","changeButtonBackground","getButton","changeCellColor","changeColor","changeButtonForeground","changeCellVisibility","renderingDeferred","changeVisibility","changeButtonVisibility","isValidRender","changeCellEditability","changeEditability","changeButtonEditability","removeAttr","triggerClick","changeCellRequired","changeRequired","changeRenderValue","fromAction","asyncRenderDeferred","setDisplayValue","changeRenderMinValue","changeCellMinValue","changeMinValue","changeRenderMaxValue","changeCellMaxValue","changeMaxValue","executeCalculatedField","runFormula","refreshContainer","def","internalQueue","refreshCell","submitFormData","submitRender","submitOnChange","cleanRenderData","cleanCellData","cleanData","changeActiveItem","setAsActiveContainer","changeFormButtonVisibility","findIndex","navigation","getNavigation","setNavigationButtons","isFloatingButtonsEnabled","changeFloatingButtonVisibility","ELEMENT_TYPE_CONTAINER","ELEMENT_TYPE_RENDER","ELEMENT_TYPE_COLUMN","renderFactory","dataService","resources","observableElement","disposed","initializeData","subscribers","getXpathContext","getPageCache","getElementType","resize","size","effect","eventType","getRenderedElement","getMode","getFormType","isReadyToSave","getCustomHandlers","off","disposeTime","isDisposed","errorType","validationController","beforeToRefresh","afterToRefresh","rendering","TYPE_QUERY_FORM","uniqueId","childrenHash","elements","createRenderElement","createContainerElement","createFormElement","originalElement","inlineEdit","retype","processDuplicateRender","registerRender","getElement","getElementsByType","clonedElement","isClone","cloneRender","internalRender","applyContainerDefaults","renderContainerHtml","postRenderContainer","renderContainer","isRendered","replaceTag","replaceChildrenTag","replaceChildrenHtml","executeChildrenPostRender","configureHandlers","applyPlaceHolderPolyfill","configureDesignView","configureLayoutView","config","placeHolderConfig","forceApply","Placeholders","enable","childrenElements","childElement","postRenderElement","renderChildrenHtml","renderElement","collectRenderValues","renderValues","canBeSent","collectData","hasChanged","collectRenderValuesQueryForm","canBeSentQueryForm","collectDataQueryForm","getRendersByXpath","hasValidGrids","childrenPromises","getFocus","getCustomHandler","customHandlers","unregisterChildren","removeActions","currentContainer","triggerChildrenActions","always","refreshDesignContainer","triggerRenderChange","registerActions","actionController","unregisterRender","getChildById","postRenderTimeout","maxRendersPerScreen","rendersExecuted","renderOptimization","startOptimization","stopOptimization","included","includedInResult","maxLength","valueFormat","isHidden","labelAlign","valueAlign","previousValue","calculateInitialLayoutProperties","displayType","getDefaultLabelAlign","getDefaultValueAlign","getRTLAlign","renderWidth","calculateRenderWidth","labelWidth","valueWidth","layoutType","renderTemplateName","renderTemplate","isFullRender","isExtendedText","isExtended","displayOptionClass","getDisplayOptionClass","labelAlignClass","getAlignClass","valueAlignClass","stringLabelWidth","stringValueWidth","printVersion","showFullRender","internalRenderControl","replaceControlHtml","renderControl","renderReadOnly","configureSubmitOnChange","isLabelFormat","executePostRender","_element","internalPostRender","getControl","emptyControlByAsyncRenderDeferred","processLayout","postRenderPrintVersion","postRenderReadOnly","performExecutionModeMethods","performDesignModeMethods","configureHandlersQueryForm","configureHandlersReadOnly","internalSetInitialValue","internalSetInitialValueFlag","hasValue","isQueryForm","filter","messageData","isQuery","columnEditable","bold","changeFontBold","italic","changeFontItalic","underline","changeFontUnderline","strikethru","changeFontStrikethru","changeFontSize","setValue","triggerEvents","checkRequired","changeRequiredLabel","triggerRenderValidate","validateInputRetype","enableCheck","displayValue","getDisplayValue","getLabel","getControlFiller","validationMessage","readOnlyValue","changeDisplayOption","changeLabelAlign","alignType","changeValueAlign","customizeRenderWidth","getElementsToStylize","originalColor","currentStyle","getFormattingLabel","baseValue","defaultValue","compareValueObj","_findAction","targetObj","guidAction","objectValue","valuestrikethru","valueunderline","newFontSize","emptyControlByChangeEditability","changeEditabilityCellControl","renderColumn","decorated","getDecorated","readyDeferred","onCellChange","labelElement","controlElement","controlFiller","currentElement","refreshDesignControl","clearDisplayValue","updateOriginalValue","queryValue","searchType","typeSearch","rangeQuery","newParameter","orderType","displayXpath","force","displayOnly","defaultControl","innerControl","align","submitOnChangexpathContext","addSubmitAction","bRefreshForm","notCollect","internalSubmitOnChange","getCacheIdCase","idCaseObject","getIdCase","getIdWorkitem","getidTask","getSessionId","backgroundImage","needBGPaint","background-color","background-image","startActionExecution","actionExecutionDeferred","endActionExecution","readyActionExecution","isFromCreatedRow","submitInvalidatePageCacheRequest","pageCacheToInvalidate","isDesignMode","isExecutionMode","preventDefaultForAnchorTag","processLabelLayout","processControlLayout","warm","$label","changeFontColor","changeTextDecoration","$control","$elements","textDecoration","configureHelpText","containerHelp","getContainerHelpText","getRTLDisplayType","containerHelpText","bFirstElement","prev","renderedElement","toggleClass","getFormParams","ele","rendersById","rendersByXpath","rendersByType","pageCacheId","displayAsReadOnly","userConfirmationMessage","hasRule","paramsRender","processPath","breadCrumb","allowValidateAndSaveAction","enableActionValidateAndSave","initializeButtons","originalProcessButton","processButton","isRoutingDisabled","applicationParent","isOfflineFormsV2Supported","caption","ordinal","nextWithoutValidations","back","createnewcase","validate","save","routing","buildButtonStyle","useCustomButtons","unshift","setParam","listRendesByType","getRenderByType","listRendesByTypeLength","renderKey","listRender","getGridByColumn","grids","columnsIds","helptext","queryForm","globalForm","complexGatewayContainer","activeTransitions","processButtons","validation","checkboxLabel","transitionId","strStyle","getContextType","getEndPointAction","formtype","getButtons","stopImmediatePropagation","buttonProperties","lastActionButton","routingDisabled","propagateExternalEvents","processDefer","contains","preProcessButton","postProcessButton","setLoaderDeferred","loaderDeferred","deleteLoaderDeferred","isLoaderDeferredSet","useOrSetLoaderDeferred","getLoaderPromise","appendWaitForLoader","getAllTabs","getAllTabsLength","innerTabsLoading","needsUserConfirmation","showConfirmationBox","customHandler","validateForm","saveForm","collectRenderValuesForSubmit","deferredsToWait","deferreds","internalSubmitFormOffline","internalSubmitForm","checkWidgetsData","isComplexGatewayPainted","getLastActionButton","showMessageBox","offlineType","waitForOnlineResponse","online","tryPushResponsePromise","responsePromise","IdCase","caseNumber","CaseNumber","failHandler","offlineAction","animate","submitDataAction","executeButtonAction","performAction","checkpointAction","commitAction","waitingDeferreds","prepareCheckpointAction","prepareCommitAction","getButtonAction","flowControlDeferred","bHasValidations","alertMessage","propertiesToDisplayMessages","validationToDisplayMessages","messages","modalError","sendRollbackAction","refreshForm","jqxhrList","abortAll","messageType","addValidationMessage","addErrorMessage","selectedTabs","getSelectedTabs","tabContainers","tabs","tabContainer","tab","waitingTemplate","waitingOverlay","waitingMessage","tmpl","isSharePoint","getSize","getOffset","min-height","min-width","getFocusedElement","setFocusedElement","errorJson","setSize","clearOnlyServer","cancelPreviousRequest","focusIdentifier","IdScope","objMessage","strMessage","connection","abort","buttonId","checkpointUrl","commitUrl","rollbackUrl","getFloatingButton","contextEvent","processTemplate","processedTemplate","g1","g2","layoutCollection","getCss","layoutguid","getContextEvent","withAddForm","withEditForm","allowDetail","getKeys","inlineAddRecords","showPreview","drawControls","drawActions","drawControl","drawForms","drawPreview","templateItem","hasData","getTotalRows","getRow","getNextRow","getPreviousRow","getFirstRow","getLastRow","setPointer","isTherePendingInlineRow","addKey","newId","removeKey","navigationform","getParameters","submitAddRequest","addUrl","submitEditRequest","editUrl","submitDeleteRequest","deleteUrl","submitSaveRequest","saveUrl","dataFail","submitRollbackRequest","getRemoteData","dataUrl","validateControls","expandedIcon","getExpandedIcon","collapsedIcon","getCollapsedIcon","expandedClassIcon","bImmediate","loading","panel","renderResult","performSearch","searchParams","refreshResults","collectSearchValues","maxRows","deviceMaxRecordsExceeded","onSearchFinished","errorObject","submitArray","getCriteriaOperation","criteriaData","parseAdditionalProperties","tabItems","counter","tabOrientation","getActiveTab","loadOnDemand","containsFocusedElement","setActiveTab","selectedTab","renderTabContent","deferredActions","engine","templateEngine","autoGenerateData","selecttemplate","processPropertyValueArgs","tagslist","maxItems","processPropertyValueDataTmplArgs","defaultAllowActions","allowactions","isHorizontal","templatetype","executeActionImmediately","processPropertyValueExecuteAction","notifyExecution","actionName","readOnly","templateDefined","actionManager","guidProcess","processStartForm","processActionFormCollection","processActionForm","addActionToQueue","actionsList","additionalXpath","idParentWorkitem","entityXpath","newValueActionsList","removeActionToQueue","controlValue","countSameActions","getPropertiesActionLaucher","actionsLaucher","getTagList","processPropertyValueExecuteConstructor","displayNamee","taglist","hasLocalData","enableTyping","complementData","isDependant","getParentCombo","valueControl","renderCombo","renderComboTemplate","dataPromise","getTemplateName","emptyValue","emptyLabelForCombo","getTemplateParams","unique","showEmpty","showCurrentData","getDummyData","remoteDataLoaded","recalculate","msgObj","auxMsg","combo","getSelectedValue","currentValue","parseAdditionalValues","newItem","bCurrentDataFound","emptyFound","dataValue","comboData","isExtraItem","escapeValue","mapValue","validateValue","translated","findDataValueById","showLetters","randomId","getDefaultAllowDecimals","numDecimals","setGroupDigits","colorizeOnNegative","dataTypeMinValue","calculateMinValue","dataTypeMaxValue","calculateMaxValue","numericInput","attachRetypeDouble","attachFormatCurrency","removeValidations","digitGroupSeparator","minValue","getMinValue","maxValue","getMaxValue","inputValue","inputLength","oldVal","isInvalidFormat","tempValue","messageToShow","isValidRenderMessage","executeFormatCurrencyPlugin","tmpData","clipboardData","originalEvent","totalVal","keydown","keyUnicode","formatTimeout","floatPart","currentPosition","keyup","character","regExp","validMessage","getDefaultGroupDigits","newValue","createTooltip","currentTitle","toolTipZindex","fullFormat","datePickerRegional","indexDateTimeSeparation","lastIndexOf","uppercaseDatePlaceholder","intHandler","isNow","dateControl","getDateControl","timeControl","getTimeControl","onChangeHandler","updatingTime","hasMaxLines","maxLines","regularExpressionExpression","regularExpressionMessage","regularExpression","isEmptyField","textarea","validationMessages","originalData","areThereEditableColumns","areThereTotalizedColumns","initProperties","enabledChecks","exclusiveChanges","originalEnabledChecks","groupBy","spliceRowData","isExclusive","columnRender","singleInstance","totalize","reverse","rowsPerPage","keyColumn","skipInitialLoad","allowFilter","groupSummary","groupText","groupCollapsed","groupOrder","formShowMode","addLabel","editLabel","deleteLabel","exportOptionsLabel","detailLabel","alreadySaved","overrideGetRemoteData","cellOverrides","changeOrderData","rowKey","reverseDataRows","removeRemainingColumns","numColumns","remainingColumns","getColumnType","getGridTemplate","applyTemplate","columnInitializers","initialize","spliceIndex","spliceRowDataVisible","spliceRowDataEditable","rowTemplate","buildCellXpathFilter","dataResp","collectGridChange","isPressed","configureColumnSubmitOnChange","keysToDelete","columnXpath","canColumnBeSent","columnExclusiveChanges","columnEnabledChecks","lengthEnabledChecks","cellOverride","getCellOverride","getCellValue","setError","changeCellProperties","saveGrid","changeColumnsEditability","saveInlineAddedRows","getDepthData","updateAffectedCellManually","canBeExported","hasErrors","getDataNewRows","merge","uniqueMessages","isValueValid","messagesLength","gridValidationMessage","setCellOverrides","len_v","newRecords","submitForGridChange","getEnabledChecks","cleanNewRecords","hasColorHeader","headerFormat","allowDinamiclabel","bindingValue","searchForms","advancedSearch","allowSuggest","allowTyping","allowClear","searchLength","enableLocalStorage","expireCache","submitVersion","h_contexttype","enableQuerySuggestBehavior","regexC","hideStatus","selectedValue","showDesignValidations","submitOnChangexpathContextRow","runButtonAction","filesCount","horizontal","checkListGroup","vertical","templateUri","useDefaultImage","getImage64","getImageUri","replaceMultiple","allowSendInMail","getValueFilesByData","dataFiles","valueAuxFiles","getDataFilesWithoutScope","valueResult","err","warn","files","getUploadXpath","indexHour","dateObj","formattedDateTime","showsymbol","currencySymbol","geolocation","allowUpdate","getCurrentPosition","succes_callback","fail_callback","getErrorMessage","PERMISSION_DENIED","POSITION_UNAVAILABLE","TIMEOUT","performPrecision","latitude","longitude","toPrecision","allowFlip","flipped","leftData","rightData","processPropertyValue","flip","makeJsonBase","getColumnData","getRightAssociation","formatJson","associationData","leftId","association","isChecked","idRight","checked","removeElement","rightId","removeValue","addElement","leftXpath","rightXpath","leftFactName","rightFactName","maxFileSizeOfProperty","maxSize","maxFileSizeOfUser","BIZAGI_SETTINGS","UploadMaxFileSize","maxfiles","validExtensions","singleExtensions","defExtensions","haveFiles","noFiles","renderUploadItem","replaceFilesHtml","itemTemplate","getTemplateItemName","buildItemUrl","filename","deleteUploadItem","fileItem","buildAddParams","BIZAGI_SESSION_NAME","setRenderRequired","maxFiles","q_xpath","showMetadata","listControl","fileProperties","getFileExtension","isImage","lengthValues","renderFileLayout","productBuildToAbout","replaceItemHtml","metadataTemplate","metaData","ecm_ecmStatus","ecmStatus","ecm_isVisible","ecm_allowUpdateMetadata","allowUpdateMetadata","ecm_allowDelete","ecm_allowUpdateContent","allowUpdateContent","ecm_allowView","allowView","ecm_allowCheckOut","allowCheckOut","ecm_allowCancelCheckOut","allowCancelCheckOut","ecm_allowEdit","idFileUploads","extension","lockUploadItem","unlockUploadItem","letterOpened","getXpath","getContextXpath","maximized","likeButton","getFormLinkXpath","executeSubmitOnChange","submitCommitRequest","submitCheckpointRequest","submitDataRequest","downloadalldocuments","allowGenerate","preRenderControl","downloadAllDocuments","documents","getControlHtml","renderDocumentsHtml","renderActionsHtml","noActivateButton","allowgenerate","activateButton","getDocumentXpath","renderDocumentItem","getTemplateItem","joined","buildAllDocumentsUrl","caseId","workitemId","htmlControl","updateControlForPrintMode","validateContainer","replaceActionsHtml","buttonExecuted","generateLink","isPropagationStopped","documentTemplateGenerate","showDocumentPreview","deleteDocumentTemplate","resolveDeleteDocumentTemplate","resolveDocumentTemplateGenerate","messageText","autoOpenDocuments","returnCssTypeFile","lenght","redrawDocuments","documentContainer","renderAllDocumentDownload","removeDeleteButton","startIndex","restOfWord","finishIndex","downloadAllDocumentsLink","getErrorTemplate","getTemplateDownload","getTemplateReadonly","dependants","parentCombo","initializingCascadingCombo","bindDependantCombo","configureReadOnlyHandlers","isInitialValue","deferredVisible","dependantCombo","onChangeFunction","refreshDependantCombo","focusDependant","cleanInput","isEventBinded","unbindDependantCombo","dependant","parentValue","inputCombo","parentLength","parentArray","configured","itemSelected","listSize","getDataValue","idToRemove","markAsChecked","some","found","canAddMoreItems","$tagsContainer","toArray","reduce","acc","getElementWidth","MORE_OPTION_WIDTH","styles","filterList","query","$container","stringContainer","stringToSearch","addSelectedElements","findItemById","hasSearchForm","removeLastElement","getListItems","getFileDependencies","fileDependencies","renderUserfieldControl","extendedData","userEditableControl","getEditableControl","renderComplex","loadUserfieldReadOnly","userReadOnlyControl","getReadonlyControl","getReadonlyValue","setEditableValue","getEditableValue","propertyName","jqXHR","textStatus","errorThrown","getRenderElements","getServerResourceURL","userfieldGuid","getRenderValue","showDialog","initialParams","userfieldName","getUserfieldControl","isColumn","getControlXpathContext","getUserFieldInstance","replicateUserfieldMethods","userfieldInstance","isUserPreference","isAutoWidth","isAutoHeight","currentUser","buildItemUrlOffline","getOfflineImage","imageValue","saveImageOffline","blobPromise","isNative","media","getImagePath","normalizeIOSFilePath","errorHandler","resolveLocalFileSystemURL","fileEntry","reader","FileReader","onloadend","blob","readAsArrayBuffer","blobImage","operationType","saveOfflineImage","buildFullItemUrl","decoratedClass","decorateRenders","columnVisible","showColumn","readonly","isReadonly","instanceDecoratedClass","applyOverrides","propertyOverrides","invalidElement","overrideDecoratedRenderProperties","renderSummary","setSurrogateKey","setDefaultValue","getCompositeValue","overrideProperties","getSortName","getAnyDecoratedInstance","getSortColumn","originalGetData","getDataForAllCells","findDataById","fetchingData","valueForGrid","tableCell","formattedDate","setRanageControls","minControl","maxControl","$maxCanvas","$minCanvas","renderRangeControl","$canvas","defineRangeControl","dateMin","suscribe","observer","notify","dateMax","getRenderProperties","typeRangeControl","renderProperties","moneyMin","moneyMax","numberMin","numberMax","slideFormParams","slideContainer","createRenderContainer","configureViewHandlers","goBack","renderSlideForm","formClass","onSave","containerParams","view_container","delegate","errorTemplate","getCommonTemplate","error_message","kendoTmpls","slideFormDeferred","allowGetOriginalFormValues","formValues","showSaveButton","slideForm","buttonContainer","refreshParams","_renderButtons","transformData","allowEdition","transformActions","transformValidations","mapRenderType","additionallabel","gridActions","bDependencyFound","newAction","transformConditions","transformCommands","gridValidations","newValidation","refreshIndex","dfd","slideOptions","renderUploadFile","virtualForm","slideParams","slideDeferred","extraButtons","renderSearchDialog","getSearchContainerData","currentSearchForm","renderAddForm","allowNew","searchResultContainer","searchFormParams","slideBoxDeferred","handleSearchFormZindex","containerSearchCriteria","addContainer","addFormParams","indicator","saveDataAddForm","currentAddForm","mapping","setDisplayValueToControl","renderControlSearchForm","addForm","searchFormToLoad","otherElements","searchForm","isDefault","searchFormData","modalViewDisplayed","saveButtonLabel","warnings","errors","configureMediaQueryHandlers","modalViewDidAppear","modalViewDidDisappear","mediaquery","matchMedia","handleOrientationChange","addListener","warningContainer","errorContainer","ekey","autoSaveEvents","newData","saveBox","hasChanges","showSaveBox","nonSupportedMethods","validateFeatureSupport","getPane","pane","handler","saveButton","nextButton","getViewContainer","postRenderEdit","formsRenderVersion","originalParams","popupResponse","getResponseValues","getResponseValuesParams","dontClose","repaintComplexGateway","isComplex","workItems","taskType","currentPopup","BIZAGI_WORKPORTAL_WIDGET_COMPLEXGATEWAY","sourceElement","insertAfter","activeScroll","closed","addWarning","addError","error_obj","notifier","class_name","sticky","kendoTmpl","VISIBLE_TABS","suscribeMethods","checkPlusVisibility","tabItem","tabReadyDeferred","tabActiveDeferred","headerShow","headerHide","accordion","accordionItem","group","expanded","subscribeOnTouch","isOpen","resultsGrid","searchCriteria","results","criteriaContainer","resultsContainer","polymorphicLauncher","configureQueueVisibility","totalActions","lessActions","templateArguments","treeActionsList","getTreeItems","bindHandlers","level","templateTreeItem","$targetData","onActionClicked","expr","FilterAction","act","executeAction","slide","cancelButtonLabel","pageCache","savedData","editMode","startForm","showConfirmationDialog","actionsToExecuteContainer","removeActionSelector","openActionSelector","$target","actionsToExecuteTitle","actionLauncher","templateData","wrap","actionsContainer","configureTemplateHandlers","multipleSelection","plusBtn","showActions","subscribe","filters","calculateFilters","renderParams","rewriteContextType","xpathContextWithKey","xpathContextWithoutKey","IdEntity","listOfActions","extraParams","dataAction","htmlTemplate","extendedText","rowSize","stopAutoAdjustInterval","autoAdjustInterval","autoExtend","autoAdjustExtendedFrame","resolvedValue","hiddenDiv","retypeDouble","numberScientificNotation","inputDisplay","numericIcon","attachFormatSientificNotation","scientificNotationNumber","scientificNotationNumberDisplay","DEFAULT_PROPERTIES","maxYearsToDisplay","initializeDateControl","isValidMinMaxValue","inputControl","controlElements","defaultDateControl","getFormattedDate","minDateControl","maxDateControl","getTimeFormat","setFullYear","mobiscroll","calendar","lang","languages","BIZAGI_LANGUAGE","inst","timeS","onSet","getVal","is24h","onBeforeShow","onShow","disableScroll","initializer","currentTime","fullDateFormated","setHour","getFullFormatedDate","preprocessDateValue","isClearButton","formatedFullDate","setNewDateValue","fullDate","dateFromFormat","applyDateFormat","initIndexTime","endIndexTime","validateMinAndMaxValue","showMandatoryMessage","isMinValue","vValue","resultValue","formatedDate","yesno","parsedValue","check","initializeCombo","showDisplayValue","parentComboValue","initialValueSet","configureCombo","inputSpan","processComboData","modalViewTemplate","modalView","kendoMobileModalView","useNativeScrolling","configureModalViewHandlers","inputContainer","closeModalViewPromise","setModalViewDisplayValue","selectedElements","_newSelectedElement","$li","actionSave","inputEdition","valueItem","valueObjet","changeCombo","comboValue","getTemplateEditionName","upload","QUALITY_PICTURE","LIMIT","EXTENSIONSIMG","EXTENSIONSFILE","EXTENSIONSVIDEO","EXTENSIONSAUDIO","allow_upload","checkExtensions","validOptions","video","nonSupportedExtension","fileAPISupported","activateUploadNative","activeUploadWebControl","addEventToOpenSlide","executeFormFailHandler","itemAddfile","checkMaxFiles","attachDeleteHandler","uploadTemplate","kendoTemplate","$modalView","ModalView","listOptions","applyPlugin","getBoundingClientRect","coordinates","resolutionUpload","getImageResolutionItems","actionSheet","actionClicked","resolutionButtonHandler","appear","cancelClicked","popover","CameraPopoverOptions","quality","sourceType","Camera","PictureSourceType","PHOTOLIBRARY","popoverOptions","camera","getPicture","extensions","closeModalView","checkMaxSize","getFileDataInfo","checkFileTypes","saveImage","modalResolutionUpload","buttonIndex","onFail","targetWidth","targetHeight","correctOrientation","capture","captureVideo","checkMaxSizeVideo","saveVideo","limit","actionSelected","ResolutionType","ORIGINAL","getImageResolution","transformImageSize","editedImageURL","localUrl","base64Image","errorResponse","isNativeContext","getTemplateEditionMenu","addParams","dataFile","queueID","FileUploadOptions","fileKey","mimeType","uploadKey","uploadFile","onUploadFileCompleted","dataVideo","fullPath","messageError","uploadWrapper","actualFiles","nonSupportedExtensionsArr","uploadfile","itIsMaxNumberFilesReached","checkMaxSizeFile","statusText","buildAddFileParams","FormData","atachOpenFileEvent","dataIndex","fileData","fileMimeType","openOfflineFile","getDataUri","fileExtension","uniqueID","onUploadFileCompletedOffline","XMLHttpRequest","onload","readAsDataURL","responseType","send","failReadFile","objectUpload","dataimage","dataUrltoSave","dataMimeType","fileToSave","DataType","objectUri","objectVideo","fileIndex","GRID_PAGE_SIZE","cellMetadata","getRowIndexByKey","initialLoadDone","isPaginatorActive","applyGridPlugin","updateData","pendingActions","buildColumnModel","columnsTotalizers","bizagi_grid_tablet","hasTotalizer","pageRequested","fetchData","sortRequested","cellReady","rowSelected","addRow","editRow","deleteRow","moreRows","showMore","onTotalData","columnModel","columnLabel","dataReady","dataReadyDeferred","loadChanges","idRow","idRowLength","columnNumber","alternativePaginator","pageSelected","pageLeftPosition","pagerContentWidth","lastLiElementPosition","pagerMarginAnimate","margin-left","newKeys","saveDeferred","originalEditable","newid","slideView","view","addPage","cleanActionChanges","executeSubmitEditRequest","editInline","editPage","originalrowsPerPage","dataToSend","moreRowsCommon","currentRow","sel","parentPromise","inlineAddPromise","inlineAddDeferred","rowLength","showTotal","columnsModel","operationState","sum","return_value","avg","formatTotalizedResult","showTotals","MAX_ROWS_SUPPORTED","originalRows","isTaskForm","createdOffline","isValidGrid","saveAddedRows","beforeInlineAdd","afterInlineAdd","cancelEdition","removeNewRecords","processChanges","rowsList","sortArray","processRow","collectOfflineTaskData","internalRedersValues","currentChanges","addRowData","isNew","processOldRows","collectChangesWithoutDeleting","collectOfflineStartData","tempRows","col","leng","drawEditableCell","drawReadonlyCell","originalFormat","_value","compositeValue","bRefresh","statusAction","delInfo","errorsMessage","ADVANCED_SEARCH_ID","ADVANCED_ADDITION_ID","SEARCH_MIN_LENGTH","SEARCH_DELAY","MAX_ITEMS","MAX_ITEMS_OFFLINE","searchInput","_simplySuggestOffline","_advanceSearch","_simplySearch","hasMozillaHelpText","applyAutocompletePlugin","showSlideSearch","autoCompleteSearchResults","elemObject","itemautocomplete","processRequest","resp","wrapper","elementUl","searchItem","renderSearchItem","req","suggestions","addToSuggestions","alSuggestions","dataOffline","itemsAttached","current","autocomplete","showAddRecordDialog","letter","fileprint","link","isValidValue","encodeURI","getFullyDecodedURI","itemId","onCheckListGroupChange","addButton","newItemName","goalActivity","addEditButton","cancelEditButton","additionalElements","notifyLoadItems","resolvedItems","idActivity","itemsResolved","activityWork","activityFormTitle","activityDescription","prepareNewItem","that","contentHolder","deleteItem","itemPosition","selectItem","repaintControl","itemSelectedName","itemContent","addSelectedHandlers","addItem","guidItem","checkListHtml","refreshValue","layoutImage","success","getResponseHeader","byteArrayToBlob","imageUrl","URL","webkitURL","createObjectURL","idcase","idworkitem","contextxpath","layoutLink","getContainerRender","proxy","onClickElement","navigateFromRender","reference","referenceType","layoutLabel","layoutText","layoutDateTime","layoutNumber","layoutMoney","layoutUpload","getHTMLFiles","formLink","hasentryrule","openLinkRule","openLink","paintFormLink","rollbackForm","dataRuleResp","ex","noAction","hasexitrule","closeExitRule","getFormLinkXpathContext","parentXpathContext","outerHTML","radio","selectedRadio","siblings","comboItem","cascadingCombo","onComboChange","renderEdition","configureListHandlers","modalViewList","multiSelect","base","temporalElements","openModalView","onUnselectElement","onShowSelectedElements","valuesToShow","$listView","showFloatListView","datasource","$tagElements","modalListHandlers","$listContainer","addNewValuesToInput","tempArray","totalValues","elementTemplate","$ChildToAdd","viewMoreTemplate","$viewMore","$floatListContext","checkbox","addTemporalElement","closeFloatView","elementToRemove","$containerControl","$floatList","widthControl","my","at","of","collision","columnData","dataAssociation","addEventControl","showDefaultContainer","defaultHeader","defaultContainer","closeAccordionSection","slideDown","headers","contents","slideUp","contextElement","associateElement","dissociateElement","getLeftName","parentId","itemAdd","itemRemove","ecm","respString","holder","startWaiting","$button","stopWaiting","$inputFile","elementBase","tmpidElement","elementsEvent","lock","unlock","del","elementReference","panelMetadata","btnCancel","btnSave","addEventsEcm","removeEventsEcm","uploadEcmLink","filesLinkElements","itemsUpload","cimage","caudio","cvideo","menuItem","metadata","applyListener","nTimeoutAccordionSection","setMobiscroll","elementsToCheck","isInvalid","metadataelement","tmpElement","oldValue","description","idmetadata","actualValue","idMetadata","metadataValues","$input","valueDate","minDate","valueText","removeListener","captureAudio","mediaFiles","audioUrl","localURL","saveAudio","Filename","dataAudio","enableImage","meta","metadataType","$arrayEcmControls","arrayItems","idfileupload","searchList","initializeList","modalViewTemplates","inputTemplates","configureReadOnly","configureModalView","newElement","showResults","showNoResultsMessage","appendFoundItem","$newElement","lastElement","isModalViewContainer","li","defaultElement","finalValue","basicUserField","defaultUserField","controlName","$addImage","$deleteImage","showAsyncImage","createModal","imageAdd","adjustSize","imageDelete","baseParams","zoom","img","onPreviewActionBack","originalImage","originalImageWidth","dataUrlToSave","imageTemplate","maxHeight","windowHeightSize","windowWidthSize","listHeight","maxWidth","popupHeight","useCamera","destinationType","DestinationType","FILE_URI","uploadFileCompleted","imageEditorParams","mobileImageEditorParams","openImageEditor","imageMaxSize","imageURL","applyDocumentTemplatesFormat","documentList","previewTooltip","returnType","rangeDate","rangeMoney","rangeNumber","cordinate","updateDisplayValue","onSuccess","coords","onError","originalGetControl","applyColumnStyles","isInlineRow","xpathPath","getImageXpathContext","applyUploadPlugin","nameFile","templates","loadOverrides","initAsyncStuff","loadTemplates","loadTemplate","templateDestination","templateService","resolvedTemplate","mobileform","formTemplate","usersForm","contentPanel","nestedForm","mobilegroup","mobiletext","layoutPlaceholder","layoutBoolean","entityTemplate","userfieldWrapper","getSearchRender","getQueryRender","collectionnavigator","getUser","activityCheckList","columnParams","exclusiveCheck","uploadecm","queryExtendedText","queryText","queryCheck","queryYesNo","queryNumber","queryMoney","queryDate","queryCombo","queryCascadingCombo","querySuggest","queryLabel","queryList","queryMultiSelect","querySearch","queryRadio","queryState","queryCaseState","queryProcess","querySearchUser","factory","enableMSF","resolvedRemplate","tmplIcons","enableCustomizations","getJavaScript","offline","execution_device","cachedFactory","getRenderFactory","print","getDataService","executionDeferred","deviceFactory","getFactory","unsubscribe","doc","ownerDocument","process","refreshing","pathProcess","lastWidth","lastHeight","resizeInPopUpHTML","configureRefresh","configureRouting","configureRenderError","configureResize","configureGlobalHandlers","enableE2EInterface","transformGridControl","processForm","getFailDeferred","jsonErrorMessage","BIZAGI_ORIENTATION","buttonsForm","fastEmpty","canvasParent","resizeTimeout","forceResize","triggerParams","heightActivitiFormContainer","renderForm","heightButtonContainer","renderBehavior","heightCanvas"],"mappings":"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","sourcesContent":["/*\r\n *   Name: \r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This widget will implement a custom grid for bizagi rendering module\r\n *\r\n *   Markup: <div></div>\r\n *\r\n *   Styles:\r\n *   - Desktop: css/bizagi/desktop/controls/bizagi.grid.css\r\n *   - Tablet: css/bizagi/tablet/controls/bizagi.grid.css\r\n */\r\n\r\n// TODO: Create templates\r\n\r\n(function ($) {\r\n    $.widget(\"ui.bizagi_grid\", {\r\n        options: {\r\n            id: \"no-id\",\r\n            columns: [],\r\n            sortBy: \"\",\r\n            sortType: \"asc\",\r\n            showSummary: false,\r\n            collapse: false,\r\n            collapseState: false,\r\n            data: {},\r\n            indexedData: {},\r\n            maxColumns: 0,\r\n            buttonsPst: false,\r\n            title: '',\r\n            tableCssClass: '', // Style for entire table              \r\n            headerStyles: '',\r\n            floatingHeader: false,\r\n            template: {\r\n                grid: \"\",\r\n                waiting: \"\",\r\n                table: \"\",\r\n                emptyTable: \"\",\r\n                column: \"\",\r\n                specialColumn: \"\",\r\n                row: \"\",\r\n                rowButtons: \"\",\r\n                cell: \"\",\r\n                specialCell: \"\",\r\n                pager: \"\",\r\n                buttons: \"\",\r\n                dynamicPager: \"\",\r\n                summary: \"\",\r\n                summaryCell: \"\"\r\n            },\r\n            actions: {\r\n                add: true,\r\n                edit: true,\r\n                remove: true,\r\n                details: true,\r\n                allowMore: false,\r\n                enableXlsExport: false,\r\n                enablePdfExport: false\r\n            },\r\n            mode: \"execution\"\r\n        },\r\n        /*\r\n        *   Constructor\r\n        */\r\n        _init: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n            var element = self.element;\r\n\r\n            // Set object variables\r\n            self.page = 1;\r\n            self.changes = {};\r\n            self.totalRows = 0;\r\n            self.totalPages = 0;\r\n            self.data = options.data;\r\n            self.selectedRow = 0;\r\n            self.components = {};\r\n            self.buttons = {};\r\n            self.asyncCells = {};\r\n            self.scrollableArea = options.scrollableArea || self;\r\n\r\n            // Build column indexes\r\n            self.columnByIndex = {};\r\n            self.columnByName = {};\r\n            self.columnKeyIndex = 0;\r\n            $.each(options.columns, function (i, column) {\r\n                // Fix non-present properties\r\n                column.key = typeof (column.key) !== \"undefined\" ? column.key : false;\r\n                column.label = typeof (column.label) !== \"undefined\" ? column.label : column.name;\r\n                column.sortType = \"asc\";\r\n                column.tooltip = typeof (column.tooltip) !== \"undefined\" ? column.tooltip : \"\";\r\n\r\n                // Index the column\r\n                self.columnByIndex[column.index] = column;\r\n                self.columnByName[column.name] = column;\r\n                if (column.key) {\r\n                    self.columnKeyIndex = column.index;\r\n                }\r\n            });\r\n\r\n            // Set sort options\r\n            options.sortBy = options.sortBy || self.columnByIndex[0].name;\r\n            if (self.columnByName[options.sortBy]) {\r\n                self.columnByName[options.sortBy].sortType = options.sortType;\r\n            } else {\r\n                if (self.columnByName[options.sortBy.split(\".\")[0]]) {\r\n                    self.columnByName[options.sortBy.split(\".\")[0]].sortType = options.sortType;\r\n                }\r\n            }\r\n\r\n            // Add base classes\r\n            element.addClass(\"ui-bizagi-grid-wrapper\");\r\n            element.attr(\"data-bizagi-id\", options.id);\r\n\r\n            // Calculate\r\n            self.calculateKeyIndex();\r\n\r\n            //collapse state\r\n            self.collapseState = options.collapseState;\r\n\r\n            // Start waiting signal \r\n            self.startLoading(false);\r\n        },\r\n        /*\r\n        *   Method to start loading for ajax data and update the ui\r\n        */\r\n        startLoading: function (bUseTimeout) {\r\n            var self = this;\r\n            bUseTimeout = typeof (bUseTimeout) !== \"undefined\" ? bUseTimeout : true;\r\n\r\n            if (self.options.mode !== \"execution\" || typeof self.options.sortBy === \"undefined\") {\r\n                return;\r\n            }\r\n\r\n            // Draw the waiting template when the endLoading delays more than 250ms\r\n            var waitingFn = function () {\r\n                var element = self.element;\r\n                var options = self.options;\r\n\r\n                // Set null to timeout\r\n                self.waitingTimeout = null;\r\n\r\n                element.append($.fasttmpl(options.template.waiting));\r\n            };\r\n\r\n            if (bUseTimeout) {\r\n                self.waitingTimeout = setTimeout(waitingFn, 250);\r\n            } else {\r\n                waitingFn();\r\n            }\r\n        },\r\n\r\n        /*\r\n        *   Method to remove the loading message\r\n        */\r\n        endLoading: function () {\r\n            var self = this;\r\n            var element = self.element;\r\n\r\n            // Remove waiting timeout\r\n            if (self.waitingTimeout) {\r\n                clearTimeout(self.waitingTimeout);\r\n                self.waitingTimeout = null;\r\n            }\r\n\r\n            // Remove everything\r\n            element.empty();\r\n        },\r\n\r\n        /*\r\n        *   This method updates the data and refreshes the grid\r\n        */\r\n        setData: function (data) {\r\n            var self = this;\r\n\r\n            // Set internal data\r\n            self.data = data;\r\n            self.calculateKeyIndex();\r\n\r\n            // Call refresh\r\n            self.refresh();\r\n        },\r\n        /*\r\n        *   This method retrieves the actual data from the grid\r\n        */\r\n        getData: function () {\r\n            var self = this;\r\n\r\n            // Return internal data\r\n            return self.data;\r\n        },\r\n\r\n        /*\r\n        *   Calculate key index\r\n        */\r\n        calculateKeyIndex: function () {\r\n            var self = this;\r\n            var columns = self.options.columns;\r\n            var data = self.data;\r\n\r\n            indexedData = {};\r\n\r\n            if (data.rows) {\r\n                $.each(data.rows, function (i, row) {\r\n                    var key;\r\n                    var row\r\n                    $.each(columns, function (j, column) {\r\n                        if (column.key) key = row[j];\r\n                    });\r\n                    indexedData[key] = row;\r\n                });\r\n            }\r\n            self.indexedData = indexedData;\r\n        },\r\n\r\n        /*\r\n        *   This method retrieves the changes made by the user\r\n        */\r\n        getChanges: function () {\r\n        },\r\n\r\n        /*\r\n        *   This method refreshes the grid\r\n        */\r\n        refresh: function () {\r\n            var self = this;\r\n\r\n            // Cleans components\r\n            self._cleanComponents();\r\n            self._cleanButtons();\r\n\r\n            // Call the draw method\r\n            self.components = {};\r\n            self.draw();\r\n        },\r\n\r\n        /*\r\n        *   This method refreshes only the summary\r\n        */\r\n        refreshSummary: function (columnIndex) {\r\n            var self = this;\r\n            var options = self.options;\r\n            var summary = self._getComponent(\"summary\");\r\n\r\n            // Do nothing if the component is drawing or there is no summary\r\n            if (self.drawing) return;\r\n            if (!summary) return;\r\n\r\n            // Resolve summary\r\n            if (options.showSummary) {\r\n\r\n                if (columnIndex) {\r\n                    // Refresh an specific summary\r\n                    self.refreshSummaryCell(columnIndex);\r\n\r\n                } else {\r\n                    // Clean and re-draw summary\r\n                    summary.empty();\r\n                    summary.append(self.drawSummary());\r\n\r\n                    // Execute post-render\r\n                    self.postRenderSummary(summary);\r\n                }\r\n            }\r\n        },\r\n\r\n        /*\r\n        *   Refresh a single summary cell\r\n        */\r\n        refreshSummaryCell: function (columnIndex) {\r\n            var self = this;\r\n            var options = self.options;\r\n            var summary = self._getComponent(\"summary\");\r\n            var getCell = function (summary, columnIndex) {\r\n                var cells = summary.is(\"[data-bizagi-component=summary-cells]\") ? summary.children() : summary.find(\"[data-bizagi-component=summary-cells]\").children();\r\n                return $(cells[columnIndex]);\r\n            };\r\n            var cell = getCell(summary, columnIndex);\r\n\r\n            // Omit index key\r\n            var column = self.columnByIndex[columnIndex];\r\n            if (column.key) return; // Omit key column\r\n\r\n            // Clean and Execute render\r\n            var html = self.drawSummaryCell(column);\r\n            cell.replaceWith(html);\r\n\r\n            // Recalculate cell\r\n            cell = getCell(summary, columnIndex);\r\n\r\n            // Execute post-render\r\n            self.onCellReady(column, \"summary\", cell, false);\r\n        },\r\n\r\n        /*\r\n        *   This method changes a cell value in the grid\r\n        */\r\n        changeCellValue: function (key, columnIndex, value) {\r\n            var self = this;\r\n            if (self.indexedData[key]) {\r\n                self.indexedData[key][columnIndex] = value;\r\n            }\r\n        },\r\n\r\n        deleteCellExclusiveValues: function(columnIndex) {\r\n            var self = this;\r\n            if (self.indexedData) {\r\n                $.each(self.indexedData, function (key) {\r\n                    self.indexedData[key][columnIndex] = false;\r\n                });\r\n            }\r\n        },\r\n\r\n        /*\r\n        *   This method draws the full grid associated with the data\r\n        */\r\n        draw: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n            var element = self.element;\r\n\r\n            // Start global drawing flag\r\n            self.drawing = true;\r\n\r\n            // Ends waiting signal\r\n            self.endLoading();\r\n\r\n            if (options.orientation === \"rtl\") {\r\n\r\n                // Resolve grid template\r\n                var html = $.fasttmpl(options.template.gridRtl, {\r\n                    label: options.title,\r\n                    buttonsPst: options.buttonsPst,\r\n                    collapse: options.collapse,\r\n                    collapseState: self.collapseState,\r\n                    isDesign: (options.mode === \"design\")\r\n                });\r\n\r\n            } else {\r\n                // Resolve grid template\r\n                var html = $.fasttmpl(options.template.grid, {\r\n                    label: options.title,\r\n                    buttonsPst: options.buttonsPst,\r\n                    collapse: options.collapse,\r\n                    collapseState: self.collapseState,\r\n                    isDesign: (options.mode === \"design\")\r\n                });\r\n            }\r\n\r\n            // Call sub-drawers\r\n            html = self.drawTable(html);\r\n            self.grid = $(html).appendTo(element);\r\n\r\n            // Post render the grid\r\n            self.postRender(self.grid);\r\n\r\n            if (options.mode !== \"design\") {\r\n                // Attach paginator desktop\r\n                self.attachPaginator();\r\n\r\n                // Attach handlers\r\n                self.attachHandlers();\r\n            }\r\n\r\n            if (options.mode === \"execution\" && options.floatingHeader) {\r\n                var $tableContainer = self._getComponent(\"table\");\r\n                var $table = $(\"table\", $tableContainer);\r\n                var offset = parseInt($(self.scrollableArea).css(\"padding-top\").replace(/[^\\d.]/g, '')) || 0;\r\n\r\n                $table.stickyTableHeaders({\r\n                    fixedOffset: offset > 0 ? offset - 1 : offset,\r\n                    scrollableArea: self.scrollableArea,\r\n                    zIndex: 1000,\r\n                    cacheHeaderHeight: true\r\n                });\r\n                $tableContainer.bind(\"scroll\", function () {\r\n                    $table.trigger(\"resize.stickyTableHeaders\");\r\n                });\r\n            }\r\n\r\n            // Toggle visibility depending from row count\r\n            if (self.data.rows.length === 0) {\r\n                self._getComponent(\"table\").hide();\r\n                self._getComponent(\"pager\").hide();\r\n                self._getButton(\"remove\").hide();\r\n                self._getButton(\"edit\").hide();\r\n                self._getComponent(\"dynamicPager\").hide();\r\n                self._getComponent(\"emptyTable\").show();\r\n\r\n            } else {\r\n                self._getComponent(\"table\").show();\r\n                self._getButton(\"remove\").show();\r\n                self._getButton(\"edit\").show();\r\n                self._getComponent(\"emptyTable\").hide();\r\n\r\n                if (options.actions.allowMore) {\r\n                    self._getComponent(\"dynamicPager\").show();\r\n                    self._getComponent(\"pager\").hide();\r\n                } else {\r\n                    self._getComponent(\"pager\").show();\r\n                    self._getComponent(\"dynamicPager\").hide();\r\n                }\r\n\r\n                if (options.actions.edit) {\r\n                    self._getButton(\"edit\").show();\r\n                }\r\n\r\n                if (options.actions.enableXlsExport || options.actions.enablePdfExport) {\r\n                    self._getButton('show-grid-export-options').show();\r\n                } else {\r\n                    self._getButton('show-grid-export-options').css('display', 'none');\r\n                }\r\n\r\n            }          \r\n\r\n            // End global drawing flag\r\n            self.drawing = false;\r\n        },\r\n\r\n        attachPaginator: function () {\r\n        },\r\n\r\n        /*\r\n        *   This method draws the table associated with the data\r\n        */\r\n        drawTable: function (html) {\r\n            var self = this;\r\n            var options = self.options;\r\n\r\n            // Resolve table template\r\n            var table = $.fasttmpl(options.template.table, {\r\n                showSummary: options.showSummary,\r\n                tableCssClass: options.tableCssClass\r\n            });\r\n            var emptyTable = $.fasttmpl(options.template.emptyTable);\r\n\r\n            // Resolve header\r\n            table = self._replaceElement(table, \"columns\", self.drawHeader());\r\n\r\n            // Resolve body\r\n            table = self._replaceElement(table, \"rows\", self.drawBody());\r\n\r\n            // Resolve summary\r\n            if (options.showSummary) {\r\n                table = self._replaceElement(table, \"summary\", self.drawSummary());\r\n            }\r\n\r\n            // Resolve pager\r\n            html = self._replaceElement(html, \"pager\", self.drawPager());\r\n\r\n            // Resolve buttons\r\n            html = self._replaceElement(html, \"buttons\", self.drawButtons());\r\n\r\n            //Resolve export options menu\r\n            html = self._replaceElement(html, \"gridExportOptions\", self.drawGridExportOptions());\r\n\r\n            // Resolve row buttons\r\n            html = self._replaceElement(html, \"rowButtons\", self.drawRowButtons());\r\n\r\n            // Resolve dynamic Pager\r\n            html = self._replaceElement(html, \"dynamicPager\", self.drawDynamicPager());\r\n\r\n            // Perform grid replaces\r\n            html = self._replaceElement(html, \"table\", table);\r\n            html = self._replaceElement(html, \"emptyTable\", emptyTable);\r\n            return html;\r\n        },\r\n        /*\r\n        * Find if a column has a exact match for sort it\r\n        */\r\n        isExactMatch: function () {\r\n            var self = this;\r\n            var columns = self.options.columns;\r\n            var sortBy = self.options.sortBy;\r\n            var i = 0, length = columns.length;\r\n            for (; i < length;) {\r\n                if (sortBy == columns[i++].name) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        },\r\n\r\n        /*\r\n        *   This method draws the grid header\r\n        */\r\n        drawHeader: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n\r\n            // Resolve columns\r\n            var columns = \"\";\r\n\r\n            self.exactMatch = self.isExactMatch();\r\n\r\n            $.each(options.columns, function (i, column) {\r\n                if (self.options.maxColumns > 0) {\r\n                    if (i <= self.options.maxColumns) {\r\n                        // Draw normal column\r\n                        columns += self.drawColumn(column);\r\n                    }\r\n                } else {\r\n                    // Draw normal column\r\n                    columns += self.drawColumn(column);\r\n                }\r\n            });\r\n\r\n            if (self.options.maxColumns > 0 && self._canShowButtons()){\r\n                // Draw special column\r\n                columns += self.drawSpecialColumn();\r\n            }\r\n\r\n            return columns;\r\n        },\r\n\r\n        /*\r\n        *   This method draws a column header\r\n        */\r\n        drawColumn: function (column) {\r\n            var self = this;\r\n            var options = self.options;\r\n\r\n            var columnProperties = column.bizAgiProperties || {}\r\n            var cssClass = columnProperties.cssclass ? columnProperties.cssclass : \"\";\r\n            var headerStyles = (options.headerStyles ? options.headerStyles.header : \"\");\r\n            headerStyles += (headerStyles !== \"\" ? \"; text-align:\" : \"text-align:\") + (columnProperties.columntitlealign ? columnProperties.columntitlealign : \"center\");\r\n\r\n            // Resolve column template\r\n            return $.fasttmpl(options.template.column, $.extend({}, column, {\r\n                isKey: column.key,\r\n                sortActive: column.name === options.sortBy ? column.name === options.sortBy : column.name === options.sortBy.split(\".\")[0] && !self.exactMatch ? column.name === options.sortBy.split(\".\")[0] : false,\r\n                sortType: options.sortOrder,\r\n                tooltip: column.tooltip || \"\",\r\n                columnCssClass: cssClass,\r\n                headerLabelStyles: options.headerStyles ? options.headerStyles.label : \"\",\r\n                headerStyles: headerStyles\r\n            }));\r\n        },\r\n        /*\r\n        *   This method draws a special column header that will be drawn when the grid can't show more columns\r\n        */\r\n        drawSpecialColumn: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n\r\n            // Resolve column template\r\n            return $.fasttmpl(options.template.specialColumn);\r\n        },\r\n\r\n        drawDynamicPager: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n\r\n            // Resolve column template\r\n            return $.fasttmpl(options.template.dynamicPager);\r\n        },\r\n\r\n        /*\r\n        *   This method draws the table body\r\n        */\r\n        drawBody: function () {\r\n            var self = this;\r\n\r\n            // Resolve rows\r\n            var rows = \"\";\r\n            $.each(self.data.rows, function (i, row) {\r\n                rows += self.drawRow(row);\r\n            });\r\n\r\n            return rows;\r\n        },\r\n\r\n        /*\r\n        *   This method draws a grid row\r\n        */\r\n        drawRow: function (rowData, isNewRow) {\r\n            var self = this;\r\n            var options = self.options;\r\n            var key = rowData[self.columnKeyIndex];\r\n            var newRow = isNewRow || false;\r\n            var rnd = Math.floor(Math.random() * 10000);\r\n            var row = $.fasttmpl(options.template.row, {\r\n                key: rnd,\r\n                isNewRow: isNewRow,\r\n                businessKey: key\r\n            });\r\n\r\n            // Resolve cells\r\n            var cells = \"\";\r\n            $.each(rowData, function (i, cell) {\r\n                if (self.options.maxColumns > 0) {\r\n                    if (i < self.options.maxColumns + 1) {\r\n                        // Draw normal cell\r\n                        cells += self.drawCell(i, key, cell, newRow);\r\n                    } \r\n                } else {\r\n                    // Draw normal cell\r\n                    cells += self.drawCell(i, key, cell, newRow);\r\n                }\r\n            });\r\n\r\n            if (self.options.maxColumns > 0 && self._canShowRowButtons()){\r\n                // Draw special column\r\n                cells += self.drawSpecialCell(self.options.maxColumns + 1);\r\n            }\r\n\r\n            // Resolve cells template\r\n            row = self._replaceElement(row, \"cells\", cells);\r\n            return row;\r\n        },\r\n\r\n        /*\r\n        *   This method draws the cells for summary\r\n        */\r\n        drawSummary: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n            var row = $.fasttmpl(options.template.summary);\r\n            var cells = \"\";\r\n\r\n            // Resolve summary cells\r\n            $.each(options.columns, function (i, column) {\r\n                if (self.options.maxColumns > 0) {\r\n                    if (i <= self.options.maxColumns) {\r\n                        // Draw summary column\r\n                        cells += self.drawSummaryCell(column);\r\n                    }\r\n                } else {\r\n                    // Draw summary column\r\n                    cells += self.drawSummaryCell(column);\r\n                }\r\n            });\r\n\r\n            // Resolve cells template\r\n            row = self._replaceElement(row, \"summary-cells\", cells);\r\n            return row;\r\n        },\r\n\r\n        /*\r\n        *   This method draws a single summary cell\r\n        */\r\n        drawSummaryCell: function (column) {\r\n            var self = this;\r\n            var options = self.options;\r\n\r\n            var columnProperties = column.bizAgiProperties || {};\r\n            var cellAlign = columnProperties.columnAlign ? columnProperties.columnAlign : \"center\";\r\n\r\n            // Resolve cell template\r\n            var cell = $.fasttmpl(options.template.summaryCell, {\r\n                hidden: column.hidden || false,\r\n                summarizeBy: column.summarizeBy,\r\n                cellAlign: cellAlign\r\n            });\r\n\r\n            var result = self.onDrawCell(column, \"summary\", self.calculateSummary(column), false);\r\n            result = (result != undefined && typeof (result) != \"number\") ? result.replace(\"summaryValue\", self.calculateSummary(column)) : result;\r\n\r\n            if (!result) {\r\n                result = \"\";\r\n            }\r\n\r\n            var async = typeof (result) === \"object\" && result.done;\r\n            if (async) {\r\n                if (result.state() === \"resolved\") {\r\n                    // Fetch resolved result\r\n                    cell = self._replaceElement(cell, \"cellContent\", self.resolveResult(result));\r\n                } else {\r\n                    // Wait for result\r\n                    cell = self._replaceElement(cell, \"cellContent\", \"\");\r\n                    self.asyncCells[key + \"-\" + columnIndex] = result;\r\n                }\r\n\r\n            } else {\r\n                // Resolve cell content\r\n                cell = self._replaceElement(cell, \"cellContent\", result);\r\n            }\r\n\r\n            return cell;\r\n        },\r\n\r\n        /*\r\n        *   This method draws the grid cell\r\n        */\r\n        drawCell: function (columnIndex, key, value, isNewRow) {\r\n            var self = this;\r\n            var options = self.options;\r\n            isNewRow = isNewRow || false;\r\n            var messageValidation = \"\";\r\n\r\n            // Ensure that data is mapped into a column\r\n            if (!self.columnByIndex[columnIndex]) {\r\n                return \"\";\r\n            }\r\n\r\n            // Get message\r\n            if (columnIndex > 0) {\r\n                messageValidation = self.columnByIndex[columnIndex].bizAgiProperties && self.columnByIndex[columnIndex].bizAgiProperties.messageValidation;\r\n            }\r\n\r\n            var columnProperties = self.columnByIndex[columnIndex].bizAgiProperties || {};\r\n            var cssClass = (columnProperties.cssclass) ? columnProperties.cssclass : \"\";\r\n            var cellAlign = columnProperties.columnAlign ? columnProperties.columnAlign : \"center\";\r\n\r\n            // Resolve cell template\r\n            var cell = $.fasttmpl(options.template.cell, {\r\n                isKey: self.columnByIndex[columnIndex].key,\r\n                hidden: options.columns[columnIndex].hidden || false,\r\n                isDesign: (options.mode === \"design\"),\r\n                messageValidation: messageValidation,\r\n                columnCssClass: cssClass,\r\n                id: options.columns[columnIndex].bizAgiProperties ? options.columns[columnIndex].bizAgiProperties.id : undefined,\r\n                cellAlign: cellAlign\r\n            });\r\n\r\n            var result = self.onDrawCell(self.columnByIndex[columnIndex], key, value, isNewRow);\r\n            if (!result) {\r\n                result = \"\";\r\n            }\r\n            var async = typeof (result) === \"object\" && result.done;\r\n            if (async) {\r\n                if (result.state() === \"resolved\") {\r\n                    // Fetch resolved result\r\n                    cell = self._replaceElement(cell, \"cellContent\", self.resolveResult(result));\r\n                } else {\r\n                    // Wait for result\r\n                    cell = self._replaceElement(cell, \"cellContent\", \"\");\r\n                    self.asyncCells[key + \"-\" + columnIndex] = result;\r\n                }\r\n\r\n            } else {\r\n                // Resolve cell content\r\n                cell = self._replaceElement(cell, \"cellContent\", result);\r\n            }\r\n\r\n            self.columnByIndex[columnIndex]['cell'] = $(cell);\r\n            return cell;\r\n        },\r\n        /*\r\n        *   Returns the resolved result from a promise when the promise has been executed already\r\n        */\r\n        resolveResult: function (promise) {\r\n            var result;\r\n\r\n            promise.done(function (data) {\r\n                result = data;\r\n            });\r\n\r\n            return result;\r\n        },\r\n        /*\r\n        *   This method draws a special cell that will be drawn when the grid can't show more columns\r\n        */\r\n        drawSpecialCell: function (columnIndex) {\r\n            var self = this;\r\n            var options = self.options;\r\n\r\n            /* // Ensure that data is mapped into a column\r\n            if (!self.columnByIndex[columnIndex]) {\r\n                return \"\";\r\n            } */\r\n\r\n            // Resolve cell template\r\n            var cell = $.fasttmpl(options.template.specialCell);\r\n\r\n            return cell;\r\n        },\r\n        /*\r\n        *   This method draws a group header\r\n        */\r\n        drawGroupHeader: function () {\r\n            // TODO: Implement for PC version\r\n        },\r\n        /*\r\n        *   This method draws a footer\r\n        */\r\n        drawFooter: function () {\r\n            // TODO: Implement for PC version\r\n        },\r\n        /*\r\n        *   This method draws a grid pager\r\n        */\r\n        drawPager: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n\r\n            // Calculate pages\r\n            var pages = [];\r\n            for (var i = 1; i <= self.data.total; i++) {\r\n                pages.push({\r\n                    number: i,\r\n                    active: (i == self.data.page)\r\n                });\r\n            }\r\n\r\n            // Resolve pager template\r\n            return $.fasttmpl(options.template.pager, {\r\n                page: self.data.page,\r\n                pages: pages,\r\n                records: self.data.records\r\n            });\r\n        },\r\n        /*\r\n        *   This method draws a grid button actions\r\n        */\r\n        drawButtons: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n            var tooltips = options.tooltips || {};\r\n\r\n            var parameters = $.extend(options.actions, tooltips);\r\n\r\n            if (self._canShowButtons()) {\r\n                // Resolve buttons template\r\n                if (options.orientation === \"rtl\") {\r\n                    return $.fasttmpl(options.template.buttonsRtl, parameters);\r\n                } else {\r\n                    return $.fasttmpl(options.template.buttons, parameters);\r\n                }\r\n            } else {\r\n                return \"\";\r\n            }\r\n        },\r\n\r\n        /*\r\n        * This method draws the export options menu\r\n        */\r\n        drawGridExportOptions: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n            var actions = options.actions;\r\n\r\n            tooltips = options.tooltips || {};\r\n\r\n            var parameters = $.extend({ \r\n                enableXlsExport: actions.enableXlsExport,\r\n                enablePdfExport: actions.enablePdfExport \r\n            }, tooltips);\r\n\r\n            return $.fasttmpl(options.template.exportOptions, parameters);\r\n        },\r\n\r\n        /*\r\n        *   This method draws a row buttons,\r\n        *   those buttons will be invisible, and will be activated when the user selects a row\r\n        */\r\n        drawRowButtons: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n\r\n            if (self._canShowRowButtons()) {\r\n                // Resolve row buttons template\r\n                if (options.orientation === \"rtl\") {\r\n                    return $.fasttmpl(options.template.rowButtons.rtl, options.actions);\r\n                } else {\r\n                    return $.fasttmpl(options.template.rowButtons, options.actions);\r\n                }\r\n            } else {\r\n                return \"\";\r\n            }\r\n        },\r\n        /*\r\n        *   Execute post-renders in all the grid\r\n        */\r\n        postRender: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n\r\n            // Get grid rows\r\n            var rows = self._getComponent(\"cells\");\r\n            if (rows) {\r\n                $.each(rows, function (i, row) {\r\n                    row = $(row);\r\n                    self.postRenderRow(row);\r\n                });\r\n            }\r\n\r\n            // Get summary row\r\n            if (options.showSummary) {\r\n                var summary = self._getComponent(\"summary\");\r\n                self.postRenderSummary(summary);\r\n            }\r\n\r\n            self._triggerHandler(\"gridControlReady\");\r\n        },\r\n\r\n        /*\r\n        *   Execute post-renders in each cell after the element has been created\r\n        */\r\n        postRenderRow: function (row) {\r\n            var self = this;\r\n            var key = row.attr(\"data-business-key\");\r\n            var isNewRow = row.attr(\"data-new-row\");\r\n            var cells = row.is(\"[data-bizagi-component=cells]\") ? row.children() : row.find(\"[data-bizagi-component=cells]\").children();\r\n\r\n            $.each(cells, function (i, cell) {\r\n                var column = self.columnByIndex[i];\r\n                if (typeof column == \"undefined\" || column.key) return; // Omit key column\r\n\r\n                // Check if the cell has an async result\r\n                var asyncResult = self.asyncCells[key + \"-\" + column.index];\r\n                if (asyncResult) {\r\n                    $.when(asyncResult)\r\n                        .done(function (html) {\r\n                            // Append async result\r\n                            cell = $(cell);\r\n                            cell.append(html);\r\n                            self.onCellReady(column, key, cell, isNewRow);\r\n                        });\r\n                } else {\r\n                    self.onCellReady(column, key, $(cell), isNewRow);\r\n                }\r\n            });\r\n        },\r\n\r\n        /*\r\n        *   Execute post-renders in each summary cell after the element has been created\r\n        */\r\n        postRenderSummary: function (summary) {\r\n            var self = this;\r\n            var cells = summary.is(\"[data-bizagi-component=summary-cells]\") ? summary.children() : summary.find(\"[data-bizagi-component=summary-cells]\").children();\r\n\r\n            $.each(cells, function (i, cell) {\r\n                var column = self.columnByIndex[i];\r\n                if (column.key) return; // Omit key column\r\n\r\n                // Check if the cell has an async result\r\n                var asyncResult = self.asyncCells[key + \"-\" + column.index];\r\n                if (asyncResult) {\r\n                    $.when(asyncResult)\r\n                        .done(function (html) {\r\n                            // Append async result\r\n                            cell = $(cell);\r\n                            cell.append(html);\r\n                            self.onCellReady(column, \"summary\", cell, false);\r\n                        });\r\n                } else {\r\n                    self.onCellReady(column, \"summary\", $(cell), false);\r\n                }\r\n            });\r\n        },\r\n\r\n        /*\r\n        *   Method to attach any handler to the grid\r\n        */\r\n        attachHandlers: function () { },\r\n\r\n        //TODO IMPLEMENTANDO\r\n        selectDynamicPager: function () {\r\n            this.onDynamicPager();\r\n        },\r\n\r\n        /*\r\n        *   Changes the current page in the grid\r\n        */\r\n        changePage: function (page) {\r\n            var self = this;\r\n            var currentPage = Number(self.data.page);\r\n            var total = self.data.total;\r\n            var newPage = page;\r\n\r\n            // Process previous page\r\n            if (page === \"previous\") {\r\n                if (currentPage > 1) {\r\n                    newPage = currentPage - 1;\r\n                } else {\r\n                    return;\r\n                }\r\n            }\r\n\r\n            // Process next page\r\n            if (page === \"next\") {\r\n                if (currentPage < total) {\r\n                    newPage = currentPage + 1;\r\n                } else {\r\n                    return;\r\n                }\r\n            }\r\n\r\n            //refresh components cells and rows\r\n            self._cleanComponents();\r\n\r\n            // Update internal options\r\n            self.page = Number(newPage);\r\n\r\n            // Execute handler\r\n            self.onPageRequested();\r\n        },\r\n\r\n        /*\r\n        *  Verify cells before sumitonchange\r\n        */\r\n        isValid: function () {\r\n            // Trigger handler\r\n            return this._triggerHandler(\"isValid\");\r\n        },\r\n\r\n        /*\r\n        *   Sort the grid by a column\r\n        */\r\n        sortBy: function (columnIndex, sortType) {\r\n            var self = this;\r\n            var options = self.options;\r\n            var column = self.columnByIndex[columnIndex];\r\n\r\n            if (typeof options.sortBy === \"undefined\") {\r\n                return true;\r\n            }\r\n\r\n            // Set new sort type reversed to current, if the sort column has not changed\r\n            if (typeof (column.name) === \"undefined\") column.name = column.label;\r\n            if (column.name == options.sortBy) {\r\n                sortType = sortType || (options.sortOrder == \"asc\" ? \"desc\" : \"asc\");\r\n            } else {\r\n                if (column.name == options.sortBy.split(\".\")[0]) {\r\n                    sortType = sortType || (options.sortType == \"asc\" ? \"desc\" : \"asc\");\r\n                } else {\r\n                    sortType = sortType || options.sortType;\r\n                }\r\n            }\r\n\r\n            // Update internal options\r\n            if (options.sortBy.split(\".\").length > 1) {\r\n                if (options.sortBy.split(\".\")[0] != column.name) {\r\n                    options.sortBy = column.name;\r\n                } else {\r\n                    options.sortBy = column.name;\r\n                }\r\n            } else {\r\n                options.sortBy = column.name;\r\n            }\r\n\r\n            if (typeof (column.bizAgiProperties.sortAttribute) !== \"undefined\" && column.bizAgiProperties.type.indexOf(\"column\") !== -1) {\r\n                options.sortBy = column.name + \".\" + column.bizAgiProperties.sortAttribute;\r\n            }\r\n\r\n            options.sortColumn = column;\r\n            options.sortType = sortType;\r\n            options.sortOrder = sortType;\r\n\r\n            //refresh components cells and rows\r\n            self._cleanComponents();\r\n\r\n            // Execute handler\r\n            self.onSortRequested();\r\n        },\r\n\r\n        /*\r\n        *   Selects a row in the grid\r\n        */\r\n        selectRow: function (key, businessKey) {\r\n            var self = this;\r\n\r\n            if (self.selectedRow == key) {\r\n                // Invoke un-select handler\r\n                self.onRowUnselected();\r\n\r\n                // Update internal options\r\n                self.selectedRow = 0;\r\n                self.selectedBusinessKey = 0;\r\n            } else {\r\n                if (self.selectedRow != 0) {\r\n                    // Invoke un-select handler\r\n                    self.onRowUnselected();\r\n                }\r\n\r\n                // Update internal options\r\n                self.selectedRow = key;\r\n                self.selectedBusinessKey = businessKey;\r\n\r\n                // Invoke select handler\r\n                self.onRowSelected();\r\n            }\r\n        },\r\n\r\n        /*\r\n        *   Unselects a row in the grid\r\n        */\r\n        unselectRow: function () {\r\n            var self = this;\r\n\r\n            if (self.selectedRow != 0) {\r\n                // Invoke un-select handler\r\n                self.onRowUnselected();\r\n                self.selectedRow = 0;\r\n                self.selectedBusinessKey = 0;\r\n            }\r\n        },\r\n\r\n        /*\r\n        *   Calculates the summary for a column given the data\r\n        */\r\n        calculateSummary: function (column) {\r\n            var self = this;\r\n            var operation = column.summarizeBy;\r\n\r\n            //Consider the default values in the operations\r\n            $.each(self.data.rows, function (i, value) {\r\n                if (typeof self.data.rows[i][column.index] !== \"undefined\" && self.data.rows[i][column.index] == null && column.bizAgiProperties.defaultvalue != null) {\r\n                    self.data.rows[i][column.index] = column.bizAgiProperties.defaultvalue;\r\n                }\r\n            });\r\n            var columnValues = $.map(self.data.rows, function (row, i) { return row[column.index]; });\r\n            var result;\r\n\r\n            // Don't calculate anything if there are no rows\r\n            if (columnValues.length == 0) return 0;\r\n\r\n            // Resolve operations\r\n            if (operation === \"sum\") {\r\n                result = 0;\r\n                $.each(columnValues, function (i, value) { if (value != null) result += Number(value); });\r\n\r\n            } else if (operation === \"min\") {\r\n                result = columnValues[0] || 0;\r\n                $.each(columnValues, function (i, value) { if (typeof (value) === \"number\" && value != null && (value < result)) result = Number(value); });\r\n                if (result === Math.max()) result = null;\r\n\r\n            } else if (operation === \"max\") {\r\n                result = columnValues[0] || 0;\r\n                $.each(columnValues, function (i, value) { if (typeof (value) === \"number\" && value != null && (value > result)) result = Number(value); });\r\n                if (result === Math.min()) result = null;\r\n\r\n            } else if (operation === \"avg\") {\r\n                result = 0;\r\n                $.each(columnValues, function (i, value) { if (value != null) result += Number(value); });\r\n                result = result / columnValues.length;\r\n\r\n            } else if (operation === \"count\") {\r\n                result = 0;\r\n                columnValues = self.data.rows;\r\n\r\n                for (i = 0; i < columnValues.length; i++) {\r\n                    var columnValue = columnValues[i][column.index];\r\n\r\n                    if (columnValue instanceof Array && columnValue.length > 0) {\r\n                        result += 1;\r\n                    }\r\n                    else if (!(columnValue instanceof Array) && columnValue !== null && columnValue !== \"\") {\r\n                        result += 1;\r\n                    }\r\n                }\r\n            }\r\n            return result;\r\n        },\r\n\r\n        /*\r\n        *   Process an action in order to do something with the grid\r\n        */\r\n        processAction: function (action, params) {\r\n            var self = this;\r\n\r\n            var key = params && params.key ? params.key : self.selectedBusinessKey;\r\n            if (action === \"edit\") {\r\n                self.onEditRow(key);\r\n            }\r\n            if (action === \"remove\") {\r\n                self.onDeleteRow(key);\r\n            }\r\n            if (action === \"more\") {\r\n                self.onShowMore(key);\r\n            }\r\n            if (action === \"details\") {\r\n                self.onShowDetails(key);\r\n            }\r\n            if (action === \"add\") {\r\n                self.onAddRow();\r\n            }\r\n\r\n            if (action === \"show-grid-export-options\") {\r\n                self.onShowExportGridOptions();\r\n            }\r\n        },\r\n        /*\r\n        *   Executes the page requested handler\r\n        */\r\n        onPageRequested: function () {\r\n            var self = this;\r\n\r\n            // Start loading signal \r\n            self.startLoading();\r\n\r\n            // Trigger handler\r\n            return self._triggerHandler(\"pageRequested\", self._buildRefreshParameters());\r\n        },\r\n        /*\r\n        *   Executes the sort requested handler\r\n        */\r\n        onSortRequested: function () {\r\n            var self = this;\r\n\r\n            // Start loading signal \r\n            self.startLoading();\r\n\r\n            // Trigger handler\r\n            return self._triggerHandler(\"sortRequested\", self._buildRefreshParameters());\r\n        },\r\n        /*\r\n        *   Executes the row selected handler\r\n        */\r\n        onRowSelected: function () {\r\n            var self = this;\r\n\r\n            return self._triggerHandler(\"rowSelected\", { key: self.selectedBusinessKey });\r\n        },\r\n        /*\r\n        *   Executes the row un-selected handler\r\n        */\r\n        onRowUnselected: function () {\r\n            var self = this;\r\n            return self._triggerHandler(\"rowUnselected\", { key: self.selectedBusinessKey });\r\n        },\r\n\r\n        /*\r\n        * Executes collapse grid\r\n        */\r\n        onCollapseGrid: function () {\r\n            var self = this;\r\n            return self._triggerHandler(\"performCollapseGrid\");\r\n        },\r\n\r\n        //TODO:llamar\r\n        onDynamicPager: function () {\r\n            var self = this;\r\n            return self._triggerHandler(\"moreRows\", { key: self.selectedBusinessKey });\r\n        },\r\n\r\n        /*\r\n        *   Executes the on draw cell handler\r\n        */\r\n        onDrawCell: function (column, key, value, isNewRow) {\r\n            var self = this;\r\n            return self._triggerHandler(\"drawCell\", { \r\n                column: column,\r\n                key: key,\r\n                value: value,\r\n                isNewRow: isNewRow \r\n            });\r\n        },\r\n        /*\r\n        *   Executes on cell ready handler\r\n        */\r\n        onCellReady: function (column, key, cell, isNewRow) {\r\n            var self = this;\r\n            return self._triggerHandler(\"cellReady\", { \r\n                column: column,\r\n                key: key,\r\n                cell: cell,\r\n                isNewRow: isNewRow \r\n            });\r\n        },\r\n\r\n        /*\r\n        *   Executes the on draw control handler\r\n        */\r\n        onDrawControl: function () {\r\n            //TODO: Implement this\r\n        },\r\n        /*\r\n        *   Executes the on draw group header handler\r\n        */\r\n        onDrawGroupHeader: function () {\r\n            //TODO: Implement this\r\n        },\r\n        /*\r\n        *   Executes the on add row handler\r\n        */\r\n        onAddRow: function () {\r\n            var self = this;\r\n            return self._triggerHandler(\"addRow\");\r\n        },\r\n        /*\r\n        *   Executes the on edit row handler\r\n        */\r\n        onEditRow: function (key) {\r\n            var self = this;\r\n            return self._triggerHandler(\"editRow\", { key: key });\r\n        },\r\n        /*\r\n        *   Executes the on delete row handler\r\n        */\r\n        onDeleteRow: function (key) {\r\n            var self = this;\r\n            return self._triggerHandler(\"deleteRow\", { key: key });\r\n        },\r\n        /*\r\n        *   Executes the on show more handler\r\n        */\r\n        onShowMore: function (key) {\r\n            var self = this;\r\n            return self._triggerHandler(\"showMore\", { key: key });\r\n        },\r\n        /*\r\n        *   Executes the on show details handler\r\n        */\r\n        onShowDetails: function (key) {\r\n            var self = this;\r\n            return self._triggerHandler(\"showFormDetails\", { key: key });\r\n        },\r\n        /*\r\n        * Executes the on show export grid options \r\n        */\r\n        onShowExportGridOptions: function () {\r\n            var self = this;\r\n            return self._triggerHandler(\"showGridExportOptions\");\r\n        },\r\n\r\n        /*\r\n        *   Replaces a matched element in the container for the specified \"replace\" element\r\n        */\r\n        _replaceElement: function (html, element, replace) {\r\n            return html.replace(\"{{element \" + element + \"}}\", replace);\r\n        },\r\n\r\n        /*\r\n        *   Return the event handler parameters object\r\n        */\r\n        _buildRefreshParameters: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n            var sortColumn = (options.sortColumn != undefined) ? options.sortColumn.index : 1;\r\n            return { \r\n                page: self.page,\r\n                sortBy: options.sortBy,\r\n                sortType: options.sortOrder,\r\n                sortColumnIndex: sortColumn\r\n            };\r\n        },\r\n        /*\r\n        *   Calls directly to handler callback\r\n        */\r\n        _triggerHandler: function (type, data) {\r\n            var callback = this.options[type];\r\n            if (!callback) {\r\n                return null;\r\n            }\r\n            return callback.call(this.element[0], data);\r\n        },\r\n        /*\r\n        *   Gets the component\r\n        */\r\n        _getComponent: function (component) {\r\n            var self = this;\r\n            var element = self.element;\r\n            if (!self.components[component]) {\r\n                var foundComponent = $(\"[data-bizagi-component=\" + component + \"]\", element);\r\n                if (foundComponent != null && foundComponent.length > 0) {\r\n                    self.components[component] = foundComponent;\r\n                }\r\n            }\r\n            return self.components[component];\r\n        },\r\n        /*\r\n        *   Gets the specific Button\r\n        */\r\n        _getButton: function (button) {\r\n            var self = this;\r\n            var element = self.element;\r\n            if (!self.buttons[button])\r\n                self.buttons[button] = $(\"[data-action=\" + button + \"]\", element);\r\n            return self.buttons[button];\r\n        },\r\n        /*\r\n        * Cleans the components \r\n        */\r\n        _cleanComponents: function () {\r\n            var self = this;\r\n            self.components = {};\r\n        },\r\n        /*\r\n        * Cleans the buttons \r\n        */\r\n        _cleanButtons: function () {\r\n            var self = this;\r\n            self.buttons = {};\r\n        },\r\n        /*\r\n        *  Template method to check if buttons component must be rendered\r\n        */\r\n        _canShowButtons: function () {\r\n            return true;\r\n        },\r\n        /*\r\n        *  Template method to check if row buttons must be displayed when the row is selected\r\n        */\r\n        _canShowRowButtons: function(){\r\n            return true;\r\n        }\r\n\r\n    });\r\n})(jQuery);\r\n","/*\r\n*   Name: Bizagi Grid for tablet\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This widget will extend the bizagi grid widget to specialize into a tablet view\r\n*\r\n*   Markup: <div></div>\r\n*\r\n*   Styles:\r\n*   - css/bizagi/tablet/controls/bizagi.grid.css\r\n*/\r\n\r\n(function ($) {\r\n    $.widget(\"ui.bizagi_grid_tablet\", $.ui.bizagi_grid, {\r\n\r\n        /**\r\n         * Constructor\r\n         * @private\r\n         */\r\n        _init: function () {\r\n            this._super();\r\n\r\n            this.isOfflineForm = typeof (this.options.isOfflineForm) !== \"undefined\" && bizagi.util.parseBoolean(this.options.isOfflineForm);\r\n        },\r\n\r\n        /**\r\n         * Method to attach any handler to the grid\r\n         * @returns {}\r\n         */\r\n        attachHandlers: function () {\r\n            var self = this;\r\n\r\n            // Add paging events\r\n            self._getComponent(\"pager\").find(\"ul li button\").bind(\"click\", function () {\r\n                var pageNumber = parseInt($(this).attr(\"data-page-number\"));\r\n\r\n                if (pageNumber) {\r\n                    self.changePage(pageNumber);\r\n                }\r\n            });\r\n\r\n            //TODO falta implementar\r\n            self._getComponent(\"dynamicPager\").find(\"input\").bind(\"click\", function () {\r\n                self.selectDynamicPager();\r\n            });\r\n\r\n            // Add sort events\r\n            self._getComponent(\"columns\").find(\".bz-tablet-grid__label\").bind(\"click\", function () {\r\n                if (!self.isOfflineForm) {\r\n                    var columnIndex = $(this).attr(\"data-column-index\");\r\n                    self.sortBy(columnIndex);\r\n                }\r\n            });\r\n\r\n            // Bind button actions\r\n            self._getComponent(\"buttons\").find(\"[data-action]\").bind(\"click\", function () {\r\n                if ($(this).attr(\"data-action\") === \"totalizer\") {\r\n                    self.totalizer();\r\n                } else {\r\n                    self.processAction($(this).attr(\"data-action\"));\r\n                    self.unselectRow();\r\n                }\r\n            });\r\n\r\n            self._getComponent(\"rowButtons\").find(\"[data-action]\").bind(\"click\", function () {\r\n                self.processAction($(this).attr(\"data-action\"));\r\n                self.unselectRow();\r\n            });\r\n\r\n            if (this.isOfflineForm) {\r\n                self._getComponent(\"rows\").on(\"click\", \".bz-tablet-grid__cell-more [data-action=more]\", function (evt) {\r\n                    var $context = $(evt.target).parents(\"[data-bizagi-component=cells]\");\r\n\r\n                    if ($context && $context.hasClass(\"bz-tablet-grid__row\")) {\r\n                        var businessKey = $context.attr(\"data-business-key\");\r\n                        var isNewRow = bizagi.util.parseBoolean($context.attr(\"data-new-row\")) || false;\r\n\r\n                        if (isNewRow) {\r\n                            self.onRemoveNewRow(businessKey);\r\n                        } else {\r\n                            self.processAction(\"remove\", {key: businessKey});\r\n                        }\r\n                    }\r\n                });\r\n            } else {\r\n\r\n                self._getComponent(\"rows\").find(\"tr\").bind(\"click\", function (evt) {\r\n                    var $context = $(evt.target).closest(\".bz-tablet-grid__cell\");\r\n\r\n                    evt.stopPropagation();\r\n\r\n                    if ($context && $context.hasClass(\"bz-tablet-grid__cell\")) {\r\n                        var key = $(this).attr(\"data-key\");\r\n                        var businessKey = $(this).attr(\"data-business-key\");\r\n\r\n                        self.selectRow(key, businessKey);\r\n                    }\r\n                });\r\n\r\n                // Bind special cell button action\r\n                self._addColumnActions();\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Popup Total\r\n         * @returns {}\r\n         */\r\n        totalizer: function () {\r\n            this.options.totalData();\r\n        },\r\n        /**\r\n         * Executes the row selected handler\r\n         * @returns {}\r\n         */\r\n        onRowSelected: function () {\r\n            // Call base\r\n            $.ui.bizagi_grid.prototype.onRowSelected.apply(this, arguments);\r\n\r\n            // Show row buttons             \r\n            this._showRowButtons();\r\n        },\r\n\r\n        /**\r\n         * Executes the row un-selected handler\r\n         * @returns {}\r\n         */\r\n        onRowUnselected: function () {\r\n            // Call base\r\n            $.ui.bizagi_grid.prototype.onRowUnselected.apply(this, arguments);\r\n\r\n            // Hide row buttons           \r\n            this._hideRowButtons();\r\n        },\r\n\r\n        getCell: function (key, xpath, index) {\r\n            var self = this;\r\n            var row = self._getComponent(\"rows\").find(\"[data-business-key=\" + key + \"]\");\r\n            var allVisibleTd, cell = \"\";\r\n\r\n            if (index < 4) {\r\n                allVisibleTd = $(\"td\", $(row));\r\n                cell = allVisibleTd[index + 1];\r\n            } else {\r\n                allVisibleTd = $(\"td:visible\", $(row));\r\n                cell = allVisibleTd[index];\r\n            }\r\n\r\n            return $(cell);\r\n        },\r\n\r\n        /**\r\n         * Template method to check if buttons component must be rendered\r\n         * @returns {}\r\n         */\r\n        _canShowButtons: function () {\r\n            var actions = this.options.actions;\r\n\r\n            if (this.isOfflineForm) {\r\n                return actions[\"add\"] || actions[\"remove\"] || actions[\"edit\"] || actions[\"inlineAdd\"];\r\n            } else {\r\n                return actions[\"add\"];\r\n            }\r\n        },\r\n\r\n        /*\r\n        *   This method draws a grid pager\r\n        */\r\n        drawPager: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n\r\n            // Calculate pages\r\n            var pages = [];\r\n            var renderPages = [];\r\n\r\n            for (var i = 1; i <= self.data.total; i++) {\r\n                pages.push({\r\n                    number: i,\r\n                    active: (i == self.data.page)\r\n                });\r\n            }\r\n\r\n            if (self.data.page < 3 || self.data.page > self.data.total - 2) {\r\n                renderPages = [];\r\n            } else {\r\n                renderPages = [self.data.page - 1, self.data.page, self.data.page + 1];\r\n            }\r\n\r\n            var pagination = {\r\n                renderPages: renderPages,\r\n                pages: pages,\r\n                pagination: {\r\n                    totalPages: self.data.total,\r\n                    currentPage: self.data.page\r\n                }\r\n            };\r\n\r\n            // Resolve pager template\r\n            return $.fasttmpl(options.template.pager, pagination);\r\n        },\r\n\r\n        /**\r\n         * Template method to check if row buttons must be displayed when the row is selected\r\n         * @returns {}\r\n         */\r\n        _canShowRowButtons: function () {\r\n            var actions = this.options.actions;\r\n\r\n            if (this.isOfflineForm) {\r\n                return false;\r\n            } else {\r\n                return actions[\"edit\"] || actions[\"details\"] || this.options.columns.length > this.options.maxColumns;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Show the row buttons\r\n         * @returns {}\r\n         */\r\n        _showRowButtons: function () {\r\n            var self = this;\r\n            var doc = window.document;\r\n            var element = self.element;\r\n\r\n            // Add selected style to row\r\n            var tr = element.find(\"[data-bizagi-component=rows] tr[data-key=\" + self.selectedRow + \"]\");\r\n            tr.addClass(\"ui-bizagi-state-selected\");\r\n        },\r\n\r\n        /**\r\n         * Hide the row buttons\r\n         * @returns {}\r\n         */\r\n        _hideRowButtons: function () {\r\n            var self = this;\r\n\r\n            // Call base\r\n            $.ui.bizagi_grid.prototype.onRowUnselected.apply(self, arguments);\r\n\r\n            var tr = self._getComponent(\"rows\").find(\"tr[data-key=\" + self.selectedRow + \"]\");\r\n            tr.removeClass(\"ui-bizagi-state-selected\");\r\n\r\n            // Hide floating buttons for the row\r\n            if (!self.isOfflineForm) {\r\n                var floatingButtons = self._getComponent(\"rowButtons\");\r\n                floatingButtons.hide();\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Return the new created ids\r\n         * @param {} rows\r\n         * @returns {}\r\n         */\r\n        getNewRowKeys: function (rows) {\r\n            var self = this;\r\n\r\n            rows = rows || self._getComponent(\"rows\").find(\"[data-new-row=true]\");\r\n\r\n            return $.map(rows, function (row, i) {\r\n                return $(row).data(\"business-key\");\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Process an action in order to do something with the grid\r\n         * @param {} action\r\n         * @returns {}\r\n         */\r\n        processAction: function (action) {\r\n            var self = this;\r\n\r\n            // Call base\r\n            $.ui.bizagi_grid.prototype.processAction.apply(self, arguments);\r\n\r\n            if (action === \"save\") {\r\n                self.onSaveAddedRows();\r\n            }\r\n            if (action === \"cancel\") {\r\n                self.onCancelEdition();\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Check if row its new\r\n         * @param {} businessKey\r\n         * @returns {}\r\n         */\r\n        isNewRecord: function (businessKey) {\r\n            var self = this;\r\n            var row = self._getComponent(\"rows\");\r\n\r\n            if (row) {\r\n                businessKey = row.find(\"[data-business-key='\" + businessKey + \"']\");\r\n                if ($(businessKey).data(\"new-row\")) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        },\r\n\r\n        /**\r\n         * Add inline row\r\n         * @returns {}\r\n         */\r\n        addInlineRow: function () {\r\n            var self = this;\r\n\r\n            // Draw the new row\r\n            self._triggerHandler(\"beforeInlineAdd\");\r\n            var html = self.drawRow(self.createAddRowData(), true);\r\n            var newRow = $(html);\r\n\r\n            // Execute the postrender\r\n            self.postRenderRow(newRow);\r\n\r\n            // Append to rows component\r\n            self._getComponent(\"rows\").append(newRow);\r\n\r\n            var buttons = self._getComponent(\"buttons\");\r\n\r\n            if (self.isOfflineForm) {\r\n                buttons.find(\"[data-action=save]\").removeClass(\"bz-tablet-grid__buttons--hidden\");\r\n                buttons.find(\"[data-action=cancel]\").removeClass(\"bz-tablet-grid__buttons--hidden\");\r\n            } else {\r\n                buttons.find(\"[data-action=save]\").css(\"display\", \"inline-block\");\r\n                buttons.find(\"[data-action=cancel]\").css(\"display\", \"inline-block\");\r\n            }\r\n\r\n            // Show table component if there are no rows\r\n            if (self.data.rows.length === 0) {\r\n                self._getComponent(\"table\").show();\r\n                self._getComponent(\"emptyTable\").hide();\r\n            }\r\n\r\n            self._triggerHandler(\"afterInlineAdd\");\r\n        },\r\n\r\n        /**\r\n         * Creates a dummy data for the new row\r\n         * @returns {}\r\n         */\r\n        createAddRowData: function () {\r\n            var self = this;\r\n            var options = self.options;\r\n            var row = [];\r\n\r\n            $.each(options.columns, function (i) {\r\n\r\n                if (i === self.columnKeyIndex) {\r\n                    // Add random key so we can identify them later\r\n                    var key = Math.ceil(Math.random() * 100000);\r\n                    row.push(key);\r\n                } else {\r\n                    // Add null value\r\n                    row.push(null);\r\n                }\r\n            });\r\n\r\n            return row;\r\n        },\r\n\r\n        /**\r\n         * Executes the on add row handler\r\n         * @returns {}\r\n         */\r\n        onAddRow: function () {\r\n            var self = this;\r\n\r\n            // Allow add\r\n            if (self.options.actions.add) {\r\n                if (self.options.actions.inlineAdd) {\r\n                    return self.addInlineRow();\r\n                } else {\r\n                    // Open dialog with addform\r\n                    return self._triggerHandler(\"addRow\");\r\n                }\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Executes when the user presses the cancel button, after inline add edition\r\n         * @returns {}\r\n         */\r\n        onCancelEdition: function () {\r\n            var self = this;\r\n\r\n            // Remove zero key rows\r\n            var rows = self._getComponent(\"rows\").find(\"[data-new-row=true]\");\r\n            var savedRows = self._getComponent(\"rows\").find(\"[data-new-row=false]\");\r\n            rows.detach();\r\n\r\n            // Hide buttons\r\n            var buttons = self._getComponent(\"buttons\");\r\n\r\n            if (self.isOfflineForm) {\r\n                buttons.find(\"[data-action=save]\").addClass(\"bz-tablet-grid__buttons--hidden\");\r\n                buttons.find(\"[data-action=cancel]\").addClass(\"bz-tablet-grid__buttons--hidden\");\r\n            } else {\r\n                buttons.find(\"[data-action=save]\").hide();\r\n                buttons.find(\"[data-action=cancel]\").hide();\r\n            }\r\n\r\n            // Show table component if there are no rows\r\n            if (savedRows.length === 0) {\r\n                self._getComponent(\"table\").hide();\r\n                self._getComponent(\"emptyTable\").show();\r\n            }\r\n\r\n            return self._triggerHandler(\"cancelEdition\", {keys: self.getNewRowKeys(rows)});\r\n        },\r\n\r\n        /**\r\n         * Executes when the user presses the save button, after inline add edition\r\n         * @returns {}\r\n         */\r\n        onSaveAddedRows: function () {\r\n            var self = this;\r\n\r\n            // Retrieve key of added rows\r\n            var newRowKeys = self.getNewRowKeys();\r\n            var buttons = self._getComponent(\"buttons\");\r\n\r\n            // Hide buttons         \r\n            if (newRowKeys.length >= 1 && self.isValid()) {\r\n\r\n                var row = self._getComponent(\"rows\");\r\n\r\n                if (self.isOfflineForm) {\r\n                    $.each(newRowKeys, function (key, value) {\r\n                        var businessKey = row.find(\"[data-business-key='\" + value + \"']\");\r\n                        $(businessKey).attr(\"data-new-row\", 'false');\r\n                    });\r\n\r\n                    buttons.find(\"[data-action=save]\").addClass(\"bz-tablet-grid__buttons--hidden\");\r\n                    buttons.find(\"[data-action=cancel]\").addClass(\"bz-tablet-grid__buttons--hidden\");\r\n\r\n                    self._triggerHandler(\"saveAddedRows\", {keys: newRowKeys});\r\n\r\n                    return true;\r\n                } else {\r\n                    buttons.find(\"[data-action=save]\").hide();\r\n                    buttons.find(\"[data-action=cancel]\").hide();\r\n\r\n                    self._triggerHandler(\"saveAddedRows\", {keys: newRowKeys});\r\n\r\n                    return self._triggerHandler(\"removeNewRecords\", {keys: newRowKeys});\r\n                }\r\n\r\n            } else {\r\n                return true;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Add new column actions\r\n         * @private\r\n         */\r\n        _addColumnActions: function () {\r\n            var self = this;\r\n            var items = [];\r\n\r\n            if (self.options.actions.details || self.options.columns.length > self.options.maxColumns) {\r\n                items.push({\r\n                    name: bizagi.localization.getResource(\"render-collection-navigator-details-form\"),\r\n                    fn: function (e) {\r\n                        var businessKey = $(e).parents(\"[data-bizagi-component=cells]\").attr(\"data-business-key\");\r\n\r\n                        if (self.options.actions.details) {\r\n                            self.processAction(\"details\", {key: businessKey});\r\n                        } else {\r\n                            self.processAction(\"more\", {key: businessKey});\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n\r\n            if (self.options.actions.edit) {\r\n                items.push({\r\n                    name: bizagi.localization.getResource(\"render-grid-edit-label\"),\r\n                    fn: function (e) {\r\n                        var businessKey = $(e).parents(\"[data-bizagi-component=cells]\").attr(\"data-business-key\");\r\n\r\n                        self.processAction(\"edit\", {key: businessKey});\r\n                    }\r\n                });\r\n            }\r\n\r\n            if (self.options.actions.remove) {\r\n                items.push({\r\n                    name: bizagi.localization.getResource(\"render-ecm-confirm-bt-delete\"),\r\n                    fn: function (e) {\r\n                        var businessKey = $(e).parents(\"[data-bizagi-component=cells]\").attr(\"data-business-key\");\r\n\r\n                        self.processAction(\"remove\", {key: businessKey});\r\n                    }\r\n                });\r\n            }\r\n\r\n            self._getComponent(\"rows\").find(\"[data-action=more]\").overflowMenu({items: items});\r\n        },\r\n\r\n        /**\r\n         * Executes when the user presses the cancel button, after inline add edition\r\n         * @param key\r\n         * @param businessKey\r\n         */\r\n        onRemoveNewRow: function (businessKey) {\r\n            var self = this;\r\n            var buttons = self._getComponent(\"buttons\");\r\n\r\n            // Remove zero key rows\r\n            var cancelNewRow = self._getComponent(\"rows\").find(\"tr[data-business-key=\" + businessKey + \"]\");\r\n            var savedRows = self._getComponent(\"rows\").find(\"[data-new-row=false]\");\r\n            var newRows = self._getComponent(\"rows\").find(\"[data-new-row=true]\");\r\n\r\n            cancelNewRow.detach();\r\n\r\n            // Hide buttons\r\n            if(newRows.length === 1) {\r\n                buttons.find(\"[data-action=save]\").addClass(\"bz-tablet-grid__buttons--hidden\");\r\n                buttons.find(\"[data-action=cancel]\").addClass(\"bz-tablet-grid__buttons--hidden\");\r\n            }\r\n\r\n            // Show table component if there are no rows\r\n            if (savedRows.length === 0) {\r\n                self._getComponent(\"table\").hide();\r\n                self._getComponent(\"emptyTable\").show();\r\n            }\r\n\r\n            return self._triggerHandler(\"cancelEdition\", {keys: self.getNewRowKeys(cancelNewRow)});\r\n        },\r\n\r\n        /**\r\n         * Replaces a matched element in the container for the specified \"replace\" element\r\n         * @param html\r\n         * @param element\r\n         * @param replace\r\n         * @returns {*}\r\n         * @private\r\n         */\r\n        _replaceElement: function (html, element, replace) {\r\n            return html.replace(new RegExp(\"{{element \" + element + \"}}\", 'g'), replace);\r\n        }\r\n\r\n    });\r\n\r\n})(jQuery);\r\n","/*\r\n *   Name: BizAgi Utils\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This class will provide misc helpers to all modules\r\n */\r\n\r\n// Create or Define BizAgi namespace\r\nbizagi = (typeof (bizagi) !== \"undefined\") ? bizagi : {};\r\nbizagi.util = (typeof (bizagi.util) !== \"undefined\") ? bizagi.util : {};\r\nbizagi.context = (typeof (bizagi.context) !== \"undefined\") ? bizagi.context : {};\r\nbizagi.util.smartphone = (typeof (bizagi.util.smartphone) !== \"undefined\") ? bizagi.util.smartphone : {};\r\nbizagi.util.tablet = (typeof (bizagi.util.tablet) !== \"undefined\") ? bizagi.util.tablet : {};\r\n\r\nvar DEVICES = {};\r\n\r\nDEVICES[DEVICES['desktop'] = 0] = 'desktop';\r\nDEVICES[DEVICES['smartphone'] = 1] = 'smartphone';\r\nDEVICES[DEVICES['tablet'] = 2] = 'tablet';\r\n\r\nbizagi.deviceEnum = DEVICES;\r\n\r\n/*\r\n *   Define mini-plugin to acceess iframe's boundaries\r\n */\r\n(function ($) {\r\n    $.fn.callInside = function (fx, args) {\r\n        if ($(this)[0].tagName.toLowerCase() != \"iframe\")\r\n            return null;\r\n        // Don't execute the code when the content window is not ready yet    \r\n        if ($(this)[0].contentWindow == null)\r\n            return null;\r\n        // Check if the iframe is cross domain\r\n        try {\r\n            // Evals the content\r\n            $(this)[0].contentWindow.args = args;\r\n        } catch (e) {\r\n            // If an exception is thrown here this is a cross domain access\r\n            return null;\r\n        }\r\n\r\n        if ($.browser.msie) {\r\n            return $(this)[0].contentWindow.execScript('args = (this.window.args)?this.window.args:{}; insideFunction = ' + fx.toString() + '; insideFunction(args)');\r\n        } else if ($.browser.webkit || $.browser.mozilla) {\r\n            return $(this)[0].contentWindow.eval('args = window.args;insideFunction = ' + fx.toString() + '; insideFunction(args)');\r\n        }\r\n    };\r\n})(jQuery);\r\n(function ($) {\r\n    $.fn.callInsidePopup = function (fx, args) {\r\n        // This is window here\r\n        var self = this;\r\n        $(document).ready(function () {\r\n            // Check if the iframe is cross domain\r\n            try {\r\n                // Evals the content\r\n                $(self)[0].args = args;\r\n            } catch (e) {\r\n                // If an exception is thrown here this is a cross domain access\r\n                return null;\r\n            }\r\n\r\n            if ($.browser.msie) {\r\n                return $(self)[0].execScript('args = (this.window.args)?this.window.args:{}; insideFunction = ' + fx.toString() + '; insideFunction(args)');\r\n            } else if ($.browser.webkit || $.browser.mozilla) {\r\n                return $(self)[0].eval('args = window.args;insideFunction = ' + fx.toString() + '; insideFunction(args)');\r\n            }\r\n\r\n        });\r\n    };\r\n})(jQuery);\r\n(function ($) {\r\n\r\n    // add support for CSS functions for \"setProperty\" in ie8\r\n    var isStyleFuncSupported = !!CSSStyleDeclaration.prototype.getPropertyValue;\r\n    if (!isStyleFuncSupported) {\r\n        CSSStyleDeclaration.prototype.getPropertyValue = function (a) {\r\n            return this.getAttribute(a);\r\n        };\r\n        CSSStyleDeclaration.prototype.setProperty = function (styleName, value, priority) {\r\n            this.setAttribute(styleName, value);\r\n            var priority = typeof priority != 'undefined' ? priority : '';\r\n            if (priority != '') {\r\n                // Add priority manually\r\n                var rule = new RegExp(RegExp.escape(styleName) + '\\\\s*:\\\\s*' + RegExp.escape(value) + '(\\\\s*;)?', 'gmi');\r\n                this.cssText = this.cssText.replace(rule, styleName + ': ' + value + ' !' + priority + ';');\r\n            }\r\n        };\r\n\r\n        CSSStyleDeclaration.prototype.removeProperty = function (a) {\r\n            return this.removeAttribute(a);\r\n        };\r\n\r\n        CSSStyleDeclaration.prototype.getPropertyPriority = function (styleName) {\r\n            var rule = new RegExp(RegExp.escape(styleName) + '\\\\s*:\\\\s*[^\\\\s]*\\\\s*!important(\\\\s*;)?', 'gmi');\r\n            return rule.test(this.cssText) ? 'important' : '';\r\n        };\r\n    }\r\n\r\n    // Escape regex chars with \\\r\n    RegExp.escape = function (text) {\r\n        return text.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, \"\\\\$&\");\r\n    };\r\n\r\n    // The style function\r\n    jQuery.fn.style = function (styleName, value, priority) {\r\n        // DOM node\r\n        var node = this.get(0);\r\n        // Ensure we have a DOM node \r\n        if (typeof node == 'undefined') {\r\n            return;\r\n        }\r\n        // CSSStyleDeclaration\r\n        var style = this.get(0).style;\r\n        // Getter/Setter\r\n        if (typeof styleName != 'undefined') {\r\n            if (typeof value != 'undefined') {\r\n                // Set style property\r\n                var priority = typeof priority != 'undefined' ? priority : '';\r\n                // Hack to IE8\r\n                if (style.setProperty) {\r\n                    style.setProperty(styleName, value, priority);\r\n                } else {\r\n                    style.setAttribute(styleName, value, priority);\r\n                }\r\n            } else {\r\n                // Get style property\r\n\r\n                return style.getPropertyValue(styleName);\r\n            }\r\n        } else {\r\n            // Get CSSStyleDeclaration\r\n            return style;\r\n        }\r\n    };\r\n})(jQuery);\r\n\r\n(function ($) {\r\n    jQuery.nl2br = function (value) {\r\n        return value.replace(/(\\r\\n|\\n\\r|\\r|\\n|\\\\r\\\\n|\\\\n\\\\r|\\\\r|\\\\n)/g, \"<br>\");\r\n    };\r\n})(jQuery);\r\n\r\n\r\n\r\n(function ($) {\r\n    jQuery.br2nl = function (value) {\r\n        return value.replace(/\\r\\n|\\r|\\n/g, \"\\r\");\r\n    };\r\n})(jQuery);\r\n\r\n/**\r\n *   Can be compare control between their intance value and existing value\r\n */\r\n//TODO: DEPL- Please move this out of here, this is rendering logic, it must exists as a function for the render, and every erender could override its implementation\r\n(function ($) {\r\n    jQuery.controlValueIsChanged = function (control) {\r\n        var self = control;\r\n        var properties = self.properties;\r\n        var value = self.getValue();\r\n        var compareValue = properties.originalValue;\r\n        var result = true;\r\n\r\n        // Flag to force to collect data\r\n        if ($.forceCollectData) {\r\n            return true;\r\n        }\r\n\r\n        // Verify if control has been ready\r\n        if (control.properties.type == \"grid\" && control.ready().state() == \"pending\") {\r\n            return false;\r\n        }\r\n\r\n        if ([\"combo\", \"queryCombo\", \"list\", \"queryList\", \"radio\", \"queryRadio\", \"queryState\", ].includes(properties.type) || /^cascadingcombo$/i.test(properties.type)) {\r\n            if (value && value.length !== undefined)\r\n                value = value[0];\r\n            if (compareValue && compareValue.length !== undefined)\r\n                compareValue = compareValue[0];\r\n            value = value && value.id ? value.id : value;\r\n            compareValue = compareValue && compareValue.id ? compareValue.id : compareValue;\r\n            result = (compareValue == value) ? false : true;\r\n        } else if (properties.type == \"boolean\" || properties.type == \"queryBoolean\" || properties.type == \"queryCheck\") {\r\n            result = (bizagi.util.parseBoolean(compareValue) == bizagi.util.parseBoolean(value)) ? false : true;\r\n        } else if (properties.type == \"searchNumber\") {\r\n\r\n            result = (value) ? true : false;\r\n        } else if (properties.type === \"date\") {\r\n            result = (new Date(compareValue).getTime()) !== (new Date(value).getTime());\r\n        } else {\r\n            result = (compareValue === value) ? false : true;\r\n        }\r\n\r\n        return result;\r\n    };\r\n})(jQuery);\r\n\r\n(function ($) {\r\n    jQuery.getMaxZindex = function () {\r\n        var elm = $(\"*\");\r\n        var maxZindex = 1;\r\n\r\n        $.each(elm, function (key, value) {\r\n            var zindex = parseInt($(value).css(\"z-index\"));\r\n            if (zindex > maxZindex) {\r\n                maxZindex = zindex + 1;\r\n            }\r\n\r\n        });\r\n\r\n        return maxZindex;\r\n    }\r\n})(jQuery);\r\n\r\n/**\r\n * Set the same max height to multiples divs\r\n */\r\n(function ($) {\r\n    jQuery.equalizeHeights = function (selector) {\r\n        var heights = new Array();\r\n        // Loop to get all element heights\r\n        $(selector).each(function () {\r\n\r\n            // Need to let sizes be whatever they want so no overflow on resize\r\n            $(this).css('min-height', '0');\r\n            $(this).css('max-height', 'none');\r\n            $(this).css('height', 'auto');\r\n\r\n            // Then add size (no units) to array\r\n            heights.push($(this).outerHeight());\r\n        });\r\n\r\n        // Find max height of all elements\r\n        var max = Math.max.apply(Math, heights);\r\n\r\n        // Set all heights to max height\r\n        $(selector).each(function () {\r\n            $(this).css('height', max + 'px');\r\n        });\r\n    }\r\n})(jQuery);\r\n\r\n//TODO: DEPL - Move this to rendering\r\nbizagi.util.autoSave = function () {\r\n    var deferredSave = $.Deferred();\r\n\r\n    //if attr data-event exist trigger event auto-save or resolve the deferred\r\n    if (bizagi.util.detectDevice() !== \"desktop\") {\r\n        if ($(document).data('auto-save')) {\r\n            $(document).trigger('save-form', [deferredSave]);\r\n        } else {\r\n            deferredSave.resolve();\r\n        }\r\n    } else {\r\n        if ($._data($(document)[0], 'events')[\"save-form\"] && $._data($(document)[0], 'events')[\"save-form\"].length > 0) {\r\n            $(document).trigger('save-form', [deferredSave]);\r\n        } else {\r\n            deferredSave.resolve();\r\n        }\r\n    }\r\n    return deferredSave.promise();\r\n};\r\n//--  **Users Deleted** the name will fill on first reques in UsersPictures\r\nbizagi.util.anonymizedUserInformation = {\r\n    id: \"00000000-0000-0000-0000-000000000000\",\r\n    name: \"\",\r\n    username: \"\",\r\n    email: \"\",\r\n    domain: \"\",\r\n    picture: \"\",\r\n    isAnonymized: true\r\n};\r\n\r\n//-- **Resources for date picker**\r\nbizagi.util.datepickerResource=[];\r\n// taken  from https://github.com/jquery/jquery-ui/tree/master/ui/i18n\r\nbizagi.util.datepickerResource[\"en\"]={ closeText: \"Done\", prevText: \"Prev\",nextText: \"Next\",currentText: \"Today\",monthNames: [ \"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\" ],monthNamesShort: [ \"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\",\"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\" ],dayNames: [ \"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\" ],dayNamesShort: [ \"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\" ],dayNamesMin: [ \"Su\",\"Mo\",\"Tu\",\"We\",\"Th\",\"Fr\",\"Sa\" ],weekHeader: \"Wk\",dateFormat: \"dd/mm/yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"es\"]={ closeText: \"Cerrar\", prevText: \"&#x3C;Ant\",nextText: \"Sig&#x3E;\",currentText: \"Hoy\",monthNames: [ \"enero\",\"febrero\",\"marzo\",\"abril\",\"mayo\",\"junio\",\"julio\",\"agosto\",\"septiembre\",\"octubre\",\"noviembre\",\"diciembre\" ],monthNamesShort: [ \"ene\",\"feb\",\"mar\",\"abr\",\"may\",\"jun\",\"jul\",\"ago\",\"sep\",\"oct\",\"nov\",\"dic\" ],dayNames: [ \"domingo\",\"lunes\",\"martes\",\"miércoles\",\"jueves\",\"viernes\",\"sábado\" ],dayNamesShort: [ \"dom\",\"lun\",\"mar\",\"mié\",\"jue\",\"vie\",\"sáb\" ],dayNamesMin: [ \"D\",\"L\",\"M\",\"X\",\"J\",\"V\",\"S\" ],weekHeader: \"Sm\",dateFormat: \"dd/mm/yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"ar\"]={ closeText: \"إغلاق\", prevText: \"&#x3C;السابق\",nextText: \"التالي&#x3E;\",currentText: \"اليوم\",monthNames: [ \"يناير\", \"فبراير\", \"مارس\", \"أبريل\", \"مايو\", \"يونيو\",\"يوليو\", \"أغسطس\", \"سبتمبر\", \"أكتوبر\", \"نوفمبر\", \"ديسمبر\" ],monthNamesShort: [ \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\" ],dayNames: [ \"الأحد\", \"الاثنين\", \"الثلاثاء\", \"الأربعاء\", \"الخميس\", \"الجمعة\", \"السبت\" ],dayNamesShort: [ \"أحد\", \"اثنين\", \"ثلاثاء\", \"أربعاء\", \"خميس\", \"جمعة\", \"سبت\" ],dayNamesMin: [ \"ح\", \"ن\", \"ث\", \"ر\", \"خ\", \"ج\", \"س\" ],weekHeader: \"أسبوع\",dateFormat: \"dd/mm/yy\",firstDay: 0,isRTL: true,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"cs\"]={ closeText: \"Zavřít\", prevText: \"&#x3C;Dříve\",nextText: \"Později&#x3E;\",currentText: \"Nyní\",monthNames: [ \"leden\",\"únor\",\"březen\",\"duben\",\"květen\",\"červen\",\"červenec\",\"srpen\",\"září\",\"říjen\",\"listopad\",\"prosinec\" ],monthNamesShort: [ \"led\",\"úno\",\"bře\",\"dub\",\"kvě\",\"čer\",\"čvc\",\"srp\",\"zář\",\"říj\",\"lis\",\"pro\" ],dayNames: [ \"neděle\", \"pondělí\", \"úterý\", \"středa\", \"čtvrtek\", \"pátek\", \"sobota\" ],dayNamesShort: [ \"ne\", \"po\", \"út\", \"st\", \"čt\", \"pá\", \"so\" ],dayNamesMin: [ \"ne\",\"po\",\"út\",\"st\",\"čt\",\"pá\",\"so\" ],weekHeader: \"Týd\",dateFormat: \"dd.mm.yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"de\"]={ closeText: \"Schließen\", prevText: \"&#x3C;Zurück\",nextText: \"Vor&#x3E;\",currentText: \"Heute\",monthNames: [ \"Januar\",\"Februar\",\"März\",\"April\",\"Mai\",\"Juni\",\"Juli\",\"August\",\"September\",\"Oktober\",\"November\",\"Dezember\" ],monthNamesShort: [ \"Jan\",\"Feb\",\"Mär\",\"Apr\",\"Mai\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Okt\",\"Nov\",\"Dez\" ],dayNames: [ \"Sonntag\",\"Montag\",\"Dienstag\",\"Mittwoch\",\"Donnerstag\",\"Freitag\",\"Samstag\" ],dayNamesShort: [ \"So\",\"Mo\",\"Di\",\"Mi\",\"Do\",\"Fr\",\"Sa\" ],dayNamesMin: [ \"So\",\"Mo\",\"Di\",\"Mi\",\"Do\",\"Fr\",\"Sa\" ],weekHeader: \"KW\",dateFormat: \"dd.mm.yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"fr\"]={ closeText: \"Fermer\", prevText: \"Précédent\",nextText: \"Suivant\",currentText: \"Aujourd'hui\",monthNames: [ \"janvier\", \"février\", \"mars\", \"avril\", \"mai\", \"juin\",\"juillet\", \"août\", \"septembre\", \"octobre\", \"novembre\", \"décembre\" ],monthNamesShort: [ \"janv.\", \"févr.\", \"mars\", \"avr.\", \"mai\", \"juin\", \"juil.\", \"août\", \"sept.\", \"oct.\", \"nov.\", \"déc.\" ],dayNames: [ \"dimanche\", \"lundi\", \"mardi\", \"mercredi\", \"jeudi\", \"vendredi\", \"samedi\" ],dayNamesShort: [ \"dim.\", \"lun.\", \"mar.\", \"mer.\", \"jeu.\", \"ven.\", \"sam.\" ],dayNamesMin: [ \"D\",\"L\",\"M\",\"M\",\"J\",\"V\",\"S\" ],weekHeader: \"Sem.\",dateFormat: \"dd/mm/yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"it\"]={ closeText: \"Chiudi\", prevText: \"&#x3C;Prec\",nextText: \"Succ&#x3E;\",currentText: \"Oggi\",monthNames: [ \"Gennaio\",\"Febbraio\",\"Marzo\",\"Aprile\",\"Maggio\",\"Giugno\",\"Luglio\",\"Agosto\",\"Settembre\",\"Ottobre\",\"Novembre\",\"Dicembre\" ],monthNamesShort: [ \"Gen\",\"Feb\",\"Mar\",\"Apr\",\"Mag\",\"Giu\",\"Lug\",\"Ago\",\"Set\",\"Ott\",\"Nov\",\"Dic\" ],dayNames: [ \"Domenica\",\"Lunedì\",\"Martedì\",\"Mercoledì\",\"Giovedì\",\"Venerdì\",\"Sabato\" ],dayNamesShort: [ \"Dom\",\"Lun\",\"Mar\",\"Mer\",\"Gio\",\"Ven\",\"Sab\" ],dayNamesMin: [ \"Do\",\"Lu\",\"Ma\",\"Me\",\"Gi\",\"Ve\",\"Sa\" ],weekHeader: \"Sm\",dateFormat: \"dd/mm/yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"ja\"]={ closeText: \"閉じる\", prevText: \"&#x3C;前\",nextText: \"次&#x3E;\",currentText: \"今日\",monthNames: [ \"1月\",\"2月\",\"3月\",\"4月\",\"5月\",\"6月\",\"7月\",\"8月\",\"9月\",\"10月\",\"11月\",\"12月\" ],monthNamesShort: [ \"1月\",\"2月\",\"3月\",\"4月\",\"5月\",\"6月\",\"7月\",\"8月\",\"9月\",\"10月\",\"11月\",\"12月\" ],dayNames: [ \"日曜日\",\"月曜日\",\"火曜日\",\"水曜日\",\"木曜日\",\"金曜日\",\"土曜日\" ],dayNamesShort: [ \"日\",\"月\",\"火\",\"水\",\"木\",\"金\",\"土\" ],dayNamesMin: [ \"日\",\"月\",\"火\",\"水\",\"木\",\"金\",\"土\" ],weekHeader: \"週\",dateFormat: \"yy/mm/dd\",firstDay: 0,isRTL: false,showMonthAfterYear: true,yearSuffix: \"年\" };\r\nbizagi.util.datepickerResource[\"nl\"]={ closeText: \"Sluiten\", prevText: \"←\",nextText: \"→\",currentText: \"Vandaag\",monthNames: [ \"januari\", \"februari\", \"maart\", \"april\", \"mei\", \"juni\",\"juli\", \"augustus\", \"september\", \"oktober\", \"november\", \"december\" ],monthNamesShort: [ \"jan\", \"feb\", \"mrt\", \"apr\", \"mei\", \"jun\",\"jul\", \"aug\", \"sep\", \"okt\", \"nov\", \"dec\" ],dayNames: [ \"zondag\", \"maandag\", \"dinsdag\", \"woensdag\", \"donderdag\", \"vrijdag\", \"zaterdag\" ],dayNamesShort: [ \"zon\", \"maa\", \"din\", \"woe\", \"don\", \"vri\", \"zat\" ],dayNamesMin: [ \"zo\", \"ma\", \"di\", \"wo\", \"do\", \"vr\", \"za\" ],weekHeader: \"Wk\",dateFormat: \"dd-mm-yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"pt\"]={ closeText: \"Fechar\", prevText: \"Anterior\",nextText: \"Seguinte\",currentText: \"Hoje\",monthNames: [ \"Janeiro\",\"Fevereiro\",\"Março\",\"Abril\",\"Maio\",\"Junho\",\"Julho\",\"Agosto\",\"Setembro\",\"Outubro\",\"Novembro\",\"Dezembro\" ],monthNamesShort: [ \"Jan\",\"Fev\",\"Mar\",\"Abr\",\"Mai\",\"Jun\",\"Jul\",\"Ago\",\"Set\",\"Out\",\"Nov\",\"Dez\" ],dayNames: [\"Domingo\",\"Segunda-feira\",\"Terça-feira\",\"Quarta-feira\",\"Quinta-feira\",\"Sexta-feira\",\"Sábado\"],dayNamesShort: [ \"Dom\",\"Seg\",\"Ter\",\"Qua\",\"Qui\",\"Sex\",\"Sáb\" ],dayNamesMin: [ \"Dom\",\"Seg\",\"Ter\",\"Qua\",\"Qui\",\"Sex\",\"Sáb\" ],weekHeader: \"Sem\",dateFormat: \"dd/mm/yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"ru\"]={ closeText: \"Закрыть\", prevText: \"&#x3C;Пред\",nextText: \"След&#x3E;\",currentText: \"Сегодня\",monthNames: [ \"Январь\",\"Февраль\",\"Март\",\"Апрель\",\"Май\",\"Июнь\",\"Июль\",\"Август\",\"Сентябрь\",\"Октябрь\",\"Ноябрь\",\"Декабрь\" ],monthNamesShort: [ \"Янв\",\"Фев\",\"Мар\",\"Апр\",\"Май\",\"Июн\",\"Июл\",\"Авг\",\"Сен\",\"Окт\",\"Ноя\",\"Дек\" ],dayNames: [ \"воскресенье\",\"понедельник\",\"вторник\",\"среда\",\"четверг\",\"пятница\",\"суббота\" ],dayNamesShort: [ \"вск\",\"пнд\",\"втр\",\"срд\",\"чтв\",\"птн\",\"сбт\" ],dayNamesMin: [ \"Вс\",\"Пн\",\"Вт\",\"Ср\",\"Чт\",\"Пт\",\"Сб\" ],weekHeader: \"Нед\",dateFormat: \"dd.mm.yy\",firstDay: 1,isRTL: false,showMonthAfterYear: false,yearSuffix: \"\" };\r\nbizagi.util.datepickerResource[\"zh\"]={ closeText: \"关闭\", prevText: \"&#x3C;上月\",nextText: \"下月&#x3E;\",currentText: \"今天\",monthNames: [ \"一月\",\"二月\",\"三月\",\"四月\",\"五月\",\"六月\",\"七月\",\"八月\",\"九月\",\"十月\",\"十一月\",\"十二月\" ],monthNamesShort: [ \"一月\",\"二月\",\"三月\",\"四月\",\"五月\",\"六月\",\"七月\",\"八月\",\"九月\",\"十月\",\"十一月\",\"十二月\" ],dayNames: [ \"星期日\",\"星期一\",\"星期二\",\"星期三\",\"星期四\",\"星期五\",\"星期六\" ],dayNamesShort: [ \"周日\",\"周一\",\"周二\",\"周三\",\"周四\",\"周五\",\"周六\" ],dayNamesMin: [ \"日\",\"一\",\"二\",\"三\",\"四\",\"五\",\"六\" ],weekHeader: \"周\",dateFormat: \"yy-mm-dd\",firstDay: 1,isRTL: false,showMonthAfterYear: true,yearSuffix: \"年\" };\r\n\r\n//--  **Communication between Workportal and LiveProcesses**\r\n\r\n// Create new Live Process\r\nbizagi.util.liveProcessesEvents = bizagi.util.liveProcessesEvents || {};\r\nbizagi.util.liveProcessesEvents.newLiveProcess = document.createEvent('Event');\r\nbizagi.util.liveProcessesEvents.newLiveProcess.initEvent('new-live-process', true, true);\r\n\r\n// Event for changing route inside LiveProcesses\r\nbizagi.util.liveProcessesEvents.routeEvents = document.createEvent('Event');\r\nbizagi.util.liveProcessesEvents.routeEvents.initEvent('parent-route-events', true, true);\r\nbizagi.util.liveProcessesEvents.routeEvents.route = '/';\r\n\r\n// Verify save condition\r\nbizagi.util.liveProcessesEvents.saveEvent = document.createEvent('Event');\r\nbizagi.util.liveProcessesEvents.saveEvent.initEvent('save-live', true, true);\r\nbizagi.util.liveProcessesEvents.saveEvent.lastWidget = '';\r\nbizagi.util.liveProcessesEvents.saveEvent.nextWidget = '';\r\n\r\nbizagi.util.liveSave = function (widgetName) {\r\n    bizagi.util.liveProcessesEvents.saveEvent.nextWidget = widgetName;\r\n    var deferredLiveSave = $.Deferred();\r\n    var indeX = 0;\r\n    // next try/catch avoids crossdomain messages in the middle of \"Next button\" execution\r\n    try {\r\n        indeX = $(document).find('iframe')[0].contentWindow.location.href.indexOf('quickprocess');\r\n    }\r\n    catch (e) {\r\n        indeX = -1;\r\n    }\r\n    if (\r\n        (widgetName !== bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PROFLY || widgetName === bizagi.util.liveProcessesEvents.saveEvent.lastWidget) &&\r\n        $(document).find('iframe').length > 0 && (indeX > 0)\r\n    ) {\r\n        bizagi.util.liveProcessesEvents.saveEvent.saveLivePromise = deferredLiveSave;\r\n        document.dispatchEvent(bizagi.util.liveProcessesEvents.saveEvent);\r\n    } else {\r\n        deferredLiveSave.resolve();\r\n    }\r\n    $.when(deferredLiveSave).done(function () { bizagi.util.liveProcessesEvents.saveEvent.lastWidget = widgetName })\r\n    return deferredLiveSave.promise();\r\n};\r\n\r\n/**\r\n * CryptoJS MD5\r\n * @param {} message\r\n * @returns {}\r\n */\r\nbizagi.util.md5 = function (message) {\r\n    // Code here will be linted with JSHint.\r\n    /* jshint ignore:start */\r\n    var CryptoJS = CryptoJS || function (s, p) { var m = {}, l = m.lib = {}, n = function () { }, r = l.Base = { extend: function (b) { n.prototype = this; var h = new n; b && h.mixIn(b); h.hasOwnProperty(\"init\") || (h.init = function () { h.$super.init.apply(this, arguments) }); h.init.prototype = h; h.$super = this; return h }, create: function () { var b = this.extend(); b.init.apply(b, arguments); return b }, init: function () { }, mixIn: function (b) { for (var h in b) b.hasOwnProperty(h) && (this[h] = b[h]); b.hasOwnProperty(\"toString\") && (this.toString = b.toString) }, clone: function () { return this.init.prototype.extend(this) } }, q = l.WordArray = r.extend({ init: function (b, h) { b = this.words = b || []; this.sigBytes = h != p ? h : 4 * b.length }, toString: function (b) { return (b || t).stringify(this) }, concat: function (b) { var h = this.words, a = b.words, j = this.sigBytes; b = b.sigBytes; this.clamp(); if (j % 4) for (var g = 0; g < b; g++) h[j + g >>> 2] |= (a[g >>> 2] >>> 24 - 8 * (g % 4) & 255) << 24 - 8 * ((j + g) % 4); else if (65535 < a.length) for (g = 0; g < b; g += 4) h[j + g >>> 2] = a[g >>> 2]; else h.push.apply(h, a); this.sigBytes += b; return this }, clamp: function () { var b = this.words, h = this.sigBytes; b[h >>> 2] &= 4294967295 << 32 - 8 * (h % 4); b.length = s.ceil(h / 4) }, clone: function () { var b = r.clone.call(this); b.words = this.words.slice(0); return b }, random: function (b) { for (var h = [], a = 0; a < b; a += 4) h.push(4294967296 * s.random() | 0); return new q.init(h, b) } }), v = m.enc = {}, t = v.Hex = { stringify: function (b) { var a = b.words; b = b.sigBytes; for (var g = [], j = 0; j < b; j++) { var k = a[j >>> 2] >>> 24 - 8 * (j % 4) & 255; g.push((k >>> 4).toString(16)); g.push((k & 15).toString(16)) } return g.join(\"\") }, parse: function (b) { for (var a = b.length, g = [], j = 0; j < a; j += 2) g[j >>> 3] |= parseInt(b.substr(j, 2), 16) << 24 - 4 * (j % 8); return new q.init(g, a / 2) } }, a = v.Latin1 = { stringify: function (b) { var a = b.words; b = b.sigBytes; for (var g = [], j = 0; j < b; j++) g.push(String.fromCharCode(a[j >>> 2] >>> 24 - 8 * (j % 4) & 255)); return g.join(\"\") }, parse: function (b) { for (var a = b.length, g = [], j = 0; j < a; j++) g[j >>> 2] |= (b.charCodeAt(j) & 255) << 24 - 8 * (j % 4); return new q.init(g, a) } }, u = v.Utf8 = { stringify: function (b) { try { return decodeURIComponent(escape(a.stringify(b))) } catch (g) { throw Error(\"Malformed UTF-8 data\"); } }, parse: function (b) { return a.parse(unescape(encodeURIComponent(b))) } }, g = l.BufferedBlockAlgorithm = r.extend({ reset: function () { this._data = new q.init; this._nDataBytes = 0 }, _append: function (b) { \"string\" == typeof b && (b = u.parse(b)); this._data.concat(b); this._nDataBytes += b.sigBytes }, _process: function (b) { var a = this._data, g = a.words, j = a.sigBytes, k = this.blockSize, m = j / (4 * k), m = b ? s.ceil(m) : s.max((m | 0) - this._minBufferSize, 0); b = m * k; j = s.min(4 * b, j); if (b) { for (var l = 0; l < b; l += k) this._doProcessBlock(g, l); l = g.splice(0, b); a.sigBytes -= j } return new q.init(l, j) }, clone: function () { var b = r.clone.call(this); b._data = this._data.clone(); return b }, _minBufferSize: 0 }); l.Hasher = g.extend({ cfg: r.extend(), init: function (b) { this.cfg = this.cfg.extend(b); this.reset() }, reset: function () { g.reset.call(this); this._doReset() }, update: function (b) { this._append(b); this._process(); return this }, finalize: function (b) { b && this._append(b); return this._doFinalize() }, blockSize: 16, _createHelper: function (b) { return function (a, g) { return (new b.init(g)).finalize(a) } }, _createHmacHelper: function (b) { return function (a, g) { return (new k.HMAC.init(b, g)).finalize(a) } } }); var k = m.algo = {}; return m }(Math); (function (s) { function p(a, k, b, h, l, j, m) { a = a + (k & b | ~k & h) + l + m; return (a << j | a >>> 32 - j) + k } function m(a, k, b, h, l, j, m) { a = a + (k & h | b & ~h) + l + m; return (a << j | a >>> 32 - j) + k } function l(a, k, b, h, l, j, m) { a = a + (k ^ b ^ h) + l + m; return (a << j | a >>> 32 - j) + k } function n(a, k, b, h, l, j, m) { a = a + (b ^ (k | ~h)) + l + m; return (a << j | a >>> 32 - j) + k } for (var r = CryptoJS, q = r.lib, v = q.WordArray, t = q.Hasher, q = r.algo, a = [], u = 0; 64 > u; u++) a[u] = 4294967296 * s.abs(s.sin(u + 1)) | 0; q = q.MD5 = t.extend({ _doReset: function () { this._hash = new v.init([1732584193, 4023233417, 2562383102, 271733878]) }, _doProcessBlock: function (g, k) { for (var b = 0; 16 > b; b++) { var h = k + b, w = g[h]; g[h] = (w << 8 | w >>> 24) & 16711935 | (w << 24 | w >>> 8) & 4278255360 } var b = this._hash.words, h = g[k + 0], w = g[k + 1], j = g[k + 2], q = g[k + 3], r = g[k + 4], s = g[k + 5], t = g[k + 6], u = g[k + 7], v = g[k + 8], x = g[k + 9], y = g[k + 10], z = g[k + 11], A = g[k + 12], B = g[k + 13], C = g[k + 14], D = g[k + 15], c = b[0], d = b[1], e = b[2], f = b[3], c = p(c, d, e, f, h, 7, a[0]), f = p(f, c, d, e, w, 12, a[1]), e = p(e, f, c, d, j, 17, a[2]), d = p(d, e, f, c, q, 22, a[3]), c = p(c, d, e, f, r, 7, a[4]), f = p(f, c, d, e, s, 12, a[5]), e = p(e, f, c, d, t, 17, a[6]), d = p(d, e, f, c, u, 22, a[7]), c = p(c, d, e, f, v, 7, a[8]), f = p(f, c, d, e, x, 12, a[9]), e = p(e, f, c, d, y, 17, a[10]), d = p(d, e, f, c, z, 22, a[11]), c = p(c, d, e, f, A, 7, a[12]), f = p(f, c, d, e, B, 12, a[13]), e = p(e, f, c, d, C, 17, a[14]), d = p(d, e, f, c, D, 22, a[15]), c = m(c, d, e, f, w, 5, a[16]), f = m(f, c, d, e, t, 9, a[17]), e = m(e, f, c, d, z, 14, a[18]), d = m(d, e, f, c, h, 20, a[19]), c = m(c, d, e, f, s, 5, a[20]), f = m(f, c, d, e, y, 9, a[21]), e = m(e, f, c, d, D, 14, a[22]), d = m(d, e, f, c, r, 20, a[23]), c = m(c, d, e, f, x, 5, a[24]), f = m(f, c, d, e, C, 9, a[25]), e = m(e, f, c, d, q, 14, a[26]), d = m(d, e, f, c, v, 20, a[27]), c = m(c, d, e, f, B, 5, a[28]), f = m(f, c, d, e, j, 9, a[29]), e = m(e, f, c, d, u, 14, a[30]), d = m(d, e, f, c, A, 20, a[31]), c = l(c, d, e, f, s, 4, a[32]), f = l(f, c, d, e, v, 11, a[33]), e = l(e, f, c, d, z, 16, a[34]), d = l(d, e, f, c, C, 23, a[35]), c = l(c, d, e, f, w, 4, a[36]), f = l(f, c, d, e, r, 11, a[37]), e = l(e, f, c, d, u, 16, a[38]), d = l(d, e, f, c, y, 23, a[39]), c = l(c, d, e, f, B, 4, a[40]), f = l(f, c, d, e, h, 11, a[41]), e = l(e, f, c, d, q, 16, a[42]), d = l(d, e, f, c, t, 23, a[43]), c = l(c, d, e, f, x, 4, a[44]), f = l(f, c, d, e, A, 11, a[45]), e = l(e, f, c, d, D, 16, a[46]), d = l(d, e, f, c, j, 23, a[47]), c = n(c, d, e, f, h, 6, a[48]), f = n(f, c, d, e, u, 10, a[49]), e = n(e, f, c, d, C, 15, a[50]), d = n(d, e, f, c, s, 21, a[51]), c = n(c, d, e, f, A, 6, a[52]), f = n(f, c, d, e, q, 10, a[53]), e = n(e, f, c, d, y, 15, a[54]), d = n(d, e, f, c, w, 21, a[55]), c = n(c, d, e, f, v, 6, a[56]), f = n(f, c, d, e, D, 10, a[57]), e = n(e, f, c, d, t, 15, a[58]), d = n(d, e, f, c, B, 21, a[59]), c = n(c, d, e, f, r, 6, a[60]), f = n(f, c, d, e, z, 10, a[61]), e = n(e, f, c, d, j, 15, a[62]), d = n(d, e, f, c, x, 21, a[63]); b[0] = b[0] + c | 0; b[1] = b[1] + d | 0; b[2] = b[2] + e | 0; b[3] = b[3] + f | 0 }, _doFinalize: function () { var a = this._data, k = a.words, b = 8 * this._nDataBytes, h = 8 * a.sigBytes; k[h >>> 5] |= 128 << 24 - h % 32; var l = s.floor(b / 4294967296); k[(h + 64 >>> 9 << 4) + 15] = (l << 8 | l >>> 24) & 16711935 | (l << 24 | l >>> 8) & 4278255360; k[(h + 64 >>> 9 << 4) + 14] = (b << 8 | b >>> 24) & 16711935 | (b << 24 | b >>> 8) & 4278255360; a.sigBytes = 4 * (k.length + 1); this._process(); a = this._hash; k = a.words; for (b = 0; 4 > b; b++) h = k[b], k[b] = (h << 8 | h >>> 24) & 16711935 | (h << 24 | h >>> 8) & 4278255360; return a }, clone: function () { var a = t.clone.call(this); a._hash = this._hash.clone(); return a } }); r.MD5 = t._createHelper(q); r.HmacMD5 = t._createHmacHelper(q) })(Math);\r\n    /* jshint ignore:end */\r\n    return CryptoJS.MD5(message).toString();\r\n};\r\n\r\n/**\r\n * Replace all coincidences in a text, based on key value object\r\n *  @argument mapDataToReplace = {\"keyTofind\":\"valueToReplace\",...}\r\n */\r\nbizagi.util.multiReplace = function (text, mapDataToReplace) {\r\n    mapDataToReplace = mapDataToReplace || {};\r\n\r\n    for (var key in mapDataToReplace) {\r\n        var reg = new RegExp(key, \"g\");\r\n        text = text.replace(reg, mapDataToReplace[key]);\r\n    }\r\n    return text;\r\n};\r\n/*\r\n *   Creates a replace all method that is left from the String Class\r\n */\r\nbizagi.util.replaceAll = function (text, pcFrom, pcTo) {\r\n    // Call the method located in bizagi.loader\r\n    return bizagi.replaceAll(text, pcFrom, pcTo);\r\n};\r\n/*\r\n *replaces global expressions regulars\r\n */\r\nbizagi.util.replaceAllGlobalRegExp = function (text, pcFrom, pcTo) {\r\n    var temp = text;\r\n\r\n    var re = new RegExp(pcFrom, \"g\");\r\n    temp = temp.replace(re, pcTo);\r\n\r\n    return temp.toString();\r\n};\r\n// Also append it to the string class\r\nString.prototype.replaceAll = function (pcFrom, pcTo) {\r\n    return bizagi.util.replaceAll(this, pcFrom, pcTo);\r\n};\r\n// Capitalize a string\r\nString.prototype.capitalize = function () {\r\n    return this.charAt(0).toUpperCase() + this.slice(1);\r\n};\r\n// Add this (Create an starts with function) to the string prototype\r\nString.prototype.startsWith = function (str) {\r\n    return this.slice(0, str.length) == str;\r\n};\r\n\r\n/**\r\n * get Initials of a string/name and if the name is empty return the anonymized icon\r\n */\r\nString.prototype.getInitials = function () {\r\n    var initials = \"\";\r\n    if (this.length===0) {\r\n        initials = '<svg  class=\"bz-icon bz-icon-24 bz-icon-svg\"><use xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"#icon-user-deactivated\"></use></svg>';\r\n    } else {\r\n        try {\r\n            var removeRepeatSpaces = this.replace(/  +/g, ' ');\r\n            var words = removeRepeatSpaces.split(' ');\r\n            for (var i = 0; i < words.length; i += 1) {\r\n                initials += words[i][0] || '';\r\n                if (initials.length == 2) {\r\n                    break;\r\n                }\r\n            }\r\n        } catch (e) { }\r\n    \r\n        initials = initials.toUpperCase();\r\n    }\r\n    return initials;\r\n};\r\n\r\nMath.sign = Math.sign || function (x) {\r\n    x = +x; // convert to a number\r\n    if (x === 0 || isNaN(x)) {\r\n        return x;\r\n    }\r\n    return x > 0 ? 1 : -1;\r\n}\r\n\r\n// Add a clone to the object prototype\r\nbizagi.clone = function (obj) {\r\n    return JSON.parse(JSON.encode(obj));\r\n};\r\n// Measures the pixel size of a string\r\nbizagi.measureString = function (string, fontSize) {\r\n    var test = $(\"<span/>\").appendTo(\"body\");\r\n    test.text(string);\r\n    if (fontSize)\r\n        test.css(\"font-size\", fontSize);\r\n    var width = test.width();\r\n    test.detach();\r\n    return width;\r\n};\r\n/*\r\n *   Creates a trim method\r\n */\r\nbizagi.util.trim = function (text) {\r\n    if (typeof (text) === \"undefined\" || text == null)\r\n        return text;\r\n    // Call the method located in bizagi.loader\r\n    return text.replace(/^\\s\\s*/, '').replace(/\\s\\s*$/, '');\r\n};\r\n// Create an ends with function\r\nString.prototype.endsWith = function (suffix) {\r\n    return this.indexOf(suffix, this.length - suffix.length) !== -1;\r\n};\r\n\r\n/*\r\n * Method to detect IE7 visitors\r\n */\r\nbizagi.util.isIE7 = function () {\r\n    return bizagi.util.isIE() && document.documentMode == 7;\r\n};\r\n/*\r\n * Method to detect IE8 visitors\r\n */\r\nbizagi.util.isIE8 = function () {\r\n    return bizagi.util.isIE() && document.documentMode == 8;\r\n};\r\n/*\r\n * Method to detect IE9 visitors\r\n */\r\nbizagi.util.isIE9 = function () {\r\n    return bizagi.util.isIE() && document.documentMode == 9;\r\n};\r\n/*\r\n * Method to detect IE10 visitors\r\n */\r\nbizagi.util.isIE10 = function () {\r\n    return bizagi.util.isIE() && document.documentMode == 10;\r\n};\r\n/*\r\n * Method to detect IE11 visitors\r\n */\r\nbizagi.util.isIE11 = function () {\r\n    return !!navigator.userAgent.match(/Trident\\/7.0/) && !navigator.userAgent.match(/MSIE/i);\r\n};\r\n\r\n/*\r\n * Method to detect IE11 or lower\r\n */\r\nbizagi.util.isIE11OrLower = function () {\r\n    return bizagi.util.isIE11() || bizagi.util.isIE10() || bizagi.util.isIE9() || bizagi.util.isIE8() || bizagi.util.isIE7();\r\n};\r\n\r\n/*\r\n * Method to detect IE10 or lower\r\n */\r\nbizagi.util.isIE10OrLower = function () {\r\n    return bizagi.util.isIE10() || bizagi.util.isIE9() || bizagi.util.isIE8() || bizagi.util.isIE7();\r\n};\r\n\r\n/*\r\n * Method to detect IE12 or Edge(Windows 10) visitors\r\n */\r\nbizagi.util.isEdge = function () {\r\n    if (/Edge\\/*./i.test(navigator.userAgent)) {\r\n        return true;\r\n    }\r\n    return false;\r\n};\r\n/*\r\n * Method to detect IE visitors\r\n */\r\nbizagi.util.isIE = function () {\r\n    return (navigator.appName.indexOf(\"Internet Explorer\") > 0 || !!navigator.userAgent.match(/Trident/));\r\n};\r\n/*\r\n * Get the specific version of IE \r\n */\r\nbizagi.util.getIEVersion = function () {\r\n    var sAgent = window.navigator.userAgent;\r\n    var indexMSIE = sAgent.indexOf(\"MSIE\");\r\n    var version = 0;\r\n    if (indexMSIE > 0) {\r\n        version = parseInt(sAgent.substring(indexMSIE + 5, sAgent.indexOf(\".\", indexMSIE)));\r\n    } else\r\n        if (!!navigator.userAgent.match(/Trident/) || window.navigator.userAgent.indexOf(\"Edge\") > -1) { // Condition Check IF IE 11 and or MS Edge\r\n            version = 11;\r\n        }\r\n    return version;\r\n};\r\n/*\r\n * Method to detect is chrome browser\r\n */\r\nbizagi.util.isChrome = function () {\r\n    return /Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor);\r\n};\r\n/*\r\n * Method to detect is Firefox browser\r\n */\r\nbizagi.util.isFirefox = function(minVersion) {\r\n    function getVersion() {\r\n        var ua=navigator.userAgent,tem,M=ua.match(/(opera|chrome|safari|firefox|msie|trident(?=\\/))\\/?\\s*(\\d+)/i) || []; \r\n        if(/trident/i.test(M[1])){\r\n            tem=/\\brv[ :]+(\\d+)/g.exec(ua) || []; \r\n            return {name:'IE',version:(tem[1]||'')};\r\n            }   \r\n        if(M[1]==='Chrome'){\r\n            tem=ua.match(/\\bOPR|Edge\\/(\\d+)/)\r\n            if(tem!=null)   {return {name:'Opera', version:tem[1]};}\r\n            }   \r\n        M=M[2]? [M[1], M[2]]: [navigator.appName, navigator.appVersion, '-?'];\r\n        if((tem=ua.match(/version\\/(\\d+)/i))!=null) {M.splice(1,1,tem[1]);}\r\n        return {\r\n          name: M[0],\r\n          version: M[1]\r\n        };   \r\n    }\r\n    return /Firefox/.test(navigator.userAgent) && (minVersion===undefined || minVersion<=getVersion().version);\r\n};\r\n/*\r\n * return the browser name this function can be modified if needs more browsers\r\n */\r\nbizagi.util.getBrowser = function() {\r\n    var bw=\"undetected\";\r\n    if(bizagi.util.isChrome()){\r\n        bw=\"chrome\";\r\n    }else if(bizagi.util.isFirefox()){\r\n        bw=\"firefox\";\r\n    }else if(bizagi.util.isEdge()){\r\n        bw=\"edge\";\r\n    }else if(bizagi.util.isIE11()){\r\n        bw=\"ie11\";\r\n    \r\n    }else if(bizagi.util.isIE10()){\r\n        bw=\"ie10\";\r\n    }\r\n    return bw;\r\n};\r\n\r\n/**\r\n * Empty Navigator Info\r\n */\r\nbizagi.util.emptyNavigatorInfo = function() {\r\n    if (bizagi.navigator && bizagi.navigator.info) {\r\n        bizagi.navigator.info={};\r\n    }\r\n};\r\n\r\n/**\r\n * Auto call setting the browser class for css specific selectors, etc..\r\n */\r\n$( document ).ready(function() {\r\n    $(\"html\").addClass(\"browser-\"+bizagi.util.getBrowser());\r\n    if (bizagi.language) {\r\n        var language=bizagi.language.split(\"-\");\r\n        if (language && language.length>0) {\r\n            $(\"html\").addClass(\"language-\"+language[0]);\r\n        }\r\n    }\r\n  });\r\n\r\n\r\n\r\n\r\n/**\r\n * Method to detect iOS version X and apply styles to that device \r\n */\r\nbizagi.util.setIphoneXOverrides = function () {\r\n    if (bizagi.util.isNativePluginSupported() && typeof (bizagiapp.isIphoneX) !== 'undefined') {\r\n        bizagiapp.isIphoneX(function (value) {\r\n            var flagIphoneX = value;\r\n            var styleIphoneX = \".bz-menu-home .bz-menu-carousel .bz-menu-carousel-seat{padding:0 16px 16px}.bz-home-header .km-navbar{padding:35px 16px 5px}#menuHome .bz-home-header .km-navbar{padding:30px 3px 0}#menuHome .km-navbar .km-rightitem{font-size:19px;right:.4em;top:32px}#menuHome .km-navbar .km-leftitem{font-size:24px;left:0;top:25px}#taskFeed .km-navbar .km-rightitem{font-size:19px;top:25px;right:0}#taskFeed .km-navbar .km-leftitem{font-size:24px;top:20px;left:0}#homePortal #menuHome .km-view-title .km-buttongroup{margin-left:0;top:2px}.bz-render-header,.search-container{padding-top:25px}#activity-search,.search-container .bz-wp-mu-button-search{padding-top:40px}#content-newCase-drawer{padding-top:25px}#menuHome{background:#EBEDF1!important}.km-flat .km-content{background-color:#fff} .k-loading-mask{top:0!important}\";\r\n\r\n            if (flagIphoneX === 'true') {\r\n                $('head').append('<style type=\"text/css\" id=\"iphoneXStyle\"></style>');\r\n                $('#iphoneXStyle').text(styleIphoneX);\r\n\r\n            } else if (bizagi.util.isiOSDevice()) {\r\n                $('head').append('<style type=\"text/css\" id=\"iphoneStyle\"></style>');\r\n                var paddingStyle = \"#homePortal .bz-home-header > div{padding-top:.8em}\";\r\n                $('#iphoneStyle').text(paddingStyle);\r\n            }\r\n        });\r\n    }\r\n};\r\n\r\nbizagi.util.isString = function (value) {\r\n    return Object.prototype.toString.apply(value) === \"[object String]\";\r\n};\r\n\r\nbizagi.util.isObject = function (value) {\r\n    return Object.prototype.toString.apply(value) === \"[object Object]\";\r\n};\r\n\r\nbizagi.util.isArray = function (value) {\r\n    return Array.isArray(value);\r\n};\r\nbizagi.util.isNull = function (value) {\r\n    return Object.prototype.toString.apply(value) === \"[object Null]\";\r\n};\r\nbizagi.util.isBoolean = function (value) {\r\n    return Object.prototype.toString.apply(value) === \"[object Boolean]\";\r\n};\r\n\r\n/*\r\n *   Method to detect IE version\r\n */\r\nbizagi.util.getInternetExplorerVersion = function () {\r\n    if (!bizagi.util.isIE())\r\n        return -1;\r\n    return Number(document.documentMode);\r\n};\r\n/*  \r\n *   Detect a device based on the width\r\n */\r\nbizagi.util.detectDevice = function () {\r\n    // Call the method located in bizagi.loader\r\n    return bizagi.detectDevice();\r\n};\r\n\r\n// Check if a string is number\r\nbizagi.util.isNumeric = function (n) {\r\n    return !isNaN(parseFloat(n)) && isFinite(n);\r\n};\r\n\r\n// Check if a string is GUID\r\nbizagi.util.isGUID = function (n) {\r\n    return /^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(n);\r\n};\r\n// Throw not implemented exception\r\nbizagi.util.mustImplement = function (notImplementedMethod) {\r\n    try {\r\n        console.log(\"Not implemented exception: \" + notImplementedMethod);\r\n    } catch (exe) { //IE console variable not exist\r\n    }\r\n    //throw \"You must implement \" + notImplementedMethod;\r\n};\r\n// Encodes the xpath \r\nbizagi.util.encodeXpath = function (xpath) {\r\n    if (bizagi.util.isEmpty(xpath) || typeof xpath.replaceAll === \"undefined\")\r\n        return \"\";\r\n    return xpath.replaceAll(\".\", \"_\").replaceAll(\"=\", \"_\").replaceAll(\"[\", \"_\").replaceAll(\"]\", \"_\");\r\n};\r\n// Parses a value to return the correct boolean value\r\nbizagi.util.parseBoolean = function (value) {\r\n    if (value === undefined) {\r\n        return null;\r\n    }\r\n\r\n    if (value === null) {\r\n        return null;\r\n    }\r\n\r\n    if (value === '') {\r\n        return null;\r\n    }\r\n\r\n    // Parse true values\r\n    if (value === true || value === 1 || value.toString() === \"true\" || value === \"1\") {\r\n        return true;\r\n    }\r\n    if (value.toString().toLowerCase() === \"true\") {\r\n        return true;\r\n    }\r\n\r\n    // Parse false values\r\n    if ((value !== null && value === false) || value === 0 || value.toString() === \"false\" || value === \"0\") {\r\n        return false;\r\n    }\r\n    if (value.toString().toLowerCase() === \"false\") {\r\n        return false;\r\n    }\r\n\r\n    return null;\r\n};\r\n/*\r\n *   Checks if a given string is empty\r\n */\r\nbizagi.util.isEmpty = function (value) {\r\n    if (value === 0)\r\n        return false;\r\n\r\n    if (value === undefined || value === null || value === \"\") {\r\n        return true;\r\n    }\r\n\r\n    if (typeof (value) === \"Array\") {\r\n        return value.length == 0;\r\n    }\r\n\r\n    if (Object.prototype.toString.apply(value) === \"[object Array]\") {\r\n        return value.length === 0;\r\n    }\r\n\r\n    if (Object.prototype.toString.apply(value) === \"[object Object]\") {\r\n        if ($.isEmptyObject(value)) {\r\n            return true;\r\n        } else {\r\n            return bizagi.util.isEmptyCombo(value);\r\n        }\r\n    }\r\n\r\n    // Side effect - I can't delete the last item in the multiselect and searchlist\r\n   /* if (value == \"{\\\"value\\\":[]}\"){\r\n        return true;\r\n    }  */\r\n\r\n    return false;\r\n};\r\n\r\nbizagi.util.isEmptyCombo = function (object) {\r\n    if (Object.prototype.toString.apply(object) === \"[object Object]\") {\r\n        var property, id = false,\r\n            value = false,\r\n            other = false;\r\n        for (property in object) {\r\n            if (object.hasOwnProperty(property)) {\r\n                if (property === \"id\") {\r\n                    id = true;\r\n                } else {\r\n                    if (property === \"value\") {\r\n                        value = true;\r\n                    } else {\r\n                        other = true;\r\n                    }\r\n                }\r\n                if (other) {\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n        if (id) {\r\n            if (object[\"id\"] === \"\") {\r\n                return true;\r\n            } else {\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n    return undefined;\r\n};\r\n\r\n/**\r\n * Decode data from encodeURI charset\r\n */\r\nbizagi.util.decodeURI = function (value) {\r\n    value = value || \"\";\r\n    var finishDecoded = false;\r\n    var decodedValue = value;\r\n    var infinityControl;\r\n\r\n    // Try to decode data value\r\n    while (!finishDecoded) {\r\n        try {\r\n            infinityControl = decodeURI(decodedValue);\r\n            if (bizagi.util.hasNonVisibleChars(infinityControl)) {\r\n                decodedValue = value;\r\n                break;\r\n            }\r\n            if (infinityControl == decodedValue) {\r\n                finishDecoded = true;\r\n            } else {\r\n                decodedValue = infinityControl;\r\n            }\r\n        } catch (e) {\r\n            finishDecoded = true;\r\n        }\r\n    }\r\n\r\n    return decodedValue;\r\n};\r\n\r\nbizagi.util.hasNonVisibleChars = function (value) {\r\n    value = value || \"\";\r\n    var length = value.length;\r\n    var i = 0,\r\n        result = false,\r\n        ch;\r\n    for (; i < length;) {\r\n        ch = value.charCodeAt(i++);\r\n        if (ch < 32 || ch > 126) {\r\n            result = true;\r\n            break;\r\n        }\r\n    }\r\n    return result;\r\n};\r\n\r\n/* \r\n *   Converts a percent into a number\r\n */\r\nbizagi.util.percent2Number = function (value) {\r\n    return Number(String(value).replace(\"%\", \"\"));\r\n};\r\n/*\r\n *   Check if a object is empty\r\n */\r\nbizagi.util.isObjectEmpty = function (obj) {\r\n    if (obj.length > 0)\r\n        return false;\r\n    return true;\r\n};\r\n/*\r\n *   Check if a map object is empty\r\n */\r\nbizagi.util.isMapEmpty = function (map) {\r\n    // First we validate a special case\r\n    if (map.length == 1 && map[0].length == 0)\r\n        return true;\r\n    // Then we do normal validation\r\n    for (var key in map) {\r\n        if (map.hasOwnProperty(key)) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n};\r\n/*\r\n *   Replaces a matched selector in the container for the specified \"replace\" element\r\n */\r\nbizagi.util.replaceSelector = function (container, selector, replace) {\r\n    // Replace children tag\r\n    var elementToReplace = $(selector, container);\r\n    if (elementToReplace.length > 0) {\r\n        elementToReplace.append(replace);\r\n        elementToReplace.children().unwrap();\r\n    }\r\n};\r\n/*\r\n *   Determines if a control as a scrollbar \r\n */\r\nbizagi.util.hasScroll = function (el, direction) {\r\n    if (el.length)\r\n        el = el[0];\r\n    direction = (direction === 'vertical') ? 'scrollTop' : 'scrollLeft';\r\n    var result = !!el[direction];\r\n    if (!result) {\r\n        el[direction] = 1;\r\n        result = !!el[direction];\r\n        el[direction] = 0;\r\n    }\r\n    return result;\r\n};\r\n\r\n//TODO: DEPL - Rename this to areIdenticalObjects\r\nbizagi.util.identicalObjects = function (obj1, obj2) {\r\n    var self = this;\r\n\r\n    if (typeof (obj1) !== typeof (obj2)) {\r\n        return false;\r\n    }\r\n\r\n    if (typeof (obj1) === \"function\") {\r\n        return obj1.toString() === obj2.toString();\r\n    }\r\n\r\n    if (obj1 instanceof Object && obj2 instanceof Object) {\r\n\r\n        // Count properties\r\n        if (bizagi.util.countProps(obj1) !== bizagi.util.countProps(obj2)) {\r\n            return false;\r\n        }\r\n\r\n        var r = true;\r\n        for (k in obj1) {\r\n            r = bizagi.util.identicalObjects(obj1[k], obj2[k]);\r\n            if (!r) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    } else {\r\n        return obj1 === obj2;\r\n    }\r\n};\r\n\r\nbizagi.util.countProps = function (obj) {\r\n    var count = 0;\r\n    for (k in obj) {\r\n        if (obj.hasOwnProperty(k)) {\r\n            count++;\r\n        }\r\n    }\r\n    return count;\r\n};\r\n/*\r\n *   Determines if a element has visibility\r\n */\r\nbizagi.util.isScrolledIntoView = function (elem, layout) {\r\n    if (elem == undefined) {\r\n        return false;\r\n    }\r\n\r\n    layout = layout || $(window);\r\n    var scrollTop = layout.scrollTop();\r\n    var elemTop = $(elem).offset().top;\r\n    var elemBottom = elemTop + $(elem).height();\r\n    var docViewBottom = scrollTop + $(layout).height();\r\n    return ((elemBottom <= docViewBottom) && (elemTop >= scrollTop));\r\n};\r\nbizagi.util.centerElementIntoScroll = function (elem, layout) {\r\n    if (elem == undefined) {\r\n        return false;\r\n    }\r\n\r\n    layout = layout || $(window);\r\n    var actualScroll = layout.scrollTop();\r\n    var elementTop = $(elem).offset().top;\r\n    var elementHeight = $(elem).height();\r\n    var offset = 0;\r\n    if (elementTop > 0) {\r\n        offset = elementTop + elementHeight;\r\n    } else {\r\n        offset = elementTop - elementHeight;\r\n    }\r\n    var newTop = actualScroll + offset;\r\n    layout.scrollTop(newTop);\r\n};\r\n/*\r\n *   Encode a html string\r\n */\r\nbizagi.util.encodeHtml = function (text) {\r\n    if (text === undefined || text === null) {\r\n        return \"\";\r\n    }\r\n    if (typeof (text) == \"string\") {\r\n        return text.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');\r\n    }\r\n    return text;\r\n};\r\n\r\n/*\r\n *   Encode a string as HTML\r\n */\r\nbizagi.util.decodeHtmlEntities = function (text) {\r\n    if (text === undefined || text === null) {\r\n        return \"\";\r\n    }\r\n    if (typeof (text) == \"string\") {\r\n        return text.replace(/&apos;/g, '\"').replace(/&lt;/g, '<').replace(/&gt;/g, '>').replace(/&quot;/g, '\\'');\r\n    }\r\n    return text;\r\n};\r\n/*\r\n *   Read the location hash\r\n */\r\nbizagi.util.getHashParams = function () {\r\n    var params = window.location.hash.substring(1).split(\"#\");\r\n    return params;\r\n};\r\n/*\r\n *   Loads a file on-demand\r\n */\r\nbizagi.util.loadFile = function (params) {\r\n    var defer = new $.Deferred();\r\n    var url = params && params.src ? params.src : params;\r\n    var type = params && params.type ? params.type : null;\r\n\r\n    bizagi.loader.loadFile({ src: url, type: type })\r\n        .then(function () {\r\n            defer.resolve();\r\n        });\r\n\r\n    return defer.promise();\r\n};\r\n\r\n/*\r\n *   Initializes a webpart on-demand\r\n */\r\nbizagi.util.initWebpart = function (webpart, device) {\r\n    var defer = new $.Deferred();\r\n\r\n    device = device || bizagi.detectDevice();\r\n\r\n    if (webpart.initialized) {\r\n        // If already initialized resolve the deferred\r\n        defer.resolve();\r\n    } else {\r\n\r\n        if (webpart.initializing) {\r\n            $.when(webpart.loadingDeferred.promise())\r\n                .done(function () {\r\n                    defer.resolve();\r\n                });\r\n        } else {\r\n\r\n            webpart.loadingDeferred = new $.Deferred();\r\n            webpart.initializing = true;\r\n            bizagi.loader.initWebpart(webpart, device, function () {\r\n\r\n                // Resolve deferreds\r\n                webpart.loadingDeferred.resolve();\r\n                webpart.initializing = false;\r\n                defer.resolve();\r\n            });\r\n        }\r\n    }\r\n\r\n    return defer.promise();\r\n};\r\n/*\r\n *   Read the query string parameteres\r\n */\r\nbizagi.util.getQueryString = function (url) {\r\n    var params = {};\r\n    url = url || window.location.href;\r\n    var query = url.indexOf(\"?\") > 0 ? url.substring(url.indexOf(\"?\") + 1) : \"\";\r\n    var pairs = query.split(\"&\");\r\n    for (var i = pairs.length - 1; i >= 0; i--) {\r\n        var pos = pairs[i].indexOf('=');\r\n        if (pos == -1)\r\n            continue;\r\n        var argname = pairs[i].substring(0, pos);\r\n        var value = pairs[i].substring(pos + 1);\r\n        params[argname] = unescape(value);\r\n    }\r\n    return params;\r\n};\r\n/*\r\n *   Extend querystring\r\n */\r\nbizagi.util.extendQueryString = function (url, additionalParams) {\r\n    var plainUrl = url.indexOf(\"?\") > 0 ? url.substring(0, url.indexOf(\"?\")) : url;\r\n    var existingParams = bizagi.util.getQueryString(url);\r\n    var newParams = $.extend({}, existingParams, additionalParams);\r\n    return plainUrl + \"?\" + $.param(newParams);\r\n};\r\nbizagi.util.getStackTrace = function () {\r\n    var callstack = [];\r\n    var isCallstackPopulated = false;\r\n    try {\r\n        i.dont.exist += 0; //doesn't exist- that's the point\r\n    } catch (e) {\r\n        if (e.stack) { //Firefox\r\n            var lines = e.stack.split('\\n');\r\n            for (var i = 0, len = lines.length; i < len; i++) {\r\n                if (lines[i].match(/^\\s*[A-Za-z0-9\\-_\\$]+\\(/)) {\r\n                    callstack.push(lines[i]);\r\n                }\r\n            }\r\n            //Remove call to printStackTrace()\r\n            callstack.shift();\r\n            isCallstackPopulated = true;\r\n        } else if (window.opera && e.message) { //Opera\r\n            var lines = e.message.split('\\n');\r\n            for (var i = 0, len = lines.length; i < len; i++) {\r\n                if (lines[i].match(/^\\s*[A-Za-z0-9\\-_\\$]+\\(/)) {\r\n                    var entry = lines[i];\r\n                    //Append next line also since it has the file info\r\n                    if (lines[i + 1]) {\r\n                        entry += ' at ' + lines[i + 1];\r\n                        i++;\r\n                    }\r\n                    callstack.push(entry);\r\n                }\r\n            }\r\n            //Remove call to printStackTrace()\r\n            callstack.shift();\r\n            isCallstackPopulated = true;\r\n        }\r\n    }\r\n    if (!isCallstackPopulated) { //IE and Safari\r\n        var currentFunction = arguments.callee.caller;\r\n        while (currentFunction) {\r\n            var fn = currentFunction.toString();\r\n            var fname = fn.substring(fn.indexOf(\"function\") + 8, fn.indexOf('')) || 'anonymous';\r\n            callstack.push(fname);\r\n            currentFunction = currentFunction.caller;\r\n        }\r\n    }\r\n    return callstack;\r\n};\r\n/*\r\n *\thighlight elements\r\n */\r\nbizagi.util.highLightElement = function (el) {\r\n    el.addClass('ui-highlight-control');\r\n    $.when(\r\n        setTimeout(function () {\r\n            el.addClass('ui-highlight-off-control');\r\n        }, 450)\r\n    ).done(\r\n        setTimeout(function () {\r\n            el.removeClass('ui-highlight-control ui-highlight-off-control');\r\n        }, 800));\r\n}\r\n/*\r\n *\tscroll to bottom\r\n */\r\nbizagi.util.autoScrollBottom = function (el) {\r\n    try {\r\n        var elScrollHeight;\r\n        elScrollHeight = el[0].scrollHeight;\r\n        el.scrollTop(elScrollHeight);\r\n    } catch (e) { }\r\n}\r\n\r\n/*create auto scroll with limit top and limit bottom */\r\nbizagi.util.autoScrollInterval = { init: false };\r\nbizagi.util.autoScroll = function (itemScroll, limitTop, limitBottom, idInterval) {\r\n    var outSide = false;\r\n    /* prevent a previous interval */\r\n    clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n    bizagi.util.autoScrollInterval[idInterval] = 0;\r\n    bizagi.util.autoScrollInterval['init'] = true;\r\n    $('body').addClass('autoscroll');\r\n    $('body.autoscroll').mousemove(function (event) {\r\n        if (event.pageY < limitTop) {\r\n            if (!outSide) {\r\n                outSide = true;\r\n                bizagi.util.autoScrollTopInterval(itemScroll, 'autoscroll', idInterval);\r\n            }\r\n        } else if (event.pageY > limitBottom) {\r\n            if (!outSide) {\r\n                outSide = true;\r\n                bizagi.util.autoScrollBottomInterval(itemScroll, 'autoscroll', idInterval);\r\n            }\r\n        } else {\r\n            clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n            outSide = false;\r\n        }\r\n    });\r\n}\r\n/*create auto scroll movement top */\r\nbizagi.util.autoScrollTopInterval = function (itemScroll, classCSS, idInterval) {\r\n    clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n    if (classCSS) {\r\n        $('body').addClass(classCSS);\r\n    }\r\n    if (itemScroll.scrollTop() == 0) {\r\n        clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n    } else {\r\n        clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n        bizagi.util.autoScrollInterval[idInterval] = setInterval(function () {\r\n            if (itemScroll.scrollTop() > 0) {\r\n                itemScroll.scrollTop(itemScroll.scrollTop() - 40);\r\n            } else {\r\n                clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n            }\r\n        }, 100);\r\n    }\r\n}\r\n\r\n/*create auto scroll movement bottom */\r\nbizagi.util.autoScrollBottomInterval = function (itemScroll, classCSS, idInterval) {\r\n    clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n    if (classCSS) {\r\n        $('body').addClass(classCSS);\r\n    }\r\n    var valueMaxScrollBottom = $(itemScroll)[0].scrollHeight - $(itemScroll).innerHeight();\r\n    if (itemScroll.scrollTop() >= valueMaxScrollBottom) {\r\n        clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n    } else {\r\n        clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n        bizagi.util.autoScrollInterval[idInterval] = setInterval(function () {\r\n            bizagi.util.autoScrollBottom($('html'));\r\n            if (itemScroll.scrollTop() < valueMaxScrollBottom) {\r\n                itemScroll.scrollTop(itemScroll.scrollTop() + 40);\r\n            } else {\r\n                clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n            }\r\n        }, 100);\r\n    }\r\n};\r\n/*remove auto scroll*/\r\nbizagi.util.removeAutoScroll = function (classCSS, idInterval) {\r\n    $('body.' + classCSS).unbind('mousemove').removeClass(classCSS);\r\n    clearInterval(bizagi.util.autoScrollInterval[idInterval]);\r\n    bizagi.util.autoScrollInterval.init = false;\r\n};\r\n\r\nbizagi.util.getMaxZIndex = function (selector) {\r\n    selector = selector || $(\"div,span\");\r\n    return Math.max.apply(null, $(selector).map(function () {\r\n        var zIndex;\r\n        return isNaN(zIndex = parseInt($(this).css(\"z-index\"), 10)) ? 0 : zIndex;\r\n    }));\r\n};\r\n\r\n/*\r\n * Creates a native popup to open an url\r\n */\r\nbizagi.showPopup = function (url, params, callbackFn) {\r\n    var width = params.width || 1024;\r\n    var height = params.height || 768;\r\n    var top = $(window).height() / 2 - height / 2;\r\n    var left = $(window).width() / 2 - width / 2;\r\n    // Creates a popup window\r\n    var newWindow = window.open(url, \"\", \"width=\" + width + \",height=\" + height + \", top=\" + top + \", left=\" + left + \", Menubar=NO, Location=NO, Status=NO, scrollbars=YES\");\r\n    // Define args to call the function\r\n    window.BAPopupWindow = newWindow;\r\n    window.BAPopupCallback = callbackFn;\r\n    // Define BACLoseWindow in this context, so the external content calls window.opener.BACloseWindow\r\n    window.BACloseWindow = function (controls, submitForm) {\r\n        // Close dialog\r\n        window.BAPopupWindow.close();\r\n        // Executes the callback to assign values and submit form (if requested)\r\n        window.BAPopupCallback(controls, submitForm);\r\n    };\r\n};\r\n/**\r\n * Creates a native popup in quirks mode to open an url\r\n * \r\n * @param url string page to open into popup\r\n * @param params json {width,height,title,afterLoad}\r\n */\r\nbizagi.showQuirksModePopup = function (url, params) {\r\n    var quirksModePage = window.BIZAGI_PATH_TO_BASE + \"quirks.html\";\r\n    var width = params.width || 1024;\r\n    var height = params.height || 768;\r\n    var top = $(window).height() / 2 - height / 2;\r\n    var left = $(window).width() / 2 - width / 2;\r\n    // Creates a popup window\r\n    var newWindow = window.open(quirksModePage, \"bizagiPopup\", \"width=\" + width + \",height=\" + height + \", top=\" + top + \", left=\" + left + \", Menubar=NO, Location=NO, Status=NO, scrollbars=YES\");\r\n    window.BAQuirksPopupWindow = newWindow;\r\n    // Attempto to set a window title\r\n    setTimeout(function () {\r\n        try {\r\n            newWindow.document.title = params.title;\r\n        } catch (e) { }\r\n    }, 50);\r\n    // We use a hack to eval content inside the popup\r\n    $(newWindow).callInsidePopup(function (windowParams) {\r\n\r\n        var $ = windowParams.jQuery;\r\n        var popupWindow = windowParams.popupWindow;\r\n        popupWindow.quirksOnLoad = function () {\r\n            var loadedBody = $(\"body\", popupWindow.document);\r\n            var iframe = $(\"iframe\", loadedBody);\r\n            // Remove waiting\r\n            loadedBody.removeClass(\"ui-bizagi-loading-message\");\r\n            iframe.show();\r\n            // Hacks the iframe\r\n            // This event will fire each time the iframe change its location\r\n            var afterLoad = windowParams.userParams.afterLoad;\r\n            if (afterLoad && afterLoad != null) {\r\n                var callbackParams = $.extend(windowParams.userParams, {\r\n                    popupWindow: popupWindow\r\n                });\r\n                iframe.callInside(afterLoad, callbackParams);\r\n            }\r\n        };\r\n        var loadingFunction = function () {\r\n            var body = $(\"body\", popupWindow.document);\r\n            // Create the iframe inside the new window\r\n            if (body.length > 0) {\r\n                body.append(\"<iframe scrolling='yes' id='innerFrameContent' src='\" + windowParams.url + \"' style='width: 100%; height: 100%; display:none' frameborder='0' onload='quirksOnLoad();'></iframe>\");\r\n            } else {\r\n                // Try again\r\n                setTimeout(function () {\r\n                    loadingFunction();\r\n                }, 50);\r\n            }\r\n        };\r\n        // Execute loading function\r\n        loadingFunction();\r\n    }, {\r\n            jQuery: $,\r\n            userParams: params,\r\n            popupWindow: newWindow,\r\n            url: url\r\n        });\r\n};\r\n/*\r\n *   Returns the resolved result from a promise when the promise has been executed already\r\n */\r\nbizagi.resolveResult = function (promise) {\r\n    var result;\r\n    promise.done(function (data) {\r\n        result = data;\r\n    });\r\n    return result;\r\n};\r\n/*\r\n *   Creates a popup using overlay style\r\n */\r\nbizagi.createPopup = function (params) {\r\n    var popupName = params.name,\r\n        onClose = params.onClose,\r\n        popupHeader;\r\n    var popupTitle = (params.title) ? params.title : '';\r\n    var overlay = $('<div class=\"ui-widget-overlay ' + popupName + '-overlay\" />');\r\n    var popup = $('<div class=\"' + popupName + '-popup  ui-popup-modal\"/>').appendTo(overlay);\r\n    var closeButton = $('<div class=\"' + popupName + '-btn-close biz-btn-close\"><i class=\"biz-icon ui-close-btn bz-studio bz-black bz-false_16x16_black\"></i></div>').appendTo(popup);\r\n    if (params.title) {\r\n        popupHeader = $('<div class=\"' + popupName + '-popup-header ui-popup-header\" ><h3>' + popupTitle + '</h3></div>').appendTo(popup);\r\n    }\r\n\r\n    var popupContent = $('<div class=\"' + popupName + '-popup-content\" />').appendTo(popup);\r\n    // Add to body\r\n    popup.hide();\r\n    if (params.additionalClass)\r\n        popup.addClass(params.additionalClass);\r\n    var container = params.container || \"body\";\r\n    overlay.appendTo($(container, document));\r\n\r\n    if (params.center) {\r\n        // Resize popup to the center\r\n        popup.css(\"top\", (overlay.height() - popup.height()) / 2);\r\n        popup.css(\"left\", (overlay.width() - popup.width()) / 2);\r\n    }\r\n    popup.show();\r\n    // Close handler\r\n    var closeHandler = function (params) {\r\n        overlay.detach();\r\n        if (onClose)\r\n            onClose(params);\r\n    };\r\n    closeButton.click(closeHandler);\r\n    // Return a full independent object\r\n    return {\r\n        fullPopup: popup,\r\n        overlay: overlay,\r\n        content: popupContent,\r\n        close: function (params) {\r\n            closeHandler(params);\r\n        }\r\n    };\r\n};\r\n/*\r\n * Create an Ok, Cancel popup using bizagi.createPopup()\r\n */\r\n\r\nbizagi.createOkCancelPopup = function (params) {\r\n    params.name = \"popup-ok-cancel\";\r\n    var onOk = params.onOk,\r\n        onCancel = params.onCancel;\r\n    var popup = bizagi.createPopup(params);\r\n    var container = $(\"<div></div>\").addClass(\"container-okcancel-popup\");\r\n    var message = $(\"<div></div>\").addClass(\"message-okcancel-popup ui-light-bevel-border biz-gradient-v\");\r\n    var buttonsContainer = $(\"<div></div>\").addClass(\"buttonsContainer-okcancel-popup biz-actions-bar\");\r\n    message.text(params.message);\r\n    message.appendTo(container);\r\n    var buttonOk = $(\"<span></span>\").addClass(\"ok-button-okcancel-popup editor-ui-button-actions biz-action-btn biz-btn\");\r\n    var buttonCancel = $(\"<span></span>\").addClass(\"cancel-button-okcancel-popup editor-ui-button-actions biz-action-btn biz-btn\");\r\n    buttonOk.text(bizagi.localization.getResource(\"bizagi-editor-okcancel-ok\"));\r\n    buttonCancel.text(bizagi.localization.getResource(\"bizagi-editor-okcancel-cancel\"));\r\n    buttonOk.appendTo(buttonsContainer);\r\n    buttonCancel.appendTo(buttonsContainer);\r\n    buttonsContainer.appendTo(container);\r\n    container.appendTo(popup.content);\r\n    var okHandler = function () {\r\n        popup.close();\r\n        if (typeof (onOk) == \"function\") {\r\n            onOk();\r\n        }\r\n    };\r\n    buttonOk.click(okHandler);\r\n    var cancelHandler = function () {\r\n        popup.close();\r\n        if (typeof (onCancel) == \"function\") {\r\n            onCancel();\r\n        }\r\n    };\r\n    buttonCancel.click(cancelHandler);\r\n    return {\r\n        close: function () {\r\n            popup.close();\r\n        },\r\n        ok: function () {\r\n            okHandler();\r\n        },\r\n        cancel: function () {\r\n            cancelHandler();\r\n        }\r\n    };\r\n};\r\n/*\r\n * Create an generic dialog\r\n */\r\nbizagi.dialog = function (params) {\r\n\r\n    var dialog = $(\"<div></div>\").addClass(\"biz-dialog\");\r\n    var msg = $(\"<p></p>\");\r\n    msg.text(params.message || \"\");\r\n    msg.appendTo(dialog);\r\n    dialog.appendTo($(\"body\", document));\r\n    dialog.dialog({\r\n        title: params.title,\r\n        modal: true,\r\n        buttons: params.buttons,\r\n        close: function () {\r\n            dialog.dialog(\"destroy\");\r\n        }\r\n    });\r\n};\r\n/*\r\n *   Close the quirks mode popup window\r\n */\r\nbizagi.closeQuirksModePopup = function () {\r\n    var quirksPopup = window.BAQuirksPopupWindow;\r\n    window.BAQuirksPopupWindow = null;\r\n    try {\r\n        if (quirksPopup)\r\n            quirksPopup.close();\r\n    } catch (e) { }\r\n};\r\n/**\r\n * Get css class definition to string\r\n */\r\nbizagi.getStyle = function (style) {\r\n    var pathName = location.href.replace(\"/default.aspx\", \"\");\r\n    var getFontFace = (style.match(/@/)) ? true : false;\r\n    var matchFontFace = \"@font-face\";\r\n    var getAllChildrens = (style.match(/\\*/)) ? true : false;\r\n    var matchStyles = new RegExp(style.replace(\"*\", \"\"), \"g\");\r\n    var stringCss = \"\";\r\n    var css;\r\n    if (style == \"\") {\r\n        return \"\";\r\n    }\r\n    var awesomeBrowser = function (style) {\r\n        for (var file = 0; file < document.styleSheets.length; file++) {\r\n            css = document.styleSheets[file].rules || document.styleSheets[file].cssRules;\r\n            if (css != null) {\r\n                for (var key = 0; key < css.length; key++) {\r\n                    if (document.styleSheets[file].href != null && (document.styleSheets[file].href.match(/less.css/g) == null || BIZAGI_ENVIRONMENT == \"release\")) {\r\n\r\n                        var cssTextOriginal = (css[key].cssText) ? css[key].cssText : '';\r\n                        // Get all matches\r\n                        if (getAllChildrens) {\r\n                            if (css[key].selectorText != undefined && css[key].selectorText.match(matchStyles) != null) {\r\n\r\n                                if ($.browser.webkit) {\r\n                                    stringCss += css[key].cssText.replace(/\\(path\\)/g, \"\");\r\n                                } else if ($.browser.msie && $.browser.version == \"8.0\") {\r\n                                    stringCss += css[key].style.cssText;\r\n                                } else {\r\n                                    stringCss += css[key].cssText.replace(/\\(path\\)/g, \"../../jquery/workportal/css/desktop\");\r\n                                }\r\n                            }\r\n                        } else if (css[key].selectorText != undefined && css[key].selectorText == style) {\r\n                            stringCss += css[key].cssText;\r\n                        }\r\n\r\n                        // Get @font-face\r\n                        if (getFontFace) {\r\n                            if (css[key] != undefined && cssTextOriginal != undefined) {\r\n                                if (cssTextOriginal.indexOf(matchFontFace) != -1) {\r\n\r\n                                    if ($.browser.webkit) {\r\n                                        stringCss += cssTextOriginal.replace(/jquery\\/workportal\\/css\\/desktop\\//g, \"\").replace(/\\(path\\)/g, \"\");\r\n                                    } else {\r\n                                        stringCss += cssTextOriginal.replace(/\\(path\\)/g, \"../../\");\r\n                                    }\r\n\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return stringCss;\r\n    };\r\n    var suckBrowser = function (style) {\r\n        if ($.browser.version == \"8.0\") {\r\n            // That is crazy, but it has the same document.styleSheets structure to chrome and mozilla\r\n            return awesomeBrowser(style);\r\n        }\r\n        var lastLevel;\r\n        for (var file = 0; file < document.styleSheets.length; file++) {\r\n            css = document.styleSheets[file].cssRules || document.styleSheets[file].rules;\r\n\r\n            if (css != null) {\r\n                for (var key = 0; key < css.length; key++) {\r\n                    if (BIZAGI_ENVIRONMENT == \"release\") {\r\n                        // Get all matches \r\n                        if (getAllChildrens) {\r\n                            if (css[key].selectorText != undefined && css[key].selectorText.match(matchStyles) != null) {\r\n                                stringCss += css[key].cssText.replace(/\\(path\\)/g, pathName + \"/jquery/workportal/css/desktop\");\r\n                            } else if (css[key].selectorText != undefined && css[key].selectorText == style) {\r\n                                stringCss += css[key].cssText.replace(/\\(path\\)/g, pathName + \"/jquery/workportal/css/desktop\");\r\n                            }\r\n                        }\r\n                    } else if (css[key].href != null && css[key].href != undefined && css[key].href.match(/less.css/g) == null) {\r\n                        // Get all matches \r\n                        lastLevel = css[key].styleSheet.cssRules || [];\r\n                        for (var n = 0; n < lastLevel.length; n++) {\r\n                            if (getAllChildrens) {\r\n                                if ((lastLevel[n].selectorText != undefined || lastLevel[n].selectorText != null) && lastLevel[n].selectorText.match(matchStyles) != null) {\r\n                                    //stringCss += lastLevel[n].cssText;\r\n                                    stringCss += lastLevel[n].cssText.replace(/\\(path\\)/g, pathName + \"/jquery/workportal/css/desktop\");\r\n                                }\r\n                            } else if (lastLevel[n].selectorText != undefined && lastLevel[n].selectorText == style) {\r\n                                // stringCss += lastLevel[n].cssText;\r\n                                stringCss += lastLevel[n].cssText.replace(/\\(path\\)/g, pathName + \"/jquery/workportal/css/desktop\");\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return stringCss;\r\n    };\r\n    var result = ($.browser.msie) ? suckBrowser(style) : awesomeBrowser(style);\r\n    return result;\r\n};\r\n/**\r\n * Set and retrieve Cookie\r\n */\r\nbizagi.cookie = function (key, value, options) {\r\n    // key and at least value given, set cookie...\r\n    if (arguments.length > 1 && String(value) !== \"[object Object]\") {\r\n        options = $.extend({}, options);\r\n        if (value === null || value === undefined) {\r\n            options.expires = -1;\r\n        }\r\n\r\n        if (typeof options.expires === 'number') {\r\n            var days = options.expires,\r\n                t = options.expires = new Date();\r\n            t.setDate(t.getDate() + days);\r\n        }\r\n\r\n        value = String(value);\r\n        return (document.cookie = [\r\n            encodeURIComponent(key), '=',\r\n            options.raw ? value : encodeURIComponent(value),\r\n            options.expires ? '; expires=' + options.expires.toUTCString() : '', // use expires attribute, max-age is not supported by IE\r\n            options.path ? '; path=' + options.path : '',\r\n            options.domain ? '; domain=' + options.domain : '',\r\n            options.secure ? '; secure' : ''\r\n        ].join(''));\r\n    }\r\n\r\n    // key and possibly options given, get cookie...\r\n    options = value || {};\r\n    var result, decode = options.raw ? function (s) {\r\n        return s;\r\n    } : decodeURIComponent;\r\n    return (result = new RegExp('(?:^|; )' + encodeURIComponent(key) + '=([^;]*)').exec(document.cookie)) ? decode(result[1]) : null;\r\n};\r\n/**\r\n * Returns a random integer between min and max\r\n */\r\nbizagi.util.randomNumber = function (min, max) {\r\n    min = min || 1;\r\n    max = max || 10000000;\r\n    return Math.floor(Math.random() * (max - min + 1)) + min;\r\n};\r\n\r\n/**\r\n * Set global context values\r\n * @param params onject\r\n * @param reset boolean\r\n */\r\nbizagi.util.setContext = function (params, reset) {\r\n    params = params || {};\r\n    reset = reset || false;\r\n    if (reset) {\r\n        bizagi.context = {};\r\n    }\r\n    $.each(params, function (key, value) {\r\n        bizagi.context[key] = value;\r\n    });\r\n\r\n    // Fix camel case in idWorkItem Property\r\n    bizagi.context[\"idWorkItem\"] = bizagi.context[\"idWorkitem\"];\r\n};\r\n\r\nbizagi.util.reloadCSS = function () {\r\n    var queryString = '?reload=' + new Date().getTime();\r\n    $('link[rel=\"stylesheet\"]').each(function () {\r\n        this.href = this.href.replace(/\\?.*|$/, queryString);\r\n    });\r\n}\r\n\r\n/**\r\n * Control recursive calls of setTimeout\r\n * @param params json {name:name of call,call: function call}\r\n * @return void\r\n */\r\nbizagi.util.setInterval = function (params) {\r\n    var _name = params.name || 'default';\r\n    var _call = params.call || function () { };\r\n    var _params = params.params || {};\r\n    var _singleton = params.singleton || false;\r\n    var _timeOut = params.timeout || 5000;\r\n    var _maxIterations = params.iterations || 1000;\r\n    var _context = params.context || \"true;\";\r\n    // If callback its diferent to context, remove from hash\r\n    var _killWhenExitContext = (params.hasOwnProperty('killWhenExitContext')) ? params.killWhenExitContext : true;\r\n    bizagi.timeOut = bizagi.timeOut || {};\r\n    if (bizagi.timeOut[_name] == undefined) {\r\n        bizagi.timeOut[_name] = [];\r\n    }\r\n\r\n    // Check if singleton (run once)\r\n    if (_singleton && bizagi.timeOut[_name] != undefined) {\r\n        bizagi.timeOut[_name] = [];\r\n    }\r\n\r\n\r\n    bizagi.timeOut[_name].push({\r\n        name: _name,\r\n        params: _params,\r\n        call: _call,\r\n        singleton: _singleton,\r\n        timeOut: _timeOut,\r\n        iterations: 0,\r\n        maxIterations: _maxIterations,\r\n        context: _context,\r\n        killWhenExitContext: _killWhenExitContext,\r\n        itsRunning: false,\r\n        timeInit: Math.round((new Date()).getTime())\r\n    });\r\n    var executeTimeOut = function () {\r\n        $.each(bizagi.timeOut, function (k, v) {\r\n            $.each(v, function (key, value) {\r\n                var now = Math.round((new Date()).getTime());\r\n                var actualIterations = Math.round((now - value.timeInit) / value.timeOut);\r\n                bizagi.timeOut[value.name][key]['iterations'] = actualIterations;\r\n                if (actualIterations < value.maxIterations) {\r\n                    // Check context\t\t\t\t\t\r\n                    if (eval(value.context)) {\r\n                        if (!value.itsRunning) {\r\n                            if (value.params)\r\n                                // Create a virtual function to IE\r\n                                if ($.browser.msie) {\r\n                                    var ieFunction = function () {\r\n                                        return value.call(value.params);\r\n                                    };\r\n                                }\r\n\r\n                            bizagi.timeOut[value.name][key]['pointer'] = ($.browser.msie) ? setInterval(ieFunction, value.timeOut, 'JavaScript') : setInterval(value.call, value.timeOut, value.params);\r\n                            bizagi.timeOut[value.name][key]['itsRunning'] = true;\r\n                        }\r\n                    } else if (value.killWhenExitContext) {\r\n                        bizagi.timeOut[value.name].splice(key, 1);\r\n                        clearTimeout(value.pointer);\r\n                    } else {\r\n                        bizagi.timeOut[value.name][key]['itsRunning'] = false;\r\n                        clearTimeout(value.pointer);\r\n                    }\r\n                } else {\r\n                    // Cancel timeout and remove call from hash\r\n                    clearTimeout(value.pointer);\r\n                    bizagi.timeOut[value.name].splice(key, 1);\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    if (!bizagi.timeOutRunning) {\r\n        bizagi.timeOutRunning = true;\r\n        setInterval(executeTimeOut, 1000);\r\n    }\r\n};\r\nbizagi.util.isDate = function (value) {\r\n    // type A) dd/mm/aaaa \r\n    // type B) aaaa/mm/dd\r\n    // type C) aa/mm/dd\r\n\r\n    var dateRegEx_typeA = /^\\d{1,2}\\/\\d{1,2}\\/\\d{4}$/,\r\n        dateRegEx_typeB = /^\\d{4}\\/\\d{1,2}\\/\\d{1,2}$/,\r\n        dateRegEx_typeC = /^\\d{1,2}\\/\\d{1,2}\\/\\d{1,2}$/,\r\n        timeRegEx = /^\\d{1,2}:\\d{2}(:\\d{2})?(\\s[aApP][mM])?$/,\r\n        result = false,\r\n        resultDate = false,\r\n        hasTime = false,\r\n        resultTime = false;\r\n\r\n    value = value || '';\r\n\r\n    var arrayDate = value.toString().split(\" \"),\r\n        dateField,\r\n        timeField;\r\n\r\n    dateField = arrayDate[0];\r\n\r\n    if (dateRegEx_typeA.test(dateField) || dateRegEx_typeB.test(dateField) || dateRegEx_typeC.test(dateField)) {\r\n        resultDate = true;\r\n    }\r\n\r\n    if (arrayDate.length > 1) {\r\n\r\n        timeField = arrayDate[1];\r\n\r\n        hasTime = true;\r\n\r\n        //Checks if AM/PM included in the time element\r\n        if (arrayDate.length == 3)\r\n            timeField = timeField + ' ' + arrayDate[2];\r\n\r\n        if (timeRegEx.test(timeField))\r\n            resultTime = true;\r\n    }\r\n\r\n    if (hasTime)\r\n        result = resultDate && resultTime;\r\n    else\r\n        result = resultDate;\r\n\r\n    return result;\r\n};\r\n/*\r\n *   Encodes unicode characters into html\r\n */\r\nbizagi.util.unicode2htmlencode = function (input) {\r\n    // Shorten\r\n    var natCCA = 'charCodeAt';\r\n    input = input.replace(/\\r\\n/g, '\\n');\r\n    var i, b1, hex,\r\n        len = input.length,\r\n        htmlHex = '';\r\n    for (i = 0; i < len; i++) {\r\n        b1 = input[natCCA](i);\r\n        hex = b1.toString(16);\r\n        htmlHex += '&#x' + hex + ';';\r\n    }\r\n    return htmlHex;\r\n};\r\n/*\r\n *   Gets the head element from the DOM\r\n */\r\nbizagi.util.getHeadElement = function () {\r\n    var hd = document.getElementsByTagName(\"head\")[0];\r\n    var docEl = document && document.documentElement;\r\n    if (!hd) {\r\n        hd = document.createElement(\"head\");\r\n        docEl.insertBefore(hd, docEl.firstChild);\r\n    }\r\n    // replace head so it runs fast next time.\r\n    bizagi.util.getHeadElement = function () {\r\n        return hd;\r\n    };\r\n    return hd;\r\n};\r\n/*\r\n *   Loads a css text into the current document\r\n */\r\nbizagi.util.loadStyle = function (styleText, layoutGuid) {\r\n\r\n    var element = document.getElementById(layoutGuid);\r\n\r\n    if (styleText && !element) { // less\r\n        var css = document.createElement(\"style\");\r\n        css.type = \"text/css\";\r\n        css.id = layoutGuid;\r\n        if (css.styleSheet) { // IE\r\n            css.styleSheet.cssText = styleText;\r\n        } else {\r\n            (function (node) {\r\n                if (css.childNodes.length) {\r\n                    if (css.firstChild.nodeValue !== node.nodeValue) {\r\n                        css.replaceChild(node, css.firstChild);\r\n                    }\r\n                } else {\r\n                    css.appendChild(node);\r\n                }\r\n            })(document.createTextNode(styleText));\r\n        }\r\n        bizagi.util.getHeadElement().appendChild(css);\r\n    }\r\n};\r\n\r\n/*\r\n *   Loads a css text of the icon widget into the current document\r\n */\r\nbizagi.util.loadIconStyle = function (icon, userfieldname) {\r\n    bizagi.log(\"bizagi.util.loadIconStyle\");\r\n    var css = document.createElement(\"style\");\r\n    css.type = \"text/css\";\r\n\r\n    var cssText = \".mtool-item-image-\" + userfieldname + \" { background:url(data:image/png;base64,\" + icon + \"); }\";\r\n    css.innerHTML = cssText;\r\n\r\n    bizagi.util.getHeadElement().appendChild(css);\r\n};\r\n\r\nbizagi.util.formatDecimalAndMoneyCell = function (tableData, externalMoneyFormat) {\r\n    var moneyFormat, decimalFormat, i, j;\r\n    var externalDecimalFormat = {\r\n        decimalSymbol: externalMoneyFormat.decimalSeparator,\r\n        digitGroupSymbol: externalMoneyFormat.groupSeparator,\r\n        roundToDecimalPlace: externalMoneyFormat.decimalDigits\r\n    };\r\n    var defaultMoneyFormat = {\r\n        symbol: \"€\",\r\n        decimalSeparator: \",\",\r\n        groupSeparator: \".\",\r\n        decimalDigits: \"2\"\r\n    };\r\n    var defaultDecimalFormat = {\r\n        colorize: false,\r\n        decimalSymbol: \".\",\r\n        digitGroupSymbol: \",\",\r\n        groupDigits: true,\r\n        negativeFormat: \"(%s%n)\",\r\n        positiveFormat: \"%s%n\",\r\n        roundToDecimalPlace: \"2\",\r\n        symbol: \"\"\r\n    };\r\n\r\n    moneyFormat = $.extend(defaultMoneyFormat, externalMoneyFormat);\r\n    decimalFormat = $.extend(defaultDecimalFormat, externalDecimalFormat);\r\n\r\n    for (i = 0; i < tableData.columnTitle.length; i++) {\r\n        if (tableData.columnTitle[i].type.toUpperCase() == \"MONEY\") {\r\n            for (j = 0; j < tableData.rows.length; j++) {\r\n                tableData.rows[j].fields[i] = bizagi.util.formatMoney(tableData.rows[j].fields[i], moneyFormat);\r\n            }\r\n        }\r\n        if (tableData.columnTitle[i].type.toUpperCase() == \"FLOAT\" || tableData.columnTitle[i].type.toUpperCase() == \"REAL\") {\r\n            for (j = 0; j < tableData.rows.length; j++) {\r\n                var numberValue = bizagi.util.formatDecimal(tableData.rows[j].fields[i], decimalFormat);\r\n                //Gets rids of unnecessary zeros\r\n                if (bizagi.override.removeTrailingZeros === true) {\r\n                    var positive = true;\r\n                    if (numberValue.toString().indexOf(\")\") != -1) {\r\n                        positive = false;\r\n                        numberValue = numberValue.replace(\"(\", \"\").replace(\")\", \"\");\r\n                    }\r\n                    var re = new RegExp(\"(\" + BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator + \"\\\\d*?[1-9])0+$\", \"g\");\r\n                    numberValue = numberValue.replace(re, \"$1\");\r\n                    re = new RegExp(\"\\\\\" + BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator + \"0+$\", \"g\");\r\n                    numberValue = numberValue.replace(re, \"\");\r\n\r\n                    if (!positive) numberValue = \"(\" + numberValue + \")\";\r\n                }\r\n                tableData.rows[j].fields[i] = numberValue;\r\n            }\r\n        }\r\n    }\r\n\r\n    return tableData;\r\n};\r\n\r\n\r\nbizagi.util.formatBoolean = function (value) {\r\n    var self = this;\r\n    if (bizagi.util.parseBoolean(value) == true) {\r\n        return bizagi.localization.getResource(\"render-boolean-yes\");\r\n    } else if (bizagi.util.parseBoolean(value) == false) {\r\n        return bizagi.localization.getResource(\"render-boolean-no\");\r\n    } else {\r\n        return \"\";\r\n    }\r\n};\r\n\r\nbizagi.util.formatInvariantBoolean = function (htmlContent) {\r\n    htmlContent = htmlContent || \"\";\r\n    $(\".formatBoolean\", htmlContent).not(\".formatted\").each(function (index, element) {\r\n        var $element = $(element);\r\n        var content = $element.html();\r\n        $element.addClass(\"formatted\");\r\n        try {\r\n            var formatBoolean = bizagi.util.formatBoolean(content);\r\n            $element.html(formatBoolean);\r\n        } catch (e) {\r\n            $element.html(content);\r\n        }\r\n    });\r\n};\r\n\r\nbizagi.util.formatDecimal = function (value, format) {\r\n    var i = $(\"<i/>\").text(value);\r\n    i.formatCurrency(format);\r\n    return i.text();\r\n};\r\n\r\n/*\r\n * Format monetary cells\r\n */\r\nbizagi.util.formatMonetaryCells = function (tableData, moneyFormat) {\r\n\r\n    var defaultFormat = {\r\n        symbol: \"€\",\r\n        decimalSeparator: \",\",\r\n        groupSeparator: \".\",\r\n        decimalDigits: \"2\"\r\n    };\r\n\r\n    moneyFormat = moneyFormat || defaultFormat;\r\n\r\n    for (var i = 0; i < tableData.columnTitle.length; i++) {\r\n        if (tableData.columnTitle[i].type.toUpperCase() == \"MONEY\") {\r\n            for (var j = 0; j < tableData.rows.length; j++) {\r\n                tableData.rows[j].fields[i] = bizagi.util.formatMoney(tableData.rows[j].fields[i], moneyFormat);\r\n            }\r\n        }\r\n    }\r\n\r\n    return tableData;\r\n\r\n};\r\n\r\n/*\r\n * Format monetary values, the format must have the structure of the next example:\r\n *\r\n * var defaultFormat = {\r\n *        symbol: \"€\",\r\n *        decimalSeparator: \",\",\r\n *        groupSeparator: \".\",\r\n *        decimalDigits: \"2\"\r\n *    };\r\n */\r\nbizagi.util.formatMoney = function (value, format) {\r\n    var result = \"\",\r\n        tmpResult = \"\",\r\n        intSection = \"\",\r\n        decimalSection = \"\",\r\n        decimalResult = \"\",\r\n        isNegative = (value < 0);\r\n\r\n    if (value == null) {\r\n        value = \"\";\r\n    }\r\n\r\n    value = value.toString();\r\n\r\n    if (value.length >= 1) {\r\n        var decimalDigitPosition = value.indexOf(\".\");\r\n\r\n        if (decimalDigitPosition > 0) {\r\n            value = bizagi.util.fixDecimalDigits(value, format.decimalDigits);\r\n            intSection = value.substring(0, decimalDigitPosition).replace(/\\D/g, '');\r\n        } else {\r\n            var zeroChar = \"0\";\r\n\r\n            for (var i = 0; i < format.decimalDigits; i++) {\r\n                decimalResult += zeroChar;\r\n            }\r\n            intSection = value.replace(/\\D/g, '');\r\n        }\r\n\r\n        //take only the number characters removing other characters\r\n        value = value.replace(/\\D/g, '');\r\n        //take the decimal section\r\n        if (format.decimalDigits > 0) {\r\n            decimalSection = decimalDigitPosition > 0 ? format.decimalSeparator + value.substring(value.length - format.decimalDigits, value.length) : format.decimalSeparator + decimalResult;\r\n        } else {\r\n            decimalSection = \"\";\r\n        }\r\n        //insert groupSeparators into int section\r\n        if (intSection.length > 3) {\r\n            var count = 0;\r\n\r\n            //insert separator from end to begin\r\n            for (var i = intSection.length - 1; i >= 0; i--) {\r\n                if (count == 3) {\r\n                    tmpResult += \".\";\r\n                    count = 0;\r\n                }\r\n                tmpResult += intSection[i];\r\n                count += 1;\r\n            }\r\n            //revert the string to get the result value\r\n            for (var i = tmpResult.length - 1; i >= 0; i--) {\r\n                result += tmpResult[i];\r\n            }\r\n        } else {\r\n            result = intSection;\r\n        }\r\n\r\n        //replace the correct group separator\r\n        result = result.replaceAll(\".\", format.groupSeparator);\r\n        //unify all sections and finish format\r\n        if (isNegative) {\r\n            var negativeFormat = bizagi.localization.getResource('numericFormat').negativeFormat;\r\n            result = negativeFormat.replace(\"%s\", format.symbol).replace(\"%n\", result + decimalSection);\r\n        } else {\r\n            result = format.symbol + result + decimalSection;\r\n        }\r\n\r\n        return result;\r\n    } else {\r\n        return value;\r\n    }\r\n\r\n\r\n};\r\n\r\n/**\r\n * Remove all characters except numbers\r\n */\r\nbizagi.util.getOnlyNumbersByString = function (stringValue) {\r\n    return stringValue.replace(/\\D/g, '');\r\n}\r\n\r\n/*\r\n    This method was created because the \"toFixed()\" JavaScript method in some cases round the numbers when it is not needed.\r\n    Can return string or number.\r\n*/\r\nbizagi.util.fixDecimalDigits = function (value, decimalDigits) {\r\n    var decimalDigitPosition,\r\n        intSection,\r\n        decimalSection;\r\n\r\n    decimalDigitPosition = value.indexOf('.');\r\n    intSection = value.substring(0, decimalDigitPosition);\r\n    decimalSection = value.substring(decimalDigitPosition + 1, value.length);\r\n\r\n    if (decimalDigits > decimalSection.length) {\r\n        for (var i = decimalSection.length; i < decimalDigits; i++) {\r\n            value += '0';\r\n        }\r\n    } else {\r\n        value = parseFloat(value).toFixed(decimalDigits);\r\n    }\r\n\r\n    return value;\r\n\r\n};\r\n\r\n/*\r\n * Format html  money\r\n */\r\nbizagi.util.formatInvariantMoney = function (htmlContent, moneyFormat) {\r\n    htmlContent = htmlContent || \"\";\r\n    var defaultFormat = {\r\n        symbol: moneyFormat.symbol,\r\n        decimalSeparator: moneyFormat.decimalSeparator || \",\",\r\n        groupSeparator: moneyFormat.groupSeparator || \".\",\r\n        decimalDigits: moneyFormat.decimalDigits || \"2\"\r\n    };\r\n    if (moneyFormat.allowDecimals === false) {\r\n        defaultFormat.decimalDigits = \"0\";\r\n    }\r\n\r\n    $(\".formatMoney\", htmlContent).not(\".formated\").each(function (index, elem) {\r\n        var content = $(elem).html();\r\n        $(elem).addClass(\"formated\");\r\n        try {\r\n            var value = parseFloat(content);\r\n            if (!isNaN(value)) {\r\n                var formatMoney = bizagi.util.formatMoney(value, defaultFormat);\r\n                $(elem).html(formatMoney);\r\n            }\r\n        } catch (e) {\r\n            // Restore the original content\r\n            $(elem).html(content);\r\n        }\r\n    });\r\n};\r\n\r\n/*\r\n * Format html  number\r\n */\r\nbizagi.util.formatInvariantNumber = function (htmlContent, numberFormat) {\r\n    htmlContent = htmlContent || \"\";\r\n    var decimalDigits = \"2\";\r\n    if (numberFormat.decimalDigits == \"0\")\r\n        decimalDigits = \"0\";\r\n    else\r\n        decimalDigits = numberFormat.decimalDigits || \"2\";\r\n\r\n    var defaultFormat = {\r\n        symbol: \"\",\r\n        decimalSeparator: numberFormat.decimalSeparator || \",\",\r\n        groupSeparator: numberFormat.groupSeparator || numberFormat.thousands ? \".\" : \"\",\r\n        decimalDigits: decimalDigits\r\n    };\r\n    $(\".formatMoney\", htmlContent).not(\".formated\").each(function (index, elem) {\r\n        var content = $(elem).html();\r\n        $(elem).addClass(\"formated\");\r\n        try {\r\n            var containsLetter = content.match(/[a-zA-Z]/);\r\n            var value = (containsLetter != null && containsLetter.length > 0) ? NaN : parseFloat(content);\r\n            if (!isNaN(value)) {\r\n                var formatNumber = bizagi.util.formatMoney(value, defaultFormat);\r\n                if (numberFormat.percentage) {\r\n                    formatNumber = formatNumber.toString() + \"%\";\r\n                }\r\n                $(elem).html(formatNumber);\r\n            }\r\n        } catch (e) {\r\n            // Restore the original content\r\n            $(elem).html(content);\r\n        }\r\n    });\r\n};\r\n\r\n/*\r\n * Format html with invariant date\r\n */\r\nbizagi.util.formatInvariantDate = function (htmlContent, dateFormat) {\r\n    htmlContent = htmlContent || \"\";\r\n    dateFormat = dateFormat || \"MM/dd/yyyy hh:mm:ss\";\r\n    $(\".formatDate\", htmlContent).not(\".formated\").each(function (index, elem) {\r\n        var content = $(elem).html();\r\n        $(elem).addClass(\"formated\");\r\n        try {\r\n            var value = new Date(content);\r\n            var dateTimeFormat = dateFormat;\r\n\r\n            if (bizagi.util.isValidDate(value))\r\n                dateTimeFormat = bizagi.util.getFormatDate(value, dateTimeFormat);\r\n\r\n            var formatDate = bizagi.util.dateFormatter.formatDate(value, dateTimeFormat /*self.getResource(\"dateFormat\")*/);\r\n            $(elem).html(formatDate);\r\n        } catch (e) {\r\n            // Restore the original content\r\n            $(elem).html(content);\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * Return format date with resources from string invariant date. It use the format specified\r\n * @param stringDateInvariant, string invariant date\r\n */\r\nbizagi.util.formatDateFromInvariantStringDate = function (stringInvariantDate) {\r\n    if (bizagi.util.isValidDate(stringInvariantDate)) {\r\n        var dateTimeFormat = bizagi.localization.getResource(\"dateFormat\") + ' ' + bizagi.localization.getResource(\"timeFormat\");\r\n        var value = new Date(stringInvariantDate);\r\n        dateTimeFormat = bizagi.util.getFormatDate(value, dateTimeFormat);\r\n\r\n        var formatDate = bizagi.util.dateFormatter.formatDate(value, dateTimeFormat);\r\n        return formatDate;\r\n    }\r\n    return stringInvariantDate || \"\";\r\n};\r\n\r\nbizagi.util.getFormatDate = function (dateValue, defaultFormatDate) {\r\n    var dateTimeFormat = defaultFormatDate;\r\n\r\n    var H = dateValue.getHours();\r\n    var m = dateValue.getMinutes();\r\n    var s = dateValue.getSeconds();\r\n    var ms = dateValue.getMilliseconds();\r\n\r\n    //Don't show time when hour, minutes, seconds and milliseconds are 0\r\n    if (H === 0 && m === 0 && s === 0 && ms === 0)\r\n        dateTimeFormat = bizagi.localization.getResource(\"dateFormat\");\r\n\r\n    return dateTimeFormat;\r\n};\r\n\r\n/**\r\n * Format value by dataType\r\n */\r\n\r\nbizagi.util.formatValueByDataType = function (value, dataType) {\r\n    /**\r\n     * Types Definedin Backend\r\n     * None = 0,BigInt = 1,Int = 2,SmallInt = 3,TinyInt = 4,Boolean = 5,Decimal = 6,Numeric = 7,Money = 8,Float = 10,Real = 11,DateTime = 12,SmallDateTime = 13,\r\n     Char = 14,VarChar = 15,Text = 16,Binary = 17,VarBinary = 18,Image = 19,Guid = 20,NChar = 21,NVarChar = 22,NText = 23,MxMBidirectionalRelationship = 24,\r\n     MxMUnidirectionalRelationship = 25,EntityDisabled = 26,UserAuth = 27,MxMUnidirectionalRelationshipWithoutFilter = 28,OracleNumber = 29,\r\n     Stakeholder = 30,ActivityItems = 31\r\n     *\r\n     * */\r\n    var result = value;\r\n    switch (dataType) {\r\n        case \"NText\":\r\n        case 23:\r\n        case \"Char\":\r\n        case 14:\r\n        case \"VarChar\":\r\n        case 15:\r\n        case \"Text\":\r\n        case 16:\r\n            if (value && value.length > 30) {\r\n                result = bizagi.util.replaceLineBreak(value);\r\n            }\r\n            break;\r\n        case \"Boolean\":\r\n        case 5:\r\n        case \"Binary\":\r\n        case 17:\r\n            result = bizagi.util.formatBoolean(value);\r\n            break;\r\n        case \"Int\":\r\n        case 2:\r\n        case \"BigInt\":\r\n        case 1:\r\n        case \"SmallInt\":\r\n        case 3:\r\n        case \"TinyInt\":\r\n        case 4:\r\n        case \"Numeric\":\r\n        case 7:\r\n            result = (value === undefined || value === null) ? \"\" : value;\r\n            break;\r\n        case \"Money\":\r\n        case 8:\r\n            result = bizagi.util.formatMonetaryCell(value);\r\n            break;\r\n        case \"Float\":\r\n        case 10:\r\n        case \"Real\":\r\n        case 11:\r\n        case \"Decimal\":\r\n        case 6:\r\n            result = bizagi.util.formatDecimalCell(value);\r\n            break;\r\n        case \"DateTime\":\r\n        case 12:\r\n        case \"SmallDateTime\":\r\n        case 13:\r\n            result = bizagi.util.formatDateFromInvariantStringDate(value);\r\n            break;\r\n    }\r\n    if (result == null) {\r\n        result = \"\";\r\n    }\r\n    return result;\r\n};\r\n\r\n/**\r\n * Check if it is a valid date\r\n */\r\nbizagi.util.isValidDate = function (params) {\r\n    if (typeof (params) != \"undefined\" && params != null) {\r\n        var parseDate = new Date(params);\r\n        return !isNaN(parseDate.valueOf());\r\n    } else return false;\r\n};\r\n\r\n/*\r\n *   Defines a date time formatter that will be available globally\r\n */\r\nbizagi.util.monthNames = new Array('January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December', 'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec');\r\nbizagi.util.dayNames = new Array('Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat');\r\n\r\nbizagi.util.dateFormatter = new function () {\r\n    this.LZ = function (x) {\r\n        return (x < 0 || x > 9 ? \"\" : \"0\") + x;\r\n    };\r\n    /*\r\n     *   isDate ( date_string, format_string )\r\n     *   Returns true if date string matches format of format string and\r\n     *   is a valid date. Else returns false.\r\n     *   It is recommended that you trim whitespace around the value before\r\n     *   passing it to this function, as whitespace is NOT ignored!\r\n     */\r\n    this.isDate = function (val, format) {\r\n        var date = this.getDateFromFormat(val, format);\r\n        if (date == 0) {\r\n            return false;\r\n        }\r\n        return true;\r\n    };\r\n\r\n    this.getRelativeTime = function (date, dateFormat, onlyUnitsTime) {\r\n\r\n        var self = this;\r\n        var now = new Date();\r\n        var time = (date instanceof Date) ? date : kendo.parseDate(date, dateFormat);\r\n        var diff = now.getTime() - time.getTime();\r\n        var timeDiff = getTimeDiffDescription(diff, 'year', 31536000000, onlyUnitsTime);\r\n\r\n        if (!timeDiff) {\r\n            timeDiff = getTimeDiffDescription(diff, 'month', 2628000000, onlyUnitsTime);\r\n            if (!timeDiff) {\r\n                timeDiff = getTimeDiffDescription(diff, 'week', 604800000, onlyUnitsTime);\r\n                if (!timeDiff) {\r\n                    timeDiff = getTimeDiffDescription(diff, 'day', 86400000, onlyUnitsTime);\r\n                    if (!timeDiff) {\r\n                        timeDiff = getTimeDiffDescription(diff, 'hour', 3600000, onlyUnitsTime);\r\n                        if (!timeDiff) {\r\n                            timeDiff = getTimeDiffDescription(diff, 'minute', 60000, onlyUnitsTime);\r\n                            if (!timeDiff) {\r\n                                if (onlyUnitsTime) {\r\n                                    if (diff === 0) {\r\n                                        timeDiff = getTimeDiffDescription(diff + 1, 'minute', 1, onlyUnitsTime);\r\n                                    } else {\r\n                                        timeDiff = getTimeDiffDescription(diff, 'minute', 1, onlyUnitsTime);\r\n                                    }\r\n                                } else {\r\n                                    timeDiff = getTimeDiffDescription(diff, 'second', 2000, onlyUnitsTime);\r\n                                    if (!timeDiff) {\r\n                                        timeDiff = bizagi.localization.getResource(\"workportal-relativetime-momentago\");\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return timeDiff;\r\n\r\n        /*\r\n         * Get Time Difference\r\n         */\r\n        function getTimeDiffDescription(diff, unit, timeDivisor, onlyUnitsTime) {\r\n            var unitAmount = (diff / timeDivisor).toFixed(0);\r\n\r\n            if (unitAmount > 0) {\r\n                if (onlyUnitsTime) {\r\n                    return (unitAmount == 1 ? bizagi.localization.getResource(\"workportal-relativetime-\" + unit).replace(\"%s\", unitAmount) : bizagi.localization.getResource(\"workportal-relativetime-\" + unit + \"s\").replace(\"%s\", unitAmount));\r\n                } else {\r\n                    var resourceAgo = bizagi.localization.getResource(\"workportal-relativetime-ago\");\r\n                    return (unitAmount == 1 ? resourceAgo.replace(\"%s\", bizagi.localization.getResource(\"workportal-relativetime-\" + unit).replace(\"%s\", unitAmount)) : resourceAgo.replace(\"%s\", bizagi.localization.getResource(\"workportal-relativetime-\" + unit + \"s\").replace(\"%s\", unitAmount)));\r\n                }\r\n\r\n            } else {\r\n                return null;\r\n            }\r\n        }\r\n    };\r\n\r\n    /*\r\n     *   compareDates(date1,date1format,date2,date2format)\r\n     *   Compare two date strings to see which is greater.\r\n     *   Returns:\r\n     *   1 if date1 is greater than date2\r\n     *   0 if date2 is greater than date1 of if they are the same\r\n     *  -1 if either of the dates is in an invalid format\r\n     */\r\n    this.compareDates = function (date1, dateformat1, date2, dateformat2) {\r\n        var d1 = getDateFromFormat(date1, dateformat1);\r\n        var d2 = getDateFromFormat(date2, dateformat2);\r\n        if (d1 == 0 || d2 == 0) {\r\n            return -1;\r\n        } else if (d1 > d2) {\r\n            return 1;\r\n        }\r\n        return 0;\r\n    };\r\n    /*\r\n     *   getDifferenceBetweenDates(date1,date2, unit)\r\n     *   Compare two date objects to see difference between them. The number result by unit specified.\r\n     *\r\n     *   Returns:\r\n     *   Difference value between two dates.\r\n     *   Message string if either of the dates is in an invalid format\r\n     */\r\n    this.getDifferenceBetweenDates = function (date1, date2, unit) {\r\n        if (date1 instanceof Date && date1 instanceof Date) {\r\n            switch (unit) {\r\n                case \"seconds\":\r\n                    return (date2.getTime() - date1.getTime()) / 1000;\r\n                case \"milliseconds\":\r\n                    return (date2.getTime() - date1.getTime());\r\n                default:\r\n                    return \"unit is not Defined\";\r\n            }\r\n        } else {\r\n            return \"one param not is Date\";\r\n        }\r\n\r\n    };\r\n    /*\r\n     *   formatDate (date_object, format)\r\n     *   Returns a date in the output format specified.\r\n     *   The format string uses the same abbreviations as in getDateFromFormat()\r\n     */\r\n    this.formatDate = function (date, format, i18n) {\r\n        // Check if date is valid\r\n        if (!bizagi.util.isValidDate(date) || date == 0) {\r\n            return \"\";\r\n        }\r\n\r\n        var monthNames = bizagi.util.monthNames;\r\n        var dayNames = bizagi.util.dayNames;\r\n        format = format + \"\";\r\n        var result = \"\";\r\n        var i_format = 0;\r\n        var c;\r\n        var token;\r\n        var y = date.getFullYear() + \"\";\r\n        var M = date.getMonth() + 1;\r\n        var d = date.getDate();\r\n        var E = date.getDay();\r\n        var H = date.getHours();\r\n        var m = date.getMinutes();\r\n        var s = date.getSeconds();\r\n        var f = date.getMilliseconds();\r\n        // Convert real date parts into formatted versions\r\n        var value = new Object();\r\n\r\n        if (bizagi.util.isValidResource(\"datePickerRegional\")) {\r\n            i18n = bizagi.localization.getResource(\"datePickerRegional\");\r\n        }\r\n\r\n        if (i18n) {\r\n            var months = i18n.monthNames.concat(i18n.monthNamesShort);\r\n            var days = i18n.dayNames.concat(i18n.dayNamesShort);\r\n            monthNames = monthNames.toString() === months.toString() ? monthNames : months;\r\n            dayNames = dayNames.toString() === days.toString() ? dayNames : days;\r\n        }\r\n\r\n        if (y.length < 4 || (y.charAt(0) === \"-\" && y.length < 5)) {\r\n            y = \"\" + (y - 0 + 1900);\r\n        }\r\n        value[\"y\"] = \"\" + y;\r\n        value[\"yyyy\"] = y;\r\n        value[\"yy\"] = y.substring(2, 4);\r\n        value[\"M\"] = M;\r\n        value[\"MM\"] = this.LZ(M);\r\n        value[\"MMM\"] = monthNames[M + 11];\r\n        value[\"MMMM\"] = monthNames[M - 1];\r\n        value[\"NNN\"] = monthNames[M + 11];\r\n        value[\"d\"] = d;\r\n        value[\"dd\"] = this.LZ(d);\r\n        value[\"ddd\"] = dayNames[E + 7];\r\n        value[\"dddd\"] = dayNames[E];\r\n        value[\"E\"] = dayNames[E + 7];\r\n        value[\"EE\"] = dayNames[E];\r\n        value[\"H\"] = H;\r\n        value[\"HH\"] = this.LZ(H);\r\n        value[\"tt\"] = H < 12 ? \"am\" : \"pm\";\r\n        value[\"TT\"] = H < 12 ? \"AM\" : \"PM\";\r\n\r\n\r\n        if (H == 0) {\r\n            value[\"h\"] = 12;\r\n        } else if (H > 12) {\r\n            value[\"h\"] = H - 12;\r\n        } else {\r\n            value[\"h\"] = H;\r\n        }\r\n        value[\"hh\"] = this.LZ(value[\"h\"]);\r\n        if (H > 11) {\r\n            value[\"K\"] = H - 12;\r\n        } else {\r\n            value[\"K\"] = H;\r\n        }\r\n        value[\"k\"] = H + 1;\r\n        value[\"KK\"] = this.LZ(value[\"K\"]);\r\n        value[\"kk\"] = this.LZ(value[\"k\"]);\r\n        if (H > 11) {\r\n            value[\"a\"] = \"PM\";\r\n        } else {\r\n            value[\"a\"] = \"AM\";\r\n        }\r\n        value[\"m\"] = m;\r\n        value[\"mm\"] = this.LZ(m);\r\n        value[\"s\"] = s;\r\n        value[\"ss\"] = this.LZ(s);\r\n        value[\"FFF\"] = f;\r\n\r\n        while (i_format < format.length) {\r\n            c = format.charAt(i_format);\r\n            token = \"\";\r\n            while ((format.charAt(i_format) == c) && (i_format < format.length)) {\r\n                token += format.charAt(i_format++);\r\n            }\r\n            if (value[token] != null) {\r\n                result = result + value[token];\r\n            } else {\r\n                result = result + token;\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    /*\r\n     *   getDateFromFormat( date_string , format_string )\r\n     *\r\n     *   This function takes a date string and a format string. It matches\r\n     *   If the date string matches the format string, it returns the \r\n     *   getTime() of the date. If it does not match, it returns 0.\r\n     */\r\n    this.getDateFromFormat = function (val, format, i18n) {\r\n        var monthNames = bizagi.util.monthNames;\r\n        var dayNames = bizagi.util.dayNames;\r\n        val = val + \"\";\r\n        format = format + \"\";\r\n        var i_val = 0;\r\n        var i_format = 0;\r\n        var c;\r\n        var token;\r\n        var x = 0,\r\n            y = 0;\r\n        var now = new Date();\r\n        var year = now.getYear();\r\n        var month = now.getMonth() + 1;\r\n        var date = 1;\r\n        var hh = now.getHours();\r\n        var mm = now.getMinutes();\r\n        var ss = now.getSeconds();\r\n        var FFF = now.getMilliseconds();\r\n        var ampm = \"\";\r\n\r\n        if (bizagi.util.isValidResource(\"datePickerRegional\")) {\r\n            i18n = bizagi.localization.getResource(\"datePickerRegional\");\r\n        }\r\n\r\n        if (i18n) {\r\n            var months = i18n.monthNames.concat(i18n.monthNamesShort);\r\n            var days = i18n.dayNames.concat(i18n.dayNamesShort);\r\n            monthNames = monthNames.toString() === months.toString() ? monthNames : months;\r\n            dayNames = dayNames.toString() === days.toString() ? dayNames : days;\r\n        }\r\n\r\n        while (i_format < format.length) {\r\n            // Get next token from format string\r\n            c = format.charAt(i_format);\r\n            token = \"\";\r\n            while ((format.charAt(i_format) == c) && (i_format < format.length)) {\r\n                token += format.charAt(i_format++);\r\n            }\r\n            // Extract contents of value based on format token\r\n            if (token == \"yyyy\" || token == \"yy\" || token == \"y\") {\r\n                if (token == \"yyyy\") {\r\n                    x = 4;\r\n                    y = 4;\r\n                }\r\n                if (token == \"yy\") {\r\n                    x = 2;\r\n                    y = 2;\r\n                }\r\n                if (token == \"y\") {\r\n                    x = 2;\r\n                    y = 4;\r\n                }\r\n                year = _getInt(val, i_val, x, y);\r\n                if (year == null) {\r\n                    return 0;\r\n                }\r\n                i_val += year.length;\r\n                if (year.length == 2) {\r\n                    if (year > 70) {\r\n                        year = 1900 + (year - 0);\r\n                    } else {\r\n                        year = 2000 + (year - 0);\r\n                    }\r\n                }\r\n            } else if (token == \"MMMM\" || token == \"MMM\" || token == \"NNN\") {\r\n                month = 0;\r\n                for (var i = 0; i < monthNames.length; i++) {\r\n                    var month_name = monthNames[i];\r\n                    if (val.substring(i_val, i_val + month_name.length).toLowerCase() == month_name.toLowerCase()) {\r\n                        if (token == \"MMMM\" || token == \"MMM\" || (token == \"NNN\" && i > 11)) {\r\n                            month = i + 1;\r\n                            if (month > 12) {\r\n                                month -= 12;\r\n                            }\r\n                            i_val += month_name.length;\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n                if ((month < 1) || (month > 12)) {\r\n                    return 0;\r\n                }\r\n            } else if (token == \"dddd\" || token == \"EE\" || token == \"E\") {\r\n                for (var j = 0; j < dayNames.length; j++) {\r\n                    var day_name = dayNames[j];\r\n                    if (val.substring(i_val, i_val + day_name.length).toLowerCase() == day_name.toLowerCase()) {\r\n                        i_val += day_name.length;\r\n                        break;\r\n                    }\r\n                }\r\n            } else if (token == \"MM\" || token == \"M\") {\r\n                month = _getInt(val, i_val, 1, 2);\r\n                if (month == null || (month < 1) || (month > 12)) {\r\n                    return 0;\r\n                }\r\n                i_val += month.length;\r\n            } else if (token == \"dd\" || token == \"d\") {\r\n                date = _getInt(val, i_val, 1, 2);\r\n                if (date == null || (date < 1) || (date > 31)) {\r\n                    return 0;\r\n                }\r\n                i_val += date.length;\r\n            } else if (token == \"hh\" || token == \"h\") {\r\n                hh = _getInt(val, i_val, token.length, 2);\r\n                if (hh == null || (hh < 1) || (hh > 12)) {\r\n                    return 0;\r\n                }\r\n                i_val += hh.length;\r\n            } else if (token == \"HH\" || token == \"H\") {\r\n                hh = _getInt(val, i_val, token.length, 2);\r\n                if (hh == null || (hh < 0) || (hh > 23)) {\r\n                    return 0;\r\n                }\r\n                i_val += hh.length;\r\n            } else if (token == \"KK\" || token == \"K\") {\r\n                hh = _getInt(val, i_val, token.length, 2);\r\n                if (hh == null || (hh < 0) || (hh > 11)) {\r\n                    return 0;\r\n                }\r\n                i_val += hh.length;\r\n            } else if (token == \"kk\" || token == \"k\") {\r\n                hh = _getInt(val, i_val, token.length, 2);\r\n                if (hh == null || (hh < 1) || (hh > 24)) {\r\n                    return 0;\r\n                }\r\n                i_val += hh.length;\r\n                hh--;\r\n            } else if (token == \"mm\" || token == \"m\") {\r\n                mm = _getInt(val, i_val, token.length, 2);\r\n                if (mm == null || (mm < 0) || (mm > 59)) {\r\n                    return 0;\r\n                }\r\n                i_val += mm.length;\r\n            } else if (token == \"ss\" || token == \"s\") {\r\n                ss = _getInt(val, i_val, token.length, 2);\r\n                if (ss == null || (ss < 0) || (ss > 59)) {\r\n                    return 0;\r\n                }\r\n                i_val += ss.length;\r\n            } else if (token == \"FFF\") {\r\n                ff = _getInt(val, i_val, token.length, 3);\r\n                if (ff == null || (ff < 0) || (ff > 999)) {\r\n                    return 0;\r\n                }\r\n                i_val += ff.length;\r\n            } else if (token == \"a\" || token == \"tt\") {\r\n                if (val.substring(i_val, i_val + 2).toLowerCase() == \"am\") {\r\n                    ampm = \"AM\";\r\n                } else if (val.substring(i_val, i_val + 2).toLowerCase() == \"pm\") {\r\n                    ampm = \"PM\";\r\n                } else {\r\n                    return 0;\r\n                }\r\n                i_val += 2;\r\n            } else {\r\n                if (val.substring(i_val, i_val + token.length) != token) {\r\n                    return 0;\r\n                } else {\r\n                    i_val += token.length;\r\n                }\r\n            }\r\n        }\r\n\r\n        // Is date valid for month?\r\n        if (month == 2) {\r\n            // Check for leap year\r\n            if (((year % 4 == 0) && (year % 100 != 0)) || (year % 400 == 0)) { // leap year\r\n                if (date > 29) {\r\n                    return 0;\r\n                }\r\n            } else {\r\n                if (date > 28) {\r\n                    return 0;\r\n                }\r\n            }\r\n        }\r\n        if ((month == 4) || (month == 6) || (month == 9) || (month == 11)) {\r\n            if (date > 30) {\r\n                return 0;\r\n            }\r\n        }\r\n        // Correct hours value\r\n        if (hh < 12 && ampm == \"PM\") {\r\n            hh = hh - 0 + 12;\r\n        } else if (hh > 11 && ampm == \"AM\") {\r\n            hh -= 12;\r\n        }\r\n        var newdate = new Date(year, month - 1, date, hh, mm, ss);\r\n        return newdate;\r\n\r\n        /*\r\n         *   Utility method for parsing in getDateFromFormat()\r\n         */\r\n        function _isInteger(_val) {\r\n            var digits = \"1234567890\";\r\n            for (var k = 0; k < _val.length; k++) {\r\n                if (digits.indexOf(_val.charAt(k)) == -1) {\r\n                    return false;\r\n                }\r\n            }\r\n            return true;\r\n        };\r\n        /*\r\n         *   Utility method for parsing in getDateFromFormat()\r\n         */\r\n        function _getInt(str, l, minlength, maxlength) {\r\n            for (var m = maxlength; m >= minlength; m--) {\r\n                var _token = str.substring(l, l + m);\r\n                if (_token.length < minlength) {\r\n                    return null;\r\n                }\r\n                if (_isInteger(_token)) {\r\n                    return _token;\r\n                }\r\n            }\r\n            return null;\r\n        };\r\n    };\r\n    /*\r\n     * parseDate( date_string [, prefer_euro_format] )\r\n     *\r\n     * This function takes a date string and tries to match it to a\r\n     * number of possible date formats to get the value. It will try to\r\n     * match against the following international formats, in this order:\r\n     * y-M-d   MMM d, y   MMM d,y   y-MMM-d   d-MMM-y  MMM d\r\n     * M/d/y   M-d-y      M.d.y     MMM-d     M/d      M-d\r\n     * d/M/y   d-M-y      d.M.y     d-MMM     d/M      d-M\r\n     * A second argument may be passed to instruct the method to search\r\n     * for formats like d/M/y (european format) before M/d/y (American).\r\n     * Returns a Date object or null if no patterns match.\r\n     */\r\n    this.parseDate = function (val) {\r\n        var preferEuro = (arguments.length == 2) ? arguments[1] : false;\r\n        var generalFormats = new Array('y-M-d', 'MMM d, y', 'MMM d,y', 'y-MMM-d', 'd-MMM-y', 'MMM d');\r\n        var monthFirst = new Array('M/d/y', 'M-d-y', 'M.d.y', 'MMM-d', 'M/d', 'M-d');\r\n        var dateFirst = new Array('d/M/y', 'd-M-y', 'd.M.y', 'd-MMM', 'd/M', 'd-M');\r\n        var checkList = new Array(generalFormats, preferEuro ? dateFirst : monthFirst, preferEuro ? monthFirst : dateFirst);\r\n        var d;\r\n        for (var i = 0; i < checkList.length; i++) {\r\n            var l = window[checkList[i]];\r\n            for (var j = 0; j < l.length; j++) {\r\n                d = getDateFromFormat(val, l[j]);\r\n                if (d != 0) {\r\n                    return new Date(d);\r\n                }\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    /*\r\n     *   Method to analyze a time format and checks separator, and hour format, and seconds\r\n     */\r\n    this.analyzeTimeFormat = function (timeFormat) {\r\n        var i = 0;\r\n        var c;\r\n        // Define return object\r\n        var returnObj = {\r\n            show24Hours: false,\r\n            showSeconds: false,\r\n            separator: \":\"\r\n        };\r\n        // Analize format\r\n        var token, lastToken = \"\";\r\n        while (i < timeFormat.length) {\r\n            // Get next token from format string\r\n            c = timeFormat.charAt(i);\r\n            token = \"\";\r\n            while ((timeFormat.charAt(i) == c) && (i < timeFormat.length)) {\r\n                token += timeFormat.charAt(i++);\r\n            }\r\n\r\n            // Extract contents of value based on format token\r\n            if (token == \"hh\" || token == \"h\") {\r\n                lastToken = token;\r\n                returnObj.show24Hours = false;\r\n            } else if (token == \"HH\" || token == \"H\") {\r\n                lastToken = token;\r\n                returnObj.show24Hours = true;\r\n            } else if (token == \"mm\" || token == \"m\") {\r\n                lastToken = token;\r\n            } else if (token == \"ss\" || token == \"s\") {\r\n                lastToken = token;\r\n                returnObj.showSeconds = true;\r\n            } else if (token == \"a\") {\r\n                lastToken = token;\r\n            } else {\r\n                if (lastToken.toUpperCase() == \"H\" || lastToken.toUpperCase() == \"HH\") {\r\n                    returnObj.separator = token;\r\n                }\r\n            }\r\n        }\r\n\r\n        return returnObj;\r\n    };\r\n    this.getDateFromInvariant = function (value, showTime) {\r\n        value = (value == null) ? \"\" : value;\r\n        value = (typeof value != \"string\") ? value.toString() : value;\r\n        var INVARIANT_FORMAT = \"MM/dd/yyyy\" + (showTime ? \" H:mm:ss\" : \"\");\r\n        if (showTime) {\r\n            if (value && (value.toLowerCase().indexOf(\"am\") > 0 || value.toLowerCase().indexOf(\"pm\") > 0)) {\r\n                INVARIANT_FORMAT = \"MM/dd/yyyy h:mm:ss a\";\r\n            }\r\n        }\r\n        var date = bizagi.util.dateFormatter.getDateFromFormat(value, INVARIANT_FORMAT);\r\n        // Also try to read the date with full format if the last instruction didn't success\r\n        if (date == 0 && !showTime) {\r\n            INVARIANT_FORMAT = \"MM/dd/yyyy H:mm:ss\";\r\n            date = bizagi.util.dateFormatter.getDateFromFormat(value, INVARIANT_FORMAT);\r\n        } else if (date == 0 && showTime && value != null && value != \"\") {\r\n            INVARIANT_FORMAT = \"MM/dd/yyyy\";\r\n            date = bizagi.util.dateFormatter.getDateFromFormat(value, INVARIANT_FORMAT);\r\n            date.setHours(0, 0, 0, 0);\r\n        }\r\n\r\n        return date;\r\n    };\r\n    this.formatInvariant = function (date, showTime) {\r\n        var INVARIANT_FORMAT = \"MM/dd/yyyy\" + (showTime ? \" HH:mm:ss\" : \"\");\r\n        var formattedDate = bizagi.util.dateFormatter.formatDate(date, INVARIANT_FORMAT);\r\n        return formattedDate;\r\n    };\r\n    this.getDateFromISO = function (value, showTime) {\r\n        var ISO_FORMAT = \"yyyy-MM-dd\" + (showTime ? \" HH:mm\" : \"\");\r\n        var date = bizagi.util.dateFormatter.getDateFromFormat(value, ISO_FORMAT);\r\n        // If the date could not be parsed, try it out with seconds\r\n        if (date == 0 && showTime) {\r\n            ISO_FORMAT = \"yyyy-MM-dd\" + (showTime ? \" HH:mm:ss\" : \"\");\r\n            date = bizagi.util.dateFormatter.getDateFromFormat(value, ISO_FORMAT);\r\n        }\r\n\r\n        // Also try to read the date with full format if the last instruction didn't success\r\n        if (date == 0 && !showTime) {\r\n            ISO_FORMAT = \"yyyy-MM-dd HH:mm\";\r\n            date = bizagi.util.dateFormatter.getDateFromFormat(value, ISO_FORMAT);\r\n            // If the date could not be parsed, try it out with seconds\r\n            if (date == 0) {\r\n                ISO_FORMAT = \"yyyy-MM-dd HH:mm:ss\";\r\n                date = bizagi.util.dateFormatter.getDateFromFormat(value, ISO_FORMAT);\r\n            }\r\n        }\r\n\r\n        return date;\r\n    };\r\n    this.formatISO = function (date, showTime) {\r\n        var ISO_FORMAT = \"yyyy-MM-dd\" + (showTime ? \" HH:mm\" : \"\");\r\n        var formattedDate = bizagi.util.dateFormatter.formatDate(date, ISO_FORMAT);\r\n        return formattedDate;\r\n    };\r\n\r\n    this.formatISO8601 = function (dateObject, restartTimeToMidnight) {\r\n        var restartTimeToMidnight = restartTimeToMidnight || false;\r\n        var ISO_FORMAT8601 = \"yyyy-MM-ddTHH:mm:ss\";\r\n        if (restartTimeToMidnight) {\r\n            dateObject.setHours(0, 0, 0, 0);\r\n        }\r\n        return bizagi.util.dateFormatter.formatDate(dateObject, ISO_FORMAT8601);\r\n    };\r\n\r\n    this.isFormatISO8601 = function (stringDate) {\r\n        var ISO_8601_WITH_TIME = /^\\d{4}-\\d\\d-\\d\\dT\\d\\d:\\d\\d:\\d\\d(\\.\\d+)?(([+-]\\d\\d:\\d\\d)|Z)?$/i\r\n        return ISO_8601_WITH_TIME.test(stringDate);\r\n    };\r\n\r\n    this.sleep = function (delay) {\r\n        // Delay in miliseconds\r\n        var start = new Date().getTime();\r\n        while (new Date().getTime() < start + delay) {\r\n            // wait\r\n        }\r\n    };\r\n    this.getDateFormatByDatePickerJqueryUI = function () {\r\n        return bizagi.localization.getResource(\"dateFormat\").replace(\"yyyy\", \"yy\");\r\n    }\r\n};\r\n/*\r\n * Use localStorage in html5 verfiy supports and operations \r\n * http://dev.w3.org/html5/webstorage/#dom-storage-setitem\r\n */\r\n\r\nbizagi.util.browserSupportLocalStorage = function () {\r\n    try {\r\n        return 'localStorage' in window && window['localStorage'] !== null;\r\n    } catch (e) {\r\n        return false;\r\n    }\r\n};\r\n/*\r\n *set the item  in the local storage\r\n */\r\nbizagi.util.setItemLocalStorage = function (key, value) {\r\n    if (bizagi.util.browserSupportLocalStorage()) {\r\n        localStorage.setItem(key, value);\r\n        return true;\r\n    } else {\r\n        return false;\r\n    }\r\n};\r\n\r\nbizagi.util.getItemLocalStorage = function (key) {\r\n    return localStorage.getItem(key);\r\n};\r\n\r\nbizagi.util.removeItemLocalStorage = function (key) {\r\n    localStorage.removeItem(key);\r\n};\r\n\r\nbizagi.util.clearLocalStorage = function () {\r\n    if (bizagi.util.browserSupportLocalStorage())\r\n        localStorage.clear();\r\n};\r\n\r\nfunction printf(msg) {\r\n    var args = Array.prototype.slice.call(arguments, 1), arg;\r\n    return msg.replace(/(%[disv])/g, function (a, val) {\r\n        arg = args.shift();\r\n        if (arg !== undefined) {\r\n            switch (val.charCodeAt(1)) {\r\n                case 100:\r\n                    return +arg; // d\r\n                case 105:\r\n                    return Math.round(+arg); // i\r\n                case 115:\r\n                    return String(arg); // s\r\n                case 118:\r\n                    return arg; // v\r\n            }\r\n        }\r\n        return val;\r\n    });\r\n}\r\n\r\n\r\n// Fix problem with console.log when we forgot to remove it\r\n(function () {\r\n    var environment = (typeof BIZAGI_ENVIRONMENT != \"undefined\") ? BIZAGI_ENVIRONMENT : \"release\";\r\n    if (environment == 'debug') {\r\n        if (typeof window.console != \"object\") {\r\n            window.console = {\r\n                log: function (msg) { /*Nothing to do*/ }\r\n            };\r\n        }\r\n    } else {\r\n        if (typeof console != \"object\") {\r\n            window.console = {\r\n                log: function (msg) { /*Nothing to do*/ }\r\n            };\r\n        } else if (bizagiConfig && !bizagiConfig.showConsoleLog) {\r\n            console.log = function (a) { /*Nothing to do*/ };\r\n        }\r\n    }\r\n})();\r\n\r\nbizagi.util.smartphone.startLoading = function (container) {\r\n    var elementToapply = container || $(\"body\");\r\n    elementToapply.append('<div class=\"bz-util-loading-container\"> <div class=\"ui-bizagi-loading-icon bz-util-loading\"></div>  </div>');\r\n};\r\nbizagi.util.smartphone.stopLoading = function (container) {\r\n    var elementToapply = container || $(\"body\");\r\n    $(\".bz-util-loading-container\", elementToapply).remove();\r\n};\r\n\r\n\r\n\r\n/**\r\n * determines whether the element in the browser supports the event we are looking for, eg 'paste', 'input', 'blur', etc. More info check modernizer.js.\r\n * @param  {string|*}           eventName  is the name of an event to test for (e.g. \"resize\")\r\n * @param  {(Object|string|*)=} element    is the element|document|window|tagName to test on\r\n * @return {boolean}\r\n */\r\nbizagi.util.isEventSupported = function (eventName, element) {\r\n    var needsFallback = !('onblur' in document.documentElement);\r\n    var isSupported;\r\n\r\n    if (!eventName) {\r\n        return false;\r\n    }\r\n    if (!element || typeof element === 'string') {\r\n        element = document.createElement(element || 'div');\r\n    }\r\n\r\n    // Testing via the `in` operator is sufficient for modern browsers and IE.\r\n    // When using `setAttribute`, IE skips \"unload\", WebKit skips \"unload\" and\r\n    // \"resize\", whereas `in` \"catches\" those.\r\n    eventName = 'on' + eventName;\r\n    isSupported = eventName in element;\r\n\r\n    // Fallback technique for old Firefox - bit.ly/event-detection\r\n    if (!isSupported && needsFallback) {\r\n        if (!element.setAttribute) {\r\n            // Switch to generic element if it lacks `setAttribute`.\r\n            // It could be the `document`, `window`, or something else.\r\n            element = document.createElement('div');\r\n        }\r\n        if (element.setAttribute && element.removeAttribute) {\r\n            element.setAttribute(eventName, '');\r\n            isSupported = typeof element[eventName] === 'function';\r\n\r\n            if (element[eventName] !== undefined) {\r\n                // If property was created, \"remove it\" by setting value to `undefined`.\r\n                element[eventName] = undefined;\r\n            }\r\n            element.removeAttribute(eventName);\r\n        }\r\n    }\r\n    return isSupported;\r\n};\r\n\r\n\r\n/**\r\n * Execute deferreds in order\r\n * @example var a = new bizagiQueue(); a.add(function);\r\n * \r\n */\r\nfunction bizagiQueue() {\r\n    var self = this;\r\n    var queue = [];\r\n\r\n    self.add = function (callback) {\r\n        queue.push({ callbacks: [callback] });\r\n    };\r\n\r\n    self.addParallel = function (callback) {\r\n        if (queue.length == 0) {\r\n            return self.add(callback);\r\n        }\r\n\r\n        // Put a parallel on last item\r\n        var last = queue[queue.length - 1];\r\n        last.callbacks.push(callback);\r\n    };\r\n\r\n    self.execute = function () {\r\n        var starter = new $.Deferred();\r\n        var promise = starter.promise();\r\n        var queueLength = queue.length;\r\n        for (var i = 0; i < queueLength; i++) {\r\n            promise = promise.pipe(function () {\r\n                var element = queue.shift();\r\n                return $.when.apply($, $.map(element.callbacks, function (callback) {\r\n                    // Function support\r\n                    if (typeof (callback) == \"function\") {\r\n                        var deferred = $.Deferred();\r\n                        $.when(callback()).done(function () {\r\n                            deferred.resolve();\r\n                        }).fail(function () {\r\n                            deferred.resolve();\r\n                        });\r\n                        return deferred.promise();\r\n                    }\r\n                    // Deferred support\r\n                    return callback;\r\n                }))\r\n            });\r\n        }\r\n\r\n        starter.resolve();\r\n        promise = promise.done(function () {\r\n            // Reset queue\r\n            queue = [];\r\n        });\r\n\r\n        return promise;\r\n    };\r\n}\r\n\r\n\r\n/**\r\n * Calculate circular dependencies \r\n * \r\n * @example var a = new bizagi.circularDependencies(); a.addNode('name',obj);\r\n * a.resolve(node);\r\n * \r\n */\r\n//TODO: DEPL - Check this because we agreed to a much simpler solution\r\nbizagi.circularDependencies = function () {\r\n    var circularDependencies = new Function();\r\n    var self = circularDependencies.prototype;\r\n    self.list = []; //[{ name: \"root\", obj: {}, nodeObj: {}, childs: {} }];\r\n    self.lastNodeAdded; // Undefined reference\r\n\r\n    self.addNode = function (name, obj) {\r\n        var OBJ = JSON.encode(obj);\r\n        var foundObjChildNode = _search(name, OBJ);\r\n        if (foundObjChildNode) {\r\n            var lastNode = self.lastNodeAdded || self.list[self.list.length - 1];\r\n            lastNode.nodeObj.addChild(foundObjChildNode.nodeObj);\r\n            self.lastNodeAdded = foundObjChildNode;\r\n        } else {\r\n            var node = new _addNode(name, OBJ);\r\n            self.list.push({\r\n                name: name,\r\n                obj: OBJ,\r\n                nodeObj: node,\r\n                timeStamp: new Date().getTime()\r\n            });\r\n            return node;\r\n        }\r\n    };\r\n\r\n    self.resolve = function (node, resolved, seen) {\r\n        // if dont setted node variable, take the first one -> root\r\n        node = node || _getFirstNodeWithChilds() || self.list[0].nodeObj;\r\n        var resolveDependencies = new _resolve(node, resolved, seen);\r\n        return resolveDependencies;\r\n    };\r\n\r\n    var _resetList = function () {\r\n        self.list = [];\r\n    };\r\n\r\n    var _getFirstNodeWithChilds = function () {\r\n        for (var i = 0; i < self.list.length; i++) {\r\n            if (self.list[i].nodeObj.childs.length > 0) {\r\n                return self.list[i].nodeObj;\r\n            }\r\n        }\r\n        return (self.list.length > 0) ? self.list[0].nodeObj : {};\r\n    };\r\n\r\n    var _search = function (name, obj) {\r\n        for (var i = 0; i < self.list.length; i++) {\r\n            if (self.list[i].name == name) {\r\n                // remove tag element\r\n                var now = new Date().getTime();\r\n                var timeToKeep = 1000; //milliseconds\r\n                if ((self.list[i].timeStamp + timeToKeep) < now) {\r\n                    //remove element from the list\r\n                    self.list.splice(i, 1);\r\n                } else if (self.list[i].obj == obj) {\r\n                    return self.list[i];\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n\r\n    var _addNode = (function (name, obj) {\r\n        name = name || \"\";\r\n        obj = obj || {};\r\n        var node = function (name, obj) {\r\n            this.name = name;\r\n            this.obj = obj;\r\n            this.childs = [];\r\n        };\r\n        var self = node.prototype;\r\n\r\n        self.addChild = function (node) {\r\n            this.childs.push(node);\r\n        };\r\n\r\n        return node;\r\n    })();\r\n\r\n    var _resolve = (function (node, resolved, seen) {\r\n        var resolve = function (node, resolved, seen) {\r\n            this.node = node || {};\r\n            this.node.childs = this.node.childs || [];\r\n            this.resolved = resolved || [];\r\n            this.seen = seen || [];\r\n\r\n            this.seen.push(this.node);\r\n\r\n            for (var i = 0; i < this.node.childs.length; i++) {\r\n                if (!self.hasObject(this.node.childs[i], this.resolved)) {\r\n                    if (self.hasObject(this.node.childs[i], this.seen)) {\r\n                        //throw new _error(\"error node:\" + node.name + \" -> \" + node.childs[i].name);\r\n                        _resetList();\r\n                        var error = {\r\n                            dependencyFrom: this.node.name,\r\n                            dependencyFromObj: this.node.obj,\r\n                            dependencyTo: this.node.childs[i].name,\r\n                            dependencyToObj: this.node.childs[i].obj,\r\n                            path: this.seen\r\n                        };\r\n\r\n                        return {\r\n                            error: $.extend({\r\n                                standardError: {\r\n                                    status: \"error\",\r\n                                    responseText: JSON.encode({ message: self.makeErrorMessage(error), type: \"alert\" })\r\n                                },\r\n                                multiactionError: {\r\n                                    message: self.makeErrorMessage(error),\r\n                                    type: \"alert\"\r\n                                }\r\n                            }, error)\r\n                        };\r\n                    } else {\r\n                        return resolve(this.node.childs[i], this.resolved, this.seen);\r\n                    }\r\n                }\r\n            }\r\n            if (this.resolved) {\r\n                this.resolved.push(this.node);\r\n            }\r\n        };\r\n\r\n        var self = resolve.prototype;\r\n\r\n        self.hasObject = function (toSearch, collection) {\r\n\r\n            for (var i = 0; i < collection.length; i++) {\r\n                if (collection[i].name == toSearch.name) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        };\r\n\r\n        self.makeErrorMessage = function (error) {\r\n            var messageTmpl = bizagi.localization.getResource(\"render-actions-loop-validation\");\r\n\r\n            return printf(messageTmpl, error.dependencyFrom, error.dependencyTo);\r\n\r\n            /*  return {\r\n                  responseText: parsedMessage,\r\n                  message: parsedMessage,\r\n                  extraInfo: error\r\n              };*/\r\n        };\r\n\r\n        return resolve;\r\n    })();\r\n\r\n    return self;\r\n};\r\n\r\n/**\r\n * Apply css string style (one or more). It works to add or override a specific style even if it has !important\r\n * \r\n * @example bizagi.util.cssExtended($('.myClass'), 'display:none!important;color:red');\r\n * \r\n */\r\nbizagi.util.cssExtended = function (instance, options) {\r\n    var cssToAdd = options.split(\";\");\r\n\r\n    for (i = 0; i < cssToAdd.length; i++) {\r\n        if (cssToAdd[i] != \"\") {\r\n            bizagi.util.cssExtendedApplyChanges(instance, cssToAdd[i]);\r\n        }\r\n    }\r\n\r\n};\r\n\r\n/**\r\n * Apply the style change \r\n * \r\n */\r\nbizagi.util.cssExtendedApplyChanges = function (instance, option) {\r\n\r\n    for (var i = 0; i < instance.length; i++) {\r\n        var $this = $(instance[i]);\r\n        var attrToAdd = option.split(\":\")[0];\r\n\r\n        if ($this.attr('style')) {\r\n            var tmpStyle = $this.attr('style').split(\";\");\r\n            var arrProperties = [];\r\n            var resultProperties = \"\";\r\n\r\n            for (j = 0; j < tmpStyle.length; j++) {\r\n                var cssProperty = tmpStyle[j].split(\":\");\r\n\r\n                if ($.trim(cssProperty[0]) != attrToAdd && $.trim(cssProperty[0]) != \"\") {\r\n                    arrProperties.push(cssProperty[0] + \":\" + cssProperty[1] + \";\");\r\n                }\r\n                resultProperties = JSON.stringify(arrProperties).replace(/\\\",\"/g, ' ').replace(/\\[\"/g, ' ').replace(/\\\"]/g, ' ');\r\n            }\r\n\r\n            resultProperties = resultProperties == \"[]\" ? \"\" : resultProperties;\r\n\r\n            $this.attr('style', resultProperties + option + \";\");\r\n        } else if ($this.css(attrToAdd)) {\r\n            var tmpStyle = $this.css(attrToAdd);\r\n            var arrProperties = [];\r\n            var resultProperties = \"\";\r\n\r\n            arrProperties.push(option + \";\");\r\n\r\n            resultProperties = resultProperties == \"[]\" ? \"\" : resultProperties;\r\n\r\n            $this.attr('style', resultProperties + option + \";\");\r\n        }\r\n    }\r\n};\r\n\r\n/*\r\n * Find element to make scroll top\r\n */\r\nbizagi.util.scrollTop = function (canvas) {\r\n    if (canvas && canvas[0]) {\r\n        while (canvas[0].tagName !== \"HTML\" && canvas.css(\"overflow-y\") != \"scroll\" && canvas.css(\"overflow-y\") != \"auto\" && canvas.parent().length > 0) {\r\n            canvas = canvas.parent();\r\n        }\r\n    }\r\n    return canvas;\r\n};\r\n\r\n/*\r\n * Sort a JSON array by attribute and order type (ascendant or descendant)\r\n * example: data = [ {attr1:val1, attr2:val2} , {attr1:val3, attr2:val4 },... ]  , key = \"attr2\" , way = \"asc\"\r\n */\r\nbizagi.util.sortJSON = function (data, key, way) {\r\n    return data.sort(function (a, b) {\r\n        var x = a[key];\r\n        var y = b[key];\r\n        if (way === 'asc') {\r\n            return ((x < y) ? -1 : ((x > y) ? 1 : 0));\r\n        }\r\n        if (way === 'desc') {\r\n            return ((x > y) ? -1 : ((x < y) ? 1 : 0));\r\n        }\r\n    });\r\n};\r\n\r\n/*\r\n * Reducir formato numérico a notación abrevidad (K:1000 - M:1000000 - B:1000000000)\r\n */\r\nbizagi.util.shortNumber = function (number) {\r\n    var newNumber = number.toString();\r\n    var lenghtNumber = newNumber.length;\r\n\r\n    if (lenghtNumber >= 4 && lenghtNumber < 7) {\r\n        newNumber = '+' + newNumber.charAt(0) + 'K';\r\n    } else if (lenghtNumber >= 7 && lenghtNumber < 10) {\r\n        newNumber = '+' + newNumber.charAt(0) + 'M';\r\n    } else if (lenghtNumber >= 10) {\r\n        newNumber = '+' + newNumber.charAt(0) + 'B';\r\n    }\r\n\r\n    return '&nbsp;&nbsp;&nbsp;' + newNumber;\r\n};\r\n\r\n/*\r\n * Aplicar formato salto de linea\r\n */\r\nbizagi.util.replaceLineBreak = function (string) {\r\n    return typeof string === \"string\" ? string.replace(/\\r\\n|\\r|\\n|<br>|<br\\/>/g, \"<br/>\") : string;\r\n};\r\n\r\n// http://shebang.brandonmintern.com/foolproof-html-escaping-in-javascript/\r\nbizagi.util.escapeHtml = function (str) {\r\n    var div = document.createElement('div');\r\n    div.appendChild(document.createTextNode(str));\r\n    return div.innerHTML;\r\n}\r\n\r\n\r\n/*\r\n * Aplicar formato Tipo moneda\r\n */\r\nbizagi.util.formatMonetaryCell = function (value) {\r\n    return bizagi.util.formatMoney(value, BIZAGI_DEFAULT_CURRENCY_INFO);\r\n};\r\n\r\n/*\r\n * Aplicar formato tipo decimal\r\n */\r\nbizagi.util.formatDecimalCell = function (value) {\r\n    var decimalFormat;\r\n    var externalDecimalFormat = {\r\n        decimalSymbol: BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator,\r\n        digitGroupSymbol: BIZAGI_DEFAULT_CURRENCY_INFO.groupSeparator,\r\n        roundToDecimalPlace: BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits\r\n    };\r\n    var defaultDecimalFormat = {\r\n        colorize: false,\r\n        decimalSymbol: \".\",\r\n        digitGroupSymbol: \",\",\r\n        groupDigits: true,\r\n        negativeFormat: \"(%s%n)\",\r\n        positiveFormat: \"%s%n\",\r\n        roundToDecimalPlace: \"2\",\r\n        symbol: \"\"\r\n    };\r\n    decimalFormat = $.extend(defaultDecimalFormat, externalDecimalFormat);\r\n    var numberValue = bizagi.util.formatDecimal(value, decimalFormat);\r\n    if (bizagi.override.removeTrailingZeros === true) {\r\n        var positive = true;\r\n        if (numberValue.toString().indexOf(\")\") != -1) {\r\n            positive = false;\r\n            numberValue = numberValue.replace(\"(\", \"\").replace(\")\", \"\");\r\n        }\r\n        var re = new RegExp(\"(\" + BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator + \"\\\\d*?[1-9])0+$\", \"g\");\r\n        numberValue = numberValue.replace(re, \"$1\");\r\n        re = new RegExp(\"\\\\\" + BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator + \"0+$\", \"g\");\r\n        numberValue = numberValue.replace(re, \"\");\r\n\r\n\r\n        if (!positive) numberValue = \"(\" + numberValue + \")\";\r\n    }\r\n    return numberValue;\r\n};\r\n\r\n/*\r\n * Crea notificacion de corta duracion, principalmente uilizada en para los procesos offline\r\n */\r\nbizagi.util.showNotification = function (params) {\r\n    var params = params || {};\r\n    var div_sync = $('<div id=\"sync-notification\" class=\"bz-cm-icon\"></div>').text(params.text || \"\");\r\n    div_sync.appendTo($('body'));\r\n    div_sync.fadeIn(1500, function () {\r\n        div_sync.stop();\r\n    });\r\n\r\n    div_sync.fadeOut(2000, function () {\r\n        div_sync.remove();\r\n    });\r\n};\r\n\r\n/*\r\n * Verificar el estado de la conexión\r\n */\r\nbizagi.util.isModeOnline = function () {\r\n    return typeof bizagi.context.isOfflineForm !== \"undefined\" && !bizagi.context.isOfflineForm;\r\n};\r\n\r\nbizagi.util.dispose = function (obj) {\r\n    for (key in obj) {\r\n        if (typeof (obj[key]) == \"object\") delete obj[key];\r\n        if (typeof (obj[key]) == \"function\") { obj[key] = null; delete obj[key]; }\r\n    }\r\n};\r\n\r\nbizagi.util.arrayEach = function (array, callback) {\r\n    if (!!array) {\r\n        if (Object.prototype.toString.apply(array) === \"[object Array]\" && Object.prototype.toString.apply(callback) === \"[object Function]\") {\r\n            var index, value;\r\n            for (index in array) {\r\n                if (array.hasOwnProperty(index)) {\r\n                    value = callback.call(array[index], index, array[index]);\r\n                    if (value === false) {\r\n                        return;\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            $.each(array, callback);\r\n        }\r\n    }\r\n};\r\n\r\n//remove all the character except the +, - and decimal point\r\nbizagi.util.getStandardNotation = function (number, decimalSymbol) {\r\n    var plusCharacter = '+';\r\n    var minusCharacter = '-';\r\n    var decimalSymbol = decimalSymbol || '.';\r\n    var expSymbol = 'e';\r\n    var tmp = '';\r\n    //remove all the character except the +, -, decimal point and the numbers\r\n    var decimalNumber = false;\r\n    var exponentialNumber = false;\r\n    number = (number.length > 0 ? number.toString().toLowerCase() : '').replace(/ /g, '');\r\n    for (var i = 0; i < number.length; i++) {\r\n        if ((number[i] === plusCharacter || number[i] === minusCharacter) && (i === 0 || number[i - 1] == expSymbol)) {\r\n            tmp += number[i];\r\n        } else if (!isNaN(Number(number[i]))) {\r\n            tmp += number[i];\r\n        } else if ((number[i] === decimalSymbol) && !decimalNumber) {\r\n            tmp += number[i];\r\n            decimalNumber = true;\r\n        } else if ((number[i] === expSymbol) && !exponentialNumber) {\r\n            tmp += number[i];\r\n            exponentialNumber = true;\r\n        }\r\n    }\r\n    return tmp;\r\n};\r\n//Return it in normalized scientific notation\r\nbizagi.util.scientificNotationFormat = function (number, decimalSymbol, sdLimit, expMinLimit, expMaxLimit) {\r\n    decimalSymbol = decimalSymbol || '.';\r\n    number = bizagi.util.getStandardNotation(number, decimalSymbol);\r\n    sdLimit = (sdLimit > 0) ? sdLimit : 38;\r\n    expMinLimit = (expMinLimit > 0) ? expMinLimit : -125;\r\n    expMaxLimit = (expMaxLimit > 0) ? expMaxLimit : 125;\r\n    var expSimbol = 'e';\r\n    var sNregex = new RegExp('[0-9]+(' + decimalSymbol + '[0-9]+)?(e[+-]?[0-9]+)?');\r\n    var sNFormat = number.match(sNregex);\r\n\r\n    //get que prefix\r\n    var exp = 0;\r\n\r\n    var prefix = number[0] === '-' ? number[0] : '';\r\n    var originalPointIndex = 0;\r\n\r\n    number = number.replace(prefix, '');\r\n\r\n    //if the number is not in scientific notation\r\n    if (sNFormat && sNFormat[0] && sNFormat[2]) {\r\n        var tempParts = sNFormat[0] ? (sNFormat[0].replace(sNFormat[2], '').split(decimalSymbol)) : '';\r\n\r\n        var significantDigits = '';\r\n        var intPart = '';\r\n\r\n        //calculate significant digits\r\n        //remove zeros at the left\r\n        tempParts[0] = tempParts[0].replace(/^0+/g, '');\r\n\r\n        if (tempParts[0].length > 1) {\r\n            significantDigits = tempParts[0].slice(1);\r\n            originalPointIndex = significantDigits.length;\r\n            intPart = tempParts[0][0] || '';\r\n            significantDigits = significantDigits.concat(sNFormat[1] || '');\r\n        } else if (tempParts[0].length === 1) {\r\n            intPart = tempParts[0][0] || '';\r\n            significantDigits = significantDigits.concat(tempParts[1] || '');\r\n        } else {\r\n            originalPointIndex = tempParts[1].length;\r\n            tempParts[1] = tempParts[1].replace(/^0+/g, '');\r\n            originalPointIndex = (tempParts[1].length - 1) - originalPointIndex;\r\n            intPart = tempParts[1][0];\r\n            significantDigits = tempParts[1].slice(1);\r\n        }\r\n        //remove . and zeros from significant digits\r\n        significantDigits = significantDigits.replace(decimalSymbol, '').replace(/0+$/g, '');\r\n\r\n        if (significantDigits.length >= sdLimit) {\r\n            significantDigits = significantDigits.slice(0, sdLimit - 1);\r\n        }\r\n        exp = Number(sNFormat[2].replace(expSimbol, '')) + originalPointIndex;\r\n        exp = (exp > expMaxLimit) ? expMaxLimit : (exp < expMinLimit) ? expMinLimit : exp;\r\n        return prefix + intPart + (significantDigits ? (decimalSymbol + significantDigits) : '') + expSimbol + (exp > 0 ? '+' + exp : exp);\r\n    } else if (number) {\r\n\r\n        originalPointIndex = number.indexOf(decimalSymbol);\r\n        var from = 0;\r\n        var to = number.length - 1;\r\n\r\n        //remove decimal point\r\n        number = number.replace(decimalSymbol, '');\r\n\r\n        //from\r\n        var i = from;\r\n        while (!significantFlag) {\r\n            if (number[i] !== '0' && number[i] !== decimalSymbol) {\r\n                significantFlag = true;\r\n                from = i;\r\n            } else { i++; }\r\n        }\r\n        //to\r\n        var significantFlag = false;\r\n        var j = to;\r\n        while (!significantFlag) {\r\n            if (number[j] !== '0' && number[j] !== decimalSymbol && '-') {\r\n                significantFlag = true;\r\n                to = j + 1;\r\n            } else { j--; }\r\n        }\r\n        to = to > sdLimit + from ? sdLimit + from : to;\r\n        if (originalPointIndex !== -1) {\r\n            //find significant digits\r\n            var significantFlag = false;\r\n            var significantDigits = number.slice(from, to);\r\n            var pointIndex = from + 1;\r\n            exp = originalPointIndex - pointIndex;\r\n            if (significantDigits.length > 0 && !isNaN(Number(significantDigits[0]))) {\r\n                return prefix + significantDigits[0] + (significantDigits.length > 1 ? decimalSymbol + significantDigits.slice(1) : '') + expSimbol + (exp > 0 ? '+' + exp : exp);\r\n            } else { return '0'; }\r\n\r\n        } else {\r\n            //Int numbers\r\n            var firstDigit = number.slice(from, from + 1);\r\n            var restDigits = number.slice(from + 1, number.length);\r\n            exp = restDigits.length;\r\n            restDigits = restDigits.replace(/0+$/g, '');\r\n            if (restDigits.length > sdLimit) {\r\n                restDigits = number.slice(from + 1, sdLimit + from);\r\n            }\r\n            if (Number(firstDigit)) {\r\n                return prefix + firstDigit + (restDigits.length > 0 ? decimalSymbol + restDigits : '') + expSimbol + (exp > 0 ? '+' + exp : exp);\r\n            } else { return '0'; }\r\n        }\r\n    } else { return ''; }\r\n};\r\n\r\n/**\r\n * Remove all backslashes that represent scape of characters\r\n */\r\nbizagi.util.stripslashes = function (str) {\r\n    return str.replace(/\\\\'/g, '\\'').replace(/\\\"/g, '\"').replace(/\\\\\\\\/g, '\\\\').replace(/\\\\0/g, '\\0');\r\n};\r\n\r\n/*\r\n * Validates if the text is a valid opening and closing tags, including classes\r\n */\r\nbizagi.util.isHTMLValidText = function (text) {\r\n    var ex = new RegExp(/<(.|\\n)*?>/g);\r\n    return ex.test(text);\r\n};\r\n\r\nbizagi.util.resetData = function () {\r\n    var obj = JSON.parse(sessionStorage.getItem(\"bizagiAuthentication\"));\r\n    sessionStorage.removeItem(\"bizagiAuthentication\");\r\n    $.extend(obj, { isAuthenticate: \"false\" });\r\n    sessionStorage.setItem(\"bizagiAuthentication\", JSON.encode(obj));\r\n};\r\n\r\nbizagi.util.changeData = function (params) {\r\n    var obj = JSON.parse(sessionStorage.getItem(\"bizagiAuthentication\"));\r\n    sessionStorage.removeItem(\"bizagiAuthentication\");\r\n    $.extend(obj, params);\r\n    sessionStorage.setItem(\"bizagiAuthentication\", JSON.encode(obj));\r\n};\r\n\r\n// ------------------------------------------------------------------------\r\n// UTILS FOR MOBILE DEVICE\r\n// ------------------------------------------------------------------------\r\n\r\nbizagi.util.isMobileDevice = function (device) {\r\n    device = device || bizagi.detectDevice();\r\n\r\n    return ([\r\n        \"smartphone_ios\",\r\n        \"smartphone_ios_native\",\r\n        \"smartphone_android\",\r\n        \"smartphone_android_native\",\r\n        \"tablet\",\r\n        \"tablet_ios\",\r\n        \"tablet_ios_native\",\r\n        \"tablet_android\",\r\n        \"tablet_android_native\"\r\n    ].indexOf(device) > -1);\r\n};\r\n\r\n/** \r\n * Verify mobile device type\r\n * @returns {} \r\n */\r\nbizagi.util.isTabletDevice = function (device) {\r\n    device = device || bizagi.util.detectDevice();\r\n\r\n    return ([\r\n        \"tablet\",\r\n        \"tablet_ios\",\r\n        \"tablet_ios_native\",\r\n        \"tablet_android\",\r\n        \"tablet_android_native\"\r\n    ].indexOf(device) > -1);\r\n};\r\n\r\n/**\r\n * Tablet android\r\n * @returns {} \r\n */\r\nbizagi.util.isAndroidTabletDevice = function (device) {\r\n    device = device || bizagi.util.detectDevice();\r\n\r\n    return bizagi.util.isTabletDevice() && (device.indexOf(\"android\") !== -1);\r\n};\r\n\r\n/**\r\n * Tablet iOS\r\n * @returns {} \r\n */\r\nbizagi.util.isiOSTabletDevice = function (device) {\r\n    device = device || bizagi.util.detectDevice();\r\n\r\n    return bizagi.util.isTabletDevice() && !(device.indexOf(\"android\") === -1);\r\n};\r\n\r\n\r\n/**\r\n * Verify mobile device type\r\n * @returns {}\r\n */\r\nbizagi.util.isSmartphoneDevice = function (device) {\r\n    device = device || bizagi.util.detectDevice();\r\n\r\n    return ([\r\n        \"smartphone_ios\",\r\n        \"smartphone_ios_native\",\r\n        \"smartphone_android\",\r\n        \"smartphone_android_native\"\r\n    ].indexOf(device) > -1);\r\n};\r\n\r\n/**\r\n * Smartphone android\r\n * @returns {} \r\n */\r\nbizagi.util.isAndroidSmartphoneDevice = function (device) {\r\n    device = device || bizagi.util.detectDevice();\r\n\r\n    return bizagi.util.isSmartphoneDevice() && (device.indexOf(\"android\") !== -1);\r\n};\r\n\r\n/**\r\n * Smartphone iOS\r\n * @returns {} \r\n */\r\nbizagi.util.isiOSSmartphoneDevice = function (device) {\r\n    device = device || bizagi.util.detectDevice();\r\n\r\n    return bizagi.util.isSmartphoneDevice() && (device.indexOf(\"ios\") !== -1);\r\n};\r\n\r\n/**\r\n * Check is offline form\r\n * @param {} container \r\n * @returns {} \r\n */\r\nbizagi.util.isOfflineForm = function (params) {\r\n    if (!bizagi.util.isMobileDevice() || typeof (params) === \"undefined\")\r\n        return false;\r\n\r\n    var context = params.context || null;\r\n    var container = params.container || null;\r\n\r\n    var formContainer = container !== null ?\r\n        container : (context !== null ? context.getFormContainer() : null);\r\n\r\n    if (formContainer === null)\r\n        return false;\r\n\r\n    var formParams = formContainer.getParams() || {};\r\n    var isOfflineForm = typeof (formParams.isOfflineForm) !== \"undefined\" &&\r\n        bizagi.util.parseBoolean(formParams.isOfflineForm);\r\n\r\n    return isOfflineForm;\r\n};\r\n\r\nbizagi.util.detectAndroidVersion = function () {\r\n    var indexAndroid = navigator.userAgent.toLowerCase().indexOf(\"android\");\r\n    var androidVersion = navigator.userAgent.toLowerCase().substring(indexAndroid + 8, indexAndroid + 13);\r\n    androidVersion = androidVersion.replaceAll(\".\", \"\");\r\n    return Number(androidVersion);\r\n};\r\n\r\nbizagi.util.getPathUrl = function (url) {\r\n    var solvedUrl = \"\";\r\n    var locationParts = location.pathname.split(\"/\");\r\n    var basePath = location.protocol + \"//\" + location.host;\r\n\r\n    if (BIZAGI_PATH_TO_BASE[0] == \"/\") {\r\n        solvedUrl = basePath + BIZAGI_PATH_TO_BASE + url;\r\n    } else {\r\n        var pathToBaseBackwards = BIZAGI_PATH_TO_BASE.split(\"../\").length;\r\n        for (var i = 0, l = locationParts.length; i < l - pathToBaseBackwards; i++) {\r\n            basePath += locationParts[i] + \"/\";\r\n        }\r\n\r\n        basePath = basePath[basePath.length - 1] === \"/\" ? basePath : basePath + \"/\";\r\n        solvedUrl = basePath + url;\r\n    }\r\n    return solvedUrl;\r\n};\r\n\r\n/**\r\n * Get Android version\r\n * @returns {} \r\n */\r\nbizagi.util.getAndroidVersion = function () {\r\n    var userAgent = navigator.userAgent.toLowerCase();\r\n    var match = userAgent.match(/android\\s([0-9\\.]*)/);\r\n\r\n    return match ? parseFloat(match[1]) : false;\r\n};\r\n\r\n/**\r\n * Get image path to android device\r\n * @param {} image \r\n * @returns {} \r\n */\r\nbizagi.util.mobileImagePath = function (image) {\r\n    var dataImage = image;\r\n    var version = bizagi.util.getAndroidVersion();\r\n\r\n    if (!version)\r\n        return dataImage;\r\n\r\n    if (dataImage.substring(0, 21) === \"content://com.android\" && version <= 4.4) {\r\n        var photoSplit = dataImage.split(\"%3A\");\r\n        if (photoSplit.length > 1) {\r\n            dataImage = \"content://media/external/images/media/\" + photoSplit[1];\r\n        } else {\r\n            photoSplit = dataImage.split(\"/\");\r\n            dataImage = \"content://media/external/images/media/\" + photoSplit[photoSplit.length - 1];\r\n        }\r\n    }\r\n\r\n    return dataImage;\r\n};\r\n\r\n/**\r\n * Validate resource \r\n * @param {} resource resource name\r\n * @returns {} \r\n */\r\nbizagi.util.isValidResource = function (resource) {\r\n    if (!bizagi.localization) return false;\r\n    return (bizagi.localization.getResource(resource) !== resource);\r\n};\r\n\r\n/***\r\n * Transform base64 image to blob\r\n * @b64Data \r\n * @contentType \r\n * @sliceSize \r\n */\r\nbizagi.util.b64toBlob = function (b64Data, contentType, sliceSize) {\r\n    contentType = contentType || '';\r\n    sliceSize = sliceSize || 512;\r\n\r\n    var byteCharacters = atob(b64Data);\r\n    var byteArrays = [];\r\n\r\n    for (var offset = 0; offset < byteCharacters.length; offset += sliceSize) {\r\n        var slice = byteCharacters.slice(offset, offset + sliceSize);\r\n\r\n        var byteNumbers = new Array(slice.length);\r\n        for (var i = 0; i < slice.length; i++) {\r\n            byteNumbers[i] = slice.charCodeAt(i);\r\n        }\r\n\r\n        var byteArray = new Uint8Array(byteNumbers);\r\n\r\n        byteArrays.push(byteArray);\r\n    }\r\n\r\n    var blob = new Blob(byteArrays, { type: contentType });\r\n    return blob;\r\n};\r\n\r\n/**\r\n * Converts an string to a byte array, util in old browsers requests\r\n * @param str\r\n */\r\nbizagi.util.stringToByteArray = function (str) {\r\n    var byteArray = new Uint8Array(str.length);\r\n    for (var i = 0; i < str.length; i++) {\r\n        byteArray[i] = str.charCodeAt(i) & 0xff;\r\n    }\r\n    return byteArray;\r\n}\r\n\r\n// ------------------------------------------------------------------------\r\n// NATIVE-HYBRID ENVIRONMENT\r\n// ------------------------------------------------------------------------\r\n\r\n/** \r\n * Verify the offline forms is enabled\r\n * @returns {} \r\n */\r\nbizagi.util.hasOfflineFormsEnabled = function () {\r\n    return typeof (BIZAGI_ENABLE_OFFLINE_FORMS) !== \"undefined\" && bizagi.util.parseBoolean(BIZAGI_ENABLE_OFFLINE_FORMS) === true;\r\n};\r\n\r\n/**\r\n * \r\n * Verify the flat design is enabled\r\n * @returns {} \r\n */\r\nbizagi.util.isFlatDesignEnabled = function () {\r\n    return typeof (BIZAGI_ENABLE_FLAT) !== \"undefined\" && bizagi.util.parseBoolean(BIZAGI_ENABLE_FLAT) === true;\r\n};\r\n\r\n/**\r\n * Validate the mobile grid is enabled\r\n * @returns {}\r\n */\r\nbizagi.util.isMobileGridEnabled = function () {\r\n    return typeof (BIZAGI_ENABLE_MOBILE_GRID) !== \"undefined\" && bizagi.util.parseBoolean(BIZAGI_ENABLE_MOBILE_GRID) === true;\r\n};\r\n\r\n/**\r\n * Validate the mobile grid is enabled\r\n * @returns {}\r\n */\r\nbizagi.util.isNativeHeaderEnabled = function () {\r\n    return typeof (NATIVE_HEADER_ENABLE) !== \"undefined\" && bizagi.util.parseBoolean(NATIVE_HEADER_ENABLE) === true;\r\n};\r\n\r\n/**\r\n * Validate the Quick search is enabled\r\n * @returns {}\r\n */\r\nbizagi.util.isQuickSearchEnabled = function () {\r\n    return typeof (BIZAGI_ENABLE_QUICK_SEARCH) !== \"undefined\" && bizagi.util.parseBoolean(BIZAGI_ENABLE_QUICK_SEARCH) === true;\r\n};\r\n\r\n/** \r\n * Verify the OAuth2 is enabled\r\n * @returns {} \r\n */\r\nbizagi.util.isOAuth2Enabled = function () {\r\n    return typeof (BIZAGI_AUTH_TYPE) !== \"undefined\" && BIZAGI_AUTH_TYPE === \"OAuth\";\r\n};\r\n\r\n/**\r\n * Get native component\r\n * @returns {}\r\n */\r\nbizagi.util.getNativeComponent = function () {\r\n    return typeof (BIZAGI_NATIVE_COMPONENT) !== \"undefined\" ? BIZAGI_NATIVE_COMPONENT : \"\";\r\n};\r\n\r\n/**\r\n * Check server version\r\n * @returns {}\r\n */\r\nbizagi.util.isVersionSupported = function () {\r\n    var supported = true;\r\n\r\n    if (typeof (BIZAGI_SERVER_VERSION) !== \"undefined\" && !bizagi.util.isEmpty(BIZAGI_SERVER_VERSION)) {\r\n        var version = BIZAGI_SERVER_VERSION.match(/\\d+\\.\\d+/);\r\n        supported = version ? (parseFloat(version.shift()) >= 11.0) : true;\r\n    }\r\n\r\n    return supported;\r\n};\r\n\r\n/**\r\n * Cordova componet is supported\r\n * @returns {} \r\n */\r\nbizagi.util.isCordovaSupported = function () {\r\n    return typeof (cordova) !== \"undefined\";\r\n};\r\n\r\n/**\r\n * Native plugin of Cordova is supported \r\n * @returns {} \r\n */\r\nbizagi.util.isNativePluginSupported = function () {\r\n    return typeof (bizagiapp) !== \"undefined\";\r\n};\r\n\r\n/**\r\n * Tablet native\r\n * @returns {} \r\n */\r\nbizagi.util.isTabletNativeSupported = function () {\r\n    return typeof (bizagiapp) !== \"undefined\" && bizagi.util.isTabletDevice();\r\n};\r\n\r\n/**\r\n * Smartphone native\r\n * @returns {} \r\n */\r\nbizagi.util.isSmartphoneNativeSupported = function () {\r\n    return typeof (bizagiapp) !== \"undefined\" && bizagi.util.isSmartphoneDevice();\r\n};\r\n\r\n/**\r\n * Enables accesory bar\r\n */\r\nif (bizagi.util.isNativePluginSupported() && window.cordova && window.cordova.plugins.Keyboard) {\r\n    cordova.plugins.Keyboard.hideKeyboardAccessoryBar(false);\r\n};\r\n\r\n/**\r\n * Verify real device\r\n * @returns {} \r\n */\r\nbizagi.util.detectRealDevice = function () {\r\n    var settedDevice = typeof (BIZAGI_DEFAULT_DEVICE) !== \"undefined\" && !bizagi.util.isEmpty(BIZAGI_DEFAULT_DEVICE) ?\r\n        BIZAGI_DEFAULT_DEVICE : null;\r\n\r\n    BIZAGI_DEFAULT_DEVICE = \"\";\r\n    var device = bizagi.detectDevice();\r\n    BIZAGI_DEFAULT_DEVICE = settedDevice;\r\n\r\n    return device;\r\n};\r\n\r\n/**\r\n * Method to detect Android visitors\r\n * @returns {} \r\n */\r\nbizagi.util.isAndroid = function () {\r\n    return (navigator.userAgent.toLowerCase().indexOf(\"android\") > -1);\r\n};\r\n\r\nbizagi.util.isAndroidDevice = function () {\r\n    var device = bizagi.util.detectDevice();\r\n    return device.indexOf(\"android\") > -1;\r\n};\r\n\r\nbizagi.util.isiOSDevice = function () {\r\n    var device = bizagi.util.detectDevice();\r\n    return device.indexOf(\"android\") === -1;\r\n};\r\n\r\n\r\n/**\r\n * Get server channel\r\n * @returns {}\r\n */\r\nbizagi.util.getChannelType = function () {\r\n    if (typeof (BIZAGI_SERVER_CHANNEL) !== \"undefined\" && !bizagi.util.isEmpty(BIZAGI_SERVER_CHANNEL)) {\r\n        return BIZAGI_SERVER_CHANNEL;\r\n    }\r\n    return bizagi.loader.channel || \"\";\r\n};\r\n\r\n/**\r\n * Check data url\r\n * @param {} data \r\n * @returns {} \r\n */\r\nbizagi.util.isDataUrl = function (data) {\r\n    var regex = /^\\s*data:([a-z]+\\/[a-z0-9-+.]+(;[a-z-]+=[a-z0-9-]+)?)?(;base64)?,([a-z0-9!$&',()*+;=\\-._~:@\\/?%\\s]*)\\s*$/i;\r\n\r\n    try {\r\n        return !!(data.toString()).match(regex);\r\n    } catch (error) { }\r\n\r\n    return false;\r\n};\r\n\r\n/**\r\n * Get valid data url\r\n * @param {} data \r\n * @returns {} \r\n */\r\nbizagi.util.getDataUrl = function (properties) {\r\n    var currentUrl;\r\n\r\n    try {\r\n        if (typeof (properties.value) !== \"undefined\" && !bizagi.util.isEmpty(properties.value)) {\r\n            var data = properties.value;\r\n            var url = data.value || data;\r\n\r\n            if (Array.isArray(url)) {\r\n                var tempUrl = url.shift();\r\n                currentUrl = Array.isArray(tempUrl) ? tempUrl.join(\"\") : tempUrl;\r\n            } else {\r\n                currentUrl = url;\r\n            }\r\n        } else {\r\n            currentUrl = properties.url || \"\";\r\n        }\r\n\r\n        currentUrl = !bizagi.util.isEmpty(currentUrl) ? \"data:image/png;base64,\" + currentUrl.replace(/^data:.*;base64,/, \"\") : \"\";\r\n\r\n        if (currentUrl && currentUrl.indexOf(\"Invalid case id\") !== -1)\r\n            currentUrl = \"\";\r\n\r\n    } catch (error) {\r\n        currentUrl = \"\";\r\n    }\r\n\r\n    return currentUrl;\r\n};\r\n\r\n/**\r\n * Get response message of services\r\n * @param {} data\r\n * @returns {}\r\n */\r\nbizagi.util.processFailMessage = function (data) {\r\n    var message = data || {};\r\n\r\n    try {\r\n        message = typeof (message) == \"string\" ? JSON.parse(message) : message;\r\n        message = message.responseText || (message.message || message);\r\n    } catch (e) {\r\n        message = data;\r\n    }\r\n\r\n    return message;\r\n};\r\n\r\n/**\r\n * Disable and enable workportal menu from live process\r\n */\r\nvar tmp_block_header = \"<div class='blockHeaderByLiveProcess'></div>\";\r\nbizagi.util.disableWorkPortalMenu = function () {\r\n    var blockHeight = $(\"body\").find(\"#ui-bizagi-wp-menu\").height();\r\n    $(tmp_block_header).prependTo(\"body\");\r\n    $(\"body\").find(\".blockHeaderByLiveProcess\").css({ \"position\": \"absolute\", \"width\": \"100%\", \"height\": blockHeight + \"px\", \"background\": \"gray\", \"opacity\": \"0.9\", \"z-index\": \"101\" });\r\n}\r\n\r\nbizagi.util.enableWorkPortalMenu = function () {\r\n    $(\"body\").find(\".blockHeaderByLiveProcess\").detach();\r\n}\r\n\r\n\r\nbizagi.util.downloadFile = function(url, completeuRL) {\r\n    var ua = window.navigator.userAgent;\r\n    var msie = ua.indexOf(\"MSIE \");\r\n    var ulrToDownload = \"\";\r\n    if(completeuRL){\r\n        ulrToDownload = url;\r\n    }else{\r\n        var arrayURL = url.split(\"/\");\r\n        ulrToDownload = (window.location.href.split(\"#\")[0]) + arrayURL.slice(arrayURL.indexOf(\"Api\"), arrayURL.length).join(\"/\");\r\n    }\r\n    \r\n    if (bizagi.util.isEdge() || msie > 0 || !!navigator.userAgent.match(/Trident.*rv\\:11\\./)) {\r\n        if($('#iframe-download').length === 0){ //If the iframe already exists, don't create it again\r\n            $(\"<iframe/>\").attr({\r\n                src: ulrToDownload,\r\n                style: \"visibility:hidden;display:none\",\r\n                id: \"iframe-download\"\r\n            }).appendTo('body');\r\n        }else{\r\n            $('#iframe-download').attr(\"src\", (ulrToDownload));\r\n        }\r\n    } else {\r\n        window.open(ulrToDownload);\r\n    }\r\n}\r\n\r\nbizagi.util.executeActionRoutingFromWorkportal = function (idCase, idWorkItem) {\r\n    bizagi.workportal.controllers.menu.prototype.publish(\"executeAction\", {\r\n        action: bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,\r\n        idCase: idCase,\r\n        idWorkItem: idWorkItem\r\n    });\r\n}\r\n\r\n/**\r\n* Gets the final message when the user is offline or online (In Offline forms)\r\n* @param {} state \r\n* @returns {} The corresponding message depending on the case\r\n*/\r\n\r\nbizagi.util.getMessageFromNetworkState = function (state) {\r\n    if (state) {\r\n        return bizagi.localization.getResource(\"render-without-globalform-offline-userOnline\", \"The case has been created successfully, please wait until the server synchronizes\");\r\n    } else {\r\n        return bizagi.localization.getResource(\"render-without-globalform-offline\", \"Your offline case has been created successfully. It will synchronized as soon as you go online.\");\r\n    }\r\n};\r\n\r\nbizagi.util.sanitizeHTML = function (str) {\r\n\tvar temp = document.createElement('div');\r\n\ttemp.textContent = str;\r\n\treturn temp.innerHTML;\r\n};\r\n\r\nbizagi.util.arrayUnique = function (array) {\r\n    var items = array.concat();\r\n\r\n    for (var i = 0, length = items.length; i < length; ++i) {\r\n        for (var j = i + 1; j < length; ++j) {\r\n            if (items[i] === items[j]) {\r\n                items.splice(j -= 1, 1);\r\n            }\r\n\r\n        }\r\n    }\r\n\r\n    return items;\r\n};\r\n\r\n/**\r\n * Debounce\r\n * Taken from https://davidwalsh.name/javascript-debounce-function\r\n * Returns a function, that, as long as it continues to be invoked,\r\n * will not be triggered. The function will be called after it stops\r\n * being called for N(wait) milliseconds. If `immediate` is passed,\r\n * trigger the function on the leading edge, instead of the trailing.\r\n * \r\n * @param {} func, wait, immediate \r\n * @returns {} The function that that will be called back\r\n */\r\nbizagi.util.debounce = function (func, wait, immediate) {\r\n    var timeout;\r\n    return function () {\r\n        var context = this, args = arguments;\r\n        var later = function () {\r\n            timeout = null;\r\n            if (!immediate) func.apply(context, args);\r\n        };\r\n        var callNow = immediate && !timeout;\r\n        clearTimeout(timeout);\r\n        timeout = setTimeout(later, wait);\r\n        if (callNow) func.apply(context, args);\r\n    };\r\n};\r\n\r\n/**\r\n * Validate if the mobile image editor is enabled\r\n * @returns {}\r\n */\r\nbizagi.util.isNativeImageEditorSupported = function () {\r\n    return bizagi.util.isNativePluginSupported() && bizagi.util.isiOSDevice() && bizagi.override.enableImageEditor;\r\n};\r\n/**\r\n * Error Message\r\n */\r\nbizagi.util.errorMessage  = function (message) {\r\n    return \"<div class=\\\"admin-stakeholder-message\\\"> \" +\r\n    \"<i class=\\\"bz-wp-empty__img\\\"></i> \" +\r\n    \"<p class=\\\"bz-wp-empty__info bz-wp-empty__info--first\\\"> \" +\r\n    message +\r\n    \"</p></div>\";\r\n};\r\n\r\n\r\n/**\r\n * Validate URL \r\n */\r\nbizagi.util.validateUrlWellFormed  = function (url) {\r\n    var patternToValidateUrl = /^(http:\\/\\/www\\.|https:\\/\\/www\\.|http:\\/\\/|https:\\/\\/)?[a-z0-9]+([\\-\\.]{1}[a-z0-9]+)*\\.[a-z]{2,5}(:[0-9]{1,5})?(\\/.*)?$/;\r\n    if(patternToValidateUrl.test(url)){\r\n        var patternToValidateHttp = /^((http|https):\\/\\/)/;\r\n        if(!patternToValidateHttp.test(url)) {\r\n            url = \"http://\" + url;\r\n        }\r\n        return url;\r\n    }\r\n    return null;\r\n};\r\n\r\n/**\r\n * Replace line breaks for html line breaks\r\n * @param data\r\n * @returns {string}\r\n */\r\nbizagi.util.decodedDisplayValue = function (data) {\r\n    var value = data || \"\";\r\n    var valueToDisplay = \"\";\r\n\r\n    if (typeof (value) === \"string\") {\r\n        var decodedDisplayValue = bizagi.util.decodeURI(value);\r\n\r\n        valueToDisplay = decodedDisplayValue.replaceAll(\"&\", \"&amp;\");\r\n        valueToDisplay = valueToDisplay.replaceAll(\"$\", \"&#36;\");\r\n        valueToDisplay = valueToDisplay.replaceAll(\"<\", \"&lt;\").replaceAll(\">\", \"&gt;\");\r\n        valueToDisplay = valueToDisplay.replaceAll(\"\\\"\", \"&#34;\").replaceAll(\"'\", \"&#39;\").replaceAll(\"/\", \"&#47;\");\r\n        valueToDisplay = valueToDisplay.replaceAll(\"\\\\n\", \"<br/>\");\r\n        valueToDisplay = valueToDisplay.replaceAll(\"\\n\", \"<br/>\");\r\n    }\r\n\r\n    return valueToDisplay;\r\n};\r\n\r\n/**\r\n * Set Caret position \r\n * Set the caret in specific position of an element type input\r\n * @param {} func, position, input element \r\n * @returns {} The function not return any value.\r\n */\r\nbizagi.util.setCaretPosition = function (pos, ctrl) {\r\n    var self = this;\r\n\r\n    // Modern browsers\r\n    if (ctrl.setSelectionRange) {\r\n        ctrl.focus();\r\n        ctrl.setSelectionRange(pos, pos);\r\n\r\n        // IE8 and below\r\n    } else if (ctrl.createTextRange) {\r\n        var range = ctrl.createTextRange();\r\n        range.collapse(true);\r\n        range.moveEnd('character', pos);\r\n        range.moveStart('character', pos);\r\n        range.select();\r\n    }\r\n};\r\n\r\n\r\n/**\r\n * Get position of caret\r\n * Get the position of caret in a specific element input\r\n * @param {} func, input element \r\n * @returns {} Return the position of caret in an element input\r\n */\r\nbizagi.util.getCaretPosition = function (oField) {\r\n\r\n    // Initialize\r\n    var iCaretPos = 0;\r\n\r\n    // IE Support\r\n    if (document.selection) {\r\n\r\n        // Set focus on the element\r\n        oField.focus();\r\n\r\n        // To get cursor position, get empty selection range\r\n        var oSel = document.selection.createRange();\r\n\r\n        // Move selection start to 0 position\r\n        oSel.moveStart('character', -oField.value.length);\r\n\r\n        // The caret position is selection length\r\n        iCaretPos = oSel.text.length;\r\n    } else if (oField.selectionStart || oField.selectionStart == '0') // Firefox support\r\n        iCaretPos = oField.selectionStart;\r\n\r\n    // Return results\r\n    return iCaretPos;\r\n};\r\n\r\n/**\r\n * To escape values\r\n * @param {} value \r\n * @returns {} \r\n */\r\nbizagi.util.escapeRegex = function (value) {\r\n    value = value || \"\";\r\n\r\n    return value.replace(/([\\^\\$\\(\\)\\[\\]\\{\\}\\*\\.\\+\\?\\|\\\\])/gi, \"\\\\$1\");\r\n};\r\n\r\n/**\r\n * Function to get a featureObject by path within the global bizagiConfig.features object. Example: \"userService.v1.enabled\"\r\n */\r\nbizagi.util.getFeatureObject = function (path) {\r\n    var arr = path.split('.');\r\n    this.featureObjectCache = this.featureObjectCache || {};\r\n\r\n    function getFeatureObjectIte(arr) {\r\n        var features = bizagi.util.getConfigFeatures();\r\n\r\n        if (typeof path !== \"string\" || typeof features == \"undefined\") return;\r\n\r\n        var pivot = features;\r\n        for (var i = 0, len = arr.length; i < len; i++) {\r\n            pivot = pivot[arr[i]];\r\n            if (typeof pivot === \"undefined\") return;\r\n        }\r\n        return pivot;\r\n    };\r\n    if (path in this.featureObjectCache) {\r\n        return this.featureObjectCache[path];\r\n    } else {\r\n        return this.featureObjectCache[path] = getFeatureObjectIte(arr);\r\n    }\r\n};\r\n\r\n/**\r\n * Load features from mobile\r\n */\r\nbizagi.util.getConfigFeatures = function () {\r\n    var bizagiConfiguration = window.bizagiConfig || bizagiConfig || {};\r\n\r\n    if(bizagi.util.isMobileDevice() && typeof(BIZAGI_MOBILE_FEATURES) !== \"undefined\" && !bizagi.util.isEmpty(BIZAGI_MOBILE_FEATURES)) {\r\n        bizagiConfiguration.features = JSON.parse(BIZAGI_MOBILE_FEATURES || \"{}\")\r\n    }\r\n\r\n    return bizagiConfiguration.features;\r\n};\r\n\r\n/**\r\n * Reset features flag\r\n */\r\nbizagi.util.resetConfigFeatures = function () {\r\n    bizagi.util.featureObjectCache = undefined;\r\n};\r\n\r\n/**\r\n * Check fail request\r\n * @param result\r\n * @returns {*|boolean}\r\n */\r\nbizagi.util.isFailResponse = function (result) {\r\n    return result && ((result.type && result.type === \"error\") || (result.status && result.status === \"error\") || (result.code && result.code === \"UNKNOWN_ERROR\"));\r\n};\r\n\r\n/**\r\n * Formats value of each item\r\n * @param {string, boolean or array} value\r\n * @example\r\n * value = \"string\" => \"string\"\r\n * value = true => \"yes\" or \"si\", the localized value\r\n * value = false => \"no\", the localized value\r\n * value = [\"string 1\", \"string 2\"] => \"string 1 - string 2\"\r\n * @returns {string}\r\n */\r\nbizagi.util.formatItem = function (value) {\r\n    if (value !== undefined && value !== null) {\r\n        if ($.isArray(value)) {\r\n\r\n            for (var i = 0, length = value.length; i < length; i++) {\r\n                if (value[i] != null && typeof (value[i]) == \"boolean\") {\r\n                    if (bizagi.util.parseBoolean(value[i]) === true) {\r\n                        value[i] = bizagi.localization.getResource(\"render-boolean-yes\");\r\n\r\n                    } else if (bizagi.util.parseBoolean(value[i]) === false) {\r\n                        value[i] = bizagi.localization.getResource(\"render-boolean-no\");\r\n                    }\r\n                }\r\n                value[i] = bizagi.util.sanitizeHTML(value[i]);\r\n            }\r\n\r\n            return value.join(\" - \");\r\n        } else {\r\n            return bizagi.util.sanitizeHTML(value);\r\n        }\r\n    } else {\r\n        return \"\";\r\n    }\r\n};\r\n\r\n/**\r\n * Process response to highlight matches\r\n * @param {} item\r\n * @param term\r\n * @returns {}\r\n */\r\nbizagi.util.highlightMatches = function(item, term) {\r\n    var parseValue;\r\n\r\n    switch (typeof item.value) {\r\n        case \"number\":\r\n            parseValue = item.value;\r\n            break;\r\n        case \"object\":\r\n            parseValue = bizagi.util.formatItem(item.value);\r\n            break;\r\n        case \"string\":\r\n            var data = bizagi.util.escapeRegex(term).replaceAll(\"%\", \"\");\r\n            var regEx = new RegExp(\"(?![^&;]+;)(?!<[^<>]*)(\" + data + \")(?![^<>]*>)(?![^&;]+;)\", \"gi\");\r\n\r\n            parseValue = bizagi.util.sanitizeHTML(item.value).replace(regEx, \"<strong>$1</strong>\");\r\n            break;\r\n        default:\r\n            parseValue = item.value;\r\n            break;\r\n    }\r\n\r\n    return parseValue;\r\n};\r\n\r\n/**\r\n * Calculate window resolution for Desktop\r\n * @returns {string}\r\n */\r\nbizagi.util.getDesktopResolution = function() {\r\n    var resolution = \"\";\r\n    var devicePixelRatio = 1;\r\n    var screenWidth = window.screen.width;\r\n    var screenHeight = window.screen.height;\r\n\r\n    if ('deviceXDPI' in screen) {\r\n        devicePixelRatio = screen.deviceXDPI / screen.logicalXDPI;\r\n    } else if ('devicePixelRatio' in window) {\r\n        devicePixelRatio = window.devicePixelRatio;\r\n    }\r\n\r\n    devicePixelRatio = Number(devicePixelRatio.toFixed(3));\r\n\r\n    if ((screenWidth && screenWidth > 0) && (screenHeight && screenHeight > 0)) {\r\n        resolution = (screenWidth * devicePixelRatio) + \"x\" + (screenHeight * devicePixelRatio);\r\n    }\r\n\r\n    return resolution;\r\n};\r\n\r\n/**\r\n * Get the market name for device\r\n * @returns {*|string}\r\n */\r\nbizagi.util.getDeviceCode = function () {\r\n    var deviceCode = \"\";\r\n\r\n    if (bizagi.util.isMobileDevice()) {\r\n        deviceCode = typeof (BIZAGI_DEVICE_MARKET_NAME) !== \"undefined\" && !bizagi.util.isEmpty(BIZAGI_DEVICE_MARKET_NAME) ? BIZAGI_DEVICE_MARKET_NAME : \"\";\r\n    } else {\r\n        deviceCode = bizagi.util.getDesktopResolution();\r\n    }\r\n\r\n    return deviceCode;\r\n};\r\n\r\n/**\r\n * Get base name of the control\r\n * @param type\r\n * @returns {*}\r\n */\r\nbizagi.util.normalizeType = function(type) {\r\n    if (typeof (type) === \"undefined\") return type;\r\n\r\n    return type\r\n        .replace(/smartphone/, '')\r\n        .replace(/tablet/, '')\r\n        .replace(/offline/, '');\r\n};\r\n\r\n/**\r\n * Hide or show the X button in the show dialog method \r\n * \r\n */\r\nbizagi.util.hideOrShowXToCloseDialog = function(dialog, show) {\r\n    var selector = \".ui-dialog-titlebar-close\";\r\n    if (show) {\r\n        $(selector, dialog).show();\r\n    } else {\r\n        $(selector, dialog).hide();\r\n    }\r\n};\r\n\r\n/**\r\n * review if a feature key is enabled\r\n * @param {string} feature nombre de la llave del feature\r\n */\r\nbizagi.util.isEnableFeature = function(feature) {\r\n    return bizagi.features[feature]!==false;\r\n};\r\n\r\n/**\r\n * A function to get the scrolling parent of an html element.\r\n */\r\n(function ($) {\r\n\r\n    var parents = function (node, ps) {\r\n        if (node.parentNode === null) return ps;\r\n\r\n        return parents(node.parentNode, ps.concat([node]));\r\n    };\r\n\r\n    var style = function (node, prop) {\r\n        return getComputedStyle(node, null).getPropertyValue(prop);\r\n    };\r\n\r\n    var overflow = function (node) {\r\n        return style(node, \"overflow\") + style(node, \"overflow-y\") + style(node, \"overflow-x\");\r\n    };\r\n\r\n    var scroll = function (node) {\r\n        return /(auto|scroll)/.test(overflow(node));\r\n    };\r\n\r\n    // Get the closest ancestor element that is scrollable.\r\n    $.scrollerParent = function (node) {\r\n        if (!(node instanceof HTMLElement || node instanceof SVGElement)) return;\r\n\r\n        var ps = parents(node.parentNode, []);\r\n\r\n        for (var i = 0; i < ps.length; i += 1) {\r\n            if (scroll(ps[i])) return ps[i];\r\n        }\r\n\r\n        return document.scrollingElement || document.documentElement;\r\n    };\r\n})(jQuery);\r\n\r\nbizagi.util.startkendo = function (params) {\r\n    if (typeof (bizagi.kendoMobileApplication) === \"undefined\") {\r\n        bizagi.kendoMobileApplication = new kendo.mobile.Application($(\"body\"), {\r\n            skin: \"flat\",\r\n            browserHistory: false,\r\n            init: function (e) {\r\n                kendo.ui.progress($(\".km-flat\"), true);\r\n                params.started && params.started();\r\n            }\r\n        });\r\n\r\n        bizagi.kendoMobileApplication.bizagiNavigate = function (e, t) {\r\n            this.navigate(e, t);\r\n        };\r\n    } else {\r\n        params.started && params.started();\r\n    }\r\n};\r\n\r\n\r\n/**\r\n * Get native component\r\n * @returns {}\r\n */\r\nbizagi.util.isSharepointContext = function () {\r\n    return typeof (BIZAGI_SHAREPOINT_CONTEXT) !== \"undefined\" && bizagi.util.parseBoolean(BIZAGI_SHAREPOINT_CONTEXT) === true;\r\n};\r\n\r\n/**\r\n * Checks if a given value with format {id, value} is empty\r\n * @param value\r\n  * @returns {boolean}\r\n  */\r\nbizagi.util.isEmptyValue = function (value) {\r\n    if (value === 0) return false;\r\n    if (value === undefined || value === null || value === \"\") return true;\r\n    if (typeof (value) === \"Array\") return value.length === 0;\r\n    if (Object.prototype.toString.apply(value) === \"[object Array]\") return value.length === 0;\r\n\r\n    if (Object.prototype.toString.apply(value) === \"[object Object]\") {\r\n        for (var key in value) {\r\n            if (value.hasOwnProperty(key) && !bizagi.util.isEmptyValue(value[key])) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    return false;\r\n};\r\n","bizagi = (typeof (bizagi) !== \"undefined\") ? bizagi : {};\r\nbizagi.util = (typeof (bizagi.util) !== \"undefined\") ? bizagi.util : {};\r\nbizagi.context = (typeof (bizagi.context) !== \"undefined\") ? bizagi.context : {};\r\n\r\n/**\r\n * Method to detect iPad visitors\r\n */\r\nbizagi.util.randomNumber = function (min, max) {\r\n    min = min || 1;\r\n    max = max || 10000000;\r\n    return Math.floor(Math.random() * (max - min + 1)) + min;\r\n};\r\n\r\n/**\r\n *   Returns the resolved result from a promise when the promise has been executed already\r\n */\r\nbizagi.resolveResult = function (promise) {\r\n    var result;\r\n    promise.done(function (data) {\r\n        result = data;\r\n    });\r\n    return result;\r\n};\r\n\r\n/**\r\n *   Returns a boolean if there are two equal objects\r\n */\r\nbizagi.util.identicalObjects = function (obj1, obj2) {\r\n    var self = this;\r\n\r\n    if (typeof (obj1) !== typeof (obj2)) {\r\n        return false;\r\n    }\r\n\r\n    if (typeof (obj1) === \"function\") {\r\n        return obj1.toString() === obj2.toString();\r\n    }\r\n\r\n    if (obj1 instanceof Object && obj2 instanceof Object) {\r\n\r\n        // Count properties\r\n        if (bizagi.util.countProps(obj1) !== bizagi.util.countProps(obj2)) {\r\n            return false;\r\n        }\r\n\r\n        var r = true;\r\n        for (k in obj1) {\r\n            r = bizagi.util.identicalObjects(obj1[k], obj2[k]);\r\n            if (!r) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    } else {\r\n        return obj1 === obj2;\r\n    }\r\n};\r\n\r\n\r\nbizagi.util.countProps = function (obj) {\r\n    var count = 0;\r\n    for (k in obj) {\r\n        if (obj.hasOwnProperty(k)) {\r\n            count++;\r\n        }\r\n    }\r\n    return count;\r\n};\r\n\r\n/**\r\n *   Encode a html string\r\n */\r\nbizagi.util.encodeHtml = function (text) {\r\n    if (text === undefined || text === null) {\r\n        return \"\";\r\n    }\r\n    if (typeof (text) == \"string\") {\r\n        return text.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');\r\n    }\r\n    return text;\r\n};\r\n\r\n/**\r\n *   Encodes the xpath\r\n */\r\nbizagi.util.encodeXpath = function (xpath) {\r\n    if (bizagi.util.isEmpty(xpath))\r\n        return \"\";\r\n    return xpath.replaceAll(\".\", \"_\").replaceAll(\"=\", \"_\").replaceAll(\"[\", \"_\").replaceAll(\"]\", \"_\");\r\n};\r\n\r\n/**\r\n *   Add a clone to the object prototype\r\n */\r\nbizagi.clone = function (obj) {\r\n    return JSON.parse(JSON.encode(obj));\r\n};\r\n\r\n/**\r\n *   Generates a random guid\r\n */\r\nMath.guid = function () {\r\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\r\n        var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\r\n        return v.toString(16);\r\n    });\r\n};\r\n\r\n/**\r\n * Execute deferreds in order\r\n * @example var a = new bizagiQueue(); a.add(function);\r\n *\r\n */\r\nfunction bizagiQueue() {\r\n    var self = this;\r\n    var queue = [];\r\n\r\n    self.add = function (callback) {\r\n        queue.push({ callbacks: [callback] });\r\n    };\r\n\r\n    self.addParallel = function (callback) {\r\n        if (queue.length == 0)\r\n            return self.add(callback);\r\n\r\n        // Put a parallel on last item\r\n        var last = queue[queue.length - 1];\r\n        last.callbacks.push(callback);\r\n    };\r\n\r\n    self.execute = function () {\r\n        var starter = new $.Deferred();\r\n        var promise = starter.promise();\r\n        var queueLength = queue.length;\r\n        for (var i = 0; i < queueLength; i++) {\r\n            promise = promise.pipe(function () {\r\n                var element = queue.shift();\r\n                return $.when.apply($, $.map(element.callbacks, function (callback) {\r\n                    // Function support\r\n                    if (typeof (callback) == \"function\")\r\n                        return callback();\r\n                    // Deferred support\r\n                    return callback;\r\n                }))\r\n            });\r\n        };\r\n\r\n        starter.resolve();\r\n        promise = promise.done(function () {\r\n            // Reset queue\r\n            queue = [];\r\n        });\r\n\r\n        return promise;\r\n    };\r\n};\r\n\r\n/**\r\n *   Check if a map object is empty\r\n */\r\nbizagi.util.isMapEmpty = function (map) {\r\n    // First we validate a special case\r\n    if (map.length == 1 && map[0].length == 0)\r\n        return true;\r\n    // Then we do normal validation\r\n    for (var key in map) {\r\n        if (map.hasOwnProperty(key)) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n};\r\n\r\n/**\r\n * Find element to make scroll top\r\n */\r\nbizagi.util.scrollTop = function (canvas) {\r\n    if (canvas && canvas[0]) {\r\n        while (canvas[0].tagName !== \"HTML\" && canvas.css(\"overflow-y\") != \"scroll\" && canvas.css(\"overflow-y\") != \"auto\" && canvas.parent().length > 0) {\r\n            canvas = canvas.parent();\r\n        }\r\n    }\r\n    return canvas;\r\n};\r\n\r\n/*\r\n*   Read the query string parameteres\r\n*/\r\nbizagi.util.getQueryString = function (url) {\r\n    var params = {};\r\n    url = url || window.location.href;\r\n    var query = url.indexOf(\"?\") > 0 ? url.substring(url.indexOf(\"?\") + 1) : \"\";\r\n    var pairs = query.split(\"&\");\r\n    for (var i = 0; i < pairs.length; i++) {\r\n        var pos = pairs[i].indexOf('=');\r\n        if (pos == -1)\r\n            continue;\r\n        var argname = pairs[i].substring(0, pos);\r\n        var value = pairs[i].substring(pos + 1);\r\n        params[argname] = unescape(value);\r\n    }\r\n    return params;\r\n};\r\n\r\n\r\n/*\r\n*   Info scenarios\r\n*/\r\nvar scenarioInfo = (function(params) {\r\n    var self = this;\r\n    var _state = {};\r\n\r\n    /**\r\n    * Return url where is located specific scenario\r\n    *\r\n    * @param params\r\n    * @returns {string}\r\n    */\r\n    self.getFileScenario = function(params) {\r\n        params = params || {};\r\n        var url = \"\";\r\n        var scenario = params.scenario.split(\".\") || [];\r\n        var category = scenario[0];\r\n\r\n        url = BIZAGI_SMARTPHONE_PATH + \"scenarios/\" + category + \"/\" + params.scenario + \".js\";\r\n\r\n        return url;\r\n    };\r\n\r\n    return {\r\n        getFileScenario: self.getFileScenario\r\n    };\r\n});\r\n\r\n/**\r\n *   Determines if parameter 'n' is numeric\r\n */\r\nbizagi.util.isNumeric = function (n) {\r\n    return !isNaN(parseFloat(n)) && isFinite(n);\r\n};\r\n\r\n/**\r\n *   Determines if a element has visibility\r\n */\r\nbizagi.util.isScrolledIntoView = function (elem, layout) {\r\n    if (elem == undefined) {\r\n        return false;\r\n    }\r\n\r\n    layout = layout || $(window);\r\n    var scrollTop = layout.scrollTop();\r\n    var elemTop = $(elem).offset().top;\r\n    var elemBottom = elemTop + $(elem).height();\r\n    var docViewBottom = scrollTop + $(layout).height();\r\n    return ((elemBottom <= docViewBottom) && (elemTop >= scrollTop));\r\n};\r\n\r\n/**\r\n * determines whether the element in the browser supports the event we are looking for, eg 'paste', 'input', 'blur', etc. More info check modernizer.js.\r\n * @param  {string|*}           eventName  is the name of an event to test for (e.g. \"resize\")\r\n * @param  {(Object|string|*)=} element    is the element|document|window|tagName to test on\r\n * @return {boolean}\r\n */\r\nbizagi.util.isEventSupported = function (eventName, element) {\r\n    var needsFallback = !('onblur' in document.documentElement);\r\n    var isSupported;\r\n\r\n    if (!eventName) {\r\n        return false;\r\n    }\r\n    if (!element || typeof element === 'string') {\r\n        element = document.createElement(element || 'div');\r\n    }\r\n\r\n    // Testing via the `in` operator is sufficient for modern browsers and IE.\r\n    // When using `setAttribute`, IE skips \"unload\", WebKit skips \"unload\" and\r\n    // \"resize\", whereas `in` \"catches\" those.\r\n    eventName = 'on' + eventName;\r\n    isSupported = eventName in element;\r\n\r\n    // Fallback technique for old Firefox - bit.ly/event-detection\r\n    if (!isSupported && needsFallback) {\r\n        if (!element.setAttribute) {\r\n            // Switch to generic element if it lacks `setAttribute`.\r\n            // It could be the `document`, `window`, or something else.\r\n            element = document.createElement('div');\r\n        }\r\n        if (element.setAttribute && element.removeAttribute) {\r\n            element.setAttribute(eventName, '');\r\n            isSupported = typeof element[eventName] === 'function';\r\n\r\n            if (element[eventName] !== undefined) {\r\n                // If property was created, \"remove it\" by setting value to `undefined`.\r\n                element[eventName] = undefined;\r\n            }\r\n            element.removeAttribute(eventName);\r\n        }\r\n    }\r\n    return isSupported;\r\n};\r\n/*\r\n * Method to detect Android visitors\r\n */\r\nbizagi.util.isAndroid = function(){\r\n    return (navigator.userAgent.toLowerCase().indexOf(\"android\") > -1);\r\n};\r\n\r\n/**\r\n * Functions to loading\r\n */\r\n(function ($) {\r\n    $.fn.startLoading = function (params) {\r\n        bizagi.util.smartphone.startLoading();\r\n    };\r\n\r\n    $.fn.endLoading = function () {\r\n        bizagi.util.smartphone.stopLoading();\r\n    };\r\n})(jQuery);\r\n\r\n/***\r\n * Removes the objects and dispose\r\n * @param obj\r\n */\r\n\r\nbizagi.util.dispose = function (obj) {\r\n    for (key in obj) {\r\n        if (typeof (obj[key]) == \"object\") delete obj[key];\r\n        if (typeof (obj[key]) == \"function\") { obj[key] = null; delete obj[key]; }\r\n    }\r\n};\r\n\r\n/**\r\n* Remove all backslashes that represent scape of characters\r\n*/\r\nbizagi.util.stripslashes = function (str) {\r\n    return str.replace(/\\\\'/g, '\\'').replace(/\\\"/g, '\"').replace(/\\\\\\\\/g, '\\\\').replace(/\\\\0/g, '\\0');\r\n};\r\n\r\n/**\r\n * CryptoJS MD5 \r\n * @param {} message \r\n * @returns {} \r\n */\r\nbizagi.util.md5 = function (message) {\r\n    // Code here will be linted with JSHint.\r\n    /* jshint ignore:start */    \r\n    var CryptoJS = CryptoJS || function (s, p) { var m = {}, l = m.lib = {}, n = function () { }, r = l.Base = { extend: function (b) { n.prototype = this; var h = new n; b && h.mixIn(b); h.hasOwnProperty(\"init\") || (h.init = function () { h.$super.init.apply(this, arguments) }); h.init.prototype = h; h.$super = this; return h }, create: function () { var b = this.extend(); b.init.apply(b, arguments); return b }, init: function () { }, mixIn: function (b) { for (var h in b) b.hasOwnProperty(h) && (this[h] = b[h]); b.hasOwnProperty(\"toString\") && (this.toString = b.toString) }, clone: function () { return this.init.prototype.extend(this) } }, q = l.WordArray = r.extend({ init: function (b, h) { b = this.words = b || []; this.sigBytes = h != p ? h : 4 * b.length }, toString: function (b) { return (b || t).stringify(this) }, concat: function (b) { var h = this.words, a = b.words, j = this.sigBytes; b = b.sigBytes; this.clamp(); if (j % 4) for (var g = 0; g < b; g++) h[j + g >>> 2] |= (a[g >>> 2] >>> 24 - 8 * (g % 4) & 255) << 24 - 8 * ((j + g) % 4); else if (65535 < a.length) for (g = 0; g < b; g += 4) h[j + g >>> 2] = a[g >>> 2]; else h.push.apply(h, a); this.sigBytes += b; return this }, clamp: function () { var b = this.words, h = this.sigBytes; b[h >>> 2] &= 4294967295 << 32 - 8 * (h % 4); b.length = s.ceil(h / 4) }, clone: function () { var b = r.clone.call(this); b.words = this.words.slice(0); return b }, random: function (b) { for (var h = [], a = 0; a < b; a += 4) h.push(4294967296 * s.random() | 0); return new q.init(h, b) } }), v = m.enc = {}, t = v.Hex = { stringify: function (b) { var a = b.words; b = b.sigBytes; for (var g = [], j = 0; j < b; j++) { var k = a[j >>> 2] >>> 24 - 8 * (j % 4) & 255; g.push((k >>> 4).toString(16)); g.push((k & 15).toString(16)) } return g.join(\"\") }, parse: function (b) { for (var a = b.length, g = [], j = 0; j < a; j += 2) g[j >>> 3] |= parseInt(b.substr(j, 2), 16) << 24 - 4 * (j % 8); return new q.init(g, a / 2) } }, a = v.Latin1 = { stringify: function (b) { var a = b.words; b = b.sigBytes; for (var g = [], j = 0; j < b; j++) g.push(String.fromCharCode(a[j >>> 2] >>> 24 - 8 * (j % 4) & 255)); return g.join(\"\") }, parse: function (b) { for (var a = b.length, g = [], j = 0; j < a; j++) g[j >>> 2] |= (b.charCodeAt(j) & 255) << 24 - 8 * (j % 4); return new q.init(g, a) } }, u = v.Utf8 = { stringify: function (b) { try { return decodeURIComponent(escape(a.stringify(b))) } catch (g) { throw Error(\"Malformed UTF-8 data\"); } }, parse: function (b) { return a.parse(unescape(encodeURIComponent(b))) } }, g = l.BufferedBlockAlgorithm = r.extend({ reset: function () { this._data = new q.init; this._nDataBytes = 0 }, _append: function (b) { \"string\" == typeof b && (b = u.parse(b)); this._data.concat(b); this._nDataBytes += b.sigBytes }, _process: function (b) { var a = this._data, g = a.words, j = a.sigBytes, k = this.blockSize, m = j / (4 * k), m = b ? s.ceil(m) : s.max((m | 0) - this._minBufferSize, 0); b = m * k; j = s.min(4 * b, j); if (b) { for (var l = 0; l < b; l += k) this._doProcessBlock(g, l); l = g.splice(0, b); a.sigBytes -= j } return new q.init(l, j) }, clone: function () { var b = r.clone.call(this); b._data = this._data.clone(); return b }, _minBufferSize: 0 }); l.Hasher = g.extend({ cfg: r.extend(), init: function (b) { this.cfg = this.cfg.extend(b); this.reset() }, reset: function () { g.reset.call(this); this._doReset() }, update: function (b) { this._append(b); this._process(); return this }, finalize: function (b) { b && this._append(b); return this._doFinalize() }, blockSize: 16, _createHelper: function (b) { return function (a, g) { return (new b.init(g)).finalize(a) } }, _createHmacHelper: function (b) { return function (a, g) { return (new k.HMAC.init(b, g)).finalize(a) } } }); var k = m.algo = {}; return m }(Math); (function (s) { function p(a, k, b, h, l, j, m) { a = a + (k & b | ~k & h) + l + m; return (a << j | a >>> 32 - j) + k } function m(a, k, b, h, l, j, m) { a = a + (k & h | b & ~h) + l + m; return (a << j | a >>> 32 - j) + k } function l(a, k, b, h, l, j, m) { a = a + (k ^ b ^ h) + l + m; return (a << j | a >>> 32 - j) + k } function n(a, k, b, h, l, j, m) { a = a + (b ^ (k | ~h)) + l + m; return (a << j | a >>> 32 - j) + k } for (var r = CryptoJS, q = r.lib, v = q.WordArray, t = q.Hasher, q = r.algo, a = [], u = 0; 64 > u; u++) a[u] = 4294967296 * s.abs(s.sin(u + 1)) | 0; q = q.MD5 = t.extend({ _doReset: function () { this._hash = new v.init([1732584193, 4023233417, 2562383102, 271733878]) }, _doProcessBlock: function (g, k) { for (var b = 0; 16 > b; b++) { var h = k + b, w = g[h]; g[h] = (w << 8 | w >>> 24) & 16711935 | (w << 24 | w >>> 8) & 4278255360 } var b = this._hash.words, h = g[k + 0], w = g[k + 1], j = g[k + 2], q = g[k + 3], r = g[k + 4], s = g[k + 5], t = g[k + 6], u = g[k + 7], v = g[k + 8], x = g[k + 9], y = g[k + 10], z = g[k + 11], A = g[k + 12], B = g[k + 13], C = g[k + 14], D = g[k + 15], c = b[0], d = b[1], e = b[2], f = b[3], c = p(c, d, e, f, h, 7, a[0]), f = p(f, c, d, e, w, 12, a[1]), e = p(e, f, c, d, j, 17, a[2]), d = p(d, e, f, c, q, 22, a[3]), c = p(c, d, e, f, r, 7, a[4]), f = p(f, c, d, e, s, 12, a[5]), e = p(e, f, c, d, t, 17, a[6]), d = p(d, e, f, c, u, 22, a[7]), c = p(c, d, e, f, v, 7, a[8]), f = p(f, c, d, e, x, 12, a[9]), e = p(e, f, c, d, y, 17, a[10]), d = p(d, e, f, c, z, 22, a[11]), c = p(c, d, e, f, A, 7, a[12]), f = p(f, c, d, e, B, 12, a[13]), e = p(e, f, c, d, C, 17, a[14]), d = p(d, e, f, c, D, 22, a[15]), c = m(c, d, e, f, w, 5, a[16]), f = m(f, c, d, e, t, 9, a[17]), e = m(e, f, c, d, z, 14, a[18]), d = m(d, e, f, c, h, 20, a[19]), c = m(c, d, e, f, s, 5, a[20]), f = m(f, c, d, e, y, 9, a[21]), e = m(e, f, c, d, D, 14, a[22]), d = m(d, e, f, c, r, 20, a[23]), c = m(c, d, e, f, x, 5, a[24]), f = m(f, c, d, e, C, 9, a[25]), e = m(e, f, c, d, q, 14, a[26]), d = m(d, e, f, c, v, 20, a[27]), c = m(c, d, e, f, B, 5, a[28]), f = m(f, c, d, e, j, 9, a[29]), e = m(e, f, c, d, u, 14, a[30]), d = m(d, e, f, c, A, 20, a[31]), c = l(c, d, e, f, s, 4, a[32]), f = l(f, c, d, e, v, 11, a[33]), e = l(e, f, c, d, z, 16, a[34]), d = l(d, e, f, c, C, 23, a[35]), c = l(c, d, e, f, w, 4, a[36]), f = l(f, c, d, e, r, 11, a[37]), e = l(e, f, c, d, u, 16, a[38]), d = l(d, e, f, c, y, 23, a[39]), c = l(c, d, e, f, B, 4, a[40]), f = l(f, c, d, e, h, 11, a[41]), e = l(e, f, c, d, q, 16, a[42]), d = l(d, e, f, c, t, 23, a[43]), c = l(c, d, e, f, x, 4, a[44]), f = l(f, c, d, e, A, 11, a[45]), e = l(e, f, c, d, D, 16, a[46]), d = l(d, e, f, c, j, 23, a[47]), c = n(c, d, e, f, h, 6, a[48]), f = n(f, c, d, e, u, 10, a[49]), e = n(e, f, c, d, C, 15, a[50]), d = n(d, e, f, c, s, 21, a[51]), c = n(c, d, e, f, A, 6, a[52]), f = n(f, c, d, e, q, 10, a[53]), e = n(e, f, c, d, y, 15, a[54]), d = n(d, e, f, c, w, 21, a[55]), c = n(c, d, e, f, v, 6, a[56]), f = n(f, c, d, e, D, 10, a[57]), e = n(e, f, c, d, t, 15, a[58]), d = n(d, e, f, c, B, 21, a[59]), c = n(c, d, e, f, r, 6, a[60]), f = n(f, c, d, e, z, 10, a[61]), e = n(e, f, c, d, j, 15, a[62]), d = n(d, e, f, c, x, 21, a[63]); b[0] = b[0] + c | 0; b[1] = b[1] + d | 0; b[2] = b[2] + e | 0; b[3] = b[3] + f | 0 }, _doFinalize: function () { var a = this._data, k = a.words, b = 8 * this._nDataBytes, h = 8 * a.sigBytes; k[h >>> 5] |= 128 << 24 - h % 32; var l = s.floor(b / 4294967296); k[(h + 64 >>> 9 << 4) + 15] = (l << 8 | l >>> 24) & 16711935 | (l << 24 | l >>> 8) & 4278255360; k[(h + 64 >>> 9 << 4) + 14] = (b << 8 | b >>> 24) & 16711935 | (b << 24 | b >>> 8) & 4278255360; a.sigBytes = 4 * (k.length + 1); this._process(); a = this._hash; k = a.words; for (b = 0; 4 > b; b++) h = k[b], k[b] = (h << 8 | h >>> 24) & 16711935 | (h << 24 | h >>> 8) & 4278255360; return a }, clone: function () { var a = t.clone.call(this); a._hash = this._hash.clone(); return a } }); r.MD5 = t._createHelper(q); r.HmacMD5 = t._createHmacHelper(q) })(Math);\r\n    /* jshint ignore:end */\r\n    return CryptoJS.MD5(message).toString();\r\n};\r\n\r\n\r\n/***\r\n* Transform base64 image to blob\r\n* @b64Data \r\n* @contentType \r\n* @sliceSize \r\n*/\r\nbizagi.util.b64toBlob = function (b64Data, contentType, sliceSize) {\r\n    contentType = contentType || '';\r\n    sliceSize = sliceSize || 512;\r\n\r\n    var byteCharacters = atob(b64Data);\r\n    var byteArrays = [];\r\n\r\n    for (var offset = 0; offset < byteCharacters.length; offset += sliceSize) {\r\n        var slice = byteCharacters.slice(offset, offset + sliceSize);\r\n\r\n        var byteNumbers = new Array(slice.length);\r\n        for (var i = 0; i < slice.length; i++) {\r\n            byteNumbers[i] = slice.charCodeAt(i);\r\n        }\r\n\r\n        var byteArray = new Uint8Array(byteNumbers);\r\n\r\n        byteArrays.push(byteArray);\r\n    }\r\n\r\n    var blob = new Blob(byteArrays, { type: contentType });\r\n    return blob;\r\n};\r\n\r\nbizagi.util.arrayEach = function (array, callback) {\r\n    if (!!array) {\r\n        if (Object.prototype.toString.apply(array) === \"[object Array]\" && Object.prototype.toString.apply(callback) === \"[object Function]\") {\r\n            var index, value;\r\n            for (index in array) {\r\n                if (array.hasOwnProperty(index)) {\r\n                    value = callback.call(array[index], index, array[index]);\r\n                    if (value === false) {\r\n                        return;\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            $.each(array, callback);\r\n        }\r\n    }\r\n};\r\n\r\nfunction printf(msg) {\r\n    var args = Array.prototype.slice.call(arguments, 1), arg;\r\n    return msg.replace(/(%[disv])/g, function (a, val) {\r\n        arg = args.shift();\r\n        if (arg !== undefined) {\r\n            switch (val.charCodeAt(1)) {\r\n                case 100:\r\n                    return +arg; // d\r\n                case 105:\r\n                    return Math.round(+arg); // i\r\n                case 115:\r\n                    return String(arg); // s\r\n                case 118:\r\n                    return arg; // v\r\n            }\r\n        }\r\n        return val;\r\n    });\r\n}\r\n\r\n/*\r\n* Validates if the text is a valid opening and closing tags, including classes\r\n*/\r\nbizagi.util.isHTMLValidText = function (text) {\r\n    var ex = new RegExp(/<(.|\\n)*?>/g);\r\n    return ex.test(text);\r\n};\r\n\r\n\r\n/*\r\n*   Determines if a control as a scrollbar \r\n*/\r\nbizagi.util.hasScroll = function (el, direction) {\r\n    if (el.length)\r\n        el = el[0];\r\n    direction = (direction === 'vertical') ? 'scrollTop' : 'scrollLeft';\r\n    var result = !!el[direction];\r\n    if (!result) {\r\n        el[direction] = 1;\r\n        result = !!el[direction];\r\n        el[direction] = 0;\r\n    }\r\n    return result;\r\n};\r\n\r\n/**\r\n * Convert String to Base64 Unicode\r\n * @param {} str \r\n * @returns {} \r\n */\r\nbizagi.util.b64EncodeUnicode = function(string) {\r\n    return btoa(encodeURIComponent(string).replace(/%([0-9A-F]{2})/g, function (match, p1) {\r\n        return String.fromCharCode(\"0x\" + p1);\r\n    }));\r\n};\r\n\r\n//remove all the character except the +, - and decimal point\r\nbizagi.util.getStandardNotation = function (number, decimalSymbol) {\r\n    var plusCharacter = '+';\r\n    var minusCharacter = '-';\r\n    var decimalSymbol = decimalSymbol || '.';\r\n    var expSymbol = 'e';\r\n    var tmp = '';\r\n    //remove all the character except the +, -, decimal point and the numbers\r\n    var decimalNumber = false;\r\n    var exponentialNumber = false;\r\n    number = (number.length > 0 ? number.toString().toLowerCase() : '').replace(/ /g, '');\r\n    for (var i = 0; i < number.length; i++) {\r\n        if ((number[i] === plusCharacter || number[i] === minusCharacter) && (i === 0 || number[i - 1] == expSymbol)) {\r\n            tmp += number[i];\r\n        } else if (!isNaN(Number(number[i]))) {\r\n            tmp += number[i];\r\n        }\r\n        else if ((number[i] === decimalSymbol) && !decimalNumber) {\r\n            tmp += number[i];\r\n            decimalNumber = true;\r\n        }\r\n        else if ((number[i] === expSymbol) && !exponentialNumber) {\r\n            tmp += number[i];\r\n            exponentialNumber = true;\r\n        }\r\n    }\r\n    return tmp;\r\n};\r\n\r\n//Return it in normalized scientific notation\r\nbizagi.util.scientificNotationFormat = function (number, decimalSymbol, sdLimit, expMinLimit, expMaxLimit) {\r\n    decimalSymbol = decimalSymbol || '.';\r\n    number = bizagi.util.getStandardNotation(number, decimalSymbol);\r\n    sdLimit = (sdLimit > 0) ? sdLimit : 38;\r\n    expMinLimit = (expMinLimit > 0) ? expMinLimit : -125;\r\n    expMaxLimit = (expMaxLimit > 0) ? expMaxLimit : 125;\r\n    var expSimbol = 'e';\r\n    var sNregex = new RegExp('[0-9]+(' + decimalSymbol + '[0-9]+)?(e[+-]?[0-9]+)?');\r\n    var sNFormat = number.match(sNregex);\r\n\r\n    //get que prefix\r\n    var exp = 0;\r\n\r\n    var prefix = number[0] === '-' ? number[0] : '';\r\n    var originalPointIndex = 0;\r\n\r\n    number = number.replace(prefix, '');\r\n\r\n    //if the number is not in scientific notation\r\n    if (sNFormat && sNFormat[0] && sNFormat[2]) {\r\n        var tempParts = sNFormat[0] ? (sNFormat[0].replace(sNFormat[2], '').split(decimalSymbol)) : '';\r\n\r\n        var significantDigits = '';\r\n        var intPart = '';\r\n\r\n        //calculate significant digits\r\n        //remove zeros at the left\r\n        tempParts[0] = tempParts[0].replace(/^0+/g, '');\r\n\r\n        if (tempParts[0].length > 1) {\r\n            significantDigits = tempParts[0].slice(1);\r\n            originalPointIndex = significantDigits.length;\r\n            intPart = tempParts[0][0] || '';\r\n            significantDigits = significantDigits.concat(sNFormat[1] || '');\r\n        }\r\n        else if (tempParts[0].length === 1) {\r\n            intPart = tempParts[0][0] || '';\r\n            significantDigits = significantDigits.concat(tempParts[1] || '');\r\n        }\r\n        else {\r\n            originalPointIndex = tempParts[1].length;\r\n            tempParts[1] = tempParts[1].replace(/^0+/g, '');\r\n            originalPointIndex = (tempParts[1].length - 1) - originalPointIndex;\r\n            intPart = tempParts[1][0];\r\n            significantDigits = tempParts[1].slice(1);\r\n        }\r\n        //remove . and zeros from significant digits\r\n        significantDigits = significantDigits.replace(decimalSymbol, '').replace(/0+$/g, '');\r\n\r\n        if (significantDigits.length >= sdLimit) {\r\n            significantDigits = significantDigits.slice(0, sdLimit - 1);\r\n        }\r\n        exp = Number(sNFormat[2].replace(expSimbol, '')) + originalPointIndex;\r\n        exp = (exp > expMaxLimit) ? expMaxLimit : (exp < expMinLimit) ? expMinLimit : exp;\r\n        return prefix + intPart + (significantDigits ? (decimalSymbol + significantDigits) : '') + expSimbol + (exp > 0 ? '+' + exp : exp);\r\n    }\r\n    else if (number) {\r\n\r\n        originalPointIndex = number.indexOf(decimalSymbol);\r\n        var from = 0;\r\n        var to = number.length - 1;\r\n\r\n        //remove decimal point\r\n        number = number.replace(decimalSymbol, '');\r\n\r\n        //from\r\n        var i = from;\r\n        while (!significantFlag) {\r\n            if (number[i] !== '0' && number[i] !== decimalSymbol) { significantFlag = true; from = i; }\r\n            else { i++; }\r\n        }\r\n        //to\r\n        var significantFlag = false;\r\n        var j = to;\r\n        while (!significantFlag) {\r\n            if (number[j] !== '0' && number[j] !== decimalSymbol && '-') { significantFlag = true; to = j + 1; }\r\n            else { j--; }\r\n        }\r\n        to = to > sdLimit + from ? sdLimit + from : to;\r\n        if (originalPointIndex !== -1) {\r\n            //find significant digits\r\n            var significantFlag = false;\r\n            var significantDigits = number.slice(from, to);\r\n            var pointIndex = from + 1;\r\n            exp = originalPointIndex - pointIndex;\r\n            if (significantDigits.length > 0 && !isNaN(Number(significantDigits[0]))) {\r\n                return prefix + significantDigits[0] + (significantDigits.length > 1 ? decimalSymbol + significantDigits.slice(1) : '') + expSimbol + (exp > 0 ? '+' + exp : exp);\r\n            }\r\n            else { return '0'; }\r\n\r\n        }\r\n        else {\r\n            //Int numbers\r\n            var firstDigit = number.slice(from, from + 1);\r\n            var restDigits = number.slice(from + 1, number.length);\r\n            exp = restDigits.length;\r\n            restDigits = restDigits.replace(/0+$/g, '');\r\n            if (restDigits.length > sdLimit) {\r\n                restDigits = number.slice(from + 1, sdLimit + from);\r\n            }\r\n            if (Number(firstDigit)) {\r\n                return prefix + firstDigit + (restDigits.length > 0 ? decimalSymbol + restDigits : '') + expSimbol + (exp > 0 ? '+' + exp : exp);\r\n            } else { return '0'; }\r\n        }\r\n    }\r\n    else { return ''; }\r\n};\r\n\r\nbizagi.util.isString = function (value) {\r\n    return Object.prototype.toString.apply(value) === \"[object String]\";\r\n};\r\n\r\nbizagi.util.isArray = function (value) {\r\n    return Object.prototype.toString.apply(value) === \"[object Array]\";\r\n};","/*\r\n* jQuery UI Mask @VERSION\r\n*\r\n* Copyright (c) 2009 AUTHORS.txt (http://jqueryui.com/about)\r\n* Dual licensed under the MIT (MIT-LICENSE.txt)\r\n* and GPL (GPL-LICENSE.txt) licenses.\r\n*\r\n* Based on the jquery.maskedinput.js plugin by Josh Bush (digitalbush.com)\r\n*\r\n* http://docs.jquery.com/UI/Mask\r\n*\r\n* Depends:\r\n*   ui.core.js\r\n*/\r\n(function ($) {    \r\n\r\n    var pasteEventName = (bizagi.util.isEventSupported('paste') ? 'paste' : 'input') + \".mask\";\r\n\r\n    $.widget(\"ui.mask\", {\r\n\r\n        _init: function () {\r\n\r\n            var options = this.options, self = this;\r\n\r\n            $.extend(this, { caret: function (begin, end) { return $.ui.mask.caret(self.element, begin, end); } });\r\n\r\n            if (!options.mask || !options.mask.length) { return; } //no mask pattern defined. no point in continuing.\r\n            if (!options.placeholder || !options.placeholder.length) {\r\n                options.placeholder = '_'; //in case the user decided to nix a placeholder. \r\n            }\r\n\r\n            this._prepareBuffer();\r\n            this._bindEvents();\r\n            this._checkVal((this.element.val().length && options.allowPartials)); //Perform initial check for existing values\r\n        },\r\n\r\n        destroy: function () {\r\n            this.element\r\n\t\t\t.unbind('.mask')\r\n\t\t\t.removeData('mask');\r\n        },\r\n\r\n        value: function () {\r\n            var input = this.element,\r\n\t\t\tself = this,\r\n\t\t\tres = $.map(self.buffer, function (c, i) { return self.tests[i] ? c : null; }).join(''),\r\n\t\t\tr = new RegExp('\\\\' + this.options.placeholder, 'gi');\r\n            return res.replace(r, '');\r\n        },\r\n\r\n        formatted: function () {\r\n            var r = new RegExp('\\\\' + this.options.placeholder, 'gi'),\r\n\t\t\tres = this.element.val();\r\n            return res.replace(r, '');\r\n        },\r\n\r\n        apply: function () {\r\n            this.element.trigger('apply.mask');\r\n        },\r\n\r\n        _setData: function (key, value) {\r\n\r\n            $.widget.prototype._setData.apply(this, arguments);\r\n            var options = this.options;\r\n\r\n            switch (key) {\r\n                case 'mask':\r\n                    //no mask pattern defined. no point in continuing.\r\n                    if (!options.mask || !options.mask.length) {\r\n                        this.element.unbind('.mask')\r\n                        break;\r\n                    }\r\n                case 'placeholder':\r\n                    if (!options.placeholder || !options.placeholder.length) {\r\n                        options.placeholder = '_'; //in case the user decided to nix a placeholder.\r\n                    }\r\n                    this.element.val('');\r\n                    this._prepareBuffer();\r\n                    !this.eventsBound && this._bindEvents();\r\n                    break;\r\n            }\r\n\r\n        },\r\n\r\n        _prepareBuffer: function () {\r\n\r\n            this._escapeMask();\r\n\r\n            var self = this,\r\n\t\t\tinput = this.element,\r\n\t\t\toptions = this.options,\r\n\t\t\tmask = options.mask,\r\n\t\t\tdefs = $.ui.mask.definitions,\r\n\t\t\ttests = [],\r\n\t\t\tpartialPosition = mask.length,\r\n\t\t\tfirstNonMaskPos = null,\r\n\t\t\tlen = mask.length;\r\n\r\n            //if we're applying the mask to an element which is not an input, it won't have a val() method. fake one for our purposes.\r\n            if (!input.is(':input')) input.val = input.html;\r\n\r\n            $.each(mask.split(\"\"), function (i, c) {\r\n                if (c == '?') {\r\n                    len--;\r\n                    partialPosition = i;\r\n                }\r\n                else if (defs[c]) {\r\n                    tests.push(new RegExp(defs[c]));\r\n                    if (firstNonMaskPos == null)\r\n                        firstNonMaskPos = tests.length - 1;\r\n                }\r\n                else {\r\n                    tests.push(null);\r\n                }\r\n            });\r\n\r\n            $.extend(this, {\r\n                buffer: $.map(mask.split(\"\"), function (c, i) {\r\n                    if (c != '?') {\r\n                        return defs[c] ? options.placeholder : c;\r\n                    }\r\n                }),\r\n                tests: tests,\r\n                firstNonMaskPos: firstNonMaskPos,\r\n                partialPosition: partialPosition\r\n            });\r\n\r\n            this.buffer = $.map(this.buffer, function (c, i) {\r\n                if (c == \"\\t\") {\r\n                    return self.maskEscaped[i];\r\n                }\r\n                return c;\r\n            });\r\n\r\n            this.options.mask = mask = this.maskEscaped;\r\n        },\r\n\r\n        _bindEvents: function () {\r\n\r\n            var self = this,\r\n\t\t\tinput = this.element,\r\n\t\t\tignore = false,  \t\t\t//Variable for ignoring control keys\r\n\t\t\tfocusText = input.val();\r\n\r\n            function keydownEvent(e) {\r\n                e = e || window.event;\r\n                var pos = self.caret(),\r\n\t\t\t\tk = e.keyCode,\r\n\t\t\t\tkeyCode = $.ui.keyCode;\r\n\r\n                ignore = (k < keyCode.SHIFT || (k > keyCode.SHIFT && k < keyCode.SPACE) || (k > keyCode.SPACE && k < 41));\r\n\r\n                //delete selection before proceeding\r\n                if ((pos.begin - pos.end) != 0 && (!ignore || k == keyCode.BACKSPACE || k == keyCode.DELETE))\r\n                    self._clearBuffer(pos.begin, pos.end);\r\n\r\n                //backspace, delete, and escape get special treatment\r\n                if (k == keyCode.BACKSPACE || k == keyCode.DELETE) {//backspace/delete\r\n                    self._shiftL(pos.begin + ((k == keyCode.DELETE || (k == keyCode.BACKSPACE && pos.begin != pos.end)) ? 0 : -1), Math.abs(pos.begin - pos.end));\r\n                    return false;\r\n                }\r\n                else if (k == keyCode.ESCAPE) {//escape\r\n                    input.val(focusText);\r\n                    self.caret(0, self._checkVal());\r\n                    return false;\r\n                }\r\n            };\r\n\r\n            function keypressEvent(e) {\r\n\r\n                e = e || window.event;\r\n\r\n                var k = e.charCode || e.keyCode || e.which,\r\n\t\t\t\tkeyCode = $.ui.keyCode,\r\n\t\t\t\tlen = self.options.mask.length;\r\n\r\n                if (ignore) {\r\n                    ignore = false;\r\n                    //Fixes Mac FF bug on backspace\r\n                    return (e.keyCode == keyCode.BACKSPACE) ? false : null;\r\n                }\r\n\r\n                var pos = self.caret();\r\n\r\n                if (e.ctrlKey || e.altKey || e.metaKey) {//Ignore\r\n                    return true;\r\n                }\r\n                else if ((k >= keyCode.SPACE && k <= 125) || k > 186) {//typeable characters\r\n                    var p = self._seekNext(pos.begin - 1);\r\n                    if (p < len) {\r\n                        var c = String.fromCharCode(k);\r\n                        if (self.tests[p] && self.tests[p].test(c)) {\r\n                            self._shiftR(p);\r\n                            self.buffer[p] = c;\r\n                            self._writeBuffer();\r\n                            var next = self._seekNext(p);\r\n                            self.caret(next);\r\n                            self.options.completed && next == len && self.options.completed.call(input);\r\n                        }\r\n                    }\r\n                }\r\n                return false;\r\n            };\r\n\r\n            if (!input.attr(\"readonly\")) {\r\n                input\r\n\t\t\t\t.bind(\"focus.mask\", function () {\r\n\t\t\t\t    focusText = input.val();\r\n\t\t\t\t    var pos = self._checkVal();\r\n\t\t\t\t    self._writeBuffer();\r\n\t\t\t\t    setTimeout(function () {\r\n\t\t\t\t        if (pos == self.options.mask.length)\r\n\t\t\t\t            self.caret(0, pos);\r\n\t\t\t\t        else\r\n\t\t\t\t            self.caret(pos);\r\n\t\t\t\t    }, 0);\r\n\t\t\t\t})\r\n\t\t\t\t.bind(\"blur.mask\", function () {\r\n\t\t\t\t    self._checkVal();\r\n\t\t\t\t    if (input.val() != focusText)\r\n\t\t\t\t        input.change();\r\n\t\t\t\t})\r\n\t\t\t\t.bind(\"apply.mask\", function () { //changing the value of an input without keyboard input requires re-applying the mask.\r\n\t\t\t\t    focusText = input.val();\r\n\t\t\t\t    var pos = self._checkVal();\r\n\t\t\t\t    self._writeBuffer();\r\n\t\t\t\t})\r\n\t\t\t\t.bind(\"keydown.mask\", keydownEvent)\r\n\t\t\t\t.bind(\"keypress.mask\", keypressEvent)\r\n\t\t\t\t.bind(pasteEventName, function () {\r\n\t\t\t\t    setTimeout(function () { self.caret(self._checkVal(true)); }, 0);\r\n\t\t\t\t});\r\n                this.eventsBound = true;\r\n            }\r\n        },\r\n\r\n        _writeBuffer: function () {\r\n            return this.element.val(this.buffer.join('')).val();\r\n        },\r\n\r\n        _clearBuffer: function (start, end) {\r\n            var len = this.options.mask.length;\r\n            for (var i = start; i < end && i < len; i++) {\r\n                if (this.tests[i])\r\n                    this.buffer[i] = this.options.placeholder;\r\n            }\r\n        },\r\n\r\n        _seekNext: function (pos) {\r\n            var len = this.options.mask.length;\r\n            while (++pos <= len && !this.tests[pos]);\r\n            return pos;\r\n        },\r\n\r\n        _shiftR: function (pos) {\r\n            var len = this.options.mask.length;\r\n            for (var i = pos, c = this.options.placeholder; i < len; i++) {\r\n                if (this.tests[i]) {\r\n                    var j = this._seekNext(i);\r\n                    var t = this.buffer[i];\r\n                    this.buffer[i] = c;\r\n                    if (j < len && this.tests[j].test(t)) {\r\n                        c = t;\r\n                    }\r\n                    else {\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n        _shiftL: function (pos, length) {\r\n\r\n            while (!this.tests[pos] && --pos >= 0);\r\n\r\n            var originalPos = pos,\r\n\t\t\tlen = this.options.mask.length,\r\n\t\t\tplaceholder = this.options.placeholder;\r\n\r\n            for (var i = pos; i < len && (i >= 0 || length > 1); i++) {\r\n                if (this.tests[i]) {\r\n                    this.buffer[i] = placeholder;\r\n                    var j = this._seekNext(i);\r\n                    if (j < len && this.tests[i].test(this.buffer[j])) {\r\n                        this.buffer[pos] = this.buffer[j];\r\n                        this.buffer[j] = placeholder;\r\n                        pos++;\r\n                        while (!this.tests[pos]) pos++;\r\n                    }\r\n                }\r\n            }\r\n            this._writeBuffer();\r\n            this.caret(Math.max(this.firstNonMaskPos, originalPos));\r\n        },\r\n\r\n        _checkVal: function (allow) {\r\n            //try to place characters where they belong\r\n            var input = this.element,\r\n\t\t\ttest = input.val(),\r\n\t\t\tlen = this.options.mask.length,\r\n\t\t\tlastMatch = -1;\r\n\r\n            for (var i = 0, pos = 0; i < len; i++) {\r\n                if (this.tests[i]) {\r\n                    this.buffer[i] = this.options.placeholder;\r\n                    while (pos++ < test.length) {\r\n                        var c = test.charAt(pos - 1);\r\n                        if (this.tests[i].test(c)) {\r\n                            this.buffer[i] = c;\r\n                            lastMatch = i;\r\n                            break;\r\n                        }\r\n                    }\r\n                    if (pos > test.length)\r\n                        break;\r\n                }\r\n                else if (this.buffer[i] == test[pos] && i != this.partialPosition) {\r\n                    pos++;\r\n                    lastMatch = i;\r\n                }\r\n            }\r\n            if (!allow && lastMatch + 1 < this.partialPosition) {\r\n                if (!this.options.allowPartials || !this.value().length) {\r\n                    input.val(\"\");\r\n                    this._clearBuffer(0, len);\r\n                }\r\n                else //if we're allowing partial input/inital values, and the element we're masking isnt an input, then we need to allow the mask to apply.\r\n                    if (!input.is(':input')) this._writeBuffer();\r\n\r\n            }\r\n            else if (allow || lastMatch + 1 >= this.partialPosition) {\r\n                this._writeBuffer();\r\n                if (!allow) input.val(input.val().substring(0, lastMatch + 1));\r\n            }\r\n            return (this.partialPosition ? i : this.firstNonMaskPos);\r\n        },\r\n\r\n        _escapeMask: function () {\r\n            var mask = this.options.mask,\r\n\t\t\tliterals = [],\r\n\t\t\treplacements = [];\r\n\r\n            for (var i = 0; i < mask.length; i++) {\r\n                var c, temp = mask[i] || mask.charAt(i);\r\n                if (temp != \"\\\\\" || mask[i - 1] == \"\\\\\") {\r\n                    if (mask[i - 1] == \"\\\\\") {\r\n                        c = \"\\t\";\r\n                        replacements[literals.length] = temp;\r\n                    }\r\n                    else {\r\n                        c = temp;\r\n                    }\r\n                    literals[literals.length] = c;\r\n                }\r\n            }\r\n\r\n            this.options.mask = literals.join('');\r\n\r\n            for (var i = 0; i < literals.length; i++) {\r\n                if (replacements[i] !== undefined) {\r\n                    literals[i] = replacements[i];\r\n                }\r\n            }\r\n\r\n            this.maskEscaped = literals.join('');\r\n        }\r\n\r\n    });\r\n\r\n    $.extend($.ui.mask, {\r\n        version: \"@VERSION\",\r\n        getter: \"value formatted\",\r\n        defaults: {\r\n            mask: '',\r\n            placeholder: '_',\r\n            completed: null,\r\n            allowPartials: false\r\n        },\r\n        definitions: { //Predefined character definitions\r\n            '#': \"[\\\\d]\",\r\n            'a': \"[A-Za-z]\",\r\n            '*': \"[A-Za-z0-9]\"\r\n        },\r\n        caret: function (element, begin, end) {\t//Helper Function for Caret positioning\r\n            var input = element[0];\r\n            if (typeof begin == 'number') {\r\n                end = (typeof end == 'number') ? end : begin;\r\n                if (input.setSelectionRange) {\r\n                    input.focus();\r\n                    input.setSelectionRange(begin, end);\r\n                } else if (input.createTextRange) {\r\n                    var range = input.createTextRange();\r\n                    range.collapse(true);\r\n                    range.moveEnd('character', end);\r\n                    range.moveStart('character', begin);\r\n                    range.select();\r\n                }\r\n                return element;\r\n            } else {\r\n                if (input.setSelectionRange) {\r\n                    begin = input.selectionStart;\r\n                    end = input.selectionEnd;\r\n                }\r\n                else if (document.selection && document.selection.createRange) {\r\n                    var range = document.selection.createRange();\r\n                    begin = 0 - range.duplicate().moveStart('character', -100000);\r\n                    end = begin + range.text.length;\r\n                }\r\n                return { begin: begin, end: end };\r\n            }\r\n        }\r\n    });\r\n\r\n})(jQuery);","/*\r\n*\r\n* Copyright (c) 2006/2007 Sam Collett (http://www.texotela.co.uk)\r\n* Licensed under the MIT License:\r\n* http://www.opensource.org/licenses/mit-license.php\r\n* \r\n* Version 1.0\r\n* Demo: http://www.texotela.co.uk/code/jquery/numeric/\r\n*\r\n* $LastChangedDate: 2007-05-29 11:31:36 +0100 (Tue, 29 May 2007) $\r\n* $Rev: 2005 $\r\n*/\r\n\r\n/*\r\n* Allows only valid characters to be entered into input boxes.\r\n* Note: does not validate that the final text is a valid number\r\n* (that could be done by another script, or server-side)\r\n*\r\n* @name     numeric\r\n* @param    decimal      Decimal separator (e.g. '.' or ',' - default is '.')\r\n* @param    callback     A function that runs if the number is not valid (fires onblur)\r\n* @author   Sam Collett (http://www.texotela.co.uk)\r\n* @example  $(\".numeric\").numeric();\r\n* @example  $(\".numeric\").numeric(\",\");\r\n* @example  $(\".numeric\").numeric(null, callback);\r\n*\r\n*/\r\njQuery.fn.numeric = function (decimal, callback) {\r\n    decimal = decimal || \".\";\r\n    callback = typeof callback == \"function\" ? callback : function () { };\r\n    this.keypress(\r\n\t\tfunction (e) {\r\n\t\t    var key = e.charCode ? e.charCode : e.keyCode ? e.keyCode : 0;\r\n\t\t    // allow enter/return key (only when in an input box)\r\n\t\t    if (key == 13 && this.nodeName.toLowerCase() == \"input\") {\r\n\t\t        return true;\r\n\t\t    }\r\n\t\t    else if (key == 13) {\r\n\t\t        return false;\r\n\t\t    }\r\n\t\t    var allow = false;\r\n\t\t    // allow Ctrl+A\r\n\t\t    if ((e.ctrlKey && key == 97 /* firefox */) || (e.ctrlKey && key == 65) /* opera */) return true;\r\n\t\t    // allow Ctrl+X (cut)\r\n\t\t    if ((e.ctrlKey && key == 120 /* firefox */) || (e.ctrlKey && key == 88) /* opera */) return true;\r\n\t\t    // allow Ctrl+C (copy)\r\n\t\t    if ((e.ctrlKey && key == 99 /* firefox */) || (e.ctrlKey && key == 67) /* opera */) return true;\r\n\t\t    // allow Ctrl+Z (undo)\r\n\t\t    if ((e.ctrlKey && key == 122 /* firefox */) || (e.ctrlKey && key == 90) /* opera */) return true;\r\n\t\t    // allow or deny Ctrl+V (paste), Shift+Ins\r\n\t\t    if ((e.ctrlKey && key == 118 /* firefox */) || (e.ctrlKey && key == 86) /* opera */\r\n\t\t\t|| (e.shiftKey && key == 45)) return true;\r\n\t\t    // if a number was not pressed\r\n\t\t    if (key < 48 || key > 57) {\r\n\t\t        /* '-' only allowed at start */\r\n\t\t        if (key == 45 && this.value.length == 0) return true;\r\n\t\t        /* only one decimal separator allowed */\r\n\t\t        if (key == decimal.charCodeAt(0) && this.value.indexOf(decimal) != -1) {\r\n\t\t            allow = false;\r\n\t\t        }\r\n\t\t        // check for other keys that have special purposes\r\n\t\t        if (\r\n\t\t\t\t\tkey != 8 /* backspace */ &&\r\n\t\t\t\t\tkey != 9 /* tab */ &&\r\n\t\t\t\t\tkey != 13 /* enter */ &&\r\n\t\t\t\t\tkey != 35 /* end */ &&\r\n\t\t\t\t\tkey != 36 /* home */ &&\r\n\t\t\t\t\tkey != 37 /* left */ &&\r\n\t\t\t\t\tkey != 39 /* right */ &&\r\n\t\t\t\t\tkey != 46 /* del */\r\n\t\t\t\t) {\r\n\t\t            allow = false;\r\n\t\t        }\r\n\t\t        else {\r\n\t\t            // for detecting special keys (listed above)\r\n\t\t            // IE does not support 'charCode' and ignores them in keypress anyway\r\n\t\t            if (typeof e.charCode != \"undefined\") {\r\n\t\t                // special keys have 'keyCode' and 'which' the same (e.g. backspace)\r\n\t\t                if (e.keyCode == e.which && e.which != 0) {\r\n\t\t                    allow = true;\r\n\t\t                }\r\n\t\t                // or keyCode != 0 and 'charCode'/'which' = 0\r\n\t\t                else if (e.keyCode != 0 && e.charCode == 0 && e.which == 0) {\r\n\t\t                    allow = true;\r\n\t\t                }\r\n\t\t            }\r\n\t\t        }\r\n\t\t        // if key pressed is the decimal and it is not already in the field\r\n\t\t        if (key == decimal.charCodeAt(0) && this.value.indexOf(decimal) == -1) {\r\n\t\t            allow = true;\r\n\t\t        }\r\n\t\t    }\r\n\t\t    else {\r\n\t\t        allow = true;\r\n\t\t    }\r\n\t\t    return allow;\r\n\t\t}\r\n\t)\r\n\t.blur(\r\n\t\tfunction () {\r\n\t\t    var val = jQuery(this).val();\r\n\t\t    if (val != \"\") {\r\n\t\t        var re = new RegExp(\"^\\\\d+$|\\\\d*\" + decimal + \"\\\\d+\");\r\n\t\t        if (!re.exec(val)) {\r\n\t\t            callback.apply(this);\r\n\t\t        }\r\n\t\t    }\r\n\t\t}\r\n\t);\r\n    return this;\r\n}\r\n\r\njQuery.fn.numericSN = function (decimal, exp) {\r\n    decimal = decimal || \".\";\r\n    exp = exp || \"e\";\r\n    var plus = '+';\r\n    var minus = '-';\r\n    callback = typeof callback == \"function\" ? callback : function () { };\r\n    this.keypress(\r\n        function (e) {\r\n            var key = e.charCode ? e.charCode : e.keyCode ? e.keyCode : 0;\r\n            // allow enter/return key (only when in an input box)\r\n            if (key == 13 && this.nodeName.toLowerCase() == \"input\") {\r\n                return true;\r\n            }\r\n            else if (key == 13) {\r\n                return false;\r\n            }\r\n            var allow = false;\r\n            // allow Ctrl+A\r\n            if ((e.ctrlKey && key == 97 /* firefox */) || (e.ctrlKey && key == 65) /* opera */) return true;\r\n            // allow Ctrl+X (cut)\r\n            if ((e.ctrlKey && key == 120 /* firefox */) || (e.ctrlKey && key == 88) /* opera */) return true;\r\n            // allow Ctrl+C (copy)\r\n            if ((e.ctrlKey && key == 99 /* firefox */) || (e.ctrlKey && key == 67) /* opera */) return true;\r\n            // allow Ctrl+Z (undo)\r\n            if ((e.ctrlKey && key == 122 /* firefox */) || (e.ctrlKey && key == 90) /* opera */) return true;\r\n            // allow or deny Ctrl+V (paste), Shift+Ins\r\n            if ((e.ctrlKey && key == 118 /* firefox */) || (e.ctrlKey && key == 86) /* opera */\r\n                || (e.shiftKey && key == 45)) return true;\r\n            // if a number was not pressed\r\n            if (key < 48 || key > 57) {\r\n\r\n                /* only one decimal separator allowed */\r\n                if (key == decimal.charCodeAt(0) && this.value.indexOf(decimal) != -1) {\r\n                    allow = false;\r\n                }\r\n                /* only one e character allowed */\r\n                if (key == exp.charCodeAt(0) && this.value.indexOf(exp) != -1) {\r\n                    allow = false;\r\n                }\r\n\r\n\r\n                // check for other keys that have special purposes\r\n                if (\r\n                    key != 8 /* backspace */ &&\r\n                    key != 9 /* tab */ &&\r\n                    key != 13 /* enter */ &&\r\n                    key != 35 /* end */ &&\r\n                    key != 36 /* home */ &&\r\n                    key != 37 /* left */ &&\r\n                    key != 39 /* right */\r\n                    ) {\r\n                    allow = false;\r\n                }\r\n                else {\r\n                    // for detecting special keys (listed above)\r\n                    // IE does not support 'charCode' and ignores them in keypress anyway\r\n                    if (typeof e.charCode != \"undefined\") {\r\n                        // special keys have 'keyCode' and 'which' the same (e.g. backspace)\r\n                        if (e.keyCode == e.which && e.which != 0) {\r\n                            allow = true;\r\n                        }\r\n                        // or keyCode != 0 and 'charCode'/'which' = 0\r\n                        else if (e.keyCode != 0 && e.charCode == 0 && e.which == 0) {\r\n                            allow = true;\r\n                        }\r\n                    }\r\n                }\r\n                // if key pressed is the exp and it is not already in the field\r\n                if (key == exp.charCodeAt(0) && this.value.indexOf(exp) == -1) {\r\n                    allow = true;\r\n                }\r\n                 // if key pressed is the decimal and it is not already in the field\r\n                if (key == decimal.charCodeAt(0) && this.value.indexOf(decimal) == -1) {\r\n                    allow = true;\r\n                }\r\n\r\n                /* allow plus and minus keys*/\r\n                if (key == minus.charCodeAt(0) || key == plus.charCodeAt(0)) {\r\n                    allow = true;\r\n                }\r\n            }\r\n            else {\r\n                allow = true;\r\n            }\r\n            return allow;\r\n        }\r\n    )\r\n        .blur(\r\n        function () {\r\n            var val = jQuery(this).val();\r\n            if (val != \"\") {\r\n                var re = new RegExp(\"^\\\\d+$|\\\\d*\" + decimal + \"\\\\d+\");\r\n                if (!re.exec(val)) {\r\n                    callback.apply(this);\r\n                }\r\n            }\r\n        }\r\n    );\r\n    return this;\r\n}","//  This file is part of the jQuery formatCurrency Plugin.\r\n//\r\n//    The jQuery formatCurrency Plugin is free software: you can redistribute it\r\n//    and/or modify it under the terms of the GNU General Public License as published \r\n//    by the Free Software Foundation, either version 3 of the License, or\r\n//    (at your option) any later version.\r\n\r\n//    The jQuery formatCurrency Plugin is distributed in the hope that it will\r\n//    be useful, but WITHOUT ANY WARRANTY; without even the implied warranty \r\n//    of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n//    GNU General Public License for more details.\r\n//\r\n//    You should have received a copy of the GNU General Public License along with \r\n//    the jQuery formatCurrency Plugin.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n(function ($) {\r\n\r\n    $.formatCurrency = {};\r\n\r\n    $.formatCurrency.regions = [];\r\n\r\n    // default Region is en\r\n    $.formatCurrency.regions[''] = {\r\n        symbol: '$',\r\n        positiveFormat: '%s%n',\r\n        negativeFormat: '(%s%n)',\r\n        decimalSymbol: '.',\r\n        digitGroupSymbol: ',',\r\n        groupDigits: true\r\n    };\r\n\r\n    $.fn.formatCurrency = function (destination, settings) {\r\n\r\n        if (arguments.length == 1 && typeof destination !== \"string\") {\r\n            settings = destination;\r\n            destination = false;\r\n        }\r\n\r\n        // initialize defaults\r\n        var defaults = {\r\n            name: \"formatCurrency\",\r\n            colorize: false,\r\n            region: '',\r\n            global: true,\r\n            roundToDecimalPlace: 2, // roundToDecimalPlace: -1; for no rounding; 0 to round to the dollar; 1 for one digit cents; 2 for two digit cents; 3 for three digit cents; ...\r\n            eventOnDecimalsEntered: false\r\n        };\r\n        // initialize default region\r\n        defaults = $.extend(defaults, $.formatCurrency.regions['']);\r\n        // override defaults with settings passed in\r\n        settings = $.extend(defaults, settings);\r\n\r\n        // check for region setting\r\n        if (settings.region.length > 0) {\r\n            settings = $.extend(settings, getRegionOrCulture(settings.region));\r\n        }\r\n        settings.regex = generateRegex(settings);\r\n\r\n        return this.each(function () {\r\n            var $this = $(this);\r\n\r\n            // get number\r\n            var num = '0';\r\n            var multiCeroPattern = new RegExp(\"^(0+|-0+)\",\"g\");\r\n            num = $this[$this.is('input, select, textarea') ? 'val' : 'html']();\r\n\r\n            //identify '(123)' as a negative number\r\n            if (num.search('\\\\(') >= 0) {\r\n                num = '-' + num;\r\n            }\r\n\r\n            // Identify 0000 and -0000 pattern, and replace to 0\r\n            if (!num.match(/[1-9]/g))  num = num.replace(multiCeroPattern, 0);\r\n\r\n            if (num === '' || (num === '-' && settings.roundToDecimalPlace === -1)) {\r\n                return;\r\n            }\r\n\r\n            // if the number is valid use it, otherwise clean it\r\n            if (isNaN(num)) {\r\n                // clean number\r\n                num = num.replace(settings.regex, '');\r\n\r\n                if (num === '' || (num === '-' && settings.roundToDecimalPlace === -1)) {\r\n                    return;\r\n                }\r\n\r\n                if (settings.decimalSymbol != '.') {\r\n                    num = num.replace(settings.decimalSymbol, '.');  // reset to US decimal for arithmetic\r\n                }\r\n                if (isNaN(num)) {\r\n                    num = '0';\r\n                }\r\n            }\r\n\r\n            // evalutate number input\r\n            var numParts = String(num).split('.');\r\n            var isPositive = (num == Math.abs(num));\r\n            var hasDecimals = (numParts.length > 1);\r\n            var decimals = (hasDecimals ? numParts[1].toString() : '0');\r\n            var originalDecimals = decimals;\r\n\r\n            // format number\r\n            num = Math.abs(numParts[0]);\r\n            num = isNaN(num) ? 0 : num;\r\n            if (settings.roundToDecimalPlace >= 0) {\r\n                decimals = parseFloat('1.' + decimals); // prepend \"0.\"; (IE does NOT round 0.50.toFixed(0) up, but (1+0.50).toFixed(0)-1\r\n                decimals = decimals.toFixed(settings.roundToDecimalPlace); // round\r\n                if (decimals.substring(0, 1) == '2') {\r\n                    num = Number(num) + 1;\r\n                }\r\n                decimals = decimals.substring(2); // remove \"0.\"\r\n            }\r\n            num = String(num);\r\n\r\n            if (settings.groupDigits) {\r\n                for (var i = 0; i < Math.floor((num.length - (1 + i)) / 3); i++) {\r\n                    num = num.substring(0, num.length - (4 * i + 3)) + settings.digitGroupSymbol + num.substring(num.length - (4 * i + 3));\r\n                }\r\n            }\r\n\r\n            if ((hasDecimals && settings.roundToDecimalPlace == -1) || settings.roundToDecimalPlace > 0) {\r\n                num += settings.decimalSymbol + decimals;\r\n            }\r\n\r\n            // format symbol/negative\r\n            var format = isPositive ? settings.positiveFormat : settings.negativeFormat;\r\n            var money = format.replace(/%s/g, settings.symbol);\r\n            money = money.replace(/%n/g, num);\r\n\r\n            // setup destination\r\n            var $destination = $([]);\r\n            if (!destination) {\r\n                $destination = $this;\r\n            } else {\r\n                $destination = $(destination);\r\n            }\r\n            // set destination\r\n            $destination[$destination.is('input, select, textarea') ? 'val' : 'html'](money);\r\n\r\n            if (\r\n\t\t\t\thasDecimals &&\r\n\t\t\t\tsettings.eventOnDecimalsEntered &&\r\n\t\t\t\toriginalDecimals.length > settings.roundToDecimalPlace\r\n\t\t\t) {\r\n                $destination.trigger('decimalsEntered', originalDecimals);\r\n            }\r\n\r\n            // colorize\r\n            if (settings.colorize) {\r\n                $destination.css('color', isPositive ? 'black' : 'red');\r\n            }\r\n        });\r\n    };\r\n\r\n    // Remove all non numbers from text\r\n    $.fn.toNumber = function (settings) {\r\n        var defaults = $.extend({\r\n            name: \"toNumber\",\r\n            region: '',\r\n            global: true\r\n        }, $.formatCurrency.regions['']);\r\n\r\n        settings = jQuery.extend(defaults, settings);\r\n        if (settings.region.length > 0) {\r\n            settings = $.extend(settings, getRegionOrCulture(settings.region));\r\n        }\r\n        settings.regex = generateRegex(settings);\r\n\r\n        return this.each(function () {\r\n            var method = $(this).is('input, select, textarea') ? 'val' : 'html';\r\n            $(this)[method]($(this)[method]().replace('(', '(-').replace(settings.regex, ''));\r\n        });\r\n    };\r\n\r\n    // returns the value from the first element as a number\r\n    $.fn.asNumber = function (settings) {\r\n        var defaults = $.extend({\r\n            name: \"asNumber\",\r\n            region: '',\r\n            parse: true,\r\n            parseType: 'Float',\r\n            global: true\r\n        }, $.formatCurrency.regions['']);\r\n        settings = jQuery.extend(defaults, settings);\r\n        if (settings.region.length > 0) {\r\n            settings = $.extend(settings, getRegionOrCulture(settings.region));\r\n        }\r\n        settings.regex = generateRegex(settings);\r\n        settings.parseType = validateParseType(settings.parseType);\r\n\r\n        var method = $(this).is('input, select, textarea') ? 'val' : 'html';\r\n        var num = $(this)[method]();\r\n        num = num ? num : \"\";\r\n        num = num.replace('(', '(-');\r\n        num = num.replace(settings.regex, '');\r\n        if (!settings.parse) {\r\n            return num;\r\n        }\r\n\r\n        if (num.length == 0) {\r\n            num = '0';\r\n        }\r\n\r\n        if (settings.decimalSymbol != '.') {\r\n            num = num.replace(settings.decimalSymbol, '.');  // reset to US decimal for arthmetic\r\n        }\r\n\r\n        return window['parse' + settings.parseType](num);\r\n    };\r\n\r\n    function getRegionOrCulture(region) {\r\n        var regionInfo = $.formatCurrency.regions[region];\r\n        if (regionInfo) {\r\n            return regionInfo;\r\n        }\r\n        else {\r\n            if (/(\\w+)-(\\w+)/g.test(region)) {\r\n                var culture = region.replace(/(\\w+)-(\\w+)/g, \"$1\");\r\n                return $.formatCurrency.regions[culture];\r\n            }\r\n        }\r\n        // fallback to extend(null) (i.e. nothing)\r\n        return null;\r\n    }\r\n\r\n    function validateParseType(parseType) {\r\n        switch (parseType.toLowerCase()) {\r\n            case 'int':\r\n                return 'Int';\r\n            case 'float':\r\n                return 'Float';\r\n            default:\r\n                throw 'invalid parseType';\r\n        }\r\n    }\r\n\r\n    function generateRegex(settings) {\r\n        if (settings.symbol === '') {\r\n            return new RegExp(\"[^\\\\d\" + settings.decimalSymbol + \"-]\", \"g\");\r\n        }\r\n        else {\r\n            var symbol = settings.symbol.replace('$', '\\\\$').replace('.', '\\\\.');\r\n            return new RegExp(symbol + \"|[^\\\\d\" + settings.decimalSymbol + \"-]\", \"g\");\r\n        }\r\n    }\r\n\r\n})(jQuery);","/**\r\n* Timeago is a jQuery plugin that makes it easy to support automatically\r\n* updating fuzzy timestamps (e.g. \"4 minutes ago\" or \"about 1 day ago\").\r\n*\r\n* @name timeago\r\n* @version 1.3.1\r\n* @requires jQuery v1.2.3+\r\n* @author Ryan McGeary\r\n* @license MIT License - http://www.opensource.org/licenses/mit-license.php\r\n*\r\n* For usage and examples, visit:\r\n* http://timeago.yarp.com/\r\n*\r\n* Copyright (c) 2008-2013, Ryan McGeary (ryan -[at]- mcgeary [*dot*] org)\r\n*/\r\n\r\n(function ($) {\r\n    $.timeago = function (timestamp) {\r\n        $t.settings = {\r\n            refreshMillis: 60000,\r\n            allowFuture: false,\r\n            localeTitle: false,\r\n            cutoff: 0,\r\n            strings: {\r\n                prefixAgo: null,\r\n                prefixFromNow: null,\r\n                suffixAgo: bizagi.localization.getResource(\"bizagi-editor-form-timeago-ago\"),\r\n                suffixFromNow: bizagi.localization.getResource(\"bizagi-editor-form-timeago-from-now\"),\r\n                seconds: bizagi.localization.getResource(\"bizagi-editor-form-timeago-seconds\"),\r\n                minute: bizagi.localization.getResource(\"bizagi-editor-form-timeago-minute\"),\r\n                minutes: bizagi.localization.getResource(\"bizagi-editor-form-timeago-minutes\"),\r\n                hour: bizagi.localization.getResource(\"bizagi-editor-form-timeago-hour\"),\r\n                hours: bizagi.localization.getResource(\"bizagi-editor-form-timeago-hours\"),\r\n                day: bizagi.localization.getResource(\"bizagi-editor-form-timeago-day\"),\r\n                days: bizagi.localization.getResource(\"bizagi-editor-form-timeago-days\"),\r\n                month: bizagi.localization.getResource(\"bizagi-editor-form-timeago-month\"),\r\n                months: bizagi.localization.getResource(\"bizagi-editor-form-timeago-months\"),\r\n                year: bizagi.localization.getResource(\"bizagi-editor-form-timeago-year\"),\r\n                years: bizagi.localization.getResource(\"bizagi-editor-form-timeago-years\"),\r\n                wordSeparator: \" \",\r\n                numbers: []\r\n            }\r\n        };\r\n\r\n        if (timestamp instanceof Date) {\r\n            return inWords(timestamp);\r\n        } else if (typeof timestamp === \"string\") {\r\n            timestamp = timestamp.replace(\".\", \"-\");\r\n            return inWords($.timeago.parse(timestamp));\r\n        } else if (typeof timestamp === \"number\") {\r\n            return inWords(new Date(timestamp));\r\n        } else {\r\n            return inWords($.timeago.datetime(timestamp));\r\n        }\r\n    };\r\n    var $t = $.timeago;\r\n\r\n    $.extend($.timeago, {\r\n\r\n        /*\r\n        *\r\n        */\r\n        inWords: function (distanceMillis) {\r\n            var $l = this.settings.strings;\r\n            var prefix = $l.prefixAgo;\r\n            var suffix = $l.suffixAgo;\r\n            if (this.settings.allowFuture) {\r\n                if (distanceMillis < 0) {\r\n                    prefix = $l.prefixFromNow;\r\n                    suffix = $l.suffixFromNow;\r\n                }\r\n            }\r\n\r\n            var seconds = Math.abs(distanceMillis) / 1000;\r\n            var minutes = seconds / 60;\r\n            var hours = minutes / 60;\r\n            var days = hours / 24;\r\n            var years = days / 365;\r\n\r\n            function substitute(stringOrFunction, number) {\r\n                var string = $.isFunction(stringOrFunction) ? stringOrFunction(number, distanceMillis) : stringOrFunction;\r\n                var value = ($l.numbers && $l.numbers[number]) || number;\r\n                return string.replace(/%d/i, value);\r\n            }\r\n\r\n            var words = seconds < 45 && substitute($l.seconds, Math.round(seconds)) ||\r\n                        seconds < 90 && substitute($l.minute, 1) ||\r\n                        minutes < 45 && substitute($l.minutes, Math.round(minutes)) ||\r\n                        minutes < 90 && substitute($l.hour, 1) ||\r\n                        hours < 24 && substitute($l.hours, Math.round(hours)) ||\r\n                        hours < 42 && substitute($l.day, 1) ||\r\n                        days < 30 && substitute($l.days, Math.round(days)) ||\r\n                        days < 45 && substitute($l.month, 1) ||\r\n                        days < 365 && substitute($l.months, Math.round(days / 30)) ||\r\n                        years < 1.5 && substitute($l.year, 1) ||\r\n                        substitute($l.years, Math.round(years));\r\n\r\n            var separator = $l.wordSeparator || \"\";\r\n            if ($l.wordSeparator === undefined) { separator = \" \"; }\r\n            return $.trim([prefix, words, suffix].join(separator));\r\n        },\r\n        /*\r\n        *\r\n        */\r\n        parse: function (iso8601) {\r\n            var s = $.trim(iso8601);\r\n            s = s.replace(/\\.\\d+/, \"\"); // remove milliseconds\r\n            s = s.replace(/-/, \"/\").replace(/-/, \"/\");\r\n            s = s.replace(/T/, \" \").replace(/Z/, \" UTC\");\r\n            s = s.replace(/([\\+\\-]\\d\\d)\\:?(\\d\\d)/, \" $1$2\"); // -04:00 -> -0400\r\n            s = s.replace(/([\\+\\-]\\d\\d)$/, \" $100\"); // +09 -> +0900\r\n            return new Date(s);\r\n        },\r\n        /*\r\n        *\r\n        */\r\n        datetime: function (elem) {\r\n            var iso8601 = $t.isTime(elem) ? $(elem).attr(\"datetime\") : $(elem).attr(\"title\");\r\n            return $t.parse(iso8601);\r\n        },\r\n        /*\r\n        *\r\n        */\r\n        isTime: function (elem) {\r\n            // jQuery's `is()` doesn't play well with HTML5 in IE\r\n            return $(elem).get(0).tagName.toLowerCase() === \"time\"; // $(elem).is(\"time\");\r\n        }\r\n    });\r\n\r\n    function inWords(date) {\r\n        return $t.inWords(distance(date));\r\n    }\r\n\r\n    function distance(date) {\r\n        return (new Date().getTime() - date.getTime());\r\n    }\r\n\r\n})(jQuery);\r\n","/**\r\n * Name:\r\n *   Author: Bizagi Mobile team\r\n *   Comments:\r\n * Structure to applicate plugin\r\n *  <div class=\"bz-bizagi-container-tap-popup\"> //container\r\n    <div class=\"cell bz-container-items-tabs\"> // represent item of tab\r\n    <span >${displayName}</span>// the first span always is the title                                    \r\n    <span> ........</span> // after the span can place the items you want\r\n    <div> .........</div> // etc\r\n    </div> <!-- end cell-->\r\n    </div><!-- end bz-bizagi-container-tap-popup-->\r\n**/\r\n(function ($) {\r\n    $.fn.bztabs = function (params) {\r\n\r\n        var self = $(this);\r\n\r\n        params = params || {};\r\n        params.activeTab = params.activeTab || 0;\r\n        params.tabNumber = params.tabNumber || 1;\r\n\r\n\r\n        var activate = (params.activate && typeof params.activate === \"function\") ? params.activate : function () { };\r\n        var beforeActivate = (params.beforeActivate && typeof params.beforeActivate === \"function\") ? params.beforeActivate : function () { };\r\n\r\n        // PopUp control\r\n        var popUp = self.find(\">div.bz-bizagi-container-tap-popup\").hide();\r\n        // Depending on tabNumber a percentage will be in the width of each tab\r\n        var tabCountPopup = popUp.children().length;\r\n        // Base to build the header of tabs\r\n        var tabHeader = $(\"<div class='bz-header_select'></div>\");\r\n\r\n        var tabCountReal = (params.tabNumber > tabCountPopup) ? tabCountPopup : params.tabNumber;\r\n\r\n        // round down\r\n        var widthRow = Math.floor(100 / Number(tabCountReal));\r\n\r\n        // Duplicate the tabs to create the header\r\n        popUp.children().each(function (i, item) {\r\n            tabHeader.append(\r\n                \"<div class='bz-wp-tabs-ui bz-wp-tabs-item' data-index='\" + i + \"' data-reference-tab='\" +\r\n                item.getAttribute(\"data-reference-tab\") + \"'><span>\" +\r\n                item.textContent + \"</span></div>\");\r\n        });\r\n\r\n        tabHeader.find(\"> .bz-wp-tabs-ui\").css(\"width\", widthRow + \"%\");        \r\n        tabHeader.append(\"<div class='bz-wp-tabs-arrow-container'><div class='bz-cm-icon bz-mo-icon bz-plus'></div></div>\");\r\n\r\n        self.prepend(tabHeader);\r\n\r\n        var tabCurrent = self.find(\"> .bz-bizagi-container-tap-popup > .bz-container-items-tabs\").eq(params.activeTab);\r\n        var itemCurrent = $($(tabCurrent).data(\"reference-tab\"), self);\r\n\r\n        itemCurrent.addClass(\"childrenActive\");\r\n        tabCurrent.addClass(\"tabSelected\");\r\n\r\n        // Mark the selected tab in the header\r\n        var activeTab = $(\".bz-wp-tabs-ui:nth-child(\" + (params.activeTab + 1) + \")\", tabHeader).addClass(\"tabSelected\");\r\n\r\n        // The new width will be added to the tabSelected in order to complete the 100% on tabs\r\n        var widthTabSelected = widthRow + (100 - (widthRow * tabCountReal));\r\n        activeTab.css(\"width\", widthTabSelected + \"%\");\r\n\r\n        function updateTabSize() {\r\n            if (params.tabNumber < tabCountPopup) {\r\n                // Select the current tab\r\n                $(\".bz-wp-tabs-arrow-container\", self).first().addClass(\"show-pluss\");\r\n                tabHeader.addClass(\"show-pluss\");\r\n                activeTab.trigger(\"click\", { origin: \"popUp\" });\r\n            } else {\r\n                $(\".bz-wp-tabs-arrow-container\", self).removeClass(\"show-pluss\");\r\n                tabHeader.removeClass(\"show-pluss\");\r\n                tabHeader.find(\"> .bz-wp-tabs-ui:last\").addClass(\"bz-wp-no-border\");\r\n            }\r\n        }\r\n\r\n        // Reorder tabs\r\n        function reorderTabs(dataRef) {\r\n\r\n            var tempTabs = tabHeader.find(\".bz-wp-tabs-ui\");\r\n            var moveAtTheEnd = true;\r\n\r\n            tempTabs.each(function (i, item) {\r\n                if (dataRef !== item.getAttribute(\"data-reference-tab\") && moveAtTheEnd) {\r\n                    tabHeader.remove(\"[data-reference-tab='\" + dataRef + \"']\");\r\n                    tabHeader.append(item);\r\n                } else {\r\n                    moveAtTheEnd = false;\r\n                }\r\n            });\r\n        }\r\n\r\n        // Change tabs\r\n        function changeTab(e, params) {\r\n\r\n            params = params || {};\r\n            params.origin = params.origin || \"header\";\r\n\r\n            e.stopPropagation();\r\n            e.preventDefault();\r\n\r\n            if ($(this).hasClass(\"tabSelected\") && params.origin !== \"popUp\") {\r\n                return;\r\n            }\r\n\r\n            var dataRef = e.currentTarget.getAttribute(\"data-reference-tab\");\r\n            var tabChildren = $(dataRef, self);\r\n\r\n            activeTab = $(e.currentTarget);\r\n            // Changes the visibility of the contents of the tabs\r\n            self.find(\">div.childrenActive\").removeClass(\"childrenActive\");\r\n            tabChildren.addClass(\"childrenActive\");\r\n\r\n            // Add the normal width\r\n            tabHeader.find(\">div.tabSelected\").removeClass(\"tabSelected\").css(\"width\", widthRow + \"%\");\r\n\r\n            if (popUp.css(\"display\") === \"block\") {\r\n                popUp.toggle();\r\n            }\r\n\r\n            if (params.origin && params.origin === \"popUp\") {\r\n                activeTab = $(\"[data-reference-tab='\" + dataRef + \"']\", tabHeader);\r\n                reorderTabs(dataRef);\r\n            }\r\n\r\n            // Add the new width for tabSelected to complete the 100%\r\n            activeTab.addClass(\"tabSelected\").css(\"width\", widthTabSelected + \"%\");\r\n            activate(e, params);\r\n        }\r\n\r\n        if (typeof (params.domIncluded) !== \"undefined\") {\r\n            // Until the control is added to the DOM can be known widths to add the icon popup         \r\n            $.when(params.domIncluded).done(function () {\r\n                updateTabSize();\r\n            });\r\n        } else {\r\n            updateTabSize();\r\n        }\r\n\r\n        // Attach events\r\n        self.find(\".bz-wp-tabs-arrow-container\").first().bind(\"click\", function (event) {\r\n\r\n            // Determine if an item is visible or not\r\n            var headerWidth = (tabHeader.innerWidth() - 29);\r\n            var totalWidth = 0;\r\n\r\n            // Remove the visible elements\r\n            $(\".bz-container-items-tabs\", popUp).removeClass(\"show\");\r\n\r\n            tabHeader.find(\".bz-wp-tabs-ui\").each(function (i, item) {\r\n\r\n                totalWidth += $(\":first-child\", item).outerWidth();\r\n\r\n                // If \"true\" then it is a tab to display the popup\r\n                if (totalWidth > headerWidth) {\r\n\r\n                    popUp.children().each(function (j, pop) {\r\n                        if (pop.textContent === item.textContent) {\r\n                            $(pop).addClass(\"show\");\r\n                            $(\".cell.bz-container-items-tabs\").css(\"border-bottom\", \"\");\r\n                            $(\".cell.bz-container-items-tabs.show\").last().css(\"border-bottom\", \"none\");\r\n\r\n                            return;\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n\r\n            event.stopPropagation();\r\n            event.preventDefault();\r\n            popUp.toggle();\r\n        });\r\n\r\n        $(\">div.cell\", popUp).bind(\"click\", function (e) {\r\n            changeTab(e, { origin: \"popUp\" });\r\n        });\r\n\r\n        $(\".bz-wp-tabs-ui\", tabHeader).bind(\"click\", changeTab);\r\n\r\n        tabHeader.bind(\"resizeHeader\", function () {\r\n            updateTabSize();\r\n        });\r\n    };\r\n})(jQuery);","/**\r\n *\r\n * Created by RicardoPD on 8/11/2016.\r\n */\r\n\r\n(function ($) {\r\n    $.fn.helpText = function (options) {        \r\n        options = options || {};\r\n        options.helpText = options.helpText || \"\";\r\n        options.dir = typeof options.dir !== \"undefined\" && options.dir !== \"\" ? options.dir : \"inherit\";\r\n\r\n        var tmpl =\r\n            '<div class=\"bz-container-rn-helptext-overlay\">' +\r\n            '   <div class=\"bz-rn-helptext\" dir=\"#: data.dir #\">' +\r\n            '       <div class=\"bz-cancel-container\">' +\r\n            '           <a href=\"\\\\#\" style=\"opacity: 0; width: 0; height: 0\"></a>' +\r\n            '           <span class=\"bz-mo-icon bz-cancel\"></span>' +\r\n            '       </div>' +\r\n            '       <span class=\"bz-rn-helptext-text\">#= data.helpText #</span>' +\r\n            '   </div>' +\r\n            '</div>';\r\n\r\n        var template = kendo.template(tmpl, { useWithBlock: false });\r\n        var $html = $(template(options));\r\n\r\n        $(this).bind(\"click\", function () {\r\n            $(\"body\").append($html);\r\n            $(\"body\").css(\"position\", \"fixed\");\r\n            $(\"a\", $html).get(0).focus();\r\n            $(\".bz-cancel\", $html).bind(\"click\", function () {\r\n                $html.remove();\r\n                $(\"body\").css(\"position\", \"\");\r\n            });\r\n            $(\"a\", $html).bind(\"blur\", function () {\r\n                $(\".bz-cancel\", $html).click();\r\n            });\r\n            $html.addClass(\"active\");\r\n        });\r\n    };\r\n})(jQuery);","/*\r\n*   Name: BizAgi Services Rendering End Points\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script defines all the end-points used to retrieve ajax stuff\r\n*   -   All urls must be relative to the base application\r\n*/\r\n\r\n// Create or define namespace\r\nbizagi.render = (typeof (bizagi.render) !== \"undefined\") ? bizagi.render : {};\r\nbizagi.render.services = (typeof (bizagi.render.services) !== \"undefined\") ? bizagi.render.services : {};\r\nbizagi.render.services.endPoints = [];\r\n\r\n// Creates a endpoint hash factory to resolve custom requirements\r\nbizagi.render.services.getEndPoints = function (params) {\r\n\r\n    var renderHandlerPathRest = \"Rest/Handlers/Render\";\r\n    var renderUploadHandlerPathRest = \"Rest/Handlers/Render/Upload\";\r\n    var renderFileHandlerPathRest = \"Rest/Handlers/RenderFile\";\r\n    var letterHandlerPathRest = \"Rest/Handlers/Letter\";\r\n    var multiActionHandlerPathRest = \"Rest/Handlers/MultiAction\";\r\n    var metadataHandlerPathRest = \"Rest/Handlers/Metadata\";\r\n    var metadataMultiactionHandlerPathRest = \"Rest/Handlers/MetadataMultiAction\";\r\n    // Default workportal end-points\r\n    if (params.context == \"workflow\") {\r\n        return {\r\n            \"form-get-data\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"form-submit-data\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"form-submit-data-upload\": params.proxyPrefix + renderUploadHandlerPathRest,\r\n            \"render-property-refresh\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-multiaction\": params.proxyPrefix + multiActionHandlerPathRest,\r\n            \"render-upload-cancel-image\": params.proxyPrefix + \"jquery/rendering/css/desktop/plugins/other/images/upload-cancel.png\",\r\n            \"render-upload-data-url\": params.proxyPrefix + renderFileHandlerPathRest,\r\n            \"render-upload-add-url\": params.proxyPrefix + renderUploadHandlerPathRest,\r\n            \"render-upload-delete-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-ecm-upload-url\": params.proxyPrefix + metadataHandlerPathRest,\r\n            \"render-multiaction-metadata\": params.proxyPrefix + metadataMultiactionHandlerPathRest,\r\n            \"render-grid-edit-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-save-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-add-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-rollback-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-commit-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-checkpoint-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-save-entity\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-stakeholder-associated\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-search-default-image\": params.proxyPrefix + \"jquery/rendering/css/desktop/images/bizagi_xpress.png\",\r\n            \"render-search-form-get-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-search-advanced-url\": params.proxyPrefix + \"Rest/Handlers/Query\",\r\n            \"render-letter-notEditable-url\": params.proxyPrefix + letterHandlerPathRest,\r\n            \"render-letter-content-url\": params.proxyPrefix + letterHandlerPathRest,\r\n            \"render-letter-save-url\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-letter-content-icons\": params.proxyPrefix + \"jquery/rendering/css/desktop/plugins/other/images/nicEditorIcons.gif\",\r\n            \"render-userfield-definition\": params.proxyPrefix + \"Rest/Userfields/{guidUserfield}/UserfieldDependency/{device}\",\r\n            \"render-document-generate\": params.proxyPrefix + \"Rest/DocumentTemplates/CaseTemplates\",\r\n            \"render-document-generateAllDocuments\": params.proxyPrefix + \"Rest/DocumentTemplates/TemplatesConcatFilesToPDF\",\r\n            \"render-processes-startform\": params.proxyPrefix + \"Rest/Processes/HasStartForm\",\r\n            \"render-processes-getstartform\": params.proxyPrefix + \"Rest/Processes/HasStartForm\",\r\n            \"render-entity-layout-image64\": params.proxyPrefix + \"Api/Entities/{entity}/Picture/{surrogateKey}/Base64\",\r\n            \"render-entity-layout-imageByteArray\": params.proxyPrefix + \"Api/Entities/{entity}/Picture/{surrogateKey}/Array?xpath={xpath}&width={width}&height={height}&idcase={idcase}&idworkitem={idworkitem}&contextxpath={contextxpath}&h_={hash}\" + \"&xsrf=\" + bizagi.getXSRFToken(),\r\n            \"render-entity-layout-upload-files\": params.proxyPrefix + \"Api/Entities/{entity}/Files/{surrogateKey}/Array?xpath={xpath}\",\r\n            \"case-handler-getCaseSummary\": params.proxyPrefix + \"Rest/Cases/{idCase}/SummaryGuid\",\r\n            \"case-handler-getCaseSummaryByGuid\": params.proxyPrefix + \"Rest/Cases/{guid}/SummaryByGuid\",\r\n            \"case-handler-getCaseAssignees\": params.proxyPrefix + \"Rest/Cases/{idCase}/AssigneesGuid\",\r\n            \"case-handler-getWorkItems\": params.proxyPrefix + \"Rest/Cases/{idCase}/WorkItems\",\r\n            \"case-handler-getWorkItemsByGuid\": params.proxyPrefix + \"Rest/Cases/{guid}/WorkItemsByGuid\",\r\n            \"admin-getUsersList\": params.proxyPrefix + \"Rest/Users/SearchUsers\",\r\n            \"admin-getUsersList-FromPreferences\": params.proxyPrefix + \"Rest/Users/SearchUsersFromPreferences\",\r\n            \"admin-getUsersList-ForStakeholders\": params.proxyPrefix + \"Rest/Users/SearchUsersForStakeholders\",\r\n            \"admin-getUsersForAssignation\": params.proxyPrefix + \"Rest/Users/UsersForAssignation\",\r\n            \"admin-users-config\": params.proxyPrefix + \"Api/Authentication/BizagiConfig\",\r\n            //users administration\r\n            \"admin-usersform\": params.proxyPrefix + \"Rest/Handlers/Render\",\r\n            \"admin-GenerateDataToSendByEmail\": params.proxyPrefix + \"Rest/Users/GenerateDataToSendByEmail\",\r\n            \"admin-sendUserEmail\": params.proxyPrefix + \"Rest/Users/SendUserEmail\"\r\n        };\r\n    }\r\n    // Sharepoint end-points (must be customized for each project)\r\n    if (params.context == \"sharepoint\" || params.context == \"portal\") {\r\n        if (typeof (params.sharepointProxyPrefix) === \"undefined\") alert(\"sharepointProxyPrefix param is requiered to build endpoints when context is 'sharepoint'\");\r\n        return {\r\n            \"form-get-data\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"form-submit-data\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"form-submit-data-upload\": params.sharepointProxyPrefix + renderUploadHandlerPathRest,\r\n            \"render-property-refresh\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-multiaction\": params.sharepointProxyPrefix + multiActionHandlerPathRest,\r\n            \"render-upload-cancel-image\": \"jquery/rendering/css/desktop/plugins/other/images/upload-cancel.png\",\r\n            \"render-upload-data-url\": params.sharepointProxyPrefix + renderFileHandlerPathRest,\r\n            \"render-upload-add-url\": params.sharepointProxyPrefix + renderUploadHandlerPathRest,\r\n            \"render-upload-delete-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-ecm-upload-url\": params.sharepointProxyPrefix + metadataHandlerPathRest,\r\n            \"render-grid-edit-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-save-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-add-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-rollback-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-commit-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-grid-checkpoint-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-save-entity\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-stakeholder-associated\": params.proxyPrefix + renderHandlerPathRest,\r\n            \"render-search-default-image\": \"jquery/css/bizagi/desktop/images/bizagi_xpress.png\",\r\n            \"render-search-form-get-data\": params.sharepointProxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-search-advanced-url\": params.sharepointProxyPrefix + \"Rest/Handlers/Query\",\r\n            \"render-letter-notEditable-url\": params.sharepointProxyPrefix + letterHandlerPathRest,\r\n            \"render-letter-content-url\": params.sharepointProxyPrefix + letterHandlerPathRest,\r\n            \"render-letter-save-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\r\n            \"render-letter-content-icons\": \"jquery/css/plugins/other/images/nicEditorIcons.gif\",\r\n            \"render-userfield-definition\": params.sharepointProxyPrefix + \"Rest/Userfields/{guidUserfield}/UserfieldDependency/{device}\",\r\n            \"render-document-generate\": params.sharepointProxyPrefix + \"Rest/DocumentTemplates/CaseTemplates\",\r\n            \"render-document-generateAllDocuments\": params.sharepointProxyPrefix + \"Rest/DocumentTemplates/TemplatesConcatFilesToPDF\",\r\n            \"render-processes-startform\": params.proxyPrefix + \"Rest/Processes/HasStartForm\",\r\n            \"render-processes-getstartform\": params.proxyPrefix + \"Rest/Processes/HasStartForm\",\r\n            \"render-entity-layout-image64\": params.proxyPrefix + \"Api/Entities/{entity}/Picture/{surrogateKey}/Base64\",\r\n            \"render-entity-layout-imageByteArray\": params.proxyPrefix + \"Api/Entities/{entity}/Picture/{surrogateKey}/Array?xpath={xpath}&width={width}&height={height}&idcase={idcase}&idworkitem={idworkitem}&contextxpath={contextxpath}&h_={hash}\" + \"&xsrf=\" + bizagi.getXSRFToken(),\r\n            \"case-handler-getCaseSummary\": params.sharepointProxyPrefix + \"Rest/Cases/{idCase}/Summary\",\r\n            \"case-handler-getCaseSummaryByGuid\": params.sharepointProxyPrefix + \"Rest/Cases/{guid}/SummaryByGuid\",\r\n            \"case-handler-getWorkItems\": params.sharepointProxyPrefix + \"Rest/Cases/{idCase}/WorkItems\",\r\n            \"case-handler-getWorkItemsByGuid\": params.proxyPrefix + \"Rest/Cases/{guid}/WorkItemsByGuid\"\r\n        };\r\n    }\r\n\r\n    if (params.context == \"entitymanagement\") {\r\n        return {\r\n            \"form-get-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"form-submit-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"form-submit-data-upload\": params.proxyPrefix + renderUploadHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-property-refresh\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-upload-cancel-image\": \"jquery/rendering/css/desktop/plugins/other/images/upload-cancel.png\",\r\n            \"render-upload-data-url\": params.proxyPrefix + renderFileHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-upload-add-url\": params.proxyPrefix + renderUploadHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-upload-delete-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-grid-edit-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-grid-save-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-grid-add-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-grid-rollback-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-grid-commit-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-grid-checkpoint-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-search-default-image\": \"jquery/rendering/css/desktop/images/bizagi_xpress.png\",\r\n            \"render-search-form-get-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-search-advanced-url\": params.proxyPrefix + \"Rest/Handlers/Query\" + \"?h_contexttype=entity\",\r\n            \"render-letter-notEditable-url\": params.proxyPrefix + letterHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-letter-content-url\": params.proxyPrefix + letterHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-letter-save-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\r\n            \"render-letter-content-icons\": \"jquery/rendering/css/desktop/plugins/other/images/nicEditorIcons.gif\"\r\n        };\r\n    }\r\n\r\n    if (params.context == \"search\") {\r\n        return {\r\n            \"form-get-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"form-submit-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"form-submit-data-upload\": params.proxyPrefix + renderUploadHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-property-refresh\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-upload-cancel-image\": \"jquery/rendering/css/desktop/plugins/other/images/upload-cancel.png\",\r\n            \"render-upload-data-url\": params.proxyPrefix + renderFileHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-upload-add-url\": params.proxyPrefix + renderUploadHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-upload-delete-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-grid-edit-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-grid-save-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-grid-add-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-grid-rollback-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-grid-commit-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-grid-checkpoint-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-search-default-image\": \"jquery/rendering/css/desktop/images/bizagi_xpress.png\",\r\n            \"render-search-form-get-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-search-advanced-url\": params.proxyPrefix + \"Rest/Handlers/Query\" + \"?h_contexttype=metadata\",\r\n            \"render-letter-notEditable-url\": params.proxyPrefix + letterHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-letter-content-url\": params.proxyPrefix + letterHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-letter-save-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\r\n            \"render-letter-content-icons\": \"jquery/rendering/css/desktop/plugins/other/images/nicEditorIcons.gif\"\r\n        };\r\n    }\r\n\r\n    return {};\r\n};\r\n","/*\r\n*   Name: BizAgi Rendering Service Context Factory\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define the endpoints to be used based on the given context\r\n*/\r\n\r\n$.Class.extend(\"bizagi.render.services.context\", {}, {\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        this.context = params.context;\r\n        this.endPoints = bizagi.render.services.getEndPoints(params);\r\n        this.proxyPrefix = !bizagi.util.isEmpty(params.proxyPrefix) ? params.proxyPrefix : \"\";\r\n    },\r\n\r\n    /*\r\n    *   Returns the given url for a specified service\r\n    */\r\n    getUrl: function (service) {\r\n        if (this.endPoints[service] == null) {\r\n            alert(\"No endpoint defined for: \" + service);\r\n        }\r\n        return this.endPoints[service];\r\n    },\r\n\r\n    setProxyPrefix: function(params){\r\n        this.proxyPrefix = !bizagi.util.isEmpty(params.proxyPrefix) ? params.proxyPrefix : \"\";\r\n        this.endPoints = bizagi.render.services.getEndPoints(params);\r\n    }\r\n});","/*\r\n *   Name: BizAgi Rendering Services\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This class will provide a facade to access to rendering REST services\r\n */\r\n\r\n$.Class.extend(\"bizagi.render.services.service\",\r\n    {\r\n        // Statics\r\n        BA_ACTION_PARAMETER_PREFIX: \"p_\",\r\n        BA_CONTEXT_PARAMETER_PREFIX: \"h_\",\r\n        BA_PAGE_CACHE: \"pageCacheId\"\r\n    },\r\n    {\r\n        /*\r\n         *   Constructor\r\n         */\r\n        init: function(params) {\r\n            params = params || {};\r\n            params.context = params.context || \"workflow\";\r\n            params.proxyPrefix = !bizagi.util.isEmpty(params.proxyPrefix) ? params.proxyPrefix : \"\";\r\n            this.serviceLocator = new bizagi.render.services.context(params);\r\n            this.multiactionService = new bizagi.render.services.multiactionservice(this);\r\n            this.guid = Math.guid();\r\n\r\n            if (bizagi.override.enableECMMetadataMultiaction) {\r\n                this.multiactionMetadataService = new bizagi.render.services.metadatamultiactionservice(this);\r\n            }\r\n\r\n            // Userfield definitions mini-cache\r\n            this.userfieldRequests = {};\r\n\r\n            this.deviceType = params.deviceType || (bizagi.util.isSmartphoneDevice() ? bizagi.deviceEnum.smartphone: (bizagi.util.isTabletDevice() ? bizagi.deviceEnum.tablet: bizagi.deviceEnum.desktop));\r\n            this.deviceCode = bizagi.util.getDeviceCode();\r\n        },\r\n        /*\r\n         *   Return the multiaction-service\r\n         */\r\n        multiaction: function() {\r\n            return this.multiactionService;\r\n        },\r\n\r\n        metadataECMMultiaction: function () {\r\n            return bizagi.override.enableECMMetadataMultiaction ? this.multiactionMetadataService: this;\r\n        },\r\n        /*\r\n         *   SINGLE SERVICES METHODS\r\n         */\r\n\r\n        /*\r\n         *   Gets form data\r\n         *   Returns a promise of the data being retrieved\r\n         */\r\n        getFormData: function(params) {\r\n            var self = this;\r\n\r\n            // Check if the params contains mocked data\r\n            if (params && params.data) {\r\n                return params.data;\r\n            }\r\n\r\n            // Define data\r\n            params = params || {};\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = params.action || \"LOADFORM\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicetype\"] = self.deviceType;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicecode\"] = self.deviceCode;\r\n\r\n            if (params.idProcess)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idProcess\"] = params.idProcess;\r\n            if (params.idForm)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idForm\"] = params.idForm;\r\n            if (params.idEntity)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idEntity\"] = params.idEntity;\r\n            if (params.surrogateKey)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"surrogateKey\"] = params.surrogateKey;\r\n            if (params.idRender)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            if (params.xpathContext)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            if (params.requestedForm)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"requestedForm\"] = params.requestedForm;\r\n            if (params.recordXPath)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"recordXPath\"] = params.recordXPath;\r\n            if (params.summaryForm)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"summaryForm\"] = params.summaryForm;\r\n            if (params.idCase)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idCase\"] = params.idCase;\r\n            if (params.idWorkitem)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idWorkitem\"] = params.idWorkitem;\r\n            if (params.idTask)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idTask\"] = params.idTask;\r\n            if (params.idPageCache)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            if (params.contextType)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contextType;\r\n            if (params.guidEntity)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guidEntity;\r\n            if (!bizagi.util.isEmpty(params.isRefresh))\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isRefresh\"] = params.isRefresh;\r\n            if (params.isActionStartForm)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isActionStartForm\"] = params.isActionStartForm;\r\n            if (params.additionalXpaths)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"additionalXpaths\"] = params.additionalXpaths;\r\n            if (params.idStartScope)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idStartScope\"] = params.idStartScope;\r\n            if (typeof params.readOnlyForm !== \"undefined\")\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"readonlyform\"] = params.readOnlyForm;\r\n            if (typeof params.printversion !== \"undefined\")\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"printForm\"] = params.printversion;\r\n            if (typeof params.recordXpath !== \"undefined\")\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"recordlauncherxpath\"] = params.recordXpath;\r\n            if (params.guid)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guid\"] = params.guid;\r\n            if (params.downloadOfflineForm)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"downloadofflineform\"] = 1;\r\n\r\n            if (params.editable === false) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"DisplayFormAsReadOnly\"] = true;\r\n            }\r\n\r\n            // Support parameter from ui\r\n            // Parameters that affects all the same attributes of render\r\n            if (params.printversion) {\r\n                //Print limit grid rows\r\n                var BA_ALL_PARAMETER_PREFIX = \"all_\";\r\n\r\n                if (params[self.Class.BA_ACTION_PARAMETER_PREFIX + BA_ALL_PARAMETER_PREFIX + \"rows\"]) {\r\n                    data[self.Class.BA_ACTION_PARAMETER_PREFIX + BA_ALL_PARAMETER_PREFIX + \"rows\"] = params[self.Class.BA_ACTION_PARAMETER_PREFIX + BA_ALL_PARAMETER_PREFIX + \"rows\"];\r\n                }\r\n            }\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n\r\n            // Call ajax and returns promise\r\n            bizagi.chrono.initAndStart(\"data\");\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"form-get-data\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: params.action || \"LOAD\"\r\n            })\r\n                .pipe(function(response) {\r\n                    bizagi.chrono.stopAndLog(\"data\");\r\n\r\n                    // Transform data for read only version\r\n                    if (params.printversion) {\r\n                        try {\r\n                            response.form.properties.editable = \"False\";\r\n\r\n                            var transformGridDataToReadOnly = function(_data) {\r\n                                if (_data == null) {\r\n                                    return _data;\r\n                                }\r\n                                if (_data.hasOwnProperty('type') && _data.type == 'grid') {\r\n                                    _data.id = data.id + \"-print\";\r\n                                    _data.allowAdd = \"False\";\r\n                                    _data.allowDelete = \"False\";\r\n                                    _data.allowEdit = \"False\";\r\n                                    _data.allowGrouping = \"False\";\r\n                                    _data.allowMore = \"False\";\r\n                                    _data.allowSearch = \"False\";\r\n                                } else {\r\n                                    $.each(data, function(key, value) {\r\n                                        if (typeof (value) == 'object') {\r\n                                            _data[key] = transformGridDataToReadOnly(_data[key]);\r\n                                        }\r\n                                    });\r\n                                }\r\n                                return _data;\r\n                            };\r\n                            response = transformGridDataToReadOnly(response);\r\n                        } catch (e) {\r\n                        }\r\n                    }\r\n\r\n                    return response;\r\n                });\r\n        },\r\n        /*\r\n         *   Gets a search form data\r\n         *   Returns a promise of the data being retrieved\r\n         */\r\n        getSearchFormData: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            params = params || {};\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"SEARCHFORM\";\r\n            if (params.xpath)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            if (params.idRender)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            if (params.xpathContext)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            if (params.idSearchForm)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"searchForm\"] = params.idSearchForm;\r\n            if (params.idPageCache)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-search-form-get-data\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"SEARCHFORM\"\r\n            });\r\n        },\r\n\r\n        processDataValues: function(data) {\r\n            var o;\r\n            data = $.extend(true, {}, data);\r\n            for (o in data) {\r\n                if (data.hasOwnProperty(o) && $.type(data[o]) == \"object\") {\r\n                    // for search\r\n                    if (data[o].hasOwnProperty(\"id\")) {\r\n                        data[o] = data[o].id;\r\n                    }\r\n                }\r\n            }\r\n            return data;\r\n        },\r\n        /*\r\n         *   Sends a form action to the server\r\n         */\r\n        submitData: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            data = self.resolveData(params.data || {}, params.xpathContext);\r\n            data = self.processDataValues(data);\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = params.action;\r\n\r\n            // Fill optional parameters\r\n            params = params || {};\r\n            if (params.xpath)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            if (params.idRender)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            if (params.xpathContext)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            if (params.idPageCache)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            if (params.guidEntity)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guidEntity;\r\n            if (params.contexttype)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            if (params.transitions)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"transitions\"] = params.transitions;\r\n            if (params.surrogatekey)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"surrogateKey\"] = params.surrogatekey;\r\n            if (params.forcePlanCompletion)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"forcePlanCompletion\"] = params.forcePlanCompletion;\r\n\r\n            /* if (params.isActionStartForm)\r\n             data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isActionStartForm\"] = params.isActionStartForm;\r\n             */\r\n            var actionType = params.action.toString().toUpperCase();\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Data sent\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"form-submit-data\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: actionType\r\n            });\r\n        },\r\n        /*\r\n         * Get data processing xpathcontext\r\n         */\r\n        resolveData: function(data, xpathContext) {\r\n            var name, newName, value;\r\n            if (!$.isEmptyObject(data) && xpathContext) {\r\n                if (xpathContext.search(/\\[id=\\d+\\]/) !== -1) {\r\n                    for (name in data) {\r\n                        if (name.search(/\\[id=\\d+\\]/) !== -1 && xpathContext == name.substr(0, name.search(/\\]/) + 1)) {\r\n                            newName = name.substr(name.search(/\\]/) + 2);\r\n                            value = data[name];\r\n                            data[newName] = value;\r\n                            delete data[name];\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            return data;\r\n        },\r\n        /*\r\n         *   Fetch a property from the server\r\n         *   Params:\r\n         *   -   xpath\r\n         *   -   idRender\r\n         *   -   xpathContext\r\n         *   -   property\r\n         */\r\n        getPropertyData: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = params.property;\r\n\r\n            if (params.sessionId)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\r\n            if (params.contexttype)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            if (params.guidentity)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guidentity;\r\n            if (params.surrogatekey)\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"surrogateKey\"] = params.surrogatekey;\r\n            if (params.pxpath)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"xpath\"] = params.pxpath;\r\n            if (params.prows)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"rows\"] = params.prows;\r\n            if (params.ppage)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"page\"] = params.ppage;\r\n            if (params.pfilter != undefined && params.pfilter != null)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"filter\"] = params.pfilter;\r\n            /*else\r\n             data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"filter\"] = \"\";*/\r\n            if (params.psort != undefined && params.psort != null)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sort\"] = params.psort;\r\n            if (params.porder)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"order\"] = params.porder;\r\n            if (params.pcaseId)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"caseId\"] = params.pcaseId;\r\n            if (params.pguidEntity)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"guidEntity\"] = params.pguidEntity;\r\n            if (params.psurrogatedKey) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"surrogatedKey\"] = params.psurrogatedKey;\r\n            }\r\n            if (params.pactionXpath) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"actionXpath\"] = params.pactionXpath;\r\n            }\r\n            if (params.ptemplateGuid) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"templateGuid\"] = params.ptemplateGuid;\r\n            }\r\n            if (params.pparameters) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"parameters\"] = params.pparameters;\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Property refresh for '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            // TODO: change REST library in order to support extra HTTP parameters\r\n            // Please be careful with dataType parameter\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-property-refresh\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: params.dataType || \"json\",\r\n                serviceType: \"PROCESSPROPERTYVALUE\",\r\n                beforeSend: function(xhr, status) {\r\n                    bizagi.multiactionConnection = bizagi.multiactionConnection || [];\r\n                    bizagi.multiactionConnection.push(xhr);\r\n                }\r\n            });\r\n\r\n        },\r\n        /*\r\n         *   Refresh the data property from the server\r\n         *   Params:\r\n         *   -   xpath\r\n         *   -   idRender\r\n         *   -   xpathContext\r\n         */\r\n        getData: function(params) {\r\n            return this.getPropertyData($.extend(params, {\r\n                property: \"data\"\r\n            }));\r\n        },\r\n        /*\r\n         *   Refresh the data property from the server\r\n         *   This version is to fetch search data\r\n         *   Params:\r\n         *   -   xpath\r\n         *   -   idRender\r\n         *   -   xpathContext\r\n         *   -   term\r\n         */\r\n        getSearchData: function(params) {\r\n            var self = this;\r\n            params.extra = params.extra || {};\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"term\"] = params.term;\r\n\r\n            return this.getPropertyData($.extend(params, {\r\n                property: \"data\"\r\n            }));\r\n        },\r\n\r\n        /*\r\n         * Refresh tha data property from the server\r\n         * Params:\r\n         *   -   collapsestate\r\n         */\r\n        getCollapseData: function(params) {\r\n            var self = this;\r\n            params.extra = params.extra || {};\r\n\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"collapseState\"] = params.collapseState;\r\n\r\n            return this.getPropertyData($.extend(params, {\r\n                property: \"collapseState\"\r\n            }));\r\n        },\r\n\r\n        /*\r\n         *   Refresh the data property from the server\r\n         *   This version is to fetch grid data\r\n         *   Params:\r\n         *   -   xpath\r\n         *   -   idRender\r\n         *   -   xpathContext\r\n         *   -   sort\r\n         *   -   page\r\n         *   -   rows\r\n         */\r\n        getGridData: function(params) {\r\n            var self = this;\r\n            params.extra = params.extra || {};\r\n\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sort\"] = params.sort;\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"order\"] = params.order;\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"page\"] = params.page;\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"rows\"] = params.rows;\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"searchFilter\"] = params.searchFilter;\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"value\"] = params.value;\r\n\r\n            return this.getPropertyData($.extend(params, {\r\n                property: \"data\"\r\n            }));\r\n        },\r\n\r\n        getGridDataExclusivesSelected: function(params) {\r\n            var self = this;\r\n            params.extra = params.extra || {};\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"rows\"] = params.rows;\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"value\"] = params.value;\r\n            params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"xpathfilter\"] = params.xpathfilter;\r\n            return this.getPropertyData($.extend(params, {\r\n                property: \"exclusivesSelected\"\r\n            }));\r\n        },\r\n\r\n        /*\r\n         *   Returns the upload plugin cancel image\r\n         */\r\n        getUploadCancelImage: function() {\r\n            return bizagi.services.ajax.pathToBase + this.serviceLocator.getUrl(\"render-upload-cancel-image\");\r\n        },\r\n        /*\r\n         *   Returns the upload file url for each file\r\n         */\r\n        getUploadFileUrl: function(params) {\r\n            var self = this;\r\n            var url = this.serviceLocator.getUrl(\"render-upload-data-url\");\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = \"fileContent\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"fileId\"] = params.fileId;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\r\n            (params.contexttype) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data) + \"&xsrf=\" + bizagi.getXSRFToken();\r\n        },\r\n\r\n        getUploadFileEntityUrl: function(params) {\r\n            var self = this;\r\n            var url = this.serviceLocator.getUrl(\"render-upload-data-url\");\r\n            var data = {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUETEMPLATE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = \"fileContent\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"fileId\"] = params.fileId;\r\n            if (params.isContextContainerWidgetRender) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"xpathactions\"] = params.xpathActions;\r\n            } else {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"surrogateKey\"] = params.surrogatekey;\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guidentity;\r\n            }\r\n\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data) + \"&xsrf=\" + bizagi.getXSRFToken();\r\n        },\r\n\r\n        /*\r\n         *   Returns the upload add url\r\n         */\r\n        getUploadAddUrl: function() {\r\n            var self = this;\r\n            var url = this.serviceLocator.getUrl(\"render-upload-add-url\");\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"ADDFILE\";\r\n\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data);\r\n        },\r\n        /*\r\n         *   Returns the upload add url\r\n         */\r\n        getUploadAddFileUrl: function(isUserPreferences) {\r\n            var self = this;\r\n            var url = this.serviceLocator.getUrl(\"form-submit-data-upload\");\r\n            var data = {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = (isUserPreferences === true) ? \"SAVEUSERIMAGE\" : \"savefile\";\r\n\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data);\r\n        },\r\n\r\n        deleteImage: function(params) {\r\n            var self = this;\r\n\r\n            var data = params.extra || {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"DELETEUSERIMAGE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            (params.contexttype) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Removing image '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-upload-delete-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n\r\n        /*\r\n         *   Returns the upload add url\r\n         */\r\n        deleteUploadFile: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"REMOVERELATION\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            (params.contexttype) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Removing file in upload '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-upload-delete-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n\r\n            });\r\n        },\r\n        /*\r\n         * Return file meta data\r\n         */\r\n        getECMMetadata: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"getECMMetadata\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n            data.xPath = params.xPath;\r\n            data.idAttrib = params.idAttrib;\r\n            if (params.sessionId) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\r\n            }\r\n            // Log submit data\r\n            bizagi.debug(\"Get file metadata '\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                interceptor: {\r\n                    intercept: true,\r\n                    source: \"rendering_\" + self.guid,\r\n                }\r\n            });\r\n\r\n        },\r\n        /*\r\n         * Checkout a file\r\n         **/\r\n        checkOutFile: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"checkOutFile\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data.xPath = params.xPath;\r\n            data.idAttrib = params.idAttrib;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"file checkout '\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        /*\r\n         * cancelCheckOut\r\n         **/\r\n        cancelCheckOut: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"cancelCheckOut\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data.xPath = params.xPath;\r\n            data.idAttrib = params.idAttrib;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"file checkout '\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        /*\r\n         * Checkout a file\r\n         **/\r\n        deleteECMFile: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"delete\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data.xPath = params.xPath;\r\n            data.idAttrib = params.idAttrib;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"delete file'\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        /*\r\n         *  Update ECM file content\r\n         **/\r\n        updateECMFileContent: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"updateECMFileContent\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data.xPath = params.xPath;\r\n            data.idAttrib = params.idAttrib;\r\n\r\n            data.metaValues = params.metaValues;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Update file content '\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        /*\r\n         *  Update file content\r\n         **/\r\n        updateECMMetadata: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"updateECMMetadata\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data.xPath = params.xPath;\r\n            data.idAttrib = params.idAttrib;\r\n\r\n            data.metaValues = params.metaValues;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Update file meta data '\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        getFileProperties: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"getFileProperties\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data.xPath = params.xPath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Get file properties '\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                interceptor: {\r\n                    intercept: true,\r\n                    source: \"rendering_\" + self.guid,\r\n                }\r\n            });\r\n        },\r\n        uploadECMFile: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data.action = \"uploadECMFile\";\r\n            data.fileUpload = params.fileUpload; // Content of file\r\n            data.xPath = params.xPath;\r\n\r\n            data.idAttrib = params.idAttrib;\r\n            data.fileName = params.fileName;\r\n            data.metaValues = params.metaValues;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Upload ECM file '\" + params.xPath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        getECMFileUrl: function(params) {\r\n            var self = this;\r\n            var url = params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\") + \"File\";\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data.action = \"viewECMFile\";\r\n            data.idFileUpload = params.idFileUpload;\r\n            data.xPath = params.xPath;\r\n            data.idAttrib = params.idAttrib;\r\n\r\n            data.fileName = params.fileName;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data.xpathContext = params.xpathContext;\r\n            if (params.sessionId) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\r\n            }\r\n            if (params.p_sessionId) {\r\n                data.p_sessionId = params.p_sessionId;\r\n            }\r\n\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"View uploaded file '\" + params.xPath + \"'\", data);\r\n\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data) + \"&xsrf=\" + bizagi.getXSRFToken();\r\n        },\r\n        /*\r\n         *\r\n         */\r\n        isFileOnECM: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = {};\r\n            data[\"action\"] = \"isFileOnECM\";\r\n            data[\"idUpload\"] = params.idUpload;\r\n\r\n            // Call ajax and returns promise\r\n            return $.read(self.serviceLocator.getUrl(\"render-ecm-upload-url\"), data);\r\n        },\r\n        /*\r\n         *   Start a grid record edition\r\n         */\r\n        editGridRecord: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"EDITRELATION\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending edit request for relation '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-edit-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"EDITRELATION\"\r\n            });\r\n        },\r\n        /*\r\n         *   Sends a grid request to add a new row\r\n         *   The server returns the new row in json\r\n         */\r\n        addGridRecord: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"ADDRELATION\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending add request for grid '\" + params.xpath + \"'\", data);\r\n\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-add-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"ADDRELATION\"\r\n            });\r\n        },\r\n        /*\r\n         *   Sends a grid request to add a new row, and sending the data at the same time\r\n         *   The server returns the new row in json\r\n         */\r\n        addGridRecordData: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"ADDRELATIONWITHDATA\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Build data to submit\r\n            var submitData = params.submitData || {};\r\n            for (key in submitData) {\r\n                data[key] = submitData[key];\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending add request for grid '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-add-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"ADDRELATIONWITHDATA\"\r\n            });\r\n        },\r\n        /*\r\n         *   Submits the grid record data to the server\r\n         */\r\n        saveGridRecord: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"SAVERELATION\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"disableServerGridValidations\"] = params.disableServerGridValidations || false;\r\n\r\n            // Send the submitted data page cache because it cointains the grid's form page cache\r\n            if (params.submitData.idPageCache) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.submitData.idPageCache;\r\n                delete params.submitData.idPageCache;\r\n            }\r\n\r\n            var submitData = params.submitData || {};\r\n\r\n            // Build data to submit\r\n            submitData = self.processDataValues(submitData);\r\n\r\n            for (key in submitData) {\r\n                data[key] = submitData[key];\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending save request for grid '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-save-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"SAVERELATION\"\r\n            });\r\n        },\r\n        /*\r\n         *   Deletes a grid record in the server\r\n         */\r\n        deleteGridRecord: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"REMOVERELATION\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending delete request for grid '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-save-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"REMOVERELATION\"\r\n            });\r\n        },\r\n\r\n        /*\r\n         * Get association flipped status\r\n         */\r\n        getFlipAssociation: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.id;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = \"flipped\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"flipstate\"] = params.flipstate;\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Log request data\r\n            bizagi.debug(\"Sending request for flip association control '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-property-refresh\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"text\"\r\n            }).pipe(function(response) {\r\n                try {\r\n                    // Try to attempt to parse JSON\r\n                    return bizagi.services.ajax.parseJSON(response);\r\n                } catch (e) {\r\n                    // If JSON is not valid we need to return the original text response\r\n                    return response;\r\n                }\r\n            });\r\n        },\r\n        /*\r\n         *   Cancels an add or edit request for a grid\r\n         */\r\n        rollbackGridAction: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"ROLLBACK\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending rollback request for grid '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-rollback-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"ROLLBACK\"\r\n            });\r\n        },\r\n        /*\r\n         *   Returns the search render default image\r\n         */\r\n        getSearchDefaultImage: function() {\r\n            return bizagi.services.ajax.pathToBase + this.serviceLocator.getUrl(\"render-search-default-image\");\r\n        },\r\n\r\n        processDataCriteria: function(criteria) {\r\n            var o;\r\n            criteria = $.extend(true, [], criteria);\r\n            for (o in criteria) {\r\n                if (criteria.hasOwnProperty(o) && criteria[o].hasOwnProperty(\"value\") && $.type(criteria[o].value) == \"object\") {\r\n                    // for search\r\n                    if (criteria[o].value.hasOwnProperty(\"id\") && criteria[o].value.hasOwnProperty(\"label\")) {\r\n                        criteria[o].value = criteria[o].value.id;\r\n                    }\r\n                }\r\n            }\r\n            return criteria;\r\n        },\r\n\r\n        /*\r\n         *   Perform entity search in the server\r\n         */\r\n        submitSearch: function(params) {\r\n            var self = this, criteria;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            var sort = params.sort && params.sort !== \"\" ? params.sort : \"\";\r\n\r\n            if (params.order && params.order !== \"\" && sort !== \"\")\r\n                sort += \" \" + params.order;\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"SEARCHENTITYFORRENDER\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"searchForm\"] = params.idSearchForm;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sort\"] = sort;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"page\"] = params.page;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"pageSize\"] = params.rows;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"searchFilter\"] = params.searchFilter;\r\n\r\n            criteria = self.processDataCriteria(params.criteria);\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"searchCriteria\"] = JSON.encode(criteria);\r\n\r\n            // Optional search params\r\n            if (params.allowFullSearch)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"allowFullSearch\"] = params.allowFullSearch;\r\n            if (params.maxRecords)\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"maxRowsAllowed\"] = params.maxRecords;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Performing advanced search\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-search-advanced-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"SEARCHENTITYFORRENDER\"\r\n            });\r\n        },\r\n\r\n        /*\r\n         *   Submits the stakeholder associated\r\n         */\r\n        associateStakeholder: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"SAVE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"surrogateKey\"] = params.surrogateKey;\r\n            data[\"associatedUser\"] = params.associatedUser;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guidentity;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Property refresh for '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            // TODO: change REST library in order to support extra HTTP parameters\r\n            // Please be careful with dataType parameter\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-stakeholder-associated\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: params.dataType || \"json\"\r\n            });\r\n        },\r\n\r\n        /*\r\n         *   Refresh the stakeholder associated list\r\n         */\r\n        refreshAssociateStakeholder: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = params.property;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Property refresh for '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            // TODO: change REST library in order to support extra HTTP parameters\r\n            // Please be careful with dataType parameter\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-stakeholder-associated\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: params.dataType || \"json\",\r\n                serviceType: \"PROCESSPROPERTYVALUE\"\r\n            });\r\n        },\r\n\r\n        /*\r\n         *   Gets the link to the letter\r\n         */\r\n        getLetterNotEditableUrl: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"GETLETTER\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // Call ajax and returns promise\r\n            var url = params.url || self.serviceLocator.getUrl(\"render-letter-notEditable-url\");\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data);\r\n        },\r\n        /*\r\n         *   Gets the content for editable letters\r\n         */\r\n        getLetterContent: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"GETLETTER\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-letter-content-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"html\"\r\n            }).pipe(function(response) {\r\n                try {\r\n                    return bizagi.services.ajax.parseJSON(response);\r\n                } catch (e) {\r\n                    return response;\r\n                }\r\n            });\r\n        },\r\n        /*\r\n         *   Get the can generate letter flag\r\n         */\r\n        getCanGenerateLetter: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"CANGENERATELETTER\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: self.serviceLocator.getUrl(\"render-letter-content-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        /*\r\n         *   Saves the content for editable letters\r\n         */\r\n        saveLetterContent: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"UPDATELETTER\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // Define content\r\n            var content = params.content || \"\";\r\n\r\n            // Define url\r\n            var url = params.url || (self.serviceLocator.getUrl(\"render-letter-save-url\"));\r\n            var fullUrl = url + \"?\" + jQuery.param(data);\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Save request for letter sent to: \" + fullUrl, content);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: fullUrl,\r\n                data: content,\r\n                type: \"POST\",\r\n                dataType: \"html\"\r\n            });\r\n        },\r\n        /*\r\n         *   Returns the icons path for the letter plugin\r\n         */\r\n        getLetterEditorIconsPath: function() {\r\n            return bizagi.services.ajax.pathToBase + this.serviceLocator.getUrl(\"render-letter-content-icons\");\r\n        },\r\n        /*\r\n         *   Executes a button action in the server\r\n         */\r\n        executeButton: function(params) {\r\n            return this.getPropertyData($.extend(params, {\r\n                property: \"buttonRule\"\r\n            }));\r\n        },\r\n        /*\r\n         *   Executes a fileprint action in the server\r\n         */\r\n        getFilePrintUrl: function(params) {\r\n\r\n            var self = this;\r\n            var url = this.serviceLocator.getUrl(\"render-upload-data-url\");\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = \"data\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"disposition\"] = params.disposition;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            (params.contexttype) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\r\n\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data);\r\n\r\n        },\r\n        /*\r\n         *   Start a link form edition\r\n         */\r\n        editLinkForm: function(params) {\r\n            // Actually it does the same than edit grid records\r\n            return this.editGridRecord(params);\r\n        },\r\n        /*\r\n         *   Saves the content of the link form\r\n         */\r\n        saveLinkForm: function(params) {\r\n            // Actually it does the same than edit grid records\r\n            //return this.saveGridRecord(params);\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"SAVEFORMLINKRELATION\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Send the submitted data page cache because it cointains the grid's form page cache\r\n            if (params.submitData.idPageCache) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.submitData.idPageCache;\r\n                delete params.submitData.idPageCache;\r\n            }\r\n\r\n            var submitData = params.submitData || {};\r\n\r\n            // Build data to submit\r\n            submitData = self.processDataValues(submitData);\r\n\r\n            for (key in submitData) {\r\n                data[key] = submitData[key];\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending save request for grid '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-save-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"SAVEFORMLINKRELATION\"\r\n            });\r\n        },\r\n        /*\r\n         *   Rollbacks the link form edition\r\n         */\r\n        rollbackLinkForm: function(params) {\r\n            // Actually it does the same than rollback grid records\r\n            return this.rollbackGridAction(params);\r\n        },\r\n        /*   Commit the link form edition\r\n         */\r\n        commitLinkForm: function(params) {\r\n            // Actually it does the same than rollback grid records\r\n            return this.commitGridAction(params);\r\n        },\r\n        /*   Sends schekpoint action\r\n         */\r\n        sendCheckpoint: function(params) {\r\n            // Actually it does the same than rollback grid records\r\n            return this.sendCheckpointAction(params);\r\n        },\r\n        /*\r\n         *   Loads the userfield definition\r\n         */\r\n        getUserfieldDefinition: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n\r\n            // Check in deferreds cache\r\n            if (self.userfieldRequests[params.userfield])\r\n                return self.userfieldRequests[params.userfield];\r\n\r\n            // Required params: idCase\r\n            self.userfieldRequests[params.userfield] = $.read(self.serviceLocator.getUrl(\"render-userfield-definition\"),\r\n                {\r\n                    guidUserfield: params.userfield,\r\n                    device: (params.device || \"desktop\")\r\n                }\r\n            );\r\n\r\n            // Return deferred\r\n            return self.userfieldRequests[params.userfield];\r\n        },\r\n        /**\r\n         *  Get render json for one render o container\r\n         *  @param {object} params object with idRender,idPageCache\r\n         */\r\n        refreshControl: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"REFRESH\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            (params.xpathContext) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext : \"\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            (params.contexttype) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\r\n            (params.idForm) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idForm\"] = params.idForm : \"\";\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"form-get-data\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"PARTIALREFRESH\"\r\n            });\r\n        },\r\n        /**\r\n         *  Get render json for one render o container\r\n         *  @param {object} params object with idRender,idPageCache\r\n         */\r\n        refreshGridCell: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"REFRESHGRIDCELL\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidcolumn\"] = params.column;\r\n            (params.xpathContext) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext : \"\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            (params.idForm) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idForm\"] = params.idForm : \"\";\r\n            (params.typeRender) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"typeRender\"] = params.typeRender : \"\";\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"form-get-data\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        /**\r\n         * Request to execute rule on server\r\n         * @param {object} params h_pageCacheId, guidrule\r\n         */\r\n        executeRule: function(params) {\r\n            var self = this;\r\n\r\n\r\n            var data = {};\r\n            params = params || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"EXECUTERULE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidrule\"] = params.rule || \"\";\r\n            (params.xpathContext) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext : \"\";\r\n            (params.contexttype) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.create(self.serviceLocator.getUrl(\"form-submit-data\"), data);\r\n        },\r\n        /**\r\n         * Request to execute interface on server\r\n         * @param {object} params h_pageCacheId, guidinterface\r\n         */\r\n        executeInterface: function(params) {\r\n            var self = this;\r\n            var data = {};\r\n            params = params || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"EXECUTEINTERFACE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidinterface\"] = params.interface || \"\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext || \"\";\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.create(self.serviceLocator.getUrl(\"form-submit-data\"), data);\r\n        },\r\n        /**\r\n         * Request to execute SAP Connecor\r\n         * @param {object} params h_pageCacheId, guidinterface\r\n         */\r\n        executeSAPConnector: function(params) {\r\n            var self = this;\r\n            var data = {};\r\n            params = params || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"EXECUTESAP\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidsap\"] = params.guidsap || \"\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext || \"\";\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.create(self.serviceLocator.getUrl(\"form-submit-data\"), data);\r\n        },\r\n        /**\r\n         * Request to execute a Bizagi connector\r\n         * @param params\r\n         * @return {{}}\r\n         */\r\n        executeConnector: function(params) {\r\n            var self = this;\r\n            var data = {};\r\n            params = params || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"EXECUTECONNECTOR\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidConnector\"] = params.guidConnector || \"\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext || \"\";\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.create(self.serviceLocator.getUrl(\"form-submit-data\"), data);\r\n        },\r\n        /*\r\n         *   Document Templates generate rest service\r\n         */\r\n        generateDocumentTemplate: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n            params.append = params.append ? params.append : false;\r\n\r\n            return $.create(\r\n                self.serviceLocator.getUrl(\"render-document-generate\"),\r\n                {\r\n                    h_pageCacheId: params.idPageCache,\r\n                    contextXpath: params.xpathcontext,\r\n                    groupMappingId: params.groupMapping,\r\n                    xpathAttribute: params.xpath,\r\n                    append: params.append,\r\n                    controlId: params.id\r\n                }\r\n            );\r\n        },\r\n        /*\r\n         *   Document Templates generate rest service\r\n         */\r\n        getAllDocumentsDownloadUrl: function(params) {\r\n            var self = this;\r\n            var url = this.serviceLocator.getUrl(\"render-document-generateAllDocuments\");\r\n            var data = {};\r\n            data[\"h_pageCacheId\"] = params.idPageCache;\r\n            data[\"contextXpath\"] = params.xpathContext;\r\n            data[\"xpathAttribute\"] = params.xpath;\r\n            data[\"idCase\"] = params.idCase;\r\n            data[\"idWorkItem\"] = params.idWorkItem;\r\n            data[\"p_sessionId\"] = params.sessionId;\r\n\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data) + \"&xsrf=\" + bizagi.getXSRFToken();\r\n\r\n        },\r\n\r\n\r\n        getCaseNumber: function(params) {\r\n            var self = this;\r\n            //this function use sendEMail\r\n            //and not possible use dat ain ajax\r\n            //this is workaround (rhonyp)\r\n            return $.ajax({\r\n                url: self.serviceLocator.getUrl(\"case-handler-getCaseSummary\").replace(\"{idCase}\", params.idCase) + \"?eventAsTasks=false&onlyUserWorkItems=true&mobileDevice=\" + bizagi.isMobile(),\r\n                type: \"GET\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n\r\n        getCaseAssignees: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n\r\n            // Required params: idCase\r\n            return $.read(\r\n                self.serviceLocator.getUrl(\"case-handler-getCaseAssignees\"), {\r\n                    idCase: params.idCase\r\n                }\r\n            ).pipe(function(response) {\r\n                    return response;\r\n                });\r\n        },\r\n\r\n        getWorkitems: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n\r\n            return $.read(self.serviceLocator.getUrl(\"case-handler-getWorkItems\"), {\r\n                idCase: params.idCase,\r\n                onlyUserWorkItems: params.onlyUserWorkItems || \"\"\r\n            });\r\n        },\r\n        /*\r\n         *   Executes a grid export action in the server\r\n         */\r\n        getGridExportUrl: function(params) {\r\n\r\n            var self = this,\r\n                url = this.serviceLocator.getUrl(\"render-upload-data-url\"),\r\n                data = {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = params.exportType; //\"data\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"disposition\"] = params.disposition;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sort\"] = params.sort;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"idForm\"] = params.idForm;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            (params.contexttype) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\r\n\r\n            return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data) + \"&xsrf=\" + bizagi.getXSRFToken();\r\n        },\r\n\r\n        /*\r\n         * Executes a send email action in the server\r\n         */\r\n        sendEmail: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n\r\n            var data = {};\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = params.property || \"sendEmail\";\r\n            (params.xpathContext) ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext : \"\";\r\n\r\n            // Email parameters\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"to\"] = params.to;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"subject\"] = params.subject;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"message\"] = params.message;\r\n            data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"selected\"] = JSON.encode(params.selected);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            var url = params.url || self.serviceLocator.getUrl(\"form-get-data\");\r\n\r\n            return $.create(url, data);\r\n        },\r\n\r\n        /*\r\n         * Request to invalidates page cache in server, since it is no needed anymore\r\n         */\r\n        invalidatePageCache: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"INVALIDATEPAGECACHE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"form-submit-data\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"INVALIDATEPAGECACHE\"\r\n            });\r\n        },\r\n\r\n        /*\r\n         * Search users usign parameters suchs as userName, fullName, domain and organization\r\n         * @params { domain: (string), userName: (string), fullName: (string), organization: (string), page: (int), pageSize: (int) }\r\n         * @return {deferred} ajax object with JSON content\r\n         */\r\n        getUsersList: function(params) {\r\n            var self = this;\r\n\r\n            return $.read(self.serviceLocator.getUrl(\"admin-getUsersList\"), params);\r\n        },\r\n        /*\r\n         * Search users for preferences usign parameters suchs as userName, fullName, domain and organization\r\n         * @params { domain: (string), userName: (string), fullName: (string), organization: (string), page: (int), pageSize: (int) }\r\n         * @return {deferred} ajax object with JSON content\r\n         */\r\n        getUsersListFromPreferences: function(params) {\r\n            return $.read(this.serviceLocator.getUrl(\"admin-getUsersList-FromPreferences\"), params);\r\n        },\r\n\r\n        /*\r\n         * Search users for Stakeholders\r\n         * @params { domain: (string), userName: (string), fullName: (string), organization: (string), page: (int), pageSize: (int) }\r\n         * @return {deferred} ajax object with JSON content\r\n         */\r\n        getUsersListForStakeholders: function(params) {\r\n            return $.read(this.serviceLocator.getUrl(\"admin-getUsersList-ForStakeholders\"), params);\r\n        },\r\n\r\n        /*\r\n         * Search users usign parameters suchs as userName, fullName, domain and organization\r\n         * @params { domain: (string), userName: (string), fullName: (string), organization: (string), page: (int), pageSize: (int) }\r\n         * @return {deferred} ajax object with JSON content\r\n         */\r\n        getUsersForAssignation: function(params) {\r\n            var self = this;\r\n\r\n            return $.read(self.serviceLocator.getUrl(\"admin-getUsersForAssignation\"), params);\r\n        },\r\n\r\n        /**\r\n         * Get Users Creation/Edition Form\r\n         */\r\n        getUsersForm: function(params) {\r\n            var self = this;\r\n            return $.create(self.serviceLocator.getUrl(\"admin-usersform\"), params);\r\n        },\r\n        /**\r\n         *   Return generate Data To Send By Email\r\n         */\r\n        generateDataToSendByEmail: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n            var data = {\r\n                action: \"GenerateDataToSendByEmail\",\r\n                idUser: params.idUser,\r\n                password: params.password\r\n            };\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: self.serviceLocator.getUrl(\"admin-GenerateDataToSendByEmail\"),\r\n                data: params,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n        /**\r\n         * Return generate Send user password Mail\r\n         */\r\n        sendUserEmail: function(params) {\r\n            var self = this;\r\n            params = params || {};\r\n            var data = {\r\n                action: \"SendUserEmail\",\r\n                emailTo: params.eMailTo,\r\n                subject: params.subject,\r\n                body: params.body\r\n            };\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: self.serviceLocator.getUrl(\"admin-sendUserEmail\"),\r\n                data: params,\r\n                type: \"POST\",\r\n                dataType: \"json\"\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Get bizagi configuration\r\n         * @param {Function}   type callback function when the file load is succed\r\n         * @return {deferred} ajax object with JSON content\r\n         */\r\n        getConfiguration: function() {\r\n            var self = this;\r\n            var url = self.serviceLocator.getUrl(\"admin-users-config\");\r\n\r\n            return $.read(url);\r\n        },\r\n\r\n        /**\r\n         * Validate if url has 'http' string, in that case is not necesary add the pathToBase prefix\r\n         */\r\n        verifyPathToBase: function(pathToBase, url) {\r\n\r\n            if (url.indexOf(\"http\") != -1 && pathToBase != \"\") {\r\n                return url;\r\n            } else {\r\n                return pathToBase + url;\r\n            }\r\n\r\n        },\r\n\r\n        /**\r\n         * Get template of entity\r\n         * @param params { guid, prepare}\r\n         */\r\n        getTemplate: function(params) {\r\n            var self = this;\r\n            var data = {};\r\n            params = params || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"LOADTEMPLATE\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = \"entity\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guid;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isProcessData\"] = params.forcePersonalizedColumns;\r\n\r\n            if (params.templateType) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"templatetype\"] = params.templateType;\r\n            }\r\n\r\n            if (params.templateGuid) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"templateguid\"] = params.templateGuid;\r\n            }\r\n\r\n            if (params.isDefaultTemplate != undefined) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isDefaultTemplate\"] = params.isDefaultTemplate;\r\n            }\r\n\r\n            // Fix device type since on mobility there are tablet_ios, tablet_android, smartphone_ios, smartphone_ios\r\n            // and the service recives either tablet or smartphone\r\n            var deviceType = bizagi.util.detectDevice();\r\n            if (bizagi.util.isTabletDevice()) {\r\n                deviceType = \"tablet\";\r\n            } else if (bizagi.util.isSmartphoneDevice()) {\r\n                deviceType = \"mobile\";\r\n            }\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicetype\"] = deviceType;\r\n\r\n            // When prepare is true just return data, this feature is used by multiaction service\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.create(self.serviceLocator.getUrl(\"form-get-data\"), data);\r\n        },\r\n\r\n        /**\r\n         * Chek if an entity has startform\r\n         * @param params\r\n         * @return {*}\r\n         */\r\n        hasStartForm: function(params) {\r\n            var self = this;\r\n            var data = {};\r\n\r\n            if (params.guidWFClass) {\r\n                data.guidWFClass = params.guidWFClass;\r\n            }\r\n\r\n            return $.read(self.serviceLocator.getUrl(\"render-processes-startform\"), data);\r\n        },\r\n\r\n        /**\r\n         * Get the start form of the case\r\n         * @param params\r\n         * @return {*}\r\n         */\r\n        getStartForm: function(params) {\r\n            var self = this;\r\n            var data = {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"LOADSTARTFORM\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidprocess\"] = params.guidprocess;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isActionStartForm\"] = true;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicetype\"] = self.deviceType;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicecode\"] = self.deviceCode;\r\n\r\n            if (params.idStartScope) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idStartScope\"] = params.idStartScope;\r\n            }\r\n            if (params.idCase) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idCase\"] = params.idCase;\r\n            }\r\n            if (params.idStartScope) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idStartScope\"] = params.idStartScope;\r\n            }\r\n            if (params.idWorkitem) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idWorkitem\"] = params.idWorkitem;\r\n            }\r\n            if (params.additionalXpaths) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"additionalXpaths\"] = params.additionalXpaths;\r\n            }\r\n            if (params.surrogatedKey) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"surrogatedKey\"] = params.surrogatedKey;\r\n            }\r\n            if (params.recordXpath) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"recordlauncherxpath\"] = params.recordXpath;\r\n            }\r\n            if (params.mappingstakeholders) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"mappingstakeholders\"] = params.mappingstakeholders;\r\n            }\r\n\r\n            return $.ajax({\r\n                url: self.serviceLocator.getUrl(\"form-get-data\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                cache: true\r\n            });\r\n        },\r\n        /*\r\n         *   Start a link form edition\r\n         */\r\n        editActionForm: function(params) {\r\n            // Actually it does the same than edit grid records\r\n            return this.editGridRecord(params);\r\n        },\r\n\r\n        /**\r\n         * Get list of actions in action launcher\r\n         * @param params\r\n         * @return {*}\r\n         */\r\n        getActions: function(params) {\r\n            var self = this;\r\n            var extendParams = $.extend(params, { prepare: true });\r\n\r\n            var data = self.getPropertyData(extendParams) || [];\r\n\r\n            if (params.ptags) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"tags\"] = params.ptags;\r\n            }\r\n\r\n            if (params.pmaxitems) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"maxitems\"] = params.pmaxitems;\r\n            }\r\n\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-property-refresh\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: params.dataType || \"json\",\r\n                serviceType: \"PROCESSPROPERTYVALUE\",\r\n                beforeSend: function(xhr, status) {\r\n                    bizagi.multiactionConnection = bizagi.multiactionConnection || [];\r\n                    bizagi.multiactionConnection.push(xhr);\r\n                }\r\n            });\r\n\r\n        },\r\n\r\n        /**\r\n         * Execute actions or constructors\r\n         * @param params\r\n         */\r\n        executeActions: function(params) {\r\n            var self = this;\r\n            var extendParams = $.extend({}, params, { prepare: true });\r\n            var data = self.getPropertyData(extendParams) || [];\r\n\r\n            if (params.pguidConstructor) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"guidConstructor\"] = params.pguidConstructor;\r\n            }\r\n\r\n            if (params.pguidAction) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"guidAction\"] = params.pguidAction;\r\n            }\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-property-refresh\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: params.dataType || \"json\",\r\n                serviceType: \"PROCESSPROPERTYVALUE\"\r\n            });\r\n\r\n        },\r\n\r\n        /**\r\n         * Get list of actions in action launcher\r\n         * @param params\r\n         * @return {*}\r\n         */\r\n        getPolymorphicActions: function(params) {\r\n            var self = this;\r\n            var extendParams = $.extend(params, { prepare: true });\r\n            var data = self.getPropertyData(extendParams) || [];\r\n\r\n            if (params.ptags) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"tags\"] = params.ptags;\r\n            }\r\n\r\n            if (params.additionalXpaths) {\r\n                data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"additionalXpaths\"] = params.additionalXpaths;\r\n            }\r\n\r\n            if (params.prepare) {\r\n                return data;\r\n            }\r\n\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-property-refresh\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: params.dataType || \"json\",\r\n                serviceType: \"PROCESSPROPERTYVALUE\"\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Make a JSON tree of polymorphic constructors categories\r\n         * @param values\r\n         * @return {Array}\r\n         */\r\n        serializePolymorphicActions: function(values) {\r\n            // json serializer\r\n            var actions = [];\r\n            var GUID_ENTITY = 0, DISPLAY_NAME = 1, XPATHCONTEXT = 2, TYPE = 3, GUID_OBJECT = 4, GUID_CONSTRUCTOR = 5, GUID_PARENT_ENTITY = 6;\r\n\r\n            /**\r\n             * Get children by guid of entity\r\n             * @param guid\r\n             * @return {Array}\r\n             */\r\n            var getChildren = function(guid) {\r\n                var children = [];\r\n                guid = guid || \"\";\r\n\r\n                $.each(values, function(key, value) {\r\n                    if (value[GUID_PARENT_ENTITY] == guid) {\r\n                        children.push(value);\r\n                    }\r\n                });\r\n                return children;\r\n            };\r\n\r\n            /**\r\n             * Get parents by action object\r\n             * @param node\r\n             * @return {string}\r\n             */\r\n            var getParents = function(node) {\r\n                node = node || {};\r\n                var parents = \"\";\r\n\r\n                $.each(values, function(key, value) {\r\n                    if (value[GUID_ENTITY] == node[GUID_PARENT_ENTITY]) {\r\n                        parents += getParents(value) + value[DISPLAY_NAME] + \" > \";\r\n                    }\r\n                });\r\n                return parents;\r\n            };\r\n\r\n\r\n            /**\r\n             * Make a tree of actions\r\n             * @param list\r\n             * @param guid\r\n             * @return {*}\r\n             */\r\n            var fillTree = function(list, guid) {\r\n                var node;\r\n                var children = getChildren(guid);\r\n                $.each(children, function(key, value) {\r\n                    var child = fillTree([], value[GUID_ENTITY]);\r\n                    node = {\r\n                        \"guidEntity\": value[GUID_ENTITY],\r\n                        \"displayName\": value[DISPLAY_NAME],\r\n                        \"hasConstructor\": (value[GUID_CONSTRUCTOR]) ? true : false,\r\n                        \"type\": value[TYPE],\r\n                        \"guidObject\": value[GUID_OBJECT],\r\n                        \"guidConstructor\": value[GUID_CONSTRUCTOR],\r\n                        \"xpathContext\": value[XPATHCONTEXT],\r\n                        \"children\": child,\r\n                        \"parents\": getParents(value)\r\n                    };\r\n                    if (node.guidConstructor !== \"\" || node.children.length > 0) {\r\n                        list.push(node);\r\n                    }\r\n                });\r\n\r\n                return list;\r\n            };\r\n            fillTree(actions, \"\");\r\n            return actions;\r\n        },\r\n\r\n        /**\r\n         * Gets the image for an entity xpath\r\n         * @param params\r\n         */\r\n        getEntityImage64: function(params) {\r\n            var self = this,\r\n                data = {\r\n                    width: params.data,\r\n                    height: params.height,\r\n                    xpath: params.xpath\r\n                },\r\n                url = self.serviceLocator.getUrl(\"render-entity-layout-image64\").replace(\"{entity}\", params.entity).replace(\"{surrogateKey}\", params.surrogateKey);\r\n\r\n            return $.ajax({\r\n                url: url,\r\n                data: data\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Get data files when user access from my stuff, because there is no scope\r\n         */\r\n        getFilesDataForLayoutUploadControl: function(params) {\r\n            var self = this;\r\n            return $.read(self.serviceLocator.getUrl(\"render-entity-layout-upload-files\"), params);\r\n        },\r\n\r\n        /**\r\n         * Process an upload file into the server\r\n         * @param {} params\r\n         * @returns {}\r\n         */\r\n        processUploadFile: function(params) {                \r\n            return $.ajax({\r\n                url: this.verifyMobilePathToBase(bizagi.services.ajax.pathToBase || \"\", params.url),\r\n                data: params.formData,\r\n                type: \"POST\",\r\n                contentType: false,\r\n                processData: false\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Commit an add or edit request for a grid\r\n         * @param params\r\n         * @returns {*}\r\n         */\r\n        commitGridAction: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"COMMIT\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending rollback request for grid '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-commit-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"COMMIT\"\r\n            });\r\n        },\r\n        /*\r\n         *   Commit an add or edit request for a grid\r\n         */\r\n        sendCheckpointAction: function(params) {\r\n            var self = this;\r\n\r\n            // Define data\r\n            var data = params.extra || {};\r\n\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"CHECKPOINT\";\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\r\n\r\n            if (params.contexttype) {\r\n                data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\r\n            }\r\n\r\n            // Log submit data\r\n            bizagi.debug(\"Sending checkpoint request for grid '\" + params.xpath + \"'\", data);\r\n\r\n            // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\r\n            if (params.prepare)\r\n                return data;\r\n\r\n            // Call ajax and returns promise\r\n            return $.ajax({\r\n                url: params.url || self.serviceLocator.getUrl(\"render-grid-checkpoint-url\"),\r\n                data: data,\r\n                type: \"POST\",\r\n                dataType: \"json\",\r\n                serviceType: \"CHECKPOINT\"\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Validate if url has 'http' string, in that case is not necesary add the pathToBase prefix\r\n         */\r\n        verifyMobilePathToBase: function(pathToBase, url) {\r\n            return bizagi.util.isSharepointContext() ? (url || \"\").replaceAll(pathToBase, \"\"): url;                \r\n        }\r\n\r\n    });\r\n","/*\r\n *   Name: BizAgi Rendering Services\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This class will provide a facade to access to multiaction rendering REST services\r\n */\r\n$.Class.extend(\"bizagi.render.services.multiactionservice\", {\r\n    // Statics\r\n    BA_ACTION_PARAMETER_PREFIX: \"p_\",\r\n    BA_CONTEXT_PARAMETER_PREFIX: \"h_\",\r\n    BA_PAGE_CACHE: \"pageCacheId\"\r\n}, {\r\n\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (service) {\r\n        this.service = service;\r\n        this.serviceLocator = service.serviceLocator;\r\n\r\n        // Multiaction - batch stuff\r\n        this.batch = {};\r\n        this.batchTimer = 50;\r\n        this.circularDependencies = new bizagi.circularDependencies();\r\n\r\n        // Create proxyed version of methods\r\n        this.replicateServiceMethods();\r\n    },\r\n\r\n    /*\r\n    *   Returns the internal service\r\n    */\r\n    getService: function () {\r\n        return this.service;\r\n    },\r\n\r\n    /*\r\n    *   Create a proxied multiaction version for service calls\r\n    */\r\n    replicateServiceMethods: function () {\r\n        var self = this;\r\n        for (var key in this.service.Class.prototype) {\r\n            // Omit the folowing methods\r\n            if (key == \"init\" || key == \"constructor\" || key == \"Class\" || key == \"multiaction\") continue;\r\n\r\n            // Replicate instance methods\r\n            self[key] = eval('var tmp = function(){ return this.proxyMethod(this.getService().' + key + ', arguments);};tmp');\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Perform the proxy call for each service method\r\n    */\r\n    proxyMethod: function (method, arguments) {\r\n        var service = this.service;\r\n\r\n        // Check if has only one argument, else execute directly\r\n        if (!arguments || arguments.length != 1) {\r\n            return method.apply(service, arguments);\r\n        }\r\n\r\n        // Check if the argument is object, else execute directly\r\n        if (typeof (arguments[0]) != \"object\") {\r\n            return method.apply(service, arguments);\r\n        }\r\n\r\n        var params = arguments[0];\r\n\r\n        // If the caller is requesting a prepare call, just execute the method with the current arguments\r\n        if (params.prepare == true) return method.apply(service, arguments);\r\n\r\n        // Prepare the ajax instead of sending it\r\n        params.prepare = true;\r\n        var action = method.apply(service, arguments);\r\n\r\n        return this.add(action);\r\n    },\r\n\r\n    /**\r\n    * This method make a standard error message\r\n    */\r\n    makeCircularDependenciesError: function (error) {\r\n        var messageTmpl = bizagi.localization.getResource(\"render-actions-loop-validation\");\r\n\r\n        return printf(messageTmpl, error.dependencyFrom, error.dependencyTo);\r\n    },\r\n\r\n\r\n    /*\r\n    *   Add an action to be performed in a multiaction, and be resolved later\r\n    *   returns a deferred\r\n    */\r\n    add: function (action) {\r\n        var self = this;\r\n        var deferred = new $.Deferred();\r\n\r\n        var name = action.h_action || \"unnamed\";\r\n\r\n        // Put here all actions to ignore in circular dependencies\r\n        var exceptionActions = [\"PROCESSPROPERTYVALUE\", \"LOADTEMPLATE\", \"ADDRELATIONWITHDATA\"];\r\n\r\n        if (exceptionActions.indexOf(name) < 0 && bizagi.override.detectCircularDependencies) {\r\n            self.circularDependencies.addNode(name, action);\r\n        }\r\n\r\n        // First clear previous timeout\r\n        clearTimeout(self.batchTimeout);\r\n        var tag = action.tag = Math.guid();\r\n        var singleAction = { action: action, deferred: deferred };\r\n        self.batch[tag] = singleAction;\r\n\r\n        // Start a new timeout\r\n        self.batchTimeout = setTimeout(function () {\r\n            var resolveDependencies = self.circularDependencies.resolve();\r\n\r\n            if (resolveDependencies.error) {\r\n                // Reset Queue\r\n                for (var i in self.batch) {\r\n                    var message = resolveDependencies.error.multiactionError;\r\n                    self.batch[i].deferred.reject(message);\r\n                }\r\n                self.batch = {};\r\n            } else {\r\n                self.fire();\r\n            }\r\n        }, self.batchTimer);\r\n\r\n        return deferred.promise();\r\n    },\r\n    /*\r\n    *   Fires up the multiaction\r\n    */\r\n    fire: function () {\r\n        var self = this;\r\n        var batch = {};\r\n\r\n        // Prepare actions and clone batch manually\r\n        var actions = [];\r\n        $.each(self.batch, function (tag, item) {\r\n            actions.push(item.action);\r\n            batch[tag] = item;\r\n        });\r\n\r\n        // Reset batch\r\n        self.batch = {};\r\n\r\n        // Fire ajax \r\n        $.when(self.execute({ actions: actions, rejectDeferreds: false }))\r\n                .done(function (responses) {\r\n\r\n                    // Process each response\r\n                    $.each(responses, function (i, response) {\r\n                        var tag = response.tag;\r\n                        if (!response.error) {\r\n                            batch[tag].deferred.resolve(response.result);\r\n                        } else {\r\n                            batch[tag].deferred.reject(response.error, response, response.error.message);\r\n                        }\r\n\r\n                        // Remove paired tag from collection\r\n                        delete batch[tag];\r\n                    });\r\n\r\n                    // Check if there are unpaired actions so we need to trigger fail deferred\r\n                    $.each(batch, function (i, item) {\r\n                        item.deferred.reject({ type: \"not-processed\", message: \"Operation didn't executed\" }, '', \"Operation didn't executed\");\r\n                    });\r\n                }).fail(function (xhr, type, error) {\r\n\r\n                    // Check if there are unpaired actions so we need to trigger fail deferred\r\n                    var errorMessage = typeof (error) !== \"undefined\" ? error.message : (error || \"Operation didn't executed\");\r\n                    $.each(batch, function (i, item) {\r\n                        item.deferred.reject({ type: \"not-processed\", message: errorMessage }, '', \"Operation didn't executed\");\r\n                    });\r\n                });\r\n    },\r\n    /*\r\n    *   Sends a multiaction to the server\r\n    */\r\n    execute: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        var data = {};\r\n        var rejectDeferreds = params.rejectDeferreds !== undefined ? params.rejectDeferreds : true;\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"multiaction\";\r\n\r\n        // Check action tag\r\n        $.each(params.actions, function (i, action) {\r\n            action[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"tag\"] = action.tag || i;\r\n            delete action.tag;\r\n        });\r\n\r\n        // Fill optional parameters\r\n        params = params || {};\r\n        if (params.actions) {\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"actions\"] = JSON.encode(params.actions);\r\n        }\r\n\r\n        // Log submit data\r\n        bizagi.debug(\"Performing multi-action\", data);\r\n\r\n        // Call ajax and returns promise\r\n        var deferred = new $.Deferred();\r\n        $.ajax({\r\n            url: self.serviceLocator.getUrl(\"render-multiaction\"),\r\n            data: data,\r\n            type: \"POST\",\r\n            dataType: \"json\",\r\n            serviceType: \"MULTIACTION\",\r\n            beforeSend: function (xhr, status) {\r\n                bizagi.multiactionConnection = bizagi.multiactionConnection || [];\r\n                bizagi.multiactionConnection.push(xhr);\r\n            }\r\n\r\n        }).done(function (responses) {\r\n            for (i in responses) {\r\n                if (typeof responses[i] !== \"function\") {\r\n                    var response = responses[i];\r\n                    if (response.error) {\r\n                        if (rejectDeferreds) {\r\n                            deferred.reject(this, \"servererror\", response);\r\n                            return;\r\n                        }\r\n\r\n                    }\r\n                }\r\n            }\r\n            deferred.resolve(responses);\r\n\r\n        }).fail(function (xhr) {\r\n            var response = xhr.responseText || xhr;\r\n            var finalResponse;\r\n            // Try to parse the response\r\n            try {\r\n                finalResponse = JSON.parse(response);\r\n            } catch (e) { }\r\n            deferred.reject(xhr, \"servererror\", finalResponse);\r\n        });\r\n\r\n        return deferred.promise();\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Rendering Services\r\n *   Author: Einer Perez\r\n *   Comments:\r\n *   -   This class will provide a facade to access to multiaction rendering REST services\r\n */\r\nbizagi.render.services.multiactionservice.extend(\"bizagi.render.services.metadatamultiactionservice\", {\r\n    // Statics\r\n    BA_ACTION_PARAMETER_PREFIX: \"p_\",\r\n    BA_CONTEXT_PARAMETER_PREFIX: \"h_\",\r\n    BA_PAGE_CACHE: \"h_pageCacheId\"\r\n}, {\r\n\r\n    /*\r\n    *   Sends a multiaction to the server\r\n    */\r\n    execute: function (params) {\r\n        var self = this;\r\n\r\n        // Define data\r\n        var data = {};\r\n        var rejectDeferreds = params.rejectDeferreds !== undefined ? params.rejectDeferreds : true;\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"multiaction\";\r\n\r\n        // Check action tag\r\n        $.each(params.actions, function (i, action) {\r\n            action[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"tag\"] = action.tag || i;\r\n            if (action[self.Class.BA_PAGE_CACHE]) {\r\n                data[self.Class.BA_PAGE_CACHE] = action[self.Class.BA_PAGE_CACHE];\r\n            }\r\n            delete action[self.Class.BA_PAGE_CACHE];\r\n            delete action.tag;\r\n        });\r\n\r\n        // Fill optional parameters\r\n        params = params || {};\r\n        if (params.actions) {\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"actions\"] = JSON.encode(params.actions);\r\n        }\r\n\r\n        // Log submit data\r\n        bizagi.debug(\"Performing multi-action metadata\", data);\r\n\r\n        // Call ajax and returns promise\r\n        var deferred = new $.Deferred();\r\n        $.ajax({\r\n            url: self.serviceLocator.getUrl(\"render-multiaction-metadata\"),\r\n            data: data,\r\n            type: \"POST\",\r\n            dataType: \"json\",\r\n            serviceType: \"MULTIACTION\",\r\n            beforeSend: function (xhr, status) {\r\n                bizagi.multiactionConnection = bizagi.multiactionConnection || [];\r\n                bizagi.multiactionConnection.push(xhr);\r\n            }\r\n\r\n        }).done(function (responses) {\r\n            for (i in responses) {\r\n                if (typeof responses[i] !== \"function\") {\r\n                    var response = responses[i];\r\n                    if (response.error) {\r\n                        if (rejectDeferreds) {\r\n                            deferred.reject(this, \"servererror\", response);\r\n                            return;\r\n                        }\r\n\r\n                    }\r\n                }\r\n            }\r\n            deferred.resolve(responses);\r\n\r\n        }).fail(function (xhr) {\r\n            var response = xhr.responseText || xhr;\r\n            var finalResponse;\r\n            // Try to parse the response\r\n            try {\r\n                finalResponse = JSON.parse(response);\r\n            } catch (e) { }\r\n            deferred.reject(xhr, \"servererror\", finalResponse);\r\n        });\r\n\r\n        return deferred.promise();\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Rendering Command controller \r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define basic stuff for action and validation controllers\r\n */\r\n\r\n$.Class.extend(\"bizagi.command.controllers.controller\", {\r\n    /* \r\n    *   Set to true in order to debug\r\n    */\r\n    THROW_ERROR: true\r\n\r\n}, {\r\n    /*  \r\n    *   Constructor\r\n    */ \r\n    init: function (form) {\r\n        this.form = form;\r\n        this.dateFormat = form.getResource(\"dateFormat\");\r\n    },\r\n    /*\r\n    *   Returns the condition in JS\r\n    */\r\n    buildConditions: function (conditions, bGridDetected, bCheckEditability) {\r\n        var self = this;\r\n        var operator = conditions.expressions && conditions.expressions.length > 1 ? self.buildConditionOperator(conditions.operator) : conditions.operator;\r\n\r\n        // Define if a grid has been detected\r\n        bGridDetected = bGridDetected || false;\r\n        bCheckEditability = bCheckEditability || false;\r\n\r\n        //  Validate trtue and false conditions\r\n        if (operator == \"true\")\r\n            return \"true\";\r\n        if (operator == \"false\")\r\n            return \"false\";\r\n\r\n        var sJsCondition = \"\";\r\n\r\n        for (var i = 0; i < conditions.expressions.length; i++) {\r\n            var expression = conditions.expressions[i];\r\n\r\n            if (expression.simple) {\r\n                var bGDetected = self.searchGridReferenceInCondition(expression.simple);\r\n                sJsCondition += self.buildSimpleCondition(expression.simple, bGDetected, bCheckEditability);\r\n\r\n            } else if (expression.complex) {\r\n                sJsCondition += \"(\" + self.buildConditions(expression.complex, bGridDetected, bCheckEditability) + \") \";\r\n            }\r\n\r\n            // Adds operator\r\n            sJsCondition += (i < conditions.expressions.length - 1 ? operator : \"\");\r\n        }\r\n\r\n        return sJsCondition;\r\n    },\r\n    /*\r\n    *   Builds the condition operator\r\n    */\r\n    buildConditionOperator: function (conditionsOperator) {\r\n        if (conditionsOperator == \"and\")\r\n            return \" && \";\r\n        if (conditionsOperator == \"or\")\r\n            return \" || \";\r\n        return conditionsOperator;\r\n    },\r\n    /*\r\n    *   Builds a simple condition\r\n    */\r\n    buildSimpleCondition: function (condition, bGridDetected, bCheckEditability) {\r\n        var self = this;\r\n        var sXpath;\r\n        var xpath;\r\n        var sArgument = \"\";\r\n        var operator = condition.operator;\r\n        var ensureValueJs = \"\";\r\n        var ensureEditable = \"\";\r\n\r\n        // Define if a grid has been detected\r\n        bGridDetected = bGridDetected || false;\r\n        bCheckEditability = bCheckEditability || false;\r\n\r\n        // List of controls excluded to editability validation\r\n        // Just keep empty the value of element\r\n        var excludeEditabilityRule = { \"boolean\": \"\" };\r\n        var control = condition.xpath || condition.renderId;\r\n\r\n        var detectedArgumentType = self.detectConditionArgumentType(control, condition.argumentType);\r\n\r\n        // Build xpath\r\n        sXpath = self.buildXpath(control, detectedArgumentType, bGridDetected);\r\n        if (detectedArgumentType != \"boolean\") {\r\n            ensureValueJs += \"!bizagi.util.isEmpty(\" + sXpath + \") && \";\r\n        }\r\n\r\n        // Check if the render is editable, only when the parameter is provided\r\n        if (bCheckEditability && control && control.length > 0 && !excludeEditabilityRule.hasOwnProperty(detectedArgumentType)) {\r\n            ensureEditable = \"self.isVisible('\" + control + \"') && self.isEditable('\" + control + \"') && \";\r\n        }\r\n\r\n        // Build argument\r\n        if (!bizagi.util.isEmpty(condition.argument)) {\r\n            sArgument = self.buildArgument(condition.argument, detectedArgumentType, bGridDetected);\r\n\r\n            // If the argument is xpath it must be filled to for some operators\r\n            if (detectedArgumentType == \"xpath\") {\r\n                ensureValueJs += \"!bizagi.util.isEmpty(\" + sArgument + \") && \";\r\n            }\r\n\r\n        } else if (condition.argument === \"\") {\r\n            // Also check the case when the argument is empty\r\n            sArgument = \"\\\"\\\"\";\r\n        }\r\n\r\n        // Build condition\r\n\r\n        if (operator == \"includes\") {\r\n            return ensureEditable + ensureValueJs + \"self.includes(\" + sXpath + \",\" + sArgument + \") \";\r\n        }\r\n        //if (operator == \"changes\") return \"true\";\r\n        if (operator == \"changes\") {\r\n            return \"self.isChanged(\" + sXpath + \", params.changed)\";\r\n        }\r\n        if (operator == \"equals\")\r\n            return ensureEditable + ensureValueJs + sXpath + \" == \" + sArgument;\r\n        if (operator == \"not-equals\")\r\n            return ensureEditable + sXpath + \" != \" + sArgument;\r\n        if (operator == \"less-than\")\r\n            return ensureEditable + ensureValueJs + sXpath + \" < \" + sArgument;\r\n        if (operator == \"less-equals-than\")\r\n            return ensureEditable + ensureValueJs + sXpath + \" <= \" + sArgument;\r\n        if (operator == \"greater-than\")\r\n            return ensureEditable + ensureValueJs + sXpath + \" > \" + sArgument;\r\n        if (operator == \"greater-equals-than\")\r\n            return ensureEditable + ensureValueJs + sXpath + \" >= \" + sArgument;\r\n        if (operator == \"like\")\r\n            return ensureEditable + ensureValueJs + sXpath + \".toString().indexOf(\" + sArgument + \") >= 0 \";\r\n        if (operator == \"is-empty\") {\r\n            if (detectedArgumentType != \"entity\") {\r\n                return ensureEditable + \"bizagi.util.isEmpty(\" + sXpath + \")\";\r\n            } else {\r\n                return ensureEditable + \"(\" + sXpath + \" == 0 || bizagi.util.isEmpty(\" + sXpath + \"))\";\r\n            }\r\n        }\r\n        if (operator == \"is-not-empty\") {\r\n            if (detectedArgumentType != \"entity\") {\r\n                return ensureEditable + \"!bizagi.util.isEmpty(\" + sXpath + \")\";\r\n            } else {\r\n                return ensureEditable + \"(\" + sXpath + \" != 0 && !bizagi.util.isEmpty(\" + sXpath + \"))\";\r\n            }\r\n        }\r\n        if (operator == \"is-true\")\r\n            return ensureEditable + \"( \" + sXpath + \" == true || \" + sXpath + \" == 'true' )\";\r\n        if (operator == \"is-false\")\r\n            return ensureEditable + \"( \" + sXpath + \" == false || \" + sXpath + \" == 'false' || \" + sXpath + \" == 'False' )\";\r\n        if (operator == \"does-not-contain\")\r\n            return ensureEditable + ensureValueJs + sXpath + \".toString().indexOf(\" + sArgument + \") < 0 \";\r\n        if (operator == \"contains\")\r\n            return ensureEditable + ensureValueJs + sXpath + \".toString().indexOf(\" + sArgument + \") >= 0 \";\r\n        if (operator == \"begins-with\")\r\n            return ensureEditable + ensureValueJs + sXpath + \".toString().startsWith(\" + sArgument + \") == true \";\r\n        if (operator == \"does-not-begins-with\")\r\n            return ensureEditable + ensureValueJs + sXpath + \".toString().startsWith(\" + sArgument + \") == false \";\r\n        if (operator == \"file-uploaded\") {\r\n            xpath = control;\r\n            if (bGridDetected && xpath) {\r\n                xpath = xpath.replaceAll(\"[]\", \"[' + i + ']\");\r\n            }\r\n            return ensureEditable + \"self.isFileUploaded('\" + xpath + \"') \";\r\n        }\r\n        if (operator == \"file-not-uploaded\") {\r\n            xpath = control;\r\n            if (bGridDetected && xpath) {\r\n                xpath = xpath.replaceAll(\"[]\", \"[' + i + ']\");\r\n            }\r\n            return ensureEditable + \"!self.isFileUploaded('\" + xpath + \"') \";\r\n        }\r\n        if (operator == \"is-invalid-email\")\r\n            return ensureEditable + \"!self.isValidEmail(\" + sXpath + \") \";\r\n        if (operator == \"letter-edited\")\r\n            return \"false\"; //TODO\r\n        if (operator == \"letter-not-edited\")\r\n            return \"false\"; //TODO\r\n        if (operator == \"cell-change\")\r\n            return \"column == \" + sArgument;\r\n\r\n        if (operator == \"on-press\") {\r\n            if (bGridDetected) {\r\n                var id = self.buildXpath(control, \"id\", bGridDetected);\r\n                return \"self.isGridButtonPressed(\" + id + \", params.pressed)\";\r\n            } else {\r\n                return \"self.isButtonPressed('\" + control + \"', params.pressed)\";\r\n            }\r\n        }\r\n\r\n        // ondelete behavior on grid control  \r\n        if (operator == 'on-deleted-row') {\r\n            xpath = control || \"\";\r\n            return \"self.onDeletedGridRow('\" + xpath + \"', params.rowDeleted)\";\r\n        }\r\n\r\n        // If there is another operator code throw exception\r\n        throw new \"There is no implementation for operator code \" + operator;\r\n    },\r\n    /*\r\n    *   Detects the argument type based on the render\r\n    */\r\n    detectConditionArgumentType: function (control, argumentType) {\r\n        var self = this;\r\n\r\n        if (argumentType === undefined || argumentType == \"const\") {\r\n\r\n            // Search render\r\n            var form = self.form;\r\n            var render = form.getRender(control) || form.getRenderById(control);\r\n\r\n            // Check if exists the render\r\n            if (render == null) {\r\n                throw new Error(\"RenderNotFoundException in method detectConditionArgumentType of bizagi.command.controllers.controller\");\r\n            }\r\n\r\n            // Check if the render is a grid\r\n            if (render.properties.type == \"grid\") {\r\n                var gridXpath = self.processGridXpath(control);\r\n\r\n                if (gridXpath.remainingXpath === \"\") {\r\n                    // The target is the grid\r\n                    return \"xpath\";\r\n                } else {\r\n                    render = render.getColumn(gridXpath.remainingXpath);\r\n                    if (render == null) {\r\n                        throw new Error(\"RenderNotFoundException in method detectConditionArgumentType of bizagi.command.controllers.controller\");\r\n                    }\r\n                }\r\n            }\r\n\r\n            var dataType = render.properties.dataType;\r\n            var renderType = bizagi.util.normalizeType(render.properties.type);\r\n\r\n            if (self.isRelatedEntityRender(renderType)) {\r\n                return 'entity';\r\n            }\r\n\r\n            // Number\r\n            if (dataType == 1 || dataType == 2 || dataType == 3 || dataType == 4 || dataType == 6 || dataType == 7 || dataType == 10 || dataType == 11) {\r\n                return 'number';\r\n            }\r\n\r\n            // Money\r\n            if (dataType == 8) {\r\n                return 'money';\r\n            }\r\n\r\n            // Date\r\n            if (dataType == 12 || dataType == 13) {\r\n                if (render.properties.showTime == true) {\r\n                    return 'datetime';\r\n                } else {\r\n                    return 'date';\r\n                }\r\n            }\r\n\r\n            // Boolean\r\n            if (dataType == 5) {\r\n                return 'boolean';\r\n            }\r\n\r\n            // Button\r\n            if (renderType == \"button\") {\r\n                return \"button\";\r\n            }\r\n\r\n            // Default\r\n            return 'text';\r\n\r\n        } else if (argumentType == \"xpath\" || argumentType == \"function\" || argumentType == \"entity\") {\r\n            return argumentType;\r\n        }\r\n\r\n        // Default return text\r\n        return 'text';\r\n    },\r\n    /*\r\n    *   Detects if a render type must be binded to a xpath with related entity\r\n    */\r\n    isRelatedEntityRender: function (renderType) {\r\n        return [\"combo\", \"list\", \"radio\", \"search\", \"searchCombo\", \"columnCombo\"].includes(renderType) || /^cascadingcombo$/i.test(renderType);\r\n    },\r\n\r\n    buildXpath: function (xpath, argumentType, bGridDetected) {\r\n        var self = this;\r\n\r\n        // Define if a grid has been detected\r\n        bGridDetected = bGridDetected || false;\r\n\r\n        // Process grid xpaths\r\n        if (bGridDetected) {\r\n            xpath = xpath.replaceAll(\"[]\", \"[' + i + ']\");\r\n        }\r\n\r\n        if (argumentType == 'xpath' && !bGridDetected) {\r\n            return \"self.evalXpath('\" + xpath + \"', '\" + self.detectConditionArgumentType(xpath, \"const\") + \"')\";\r\n        } else if (argumentType == 'id') {\r\n            return \"'\" + xpath + \"'\";\r\n        } else if (argumentType == 'function') {\r\n            var xpathArgumentType = self.detectConditionArgumentType(xpath, \"const\");\r\n            return \"self.evalXpath('\" + xpath + \"', '\" + xpathArgumentType + \"')\";\r\n        } else if (bGridDetected){\r\n            return \"self.evalGridXpath(params, '\" + xpath + \"', '\" + argumentType + \"')\";      \r\n        }\r\n\r\n        return \"self.evalXpath('\" + xpath + \"', '\" + argumentType + \"')\";\r\n    },\r\n    buildArgument: function (argument, argumentType, bGridDetected, xpathContext) {\r\n        var self = this;\r\n        var number;\r\n\r\n        // Define if a grid has been detected\r\n        bGridDetected = bGridDetected || false;\r\n\r\n        if (argumentType == 'text') {\r\n            // Text\r\n            argument = (argument == null) ? \"\" : argument;\r\n            argument = (typeof argument != 'string') ? argument.toString() : argument;\r\n            if (argument.indexOf(\"'\") != -1)\r\n                argument = argument.replaceAll(\"'\", \"\\\\'\");\r\n\r\n            // Remove line breaks because they will fail with the eval command\r\n            if (argument.indexOf(\"\\n\") != -1)\r\n                argument = argument.replaceAll(\"\\n\", \"\");\r\n\r\n            return \"'\" + argument.toString() + \"'\";\r\n        }\r\n        if (argumentType == 'boolean') {\r\n            // Boolean\r\n            if (typeof (argument) == \"string\") {\r\n                return (eval(argument.toLowerCase()) == true ? \"true\" : \"false\");\r\n            } else {\r\n                return (eval(argument) == true ? \"true\" : \"false\");\r\n            }\r\n        }\r\n        if (argumentType == 'number') {\r\n            // Number\r\n            number = new Number(argument);\r\n            if (number == NaN)\r\n                return \"-99999999\";\r\n            return number.toString();\r\n        }\r\n        if (argumentType == 'money') {\r\n            // MONEY\r\n            number = new Number(argument);\r\n            if (number == NaN)\r\n                return \"-99999999\";\r\n            return number.toString();\r\n        }\r\n        if (argumentType == 'date') {\r\n            //Date\r\n            var date = bizagi.util.dateFormatter.getDateFromInvariant(argument);\r\n            if (!date || date == 0)\r\n                date = new Date(0);\r\n\r\n            // Remove time\r\n            date.setHours(0, 0, 0, 0);\r\n\r\n            return \"bizagi.util.dateFormatter.getDateFromInvariant('\" + bizagi.util.dateFormatter.formatInvariant(date) + \"').getTime()\";\r\n        }\r\n        if (argumentType == 'datetime') {\r\n            //Date\r\n            var date = bizagi.util.dateFormatter.getDateFromInvariant(argument, true);\r\n            if (!date || date == 0) {\r\n                date = new Date(0);\r\n            }\r\n            \r\n            date.setSeconds(0);\r\n            date.setMilliseconds(0);\r\n\r\n            return \"bizagi.util.dateFormatter.getDateFromInvariant('\" + bizagi.util.dateFormatter.formatInvariant(date, true) + \"', true).getTime()\";\r\n        }\r\n        if (argumentType == 'color') {\r\n            // Color\r\n            return \"'\" + argument.toString() + \"'\";\r\n        }\r\n        if (argumentType == 'entity') {\r\n\r\n            if (bizagi.util.isEmpty(argument)) {\r\n                return null;\r\n            }\r\n            try {\r\n                argument = typeof (argument) != \"object\" ? JSON.parse(argument) : argument;\r\n            } catch (e) {\r\n                argument = argument || {};\r\n            }\r\n\r\n\r\n            // Entity value\r\n            var result = argument.id || argument;\r\n            return JSON.stringify(result);\r\n        }\r\n        if (argumentType == 'xpath') {\r\n            // Xpath value\r\n            var xpath = argument.toString();\r\n\r\n            // Process grid xpaths\r\n            if (bGridDetected) {\r\n                xpath = xpath.replaceAll(\"[]\", \"[' + i + ']\");\r\n            }\r\n\r\n            if (xpathContext) {\r\n                xpath = xpathContext + \".\" + xpath;\r\n            }\r\n\r\n            return self.buildXpath(xpath, argumentType, bGridDetected);\r\n        }\r\n        if (argumentType == 'json') {\r\n            // Xpath value\r\n            return JSON.encode(argument);\r\n        }\r\n        if (argumentType == 'function') {\r\n            if (argument == \"BANow\") {\r\n                return \"self.getCurrentDate()\";\r\n            }\r\n            // If there is another function type code throw exception\r\n            throw \"There is no implementation for function \" + argument;\r\n        }\r\n\r\n        if (argumentType == undefined) {\r\n            return null;\r\n        }\r\n\r\n        // If there is another argument type code throw exception\r\n        throw \"There is no implementation for argument type \" + argumentType;\r\n    },\r\n    /*\r\n    *   Evals if an xpath is editable\r\n    */\r\n    isEditable: function (xpath) {\r\n        var self = this;\r\n        // For the submit action we need only one render to perform the server action\r\n        var render = self.getRender(xpath);\r\n        if (render == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        return render.properties.editable;\r\n    },\r\n\r\n    isVisible: function (xpath) {\r\n        var self = this;\r\n\r\n        var render = self.getRender(xpath);\r\n        if (render == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        if (render.properties.visible) {\r\n            return self.isParentVisible(render.parent);\r\n        } else {\r\n            var renderType = bizagi.util.normalizeType(render.properties.type);\r\n            if (/^hidden$/i.test(renderType)) {\r\n                return true;\r\n            } else {\r\n                return false;\r\n            }\r\n        }\r\n    },\r\n\r\n    isParentVisible: function (render) {\r\n        var self = this;\r\n        if (render.parent) {\r\n            if (render.properties.visible) {\r\n                return self.isParentVisible(render.parent);\r\n            } else {\r\n                return false;\r\n            }\r\n        } else {\r\n            return render.properties.visible;\r\n        }\r\n    },\r\n\r\n    /* \r\n    *   Evals an xpath to find a render and return its value\r\n    */\r\n    evalGridXpath: function(params, xpath, argumentType) {\r\n        var self = this;\r\n        \r\n        if (params === undefined){\r\n            return this.evalXpath(xpath, argumentType);\r\n        }\r\n\r\n        var grid = params.grid;\r\n\r\n        if (grid === undefined || grid === null){\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return null;    \r\n        }\r\n\r\n        // Grid renders\r\n        var gridXpath = self.processGridXpath(xpath);\r\n\r\n        // Return the value\r\n        var gridColumn = grid.getColumn(gridXpath.remainingXpath);\r\n\r\n        if (!gridColumn) {\r\n            return false;\r\n            //throw \"There is no a valid render for xpath \" + xpath;\r\n        }\r\n\r\n        var cellValue = grid.getCellCurrentValue(gridXpath.index, gridXpath.remainingXpath);\r\n\r\n        if (gridColumn.properties.type == \"columnRadio\") {\r\n            if (cellValue) {\r\n                if (cellValue.length > 0 && cellValue[0].length > 0)\r\n                    cellValue = cellValue[0][0];\r\n                else\r\n                    cellValue = cellValue.id;\r\n            }\r\n            else\r\n                cellValue = 0;\r\n        }\r\n\r\n        if (gridColumn.properties.type == \"columnCombo\") {\r\n            cellValue = (cellValue && cellValue.id) ? cellValue.id : 0;\r\n        }\r\n\r\n        if (gridColumn.properties.type == \"columnSearch\") {\r\n            cellValue = (cellValue && cellValue.id) ? cellValue.id : 0;\r\n        }\r\n\r\n        // Parse empty values\r\n        if (bizagi.util.isEmpty(cellValue)) {\r\n            // If the render is a boolean return false for actions\r\n            if (argumentType == \"boolean\") {\r\n                if (gridColumn.properties.display == \"check\") {\r\n                    return false;\r\n                } else {\r\n                    return null;\r\n                }\r\n            }\r\n        }\r\n\r\n        // Parse boolean and non-empty date types\r\n        if ((argumentType == \"boolean\") || (argumentType == \"date\" && !bizagi.util.isEmpty(self.getRender(xpath, argumentType).value))) {\r\n            return eval(self.buildArgument(cellValue, argumentType));\r\n        }\r\n\r\n        if (typeof (gridColumn) != \"undefined\" && typeof (gridColumn.properties) != \"undefined\" && typeof (gridColumn.properties.type) != \"undefined\" && gridColumn.properties.type == \"columnDate\")\r\n            cellValue = bizagi.util.dateFormatter.getDateFromInvariant(cellValue);\r\n\r\n        return cellValue;\r\n    },\r\n\r\n    /* \r\n    *   Evals an xpath to find a render and return its value\r\n    */\r\n    evalXpath: function (xpath, argumentType) {\r\n        var self = this, i, renderToEval;\r\n\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return null;\r\n        }\r\n\r\n        var rendersToEval = [];\r\n        $.each(renders, function (i, render) {\r\n            if (render.properties.editable) {\r\n                rendersToEval.push(render);\r\n            }\r\n        });\r\n\r\n        // If no render has been found skip editable validation\r\n        if (rendersToEval.length === 0) {\r\n            $.each(renders, function (i, render) {\r\n                rendersToEval.push(render);\r\n            });\r\n        }\r\n\r\n        i = 0;\r\n        while (i < rendersToEval.length) {\r\n            renderToEval = rendersToEval[i++];\r\n            var bIsGrid = (renderToEval.properties.type == 'grid');\r\n            if (!bIsGrid) {\r\n                // Normal renders\r\n                var value = renderToEval.getValue();\r\n                var renderType = bizagi.util.normalizeType(renderToEval.properties.type || \"\");\r\n\r\n                if (argumentType === undefined || argumentType === \"undefined\") {\r\n                    return value;\r\n                }\r\n\r\n                // If the render is a combo and the value is null return 0 for validations and actions\r\n                if ([\"combo\", \"list\", \"search\", \"radio\"].includes(renderType) || /^cascadingcombo$/i.test(renderType)) {\r\n                    if (bizagi.util.isEmpty(value) || value.id == \"\") {\r\n                        value = 0;\r\n                    }\r\n                }\r\n\r\n                if (renderType === \"comboSelected\") {\r\n                    return (typeof value === \"string\") ? JSON.parse(value).value : value;\r\n                }\r\n\r\n                if (bizagi.util.isEmpty(value)) {\r\n                    // If the render is a check and the value is null return false for validations and actions\r\n                    if (renderType === \"boolean\" && renderToEval.properties.display === \"check\") {\r\n                        return false;\r\n                    }\r\n\r\n                    if (bizagi.util.isEmpty(value)) {\r\n                        // If the render is a check and the value is null return false for validations and actions\r\n                        if (renderType === \"boolean\" && renderToEval.properties.display === \"check\") {\r\n                            return false;\r\n                        }\r\n                    }\r\n\r\n                    return value;\r\n                }\r\n\r\n                if (argumentType === \"xpath\") {\r\n                    return eval(self.buildArgument(xpath, argumentType));\r\n                } else {\r\n                    return eval(self.buildArgument(value, argumentType));\r\n                }                \r\n            } else {\r\n\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n\r\n                // Return the value\r\n                var gridColumn = renderToEval.getColumn(gridXpath.remainingXpath);\r\n\r\n                if (!gridColumn) {\r\n                    continue;\r\n                }\r\n\r\n                var cellValue = renderToEval.getCellCurrentValue(gridXpath.index, gridXpath.remainingXpath);\r\n\r\n                if (gridColumn.properties.type == \"columnRadio\") {\r\n                    if (cellValue) {\r\n                        if (cellValue.length > 0 && cellValue[0].length > 0)\r\n                            cellValue = cellValue[0][0];\r\n                        else\r\n                            cellValue = cellValue.id;\r\n                    }\r\n                    else\r\n                        cellValue = 0;\r\n                }\r\n\r\n                if (gridColumn.properties.type == \"columnCombo\") {\r\n                    cellValue = (cellValue && cellValue.id) ? cellValue.id : 0;\r\n                }\r\n\r\n                if (gridColumn.properties.type == \"columnSearch\") {\r\n                    cellValue = (cellValue && cellValue.id) ? cellValue.id : 0;\r\n                }\r\n\r\n                // Parse empty values\r\n                if (bizagi.util.isEmpty(cellValue)) {\r\n                    // If the render is a boolean return false for actions\r\n                    if (argumentType == \"boolean\") {\r\n                        if (gridColumn.properties.display == \"check\") {\r\n                            return false;\r\n                        } else {\r\n                            return null;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                // Parse boolean and non-empty date types\r\n                if ((argumentType == \"boolean\") || (argumentType == \"date\" && !bizagi.util.isEmpty(self.getRender(xpath, argumentType).value))) {\r\n                    return eval(self.buildArgument(cellValue, argumentType));\r\n                }\r\n\r\n                if (typeof (gridColumn) != \"undefined\" && typeof (gridColumn.properties) != \"undefined\" && typeof (gridColumn.properties.type) != \"undefined\" && gridColumn.properties.type == \"columnDate\")\r\n                    cellValue = bizagi.util.dateFormatter.getDateFromInvariant(cellValue);\r\n\r\n                return cellValue;\r\n            }\r\n\r\n            throw \"There is no a valid render for xpath \" + xpath;\r\n        }\r\n\r\n\r\n    },\r\n    /*\r\n    *   Check if the upload render has any files uploaded\r\n    */\r\n    isFileUploaded: function (xpath) {\r\n        var self = this;\r\n\r\n        var value = self.evalXpath(xpath);\r\n\r\n        if (value && value.length) {\r\n            if (value.length > 0)\r\n                return true;\r\n        }\r\n\r\n        return false;\r\n    },\r\n    /*\r\n    *   Check if a render has a valid email value\r\n    */\r\n    isValidEmail: function (value) {\r\n        var regex = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/gi;\r\n        if (value && value.match(new RegExp(regex))) {\r\n            return true;\r\n        }\r\n        return false;\r\n    },\r\n    /**\r\n    * Compare two elements, data of html and renderId to action\r\n    */\r\n    isButtonPressed: function (control, pressed) {\r\n        // Check if the control is a button\r\n        var render = this.getRenderById(control);\r\n        var renderType = bizagi.util.normalizeType(render.properties.type);\r\n        if (render === null || !/^button$/i.test(renderType)) return false;\r\n\r\n        return pressed;\r\n    },\r\n    /*\r\n    * Compare two elements, data of html and renderId to action\r\n    */\r\n    isGridButtonPressed: function (control, pressed) {\r\n        // Check if the control is a button\r\n        var arrGridXpath = this.processGridXpath(control);\r\n        var gridXpath = arrGridXpath.gridXpath;\r\n        var render = this.getRender(gridXpath);\r\n        var column = arrGridXpath.remainingXpath || \"\";\r\n\r\n\r\n        if (pressed && render && render.columns) {\r\n            $.each(render.columns, function (key, value) {\r\n                if ((value.properties.xpath === column || value.properties.id === column) && value.properties.type === \"columnButton\") {\r\n                    pressed = true;\r\n                }\r\n            });\r\n        }\r\n        return pressed;\r\n    },\r\n\r\n    /**\r\n    * Check if a control has been changed\r\n    */\r\n    isChanged: function (value, isChanged) {\r\n        if (value === undefined || value === null) {\r\n            return false;\r\n        }\r\n        return isChanged;\r\n    },\r\n\r\n    /**\r\n    * Check if a control has the item\r\n    */\r\n    includes: function (value, argument) {\r\n        if (typeof value == \"undefined\" || value === null) {\r\n            return false;\r\n        }\r\n        if (typeof argument == \"undefined\" || argument === null) {\r\n            return false;\r\n        }\r\n        var inArray = $.grep(value, function (e) {\r\n            return e.id == argument;\r\n        });\r\n        if (inArray.length > 0) {\r\n            return true;\r\n        }\r\n        return false\r\n    },\r\n\r\n    /**\r\n    *  Check if the grid has been deleted a row\r\n    */\r\n    onDeletedGridRow: function (xpath, rowDeleted) {\r\n        var self = this;\r\n        var grid = self.getRender(xpath) || {};\r\n\r\n        if (grid && rowDeleted) {\r\n            return true;\r\n        } else {\r\n            return false;\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Wrapper for get renders, return null if no renders have been found\r\n    */\r\n    getRenders: function (xpath) {\r\n        var self = this,\r\n            form = self.form,\r\n            regex = /id=([\\w-]+)/gi;\r\n        var renders = null;\r\n\r\n        // Check if the xpath is an id\r\n        var idMatches = regex.exec(xpath);\r\n        if (idMatches && idMatches.length > 1) {\r\n            var render = self.getRenderById(idMatches[1]);\r\n            if (render) {\r\n                if (render.length == 0)\r\n                    return null;\r\n                else {\r\n                    renders = [];\r\n                    renders.push(render);\r\n                    return renders;\r\n                }\r\n            } else {\r\n                return null;\r\n            }\r\n\r\n        }\r\n\r\n        renders = form.getRenders(xpath);\r\n        if (renders.length == 0)\r\n            return null;\r\n        return renders;\r\n    },\r\n    /*\r\n    *   Wrapper for get only one editable render\r\n    */\r\n    getRender: function (xpath) {\r\n        var self = this,\r\n            form = self.form;\r\n\r\n        return form.getRender(xpath);\r\n    },\r\n    /*\r\n    *   Wrapper to get a render by id\r\n    */\r\n    getRenderById: function (id) {\r\n        var self = this,\r\n            form = self.form;\r\n\r\n        return form.getRenderById(id);\r\n    },\r\n    /* \r\n    *   Helper function to detect metadata errors\r\n    */\r\n    showRenderNotFoundError: function (xpath) {\r\n        bizagi.debug(\"Cannot find render in DOM: \" + xpath);\r\n    },\r\n    /* \r\n    *   Helper function to detect metadata errors\r\n    */\r\n    showContainerNotFoundError: function (containerId) {\r\n        bizagi.debug(\"Cannot find container in DOM: \" + containerId);\r\n    },\r\n    /*\r\n    *   Returns the current date\r\n    */\r\n    getCurrentDate: function () {\r\n        var currentDate = new Date();\r\n\r\n        // Remove time\r\n        currentDate.setHours(0, 0, 0, 0);\r\n        return currentDate;\r\n    },\r\n    /*\r\n    *   Return the grid xpath parts\r\n    */\r\n    processGridXpath: function (xpath) {\r\n\r\n        // Eval using regular expressions\r\n        var regex = new RegExp(/([\\w\\.]*)\\[(\\d*)\\]\\.([\\w\\.|\\w-\\.]*)/g);\r\n        var matches = regex.exec(xpath);\r\n        var index, remainingXpath, gridXpath;\r\n        if (matches) {\r\n            gridXpath = matches[1];\r\n            index = matches[2];\r\n            remainingXpath = matches[3];\r\n        } else {\r\n            index = \"\";\r\n            remainingXpath = \"\";\r\n        }\r\n\r\n        return { xpath: xpath, index: index, remainingXpath: remainingXpath, gridXpath: gridXpath };\r\n    },\r\n    /*\r\n    *   Check if an action/validation contains reference to a grid\r\n    */\r\n    searchForGridReference: function (conditions, commands) {\r\n        var self = this;\r\n        var i;\r\n        // Check in conditions\r\n        if (conditions) {\r\n            return self.searchGridReferenceInCondition(conditions);\r\n        }\r\n\r\n        // Check in commands\r\n        if (commands) {\r\n            for (i in commands) {\r\n                var command = commands[i];\r\n                return self.searchForGridReferenceInCommand(command);\r\n            }\r\n        }\r\n\r\n        return null;\r\n    },\r\n    /*\r\n     *   Check if an action/validation contains reference to a grid\r\n     */\r\n    searchForGridReferenceInCommand: function(command){\r\n        if (command.xpath && command.xpath.indexOf(\"[]\") > 0) {\r\n            return command.xpath.substring(0, command.xpath.indexOf(\"[]\"));\r\n        }\r\n\r\n        // Check in argument if argumentType is xpath\r\n        if (command.argumentType == 'xpath') {\r\n            if (command.argument.indexOf(\"[]\") > 0) {\r\n                return command.argument.substring(0, command.argument.indexOf(\"[]\"));\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Check if a condition contains reference to a grid\r\n    */\r\n    searchGridReferenceInCondition: function (condition) {\r\n        var self = this;\r\n        var bGridReferenceFound;\r\n        if (typeof (condition) === \"string\" || typeof (condition) === \"boolean\")\r\n            return null;\r\n        if (condition.expressions) {\r\n            for (i in condition.expressions) {\r\n                if(condition.expressions.hasOwnProperty(i)) {\r\n                    bGridReferenceFound = self.searchGridReferenceInCondition(condition.expressions[i]);\r\n                    if (bGridReferenceFound)\r\n                        return bGridReferenceFound;\r\n                }\r\n            }\r\n\r\n        } else if (condition.simple) {\r\n            return self.searchGridReferenceInCondition(condition.simple);\r\n\r\n        } else if (condition.complex) {\r\n            return self.searchGridReferenceInCondition(condition.complex);\r\n        } else {\r\n            // Looking for grid reference within xpath\r\n            if (condition.xpath || condition.renderId) {\r\n                // Check in condition.xpath\r\n                bGridReferenceFound = self.searchGridReferenceInXpath(condition.xpath) || self.searchGridReferenceInXpath(condition.renderId);\r\n                if (bGridReferenceFound)\r\n                    return bGridReferenceFound;\r\n\r\n                // Check in argument if argumentType is xpath\r\n                if (condition.argumentType == 'xpath') {\r\n                    bGridReferenceFound = self.searchGridReferenceInXpath(condition.argument);\r\n                    if (bGridReferenceFound)\r\n                        return bGridReferenceFound;\r\n\r\n                }\r\n\r\n            }\r\n        }\r\n\r\n        return null;\r\n    },\r\n    /*\r\n    *   Check if a xpath contains a grid reference\r\n    */\r\n    searchGridReferenceInXpath: function (xpath) {\r\n        // Check in condition.xpath\r\n        if (xpath && xpath.indexOf(\"[]\") > 0) {\r\n            return xpath.substring(0, xpath.indexOf(\"[]\"));\r\n        }\r\n        return null;\r\n    },\r\n    getGridControl: function (xpath, surrogateKey) {\r\n        var self = this;\r\n        var remainingXpath = self.processGridXpath(xpath).remainingXpath;\r\n        var grid = self.getRender(xpath);\r\n        var column = grid.getControlCell(surrogateKey, remainingXpath);\r\n\r\n        return column;\r\n\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Rendering Validation controller\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will parse and execute all the validations defined for the form\r\n */\r\n\r\nbizagi.command.controllers.controller.extend(\"bizagi.command.controllers.validation\", {}, {\r\n\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (form, validations, mainForm) {\r\n        var self = this;\r\n\r\n        // Enable evalValidation function with console log trace\r\n        self.enableDebug = false;\r\n\r\n        // Call base\r\n        this._super(form);\r\n\r\n        var container = mainForm != undefined ? mainForm.container : form.container;\r\n\r\n        var validationBox = $('<div />').appendTo(container);\r\n\r\n        //Notifies that a modal view appear/disappear\r\n        $.widget( \"ui.bizagi_notifications\", $.ui.bizagi_notifications, {\r\n            expand: function() {\r\n                this._super();\r\n                self.form.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n            },\r\n            collapse: function() {\r\n                this._super();\r\n                self.form.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n            },\r\n            hide: function() {\r\n                this._super();\r\n                self.form.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n            }\r\n        });\r\n\r\n        // Apply plugin\r\n        validationBox.bizagi_notifications({\r\n            itemIcon: \"ui-icon-circle-close\",\r\n            minimized: false,\r\n            clearEnabled: false,\r\n            title: form.getResource(\"render-form-validations-header-text\"),\r\n            device: bizagi.util.detectDevice(),\r\n            orientation: form.properties.orientation\r\n\r\n        });\r\n\r\n        // Bind click\r\n        validationBox.bind(\"itemClick\", function (e, ui) {\r\n            self.onNotificationClick(ui.data);\r\n        });\r\n\r\n        // Build validations\r\n        if (validations)\r\n            self.buildValidations(validations);\r\n\r\n        // Keep references\r\n        self.validationBox = validationBox;\r\n        self.validations = validations || [];\r\n    },\r\n\r\n\r\n    /* \r\n    *   Method to incorporate automatic validation rules \r\n    */\r\n    buildValidations: function (validations) {\r\n        var self = this;\r\n        var fnValidations = self.buildAllValidations(validations);\r\n\t\r\n        self.form.bind(\"rendervalidate\", function () {\r\n            return fnValidations(self);\r\n        });\r\n    },\r\n\r\n    /* \r\n    *   Method to add a simple error message in the validation box\r\n    */\r\n    showErrorMessage: function (message) {\r\n        bizagi.showErrorAlertDialog = false;\r\n        this.showValidationMessage(message, null, \"ui-icon-circle-close\", \"ui-state-error\");\r\n    },\r\n\r\n    /* \r\n    *   Method to add a simple alert message in the validation box\r\n    */\r\n    showAlertMessage: function (message) {\r\n        this.showValidationMessage(message, null, \"ui-icon-alert\", \"ui-state-highlight\");\r\n    },\r\n\r\n    /* \r\n    *   Method to add a simple info message in the validation box\r\n    */\r\n    showInfoMessage: function (message) {\r\n        this.showValidationMessage(message, null, \"ui-icon-info\", \"ui-state-highlight\");\r\n    },\r\n\r\n    /* \r\n    *   Method to add a simple validation message in the validation box\r\n    */\r\n    showValidationMessage: function (message, focus, icon, itemAdditionalClass, type, renderId) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var render = null;\r\n\r\n        if (renderId) {\r\n            render = form.getRenderById(renderId) || null;\r\n        } else {\r\n            render = focus ? form.getRender(focus) : null;\r\n        }\r\n\r\n        bizagi.showErrorAlertDialog = false;\r\n\r\n        // Method to perform validations after the render has been changed, or the notifications has been clicked\r\n        var performValidationFn = function () {\r\n            // First hide and clear validation box\r\n            self.clearValidationMessages();\r\n\r\n            // Run validations\r\n            self.validating = true;\r\n            self.performValidations();\r\n            self.validating = false;\r\n\r\n            // Attempt to hide if there are no validations\r\n            if (self.countValidationMessages() == 0) {\r\n                self.hideValidationMessages();\r\n                self.form.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n            } else {\r\n                self.form.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n            }\r\n\r\n            form.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n        };\r\n\r\n        // Add message\r\n        self.validationBox.bizagi_notifications(\"addNotification\", message, focus, icon, itemAdditionalClass, performValidationFn, type, renderId);\r\n\r\n        if (render) {\r\n            // Add error message to render\r\n            render.setValidationMessage(message);\r\n\r\n            if (!bizagi.util.isIE8()) {\r\n\r\n                // Bind event when render change\r\n                if (!self.validating) render.one(\"rendervalidate\", performValidationFn);\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Count the number of validation messages\r\n    */\r\n    countValidationMessages: function () {\r\n        return this.validationBox.bizagi_notifications(\"count\");\r\n    },\r\n\r\n    /*\r\n    *   Remove all the validations\r\n    */\r\n    clearValidationMessages: function (params) {\r\n        var validationsBoxes = $(\".ui-bizagi-notifications-container\", \"body\").not(\".ui-bizagi-log-container\");\r\n\r\n        return validationsBoxes.bizagi_notifications(\"clearAll\", undefined, params);\r\n    },\r\n\r\n    /*\r\n    *   Hide the validation notifications box\r\n    */\r\n    hideValidationMessages: function () {\r\n        return this.validationBox.bizagi_notifications(\"hide\");\r\n    },\r\n\r\n    /*\r\n    *   Show the validation notifications box\r\n    */\r\n    showValidationMessages: function () {\r\n        return this.validationBox.bizagi_notifications(\"show\");\r\n    },\r\n\r\n    /*\r\n    *   Expand the notification box\r\n    */\r\n    expandNotificationBox: function (autofocus) {\r\n        // Select first error and expand notifications\r\n        if (autofocus !== false) this.validationBox.bizagi_notifications(\"autoFocusFirstError\");\r\n        return this.validationBox.bizagi_notifications(\"expand\");\r\n    },\r\n\r\n    isExpandedNotificationBox: function(){        \r\n        return this.validationBox.bizagi_notifications(\"isExpanded\") && this.validationBox.bizagi_notifications(\"isContentVisible\");\r\n    },\r\n\r\n    /*\r\n    *   Run all validation rules in the form container\r\n    */\r\n    performValidations: function (invalidElements) {\r\n        var self = this;\r\n\r\n        // First hide and clear validation box\r\n        self.clearValidationMessages();\r\n        self.validationBox.bizagi_notifications(\"initBatch\");\r\n\r\n        // Run render validations\r\n        var bRendersValid = self.validateRenders(invalidElements);\r\n\r\n        // Run form validations\r\n        var bFormValid = self.validations.length > 0 ? self.form.triggerHandler(\"rendervalidate\") : true;\r\n        self.validationBox.bizagi_notifications(\"endBatch\");\r\n\r\n        // Show validations if invalid\r\n        if (!bFormValid || !bRendersValid) {\r\n            self.validationBox.bizagi_notifications(\"show\");\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    /* PRIVATE METHODS */\r\n\r\n    /*  \r\n    *   Construct validations javascript rules\r\n    */\r\n    buildAllValidations: function (validations) {\r\n        var self = this;\r\n        var sJSCode = \"\";\r\n\r\n        for (var i = 0; i < validations.length; i++) {\r\n\r\n            var isEnabled = (validations[i].enabled != undefined ) ? validations[i].enabled : true;\r\n            if (isEnabled)\r\n            {\r\n                // If validation is not \"valid\" we can omit that instruction\r\n                try { sJSCode += self.buildValidation(validations[i].conditions, validations[i].validationCommand); } catch (e) {\r\n                    if (e.message != \"RenderNotFoundException\") {\r\n                        bizagi.logError(\"Validation cannot be parsed: \" + e.message, validations[i]);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Build final function\r\n        var sStatement = \"var baTmpFn = function(self, params){\\r\\n var bValid = true;\\r\\n \" + sJSCode + \"\\r\\n return bValid;}; baTmpFn\";\r\n\r\n        // Return interpreted function\r\n        return self.evalValidation(sStatement);\r\n    },\r\n\r\n    /*\r\n    *   Build a single javascript validation rule\r\n    */\r\n    buildValidation: function (conditions, validationCommand) {\r\n        var self = this;\r\n        var sJsCondition = \"\";\r\n        var sJsValidation = \"\";\r\n\r\n        // Detect grid references\r\n        var gridReference = self.searchForGridReference(conditions);\r\n        var bGridDetected = (gridReference != null);\r\n\r\n        // Build Conditions\r\n        sJsCondition += \"( \" + self.buildConditions(conditions, bGridDetected, true) + \" )\";\r\n\r\n        // Fix message for quotes and break lines\r\n        validationCommand.message = validationCommand.message.replace(/'/g, \"\\\\'\");\r\n        validationCommand.message = validationCommand.message.replace(/\\n/g, \" \");\r\n        \r\n        // Build Message\r\n        var focus = validationCommand.focus || \"\";\r\n        if (bGridDetected) focus = gridReference;\r\n        if (validationCommand.tokens)\r\n            sJsValidation += \"self.showValidationMessage(' \" + validationCommand.message + \"', '\" + focus + \"', JSON.parse('\" + JSON.encode(validationCommand.tokens) + \"')); bValid = false;\\r\\n\";\r\n        else\r\n            sJsValidation += \"self.showValidationMessage(' \" + validationCommand.message + \"', '\" + focus + \"'); bValid = false;\\r\\n\";\r\n\r\n        // Build final statement\r\n        if (!bGridDetected) {\r\n\r\n\r\n            return \"if (\" + sJsCondition + \"){\\r\\n \" + sJsValidation + \" \\r\\n}\";\r\n        } else {\r\n            var sGridStatement = \"var grid = self.form.getRender('\" + gridReference + \"');\\r\\n\";\r\n            sGridStatement += \"if(grid === null) return true;\\r\\n\";\r\n            sGridStatement += \"var data = grid.getIndexes();\\r\\n\";\r\n            sGridStatement += \"var bGridValid = true;\\r\\n\";\r\n            sGridStatement += \"$.each(data, function(_, i) {\\r\\n\";\r\n            sGridStatement += \"if (\" + sJsCondition + \"){\\r\\n bGridValid = false; \\r\\n}\";\r\n            sGridStatement += \"});\\r\\n\";\r\n            sGridStatement += \"if (bGridValid == false){\\r\\n \" + sJsValidation + \"\\r\\n}\";\r\n            return sGridStatement;\r\n        }\r\n    },\r\n\r\n    /* \r\n    *   Method triggered when the validation item has been clicked\r\n    */\r\n    onNotificationClick: function (data) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var xpath = data.focus;\r\n        var renderId = data.id;\r\n\r\n        if (xpath) {\r\n            var render = renderId ? form.getRenderById(renderId) : form.getRender(xpath);\r\n\r\n            if (render) {\r\n                render.focus();\r\n            }\r\n        }\r\n    },\r\n\r\n    /* \r\n    *   Method to loop\r\n    */\r\n    validateRenders: function (invalidElements) {\r\n        var self = this;\r\n        invalidElements = invalidElements || [];\r\n\r\n        // Do a check\r\n        var bValid = self.form.isValid(invalidElements);\r\n        if (!bValid) {\r\n            invalidElements.forEach(function(element){\r\n                if( element.id ) {\r\n                    // Parameters: message, xpath, icon, itemAdditionalClass, type, renderId\r\n                    self.showValidationMessageById(element.message, element.xpath, element.id);\r\n                } else if (element.message || element.xpath) {\r\n                    self.showValidationMessage(element.message, element.xpath);\r\n                }\r\n            });            \r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /*\r\n    *\tEval validation string, for debug purposes\r\n    */\r\n    evalValidation: function (command) {\r\n        var self = this;\r\n\r\n        if (self.enableDebug && console != undefined) {\r\n            console.log(command);\r\n        }\r\n\r\n        return eval(command);\r\n    },\r\n\r\n    /**\r\n     * Method to add a simple validation message in the validation box\r\n     * @param message\r\n     * @param xpath\r\n     * @param renderId\r\n     */\r\n    showValidationMessageById: function (message, xpath, renderId) {\r\n        this.showValidationMessage(message, xpath, undefined, false, undefined, renderId);\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: Bizagi Rendering Validation controller\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will parse and execute all the validations defined for the form\r\n */\r\n\r\nbizagi.command.controllers.controller.extend(\"bizagi.command.controllers.action\", {}, {\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (form, actions) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        this._super(form);\r\n\r\n        // Set a new hash containing all the dependencies subscribing the events\r\n        self.globalDependencies = {};\r\n        self.initialCallFunctions = {};\r\n        self.initialCallFunctionsDeferred = new $.Deferred();\r\n\r\n        // Build actions\r\n        if (actions)\r\n            self.buildActions(actions);\r\n\r\n        // Keep references\r\n        self.actions = actions;\r\n        self.internalSubmitActions = {};\r\n\r\n        // Set initial timer to trigger initial functions using a setTimeout, and distributing them in differente timespans\r\n        self.initialCallTimeout = 25;\r\n        self.initialCallIncrements = 25;\r\n        self.actionsHistory = {};\r\n        self.period = 50;\r\n    },\r\n    /*\r\n    *   Adds an internal submit action to be executed with all the given rules\r\n    */\r\n    processInternalSubmitAction: function (xpath, action) {\r\n        var self = this;\r\n\r\n        // if the action is registered, don't add it again\r\n        // only one internal submit action is allowed per control\r\n        if (self.internalSubmitActions[xpath])\r\n            return;\r\n\r\n        // Add to hash and build it\r\n        self.internalSubmitActions[xpath] = action;\r\n        self.buildAction(action, true);\r\n    },\r\n\r\n    isSummaryOrGlobalForm: function () {\r\n        var self = this;\r\n        var result = false;\r\n\r\n        if (self.form.properties.typeForm === \"SummaryForm\" || self.form.properties.typeForm === \"GlobalForm\") result = true;\r\n        return result;\r\n    },\r\n\r\n    evalClientAction: function (action) {\r\n        var self = this, i = 0, serverCommand = false, command;\r\n        var commands = [].concat(action.commands, action.elseCommands);\r\n        var length = commands.length;\r\n\r\n        for (; i < length; i++) {\r\n            command = commands[i];\r\n            if (!self.isClientAction(command)) {\r\n                serverCommand = true;\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (serverCommand) {\r\n            action.enabled = false;\r\n        }\r\n    },\r\n\r\n    /* Process all given  actions*/\r\n    buildActions: function (actions, dontExecute) {\r\n        var self = this, i, len;\r\n        var hashes = {};\r\n\r\n        var executeOnlyClientActions = self.isSummaryOrGlobalForm();\r\n\r\n        for (i = 0, len = actions.length; i < len; i++) {\r\n            // If action is not \"valid\" we can omit that instruction\r\n            try {\r\n                var action = actions[i];\r\n                var hash = bizagi.util.md5(JSON.stringify(action.conditions));\r\n                var hashC = bizagi.util.md5(JSON.stringify(action.commands));\r\n                if (hashes[hash]) {\r\n                    if (hashes[hash].indexOf(hashC) === -1) {\r\n                        // si la condicion es igual y los comandos diferentes\r\n                        executeOnlyClientActions && self.evalClientAction(action);\r\n                        self.buildAction(action, dontExecute);\r\n                        hashes[hash].push(hashC);\r\n                    }\r\n                } else {\r\n                    executeOnlyClientActions && self.evalClientAction(action);\r\n                    self.buildAction(action, dontExecute);\r\n                    hashes[hash] = [hashC];\r\n                }\r\n            } catch (e) {\r\n                // Handle the exception\r\n                if (e.message !== \"RenderNotFoundException\") {\r\n                    bizagi.logError(\"Action cannot be parsed: \" + e.message, actions[i]);\r\n                }\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    *   Remove all current handlers\r\n    */\r\n    unbindActions: function () {\r\n        var self = this;\r\n\r\n        // Remove all previous handlers\r\n        $.each(self.globalDependencies, function (i, render) {\r\n            render.unbind(\"renderchange.action\");\r\n        });\r\n\r\n        self.globalDependencies = {};\r\n\r\n        // Reset timers and collections\r\n        $.each(self.initialCallFunctions, function (i, handle) {\r\n            clearTimeout(handle);\r\n        });\r\n        self.initialCallFunctions = {};\r\n    },\r\n    /* \r\n    *   Re-execute actions, cleaning the handlers first\r\n    */\r\n    refreshActions: function (newActions) {\r\n        var self = this;\r\n\r\n        self.initialCallTimeout = 25;\r\n        self.initialCallFunctions = {};\r\n\r\n        newActions = newActions || [];\r\n\r\n        // Build the actions again\r\n        self.actions = self.actions.concat(newActions);\r\n        self.buildActions(self.actions, true);\r\n\r\n        // Build internal actions again\r\n        $.each(self.internalSubmitActions, function (_, action) {\r\n            try {\r\n                self.buildAction(action, false);\r\n            } catch (e) {\r\n                // Handle the exception\r\n                if (e.message !== \"RenderNotFoundException\") {\r\n                    bizagi.logError(\"Action cannot be parsed: \" + e.message, action);\r\n                }\r\n            }\r\n        });\r\n    },\r\n    /* Process a single action*/\r\n    buildAction: function (action, dontExecute) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var dependencies = [];\r\n        var dependenciesId = [];\r\n\r\n        var isEnabled = (action.enabled != undefined) ? action.enabled : true;\r\n\r\n        if (!isEnabled) return;\r\n\r\n        // If the condition operator is true, we gotta dig in the actions to check if it modifies a grid\r\n        // To include an auto-dependency, so each time the grid is changed that condition will be executed\r\n        if (action.conditions && action.conditions.operator == \"true\") {\r\n            if (!action.dependencies)\r\n                action.dependencies = [];\r\n            $.each(action.commands, function (_, command) {\r\n                var gridReference = self.searchGridReferenceInXpath(command.xpath);\r\n                if (gridReference) {\r\n                    var dependencyAlreadyAdded = false, j, len;\r\n                    for (j = 0, len = action.dependencies; j < len; j++) {\r\n                        if (action.dependencies[j] == gridReference)\r\n                            dependencyAlreadyAdded = true;\r\n                    }\r\n                    if (!dependencyAlreadyAdded)\r\n                        action.dependencies.push(gridReference);\r\n                }\r\n            });\r\n        }\r\n\r\n        function isValidDependency(type) {\r\n            var notValid = [\"groupedgrid\", \"collectionnavigator\"];\r\n            if (notValid.indexOf(type) === -1) {\r\n                return true;\r\n            } else {\r\n                return false;\r\n            }\r\n        }\r\n\r\n\r\n        // Find dependencies to attach triggers\r\n        if (action.dependencies) {\r\n            for (var i = 0; i < action.dependencies.length; i++) {\r\n                if (typeof action.dependencies[i] != \"undefined\") {\r\n                    var renders = form.getRenders(action.dependencies[i]);\r\n                    if (renders.length === 0) {\r\n                        var renderById = form.getRenderById(action.dependencies[i]);\r\n                        renders = (renderById) ? [renderById] : null;\r\n                    }\r\n\r\n                    if (renders) {\r\n                        $.each(renders, function (_, render) {\r\n                            if ($.inArray(render.properties.id, dependenciesId) < 0) {\r\n                                if (isValidDependency(render.properties.type)) {\r\n                                    dependenciesId.push(render.properties.id);\r\n                                    dependencies.push(render);\r\n                                }\r\n                            }\r\n                        });\r\n\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Build anonymous function\r\n        var fn = self.buildFunction(action.conditions, action.commands, action.elseCommands);\r\n\r\n        // Attach handlers\r\n        $.each(dependencies, function (_, render) {\r\n            render.bind(\"renderchange.action\", function (ev, args) {\r\n                args = args || {};\r\n\r\n                // Default changed argument to true\r\n                args.changed = args.changed !== undefined ? args.changed : true;\r\n\r\n                // If a grid action has been performed, try to filter it by column, to avoid execute all grid actions each time                \r\n                if (args.column) {\r\n                    for (var j = 0; j < action.gridColumns.length; j++) {\r\n                        if (args.column == action.gridColumns[j]) {\r\n                            // Call function\r\n                            fn(self, args);\r\n                            return;\r\n                        }\r\n                    }\r\n                } else {\r\n                    // Call function\r\n                    fn(self, args);\r\n                }\r\n            });\r\n\r\n            // Add to global dependencies hash\r\n            self.globalDependencies[render.properties.id] = render;\r\n\r\n            // If render is a grid ... trigger function at this point\r\n            if (render.properties.type === 'grid') {\r\n                dontExecute = true;\r\n\r\n                // Search column dependencies\r\n                action.gridColumns = [];\r\n                self.searchGridColumns(action.conditions, action.gridColumns);\r\n            }\r\n        });\r\n\r\n        // Check if it has to execute\r\n        if (dontExecute)\r\n            return;\r\n\r\n        // Execute the action because it must execute when the page loads with pre-defined value\r\n        // Create an async function to trigger it later\r\n        var asyncFn = function (self) {\r\n\r\n            var guid = Math.guid();\r\n            // Create the timeout\r\n            var handle = setTimeout(function () {\r\n                try {\r\n                    // TODO: Define render to set parameter to \"fn\" function\r\n                    fn(self);\r\n                    delete self.initialCallFunctions[guid];\r\n                } catch (e) {\r\n                }\r\n            }, self.initialCallTimeout);\r\n\r\n            // Save a reference\r\n            self.initialCallFunctions[guid] = handle;\r\n            self.initialCallTimeout += self.initialCallIncrements;\r\n        };\r\n\r\n        // Run it\r\n        asyncFn(self);\r\n    },\r\n    /*\r\n    * Creates the function to execute based on the action metadata\r\n    */\r\n    buildFunction: function (conditions, commands, elseCommands) {\r\n        var self = this;\r\n\r\n        var gridReference = self.searchForGridReference(conditions, commands);\r\n        var bGridDetected = (gridReference != null) ? gridReference : false;\r\n        var sJsCondition = \"\";\r\n        var sJsAction = \"\";\r\n        var sStatement;\r\n        var sJsElseAction = \"\";\r\n        var bAutomaticRestore = elseCommands ? false : true;\r\n        var bCondition = conditions ? true : false;\r\n        var i;\r\n\r\n        // Build Condition\r\n        if (bCondition) {\r\n            sJsCondition += self.buildConditions(conditions, bGridDetected);\r\n        }\r\n\r\n        // Build and execute actions\r\n        for (i = 0; i < commands.length; i++) {\r\n            // Parse command\r\n            var queueAction = self.isServerCommand(commands[i]) ? \"addParallel\" : \"add\";\r\n            var command = self.buildCommand(commands[i], bGridDetected);\r\n\r\n            // Check if command ending with semicolon and remove it\r\n            command = (command.indexOf(\";\") >= 1) ? command.replace(\";\", \"\") : command;\r\n            sJsAction += \"actionQueue.\" + queueAction + \"(function(){return \" + command + \" ;}); \\r\\n\";\r\n\r\n            if (bAutomaticRestore) {\r\n                sJsElseAction += self.buildRestoreCommand(commands[i], bGridDetected);\r\n            }\r\n        }\r\n\r\n        // Build non-automatic else commands\r\n        if (!bAutomaticRestore) {\r\n            sJsElseAction += \"var actionQueue = new bizagiQueue(); \\r\\n\";\r\n            sJsElseAction += \"if (params.render){params.render.startActionExecution();} \\r\\n\";\r\n            for (i = 0; i < elseCommands.length; i++) {\r\n                var queueAction = self.isServerCommand(elseCommands[i]) ? \"addParallel\" : \"add\";\r\n                var elseCommand = self.buildCommand(elseCommands[i], bGridDetected);\r\n                // Check if command ending with semicolon and remove it\r\n                elseCommand = (elseCommand.indexOf(\";\") >= 1) ? elseCommand.replace(\";\", \"\") : elseCommand;\r\n                sJsElseAction += \"actionQueue.\" + queueAction + \"(function(){return \" + elseCommand + \" ;}); \\r\\n\";\r\n            }\r\n            sJsElseAction += \"var execute = actionQueue.execute().always(function(){ \\r\\n\";\r\n            sJsElseAction += \"if (params.render){ params.render.endActionExecution();} \\r\\n });\\r\\n\";\r\n            sJsElseAction += \"self.form.appendWaitForLoader({ promise: execute, create: true });\\r\\n\";\r\n        }\r\n\r\n        // Build final function\r\n        //sStatement = \"var baTmpFn = function(self, i, column){ \\r\\n\";\r\n        sStatement = \"var baTmpFn = function(self, params){ \\r\\n\";\r\n        sStatement += \"params = params || {};\\r\\n\";\r\n        if (bGridDetected) {\r\n            sStatement += \"var i = params.key;\\r\\n\";\r\n            sStatement += \"var column = params.column;\\r\\n\";\r\n        }\r\n        if (bCondition) {\r\n            sStatement += \"if (\" + sJsCondition + \"){ \\r\\n\";\r\n        }\r\n\r\n        // Creates defferreds\r\n        sStatement += \"var actionQueue = new bizagiQueue(); \\r\\n\";\r\n        sStatement += \"if (params.render){params.render.startActionExecution();} \\r\\n\";\r\n        sStatement += sJsAction;\r\n        sStatement += \"var execute = actionQueue.execute().always(function(){ \\r\\n\";\r\n        sStatement += \"if (params.render){ params.render.endActionExecution();} \\r\\n });\\r\\n\";\r\n        sStatement += \"self.form.appendWaitForLoader({ promise: execute, create: true });\\r\\n\";\r\n\r\n        if (bCondition) {\r\n            sStatement += \"\\r\\n } \";\r\n            if (sJsElseAction.length > 0) {\r\n                sStatement += \"else { \\r\\n\" + sJsElseAction + \" }\\r\\n\";\r\n            }\r\n        }\r\n\r\n        sStatement += \"};\\r\\n\";\r\n\r\n\r\n        if (!bGridDetected) {\r\n            sStatement += \"baTmpFn\";\r\n        } else {\r\n            var sGridStatement = \"var baGridTmpFn = function(self, args){ \\r\\n\";\r\n            sGridStatement += \"args = args || {};\\r\\n\";\r\n            sGridStatement += \"\\t var grid = args.render || self.form.getRender('\" + gridReference + \"') || []; \\r\\n\";\r\n            sGridStatement += \"\\t grid = grid.grid ? grid : (self.form.getRender('\" + gridReference + \"') || []); \\r\\n\";\r\n            sGridStatement += \"\\t args.grid = grid; \\r\\n\";\r\n            sGridStatement += \"if(args.surrogateKey === undefined){\\r\\n\";\r\n            sGridStatement += \"\\t var data = grid.getIndexes();\\r\\n\";\r\n            sGridStatement += \"\\t $.each(data, function(i, index) {\\r\\n\";\r\n            sGridStatement += \"\\t\\t args.key = index; \\r\\n\";\r\n            sGridStatement += \"\\t\\t baTmpFn(self, args);\\r\\n\";\r\n            sGridStatement += \"\\t });\\r\\n\";\r\n            sGridStatement += \"} else {\\r\\n\";\r\n            sGridStatement += \"\\t args.key = args.surrogateKey; \\r\\n\";\r\n            sGridStatement += \"\\t\\t baTmpFn(self, args ); \\r\\n\";\r\n            sGridStatement += \"}\\r\\n\";\r\n            sGridStatement += \"};\\r\\n\";\r\n            sStatement += sGridStatement;\r\n            sStatement += \"baGridTmpFn\";\r\n        }\r\n\r\n        // Return interpreted function\r\n        return eval(sStatement);\r\n    },\r\n\r\n    /*\r\n    *   This method checks if a command must be performed by the client, or by the server\r\n    */\r\n    isServerCommand: function (command) {\r\n        var commandType = command.command;\r\n\r\n        return [\"refresh\", \"submit-data\", \"execute-rule\", \"execute-interface\", \"execute-sap\", \"execute-connector\", \"execute-excel-bot\"].includes(commandType);\r\n    },\r\n\r\n    isClientAction: function (command) {\r\n        var commandType = command.command;\r\n\r\n        return [\"background-color\", \"forecolor\", \"visible\", \"required\", \"collapse\", \"set-active\"].includes(commandType);\r\n    },\r\n\r\n    isRecentAction: function (prefix, command) {\r\n        var self = this;\r\n        var tag = prefix + \"@\" + command;\r\n        if (self.actionsHistory[tag] != null) {\r\n            return true;\r\n        }\r\n        $.when(self.runAction(prefix, command)).done(function () {\r\n            delete self.actionsHistory[tag];\r\n            bizagi.log(\"resolve \" + tag);\r\n        });\r\n        return false;\r\n    },\r\n\r\n    runAction: function (prefix, command) {\r\n        var self = this;\r\n        var tag = prefix + \"@\" + command;\r\n        self.actionsHistory[tag] = new $.Deferred();\r\n        setTimeout(self.actionsHistory[tag].resolve, self.period);\r\n        return self.actionsHistory[tag].promise();\r\n    },\r\n    /*\r\n    *   Builds the action JS\r\n    */\r\n    buildCommand: function (command, bGridDetected) {\r\n        var self = this;\r\n\r\n        // Define if a grid has been detected\r\n        bGridDetected = bGridDetected || false;\r\n\r\n        var gridReference = bGridDetected;\r\n\r\n        // Parse argument\r\n        var commandType = command.command;\r\n        var detectedArgumentType = self.detectCommandArgumentType(command.argumentType, commandType);\r\n        var argument = self.buildArgument(command.argument, detectedArgumentType, bGridDetected, command.xpathContext);\r\n        var xpath = command.xpath;\r\n\r\n\r\n        // If a render id is given, we use it with priority over only xpath\r\n        if (command.renderId) {\r\n            xpath = \"id=\" + command.renderId + \"\";\r\n        }\r\n\r\n        // Process grid xpaths\r\n        if (bGridDetected && xpath) {\r\n            xpath = xpath.replaceAll(\"[]\", \"[' + i + ']\");\r\n        }\r\n\r\n        if ((command.xpath && command.xpath.length > 0) || (command.renderId && command.renderId.length > 0)) {\r\n            // Build render command\r\n            switch (commandType) {\r\n                case 'background-color':\r\n                    if (command.controlType === \"activityFlowButton\") {\r\n                        return \"self.changeButtonBackground('\" + xpath + \"', \" + argument + \");\";\r\n                    } else {\r\n                        return \"self.changeRenderBackground('\" + xpath + \"', \" + argument + \");\";\r\n                    }\r\n                    break;\r\n                case 'forecolor':\r\n                    if (command.controlType === \"activityFlowButton\") {\r\n                        return \"self.changeButtonForeground('\" + xpath + \"', \" + argument + \");\";\r\n                    } else {\r\n                        return \"self.changeRenderForeground('\" + xpath + \"', \" + argument + \");\";\r\n                    }\r\n                    break;\r\n                case 'visible':\r\n                    if (command.controlType === \"activityFlowButton\") {\r\n                        return \"self.changeButtonVisibility('\" + xpath + \"', \" + argument + \");\";\r\n                    } else {\r\n                        return \"self.changeRenderVisibility('\" + xpath + \"', \" + argument + \");\";\r\n                    }\r\n                    break;\r\n                case 'readonly':\r\n                    if (command.controlType === \"activityFlowButton\") {\r\n                        return \"self.changeButtonEditability('\" + xpath + \"', \" + argument + \");\";\r\n                    } else {\r\n                        return \"self.changeRenderEditability('\" + xpath + \"', \" + argument + \");\";\r\n                    }\r\n                    break;\r\n                case 'required':\r\n                    return \"self.changeRenderRequired('\" + xpath + \"', \" + argument + \");\";\r\n                    break;\r\n                case 'set-value':\r\n                    // Check specific argument type\r\n                    if (bGridDetected && command.argumentType === \"xpath\" && !!command.xpathContext) {\r\n                        // When we are going to evaluate a xpath is necessary add a xpathcontext if it exist\r\n                        command.argument = command.xpathContext + \".\" + command.argument;\r\n                        argument = self.buildArgument(command.argument, detectedArgumentType, bGridDetected);\r\n                    }\r\n\r\n                    return \"self.changeRenderValue('\" + xpath + \"', \" + argument + \");\";\r\n                    break;\r\n                case 'set-min':\r\n                    return \"self.changeRenderMinValue('\" + xpath + \"', \" + argument + \");\";\r\n                    break;\r\n                case 'set-max':\r\n                    return \"self.changeRenderMaxValue('\" + xpath + \"', \" + argument + \");\";\r\n                    break;\r\n                case 'calculate':\r\n                    return \"self.executeCalculatedField('\" + xpath + \"');\";\r\n                    break;\r\n                case 'submit-value':\r\n                    return \"self.submitRender('\" + xpath + \"', '\" + argument + \"');\";\r\n                    break;\r\n                case 'clean-data':\r\n                    return \"self.cleanRenderData('\" + xpath + \"');\";\r\n                    break;\r\n\r\n                // New Features                                        \r\n                case 'refresh':\r\n                    var commandGridDetected = self.searchForGridReferenceInCommand(command);\r\n\r\n                    if (commandGridDetected) {\r\n                        return \"self.refreshGridCell('\" + xpath + \"', \" + \"'\" + (command.xpathContext || \"\") + \"'\" + \");\";\r\n                    } else {\r\n                        return \"self.refreshControl('\" + xpath + \"', \" + \"'\" + (command.xpathContext || \"\") + \"','\" + commandType + \"');\";\r\n                    }\r\n                    break;\r\n                case 'trigger-click':\r\n                    return \"self.triggerClick('\" + xpath + \"');\";\r\n                    break;\r\n\r\n            }\r\n        } else {\r\n            // Build container command\r\n            switch (commandType) {\r\n                case 'background-color':\r\n                    return \"self.changeContainerBackground('\" + command.container + \"', \" + argument + \");\";\r\n                    break;\r\n                case 'visible':\r\n                    return \"self.changeContainerVisibility('\" + command.container + \"', \" + argument + \");\";\r\n                    break;\r\n                case 'collapse':\r\n                    return \"self.toogleContainer('\" + command.container + \"', \" + !bizagi.util.parseBoolean(argument) + \");\";\r\n                    break;\r\n                case 'set-active':\r\n                    return \"self.changeActiveItem('\" + command.container + \"');\";\r\n                    break;\r\n                case 'readonly':\r\n                    return \"self.changeContainerEditability('\" + command.container + \"', \" + bizagi.util.parseBoolean(argument) + \");\";\r\n                    break;\r\n\r\n                // New Features                                        \r\n                case 'refresh':\r\n                    // Set prepare parameter to multiaction purposes \r\n                    return \"self.refreshContainer('\" + command.container + \"', \" + \"'\" + (command.xpathContext || \"\") + \"'\" + \");\";\r\n                    break;\r\n            }\r\n        }\r\n\r\n        // Global  actions without specific target\r\n        if (commandType === 'submit-data') {\r\n            return \"self.submitFormData();\";\r\n        }\r\n\r\n        if (commandType === 'execute-rule') {\r\n            var ruleObj = command.argument || {};\r\n            var guidRule = \"\";\r\n            try {\r\n                guidRule = JSON.parse(ruleObj).guid;\r\n            } catch (e) {\r\n            }\r\n\r\n            var xpathContext = command.xpathContext || \"\";\r\n            if (bGridDetected) {\r\n                var xpathContextRow = gridReference + \"[id=%s]\";\r\n                return \"self.executeRule('\" + guidRule + \"', printf('\" + xpathContextRow + \"',i) ,'\" + commandType + \"');\";\r\n            } else {\r\n                return \"self.executeRule('\" + guidRule + \"','\" + xpathContext + \"','\" + commandType + \"');\";\r\n            }\r\n        }\r\n\r\n        if (commandType === 'execute-interface') {\r\n            var interfaceObj = command.argument || {};\r\n            var guidInterface = \"\";\r\n\r\n            try {\r\n                guidInterface = JSON.parse(interfaceObj).guid;\r\n            } catch (e) {\r\n            }\r\n\r\n            xpathContext = command.xpathContext || \"\";\r\n            if (bGridDetected) {\r\n                xpathContextRow = gridReference + \"[id=%s]\";\r\n                return \"self.executeInterface('\" + guidInterface + \"', printf('\" + xpathContextRow + \"',i));\";\r\n            } else {\r\n                return \"self.executeInterface('\" + guidInterface + \"','\" + xpathContext + \"');\";\r\n            }\r\n        }\r\n\r\n        if (commandType === 'execute-sap') {\r\n            var connectorObj = command.argument || {};\r\n            var guidsap = \"\";\r\n\r\n            try {\r\n                guidsap = JSON.parse(connectorObj).guid;\r\n            } catch (e) {\r\n            }\r\n\r\n            xpathContext = command.xpathContext || \"\";\r\n            if (bGridDetected) {\r\n                xpathContextRow = gridReference + \"[id=%s]\";\r\n                return \"self.executeSAPConnector('\" + guidsap + \"', printf('\" + xpathContextRow + \"',i));\";\r\n            } else {\r\n                return \"self.executeSAPConnector('\" + guidsap + \"','\" + xpathContext + \"');\";\r\n            }\r\n        }\r\n\r\n        if (commandType === 'execute-connector' || commandType === 'execute-excel-bot') {\r\n            var connectorObj = command.argument || {};\r\n            var guidConnector = \"\";\r\n\r\n            try {\r\n                guidConnector = JSON.parse(connectorObj).guid;\r\n            } catch (e) {\r\n            }\r\n\r\n            xpathContext = command.xpathContext || \"\";\r\n            if (bGridDetected) {\r\n                xpathContextRow = gridReference + \"[id=%s]\";\r\n                return \"self.executeConnector('\" + guidConnector + \"', printf('\" + xpathContextRow + \"',i));\";\r\n            } else {\r\n                return \"self.executeConnector('\" + guidConnector + \"','\" + xpathContext + \"');\";\r\n            }\r\n        }\r\n\r\n        bizagi.log(\"There is no definition for commandType: \" + commandType);\r\n        return \"\";\r\n    },\r\n    /* \r\n    *   Builds the JS command to restore automatically a command when condition is not met\r\n    */\r\n    buildRestoreCommand: function (command, bGridDetected) {\r\n        var xpath = command.xpath;\r\n        var commandType = command.command;\r\n\r\n        // Define if a grid has been detected\r\n        bGridDetected = bGridDetected || false;\r\n\r\n        // If a render id is given, we use it with priority over only xpath\r\n        if (command.renderId) {\r\n            xpath = \"id=\" + command.renderId + \"\";\r\n        }\r\n\r\n        // Process grid xpaths\r\n        if (bGridDetected) {\r\n            xpath = xpath.replaceAll(\"[]\", \"[' + i + ']\");\r\n        }\r\n\r\n        // Build restore action\r\n        if (xpath && xpath.length > 0) {\r\n            return \"self.restoreRender('\" + xpath + \"', '\" + commandType + \"');\";\r\n        } else {\r\n            return \"self.restoreContainer('\" + command.container + \"', '\" + commandType + \"');\";\r\n        }\r\n    },\r\n    /* \r\n    *   Detect the command argument type based on the command type\r\n    */\r\n    detectCommandArgumentType: function (argumentType, commandType) {\r\n        if (argumentType === undefined) {\r\n            return argumentType;\r\n\r\n        } else if (argumentType == \"const\") {\r\n\r\n            if (commandType == 'background-color')\r\n                return 'color';\r\n            if (commandType == 'forecolor')\r\n                return 'color';\r\n            if (commandType == 'visible')\r\n                return 'boolean';\r\n            if (commandType == 'readonly')\r\n                return 'boolean';\r\n            if (commandType == 'required')\r\n                return 'boolean';\r\n            if (commandType == 'set-value')\r\n                return 'text';\r\n            if (commandType == 'collapse')\r\n                return 'boolean';\r\n            if (commandType == 'set-active')\r\n                return 'number';\r\n            if (commandType == 'set-min')\r\n                return 'text';\r\n            if (commandType == 'set-max')\r\n                return 'text';\r\n            if (commandType == 'calculate')\r\n                return undefined;\r\n            if (commandType == 'refresh')\r\n                return undefined;\r\n            if (commandType == 'submit-value')\r\n                return 'json';\r\n\r\n        } else if (argumentType === \"xpath\" || argumentType === \"entity\") {\r\n            return argumentType;\r\n        }\r\n\r\n        bizagi.log(\"There is no definition for commandType: \" + commandType);\r\n        return null;\r\n    },\r\n    /* \r\n    *   Builds the JS command to restore a render when condition is not met\r\n    */\r\n    restoreRender: function (xpath, commandType) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            var properties = render.originalProperties;\r\n            var textFormat = properties.textFormat || {};\r\n            if (commandType == 'background-color')\r\n                self.changeRenderBackground(xpath, textFormat.background || '');\r\n            if (commandType == 'forecolor')\r\n                self.changeRenderForeground(xpath, textFormat.color || 'none');\r\n            if (commandType == 'visible')\r\n                self.changeRenderVisibility(xpath, properties.visible != undefined ? properties.visible : true);\r\n            if (commandType == 'readonly')\r\n                self.changeRenderEditability(xpath, properties.editable != undefined ? properties.editable : true);\r\n            if (commandType == 'required')\r\n                self.changeRenderRequired(xpath, properties.required != undefined ? properties.required : false);\r\n            // NOte: Command 6 does not have restoration\r\n        });\r\n    },\r\n    /* \r\n    *   Builds the JS command to restore a container when condition is not met\r\n    */\r\n    restoreContainer: function (containerId, commandType) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var container = form.getContainer(containerId);\r\n        if (container == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showContainerNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        var properties = container.originalProperties;\r\n        if (commandType == 'background-color')\r\n            self.changeContainerBackground(containerId, properties.backgroundColor || 'none');\r\n        if (commandType == 'visible')\r\n            self.changeContainerVisibility(containerId, properties.visible != undefined ? properties.visible : true);\r\n        if (commandType == 'collapse')\r\n            self.toogleContainer(containerId, true);\r\n        // NOte: Command 8 does not have restoration\r\n        if (commandType == 'readonly')\r\n            self.changeContainerEditability(containerId, properties.editable != undefined ? properties.editable : true);\r\n    },\r\n    /* \r\n    *   Sets a new color for the background of the render\r\n    *   Applies also to grid cells!\r\n    */\r\n    changeRenderBackground: function (xpath, argument) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            //Detects if is the grid component, and set the desired properties\r\n            if (!self.isGridComponent(render, xpath)) {\r\n                // Normal renders\r\n                $.when(render.ready()).done(function () {\r\n                    render.changeBackgroundColor(argument);\r\n                });\r\n\r\n            } else {\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n                $.when(render.ready()).done(function () {\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        render.changeCellBackgroundColor(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                    } else {\r\n                        var indexes = render.getIndexes(), j, lenIndex;\r\n                        for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                            render.changeCellBackgroundColor(indexes[j], gridXpath.remainingXpath, argument);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    /*\r\n     *   Sets a new color for the background of the button\r\n     *   Applies also to grid cells!\r\n     */\r\n    changeButtonBackground: function (xpath, argument) {\r\n        var self = this;\r\n        var guid = xpath.substring(3);\r\n        var element = self.form.getButton(guid);\r\n\r\n        element.css(\"background-image\", \"none\");\r\n        element.addClass(\"ui-fast-transition\");\r\n\r\n        if (typeof (element[0]) !== \"undefined\") {\r\n            element[0].style.setProperty(\"background-color\", argument, \"important\");\r\n        }\r\n    },\r\n\r\n    /* \r\n    *   Sets a new color for the foreground of the render\r\n    */\r\n    changeRenderForeground: function (xpath, argument) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            //Detects if is the grid component, and set the desired properties\r\n            if (!self.isGridComponent(render, xpath)) {\r\n                // Normal renders\r\n                $.when(render.ready()).done(function () {\r\n                    render.changeColor(argument);\r\n                });\r\n\r\n            } else {\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n                $.when(render.ready()).done(function () {\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        render.changeCellColor(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                    } else {\r\n                        var indexes = render.getIndexes(), j, lenIndex;\r\n                        for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                            render.changeCellColor(indexes[j], gridXpath.remainingXpath, argument);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    /*\r\n     *   Sets a new color for the foreground of the render\r\n     */\r\n    changeButtonForeground: function (xpath, argument) {\r\n        var self = this;\r\n        var guid = xpath.substring(3);\r\n        var element = self.form.getButton(guid);\r\n        element.css(\"color\", argument, \"!important\");\r\n    },\r\n    /* \r\n    *   Changes the visibility of the render\r\n    */\r\n    changeRenderVisibility: function (xpath, argument) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            //Detects if is the grid component, and set the desired properties\r\n            if (!self.isGridComponent(render, xpath)) {\r\n                // Normal renders\r\n                $.when(render.ready()).done(function () {\r\n                    $.when(render.renderingDeferred).done(function () {\r\n                        render.changeVisibility(argument);\r\n                    });\r\n                });\r\n            } else {\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n                $.when(render.ready()).done(function () {\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        render.changeCellVisibility(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                    } else {\r\n                        var indexes = render.getIndexes(), j, lenIndex;\r\n                        for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                            render.changeCellVisibility(indexes[j], gridXpath.remainingXpath, argument);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    /*\r\n     *   Changes the visibility of the button\r\n     */\r\n    changeButtonVisibility: function (xpath, argument) {\r\n        var self = this;\r\n        var guid = xpath.substring(3);\r\n        var element = self.form.getButton(guid);\r\n        if (bizagi.util.parseBoolean(argument) == true) {\r\n            element.show();\r\n            element.css(\"display\", \"\");\r\n        } else {\r\n            element.hide();\r\n        }\r\n    },\r\n    /* \r\n    *   Changes the editability of the render\r\n    */\r\n    changeRenderEditability: function (xpath, argument) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            // execute commands over valid renders\r\n            if (self.isValidRender(render)) {\r\n                //Detects if is the grid component, and set the desired properties\r\n                if (!self.isGridComponent(render, xpath)) {\r\n                    // Normal renders\r\n                    $.when(render.ready()).done(function () {\r\n                        $.when(render.renderingDeferred).done(function () {\r\n                            render.changeEditability(argument);\r\n                        });\r\n                    });\r\n                } else {\r\n                    // Grid renders\r\n                    var gridXpath = self.processGridXpath(xpath);\r\n                    $.when(render.ready()).done(function () {\r\n                        if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                            render.changeCellEditability(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                        } else {\r\n                            var indexes = render.getIndexes(), j, lenIndex;\r\n                            for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                                render.changeCellEditability(indexes[j], gridXpath.remainingXpath, argument);\r\n                            }\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        });\r\n\r\n\r\n    },\r\n    /*\r\n     *   Changes the editability of the button\r\n     */\r\n    changeButtonEditability: function (xpath, argument) {\r\n        var self = this;\r\n        var guid = xpath.substring(3);\r\n        var element = self.form.getButton(guid);\r\n        if (bizagi.util.parseBoolean(argument) == true) {\r\n            element.removeAttr(\"disabled\");\r\n        } else {\r\n            element.attr(\"disabled\", \"disabled\");\r\n        }\r\n    },\r\n    /*\r\n     *  trigger Click button\r\n     */\r\n    triggerClick: function (xpath) {\r\n        var self = this;\r\n        var guid = xpath.substring(3);\r\n        var element = self.form.getButton(guid);\r\n        element.trigger(\"click\");\r\n    },\r\n\r\n    /* \r\n    *   Changes the required value of the render\r\n    */\r\n    changeRenderRequired: function (xpath, argument) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        var rendersToEval = [];\r\n\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            if (bizagi.util.parseBoolean(render.properties.editable)) {\r\n                rendersToEval.push(render);\r\n            }\r\n        });\r\n\r\n        if (rendersToEval.length === 0) {\r\n            rendersToEval = renders;\r\n        }\r\n\r\n        $.each(rendersToEval, function (i, render) {\r\n            // execute commands over valid renders\r\n            if (self.isValidRender(render)) {\r\n                //Detects if is the grid component, and set the desired properties\r\n                if (!self.isGridComponent(render, xpath)) {\r\n                    // Normal renders\r\n                    $.when(render.ready()).done(function () {\r\n                        $.when(render.renderingDeferred).done(function () {\r\n                            render.changeRequired(argument);\r\n                        });\r\n                    });\r\n                } else {\r\n                    // Grid renders\r\n                    var gridXpath = self.processGridXpath(xpath);\r\n                    $.when(render.ready()).done(function () {\r\n                        if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                            render.changeCellRequired(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                        } else {\r\n                            var indexes = render.getIndexes(), j, lenIndex;\r\n                            for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                                render.changeCellRequired(indexes[j], gridXpath.remainingXpath, argument);\r\n                            }\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        });\r\n    },\r\n    /* \r\n    *   Changes the render internal value\r\n    */\r\n    changeRenderValue: function (xpath, argument) {\r\n        var self = this;\r\n\r\n        if (argument != null && typeof argument === \"object\" ){\r\n            argument = $.extend(argument, {fromAction: true});\r\n        }\r\n\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        // Eval only an editable render\r\n        var rendersToEval = [];\r\n        $.each(renders, function (i, render) {\r\n            if (render.properties.editable) {\r\n                rendersToEval.push(render);\r\n            }\r\n        });\r\n\r\n        // If no render has been found skip editable validation\r\n        if (rendersToEval.length == 0) {\r\n            $.each(renders, function (i, render) {\r\n                rendersToEval.push(render);\r\n            });\r\n        }\r\n\r\n        $.each(rendersToEval, function (i, render) {\r\n            //Detects if is the grid component, and set the desired properties\r\n            if (!self.isGridComponent(render, xpath)) {\r\n                // Normal renders\r\n                $.when(render.ready()).done(function () {\r\n                    if (render.asyncRenderDeferred) {\r\n                        $.when(render.asyncRenderDeferred).done(function () {\r\n                            render.setDisplayValue(argument);\r\n                        });\r\n                    } else {\r\n                        render.setDisplayValue(argument);\r\n                    }\r\n                });\r\n            } else {\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n                $.when(render.ready()).done(function () {\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        render.changeCellValue(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                    } else {\r\n                        var indexes = render.getIndexes(), j, lenIndex;\r\n                        for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                            render.changeCellValue(indexes[j], gridXpath.remainingXpath, argument);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    /* \r\n    *   Changes the render minimum value\r\n    */\r\n    changeRenderMinValue: function (xpath, argument) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            //Detects if is the grid component, and set the desired properties\r\n            if (!self.isGridComponent(render, xpath)) {\r\n                // Normal renders\r\n                $.when(render.ready()).done(function () {\r\n                    var renderType = render.properties.type;\r\n                    if (renderType === \"number\" || renderType === \"date\" || renderType === \"money\") {\r\n                        render.changeMinValue(argument);\r\n                    }\r\n                });\r\n\r\n            } else {\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n                $.when(render.ready()).done(function () {\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        render.changeCellMinValue(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                    } else {\r\n                        var indexes = render.getIndexes(), j, lenIndex;\r\n                        for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                            render.changeCellMinValue(indexes[j], gridXpath.remainingXpath, argument);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    /* \r\n    *   Changes the render max value\r\n    */\r\n    changeRenderMaxValue: function (xpath, argument) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            //Detects if is the grid component, and set the desired properties\r\n            if (!self.isGridComponent(render, xpath)) {\r\n                // Normal renders\r\n                $.when(render.ready()).done(function () {\r\n                    render.changeMaxValue(argument);\r\n                });\r\n\r\n            } else {\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n                $.when(render.ready()).done(function () {\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        render.changeCellMaxValue(gridXpath.index, gridXpath.remainingXpath, argument);\r\n\r\n                    } else {\r\n                        var indexes = render.getIndexes(), j, lenIndex;\r\n                        for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                            render.changeCellMaxValue(indexes[j], gridXpath.remainingXpath, argument);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    /* \r\n    *   Changes the render max value\r\n    */\r\n    executeCalculatedField: function (xpath) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            $.when(render.ready()).done(function () {\r\n                render.runFormula();\r\n            });\r\n        });\r\n    },\r\n    /* \r\n    *   Refresh the render internal value using ajax\r\n    */\r\n    refreshControl: function (xpath, xpathContext, commandType) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath) || self.form.getContainer(xpath);\r\n        var queue = new bizagiQueue();\r\n\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        // Process matching renders\r\n        $.each(renders, function (i, render) {\r\n            queue.add(render.ready().pipe(function () {\r\n                return render.refreshControl({xpath: xpath, xpathContext: xpathContext});\r\n            }));\r\n        });\r\n\r\n        // Return queue deferred\r\n        return queue.execute();\r\n    },\r\n    /* \r\n    *   Refresh the render internal value using ajax\r\n    */\r\n    refreshContainer: function (containerId, xpathContext) {\r\n        var self = this;\r\n        var container = self.form.getContainer(containerId);\r\n\r\n        if (container == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(containerId);\r\n            }\r\n            return;\r\n        }\r\n\r\n        return $.when(container.ready())\r\n            .pipe(function () {\r\n                return container.refreshContainer({xpathContext: xpathContext});\r\n            });\r\n    },\r\n    /**\r\n     * Refresh a cell of grid\r\n     */\r\n    refreshGridCell: function (xpath, xpathContext) {\r\n        var self = this;\r\n        var queue = new bizagiQueue();\r\n        var def = new $.Deferred();\r\n        var renders = self.getRenders(xpath) || self.form.getContainer(xpath);\r\n\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return null;\r\n        }\r\n\r\n        // Eval only an editable render\r\n        var rendersToEval = [];\r\n        $.each(renders, function (i, render) {\r\n            if (render.properties.editable) {\r\n                rendersToEval.push(render);\r\n                return false;\r\n            }\r\n        });\r\n\r\n        // If no render has been found skip editable validation\r\n        if (rendersToEval.length == 0) {\r\n            $.each(renders, function (i, render) {\r\n                rendersToEval.push(render);\r\n                return false;\r\n            });\r\n        }\r\n\r\n        if (rendersToEval.length === 0) {\r\n            return;\r\n        }\r\n\r\n        // Check xpathContext of the form (addForm or editForm)\r\n        if (self.form && self.form.properties.xpathContext !== \"\") {\r\n            xpathContext = (xpathContext !== \"\") ? self.form.properties.xpathContext + \".\" + xpathContext : self.form.properties.xpathContext;\r\n        }\r\n\r\n        queue.add(def.promise());\r\n\r\n        $.when.apply($, $.map(rendersToEval, function (grid) {\r\n            grid.ready();\r\n        }))\r\n            .done(function () {\r\n                var len = rendersToEval.length;\r\n                var internalQueue = new bizagiQueue();\r\n                for (var i = 0; i < len; i++) {\r\n                    var grid = rendersToEval[i];\r\n\r\n                    var gridXpath = self.processGridXpath(xpath);\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        // Process a specific row\r\n                        internalQueue.add(grid.refreshCell({\r\n                            key: gridXpath.index,\r\n                            column: gridXpath.remainingXpath,\r\n                            xpathContext: xpathContext\r\n                        }));\r\n                    } else {\r\n                        // Process all rows\r\n                        var indexes = grid.getIndexes();\r\n                        var lenIndex = indexes.length;\r\n                        for (var j = 0; j < lenIndex; j++) {\r\n                            internalQueue.addParallel(grid.refreshCell({\r\n                                key: indexes[j],\r\n                                column: gridXpath.remainingXpath,\r\n                                xpathContext: xpathContext\r\n                            }));\r\n                        }\r\n                    }\r\n                }\r\n\r\n                $.when(internalQueue.execute())\r\n                    .done(function () {\r\n                        def.resolve();\r\n                    });\r\n            });\r\n\r\n\r\n        return queue.execute();\r\n    },\r\n    /**\r\n     * This function execute action to save all data of render, but\r\n     * the server service dont execute any rule on the server\r\n     */\r\n    submitFormData: function (params) {\r\n        var self = this;\r\n\r\n        // For the submit action we need only the whole form to perform the server action\r\n        var form = self.form;\r\n\r\n        // Process the action\r\n        return $.when(form.ready())\r\n            .pipe(function () {\r\n                return form.submitData(params);\r\n            });\r\n    },\r\n    /**\r\n     * This function send a request to the server to execute a rule\r\n     */\r\n    executeRule: function (rule, xpathContext, commandType) {\r\n        var self = this;\r\n        // For the execute rule  action we need only the whole form to perform the server action\r\n        var form = self.form;\r\n        var prefix = rule + \".\" + xpathContext;\r\n        if (self.isRecentAction(prefix, commandType)) {\r\n            return;\r\n        } else {\r\n            // Process the action\r\n            return $.when(form.ready())\r\n                .pipe(function () {\r\n                    return form.executeRule({rule: rule, xpathContext: xpathContext});\r\n                });\r\n        }\r\n    },\r\n    executeInterface: function (interface, xpathContext) {\r\n        var self = this;\r\n        // For the execute rule  action we need only the whole form to perform the server action\r\n        var form = self.form;\r\n\r\n        // Process the action\r\n        return $.when(form.ready())\r\n            .pipe(function () {\r\n                return form.executeInterface({interface: interface, xpathContext: xpathContext});\r\n            });\r\n    },\r\n\r\n\r\n    executeSAPConnector: function (guidsap, xpathContext) {\r\n        var self = this;\r\n        var form = self.form;\r\n        return $.when(form.ready).pipe(function () {\r\n            return form.executeSAPConnector({guidsap: guidsap, xpathContext: xpathContext});\r\n        });\r\n    },\r\n\r\n    executeConnector: function (guidConnector, xpathContext) {\r\n        var self = this;\r\n        var form = self.form;\r\n        return $.when(form.ready).pipe(function () {\r\n            return form.executeConnector({guidConnector: guidConnector, xpathContext: xpathContext});\r\n        });\r\n    },\r\n    /*\r\n    *   Submit the given render and refresh dependencies after that\r\n    */\r\n    submitRender: function (xpath, argument) {\r\n        var self = this;\r\n        // For the submit action we need only one render to perform the server action\r\n        var render = self.getRender(xpath);\r\n        if (render == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        // Process the action in the render\r\n        return $.when(render.ready()).pipe(function () {\r\n            return render.submitOnChange();\r\n        });\r\n    },\r\n    /*\r\n    * Cleans current value\r\n    */\r\n    cleanRenderData: function (xpath) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        if (renders == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showRenderNotFoundError(xpath);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.each(renders, function (i, render) {\r\n            //Detects if is the grid component, and set the desired properties\r\n            if (!self.isGridComponent(render, xpath)) {\r\n                // Normal renders\r\n                $.when(render.ready()).done(function () {\r\n                    $.when(render.renderingDeferred).done(function () {\r\n                        render.cleanData();\r\n                        self.changeRenderRequired(xpath, render.properties.required != undefined ? render.properties.required : false);\r\n                    });\r\n                });\r\n            } else {\r\n                // Grid renders\r\n                var gridXpath = self.processGridXpath(xpath);\r\n                $.when(render.ready()).done(function () {\r\n                    if (!bizagi.util.isEmpty(gridXpath.index)) {\r\n                        render.cleanCellData(gridXpath.index, gridXpath.remainingXpath);\r\n                    } else {\r\n                        var indexes = render.getIndexes(), j, lenIndex;\r\n                        for (j = 0, lenIndex = indexes.length; j < lenIndex; j++) {\r\n                            render.cleanCellData(indexes[j], gridXpath.remainingXpath);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    /* \r\n    *   Changes container background color\r\n    */\r\n    changeContainerBackground: function (containerId, argument) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var container = form.getContainer(containerId);\r\n        if (container == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showContainerNotFoundError(containerId);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.when(container.ready()).done(function () {\r\n            container.changeBackgroundColor(argument);\r\n        });\r\n    },\r\n    /* \r\n    *   Shows or hides a container\r\n    */\r\n    changeContainerVisibility: function (containerId, argument) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var container = form.getContainer(containerId);\r\n        if (container == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showContainerNotFoundError(containerId);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.when(container.ready(true)).done(function () {\r\n            $.when(container.renderingDeferred).done(function () {\r\n                container.changeVisibility(argument);\r\n            });\r\n        });\r\n    },\r\n    /* \r\n    *   Expand or collapse a group container\r\n    */\r\n    toogleContainer: function (containerId, argument) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var container = form.getContainer(containerId);\r\n        if (container == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showContainerNotFoundError(containerId);\r\n            }\r\n            return;\r\n        }\r\n        if (container.properties.type !== \"group\")\r\n            return;\r\n\r\n        $.when(container.ready()).done(function () {\r\n            container.toogleContainer(argument);\r\n        });\r\n    },\r\n    /* \r\n    *   Select a determinate sub-container in a tab or an accordion\r\n    */\r\n    changeActiveItem: function (containerId) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var container = form.getContainer(containerId);\r\n        if (container == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showContainerNotFoundError(containerId);\r\n            }\r\n            return;\r\n        }\r\n        if (container.properties.type === \"tabItem\" && container.loadingDeferred) {\r\n            container.loadingDeferred.resolve();\r\n        }\r\n        $.when(container.ready()).done(function () {\r\n            container.setAsActiveContainer();\r\n        });\r\n    },\r\n    /* \r\n    *   Changes container editability\r\n    */\r\n    changeContainerEditability: function (containerId, argument) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var container = form.getContainer(containerId);\r\n        if (container == null) {\r\n            if (self.Class.THROW_ERROR) {\r\n                self.showContainerNotFoundError(containerId);\r\n            }\r\n            return;\r\n        }\r\n\r\n        $.when(container.ready()).done(function () {\r\n            container.changeEditability(argument);\r\n        });\r\n    },\r\n    /*\r\n    *   Search for grid columns\r\n    */\r\n    searchGridColumns: function (condition, gridColumns) {\r\n        var self = this;\r\n        var column;\r\n        if (typeof (condition) === \"string\" || typeof (condition) === \"boolean\")\r\n            return null;\r\n        if (condition.expressions) {\r\n            var j, lenIndex;\r\n            for (j = 0, lenIndex = condition.expressions.length; j < lenIndex; j++) {\r\n                self.searchGridColumns(condition.expressions[j], gridColumns);\r\n            }\r\n\r\n        } else if (condition.simple) {\r\n            return self.searchGridColumns(condition.simple, gridColumns);\r\n\r\n        } else if (condition.complex) {\r\n            return self.searchGridColumns(condition.complex, gridColumns);\r\n        } else {\r\n            var xpath = condition.xpath || condition.renderId;\r\n            if (xpath) {\r\n                // Check in condition.xpath\r\n                if (xpath && xpath.indexOf(\"[]\") > 0) {\r\n                    column = xpath.substring(xpath.indexOf(\"[]\") + 3);\r\n                    gridColumns.push(column);\r\n                }\r\n\r\n                // Check in argument if argumentType is xpath\r\n                if (condition.argumentType === 'xpath') {\r\n                    if (condition.argument.indexOf(\"[]\") > 0) {\r\n                        column = condition.argument.substring(condition.argument.indexOf(\"[]\") + 3);\r\n                        gridColumns.push(column);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return null;\r\n    },\r\n    /**/\r\n\r\n    isGridComponent: function (render, xpath) {\r\n        var renderType = bizagi.util.normalizeType(render.properties.type);\r\n        return (/^grid$/i.test(renderType) && xpath.indexOf('[') >= 0);\r\n    },\r\n    /**/\r\n\r\n    isValidRender: function (render) {\r\n        var notValid = [\"collectionnavigator\"];\r\n\r\n        return notValid.indexOf(render.properties.type) === -1;\r\n    },\r\n\r\n    /**\r\n     * Helper to override the visibility and editability. TODO: Apply to mobile with formButtons\r\n     * @param {} xpath\r\n     * @param {} status\r\n     * @returns {}\r\n     */\r\n    changeFormButtonVisibility: function(xpath, visible) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var guid = xpath.substring(3);\r\n\r\n        var buttons = form.buttons && form.buttons.length ? form.buttons : form.properties.buttons || [];\r\n        var isVisible = bizagi.util.parseBoolean(visible) !== false;\r\n        var index = buttons.findIndex(function(item) { return item.id === guid; });\r\n        var navigation = form.getNavigation();\r\n\r\n        if (index !== -1)\r\n            buttons[index].visible = isVisible;\r\n\r\n        form.buttons = buttons || [];\r\n        navigation.setNavigationButtons(form);\r\n    }\r\n});","/*\r\n *   Name: Bizagi Rendering Validation controller \r\n *   Author: Richar Urbano <Richar.Urbano@Bizagi.com\r\n *   Comments:\r\n *   -   This script will parse and execute all the validations defined for the form\r\n */\r\n\r\n// Override to support the change of the visibility and editability over forms buttons\r\nbizagi.command.controllers.action.extend(\"bizagi.command.controllers.action\", {}, {\r\n\r\n    /**\r\n     * Sets a new color for the background of the button\r\n     * Applies also to grid cells!\r\n     * @param {} xpath \r\n     * @param {} color \r\n     * @returns {} \r\n     */\r\n    changeButtonBackground: function(xpath, color) {       \r\n        if (this.form && !this.form.isFloatingButtonsEnabled())\r\n            this._super(xpath, color);\r\n    },\r\n\r\n    /**\r\n     * Sets a new color for the foreground of the render\r\n     * @param {} xpath \r\n     * @param {} argument \r\n     * @returns {} \r\n     */\r\n    changeButtonForeground: function(xpath, color) {                           \r\n        if (this.form && !this.form.isFloatingButtonsEnabled())\r\n            this._super(xpath, color);\r\n    },\r\n\r\n    /**\r\n     * Changes the visibility of the button\r\n     * @param {} xpath \r\n     * @param {} argument \r\n     * @returns {} \r\n     */\r\n    changeButtonVisibility: function(xpath, status) {\r\n        var self = this;        \r\n\r\n        if (self.form && !self.form.isFloatingButtonsEnabled()) {\r\n            self._super(xpath, status);\r\n        } else {\r\n            self.changeFloatingButtonVisibility(xpath, status)\r\n        }\r\n    },\r\n\r\n    /**     \r\n     * Changes the editability of the button\r\n     * @param {} xpath \r\n     * @param {} argument \r\n     * @returns {} \r\n     */\r\n    changeButtonEditability: function (xpath, status) {\r\n        var self = this;\r\n\r\n        if (self.form && !self.form.isFloatingButtonsEnabled()) {\r\n            self._super(xpath, status);\r\n        } else {\r\n            self.changeFloatingButtonVisibility(xpath, status)\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Helper to override the visibility and editability\r\n     * @param {} xpath \r\n     * @param {} status \r\n     * @returns {} \r\n     */\r\n    changeFloatingButtonVisibility: function(xpath, visible) {\r\n        var self = this;\r\n        var form = self.form;\r\n        var guid = xpath.substring(3);\r\n        var navigation = form.getNavigation();\r\n        var buttons = form.buttons && form.buttons.length ? form.buttons : form.properties.buttons || [];\r\n        var isVisible = bizagi.util.parseBoolean(visible) !== false;\r\n        var index = buttons.findIndex(function(item) { return item.id === guid; });\r\n\r\n        if (index !== -1)\r\n            buttons[index].visible = isVisible;\r\n\r\n        form.buttons = buttons || [];\r\n        navigation.setNavigationButtons(form);\r\n    }\r\n\r\n});","/*\r\n*   Name: BizAgi Element Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a base class with common stuff related to all renders and containers\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.element\", {\r\n    ELEMENT_TYPE_CONTAINER: 1,\r\n    ELEMENT_TYPE_RENDER: 2,\r\n    ELEMENT_TYPE_COLUMN: 3\r\n}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        // Set render factory\r\n        this.renderFactory = params.renderFactory;\r\n\r\n        // Set data service\r\n        this.dataService = params.dataService;\r\n\r\n        // Set reference to parent\r\n        this.parent = params.parent;\r\n\r\n        // Set l10n service\r\n        this.resources = bizagi.localization;\r\n\r\n        // Set the observable element\r\n        this.observableElement = $(\"<div />\");\r\n\r\n        // Set the dispose flag\r\n        this.disposed = false;\r\n\r\n        // Update data\r\n        this.initializeData(params.data);\r\n\r\n        // Define an object to hold the subscribe collection\r\n        this.subscribers = [];\r\n    },\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Set the internal data\r\n        this.properties = {};\r\n        if (data && data.properties) this.properties = data.properties;\r\n\r\n        // Set xpath context\r\n        this.properties.xpathContext = this.getXpathContext();\r\n\r\n        // Set page cache\r\n        this.properties.idPageCache = this.getPageCache();\r\n    },\r\n\r\n    /*\r\n    *   Returns the xpath context of the element\r\n    */\r\n    getXpathContext: function () {\r\n        // By default return parent's xpath context\r\n        // This method is overriden in form container which contains the real xpath context\r\n\r\n        return (this.parent != undefined && typeof this.parent.getXpathContext == \"function\") ? this.parent.getXpathContext() : \"\";\r\n    },\r\n\r\n    /*\r\n    *   Returns the page cache for the current element\r\n    */\r\n    getPageCache: function () {\r\n        // By default return parent's page cache\r\n        // This method is overriden in form container which contains the real page cache\r\n\r\n        return (this.parent != undefined && typeof this.parent.getPageCache == \"function\") ? this.parent.getPageCache() : \"\";\r\n    },\r\n\r\n    /*\r\n    *   Returns the form containing the element\r\n    */\r\n    getFormContainer: function () {\r\n        // By default return parent's form container\r\n        // This method is overriden in form container which returns itself\r\n        if (typeof (this.parent) != \"undefined\")\r\n        return this.parent.getFormContainer();\r\n    },\r\n\r\n\r\n    /*\r\n    *   Returns the mapped resource\r\n    */\r\n    getResource: function (key) {\r\n        return this.resources.getResource(key);\r\n    },\r\n\r\n    /*\r\n    *   Returns the element type\r\n    */\r\n    getElementType: function () { },\r\n\r\n    /* \r\n    *   Resizes the element \r\n    */\r\n    resize: function (size) {\r\n\r\n    },\r\n\r\n    /*\r\n    *   Focus on the current element\r\n    */\r\n    focus: function () {\r\n\r\n        if (this.properties.required) {\r\n            var layout = $(\"#ui-bizagi-wp-app-render-form-content\");\r\n            // Check if element is visible into scroll\r\n            if (!bizagi.util.isScrolledIntoView(this.element, layout)) {\r\n                $(this.element).attr('tabindex', -1).focus();\r\n            }\r\n            if (this.element) {\r\n                this.element.effect('highlight', 2000);\r\n            }\r\n        }\r\n\r\n        //Check if the element has parent\r\n        if (this.parent && typeof this.parent.focus == 'function') {\r\n            this.parent.focus();\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Publish a global event that the facade will replicate\r\n    */\r\n    triggerGlobalHandler: function (eventType, data) {\r\n        if (this.disposed) return null;\r\n        if (this.parent) return this.parent.triggerGlobalHandler(eventType, data);\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Triggers an event inside the control\r\n    */\r\n    trigger: function (eventType, data) {\r\n        if (this.disposed) return null;\r\n        if (this.observableElement) return this.observableElement.trigger(eventType, data);\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Triggers an event handler inside the control\r\n    */\r\n    triggerHandler: function (eventType, data) {\r\n        if (this.disposed) return null;\r\n        if (this.observableElement) return this.observableElement.triggerHandler(eventType, data);\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Binds to an event\r\n    */\r\n    bind: function (eventType, fn) {\r\n        if (this.disposed) return null;\r\n        if (this.observableElement) return this.observableElement.bind(eventType, fn);\r\n        this.subscribers.push({ event: eventType });\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Un-binds to an event\r\n    */\r\n    unbind: function (eventType, fn) {\r\n        if (this.disposed) return null;\r\n        if (this.observableElement) return this.observableElement.unbind(eventType, fn);\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Binds a one time event\r\n    */\r\n    one: function (eventType, fn) {\r\n        if (this.disposed) return null;\r\n        if (this.observableElement) return this.observableElement.one(eventType, fn);\r\n        this.subscribers.push({ event: eventType });\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Return the rendered element\r\n    */\r\n    getRenderedElement: function () { },\r\n\r\n    /*\r\n    *   Get current rendering mode\r\n    */\r\n    getMode: function () {\r\n        if (this.parent) return this.parent.getMode();\r\n    },\r\n\r\n    /*\r\n    *   Get current rendering params\r\n    */\r\n    getParams: function () {\r\n        if (this.parent) return this.parent.getParams();\r\n    },\r\n\r\n    /*\r\n    * Get current form type (ex. queryform, form)\r\n    */\r\n    getFormType: function () {\r\n        var self = this;\r\n\r\n        var form = self.getFormContainer();\r\n        return form.properties.type || \"form\";\r\n    },\r\n\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready\r\n    */\r\n    ready: function () { },\r\n\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready to save\r\n    */\r\n    isReadyToSave: function () { },\r\n\r\n    /*\r\n    *   Get the custom handlers set for this execution\r\n    */\r\n    getCustomHandlers: function () {\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Dispose the class so we can detect when a class is invalid already\r\n    */\r\n    dispose: function () {\r\n        var self = this;\r\n        self.disposed = true;\r\n\r\n        setTimeout(function () {\r\n            if (self.subscribers != null) {\r\n                // Remove all subcriptions\r\n                $.each(self.subscribers, function (i, item) {\r\n                    self.unbind(item.event);\r\n                });\r\n            }\r\n            delete self.subscribers;\r\n\r\n            if (self.observableElement) self.observableElement.off();\r\n            bizagi.util.dispose(self);\r\n        }, bizagi.override.disposeTime || 50);\r\n    },\r\n\r\n    /*\r\n    *   Check if the current object is disposed\r\n    */\r\n    isDisposed: function () {\r\n        return this.disposed;\r\n    },\r\n\r\n    /*\r\n    *   This method process the error or alert messages coming from the server, and adds them to the validation controller\r\n    */\r\n    processFailMessage: function(message) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var isOfflineForm = bizagi.util.isOfflineForm({ context: self });\r\n\r\n        if (message.errorType === \"CustomMessageException\") {\r\n            // Clear previous validations\r\n            form.validationController.clearValidationMessages();\r\n            var error = bizagi.localization.getResource(message.message);\r\n            form.validationController.showErrorMessage(error);\r\n        } else if (message.errorType === \"InvalidCaseStateException\") {\r\n            var params = form.getParams()\r\n\r\n            form.validationController.clearValidationMessages();\r\n           \r\n            // Redirection Here\r\n            form.container.trigger(\"routing\", { idCase: params.idCase || bizagi.context.idCase });\r\n        } else {\r\n            var message = message || {};\r\n            message = typeof (message) == \"string\" ? JSON.parse(message) : message;\r\n            var type = message.type || \"error\";\r\n            var code = message.code || \"code\";\r\n            message = message.responseText || (message.message || message);\r\n\r\n            // Omit processing when the ajax didn't process\r\n            if (type === \"not-processed\") return;\r\n            if (type === \"not-shown\") return;\r\n            if (isOfflineForm && code === \"AUTH_ERROR\") return;\r\n\r\n            // Clear previous validations\r\n            form.validationController.clearValidationMessages();\r\n            if (type == \"alert\") {\r\n                form.validationController.showAlertMessage(message);\r\n            } else {\r\n                form.validationController.showErrorMessage(message);\r\n            }\r\n        }\r\n\r\n        return message;\r\n    },\r\n\r\n    /*\r\n    *   Sets a waiting overlay above the current element\r\n    */\r\n    startLoading: function () {  /* Override in implementations */ },\r\n\r\n    /*\r\n    *   Removes the waiting overlay\r\n    */\r\n    endLoading: function () { /* Override in implementations */ },\r\n\r\n    /**\r\n    *   Prepare control to remove it from the render, that allows to\r\n    *   clean all elements of the control or to do any stuff before to remove\r\n    */\r\n    beforeToRefresh: function () { /* Implement in each render and container if you need */ },\r\n\r\n    /**\r\n    *   Run before that the control has been refreshed\r\n    */\r\n    afterToRefresh: function () { /* Implement in each render and container if you need */ }\r\n});\r\n\r\n","/*\r\n *   Name: BizAgi Container Class\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define a base container class with common stuff related to all containers\r\n */\r\n\r\nbizagi.rendering.element.extend(\"bizagi.rendering.container\", {\r\n    TYPE_QUERY_FORM: \"queryForm\"\r\n}, {\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Set defaults\r\n        var properties = self.properties;\r\n        properties.uniqueId = Math.ceil(Math.random() * 1000000);\r\n        properties.editable = (typeof properties.editable != \"undefined\") ? bizagi.util.parseBoolean(properties.editable) : true;\r\n        properties.visible = (typeof properties.visible != \"undefined\") ? bizagi.util.parseBoolean(properties.visible) : true;\r\n\r\n        // Override orientation from parent if not set\r\n        properties.orientation = properties.orientation || \"auto\";\r\n\r\n        // Save original properties\r\n        this.originalProperties = JSON.parse(JSON.encode(properties));\r\n\r\n        // Create children\r\n        this.children = [];\r\n        this.childrenHash = {};\r\n\r\n        if (data.elements) {\r\n            $.each(data.elements, function(i, element) {\r\n                if (element.render) {\r\n                    self.createRenderElement(element);\r\n                } else if (element.container) {\r\n                    self.createContainerElement(element);\r\n                } else if (element.form) {\r\n                    self.createFormElement(element);\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Creates a render element\r\n    */\r\n    createRenderElement: function (element) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var originalElement;\r\n\r\n        // Replicate editable property when container is not editable\r\n        if (properties.editable == false) {\r\n            element.render.properties.editable = properties.editable;\r\n            if (element.render.properties.type == \"grid\")\r\n                element.render.properties.inlineEdit = false;\r\n        }\r\n\r\n        // Replicate required property when container is not required\r\n        if (properties.required === false) {\r\n            element.render.properties.required = properties.required;\r\n        }\r\n\r\n        //clone originalElement to apply duplicate render properties correctly\r\n        if (element.render.properties.retype == \"duplicate\") {\r\n            originalElement = bizagi.clone(element);\r\n        }\r\n\r\n        var render = self.renderFactory.getRender({\r\n            type: element.render.properties.type,\r\n            data: element.render,\r\n            dataService: self.dataService,\r\n            parent: self,\r\n            mode: self.getMode()\r\n        });\r\n\r\n        // Add to children\r\n        self.children.push(render);\r\n\r\n        // Check for duplicate\r\n        if (element.render.properties.retype == \"duplicate\") {\r\n            self.processDuplicateRender(render, originalElement);\r\n        }\r\n\r\n        //TODO: at this point not posible add the retype double at this point not exist input\r\n\r\n        // Register in form container\r\n        self.getFormContainer().registerRender(render);\r\n    },\r\n    /*\r\n    *   Creates a container element\r\n    */\r\n    createContainerElement: function (element) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Replicate editable property when container is not editable\r\n        if (properties.editable == false) {\r\n            element.container.properties.editable = properties.editable;\r\n        }\r\n\r\n        // Replicate required property when container is not required\r\n        if (properties.required === false) {\r\n            element.container.properties.required = properties.required;\r\n        }\r\n\r\n        var container = self.renderFactory.getContainer({\r\n            type: element.container.properties.type,\r\n            data: element.container,\r\n            parent: self,\r\n            dataService: self.dataService,\r\n            mode: self.getMode(),\r\n            isDesign: self.getMode() === \"design\"\r\n        });\r\n\r\n        self.children.push(container);\r\n\r\n        // Register in form container\r\n        self.getFormContainer().registerRender(container);\r\n    },\r\n    /*\r\n    *   Creates a form element\r\n    */\r\n    createFormElement: function (element) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Replicate editable property when container is not editable\r\n        if (properties.editable == false) {\r\n            element.container.properties.editable = properties.editable;\r\n        }\r\n\r\n        var form = self.renderFactory.getContainer({\r\n            type: (element.form.properties.type || \"form\"),\r\n            data: element.form,\r\n            parent: self,\r\n            dataService: self.dataService,\r\n            mode: self.getMode()\r\n        });\r\n        self.children.push(form);\r\n    },\r\n    /* \r\n    *   Gets the current container \r\n    */\r\n    getElement: function () {\r\n        var self = this;\r\n        return self.container;\r\n    },\r\n    /* \r\n    *   Gets a collection for all elements matching a type \r\n    */\r\n    getElementsByType: function (type, elements) {\r\n        elements = elements || [];\r\n        var self = this;\r\n\r\n        // Iterate through elements\r\n        $.each(self.children, function (i, child) {\r\n            if (child.properties.type == type) {\r\n                elements.push(child);\r\n            }\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                child.getElementsByType(type, elements);\r\n            }\r\n        });\r\n\r\n        return elements;\r\n    },\r\n    /*\r\n    *   Process renders with duplicate property\r\n    */\r\n    processDuplicateRender: function (render, element) {\r\n        var self = this;\r\n        var clonedElement = JSON.parse(JSON.encode(element.render));\r\n\r\n        // Changes properties\r\n        clonedElement.properties.displayName = clonedElement.properties.displayName + \" \" + self.getResource(\"render-text-duplicate-label-sufix\");\r\n        clonedElement.properties.xpath = clonedElement.properties.xpath + \".clone\";\r\n        clonedElement.properties.isClone = true;\r\n\r\n        // Creates clone\r\n        var clone = self.renderFactory.getRender({\r\n            type: clonedElement.properties.type,\r\n            data: clonedElement,\r\n            parent: self,\r\n            mode: self.getMode()\r\n        });\r\n\r\n        // Associates with main render\r\n        render.cloneRender = clone;\r\n\r\n        // Add to collection\r\n        self.children.push(clone);\r\n    },\r\n    /*\r\n    *   Returns the element type\r\n    */\r\n    getElementType: function () {\r\n        return bizagi.rendering.element.ELEMENT_TYPE_CONTAINER;\r\n    },\r\n    /*\r\n    *   Returns the in-memory processed element\r\n    */\r\n    render: function () {\r\n        var self = this,\r\n            mode = self.getMode(),\r\n            result;\r\n\r\n        // Render container\r\n        result = self.internalRender();\r\n\r\n        // Apply container defaults\r\n        self.applyContainerDefaults();\r\n\r\n        // Add container id\r\n        result.attr(\"data-container-id\", self.properties.id);\r\n\r\n        //Add container tag property\r\n        if (self.properties.tag) {\r\n            result.attr(\"data-tag\", self.properties.tag);\r\n        }\r\n\r\n        //Add class to the requested form, to specify if is add form, edit form, or detail form\r\n        if (self.params)\r\n            if (self.params.requestedForm)\r\n                result.addClass(self.params.requestedForm);\r\n\r\n        return result;\r\n    },\r\n    /*\r\n    *   Internal  rendering\r\n    */\r\n    internalRender: function () {\r\n        var self = this;\r\n\r\n        // Render the container\r\n        var html = self.renderContainerHtml();\r\n\r\n        // Convert html string to jquery object\r\n        var container = self.container = $(html);\r\n\r\n        // Post-render\r\n        self.postRenderContainer(container);\r\n\r\n        return self.container;\r\n    },\r\n    /*\r\n    *   Renders container html\r\n    */\r\n    renderContainerHtml: function () {\r\n        var self = this;\r\n        // Start rendering deferred\r\n        self.renderingDeferred = self.renderingDeferred || new $.Deferred();\r\n\r\n        return this.renderContainer();\r\n    },\r\n    /*\r\n    *   Check if the jquery element is ready or not\r\n    */\r\n    isRendered: function () {\r\n        var self = this;\r\n        if (!self.renderingDeferred)\r\n            return false;\r\n        return self.renderingDeferred.promise();\r\n    },\r\n    /*\r\n    *   Return the rendered element\r\n    */\r\n    getRenderedElement: function () {\r\n        if (bizagi.util.isEmpty(this.container))\r\n            alert(\"container hasn't been rendered!\");\r\n\r\n        return this.container;\r\n    },\r\n    /* \r\n    *   Set container defaults\r\n    */\r\n    applyContainerDefaults: function () {\r\n        var self = this,\r\n                properties = self.properties;\r\n\r\n        // Set customizations\r\n        if (properties.backgroundColor)\r\n            self.changeBackgroundColor(properties.backgroundColor);\r\n\r\n        // Set editability and visiblity\r\n        if (!properties.visible)\r\n            self.changeVisibility(properties.visible);\r\n    },\r\n    /* \r\n    *  Changes background color \r\n    */\r\n    changeBackgroundColor: function (color) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        properties.backgroundColor = color;\r\n\r\n        // Iterate through elements\r\n        $.each(self.children, function (i, child) {\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                child.changeBackgroundColor(color);\r\n\r\n            } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                child.changeBackgroundColor(color);\r\n            }\r\n        });\r\n    },\r\n    /* \r\n    *   Hides / Show container \r\n    */\r\n    changeVisibility: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Store in properties\r\n        properties.visible = bizagi.util.parseBoolean(argument);\r\n\r\n        // Hide - show the render\r\n        if (properties.visible) {\r\n            self.container.show();\r\n\r\n        } else {\r\n            self.container.hide();\r\n        }\r\n    },\r\n    /* Changes editability */\r\n    changeEditability: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Store in properties\r\n        properties.editable = bizagi.util.parseBoolean(argument);\r\n\r\n        // Iterate through elements\r\n        $.each(self.children, function (i, child) {\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                child.changeEditability(argument);\r\n\r\n            } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                child.changeEditability(argument);\r\n            }\r\n        });\r\n    },\r\n    /*\r\n    *   Replaces a <x/> tag in the container for the specified \"replace\" element\r\n    */\r\n    replaceTag: function (container, tag, replace) {\r\n        bizagi.util.replaceSelector(container, tag, replace);\r\n    },\r\n    /*\r\n    *   Replaces a <children/> tag in the container for the specified \"replace\" element\r\n    */\r\n    replaceChildrenTag: function (container, replace) {\r\n        this.replaceTag(container, \".children\", replace);\r\n    },\r\n    /*\r\n    *   Replaces a {{children}} string in the specified element\r\n    */\r\n    replaceChildrenHtml: function (html, replace) {\r\n        return html.replace(\"{{children}}\", replace);\r\n    },\r\n    /*\r\n    *   Template method to render the container layout, returns a string with all the builded html,\r\n    *   must be overriden in all children\r\n    */\r\n    renderContainer: function () {\r\n    },\r\n    /*\r\n    *   Template method to process each jquery object\r\n    *   must be overriden in each container\r\n    */\r\n    postRenderContainer: function (container) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n\r\n        // Resolve rendering deferred\r\n        if (self.renderingDeferred)\r\n            self.renderingDeferred.resolve();\r\n\r\n        // Process children elements\r\n        self.container = container;\r\n        self.executeChildrenPostRender(container);\r\n\r\n        if (mode == \"execution\") {\r\n            // Apply handlers\r\n            self.configureHandlers();\r\n            self.applyPlaceHolderPolyfill();\r\n\r\n        }\r\n        if (mode == \"design\") {\r\n            // Configure view\r\n            self.configureDesignView();\r\n        }\r\n        if (mode == \"layout\") {\r\n            // Configure view\r\n            self.configureDesignView();\r\n            self.configureLayoutView();\r\n        }\r\n    },\r\n\r\n    applyPlaceHolderPolyfill: function () {\r\n        var self = this;\r\n        var config = window.placeHolderConfig || {};\r\n        if (('placeholder' in $('<input>')[0] || 'placeHolder' in $('<input>')[0]) && !config.forceApply) {\r\n            // don't run the polyfill when the browser has native support\r\n            return;\r\n        }\r\n        Placeholders.enable();\r\n    },\r\n    /*\r\n    *   Process container children\r\n    */\r\n    executeChildrenPostRender: function (container) {\r\n        var self = this;\r\n        var childrenElements = container.children();\r\n\r\n        $.each(childrenElements, function (i, childElement) {\r\n            childElement = $(childElement);\r\n            var id = Number(childElement.data(\"unique-id\"));\r\n            if (id) {\r\n                var child = self.childrenHash[id];\r\n                if (child) {\r\n                    var type = child.getElementType();\r\n                    if (type == bizagi.rendering.element.ELEMENT_TYPE_RENDER)\r\n                        child.postRenderElement(childElement);\r\n                    if (type == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER)\r\n                        child.postRenderContainer(childElement);\r\n                }\r\n            } else {\r\n                self.executeChildrenPostRender(childElement);\r\n            }\r\n        });\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the container's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour when rendering in design mode\r\n    */\r\n    configureDesignView: function () {\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the container's behaviour to show layout\r\n    */\r\n    configureLayoutView: function () {\r\n\r\n    },\r\n    /**\r\n    *   Renders all children html\r\n    */\r\n    renderChildrenHtml: function () {\r\n        var self = this;\r\n        var temp = \"\";\r\n\r\n        $.each(self.children, function (i, child) {\r\n            var type = child.getElementType();\r\n            if (type == bizagi.rendering.element.ELEMENT_TYPE_RENDER)\r\n                temp += child.renderElement();\r\n            if (type == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER)\r\n                temp += child.renderContainerHtml();\r\n            self.childrenHash[child.properties.uniqueId] = child;\r\n        });\r\n\r\n        return temp;\r\n    },\r\n    /*\r\n    *   Iterate through all the renders in the container and fills the hashtable\r\n    */\r\n    collectRenderValues: function (renderValues) {\r\n        var self = this;\r\n        if (self.children) {\r\n            $.each(self.children, function (i, child) {\r\n                if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                    // Go though container\r\n                    child.collectRenderValues(renderValues);\r\n\r\n                } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                    // Check if the render can be sent to the server\r\n                    if (child.canBeSent()) {\r\n                        child.collectData(renderValues);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Iterate through all the renders and check if has changed\r\n    */\r\n    hasChanged: function (result) {\r\n        var self = this;\r\n        result = result || [];\r\n\r\n        if (!result.length) {\r\n            if(self.children){\r\n                $.each(self.children, function (i, child) {\r\n                    if (result.length || child.hasChanged(result)) {\r\n                        return false;\r\n                    }\r\n                });\r\n            }\r\n        } else {\r\n            return result;\r\n        }\r\n    },\r\n\r\n    /*\r\n    *    Creates a json array parameters to search result\r\n    */\r\n    collectRenderValuesQueryForm: function (renderValues) {\r\n        var self = this;\r\n        $.each(self.children, function (i, child) {\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                // Go though container\r\n                child.collectRenderValuesQueryForm(renderValues);\r\n\r\n            } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                // Check if the render can be sent to the server\r\n                if (child.canBeSentQueryForm()) {\r\n                    child.collectDataQueryForm(renderValues);\r\n                }\r\n            }\r\n        });\r\n    },\r\n    /*\r\n    *   Gets the first child\r\n    */\r\n    firstChild: function () {\r\n        return this.children[0];\r\n    },\r\n    /*\r\n    *   Method to find all the renders matching an xpath inside the container\r\n    */\r\n    getRenders: function (xpath, renders) {\r\n        var self = this;\r\n\r\n        renders = renders || [];\r\n\r\n        // Remove [] filters for grid columns xpaths to fully identify the grid as the xpath target\r\n        if (xpath.indexOf(\"[\") > 0) {\r\n            xpath = xpath.substring(0, xpath.indexOf(\"[\"));\r\n        }\r\n\r\n        $.each(self.children, function (i, child) {\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                // Go though container\r\n                child.getRenders(xpath, renders);\r\n\r\n            } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                if (xpath == child.properties.xpath) {\r\n                    renders.push(child);\r\n                }\r\n            }\r\n        });\r\n\r\n        return renders;\r\n    },\r\n    /* \r\n    *   Gets the first editable render \r\n    */\r\n    getRender: function (xpath) {\r\n        var self = this;\r\n        var renders = self.getRenders(xpath);\r\n        var result = null;\r\n        $.each(renders, function (i, render) {\r\n            if (render.properties.editable) {\r\n                if (result == null)\r\n                    result = render;\r\n            }\r\n        });\r\n\r\n        // if no render has been found, skip editable condition\r\n        if (result == null) {\r\n            $.each(renders, function (i, render) {\r\n                result = render;\r\n            });\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n     *   Gets all renders by xpath\r\n     */\r\n    getRendersByXpath: function (xpath) {\r\n        var self = this;\r\n        return self.getRenders(xpath);\r\n    },\r\n\r\n    /* \r\n    *   Gets a container by the id\r\n    */\r\n    getContainer: function (id) {\r\n        var self = this;\r\n\r\n        if (self.properties.id == id)\r\n            return this;\r\n\r\n        var result;\r\n        $.each(self.children, function (i, child) {\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                // Go though container\r\n                var o = child.getContainer(id);\r\n                if (o != null) {\r\n                    result = o;\r\n                    return false;\r\n                }\r\n            }\r\n        });\r\n\r\n        return result;\r\n    },\r\n    /* \r\n    *   Validate all renders in the container \r\n    */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n\r\n        $.each(self.children, function (i, child) {\r\n            if (child.properties.visible) {\r\n                if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                    // Go though container\r\n                    child.isValid(invalidElements);\r\n\r\n                } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                    // Go to the render\r\n                    child.isValid(invalidElements);\r\n                }\r\n            }\r\n        });\r\n\r\n        return invalidElements.length == 0;\r\n    },\r\n\r\n        /*\r\n       *   Validate all grids in the container\r\n       */\r\n    hasValidGrids: function (invalidElements) {\r\n        var self = this;\r\n\r\n        $.each(self.children, function (i, child) {\r\n            if (child.properties.visible) {\r\n                if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                    // Go though container\r\n                    child.hasValidGrids(invalidElements);\r\n\r\n                } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER && typeof (child.grid) != \"undefined\") {\r\n                    // Go to the render\r\n                    child.isValid(invalidElements);\r\n                }\r\n            }\r\n        });\r\n\r\n        return invalidElements.length == 0;\r\n    },\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready\r\n    */\r\n    ready: function () {\r\n        var self = this;\r\n        return $.when(self.parent.ready(), self.isRendered());\r\n    },\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready to save\r\n    */\r\n    isReadyToSave: function () {\r\n        var self = this;\r\n        var childrenPromises = $.map(self.children, function (child) {\r\n            return child.isReadyToSave();\r\n        });\r\n        return $.when.apply($, childrenPromises);\r\n    },\r\n    /*  \r\n    *   Return the current focuses container\r\n    */\r\n    getFocus: function () {\r\n        var self = this;\r\n        var focus;\r\n        $.each(self.children, function (i, child) {\r\n            if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                var result = child.getFocus();\r\n                if (!bizagi.util.isEmpty(result)) {\r\n                    focus = result;\r\n                }\r\n            }\r\n        });\r\n\r\n        return focus;\r\n    },\r\n    /*\r\n    *   Get the custom handlers set for this execution\r\n    */\r\n    getCustomHandlers: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n\r\n        if (form) {\r\n            return form.getCustomHandlers();\r\n        }\r\n    },\r\n    /*\r\n    *   Get the custom handlers set for this execution\r\n    */\r\n    getCustomHandler: function (key) {\r\n        var self = this;\r\n        var customHandlers = self.getCustomHandlers();\r\n\r\n        if (customHandlers) {\r\n            return customHandlers[key];\r\n        }\r\n    },\r\n    /*\r\n    *   Dispose the class so we can detect when a class is invalid already\r\n    */\r\n    dispose: function () {\r\n        var self = this;\r\n\r\n        // Iterate through elements\r\n        setTimeout(function () {\r\n            if (self.children) {\r\n                $.each(self.children, function (i, child) {\r\n                    child.dispose();\r\n                });\r\n            }\r\n        }, bizagi.override.disposeTime || 50);\r\n\r\n        // Call base\r\n        self._super();\r\n    },\r\n\r\n    /*\r\n    *   Refresh the current container\r\n    */\r\n    refreshContainer: function (args) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Start waiting\r\n        self.startLoading();\r\n\r\n        // Execute personalized stuff before to refresh it\r\n        self.beforeToRefresh();\r\n\r\n        // Call the service\r\n        return $.when(self.dataService.multiaction().refreshControl({\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            idPageCache: properties.idPageCache,\r\n            xpathContext: (properties.xpathContext || args.xpathContext),\r\n            contexttype: self.properties.contexttype || \"\"\r\n        })).done(function (data) {\r\n\r\n            if (!self.isDisposed()) {\r\n\r\n                // Unregister children of container to replace in hash self.rendersById and self.rendersByXpath\r\n                self.unregisterChildren();\r\n                delete self.children;\r\n                delete self.childrenHash;\r\n\r\n                self.getFormContainer().removeActions();\r\n\r\n                // update editable\r\n                if (self.properties.editable === false) {\r\n                    data.container && data.container.properties ? (data.container.properties.editable = false) : \"\";\r\n                }\r\n\r\n                // Update the data\r\n                self.initializeData(data.container);\r\n\r\n                // Render the container again\r\n                var currentContainer = self.container;\r\n                var result = self.render();\r\n\r\n                if (self.properties.type == \"tabItem\") {\r\n                    $(result).addClass(\"childrenActive\");\r\n                }\r\n\r\n                currentContainer.replaceWith(result);\r\n\r\n                // Rebind the actions\r\n                var actions = data.container && data.container.actions ? data.container.actions : [];\r\n                self.getFormContainer().refreshActions(actions);\r\n\r\n                self.triggerChildrenActions();\r\n\r\n                // Execute personalized stuff after to refresh it\r\n                self.afterToRefresh();\r\n\r\n            }\r\n        }).fail(function (message) {\r\n            message = self.processFailMessage(message);\r\n\r\n        }).always(function () {\r\n            self.endLoading();\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Refresh the current container\r\n     */\r\n    refreshDesignContainer: function (data) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Execute personalized stuff before to refresh it\r\n        self.beforeToRefresh(data);\r\n        //self.setActiveTab(data.elements);\r\n\r\n        $.extend(data.properties, {\r\n            editable: properties.editable,\r\n            contexttype: (properties.contexttype || \"\"),\r\n            idPageCache: properties.idPageCache,\r\n            idRender: properties.id,\r\n            messageValidation: properties.messageValidation,\r\n            uniqueId: properties.uniqueId,\r\n            visible:properties.visible,\r\n            xpath: properties.xpath,\r\n            mode: \"design\",\r\n            xpathContext: properties.xpathContext || \"\"\r\n        });\r\n\r\n\r\n        if (!self.isDisposed()) {\r\n            // Unregister children of container to replace in hash self.rendersById and self.rendersByXpath\r\n            self.unregisterChildren();\r\n            delete self.children;\r\n            delete self.childrenHash;\r\n\r\n            // update editable\r\n            if (self.properties.editable === false) {\r\n                data.container && data.container.properties ? (data.container.properties.editable = false) : \"\";\r\n            }\r\n\r\n            // Update the data\r\n            self.initializeData(data.container);\r\n\r\n            // Render the container again\r\n            var currentContainer = self.container;\r\n            var result = self.render();\r\n\r\n            if (self.properties.type == \"tabItem\") {\r\n                $(result).addClass(\"childrenActive\");\r\n            }\r\n\r\n            currentContainer && currentContainer.replaceWith(result);\r\n\r\n            // Execute personalized stuff after to refresh it\r\n            self.afterToRefresh();\r\n        }\r\n    },\r\n\r\n    beforeToRefresh: function () {\r\n        var self = this;\r\n\r\n        // Call beforeToRefresh of each children\r\n        for (var i = 0; i < self.children.length; i++) {\r\n            self.children[i].beforeToRefresh();\r\n        }\r\n    },\r\n\r\n    afterToRefresh: function () {\r\n        var self = this;\r\n\r\n        // Call beforeToRefresh of each children\r\n        for (var i = 0; i < self.children.length; i++) {\r\n            self.children[i].afterToRefresh();\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Re-execute children actions\r\n    */\r\n    triggerChildrenActions: function () {\r\n        var self = this;\r\n\r\n        var form = self.getFormContainer();\r\n        var children = self.children;\r\n\r\n        for (var i = 0, l = children.length; i < l; i++) {\r\n            var child = children[i];\r\n            var type = child.getElementType();\r\n\r\n            if (type === bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                child.triggerChildrenActions();\r\n            }\r\n            else if (type === bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                child.triggerRenderChange({ changed: false });\r\n            }\r\n        }\r\n    },\r\n\r\n\r\n    /*\r\n    * register actions container\r\n    */\r\n    registerActions: function (actions) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n\r\n        if (actions) {\r\n            form.actionController.buildActions(actions);\r\n        }\r\n    },\r\n\r\n    /*\r\n    * unregister children container\r\n    */\r\n    unregisterChildren: function () {\r\n        var self = this;\r\n\r\n        var form = self.getFormContainer();\r\n        var children = self.children;\r\n\r\n        for (var i = 0, l = children.length; i < l; i++) {\r\n            var child = children[i];\r\n            var type = child.getElementType();\r\n\r\n            if (type === bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                child.unregisterChildren();\r\n            }\r\n            else if (type === bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                form.unregisterRender(child);\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    * Replace child\r\n    */\r\n    replaceChild: function (element) {\r\n        var self = this;\r\n\r\n        var children = self.children;\r\n\r\n        for (var i = 0, l = children.length; i < l; i++) {\r\n            var child = children[i];\r\n\r\n            if (child.properties.uniqueId == element.properties.uniqueId) {\r\n                children.splice(i, 1);\r\n                children.splice(i, 0, element);\r\n                break;\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    * Gets child\r\n    */\r\n    getChildById: function (id) {\r\n\r\n        var self = this;\r\n\r\n        var children = self.children;\r\n\r\n        for (var i = 0, l = children.length; i < l; i++) {\r\n            var child = children[i];\r\n\r\n            if (child.properties.id == id) {\r\n                return child;\r\n            }\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Tablet Container Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the container class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.container.extend(\"bizagi.rendering.container\", {}, {\r\n    \r\n});\r\n","/*\r\n *   Name: Bizagi Render Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define a base render class with common stuff related to all renders\r\n */\r\n\r\nbizagi.rendering.element.extend(\"bizagi.rendering.render\", {\r\n    postRenderTimeout: 0,\r\n    maxRendersPerScreen: 50,\r\n    rendersExecuted: 0,\r\n    renderOptimization: false,\r\n    TYPE_QUERY_FORM: \"queryForm\",\r\n    startOptimization: function () {\r\n        bizagi.rendering.render.postRenderTimeout = 500;\r\n        bizagi.rendering.render.rendersExecuted = 0;\r\n        // Cancelled optimization temporally, because its on experimental stage\r\n        bizagi.rendering.render.renderOptimization = false;\r\n    },\r\n    stopOptimization: function () {\r\n        bizagi.rendering.render.postRenderTimeout = 0;\r\n        bizagi.rendering.render.rendersExecuted = 0;\r\n        bizagi.rendering.render.renderOptimization = false;\r\n    }\r\n}, {\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        var form = self.getFormContainer();\r\n\r\n        // Fill default properties\r\n        var properties = self.properties;\r\n\r\n        properties.included = (typeof properties.included != \"undefined\") ? bizagi.util.parseBoolean(properties.included) : false;\r\n        properties.uniqueId = Math.ceil(Math.random() * 1000000);\r\n        properties.displayName = properties.displayName || \"\";\r\n        properties.editable = (typeof properties.editable != \"undefined\") ? bizagi.util.parseBoolean(properties.editable) : true;\r\n        properties.visible = (typeof properties.visible != \"undefined\") ? bizagi.util.parseBoolean(properties.visible) : true;\r\n        properties.includedInResult = (typeof properties.includedInResult != \"undefined\") ? bizagi.util.parseBoolean(properties.includedInResult) : false;\r\n\r\n        var renderType = bizagi.util.normalizeType(properties.type);\r\n        if (/^hidden$/i.test(renderType)) {\r\n            properties.visible = false;\r\n        }\r\n\r\n        properties.required = (typeof properties.required != \"undefined\") ? bizagi.util.parseBoolean(properties.required) : false;\r\n        properties.submitOnChange = (typeof properties.submitOnChange != \"undefined\") ? bizagi.util.parseBoolean(properties.submitOnChange) : false;\r\n        properties.maxLength = properties.maxLength || 0;\r\n        properties.helpText = bizagi.util.trim(properties.helpText) || \"\";\r\n        properties.textFormat = properties.textFormat || {};\r\n        properties.valueFormat = properties.valueFormat || {};\r\n        properties.isHidden = (typeof properties.isHidden != \"undefined\") ? bizagi.util.parseBoolean(properties.isHidden) : false;\r\n        properties.visible = (properties.isHidden) ? false : properties.visible;\r\n\r\n        // Old color and background color\r\n        if (properties.color) {\r\n            properties.textFormat.color = properties.color;\r\n        }\r\n\r\n        if (properties.backgroundColor) {\r\n            properties.textFormat.backgroundColor = properties.backgroundColor;\r\n        }\r\n\r\n        // Non-editable fields cannot be required\r\n        properties.required = properties.editable ? properties.required : false;\r\n\r\n        // Override orientation from parent if not set\r\n        properties.orientation = properties.orientation || \"auto\";\r\n\r\n        // Check contexttype\r\n        properties.contexttype = (form.params && form.params.data && form.params.data.contextType) ? form.params.data.contextType : \"\";\r\n\r\n        // Save original properties\r\n        self.originalProperties = {\r\n            textFormat: {\r\n                color: properties.textFormat.color,\r\n                backgroundColor: properties.textFormat.backgroundColor\r\n            },\r\n            valueFormat: {\r\n                color: properties.textFormat.color,\r\n                backgroundColor: properties.textFormat.backgroundColor\r\n            },\r\n            visible: properties.visible,\r\n            editable: properties.editable,\r\n            required: properties.required,\r\n            labelAlign: properties.labelAlign,\r\n            valueAlign: properties.valueAlign\r\n        };\r\n\r\n        // Create value property\r\n        self.value = typeof (properties.value) !== \"undefined\" ? properties.value : null;\r\n\r\n        // Register original value property\r\n        self.properties.originalValue = self.value;\r\n        self.properties.previousValue = self.value;\r\n\r\n        // Calculate layout properties\r\n        self.calculateInitialLayoutProperties();\r\n    },\r\n    /*\r\n    *   Calculate aligns, display types, rtl and widths\r\n    */\r\n    calculateInitialLayoutProperties: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set visual defaults\r\n        properties.displayType = properties.displayType || \"normal\";\r\n        properties.labelAlign = properties.labelAlign || self.getDefaultLabelAlign(properties.displayType);\r\n        properties.valueAlign = properties.valueAlign || self.getDefaultValueAlign(properties.displayType);\r\n\r\n        // Check rtl orientation\r\n        if (properties.orientation === \"rtl\") {\r\n            properties.labelAlign = self.getRTLAlign(properties.labelAlign);\r\n            properties.valueAlign = self.getRTLAlign(properties.valueAlign);\r\n        }\r\n\r\n        // Calculate render with\r\n        var renderWidth = self.calculateRenderWidth(properties.labelWidth, properties.valueWidth, properties.displayType);\r\n        properties.labelWidth = renderWidth.label;\r\n        properties.valueWidth = renderWidth.control;\r\n\r\n        if (properties.layoutType === \"percentage\") {\r\n            properties.valueWidth = renderWidth.control;\r\n        }\r\n\r\n        if (properties.labelWidth == 0) {\r\n            properties.displayType = \"value\";\r\n            properties.valueWidth = renderWidth.control;\r\n        }\r\n\r\n        if (properties.valueWidth == 0) {\r\n            properties.displayType = \"label\";\r\n        }\r\n\r\n        if (properties.type === \"userfield\") {\r\n            if (properties.displayType === \"both\") {\r\n                properties.valueWidth = properties.valueWidth || 50;\r\n                properties.labelWidth = properties.labelWidth || 50;\r\n            } else if (properties.displayType === \"vertical\") {\r\n                properties.valueWidth = 100;\r\n                properties.labelWidth = 100;\r\n            } else {\r\n                properties.valueWidth = 100;\r\n                properties.labelWidth = 0;\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    *   Returns the element type\r\n    */\r\n    getElementType: function () {\r\n        return bizagi.rendering.element.ELEMENT_TYPE_RENDER;\r\n    },\r\n    /*\r\n    *   Returns the html templated element\r\n    */\r\n    render: function (renderTemplateName) {\r\n        return this.renderElement(renderTemplateName);\r\n    },\r\n    /*\r\n    *   Returns the html templated element\r\n    */\r\n    renderElement: function (renderTemplateName) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        // Start rendering deferred\r\n        self.renderingDeferred = new $.Deferred();\r\n\r\n        // Set render template\r\n        renderTemplateName = renderTemplateName || \"render\";\r\n        var renderTemplate = self.renderFactory.getTemplate(renderTemplateName);\r\n\r\n        // Resolve render label\r\n        var label = properties.displayName;\r\n        if (typeof label == \"string\") {\r\n            label = label.replaceAll(\"&\", \"&amp;\");\r\n            label = label.replaceAll(\"$\", \"&#36;\");\r\n            label = label.replaceAll(\"<\", \"&lt;\").replaceAll(\">\", \"&gt;\");\r\n            label = label.replaceAll(\"\\\"\", \"&#34;\").replaceAll(\"'\", \"&#39;\").replaceAll(\"/\", \"&#47;\");\r\n            label = label.replaceAll(\"\\\\n\", \"<br/>\");\r\n            label = label.replaceAll(\"\\n\", \"<br/>\");\r\n        }\r\n\r\n        var isFullRender = bizagi.util.detectDevice() !== \"desktop\" && (properties.type === \"association\" || properties.type === \"uploadecm\" || ((properties.type === \"actionLauncher\" || properties.type === \"polymorphicLauncher\") && bizagi.util.isTabletDevice()) || (properties.type === \"grid\" && !bizagi.util.isTabletDevice()));\r\n        var labelWidth = parseFloat(properties.labelWidth);\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(renderTemplate, {\r\n            label: label, helpText: properties.helpText,\r\n            editable: properties.editable,\r\n            isExtendedText: (properties.type == \"text\" && properties.isExtended),\r\n            orientation: properties.orientation,\r\n            uniqueId: properties.uniqueId,\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            tag: properties.tag,\r\n            displayType: properties.displayType,\r\n            displayOptionClass: self.getDisplayOptionClass(properties.displayType),\r\n            labelAlignClass: self.getAlignClass(properties.labelAlign),\r\n            valueAlignClass: self.getAlignClass(properties.valueAlign),\r\n            labelWidth: labelWidth,\r\n            stringLabelWidth: labelWidth + (properties.layoutType == 'pixels' ? 'px' : '%'),\r\n            valueWidth: parseFloat(properties.valueWidth),\r\n            stringValueWidth: parseFloat(properties.valueWidth) + (properties.layoutType == 'pixels' ? 'px' : '%'),\r\n            layoutType: properties.layoutType,\r\n            isDesign: self.getMode() === \"design\",\r\n            messageValidation: properties.messageValidation,\r\n            printVersion: form.params.printversion,\r\n            cssClass: properties.cssclass || \"\",\r\n            includedInResult: properties.includedInResult,\r\n            included: properties.included,\r\n            type: properties.type,\r\n            showFullRender: isFullRender,\r\n            required: properties.required,\r\n            helpText: properties.helpText\r\n        });\r\n\r\n        // Render internal control html\r\n        var result = self.internalRenderControl();\r\n        if (!result) {\r\n            result = \"\";\r\n        }\r\n\r\n        // Check if this is an async element or not\r\n        var async = typeof (result) === \"object\" && result.done;\r\n        if (!async) {\r\n            html = self.replaceControlHtml(html, result);\r\n\r\n        } else {\r\n            if (result.state() === \"resolved\") {\r\n                // Fetch resolved result\r\n                html = self.replaceControlHtml(html, self.resolveResult(result));\r\n                self.asyncRenderDeferred = null;\r\n            } else {\r\n                // Wait for result\r\n                self.asyncRenderDeferred = result;\r\n                html = self.replaceControlHtml(html, \"\");\r\n            }\r\n        }\r\n\r\n        return html;\r\n    },\r\n    /*\r\n    *   Returns the resolved result from a promise when the promise has been executed already\r\n    */\r\n    resolveResult: function (promise) {\r\n        return bizagi.resolveResult(promise);\r\n    },\r\n    /*\r\n    *   Check if the jquery element is ready or not\r\n    */\r\n    isRendered: function () {\r\n        var self = this;\r\n        if (!self.renderingDeferred) {\r\n            return false;\r\n        }\r\n        return self.renderingDeferred.promise();\r\n    },\r\n    /*\r\n    *   Renders the control html\r\n    */\r\n    internalRenderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        self.control = null;\r\n\r\n        if (self.renderFactory.printVersion) {\r\n            properties.editable = false;\r\n            return self.renderControl();\r\n        } else if (properties.editable) {\r\n            return self.renderControl();\r\n        }\r\n\r\n        return self.renderReadOnly();\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRenderElement: function (element) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set element variable\r\n        self.element = element;\r\n\r\n        if (properties.submitOnChange)\r\n            self.configureSubmitOnChange();\r\n\r\n        // Process internal layout\r\n        isLabelFormat = true;\r\n\r\n        var executePostRender = function (_element) {\r\n            if (bizagi.rendering.render.renderOptimization &&\r\n                bizagi.rendering.render.rendersExecuted > bizagi.rendering.render.maxRendersPerScreen) {\r\n\r\n                // Execute post-render control\r\n                setTimeout(function () {\r\n                    self.internalPostRender(_element);\r\n                    bizagi.rendering.render.postRenderTimeout += 50;\r\n                }, bizagi.rendering.render.postRenderTimeout);\r\n\r\n            } else {\r\n                self.internalPostRender(_element);\r\n            }\r\n            bizagi.rendering.render.rendersExecuted++;\r\n        };\r\n\r\n        if (self.asyncRenderDeferred) {\r\n            // Wait for async result\r\n            $.when(self.asyncRenderDeferred)\r\n                .done(function (html) {\r\n                    var control = self.getControl();\r\n                    if (typeof self.emptyControlByAsyncRenderDeferred == \"function\") {\r\n                        self.emptyControlByAsyncRenderDeferred();\r\n                    }\r\n                    control.append(html);\r\n\r\n                    // Execute post-render control\r\n                    executePostRender(element);\r\n                    self.processLayout(!isLabelFormat, self.properties.valueFormat || {});\r\n                });\r\n        } else {\r\n            // Execute post-render control\r\n            executePostRender(element);\r\n        }\r\n    },\r\n    /*\r\n    *   Executes the post render handlers\r\n    */\r\n    internalPostRender: function (element) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n\r\n        self.control = self.getControl();\r\n\r\n        // Resolve rendering deferred\r\n        if (self.renderingDeferred) {\r\n            self.renderingDeferred.resolve();\r\n        }\r\n\r\n        // Execute post-renders\r\n        if (properties.editable) {\r\n            // Post-render editable version\r\n            if (self.renderFactory.printVersion && self.postRenderPrintVersion) {\r\n                self.postRenderPrintVersion();\r\n            } else {\r\n                self.postRender();\r\n            }\r\n\r\n        } else {\r\n            // Post-render readonly version\r\n            self.postRenderReadOnly(element);\r\n        }\r\n\r\n        // Perform execution mode methods\r\n        if (mode == \"execution\") {\r\n            self.performExecutionModeMethods();\r\n        } else {\r\n            self.performDesignModeMethods();\r\n        }\r\n\r\n        self.processLayout(isLabelFormat, self.properties.textFormat || {});\r\n        self.processLayout(!isLabelFormat, self.properties.valueFormat || {});\r\n    },\r\n    /*\r\n    *   Execute runtime only methods\r\n    */\r\n    performExecutionModeMethods: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        if (self.getFormType() == self.Class.TYPE_QUERY_FORM) {\r\n            self.configureHandlersQueryForm();\r\n        }\r\n\r\n        // Apply handlers\r\n        if (properties.editable) {\r\n            self.configureHandlers();\r\n        } else {\r\n            self.configureHandlersReadOnly();\r\n        }\r\n\r\n        // Set initial value\r\n        self.internalSetInitialValue();\r\n    },\r\n    /**\r\n     * Execute design only methods\r\n     */\r\n    performDesignModeMethods: function () {\r\n        var self = this;\r\n\r\n        // Execute custom code for each render\r\n        self.configureDesignView();\r\n\r\n        // Set initial value\r\n        self.internalSetInitialValue();\r\n    },\r\n    /*\r\n    *   Replaces a {{control}} string in the specified element\r\n    */\r\n    replaceControlHtml: function (html, replace) {\r\n        html = html || \"\";\r\n        replace = replace || \"\";\r\n        return html.replace(\"{{control}}\", replace);\r\n    },\r\n    /*\r\n    *   Return the rendered element\r\n    */\r\n    getRenderedElement: function () {\r\n        if (bizagi.util.isEmpty(this.element)) {\r\n            bizagi.log(\" render hasn't been rendered!\", this, \"error\");\r\n        }\r\n\r\n        return this.element;\r\n    },\r\n    /*\r\n    *   Sets the initial value for the renders\r\n    */\r\n    internalSetInitialValue: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        self.internalSetInitialValueFlag = true;\r\n\r\n        // Set the initial value\r\n        if (properties.editable) {\r\n            if (!bizagi.util.isEmpty(self.value)) {\r\n                self.setDisplayValue(self.value);\r\n            }\r\n        } else {\r\n            if (!bizagi.util.isEmpty(self.value)) {\r\n                self.setDisplayValue(self.value);\r\n            }\r\n        }\r\n        self.internalSetInitialValueFlag = false;\r\n    },\r\n    /*\r\n    * Public method to determine if a value is valid or not\r\n    */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var message;\r\n        var inlineAdd = self.grid && self.grid.properties && self.grid.properties.inlineAdd;\r\n\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.visible) === false) {\r\n            return true;\r\n        }\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.editable) === false && !inlineAdd) {\r\n            return true;\r\n        }\r\n\r\n        // Clear error message\r\n        self.setValidationMessage(\"\");\r\n\r\n        // Check required\r\n        if (bizagi.util.parseBoolean(properties.required)) {\r\n            var form = self.getFormContainer();\r\n            var hasValue = false;\r\n            var renders = self.grid ? [self] : form.getRenders(properties.xpath);\r\n            var isQueryForm = /^query/i.test(properties.type);\r\n\t               \r\n            renders.filter(function (render) {\r\n                return render.properties.id == properties.id;\r\n            }).forEach(function (render) {\r\n                if (render.hasValue() && (render.properties.editable || inlineAdd)) {\r\n                    hasValue = true;\r\n                    return false;\r\n                }\r\n            });\r\n\r\n            if (!hasValue && !self.properties.isClone) {\r\n                message = self.getResource(\"render-required-text\").replaceAll(\"#label#\", properties.displayName);\r\n                var messageData = {xpath: properties.xpath, message: message};\r\n\r\n                if (isQueryForm) {\r\n                    messageData = $.extend({}, messageData, {\r\n                        id: properties.id,\r\n                        isQuery: isQueryForm\r\n                    });\r\n                }\r\n\r\n                invalidElements.push(messageData);\r\n                return false;\r\n            }\r\n        }\r\n\r\n        // Check retypes\r\n        if (properties.retype == \"duplicate\") {\r\n            // Don't process cloned renders, just originals\r\n            if (self.cloneRender) {\r\n                if (self.cloneRender.getValue() != self.getValue()) {\r\n                    message = self.getResource(\"render-text-retype-error\");\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    return false;\r\n                }\r\n            }\r\n        } else if (properties.retype == \"double\") {\r\n            var control = $(\"input\", self.element);\r\n\r\n            //Waits until the control has the second value written\r\n            if (control && control.data(\"oldValue\")) {\r\n                if (control.val() === \"\") {\r\n\r\n                    message = self.getResource(\"render-text-retype-error\");\r\n                    invalidElements.push({\r\n                        xpath: properties.xpath,\r\n                        message: message\r\n                    });\r\n\r\n                    return false;\r\n                } else if (control.val() != control.data(\"oldValue\")) {\r\n                    message = self.getResource(\"render-text-retype-error\");\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n\r\n        // Check maxlength\r\n        var columnEditable = self.grid && self.grid.getColumn ? self.grid.getColumn(self.properties.xpath).properties.editable : true;\r\n        if (properties.type !== \"userPassword\" && properties.maxLength !== undefined && properties.maxLength > 0 && bizagi.util.isNumeric(properties.maxLength)) {\r\n            if (columnEditable || (!columnEditable && self.controlValueIsChanged())) {\r\n                var maxLength = new Number(properties.maxLength);\r\n                var value = self.getValue();\r\n\r\n                if (value && value.toString().length > maxLength) {\r\n                    message = self.getResource(\"render-text-maxLength-error\").replaceAll(\"#maxLength#\", maxLength);\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    /*\r\n    *   Check if a render has no value for required validation\r\n    */\r\n    hasValue: function () {\r\n        var self = this;\r\n        // Next line decides if only spaces are accepted as valid texts or not. Anyway the spaces are still saved as self.value has not changed\r\n        var value = self.getValue();\r\n        value = (value && self.properties.type === \"text\") ? value.trim() : value;\r\n        return !bizagi.util.isEmpty(value);\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {       \r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed in read-only mode\r\n    */\r\n    postRenderReadOnly: function () {\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers when the control is readonly\r\n    */\r\n    configureHandlersReadOnly: function () {\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour when rendering in design mode\r\n    */\r\n    configureDesignView: function () {\r\n    },\r\n    /*\r\n    *   Method to process the render the layout\r\n    */\r\n    processLayout: function (isLabelFormat, format) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (self.getControl() == null) return;\r\n\r\n        // Set customizations\r\n        format = format || {};\r\n\r\n        if (format.color) {\r\n            self.changeColor(format.color, isLabelFormat);\r\n        }\r\n        if (format.background) {\r\n            self.changeBackgroundColor(format.background);\r\n        }\r\n        //if bold is true in modeler, we receive nothing in execution (!formal.bold)\r\n        if (format.bold || !format.bold || !isLabelFormat) {\r\n            self.changeFontBold(format.bold, isLabelFormat);\r\n        }\r\n        if (format.italic) {\r\n            self.changeFontItalic(format.italic, isLabelFormat);\r\n        }\r\n        if (format.underline) {\r\n            self.changeFontUnderline(format.underline, isLabelFormat);\r\n        }\r\n        if (format.strikethru) {\r\n            self.changeFontStrikethru(format.strikethru, isLabelFormat);\r\n        }\r\n        if (format.size) {\r\n            self.changeFontSize(format.size, isLabelFormat);\r\n        }\r\n\r\n        // Set required and visiblity\r\n        properties.required = properties.required != undefined ? bizagi.util.parseBoolean(properties.required) : false;\r\n        var visible = properties.visible != undefined ? bizagi.util.parseBoolean(properties.visible) : true;\r\n        if (properties.required) {\r\n            self.changeRequired(properties.required);\r\n        }\r\n        if (!visible) {\r\n            self.changeVisibility(visible);\r\n        }\r\n    },\r\n    /*\r\n    *   Sets the internal value\r\n    */\r\n    setValue: function (value, triggerEvents) {\r\n        var self = this;\r\n        triggerEvents = triggerEvents !== undefined ? triggerEvents : true;\r\n\r\n        if (!(bizagi.util.identicalObjects(value, self.value))) {\r\n            // set previous value\r\n            self.properties.previousValue = self.properties.originalValue = self.value;\r\n\r\n            // Change internal value\r\n            self.value = self.properties.value = value;\r\n            if (self.properties.required && self.getMode() == \"execution\") {\r\n\r\n                if (self.checkRequired([])) {\r\n                    self.changeRequiredLabel(false);\r\n                } else {\r\n                    self.changeRequiredLabel(true);\r\n                }\r\n            }\r\n\r\n            // Trigger events\r\n            if (triggerEvents && !self.internalSetInitialValueFlag) {\r\n                self.triggerRenderChange();\r\n                self.triggerRenderValidate();\r\n            }\r\n        }\r\n    },\r\n\r\n    checkRequired: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (bizagi.util.parseBoolean(properties.required)) {\r\n            if (!self.hasValue()) {\r\n                message = self.getResource(\"render-required-text\").replaceAll(\"#label#\", properties.displayName);\r\n                invalidElements.push({\r\n                    xpath: properties.xpath,\r\n                    message: message\r\n                });\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    },\r\n\r\n    validateInputRetype: function () {\r\n        var self = this;\r\n        if (self.properties.retype && self.cloneRender) {\r\n            return self.getValue() == self.cloneRender.getValue();\r\n        }\r\n        return true;\r\n    },\r\n\r\n    /*\r\n    *   Triggers the render change event\r\n    */\r\n    triggerRenderChange: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n        params.changed = params.changed !== undefined ? params.changed : true;\r\n        self.triggerHandler(\"renderchange\", {render: self, changed: params.changed});\r\n    },\r\n    /*\r\n    *   Triggers the render validate event\r\n    */\r\n    triggerRenderValidate: function () {\r\n        var self = this;\r\n        self.triggerHandler(\"rendervalidate\", {render: self});\r\n    },\r\n    /*\r\n    *   Sets the value in the rendered control\r\n    */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Set internal value\r\n        self.setValue(value, false);\r\n\r\n        if (!self.properties.editable && (self.properties.display !== \"check\" || (self.properties.display === \"check\" && bizagi.override.enableCheck === true))) {\r\n            // Render as simple value\r\n            var displayValue = self.getDisplayValue(value);\r\n            if (typeof (displayValue) == \"string\" || typeof (displayValue) == \"number\") {\r\n                displayValue = bizagi.util.sanitizeHTML(displayValue);\r\n                $(control).html(\"<label class='readonly-control'>\" + displayValue + \"</label>\");\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    *   Returns the internal value\r\n    */\r\n    getValue: function () {\r\n        return this.value;\r\n    },\r\n    /*\r\n    *   Returns the value to display, ex. non-editable renders\r\n    */\r\n    getDisplayValue: function () {\r\n        return this.getValue();\r\n    },\r\n    /*\r\n    *   Template method to get the label element\r\n    */\r\n    getLabel: function () {\r\n        bizagi.util.mustImplement(\"getLabel\");\r\n    },\r\n    /*\r\n    *   Template method to get the control element\r\n    */\r\n    getControl: function () {\r\n        bizagi.util.mustImplement(\"getControl\");\r\n    },\r\n    /*\r\n    *   Template method to get the control filler element\r\n    */\r\n    getControlFiller: function () {\r\n        bizagi.util.mustImplement(\"getControlFiller\");\r\n    },\r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    renderControl: function () {\r\n    },\r\n    /*\r\n    *   Adds a validation message to the render\r\n    */\r\n    setValidationMessage: function (message) {\r\n        this.validationMessage = message;\r\n    },\r\n    /*\r\n    *   Method to render non editable values\r\n    */\r\n    renderReadOnly: function () {\r\n        var result = this.getValue();\r\n        var readOnlyValue = \"\";\r\n\r\n        if (bizagi.util.isObject(result) && typeof (result.value) !== \"undefined\") {\r\n            readOnlyValue = bizagi.util.sanitizeHTML(result.value);\r\n        } else if (!bizagi.util.isEmpty(result)) {\r\n            if (bizagi.util.isString(result)) {\r\n                readOnlyValue = bizagi.util.decodedDisplayValue(result);\r\n            } else {\r\n                readOnlyValue = result;\r\n            }\r\n        }\r\n\r\n        return readOnlyValue;\r\n    },\r\n\r\n    /*\r\n    *  Method to render print version\r\n    */\r\n    postRenderPrintVersion: function () {\r\n    },\r\n\r\n    /*\r\n    *   Customizes render display type with custom css classes\r\n    */\r\n    changeDisplayOption: function (displayType) {\r\n        this.properties.displayType = displayType;\r\n    },\r\n\r\n    /*\r\n    *   Return the right display option class\r\n    */\r\n    getDisplayOptionClass: function (displayType) {\r\n        return \"\";\r\n    },\r\n\r\n    /*\r\n    *   Customizes render label align\r\n    */\r\n    changeLabelAlign: function (alignType) {\r\n        this.properties.labelAlign = alignType;\r\n    },\r\n\r\n    /*\r\n    *   Customizes render value align\r\n    */\r\n    changeValueAlign: function (alignType) {\r\n        this.properties.valueAlign = alignType;\r\n    },\r\n\r\n    /*\r\n    *   Return the right align class\r\n    */\r\n    getAlignClass: function (alignType) {\r\n        return \"\";\r\n    },\r\n\r\n    /*\r\n    *   Customizes render label and value width\r\n    */\r\n    customizeRenderWidth: function () {\r\n    },\r\n\r\n    /* Customizes render color*/\r\n    changeColor: function (color, isLabelFormat) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var label = self.getLabel();\r\n        var isLabelFormat = (typeof isLabelFormat != \"undefined\" || isLabelFormat != null) ? isLabelFormat : true;\r\n\r\n        if (control && label) {\r\n            if (color != 'none') {\r\n                // Hide - show the render\r\n                if (self.properties.displayType === \"value\" || !isLabelFormat) {\r\n                    self.getElementsToStylize(self.getControl()).css(\"color\", color, \"!important\");\r\n                    self.getControl().find(\"*\").each(function (i, element) {\r\n                        self.getElementsToStylize(element).css(\"color\", color, \"!important\");\r\n                    });\r\n                } else {\r\n                    self.element.each(function () {\r\n                        this.style.setProperty('color', color, 'important');\r\n                    });\r\n\r\n                    if (self.properties.type == \"grid\") {\r\n                        self.getControl().find(\".bz-mobile-grid__header-title\").each(function () {\r\n                            this.style.setProperty('color', color, 'important');\r\n                        });\r\n                    }\r\n\r\n                    self.getLabel().find(\"label\").css(\"color\", color, \"!important\");\r\n                    if (self.properties.editable === false) {\r\n                        self.getElementsToStylize(self.getControl()).css(\"color\", color, \"!important\");\r\n                        self.getElementsToStylize($(\"label\", self.getControl()).css(\"color\", color, \"!important\"));\r\n                    }\r\n                }\r\n            } else {\r\n                self.element.css(\"color\", \"\");\r\n                self.getLabel().find(\"label\").css(\"color\", \"\");\r\n                self.getControl().css(\"color\", \"\");\r\n\r\n                self.getControl().find(\"input, textarea\").each(function (i, element) {\r\n                    var originalColor = $(element).data(\"originalColor\") || \"\";\r\n                    self.getElementsToStylize(element).css(\"color\", originalColor);\r\n                });\r\n            }\r\n        }\r\n    },\r\n\r\n    /* Customizes render background color*/\r\n    changeBackgroundColor: function (color) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var label = self.getLabel();\r\n\r\n        if (control && label) {\r\n            if (color != 'none') {\r\n                self.element.each(function () {\r\n                    this.style.setProperty('background-color', color, 'important');\r\n                });\r\n\r\n                if (typeof (label.find('label').style) !== \"undefined\") {\r\n                    self.getLabel().find(\"label\").style(\"background-color\", color, \"important\");\r\n                } else {\r\n                    self.getLabel().find(\"label\").css(\"background-color\", color, \"!important\");\r\n                }\r\n\r\n                var currentStyle = self.getLabel().attr(\"style\");\r\n                currentStyle += \"; background-color:\" + color + \"!important\";\r\n                self.getLabel().attr(\"style\", currentStyle);\r\n            } else {\r\n                self.element.css(\"background-color\", \"\");\r\n                self.getLabel().find(\"label\").css(\"background-color\", \"\");\r\n                self.getControl().css(\"background-color\", \"\");\r\n                self.getControl().find(\"input, textarea\").each(function (i, element) {\r\n                    var originalColor = $(element).data(\"originalColor\") || \"\";\r\n                    $(element).css(\"background-color\", originalColor);\r\n                });\r\n            }\r\n        }\r\n    },\r\n\r\n    /* Returns the formatting label to be used for bold, italic, underline, strikethrough and size*/\r\n    getFormattingLabel: function () {\r\n        var self = this;\r\n        return self.getLabel().find(\"label\");\r\n    },\r\n\r\n    /* Customizes the font weight */\r\n    changeFontBold: function (bold, isLabelFormat) {\r\n        var self = this;\r\n        var isLabelFormat = (typeof isLabelFormat != \"undefined\" || isLabelFormat != null) ? isLabelFormat : true;\r\n\r\n        // Hide - show the render\r\n        if (bizagi.util.parseBoolean(bold) != false && isLabelFormat) {\r\n            self.getFormattingLabel().css(\"font-weight\", \"bold\", \"!important\");\r\n            self.getControl().each(function (i, element) {\r\n                $(element).css(\"font-weight\", \"bold\", \"!important\");\r\n            });\r\n\r\n        } else {\r\n            if (isLabelFormat)\r\n                self.getFormattingLabel().css(\"font-weight\", \"normal\", \"!important\");\r\n        }\r\n        if (!isLabelFormat) {\r\n            if (bizagi.util.parseBoolean(bold) == true) {\r\n                self.getControl().find(\"*\").each(function (i, element) {\r\n                    $(element).css(\"font-weight\", \"bold\", \"!important\");\r\n                });\r\n            } else {\r\n                self.getControl().find(\"*\").each(function (i, element) {\r\n                    $(element).css(\"font-weight\", \"normal\", \"!important\");\r\n                });\r\n                self.getControl().css(\"font-weight\", \"normal\", \"!important\");\r\n            }\r\n        }\r\n    },\r\n\r\n    controlValueIsChanged: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var value = self.getValue();\r\n        var compareValue = properties.originalValue;\r\n        var baseValue = properties.defaultValue;\r\n        var result = true;\r\n        var renderType = bizagi.util.normalizeType(properties.type);\r\n\r\n        // Flag to force to collect data\r\n        if ($.forceCollectData) {\r\n            return true;\r\n        }\r\n\r\n        // Verify if control has been ready\r\n        if (renderType === \"grid\" && self.ready().state() === \"pending\") {\r\n            return false;\r\n        }\r\n\r\n        if ([\"combo\", \"queryCombo\", \"list\", \"queryList\",\"radio\", \"queryRadio\"].includes(renderType) || /^cascadingcombo$/i.test(renderType)) {\r\n            if (value && value.length !== undefined) {\r\n                value = value[0];\r\n            }\r\n            if (compareValue && compareValue.length !== undefined) {\r\n                compareValue = compareValue[0];\r\n            }\r\n            if (baseValue && baseValue.length !== undefined) {\r\n                baseValue = baseValue[0];\r\n            }\r\n            value = value && value.id ? value.id : value;\r\n            compareValue = compareValue && compareValue.id ? compareValue.id : compareValue;\r\n            baseValue = baseValue && baseValue.id ? baseValue.id : baseValue;\r\n            if (typeof baseValue != \"undefined\" && baseValue != null) {\r\n                result = (compareValue == value) && (compareValue != baseValue) ? false : true;\r\n            } else {\r\n                result = (compareValue == value) ? false : true;\r\n            }\r\n        } else if (renderType === \"boolean\" || renderType === \"queryBoolean\" || renderType === \"queryCheck\") {\r\n            result = (bizagi.util.parseBoolean(compareValue) == bizagi.util.parseBoolean(value)) ? false : true;\r\n        } else if (renderType === \"searchNumber\") {\r\n            result = !!(value);\r\n        } else if (renderType === \"number\") {\r\n            if ((value === null || value === \"\") && (compareValue === null || compareValue === \"\")) {\r\n                result = false;\r\n            } else {\r\n                result = (compareValue === value) ? false : true;\r\n            }\r\n        } else if (renderType === \"text\") {\r\n            if ((value === null || value === \"\") && (compareValue === null || compareValue === \"\")) {\r\n                result = false;\r\n            } else {\r\n                result = (compareValue === value) ? false : true;\r\n            }\r\n        } else if (renderType === \"date\") {\r\n            if (!compareValue && !value) {\r\n                result = false;\r\n            } else {\r\n                result = (compareValue == value) ? false : true;\r\n            }\r\n        } else if (renderType === \"actionLauncher\") {\r\n            //Object must be an array\r\n            result = false;\r\n            var compareValueObj = [];\r\n            try {\r\n                if (typeof compareValue === \"string\") {\r\n                    compareValueObj = JSON.parse(compareValue);\r\n                } else {\r\n                    compareValueObj = compareValue;\r\n                }\r\n            } catch (e) {\r\n            }\r\n\r\n            var _findAction = function (guid, targetObj) {\r\n                guid = guid || \"\";\r\n                targetObj = targetObj || [];\r\n                var result = false;\r\n                for (var i = 0, l = targetObj.length; i < l; i++) {\r\n                    if (targetObj[i].guidAction == guid) {\r\n                        result = true;\r\n                        break;\r\n                    }\r\n                }\r\n                return result;\r\n            };\r\n\r\n            if (compareValueObj.length == value.length) {\r\n                for (var i = 0, l = compareValueObj.length; i < l; i++) {\r\n                    if (!_findAction(compareValueObj[i].guidAction, value)) {\r\n                        result = true;\r\n                    }\r\n                }\r\n\r\n            } else {\r\n                result = true;\r\n            }\r\n        } else if (renderType === \"polymorphicLauncher\" || renderType === \"entityTemplate\") {\r\n            //Object must be an array\r\n            if (compareValue.length != value.length) {\r\n                result = true;\r\n            } else {\r\n                result = (JSON.encode(value) == JSON.encode(compareValue)) ? false : true;\r\n            }\r\n        } else if (renderType === \"image\") {\r\n            if (compareValue == null && value.indexOf(true) < 0) {\r\n                result = false;\r\n            } else {\r\n                result = true;\r\n            }\r\n        } else if (renderType === \"searchList\") {\r\n            var objectValue = {};\r\n            try {\r\n                objectValue = JSON.parse(value);\r\n            } catch (e) {\r\n                console.log(\"Error when detect change value on searchList control\")\r\n            }\r\n            result = (JSON.encode(compareValue) == JSON.encode(objectValue.value)) ? false : true;\r\n        } else {\r\n            result = (compareValue === value) ? false : true;\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /* Customizes the font italic style */\r\n    changeFontItalic: function (italic, isLabelFormat) {\r\n        var self = this;\r\n        var isLabelFormat = (typeof isLabelFormat != \"undefined\" || isLabelFormat != null) ? isLabelFormat : true;\r\n\r\n        // Hide - show the render\r\n        if (self.properties.displayType == \"value\" || !isLabelFormat) {\r\n            if (bizagi.util.parseBoolean(italic) == true) {\r\n                if (isLabelFormat)\r\n                    self.getFormattingLabel().css(\"font-style\", \"italic\", \"!important\");\r\n\r\n                if (self.properties.editable) {\r\n                    self.getControl().find(\"*\").each(function (i, element) {\r\n                        self.getElementsToStylize(element).css(\"font-style\", \"italic\", \"!important\");\r\n                    });\r\n                } else {\r\n                    self.getElementsToStylize(self.getControl()).css(\"font-style\", \"italic\", \"!important\");\r\n                }\r\n            } else {\r\n                if (isLabelFormat)\r\n                    self.getFormattingLabel().css(\"font-style\", \"normal\", \"!important\");\r\n\r\n                if (self.properties.editable) {\r\n                    self.getControl().find(\"*\").each(function (i, element) {\r\n                        self.getElementsToStylize(element).css(\"font-style\", \"normal\", \"!important\");\r\n                    });\r\n                } else {\r\n                    self.getElementsToStylize(self.getControl()).css(\"font-style\", \"normal\", \"!important\");\r\n                }\r\n            }\r\n        } else {\r\n            if (bizagi.util.parseBoolean(italic) == true) {\r\n                self.getFormattingLabel().css(\"font-style\", \"italic\", \"!important\");\r\n            } else {\r\n                self.getFormattingLabel().css(\"font-style\", \"normal\", \"!important\");\r\n            }\r\n        }\r\n    },\r\n\r\n    /* Customizes the font underline */\r\n    changeFontUnderline: function (underline, isLabelFormat) {\r\n        var self = this;\r\n        var textFormat = self.properties.textFormat || {};\r\n        var valueFormat = self.properties.valueFormat || {};\r\n        var strikethru = bizagi.util.parseBoolean(textFormat.strikethru) ? \"line-through \" : \"\";\r\n        var valuestrikethru = bizagi.util.parseBoolean(valueFormat.strikethru) ? \"line-through \" : \"\";\r\n        var isLabelFormat = (typeof isLabelFormat != \"undefined\" || isLabelFormat != null) ? isLabelFormat : true;\r\n\r\n        // Hide - show the render\r\n        if (bizagi.util.parseBoolean(underline) == true && isLabelFormat) {\r\n            self.getFormattingLabel().css(\"text-decoration\", strikethru + \"underline\", \"!important\");\r\n            self.getControl().each(function (i, element) {\r\n                self.getElementsToStylize(element).css(\"text-decoration\", strikethru + \"underline\");\r\n            });\r\n        } else {\r\n            if (isLabelFormat)\r\n                self.getFormattingLabel().css(\"text-decoration\", strikethru, \"!important\");\r\n        }\r\n        if (self.properties.displayType == \"value\" || !isLabelFormat) {\r\n            if (bizagi.util.parseBoolean(underline) == true) {\r\n                if (self.properties.editable) {\r\n                    self.getControl().find(\"*\").each(function (i, element) {\r\n                        self.getElementsToStylize(element).css(\"text-decoration\", valuestrikethru + \"underline\", \"!important\");\r\n                    });\r\n                } else {\r\n                    self.getElementsToStylize(self.getControl()).css(\"text-decoration\", valuestrikethru + \"underline\", \"!important\");\r\n                }\r\n            } else {\r\n                self.getControl().find(\"*\").each(function (i, element) {\r\n                    self.getElementsToStylize(element).css(\"text-decoration\", valuestrikethru, \"!important\");\r\n                });\r\n            }\r\n        }\r\n    },\r\n\r\n    /* Customizes the font Strikethrough property */\r\n    changeFontStrikethru: function (strikethru, isLabelFormat) {\r\n        var self = this;\r\n        var textFormat = self.properties.textFormat || {};\r\n        var valueFormat = self.properties.valueFormat || {};\r\n        var underline = bizagi.util.parseBoolean(textFormat.underline) ? \"underline \" : \"\";\r\n        var valueunderline = bizagi.util.parseBoolean(valueFormat.underline) ? \"underline \" : \"\";\r\n        var isLabelFormat = (typeof isLabelFormat != \"undefined\" || isLabelFormat != null) ? isLabelFormat : true;\r\n\r\n        // Hide - show the render\r\n        if (bizagi.util.parseBoolean(strikethru) == true && isLabelFormat) {\r\n            self.getFormattingLabel().css(\"text-decoration\", underline + \"line-through\", \"!important\");\r\n        } else {\r\n            if (isLabelFormat)\r\n                self.getFormattingLabel().css(\"text-decoration\", underline, \"!important\");\r\n        }\r\n\r\n        if (self.properties.displayType == \"value\" || !isLabelFormat) {\r\n            if (bizagi.util.parseBoolean(strikethru) == true) {\r\n                if (self.properties.editable) {\r\n                    self.getControl().find(\"*\").each(function (i, element) {\r\n                        self.getElementsToStylize(element).css(\"text-decoration\", valueunderline + \"line-through\", \"!important\");\r\n                    });\r\n                } else {\r\n                    self.getElementsToStylize(self.getControl()).css(\"text-decoration\", valueunderline + \"line-through\", \"!important\");\r\n                }\r\n            } else {\r\n                if (self.properties.editable) {\r\n                    self.getControl().find(\"*\").each(function (i, element) {\r\n                        self.getElementsToStylize(element).css(\"text-decoration\", valueunderline, \"!important\");\r\n                    });\r\n                } else {\r\n                    self.getElementsToStylize(self.getControl()).css(\"text-decoration\", valueunderline, \"!important\");\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    /* Customizes the font size property */\r\n    changeFontSize: function (size, isLabelFormat) {\r\n        var self = this;\r\n        var isLabelFormat = (typeof isLabelFormat != \"undefined\" || isLabelFormat != null) ? isLabelFormat : true;\r\n\r\n        // Hide - show the render\r\n        if (size != \"0\") {\r\n            var label = self.getFormattingLabel();\r\n            var newFontSize = (100 + Number(size) * 10) + \"%\";\r\n            if (isLabelFormat) {\r\n                label.css(\"font-size\", newFontSize, \"!important\");\r\n            }\r\n            if (self.properties.displayType == \"value\" || !isLabelFormat) {\r\n                var control = self.getControl();\r\n                if (typeof control.children() == \"object\" && control.children().length > 0) {\r\n                    self.getElementsToStylize(control.children()).css(\"font-size\", newFontSize, \"!important\");\r\n                } else {\r\n                    self.getElementsToStylize(control).css(\"font-size\", newFontSize, \"!important\");\r\n                    // Next line applies to Cascading combo and combo in order to increase the control space with large value fonts\r\n                    if (self.properties.type.indexOf(\"ombo\") != -1 && size > 4) (\".ui-selectmenu\", control).children(0).height(2 * size + 20);\r\n                }\r\n\r\n                self.getElementsToStylize(control.find(\".ui-bizagi-render-date\")).css(\"line-height\", \"normal\");\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * in mobiles, don't apply styles to icon's elements\r\n     */\r\n    getElementsToStylize: function (context) {\r\n        return $(context);\r\n    },\r\n\r\n    /* Changes the render visibility*/\r\n    changeVisibility: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Hide - show the render\r\n        if (bizagi.util.parseBoolean(argument) == true) {\r\n            if (properties.type !== \"hidden\") {\r\n                self.element.show();\r\n                self.element.css(\"display\", \"\");\r\n\r\n                if (properties.required) {\r\n                    if (!self.hasValue()) {\r\n                        self.changeRequiredLabel(true);\r\n                    }\r\n                }\r\n            }\r\n        } else if (self.element) {\r\n            self.element.hide();\r\n        }\r\n\r\n        // Update properties\r\n        properties.visible = argument;\r\n    },\r\n    /* Changes the render editability*/\r\n    changeEditability: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        // Renders again\r\n        properties.editable = bizagi.util.parseBoolean(argument);\r\n\r\n        // Clears control\r\n        control.empty();\r\n\r\n        if (typeof self.internalRenderControl == \"function\") {\r\n            $.when(self.internalRenderControl()).done(function (html) {\r\n                if (typeof self.emptyControlByChangeEditability == \"function\")\r\n                    self.emptyControlByChangeEditability();\r\n                if (!self.asyncRenderDeferred)\r\n                    control.append(html);\r\n                self.postRenderElement(self.element);\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n    * change cell editability and attach bindings\r\n    */\r\n    changeEditabilityCellControl: function (argument, key, xpath) {\r\n        var self = this,\r\n            properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        var renderColumn = self.grid.getColumn(xpath);\r\n        var decorated = renderColumn.getDecorated(key);\r\n\r\n        // Renders again\r\n        properties.editable = bizagi.util.parseBoolean(argument);\r\n\r\n        // Clears control\r\n        control.empty();\r\n        if (typeof self.internalRenderControl == \"function\") {\r\n            $.when(self.internalRenderControl()).done(function (html) {\r\n                if (!self.asyncRenderDeferred) {\r\n                    control.append(html);\r\n                }\r\n\r\n                self.postRenderElement(self.element);\r\n\r\n                if (properties.editable) {\r\n\r\n                    renderColumn.bind(\"rendered\", function () {\r\n                        renderColumn.readyDeferred.resolve();\r\n                    });\r\n\r\n                    decorated.unbind(\"renderchange\");\r\n\r\n                    // If the render changes set the flag on\r\n                    decorated.bind(\"renderchange\", function (render, args) {\r\n                        renderColumn.changed = true;\r\n                        self.grid.onCellChange(renderColumn, null, key, args);\r\n                    });\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var label = properties.displayName || \"\";\r\n        var labelElement = $(\"label\", self.getLabel());\r\n        var controlElement = self.getControl();\r\n\r\n        // Update properties\r\n        properties.required = argument;\r\n\r\n        // Changes label\r\n        if (self.getMode() == \"execution\" && self.checkRequired([])) {\r\n            self.changeRequiredLabel(false);\r\n        } else if (bizagi.util.parseBoolean(argument) == true && properties.editable) {\r\n            if (self.properties.orientation == \"rtl\") {\r\n                controlElement.prepend('<div class=\"ui-bizagi-render-control-required-rtl\"></div>');\r\n            } else {\r\n                controlElement.addClass('control-required');\r\n                controlElement.prepend('<div class=\"ui-bizagi-render-control-required\"></div>');\r\n            }\r\n        } else {\r\n            // if element has required label and through action change it, remove element.\r\n            if (self.properties.orientation == \"rtl\") {\r\n                $(\".ui-bizagi-render-control-required-rtl\", controlElement).remove();\r\n            } else {\r\n                controlElement.removeClass('control-required');\r\n                $(\".ui-bizagi-render-control-required\", controlElement).remove();\r\n            }\r\n        }\r\n\r\n        // Set text, HTML is more suitable for the content\r\n        labelElement.html(label);\r\n\r\n        // Perform validations again to check if the form is valid after this change\r\n        self.triggerRenderValidate();\r\n    },\r\n    /**\r\n     * This method just make a toggle of red label indicator\r\n     * Does't change internal value of control, if you need it\r\n     * please use changeRequired method\r\n     *\r\n     * @argument {boolean} argument\r\n     */\r\n    changeRequiredLabel: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var label = properties.displayName || \"\";\r\n        var labelElement = $(\"label\", self.getLabel());\r\n        var controlElement = self.getControl();\r\n\r\n        // Changes label\r\n        if (bizagi.util.parseBoolean(argument) == true && properties.editable) {\r\n            if (self.properties.orientation == \"rtl\") {\r\n                controlElement.prepend('<div class=\"ui-bizagi-render-control-required-rtl\"></div>');\r\n            } else {\r\n                controlElement.addClass('control-required');\r\n                controlElement.append('<div class=\"ui-bizagi-render-control-required\"></div>');\r\n            }\r\n        } else {\r\n            // if element has required label and through action change it, remove element.\r\n            if (self.properties.orientation == \"rtl\") {\r\n                $(\".ui-bizagi-render-control-required-rtl\", controlElement).remove();\r\n            } else {\r\n                controlElement.removeClass('control-required');\r\n                $(\".ui-bizagi-render-control-required\", controlElement).remove();\r\n            }\r\n        }\r\n\r\n        // Set text, HTML is more suitable for the content\r\n        labelElement.html(label);\r\n\r\n        // Perform validations again to check if the form is valid after this change\r\n        self.triggerRenderValidate();\r\n    },\r\n    /*\r\n    *   Refresh the control with a new data\r\n    */\r\n    refreshControl: function (args) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var originalValue = self.value;\r\n        var form = self.getFormContainer();\r\n        var idForm = form.properties.id || \"\";\r\n\r\n        args = args || {};\r\n\r\n        // Start waiting\r\n        self.startLoading();\r\n\r\n        // Execute personalized stuff before to refresh it\r\n        self.beforeToRefresh();\r\n\r\n        // Call the ajax service\r\n        return $.when(self.dataService.multiaction().refreshControl({\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            idPageCache: properties.idPageCache,\r\n            xpathContext: (properties.xpathContext || args.xpathContext),\r\n            idForm: idForm\r\n        })).pipe(function (data) {\r\n            // Clear variables\r\n            self.control = self.controlFiller = self.label = null;\r\n\r\n            // Update properties data\r\n            var currentElement = self.element;\r\n            self.initializeData(data.render);\r\n\r\n            // Render the control again\r\n            return $.when(self.render()).pipe(function (html) {\r\n                var result = $(html);\r\n                //Dont remove unused rendered var\r\n                var rendered = self.postRenderElement(result);\r\n                self.properties.originalValue = self.value;\r\n                return result;\r\n            }).pipe(function (result) {\r\n                // When the content has been post-renderized, replace it\r\n                currentElement.replaceWith(result);\r\n\r\n                // Prevent multiple refresh on grid\r\n                if (!self.grid) {\r\n                    self.triggerRenderChange({changed: false});\r\n                }\r\n\r\n                // Execute personalized stuff before to refresh it\r\n                self.afterToRefresh();\r\n            });\r\n\r\n        }).fail(function (message) {\r\n            var message = self.processFailMessage(message);\r\n\r\n        }).always(function () {\r\n            self.endLoading();\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Refresh the control with a new data\r\n     */\r\n    refreshDesignControl: function (data) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Execute personalized stuff before to refresh it\r\n        self.beforeToRefresh();\r\n\r\n        // Clear variables\r\n        self.control = self.controlFiller = self.label = null;\r\n\r\n        $.extend(data.render.properties, {\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: (properties.xpathContext || \"form\"),\r\n            idPageCache: properties.idPageCache\r\n        });\r\n\r\n        // Update properties data\r\n        var currentElement = self.element;\r\n        self.initializeData(data.render);\r\n\r\n        // Render the control again\r\n        return $.when(self.render()).pipe(function (html) {\r\n            var result = $(html);\r\n            //Dont remove unused rendered var\r\n            var rendered = self.postRenderElement(result);\r\n            self.properties.originalValue = self.value;\r\n            return result;\r\n        }).pipe(function (result) {\r\n            // When the content has been post-renderized, replace it\r\n            currentElement.replaceWith(result);\r\n            self.triggerRenderChange();\r\n\r\n            // Execute personalized stuff before to refresh it\r\n            self.beforeToRefresh();\r\n        });\r\n    },\r\n\r\n    /*\r\n    * Cleans current value\r\n    */\r\n    cleanData: function () {\r\n        var self = this;\r\n\r\n        self.setValue(\"\");\r\n        self.clearDisplayValue();\r\n    },\r\n\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var input = control.find(\"input\");\r\n\r\n        if (input.length > 0) {\r\n            input.val(self.getValue());\r\n        } else if (self.properties.editable === false) {\r\n            $(control).html(\"<label class='readonly-control'></label>\");\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Updates original value for some comparisons\r\n    */\r\n    updateOriginalValue: function () {\r\n        var self = this;\r\n        self.properties.originalValue = self.value;\r\n    },\r\n    /*\r\n    *   Add the render data to the given collection in order to send data to the server\r\n    */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Add the render value\r\n        var xpath = properties.xpath;\r\n        var value = self.getValue();\r\n\r\n        if (self.controlValueIsChanged()) {\r\n            // Filter by valid xpaths and valid values\r\n            if (!bizagi.util.isEmpty(xpath)) {\r\n                if (!bizagi.util.isEmpty(value)) {\r\n                    renderValues[properties.xpath] = value;\r\n                } else if (value === \"\" || value === null) {\r\n                    renderValues[properties.xpath] = \"\";\r\n                }\r\n            }\r\n        }\r\n\r\n        //Validate if the input has a retype configured and check that both values matches, otherwise delete the original value\r\n        if (!self.validateInputRetype()) {\r\n            renderValues[properties.xpath] = \"\";\r\n        }\r\n    },\r\n\r\n    hasChanged: function (result) {\r\n        var self = this;\r\n        if (self.controlValueIsChanged()) {\r\n            result.push(true);\r\n            return true;\r\n        } else {\r\n            return false;\r\n        }\r\n    },\r\n\r\n    /*\r\n    *  Configure aditional Handlers for queryForm type\r\n    */\r\n    configureHandlersQueryForm: function () {\r\n        var self = this;\r\n        var checkIncluded = self.element.find(\".ui-bizagi-render-control-included\");\r\n        checkIncluded.change(function () {\r\n            self.properties.included = $(this).is(\":checked\");\r\n        });\r\n    },\r\n    /*\r\n    *   Add the render data to the given collection in order to send data to the server\r\n    */\r\n    collectDataQueryForm: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpath = properties.xpath;\r\n        var value = self.getValue();\r\n        var queryValue = null;\r\n        if (!bizagi.util.isEmpty(xpath)) {\r\n            if (value !== null && typeof (value) !== \"undefined\") {\r\n                var isObject = typeof (value.id) !== \"undefined\";\r\n                if (isObject) {\r\n                    queryValue = (!bizagi.util.isEmpty(value.id)) ? [value] : null;\r\n                } else {\r\n                    queryValue = (value !== \"\") ? value : null;\r\n                }\r\n            }\r\n            if (queryValue !== null || properties.included) {\r\n\r\n                if (!(properties.display == \"check\" && properties.value == false)) {\r\n\r\n                    var searchType = self.properties.typeSearch || self.properties.rangeQuery || \"NONE\";\r\n                    searchType = searchType.toUpperCase();\r\n                    var newParameter = {\r\n                        \"value\": queryValue,\r\n                        \"included\": self.properties.included,\r\n                        \"xpath\": properties.xpath,\r\n                        \"searchType\": searchType,\r\n                        \"orderType\": \"NONE\"\r\n                    };\r\n                    if (typeof properties.displayXpath !== \"undefined\" && properties.displayXpath !== \"\") {\r\n                        //newParameter.displayXpath= properties.xpath+\".\"+properties.displayXpath;\r\n                        newParameter.displayXpath = properties.displayXpath;\r\n                    }\r\n                    renderValues.push(newParameter);\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *  Method to determine if the render value can be sent to the server or not\r\n    */\r\n    canBeSent: function () {\r\n        var self = this, force;\r\n        var properties = self.properties;\r\n        var displayOnly = bizagi.util.parseBoolean(properties.displayOnly) || false;\r\n        var editable = properties.editable;\r\n\r\n        // The render can be sent if it is editable and is not \"display only\"\r\n        if (!displayOnly && editable) {\r\n            return true;\r\n        }\r\n\r\n        // Don't send the clones\r\n        if (properties.isClone) {\r\n            return false;\r\n        }\r\n\r\n        if (properties.xpath) {\r\n            var form = self.getFormContainer();\r\n            if (form.getRenders(properties.xpath).length == 1) {\r\n                force = $.forceCollectData ? $.forceCollectData.toString() : false;\r\n                $.forceCollectData = force ? undefined : $.forceCollectData;\r\n                if (self.controlValueIsChanged()) {\r\n                    $.forceCollectData = force ? bizagi.util.parseBoolean(force) : $.forceCollectData;\r\n                    return true;\r\n                }\r\n                $.forceCollectData = force ? bizagi.util.parseBoolean(force) : $.forceCollectData;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    },\r\n    /*\r\n    *  Method to determine if the render value can be sent to search\r\n    */\r\n    canBeSentQueryForm: function () {\r\n        var self = this, force;\r\n        var properties = self.properties;\r\n        // Don't send the clones\r\n        if (properties.isClone) {\r\n            return false;\r\n        }\r\n        return true;\r\n    },\r\n    /*\r\n    *   Focus on the current element\r\n    */\r\n    focus: function (time) {\r\n        var self = this;\r\n\r\n        // Focus is only allowed when the render is visible\r\n        if (!self.properties.visible) return;\r\n\r\n        // Call base\r\n        this._super();\r\n        var layout = $(\"#ui-bizagi-wp-app-render-form-content\");\r\n\r\n        // Configures effect\r\n        var effect = function () {\r\n            var control = self.getControl();\r\n            var defaultControl = (self.properties.type != \"grid\") ? $(\"input, select, option, textarea\", control) : $(\"input, select, option, textarea\", control).first();\r\n            if (defaultControl.length > 0) {\r\n\r\n                // Focus control\r\n                $.each(defaultControl, function (i) {\r\n                    var innerControl = defaultControl[i];\r\n                    if ($(innerControl).attr(\"type\") != \"hidden\" && $(innerControl).css(\"display\") != \"none\" && $(innerControl).css(\"visibility\") != \"hidden\") {\r\n\r\n                        try {\r\n                            if (!bizagi.util.isIE()) {\r\n                                bizagi.util.autoScrollBottom(layout);\r\n                            }\r\n                            innerControl.focus();\r\n                        } catch (e) {\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        };\r\n\r\n        // Wait until the render is ready to apply the focus effect\r\n        $.when(self.ready())\r\n            .done(function () {\r\n                // Run effect\r\n                if (time > 0) {\r\n                    setTimeout(effect, time);\r\n                } else {\r\n                    effect();\r\n                }\r\n            });\r\n    },\r\n\r\n    /*\r\n    *   Resolves default align for each display type\r\n    */\r\n    getDefaultLabelAlign: function (displayType) {\r\n        return \"default\";\r\n    },\r\n\r\n    /*\r\n    *   Resolves default value align for each display type\r\n    */\r\n    getDefaultValueAlign: function (displayType) {\r\n        return \"default\";\r\n    },\r\n    /*\r\n    *   Transform the align type when using RTL orientation\r\n    */\r\n    getRTLAlign: function (align) {\r\n        /* if (align === \"default\"){ \r\n            return \"right\";\r\n        } */\r\n        return align;\r\n    },\r\n\r\n    /*\r\n    *   Enables submit on change feature for the current render\r\n    */\r\n    configureSubmitOnChange: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpath = \"\";\r\n\r\n        if (!properties.editable) return;\r\n\r\n        // Build action\r\n        properties.dependencies = properties.dependencies || 'all';\r\n\r\n        if (properties.xpath) {\r\n            if (properties.submitOnChangexpathContext) {\r\n                xpath = properties.submitOnChangexpathContext + \".\" + properties.xpath;\r\n            } else {\r\n                xpath = properties.xpath;\r\n            }\r\n        } else {\r\n            if (properties.submitOnChangexpathContext) {\r\n                xpath = properties.submitOnChangexpathContext + \".\" + properties.id;\r\n            } else {\r\n                xpath = properties.id;\r\n            }\r\n        }\r\n\r\n        var action = {\r\n            \"conditions\": {\r\n                \"expressions\": [\r\n                    {\r\n                        \"simple\": {\r\n                            \"xpath\": xpath,\r\n                            \"operator\": \"changes\",\r\n                            \"argumentType\": \"const\"\r\n                        }\r\n                    }\r\n                ]\r\n            },\r\n            \"commands\": [\r\n                {\r\n                    \"xpath\": xpath,\r\n                    \"command\": 'submit-value',\r\n                    \"argument\": properties.dependencies\r\n                }\r\n            ],\r\n            \"dependencies\": [xpath],\r\n            \"elseCommands\": []\r\n        };\r\n\r\n        // Add action when form ends its rendering\r\n        $.when(self.ready()).done(function () {\r\n            var form = self.getFormContainer();\r\n            form.addSubmitAction(xpath, action);\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Sends all the info to the server then refreshes the form\r\n    *   Returns a deferred\r\n    */\r\n    submitOnChange: function (data, bRefreshForm, notCollect) {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n\r\n        // Add context parameter\r\n        if (self.properties.contexttype != \"\" && data) {\r\n            data[self.dataService.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = self.properties.contexttype;\r\n        }\r\n\r\n        $.when(self.isReadyToSave()).done(function () {\r\n            self.internalSubmitOnChange(data, bRefreshForm, notCollect).done(function () {\r\n                defer.resolve();\r\n            }).fail(function () {\r\n                defer.reject();\r\n            });\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    getCacheIdCase: function () {\r\n        var self = this;\r\n        var idCase = self.getParams().idCase;\r\n\r\n        if (bizagi.cache === undefined) {\r\n            bizagi.cache = {};\r\n            bizagi.cache.idCaseObject = {\r\n                idCase: idCase !== undefined ? idCase : (bizagi.cache.idCase !== undefined ? bizagi.cache.idCase : undefined)\r\n            };\r\n        } else {\r\n            if (idCase !== undefined && bizagi.cache.idCaseObject !== undefined) {\r\n                bizagi.cache.idCaseObject.idCase = idCase;\r\n            } else {\r\n                if (idCase !== undefined && bizagi.cache.idCaseObject === undefined) {\r\n                    bizagi.cache.idCaseObject = {};\r\n                    bizagi.cache.idCaseObject.idCase = idCase;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (idCase === undefined) {\r\n            if (bizagi.cache.idCaseObject === undefined) {\r\n                idCase = undefined;\r\n            } else {\r\n                idCase = bizagi.cache.idCaseObject.idCase;\r\n            }\r\n        } else {\r\n            idCase = idCase;\r\n        }\r\n\r\n        return idCase;\r\n    },\r\n    /*\r\n    *   Internal method\r\n    *   Sends all the info to the server then refreshes the form\r\n    *   Returns a deferred\r\n    */\r\n    internalSubmitOnChange: function (data, bRefreshForm, notCollect) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var properties = self.properties;\r\n        var parameters = {\r\n            data: data,\r\n            bRefreshForm: bRefreshForm,\r\n            notCollect: notCollect,\r\n            properties: {\r\n                idCase: self.getCacheIdCase(),\r\n                id: properties.id,\r\n                xpath: properties.xpath,\r\n                idPageCache: properties.idPageCache,\r\n                contexttype: properties.contexttype\r\n            }\r\n        }\r\n\r\n        return form.internalSubmitOnChange(parameters);\r\n    },\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready\r\n    */\r\n    ready: function () {\r\n        var self = this;\r\n        return $.when(self.parent.ready(), self.isRendered());\r\n    },\r\n    /*\r\n    *   Get the custom handlers set for this execution\r\n    */\r\n    getCustomHandlers: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n\r\n        if (form) {\r\n            return form.getCustomHandlers();\r\n        }\r\n        return null;\r\n    },\r\n    /*\r\n    *   Get the custom handlers set for this execution\r\n    */\r\n    getCustomHandler: function (key) {\r\n        var self = this;\r\n        var customHandlers = self.getCustomHandlers();\r\n\r\n        if (customHandlers) {\r\n            return customHandlers[key];\r\n        }\r\n        return null;\r\n    },\r\n    /*\r\n    *   Calculates render label and value width\r\n    */\r\n    calculateRenderWidth: function (labelWidth, valueWidth, displayType) {\r\n        var self = this;\r\n        // Read values\r\n        // If the label width or the value width are 0, the BAS means that no value is used, so we need to adjust them to 50%\r\n        if (valueWidth == \"100\" && typeof labelWidth === \"undefined\") {\r\n            labelWidth = \"0\";\r\n        } else {\r\n            labelWidth = labelWidth ? (labelWidth != \"0\" ? labelWidth : \"50\") : \"50%\";\r\n        }\r\n        valueWidth = valueWidth ? (valueWidth != \"0\" ? valueWidth : \"50\") : \"50%\";\r\n\r\n        if (displayType == \"normal\" || displayType == \"both\" || displayType == \"reversed\") {\r\n\r\n            // Special case with lower values, so they want both fields in \"auto\" width\r\n            if (labelWidth && bizagi.util.percent2Number(labelWidth) < 5 &&\r\n                valueWidth && bizagi.util.percent2Number(valueWidth) < 5) {\r\n                return {label: 0, control: 100};\r\n            }\r\n            // Normalize percentages\r\n            if (labelWidth && !valueWidth) {\r\n                labelWidth = bizagi.util.percent2Number(labelWidth);\r\n                valueWidth = 100 - labelWidth;\r\n\r\n            } else if (!labelWidth && valueWidth) {\r\n                valueWidth = bizagi.util.percent2Number(valueWidth);\r\n                labelWidth = 100 - valueWidth;\r\n            } else {\r\n                labelWidth = bizagi.util.percent2Number(labelWidth);\r\n                valueWidth = bizagi.util.percent2Number(valueWidth);\r\n\r\n                // Check 100% percentage\r\n                if ((labelWidth + valueWidth) != 100 && typeof (self.properties) != \"undefined\" && self.properties.layoutType != \"pixels\") {\r\n                    valueWidth = 100 - labelWidth;\r\n                }\r\n            }\r\n        } else {\r\n            labelWidth = 100;\r\n            valueWidth = 100;\r\n        }\r\n\r\n        return {label: labelWidth, control: valueWidth};\r\n    },\r\n    /*\r\n    *   Get param value idCase\r\n    */\r\n    getIdCase: function () {\r\n        var self = this;\r\n        return self.getFormContainer().params.idCase || bizagi.context.idCase;\r\n    },\r\n    /*\r\n    *   Get param value idWorkitem\r\n    */\r\n    getIdWorkitem: function () {\r\n        var self = this;\r\n        return self.getFormContainer().params.idWorkitem || bizagi.context.idWorkitem;\r\n    },\r\n    /*\r\n    *   Get param value idTask\r\n    */\r\n    getidTask: function () {\r\n        var self = this;\r\n        return self.getFormContainer().params.idTask || bizagi.context.idTask;\r\n    },\r\n    /*\r\n    *   Get param value sessionId\r\n    */\r\n    getSessionId: function () {\r\n        var self = this;\r\n        return self.getFormContainer().properties.sessionId;\r\n    },\r\n\r\n    /*\r\n    *   CELL STUFF\r\n    *   TODO: Move to other place\r\n    */\r\n\r\n    /* Customizes cell color*/\r\n    changeCellColor: function (color) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        if (control) {\r\n            if (color != 'none') {\r\n                control.css(\"color\", color);\r\n                control.find(\"input, textarea, label\").each(function (i, element) {\r\n                    $(element).css(\"color\", color);\r\n                });\r\n            } else {\r\n                control.css(\"color\", \"\");\r\n                control.find(\"input, textarea, label\").each(function (i, element) {\r\n                    $(element).css(\"color\", \"\");\r\n                });\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Customizes cell background color\r\n     * @param color\r\n     */\r\n    changeCellBackgroundColor: function (color) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var backgroundColor = \"\";\r\n        var backgroundImage = \"\";\r\n\r\n        if (control) {\r\n            if (color != 'none') {\r\n                backgroundColor = color;\r\n                backgroundImage = \"none\";\r\n            }\r\n\r\n            if (self.properties.editable) {\r\n                var needBGPaint = false;\r\n\r\n                control.find(\"input, textarea, .ui-selectmenu\").each(function (i, element) {\r\n\r\n                    if (((element.type == \"text\") || (element.type == \"textarea\")) && !($(element).hasClass('ui-select-data')))\r\n                        needBGPaint = true;\r\n\r\n                    $(element).css({\r\n                        \"background-color\": backgroundColor,\r\n                        \"background-image\": backgroundImage\r\n                    });\r\n                });\r\n\r\n                if (!needBGPaint) {\r\n                    control.closest(\"td\").each(function (i, element) {\r\n                        $(element).css({\r\n                            \"background-color\": backgroundColor,\r\n                            \"background-image\": backgroundImage\r\n                        });\r\n                    });\r\n                }\r\n\r\n            } else {\r\n                control.each(function (i, element) {\r\n                    //TODO: Validar si se aplican los estilos en tablet aun sin esta linea, cuidado con desktop\r\n                    var item = ($(element).hasClass(\"ui-bizagi-cell-readonly\")) ? control.closest(\"td\") : $(element);\r\n                    item.css({\r\n                        \"background-color\": backgroundColor,\r\n                        \"background-image\": backgroundImage\r\n                    });\r\n                });\r\n            }\r\n        }\r\n\r\n\r\n    },\r\n\r\n    /**\r\n     * Changes the cell visibility\r\n     * @param argument\r\n     */\r\n    changeCellVisibility: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        if (control) {\r\n            // Hide - show the render\r\n            if (bizagi.util.parseBoolean(argument) == true) {\r\n                //control.show();\r\n                control.css(\"visibility\", \"visible\");\r\n                control.css(\"display\", \"\");\r\n\r\n                self.element && self.element.show();\r\n            } else {\r\n                //control.hide();\r\n                control.css(\"visibility\", \"hidden\");\r\n            }\r\n        }\r\n\r\n        // Update properties\r\n        properties.visible = argument;\r\n    },\r\n\r\n    /**\r\n     * Changes the cell required\r\n     * @param argument\r\n     */\r\n    changeCellRequired: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        if (control) {\r\n            // Check if argument is true and control donot have any value\r\n            if (bizagi.util.parseBoolean(argument) == true && bizagi.util.isEmpty(self.value)) {\r\n                control.addClass('control-required');\r\n                control.append('<div class=\"ui-bizagi-render-control-required\"></div>');\r\n            } else {\r\n                control.removeClass('control-required');\r\n                $(\".ui-bizagi-render-control-required\", control).remove();\r\n            }\r\n            // Update properties\r\n            properties.required = argument;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Method to create deferred at the moment to start multiaction\r\n     */\r\n    startActionExecution: function () {\r\n        var self = this;\r\n        self.startLoading();\r\n        self.actionExecutionDeferred = new $.Deferred();\r\n    },\r\n\r\n    /**\r\n     * method to resolve the deferred when multiaction finish\r\n     */\r\n    endActionExecution: function () {\r\n        var self = this;\r\n        self.endLoading();\r\n        if (self.actionExecutionDeferred) self.actionExecutionDeferred.resolve();\r\n        delete self.actionExecutionDeferred;\r\n    },\r\n\r\n    /**\r\n     * Method to return the promise to anyone that needs to know if multiaction ended\r\n     * @returns {*}\r\n     */\r\n    readyActionExecution: function () {\r\n        var self = this;\r\n        if (!self.actionExecutionDeferred) return $.when(true);\r\n        return self.actionExecutionDeferred.promise();\r\n    },\r\n\r\n    /**\r\n     * Verifies is the elements was inside a new row in a grid\r\n     * @returns {boolean}\r\n     */\r\n    isFromCreatedRow: function () {\r\n        var self = this;\r\n\r\n        if (self.grid) {\r\n            var i = self.grid.columns.length;\r\n\r\n            while (i-- > 0) {\r\n                if (self.grid.columns[i].properties.xpath == self.properties.xpath) {\r\n                    if (self.grid.columns[i].isNewRow == true) {\r\n                        return true;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    },\r\n    /**\r\n     * Submits a invalidate page cache request\r\n     * @param params\r\n     */\r\n    submitInvalidatePageCacheRequest: function (params) {\r\n        var self = this,\r\n            properties = self.properties;\r\n        var pageCacheToInvalidate = params ? params.idPageCache : properties.idPageCache;\r\n\r\n\r\n        self.dataService.invalidatePageCache({idPageCache: pageCacheToInvalidate});\r\n    },\r\n\r\n    /**\r\n     * Check is design mode\r\n     */\r\n    isDesignMode: function () {\r\n        return this.getMode() === \"design\";\r\n    },\r\n\r\n    /**\r\n     * Check is design mode\r\n     */\r\n    isExecutionMode: function () {\r\n        return this.getMode() === \"execution\";\r\n    },\r\n\r\n    /***/\r\n    preventDefaultForAnchorTag: function(){        \r\n        if (bizagi.util.isSharepointContext()){\r\n            $(\"a\", this.getControl()).click(function(ev){\r\n                ev.preventDefault();          \r\n            });\r\n        }    \r\n    }\r\n});","/*\r\n *   Name: Bizagi Render Base Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define a base render class with common stuff related to all renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.render.base\", {}, {\r\n\r\n    /**\r\n     * Method to process the render the layout\r\n     * @param {boolean} isLabelFormat\r\n     * @param {string} format\r\n     */\r\n    processLayout: function (isLabelFormat, format) {\r\n        var properties = this.properties;\r\n\r\n        if (typeof isLabelFormat !== \"boolean\") {\r\n            console.warm(\"error calling processLayout, 'isLabelFormat' is not boolean\");\r\n            return;\r\n        }\r\n\r\n        if (isLabelFormat) {\r\n            this.processLabelLayout(format);\r\n        } else {\r\n            this.processControlLayout(format);\r\n\r\n            // Set required and visiblity\r\n            properties.required = typeof (properties.required) !== \"undefined\" ? bizagi.util.parseBoolean(properties.required) : false;\r\n            var visible = typeof (properties.visible) !== \"undefined\" ? bizagi.util.parseBoolean(properties.visible) : true;\r\n\r\n            if (properties.required) {\r\n                this.changeRequired(properties.required);\r\n            }\r\n\r\n            if (!visible) {\r\n                this.changeVisibility(visible);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Method to process the label in the layout\r\n     * @param {} format\r\n     * @returns {}\r\n     */\r\n    processLabelLayout: function (format) {\r\n        var $label = this.getLabel();\r\n        if ($label == null) return;\r\n\r\n        // Set customizations\r\n        format = format || {};\r\n        if (typeof format.bold === \"undefined\") {\r\n            format.bold = true; // Default value\r\n        }\r\n\r\n        this.changeBackgroundColor(format.background)\r\n            .changeFontColor($label, format.color)\r\n            .changeFontBold($label, format.bold)\r\n            .changeFontSize($label, format.size)\r\n            .changeFontItalic($label, format.italic)\r\n            .changeTextDecoration($label, (format.underline ? \"underline\" : \"\") + (format.strikethru ? \" line-through\" : \"\"));\r\n    },\r\n\r\n    /**\r\n     * Method to process the control in the layout\r\n     * @param {} format\r\n     * @returns {}\r\n     */\r\n    processControlLayout: function (format) {\r\n        var $control = this.getControl();\r\n        var $elements = this.getElementsToStylize($control);\r\n\r\n        // Set customizations\r\n        format = format || {};\r\n\r\n        this.changeFontColor($elements, format.color)\r\n            .changeFontBold($elements, format.bold)\r\n            .changeFontItalic($elements, format.italic)\r\n            .changeFontSize($elements, format.size)\r\n            .changeTextDecoration($elements, (format.underline ? \"underline\" : \"\") + (format.strikethru ? \" line-through\" : \"\"));\r\n    },\r\n\r\n    /**\r\n     * Customizes render color\r\n     * @param {} color\r\n     * @returns {}\r\n     */\r\n    changeColor: function (color) {\r\n        var $label = this.getLabel();\r\n        var $control = this.getControl();\r\n        var $elements = this.getElementsToStylize($control);\r\n\r\n        return this\r\n            .changeFontColor($label, color)\r\n            .changeFontColor($elements, color);\r\n    },\r\n\r\n    /**\r\n     * Customizes render color\r\n     * @param {} $element\r\n     * @param {} color\r\n     * @returns {}\r\n     */\r\n    changeFontColor: function ($element, color) {\r\n        if ($element === undefined) return this;\r\n        if (color === undefined) return this;\r\n\r\n        var style = color !== \"none\" ? color : \"\";\r\n        $element.css(\"color\", style);\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Customizes the font size property\r\n     * @param {} $element\r\n     * @param {} size\r\n     * @returns {}\r\n     */\r\n    changeFontSize: function ($element, size) {\r\n        if (size === undefined) return this;\r\n        if ($element === undefined) return this;\r\n\r\n        if (size !== \"0\") {\r\n            var newFontSize = 100 + Number(size) * 10 + \"%\";\r\n            $element.css(\"font-size\", newFontSize);\r\n        }\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Customizes the font Strikethrough or underline property\r\n     * @param {} $element\r\n     * @param {} textDecoration\r\n     * @returns {}\r\n     */\r\n    changeTextDecoration: function ($element, textDecoration) {\r\n        if (textDecoration === undefined) return this;\r\n        if ($element === undefined) return this;\r\n\r\n        textDecoration && $element.css(\"text-decoration\", textDecoration);\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Customizes the font italic style\r\n     * @param {} $element\r\n     * @param {} italic\r\n     * @returns {}\r\n     */\r\n    changeFontItalic: function ($element, italic) {\r\n        var style = bizagi.util.parseBoolean(italic) ? \"italic\" : \"normal\";\r\n\r\n        $element.css(\"font-style\", style);\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Customizes the font weight\r\n     * @param {} $label\r\n     * @param {} bold\r\n     * @returns {}\r\n     */\r\n    changeFontBold: function ($label, bold) {\r\n        var style = bizagi.util.parseBoolean(bold) ? \"bold\" : \"normal\";\r\n\r\n        $label.css(\"font-weight\", style);\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Customizes render background color\r\n     * @param {} color\r\n     * @returns {}\r\n     */\r\n    changeBackgroundColor: function (color) {\r\n        if (typeof color === \"undefined\") return this;\r\n\r\n        if (color !== \"none\") {\r\n            this.element.css(\"background-color\", color);\r\n        } else {\r\n            this.element.css(\"background-color\", \"\");\r\n        }\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * This method just make a toggle of red label indicator\r\n     * @argument {boolean} argument\r\n     */\r\n    changeRequiredLabel: function () {\r\n    },\r\n\r\n    /**\r\n     * Change cell required and attach bindings\r\n     * @param argument\r\n     */\r\n    changeCellRequired: function (argument) {\r\n        this.changeRequired(argument);\r\n    },\r\n\r\n    /**\r\n     * \r\n     */\r\n    getRTLAlign: function (align) {\r\n        if (typeof align == \"undefined\" || align == \"\") {\r\n            return \"default\";\r\n        }\r\n        return align;\r\n    },\r\n\r\n    /**\r\n     * TODO: This override should be removed after genome, just because the align shoudnt be depend of the display type\r\n     */\r\n    getDefaultLabelAlign: function(){\r\n        return \"default\";\r\n    },\r\n\r\n    /**\r\n     * TODO: This override should be removed after genome, just because the align shoudnt be depend of the display type\r\n     */\r\n    getDefaultValueAlign: function(){\r\n        return \"default\";\r\n    }\r\n});","/*\r\n*   Name: BizAgi Tablet Render Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the render class to adjust to tablet devices\r\n*/\r\n\r\nbizagi.rendering.render.extend(\"bizagi.rendering.render\", {}, {\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function(data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        var formContainer = self.getFormContainer();\r\n        self.formParams = formContainer.getParams();\r\n    },\r\n\r\n    /*\r\n    *   Returns the in-memory processed element\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n        // Call base\r\n        self.configureHelpText();\r\n    },\r\n\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var container = self.getControl();\r\n\r\n        // Call base\r\n        self._super();\r\n        self.configureHelpText();\r\n\r\n        // Add styles readonly controls\r\n        container.addClass(\"bz-rn-read-only\");\r\n        container.parent().addClass(\"bz-rn-read-only\");\r\n    },\r\n\r\n    configureHelpText: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (properties && properties.helpText && properties.helpText !== \"\") {\r\n            var containerHelp = self.getContainerHelpText();\r\n\r\n            if (containerHelp) {\r\n                $(containerHelp).helpText({helpText: properties.helpText, dir: properties.orientation});\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Template method to get the label element\r\n    */\r\n    getLabel: function () {\r\n        var self = this;\r\n        if (!self.label) {\r\n            var label = $(\".ui-bizagi-label\", self.element || self.observableElement);\r\n            if (label.length > 0) {\r\n                self.label = label;\r\n            }\r\n            return label;\r\n        }\r\n        return self.label;\r\n    },\r\n\r\n    /*\r\n    *   Template method to get the control element\r\n    */\r\n    getControl: function () {\r\n        var self = this;\r\n        if (!self.control || self.control.length === 0) {\r\n            self.control = $(\".ui-bizagi-render-control\", self.element || self.observableElement);\r\n        }\r\n        return self.control;\r\n    },\r\n\r\n    /*\r\n    *   Template method to get the control filler element\r\n    */\r\n    getControlFiller: function () {\r\n        var self = this;\r\n        if (!self.controlFiller) {\r\n            self.controlFiller = $(\".ui-bizagi-render-control\", self.element || self.observableElement);\r\n        }\r\n        return self.controlFiller;\r\n    },\r\n\r\n    /*\r\n    *   Starts waiting signal for async stuff\r\n    */\r\n    startLoading: function () {        \r\n    },\r\n\r\n    /*\r\n    *   Ends waiting for async stuff\r\n    */\r\n    endLoading: function () {        \r\n    },\r\n\r\n    /*\r\n    *   Return the right display option class\r\n    */\r\n    getDisplayOptionClass: function (displayType) {\r\n        // Set display type\r\n        if (displayType == \"normal\" ||\r\n                displayType == \"both\") {\r\n            return \"ui-bizagi-render-display-normal\";\r\n\r\n        } else if (displayType == \"vertical\") {\r\n            return \"ui-bizagi-render-display-vertical\";\r\n\r\n        } else if (displayType == \"reversed\") {\r\n            return \"ui-bizagi-render-display-reversed\";\r\n\r\n        } else if (displayType == \"verticalReversed\") {\r\n            return \"ui-bizagi-render-display-vertical-reversed\";\r\n\r\n        } else if (displayType == \"label\") {\r\n            return \"ui-bizagi-render-display-label\";\r\n\r\n        } else if (displayType == \"value\") {\r\n            return \"ui-bizagi-render-display-value\";\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Transform the display type when using RTL orientation\r\n     */\r\n    getRTLDisplayType: function (displayType) {\r\n        return displayType;\r\n    },\r\n\r\n    /*\r\n    *   Customizes render display type with custom css classes\r\n    */\r\n    changeDisplayOption: function (displayType) {\r\n        var self = this,\r\n        el = self.element;\r\n\r\n        // Clean old display type\r\n        el.removeClass(\"ui-bizagi-render-display-normal ui-bizagi-render-display-vertical ui-bizagi-render-display-reversed\")\r\n          .removeClass(\"ui-bizagi-render-display-vertical-reversed ui-bizagi-render-display-label ui-bizagi-render-display-value\");\r\n\r\n        el.addClass(self.getDisplayOptionClass(displayType));\r\n    },\r\n\r\n    /*\r\n    *   Return the right align class\r\n    */\r\n    getAlignClass: function (alignType) {\r\n        // Set label align\r\n        if (alignType == \"left\") {\r\n            return \"ui-bizagi-render-align-left\";\r\n        } else if (alignType == \"center\") {\r\n            return \"ui-bizagi-render-align-center\";\r\n        } else if (alignType == \"right\") {\r\n            return \"ui-bizagi-render-align-right\";\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Customizes render label align\r\n    */\r\n    changeLabelAlign: function (alignType) {\r\n        var self = this;\r\n\r\n        // Get label\r\n        var label = self.getLabel();\r\n\r\n        // Remove old label align\r\n        label.removeClass(\"ui-bizagi-render-align-left ui-bizagi-render-align-center ui-bizagi-render-align-right\");\r\n\r\n        // Set label align\r\n        label.addClass(self.getAlignClass(alignType));\r\n    },\r\n\r\n    /*\r\n    *   Customizes render value align\r\n    */\r\n    changeValueAlign: function (alignType) {\r\n        var self = this;\r\n\r\n        // Get control\r\n        var controlFiller = self.getControlFiller();\r\n\r\n        // Remove old value align\r\n        controlFiller.removeClass(\"ui-bizagi-render-align-left ui-bizagi-render-align-center ui-bizagi-render-align-right\");\r\n\r\n        // Set value align\r\n        controlFiller.addClass(self.getAlignClass(alignType));\r\n    },\r\n\r\n    /*\r\n    *   Customizes render label and value width\r\n    */\r\n    customizeRenderWidth: function () {\r\n        var self = this;\r\n        var label = self.getLabel();\r\n        var properties = self.properties;\r\n        var controlFiller = self.getControlFiller();\r\n\r\n        // Read values\r\n        // If the label width or the value width are 0, the BAS means that no value is used, so we need to adjust them to 50%\r\n        var labelWidth = properties.labelWidth ? (properties.labelWidth != \"0\" ? properties.labelWidth : \"50%\") : null;\r\n        var valueWidth = properties.valueWidth ? (properties.valueWidth != \"0\" ? properties.valueWidth : \"50%\") : null;\r\n\r\n        // Normalize percentages\r\n        if (labelWidth && !valueWidth) {\r\n            labelWidth = bizagi.util.percent2Number(labelWidth);\r\n            valueWidth = 100 - labelWidth;\r\n\r\n        } else if (!labelWidth && valueWidth) {\r\n            valueWidth = bizagi.util.percent2Number(valueWidth);\r\n            labelWidth = 100 - valueWidth;\r\n\r\n        } else {\r\n            labelWidth = bizagi.util.percent2Number(labelWidth);\r\n            valueWidth = bizagi.util.percent2Number(valueWidth);\r\n\r\n            // Check 100% percentage\r\n            if ((labelWidth + valueWidth) != 100) {\r\n                valueWidth = 100 - labelWidth;\r\n            }\r\n        }\r\n\r\n        // Now apply width\r\n        label.width(labelWidth + \"%\");\r\n        controlFiller.width((valueWidth - 0.01) + \"%\");\r\n    },\r\n\r\n    /*\r\n    *   Sends all the info to the server then refreshes the form\r\n    *   Returns a deferred\r\n    */\r\n    submitOnChange: function(data, bRefreshForm) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        bizagi.util.tablet.startLoading();\r\n\r\n        $.when(self.isReadyToSave()).done(function() {\r\n            $.when(self.internalSubmitOnChange(data, bRefreshForm))\r\n                .done(function() {\r\n                    defer.resolve();\r\n                }).fail(function() {\r\n                    defer.reject();\r\n                }).always(function() {\r\n                    bizagi.util.tablet.stopLoading();\r\n                });\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n     *   Template method to get the control element\r\n     */\r\n    getContainerHelpText: function() {\r\n        var self = this;\r\n\r\n        if (!self.containerHelpText)\r\n            self.containerHelpText = $(\".bz-container-rn-helptext\", self.element || self.observableElement);\r\n\r\n        if (!self.containerHelpText || self.containerHelpText.length === 0)\r\n            return null;\r\n\r\n        return self.containerHelpText;\r\n    },\r\n\r\n    /* \r\n    *   Adds a validation message to the render\r\n    */\r\n    setValidationMessage: function (message) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(message);\r\n\r\n        // Wait until element is ready\r\n        $.when(self.ready())\r\n        .done(function () {\r\n            var control = self.getControl();\r\n\r\n            if (message && message.length > 0) {\r\n\r\n                // Check if this is the first element\r\n                var bFirstElement = self.element.prev().length === 0 && self.parent === self.getFormContainer();\r\n\r\n                // Remove html tags\r\n                message = message.replace(/<\\w+>([^<]*)<\\/\\w+>/g, \"$1\");\r\n                control.attr(\"data-error\", message);\r\n                control.addClass(bFirstElement ? \"ui-bizagi-render-error-firstControl\" : \"ui-bizagi-render-error\");\r\n\r\n            } else {\r\n                if (control) {\r\n                    control.attr(\"data-error\", \"\");\r\n                    control.removeClass(\"ui-bizagi-render-error\");\r\n                    control.removeClass(\"ui-bizagi-render-error-firstControl\");\r\n                }\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Method to render non editable values\r\n    */\r\n    renderReadOnly: function() {\r\n        var result = this.getValue();\r\n        var readOnlyValue = \"\";\r\n\r\n        if (bizagi.util.isObject(result) && typeof (result.value) !== \"undefined\") {\r\n            readOnlyValue = result.value\r\n        } else if (!bizagi.util.isEmpty(result)) {\r\n            readOnlyValue = result;\r\n        }\r\n\r\n        return readOnlyValue;\r\n    },\r\n\r\n    /*\r\n     *   Method to process the render the layout\r\n     */\r\n    processLayout: function(isLabelFormat, format) {\r\n        this._super(isLabelFormat, format);\r\n    },\r\n\r\n    changeRequiredLabel: function() {\r\n        var self = this;        \r\n\r\n        if (self.properties.required) {\r\n\r\n            if (!self.checkRequired([])) {\r\n                $(\"div.ui-bizagi-render-control-required\", self.getControl()).show();\r\n            } else {\r\n                $(\"div.ui-bizagi-render-control-required\", self.getControl()).hide();\r\n            }\r\n        }\r\n    },\r\n\r\n    changeRequired: function(argument) {\r\n        var self = this;\r\n        var labelElement = $(\"label\", self.getLabel());\r\n        var controlElement = self.getControl();\r\n        //Remove the required div from the dom in order to have only one any time\r\n        controlElement.find(\".ui-bizagi-render-control-required\").remove();\r\n        var properties = self.properties;\r\n\r\n        // Update properties\r\n        properties.required = argument;\r\n\r\n        // Changes label\r\n        if (bizagi.util.parseBoolean(argument)) {\r\n            labelElement.text((properties.displayName || \"\") + \" \");\r\n\r\n            if (!self.hasValue()) {\r\n                controlElement.prepend(\"<div class='ui-bizagi-render-control-required'></div>\");\r\n            }else{\r\n                controlElement.prepend(\"<div class='ui-bizagi-render-control-required' style='display: none'></div>\");\r\n            }\r\n        } else {\r\n            labelElement.text((properties.displayName || \"\")); //+ ' :'\r\n        }\r\n\r\n        // Perform validations again to check if the form is valid after this change\r\n        self.triggerRenderValidate();\r\n    },\r\n\r\n    changeEditability: function (argument) {\r\n        var self = this;\r\n        var editable = bizagi.util.parseBoolean(argument);\r\n\r\n        self._super(argument);\r\n\r\n        var renderedElement = self.getRenderedElement();\r\n\r\n        if (renderedElement)\r\n            renderedElement.toggleClass(\"bz-rn-non-editable\", !editable).toggleClass(\"bz-rn-read-only\", !editable);\r\n    },\r\n\r\n    /**\r\n    * in mobiles, don't apply styles to icon's elements\r\n    */\r\n    getElementsToStylize: function(context){\r\n        context = $(\"*:not(.bz-mo-icon):not(.bz-rn-container-control-icon):not(.bz-rn-upload-show-menu):not(.ui-bizagi-render-yesno)\", $(context));\r\n        return context;\r\n    },\r\n\r\n    getFormParams: function() {        \r\n        return this.formParams || {};\r\n    },\r\n\r\n    /**\r\n     *   Sets the value in the rendered control\r\n     */\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var input = control.find(\"input\").filter(function(index, ele){\r\n            return ele.type !== \"file\" && ele.type !== \"radio\" && ele.type !== \"checkbox\"\r\n        });\r\n\r\n        if (input.length > 0) {\r\n            input.val(self.getValue());\r\n        } else {\r\n            self.setDisplayValue(\"\");\r\n        }\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Form Container Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define a form container class that defines basic stuff regarding the device\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.form\", {}, {\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        var self = this;\r\n        var data = params.data;\r\n        var device = bizagi.util.detectDevice();\r\n\r\n        // Creates a hashtable to maintain references by id\r\n        self.rendersById = {};\r\n        self.rendersByXpath = {};\r\n        self.rendersByType = {};\r\n\r\n        // Set page cache id\r\n        self.idPageCache = data.pageCacheId;\r\n\r\n        // Set default mode\r\n        self.mode = params.mode || \"execution\";\r\n        self.focus = params.focus;\r\n\r\n        // Set rendering params\r\n        self.params = params;\r\n\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Define confirmation message \r\n        var message = \"\";\r\n\r\n        if (device !== \"desktop\") {\r\n            message = this.getResource(\"render-form-user-confirmation-message\").replace(/<br(\\/| \\/)>/g, \"\\n\");\r\n        } else {\r\n            message = this.getResource(\"render-form-user-confirmation-message\");\r\n        }\r\n\r\n        // Default properties\r\n        var properties = self.properties;\r\n        properties.sessionId = data.sessionId;\r\n        properties.displayAsReadOnly = bizagi.util.parseBoolean(data.displayAsReadOnly) || false;\r\n        properties.userConfirmationMessage = properties.userConfirmationMessage || message;\r\n        properties.orientation = properties.orientation || \"ltr\";\r\n        properties.hasRule = bizagi.util.parseBoolean(properties.hasRule) || false;\r\n        properties.contexttype = params.contexttype || \"\";\r\n        properties.paramsRender = params.paramsRender || {};\r\n        properties.processPath = params.data.processPath ? params.data.processPath.replaceAll(\"|/|\", \"  &rsaquo;  \") : \"\";\r\n        properties.breadCrumb = params.data.processPath ? params.data.processPath.split(\"|/|\") : [];\r\n\r\n        // Set validations & actions\r\n        this.validations = data.validations;\r\n        this.actions = data.actions;\r\n\r\n        // Enable the \"Validate and Save\" action for Form Buttons\r\n        self.allowValidateAndSaveAction = bizagi.override && bizagi.override.enableActionValidateAndSave === true;\r\n\r\n        // Initialize buttons\r\n        self.initializeButtons(data);\r\n\r\n        // Define transitions to Complex Gateway\r\n        if (data.transitions) {\r\n            self.transitions = data.transitions;\r\n        }\r\n\r\n        this.originalProcessButton = this.processButton;\r\n\r\n        //Custom behaviour for application parent activated.\r\n        self.isRoutingDisabled = false;\r\n        if (params.applicationParent) {\r\n            switch (params.applicationParent) {\r\n                case 'NEWWORKPORTAL':\r\n                    self.isRoutingDisabled = true;\r\n                    break;\r\n            }\r\n        }\r\n\r\n        self.isOfflineFormsV2Supported =  bizagi.util.isMobileDevice() && bizagi.util.isOfflineFormsV2Supported();\r\n\r\n    },\r\n    /*\r\n    *   Initializes button metadata\r\n    */\r\n    initializeButtons: function (data) {\r\n        var self = this;\r\n\r\n        self.buttons = [];\r\n\r\n        // Process buttons\r\n        if (data.buttons) {\r\n            $.each(data.buttons, function (i, item) {\r\n                var button = item.button.properties;\r\n\r\n                // Process caption\r\n                button.caption = !bizagi.util.isEmpty(button.caption) && self.getResource(button.caption) != button.caption ? self.getResource(button.caption) : button.caption;\r\n\r\n                // Process actions\r\n                if (button.actions) {\r\n                    $.each(button.actions, function (i, action) {\r\n                        button[action] = true;\r\n                    });\r\n                }\r\n\r\n                // Add other properties\r\n                button.ordinal = i;\r\n                button.action = button.next ? \"next\" :\r\n                    button.nextWithoutValidations ? \"nextWithoutValidations\" :\r\n                        button.submitData ? \"save\" :\r\n                            button.cancel ? \"cancel\" :\r\n                                button.back ? \"back\" :\r\n                                    button.createnewcase ? \"createnewcase\" :\r\n                                        button.validate ? \"validate\" : \"\";\r\n\r\n                // Explicit add save operation\r\n                button.save = (button.action === \"save\");\r\n\r\n                // Add inherent behaviours\r\n                if (button.next || button.back || button.nextWithoutValidations) {\r\n                    button.routing = true;\r\n                }\r\n\r\n                if (button.hasRule) {\r\n                    button.executeRule = true;\r\n                }\r\n\r\n                if (self.allowValidateAndSaveAction && button.validate) {\r\n                    button.submitData = true;\r\n                    button.refresh = true;\r\n                    button.save = true;\r\n                    if (button.action === \"next\" || button.action === \"createnewcase\") {\r\n                        button.refresh = false;\r\n                    }\r\n                }\r\n\r\n                // Prepare button style\r\n                button.style = self.buildButtonStyle(button);\r\n\r\n                // Add to button array\r\n                if (self.properties.orientation === \"rtl\" && !self.properties.useCustomButtons) {\r\n                    self.buttons.unshift(button);\r\n                } else {\r\n                    self.buttons.push(button);\r\n                }\r\n\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Get the original params used to fetch the form\r\n    */\r\n    getParams: function () {\r\n        return this.params;\r\n    },\r\n\r\n    setParam: function (property, value) {\r\n        if (this.params) {\r\n            this.params[property] = value;\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Get current rendering mode\r\n    */\r\n    getMode: function () {\r\n        return this.mode;\r\n    },\r\n    /*\r\n    *   Get the custom handlers set for this execution\r\n    */\r\n    getCustomHandlers: function () {\r\n        var self = this;\r\n        if (self.params) {\r\n            return self.params.customHandlers;\r\n        }\r\n    },\r\n    /*\r\n    * Method to index renders\r\n    */\r\n    registerRender: function (render) {\r\n        var self = this;\r\n\r\n        self.rendersById[render.properties.id] = render;\r\n        if (render.properties.xpath) {\r\n            if (!self.rendersByXpath[render.properties.xpath]) {\r\n                self.rendersByXpath[render.properties.xpath] = [];\r\n            }\r\n            self.rendersByXpath[render.properties.xpath].push(render);\r\n        }\r\n\r\n        if (!self.rendersByType[render.properties.type]) {\r\n            self.rendersByType[render.properties.type] = [];\r\n        }\r\n        self.rendersByType[render.properties.type].push(render);\r\n    },\r\n    /*\r\n    * Method to unregister render\r\n    */\r\n    unregisterRender: function (render) {\r\n        var self = this;\r\n\r\n        if (self.rendersById[render.properties.id]) {\r\n            delete self.rendersById[render.properties.id];\r\n        }\r\n\r\n        if (render.properties.xpath) {\r\n            if ($.isArray(self.rendersByXpath[render.properties.xpath])\r\n                && self.rendersByXpath[render.properties.xpath].length > 1) {\r\n                for (var i = 0, l = self.rendersByXpath[render.properties.xpath].length; i < l; i++) {\r\n                    var element = self.rendersByXpath[render.properties.xpath][i];\r\n                    if (element.properties.id === render.properties.id) {\r\n                        self.rendersByXpath[render.properties.xpath].splice(i, 1);\r\n                        break;\r\n                    }\r\n                }\r\n            } else {\r\n                delete self.rendersByXpath[render.properties.xpath];\r\n            }\r\n        }\r\n\r\n        // Unregister from renders by type\r\n        if (render.properties.type) {\r\n            var listRendesByType = self.getRenderByType(render.properties.type);\r\n            var listRendesByTypeLength = listRendesByType.length;\r\n            var renderKey = render.properties.id || render.properties.xpath;\r\n\r\n            for (var i = 0; i < listRendesByTypeLength; i++) {\r\n                var listRender = listRendesByType[i];\r\n                if ((typeof listRender.properties.id != \"undefined\" && listRender.properties.id == renderKey) ||\r\n                    (typeof listRender.properties.xpath != \"undefined\" && listRender.properties.xpath == renderKey)) {\r\n                    // Unregister element\r\n                    self.rendersByType[render.properties.type].splice(i, 1);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    * Method to access a render by id\r\n    */\r\n    getRenderById: function (id) {\r\n        var self = this;\r\n\r\n        return self.rendersById[id];\r\n    },\r\n\r\n    getGridByColumn: function (id) {\r\n        var self = this;\r\n        var grids = self.getRenderByType('grid');\r\n        var i = 0, columnIndex;\r\n\r\n        for (; i < grids.length; i++) {\r\n            columnIndex = grids[i].columnsIds.indexOf(id);\r\n            if (columnIndex != -1) {\r\n                return grids[i];\r\n            }\r\n        }\r\n\r\n        return null;\r\n    },\r\n\r\n    /*\r\n    *   Method to find all the renders matching an xpath inside the container\r\n    */\r\n    getRenders: function (xpath) {\r\n        var self = this;\r\n\r\n        // Remove [] filters for grid columns xpaths to fully identify the grid as the xpath target\r\n        if (xpath && xpath.indexOf)\r\n            if (xpath.indexOf(\"[\") > 0) {\r\n                xpath = xpath.substring(0, xpath.indexOf(\"[\"));\r\n            }\r\n\r\n        return self.rendersByXpath[xpath] ? self.rendersByXpath[xpath] : [];\r\n    },\r\n    /**\r\n     * Get all render with the same type\r\n     */\r\n    getRenderByType: function (type) {\r\n        var self = this;\r\n\r\n        // Check that type is defined\r\n        if (typeof type == \"string\" && type.length > 0) {\r\n            // Search controls by type\r\n            return (self.rendersByType[type]) ? self.rendersByType[type] : [];\r\n        }\r\n        return [];\r\n    },\r\n\r\n    /*\r\n    *   Build the container html\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"form\");\r\n        var idCase = \"\";\r\n\r\n        // Render the form\r\n        var html = $.fasttmpl(template, {\r\n            buttons: self.buttons,\r\n            transitions: self.transitions,\r\n            uniqueId: properties.uniqueId,\r\n            helptext: properties.helpText,\r\n            mode: self.getMode(),\r\n            queryForm: self.getFormType() == \"queryForm\",\r\n            summaryForm: self.params.summaryForm || false,\r\n            globalForm: self.properties.displayAsReadOnly || false,\r\n            idCase: idCase,\r\n            displayName: self.params.displayName || idCase,\r\n            processPath: properties.processPath,\r\n            breadCrumb: properties.breadCrumb,\r\n            orientation: properties.orientation\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    },\r\n    /*\r\n    *   Process the html rendering object\r\n    */\r\n    postRenderContainer: function (form) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        // Add a mode class\r\n        form.addClass(\"ui-bizagi-rendering-mode-\" + mode);\r\n\r\n        // Call base\r\n        this._super(form);\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the container's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var complexGatewayContainer;\r\n        var form = self.container;\r\n\r\n        if (form.length > 1) {\r\n            $(form).each(function () {\r\n                if ($(this).hasClass('ui-bizagi-container-complexgateway')) {\r\n                    complexGatewayContainer = this;\r\n                }\r\n            });\r\n        } else {\r\n            complexGatewayContainer = $(\".ui-bizagi-container-complexgateway\", form);\r\n        }\r\n\r\n        // activeTransitions is used to store ids of activities in Complex Gateway\r\n        self.activeTransitions = {};\r\n\r\n        // Process buttons\r\n        self.processButtons(form);\r\n\r\n        // Check for dom included event\r\n        self.bind(\"ondomincluded\", function (e, mainForm) {\r\n            // Creates validation controller after the form is ready\r\n            self.validationController = new bizagi.command.controllers.validation(self, self.validations, mainForm);\r\n            // Creates action controller after the form is ready\r\n            self.actionController = new bizagi.command.controllers.action(self, self.actions);\r\n\r\n            // Resolve this deferred to start executing DOM dependant plugins\r\n            self.readyDeferred.resolve();\r\n        });\r\n\r\n        // Set events for complex gateway interface\r\n        $(complexGatewayContainer).find(\".ui-checkbox\").bind(\"click\", function () {\r\n            var checkboxLabel = $(\"label\", this);\r\n\r\n            var transitionId = checkboxLabel.data(\"value\") || \"\";\r\n            if (typeof self.activeTransitions[transitionId] == \"undefined\") {\r\n                self.activeTransitions[transitionId] = false;\r\n            }\r\n\r\n            if (bizagi.util.parseBoolean(checkboxLabel.data(\"checked\"))) {\r\n                // Uncheck element\r\n                checkboxLabel.removeClass(\"ui-checkbox-state-checked\");\r\n                checkboxLabel.removeClass(\"bz-check\").addClass(\"bz-full-ball\");\r\n                checkboxLabel.data(\"checked\", false);\r\n                self.activeTransitions[transitionId] = false;\r\n            } else {\r\n                // Check element\r\n                checkboxLabel.addClass(\"ui-checkbox-state-checked\");\r\n                checkboxLabel.addClass(\"bz-mo-icon\").addClass(\"bz-check\").removeClass(\"bz-full-ball\");\r\n                checkboxLabel.data(\"checked\", true);\r\n                self.activeTransitions[transitionId] = true;\r\n            }\r\n        });\r\n    },\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour when rendering in design mode\r\n    */\r\n    configureDesignView: function () {\r\n        var self = this;\r\n\r\n\r\n        // Check for dom included event\r\n        self.bind(\"ondomincluded\", function () {\r\n            // Resolve this deferred to start executing DOM dependant plugins\r\n            self.readyDeferred.resolve();\r\n        });\r\n    },\r\n    /*\r\n    *   Format form buttons to allow further customization\r\n    */\r\n    buildButtonStyle: function (button) {\r\n\r\n        var style = {};\r\n        if (button.format) {\r\n            if (button.format.size) {\r\n                if (button.format.size != \"0\") {\r\n                    var newFontSize = (100 + Number(button.format.size) * 10) + \"%\";\r\n                    style[\"font-size\"] = newFontSize + \" !important\";\r\n                }\r\n            }\r\n            if (button.format.bold) {\r\n                style[\"font-weight\"] = \"bold !important\";\r\n                if (bizagi.util.isIE()) {\r\n                    style[\"font-family\"] = \"'Open Sans', 'Helvetica Neue', Arial, Helvetica, sans-serif !important\";\r\n                }\r\n            }\r\n            if (button.format.italic) {\r\n                style[\"font-style\"] = \"italic !important\";\r\n            }\r\n            if (button.format.underline || button.format.strikethru) {\r\n                var strikethru = bizagi.util.parseBoolean(button.format.strikethru) ? \"line-through \" : \"\";\r\n                var underline = bizagi.util.parseBoolean(button.format.underline) ? \"underline \" : \"\";\r\n                style[\"text-decoration\"] = strikethru + underline + \" !important\";\r\n            }\r\n            if (button.format.background) {\r\n                style[\"background-color\"] = button.format.background + \" !important\";\r\n                style[\"background-image\"] = \"none !important\";\r\n            }\r\n            if (button.format.color) {\r\n                style[\"color\"] = button.format.color + \" !important\";\r\n            }\r\n        }\r\n\r\n        var strStyle = \"\";\r\n        for (key in style) {\r\n            strStyle += key + \":\" + style[key] + \";\";\r\n        }\r\n        return strStyle;\r\n    },\r\n    /*\r\n    *   Returns the in-memory processed element\r\n    *   Returns a promise\r\n    */\r\n    render: function () {\r\n        var self = this;\r\n\r\n        // Creates a deferred, so we can check when form has been included in dom\r\n        if (!self.readyDeferred)\r\n            self.readyDeferred = new $.Deferred();\r\n\r\n        // Call base\r\n        var result = this._super();\r\n\r\n        return result;\r\n    },\r\n    /*\r\n    *   Sets a promise that the form will be included in the DOM\r\n    *   so we can apply some tedious plugins that require that\r\n    */\r\n    ready: function () {\r\n        var self = this;\r\n\r\n        return self.readyDeferred.promise();\r\n    },\r\n    /*\r\n    *   Returns the xpath context of the element\r\n    */\r\n    getXpathContext: function () {\r\n        return this.properties.xpathContext || \"\";\r\n    },\r\n    /*\r\n    *  Return context type, when the parent form is entity\r\n    */\r\n    getContextType: function () {\r\n        return this.properties.contexttype || \"\";\r\n    },\r\n\r\n    /*\r\n    * Return the endpoint action, when the form will be refresh\r\n    */\r\n    getEndPointAction: function () {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        if (properties.formtype == \"startform\")\r\n            return \"LOADSTARTFORM\";\r\n\r\n        return undefined;\r\n\r\n    },\r\n\r\n    /*\r\n    *   Returns the page cache id for the element\r\n    */\r\n    getPageCache: function () {\r\n        return this.idPageCache;\r\n    },\r\n    /*\r\n    *   Returns the form containing the element\r\n    */\r\n    getFormContainer: function () {\r\n        return this;\r\n    },\r\n    /*\r\n    *   Method to process button actions in the form\r\n    */\r\n    processButtons: function () {\r\n        var self = this;\r\n        var buttons = self.getButtons();\r\n\r\n        // Don't process buttons if they are undefined in the template\r\n        if (!buttons || buttons.length == 0) {\r\n            return;\r\n        }\r\n\r\n        // Attach a handler for each button\r\n        buttons.on(\"click\", function (e) {\r\n            e.preventDefault();\r\n            e.stopImmediatePropagation();\r\n\r\n            self.startLoading();\r\n\r\n            var button = $(this);\r\n            var ordinal = button.attr(\"ordinal\");\r\n            var buttonProperties = self.buttons[ordinal];\r\n\r\n            self.lastActionButton = buttonProperties;\r\n            if (buttonProperties.action === \"next\") {\r\n                buttonProperties.routingDisabled = self.isRoutingDisabled;\r\n            }\r\n\r\n            button.prop(\"disabled\", true); //disable button to prevent multiple click actions\r\n\r\n            if(button.hasOwnProperty('disabled')) {\r\n                button.button(\"disable\"); //Setting styles\r\n            }\r\n\r\n            // External Events\r\n            self.propagateExternalEvents(e);\r\n\r\n            // Execute button\r\n            //QAF-1418 - add setTimeout\r\n            setTimeout(function () {\r\n                $.when(self.processButton(buttonProperties)).always(function () {\r\n                    self.processDefer = undefined;\r\n                    self.endLoading();\r\n                    if ($.contains(document.documentElement, button.get(0))) { //check if button is still in DOM\r\n                        button.prop(\"disabled\", false);  //enable button\r\n\r\n                        if(button.hasOwnProperty('enable')) {\r\n                            button.button(\"enable\"); //Setting styles\r\n                        }\r\n                    }\r\n                });\r\n            }, 100);\r\n        });\r\n    },\r\n    /*\r\n    * Execute codes just before sending information to server\r\n    */\r\n    preProcessButton: function (buttonProperties) {\r\n        return true;\r\n    },\r\n    /*\r\n    * Execute codes just after sending information to server\r\n    */\r\n    postProcessButton: function (responses, buttonProperties) {\r\n        return true; // true means continue\r\n    },\r\n\r\n    setLoaderDeferred: function() {\r\n        var self = this;\r\n\r\n        self.loaderDeferred = $.Deferred().resolve();\r\n    },\r\n\r\n    deleteLoaderDeferred: function () {\r\n        var self = this;\r\n\r\n        if (self.isLoaderDeferredSet()) {\r\n            $.when(self.loaderDeferred.promise()).done(function() {\r\n                delete self.loaderDeferred;\r\n            });\r\n        }\r\n    },\r\n\r\n    useOrSetLoaderDeferred: function () {\r\n        var self = this;\r\n\r\n        if (!self.isLoaderDeferredSet()) {\r\n            self.setLoaderDeferred();\r\n        }\r\n    },\r\n\r\n    getLoaderPromise: function () {\r\n        var self = this;\r\n\r\n        if (self.isLoaderDeferredSet()) {\r\n            return self.loaderDeferred.promise();\r\n        } else {\r\n            return;\r\n        }\r\n    },\r\n\r\n    isLoaderDeferredSet: function () {\r\n        var self = this;\r\n\r\n        if (self.loaderDeferred) {\r\n            return true;\r\n        } else {\r\n            return false;\r\n        }\r\n    },\r\n\r\n    appendWaitForLoader: function (params) {\r\n        var self = this;\r\n        var promise = params.promise;\r\n        var create = params.create || false;\r\n\r\n        if (!self.isLoaderDeferredSet()) {\r\n            if (create) {\r\n                self.setLoaderDeferred();\r\n            } else {\r\n                return;\r\n            }\r\n        }\r\n\r\n        self.loaderDeferred = self.loaderDeferred.then(function () {\r\n            return (function () {\r\n                return promise;\r\n            })();\r\n        });\r\n    },\r\n\r\n\r\n    /*\r\n    *   Executes a single button action\r\n    */\r\n    processButton: function (buttonProperties) {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n        var properties = self.properties;\r\n        if (!buttonProperties.routing) {\r\n            bizagi.chrono.initAndStart(\"submitForm\");\r\n        }\r\n        bizagi.chrono.init(\"waiting\");\r\n\r\n        // First hide and clear validation box\r\n        self.validationController.clearValidationMessages();\r\n\r\n        // Resolve asynchronous tabItems\r\n        var form = self.getFormContainer();\r\n        var getAllTabs = form.getRenderByType(\"tabItem\");\r\n        var getAllTabsLength = getAllTabs.length;\r\n\r\n        form.innerTabsLoading = true;\r\n\r\n\r\n        self.useOrSetLoaderDeferred();\r\n\r\n        // Check\r\n        for (var i = 0; i < getAllTabsLength; i++) {\r\n            var render = getAllTabs[i];\r\n            // Resolve internal deferred\r\n            if (render.loadingDeferred && render.parent.container) {\r\n                render.loadingDeferred.resolve();\r\n            }\r\n        }\r\n\r\n        delete form.innerTabsLoading;\r\n\r\n        $.when(self.ready(), self.getLoaderPromise()).done(function () {\r\n            self.deleteLoaderDeferred();\r\n            // Validate the form\r\n            var valid = bizagi.util.parseBoolean(buttonProperties.validate) ? self.validationController.performValidations() : true;\r\n            if (valid) {\r\n\r\n                if ([\"save\", \"next\", \"back\", \"createnewcase\", \"nextWithoutValidations\"].includes(buttonProperties.action)) {\r\n                    $(document).data('auto-save', '');\r\n                }\r\n\r\n                // Check for user confirmation if configured and the button is configured to enroute\r\n                if (bizagi.util.parseBoolean(self.properties.needsUserConfirmation) && bizagi.util.parseBoolean(buttonProperties.routing)) {\r\n                    self.endLoading();\r\n                    $.when(bizagi.showConfirmationBox(properties.userConfirmationMessage, null, false)).done(function () {\r\n                        // Submits the form\r\n                        if (self.preProcessButton(buttonProperties)) {\r\n                            //Trigger the event after ProcessButton\r\n                            self.triggerGlobalHandler(\"renderActionButton\", buttonProperties);\r\n                            $.when(self.submitForm(buttonProperties)).done(function () {\r\n                                defer.resolve();\r\n                            }).fail(function() {\r\n                                defer.reject(arguments);\r\n                            });\r\n                        }\r\n                    }).fail(function () {\r\n                        defer.reject();\r\n                    });\r\n\r\n                } else {\r\n                    if (self.preProcessButton(buttonProperties)) {\r\n                        //Trigger the event after ProcessButton\r\n                        self.triggerGlobalHandler(\"renderActionButton\", buttonProperties);\r\n                        $.when(self.submitForm(buttonProperties)).done(function () {\r\n                            $(document).trigger(\"FORMACTION\", buttonProperties);\r\n                            defer.resolve();\r\n                        }).fail(function () {\r\n                            defer.reject(arguments);\r\n                        });\r\n                    }\r\n                }\r\n\r\n            } else {\r\n\r\n                self.endLoading();\r\n                if (buttonProperties.submitData) {\r\n                    $.when(self.submitData()).done(function () {\r\n                        defer.reject();\r\n                    });\r\n                }\r\n                else {\r\n                    defer.reject();\r\n                }\r\n\r\n                self.validationController.expandNotificationBox();\r\n            }\r\n\r\n            var customHandler = self.getCustomHandler(\"afterFormButtonClick\");\r\n            if (customHandler) {\r\n                customHandler(buttonProperties);\r\n            }\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n    /*\r\n    *   Public method to perform validations externally\r\n    */\r\n    validateForm: function () {\r\n        var self = this;\r\n\r\n        // First hide and clear validation box\r\n        self.validationController.clearValidationMessages();\r\n\r\n        // Validate the form\r\n        return self.validationController.performValidations();\r\n    },\r\n    /*\r\n    *   Submits all the form to the server and returns a deferred to check when the process finishes\r\n    */\r\n    saveForm: function () {\r\n        var self = this;\r\n\r\n        // Check is offline form        \r\n        var isOfflineForm = bizagi.util.isOfflineForm({ context: self });\r\n\r\n        // Collect data\r\n        var data = self.collectRenderValuesForSubmit();\r\n\r\n        // Check if there are deferreds to wait\r\n        var deferredsToWait = null;\r\n        if (data.deferreds) {\r\n            deferredsToWait = $.when.apply($, data.deferreds);\r\n            delete data.deferreds;\r\n        }\r\n\r\n        // Wait for deferreds\r\n        return $.when(deferredsToWait).pipe(function () {\r\n            self.startLoading();\r\n\r\n            // Submit the form\r\n            return $.when(self.dataService.submitData({\r\n                action: \"SAVE\",\r\n                data: data,\r\n                idCase: self.params.idCase,\r\n                idWorkitem: self.params.idWorkitem,\r\n                xpathContext: self.properties.xpathContext,\r\n                idPageCache: self.properties.idPageCache,\r\n                isOfflineForm: isOfflineForm || false\r\n            })).always(function () {\r\n                self.endLoading();\r\n            });\r\n        });\r\n    },\r\n    /*\r\n    *   Creates a json array with key values to send to the server\r\n    */\r\n    submitForm: function (buttonProperties) {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n\r\n        // Check is offline form                \r\n        var isOfflineForm = bizagi.util.isOfflineForm({ context: self });\r\n\r\n        $.when(self.isReadyToSave())\r\n            .done(function () {\r\n                if (isOfflineForm) {\r\n                    self.internalSubmitFormOffline(buttonProperties);\r\n                    return;\r\n                }\r\n                $.when(self.internalSubmitForm(buttonProperties)).done(function () {\r\n                    defer.resolve();\r\n                }).fail(function () {\r\n                    defer.reject(arguments);\r\n                });\r\n\r\n            }).fail(function () {\r\n            self.endLoading();\r\n            bizagi.log(\"The form is not saved, no changes were found\");\r\n            defer.reject();\r\n        });\r\n        return defer.promise();\r\n    },\r\n    checkWidgetsData: function () {\r\n        //\r\n    },\r\n    isComplexGatewayPainted: function () {\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Get last action button\r\n     * @returns {*}\r\n     */\r\n    getLastActionButton: function () {\r\n        var self = this;\r\n        return self.lastActionButton;\r\n    },\r\n\r\n    /**\r\n     * Internal - Creates a json array with key values to send to the database\r\n     * @param {} buttonProperties\r\n     * @returns {}\r\n     */\r\n    internalSubmitFormOffline: function (buttonProperties) {\r\n        var self = this;\r\n        var message = \"\";\r\n        var data;\r\n\r\n        // Check is offline form                \r\n        var isOfflineForm = bizagi.util.isOfflineForm({ context: self });\r\n\r\n        if (isOfflineForm && (self.properties && !self.properties.idPageCache)) {\r\n            self.properties.idPageCache = \"\";\r\n        }\r\n\r\n        // Fill data hash\r\n        if (buttonProperties.submitData || buttonProperties.executeRule) {\r\n            // Collect data\r\n            data = self.collectRenderValuesForSubmit();\r\n        }\r\n\r\n        if (self.transitions) {\r\n            var transitions = [];\r\n            $.each(this.activeTransitions, function (key, value) {\r\n                (value) ? transitions.push(key) : \"\";\r\n            });\r\n\r\n            if (bizagi.util.countProps(transitions) == 0) {\r\n                bizagi.showMessageBox(\r\n                    bizagi.localization.getResource(\"render-widget-complexgateway-path\"),\r\n                    bizagi.localization.getResource(\"render-widget-complexgateway-error\"), \"info\", false\r\n                );\r\n                self.endLoading();\r\n                return \"\";\r\n            }\r\n        }\r\n\r\n        $.when(self.dataService.submitData({\r\n            action: buttonProperties.action,\r\n            data: data,\r\n            xpathContext: self.properties.xpathContext,\r\n            idPageCache: self.properties.idPageCache,\r\n            idForm: self.properties.id,\r\n            prepare: true,\r\n            transitions: transitions || \"\",\r\n            idCase: self.params.idCase,\r\n            idWorkitem: self.params.idWorkitem,\r\n            isOfflineForm: isOfflineForm || false,\r\n            offlineType: self.params.offlineType || \"\"\r\n        })).done(function (responses) {\r\n\r\n            if (!self.postProcessButton(responses, buttonProperties)) {\r\n                return;\r\n            }\r\n\r\n            if (buttonProperties.routing) {\r\n                var waitForOnlineResponse = false;\r\n                if(isOfflineForm && self.isOfflineFormsV2Supported && self.params.online) {\r\n                    waitForOnlineResponse = true;\r\n                    var tryPushResponsePromise = new $.Deferred();\r\n                    self.params.responsePromise = tryPushResponsePromise;\r\n                    $(document).trigger(\"tryPushCase.offline\", self.params);\r\n                }\r\n                else if( isOfflineForm && !self.isOfflineFormsV2Supported){\r\n                    $(document).trigger(\"tryPushData.offline\");\r\n                }\r\n\r\n                if(!waitForOnlineResponse){\r\n                    self.triggerHandler(\"routing\", {\r\n                        offlineAction: buttonProperties.action,\r\n                        idCase: self.params.idCase,\r\n                        idWorkitem: self.params.idWorkitem\r\n                    });\r\n                }\r\n                else {\r\n                    $.when(tryPushResponsePromise)\r\n                    .then( function(result){\r\n                        self.triggerHandler(\"routing\", {\r\n                            idCase: result.IdCase,\r\n                            caseNumber: result.CaseNumber\r\n                        });\r\n                    })\r\n                    .fail( function(error){\r\n                        self.failHandler(error);\r\n                    });\r\n                }\r\n\r\n            } else {\r\n                message = bizagi.util.isValidResource(\"workportal-mobile-offline-form-successful\")\r\n                    ? bizagi.localization.getResource(\"workportal-mobile-offline-form-successful\")\r\n                    : \"Saved\";\r\n\r\n                bizagi.util.showNotification({ text: message, type: \"success\" });\r\n            }\r\n\r\n        }).fail(function (error) {\r\n            message = bizagi.util.isValidResource(\"workportal-mobile-offline-successful-fail\")\r\n                ? bizagi.localization.getResource(\"workportal-mobile-offline-successful-fail\")\r\n                : \"Not saved\";\r\n\r\n            bizagi.util.showNotification({ text: message, type: \"error\" });\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Internal - Creates a json array with key values to send to the server\r\n    */\r\n    internalSubmitForm: function (buttonProperties) {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n        var data;\r\n\r\n        // Fill data hash\r\n        if (buttonProperties.submitData || buttonProperties.executeRule || buttonProperties.createnewcase) {\r\n            // Collect data\r\n            data = self.collectRenderValuesForSubmit();\r\n        }\r\n\r\n        // Start asynchronous operation\r\n        $.when(self.startLoading()).done(function () {\r\n            $('html, body').animate({ scrollTop: $('.ui-bizagi-loading-icon') }, 'slow');\r\n        });\r\n\r\n        var submitDataAction = null;\r\n        var executeButtonAction = null;\r\n        var performAction = null;\r\n        var checkpointAction = null;\r\n        var commitAction = null;\r\n        var waitingDeferreds = [];\r\n        var deferredsToWait = null;\r\n\r\n        // Prepare actions\r\n        if (buttonProperties.executeRule) {  // When the button has to execute any rule (MUST SUBMIT DATA BEFORE ALWAYS)\r\n\r\n            if (data.deferreds) {\r\n                deferredsToWait = $.when.apply($, data.deferreds);\r\n                waitingDeferreds.push(deferredsToWait);\r\n                delete data.deferreds;\r\n            }\r\n\r\n            submitDataAction = self.dataService.submitData({\r\n                action: \"SUBMITDATA\",\r\n                data: data,\r\n                xpathContext: self.properties.xpathContext,\r\n                idPageCache: self.properties.idPageCache,\r\n                prepare: true\r\n            });\r\n            submitDataAction.tag = \"submitData\";\r\n\r\n            checkpointAction = self.prepareCheckpointAction(buttonProperties.id);\r\n\r\n            // Reset data because when an execute rule operation has been performed, it saved already all the data\r\n            data = {};\r\n            executeButtonAction = self.dataService.executeButton({\r\n                idRender: buttonProperties.id,\r\n                xpathContext: self.properties.xpathContext || \"\",\r\n                idPageCache: self.properties.idPageCache,\r\n                prepare: true\r\n            });\r\n            executeButtonAction.tag = \"executeRule\";\r\n\r\n            commitAction = self.prepareCommitAction(buttonProperties.id);\r\n        }\r\n\r\n        if (buttonProperties.next || buttonProperties.back || buttonProperties.save || buttonProperties.createnewcase || buttonProperties.nextWithoutValidations) {\r\n            // Verify transitions\r\n            if (self.transitions) {\r\n                var transitions = [];\r\n                $.each(this.activeTransitions, function (key, value) {\r\n                    (value) ? transitions.push(key) : \"\";\r\n                });\r\n\r\n                if (bizagi.util.countProps(transitions) == 0) {\r\n                    bizagi.showMessageBox(bizagi.localization.getResource(\"render-widget-complexgateway-path\"), bizagi\r\n                        .localization.getResource(\"render-widget-complexgateway-error\"), \"info\", false);\r\n                    self.endLoading();\r\n                    defer.reject();\r\n                    return defer.promise();\r\n                }\r\n            }\r\n\r\n            if (data.deferreds) {\r\n                deferredsToWait = $.when.apply($, data.deferreds);\r\n                waitingDeferreds.push(deferredsToWait);\r\n                delete data.deferreds;\r\n            }\r\n\r\n\r\n            performAction = self.dataService.submitData({\r\n                action: self.getButtonAction(buttonProperties.action),\r\n                forcePlanCompletion: buttonProperties.forcePlanCompletion,\r\n                data: data,\r\n                xpathContext: self.properties.xpathContext,\r\n                idPageCache: self.properties.idPageCache,\r\n                prepare: true,\r\n                transitions: transitions || \"\",\r\n                contexttype: self.properties.contextType,\r\n                surrogatekey: self.properties.surrogateKey\r\n            });\r\n            performAction.tag = \"performAction\";\r\n        }\r\n\r\n        // Assemble the actions\r\n        var actions = [];\r\n\r\n        if (executeButtonAction) {\r\n            actions.push(submitDataAction);\r\n            actions.push(checkpointAction);\r\n            actions.push(executeButtonAction);\r\n            actions.push(commitAction);\r\n        }\r\n\r\n        if (performAction) {\r\n            actions.push(performAction);\r\n        }\r\n\r\n        // Execute the batch\r\n        bizagi.chrono.initAndStart(\"submitForm-ajax\");\r\n\r\n\r\n        //Evaluate if there are deferreds to evaluate, like inline add in grid, that must send a ADDRELATIONWITHDATA before to savedata\r\n        var flowControlDeferred = new $.Deferred();\r\n        if (data && data.deferreds) {\r\n            $.when.apply(this, data.deferreds)\r\n                .done(function (response) {\r\n                    flowControlDeferred.resolve(response);\r\n                })\r\n                .fail(function () {\r\n                    flowControlDeferred.reject();\r\n                    console.log(\"Error: It was not possible resolve async actions on form \")\r\n                })\r\n        } else {\r\n            flowControlDeferred.resolve();\r\n        }\r\n\r\n        waitingDeferreds.push(flowControlDeferred);\r\n\r\n        $.when.apply($, waitingDeferreds).done(function() {\r\n            $.when(self.dataService.multiaction().execute({ actions: actions })).done(function (responses) {\r\n                bizagi.chrono.stop(\"submitForm-ajax\");\r\n                // End asynchronous operation\r\n                self.endLoading();\r\n                // Find validations\r\n                var bHasValidations;\r\n                var alertMessage = \"\";\r\n                $.each(responses, function (i, response) {\r\n\r\n                    var propertiesToDisplayMessages = self.validationToDisplayMessages(bHasValidations, response.result.type, response.result.messages, alertMessage);\r\n                    bHasValidations = propertiesToDisplayMessages.bHasValidations;\r\n                    alertMessage = propertiesToDisplayMessages.alertMessage;\r\n\r\n                });\r\n\r\n                if (!bHasValidations) {\r\n                    // Everything went ok .. succesfully response from the server\r\n                    if (!self.postProcessButton(responses, buttonProperties)) {\r\n                        return;\r\n                    }\r\n\r\n                    // After successfully response refresh the form\r\n                    if (buttonProperties.refresh) {\r\n                        self.refreshForm();\r\n                    }\r\n\r\n                    // If needs routing publish an event\r\n                    if (buttonProperties.routing) {\r\n                        bizagi.jqxhrList.abortAll(\"rendering_\" + self.dataService.guid);\r\n                        self.triggerHandler(\"routing\", {\r\n                            idCase: self.params.idCase,\r\n                            routingDisabled: buttonProperties.routingDisabled\r\n                        });\r\n                    }\r\n\r\n                    // Create case\r\n                    if (buttonProperties.createnewcase) {\r\n                        if (responses.length > 0) {\r\n                            bizagi.jqxhrList.abortAll(\"rendering_\" + self.dataService.guid);\r\n                            self.triggerHandler(\"routing\", {\r\n                                idCase: responses[0].result.IdCase,\r\n                                caseNumber: responses[0].result.CaseNumber\r\n                            });\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    if(alertMessage !== \"\"){ /*If there is an alertMessage show in a modal error*/\r\n                        bizagi.modalError.show(alertMessage, 'workportal-general-word-information', false);\r\n                    }\r\n                    if (buttonProperties.executeRule) {\r\n                        self.sendRollbackAction(buttonProperties.id);\r\n                    }\r\n                }\r\n\r\n                defer.resolve();\r\n            }).fail(function (_, _, response) {\r\n                if (buttonProperties.executeRule) {\r\n                    self.sendRollbackAction(buttonProperties.id);\r\n                }\r\n\r\n                if (response && response.error && (response.error.errorType === \"WaitForCompletionPlanException\" ||\r\n                    response.error.errorType === \"InvalidPlanStateException\" || response.error.errorType === \"CustomMessageException\")) {\r\n                    self.endLoading();\r\n                    $.when(bizagi.showConfirmationBox(bizagi.localization.getResource(response.error.message), null, false)).then(function () {\r\n                        return $.when(self.internalSubmitForm($.extend({}, buttonProperties, { forcePlanCompletion: true })));\r\n                    }).done(function () {\r\n                        defer.resolve();\r\n                    }).fail(function () {\r\n                        defer.reject();\r\n                    });\r\n                } else {\r\n                    self.failHandler(response);\r\n                    defer.reject(response);\r\n                }\r\n            });\r\n        });\r\n        return defer.promise();\r\n    },\r\n    validationToDisplayMessages: function(bHasValidations, messageType, message, alertMessage){\r\n        var self = this;\r\n\r\n        if (messageType == \"validationMessages\") {\r\n            // Something went wrong, we gotta display messages in notifications grid\r\n            self.addValidationMessage(message);\r\n            bHasValidations = true;\r\n        }\r\n        if(bizagi.detectDevice() == \"desktop\" && messageType == \"alertMessages\"){\r\n            // Something went wrong, we gotta display alert message\r\n            if(alertMessage === \"\"){\r\n                alertMessage = message;\r\n            }else{\r\n                alertMessage = alertMessage + \"\\n\\n\" + message;\r\n            }\r\n\r\n            bHasValidations = true;\r\n        }\r\n\r\n        return {\"bHasValidations\": bHasValidations, \"alertMessage\": alertMessage};\r\n    },\r\n\r\n    /*\r\n    *   Add a validation message to the form\r\n    */\r\n    addValidationMessage: function (validationMessage, focus, icon, itemAdditionalClass, autofocus, type) {\r\n        var self = this;\r\n\r\n        if (!self.validationController) {\r\n            self.validationController = new bizagi.command.controllers.validation(self);\r\n        }\r\n\r\n        if (typeof (validationMessage) == \"string\") {\r\n            self.validationController.showValidationMessage(validationMessage, focus, icon, itemAdditionalClass, type);\r\n        } else {\r\n            $.each(validationMessage, function (i, message) {\r\n                self.validationController.showValidationMessage(message, focus, icon, itemAdditionalClass, type);\r\n            });\r\n        }\r\n        self.validationController.expandNotificationBox(autofocus);\r\n    },\r\n    /*\r\n    *   Public method to perform validations externally\r\n    */\r\n    clearValidationMessages: function (params) {\r\n        var self = this;\r\n\r\n        // First hide and clear validation box\r\n        if (self.validationController) {\r\n            self.validationController.clearValidationMessages(params);\r\n        }\r\n\r\n    },\r\n    /*\r\n    *   Add an error message to the form\r\n    */\r\n    addErrorMessage: function (errorMessage) {\r\n        var self = this;\r\n\r\n        self.validationController.showErrorMessage(errorMessage);\r\n        self.validationController.expandNotificationBox();\r\n    },\r\n    /*\r\n    *   Refresh the current form\r\n    */\r\n    refreshForm: function (focus) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var deferred = $.Deferred();\r\n\r\n        focus = focus || self.getFocus();\r\n\r\n        // Normalize new focus structure if not present\r\n        if (focus && !focus.id) {\r\n            focus = {\r\n                id: focus\r\n            };\r\n        }\r\n\r\n        var options = {\r\n            idCase: self.params.idCase || \"\",\r\n            idWorkitem: self.params.idWorkitem || \"\",\r\n            idTask: self.params.idTask || \"\",\r\n            focus: focus,\r\n            selectedTabs: self.getSelectedTabs(),\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            isRefresh: true,\r\n            contextType: self.getContextType() || \"\",\r\n            action: self.getEndPointAction(),\r\n            idStartScope: self.properties.idStartScope || \"\"\r\n        };\r\n\r\n        // Notify the refresh event so the consumer takes the decision about what to do\r\n        self.startLoading();\r\n        $.when(self.triggerHandler(\"refresh\", options)).done(function () {\r\n            self.endLoading();\r\n            deferred.resolve();\r\n        }).fail(function () {\r\n            self.endLoading();\r\n            deferred.reject();\r\n        });\r\n        return deferred.promise();\r\n    },\r\n    /*\r\n    *   Get opened tabs configuration\r\n    */\r\n    getSelectedTabs: function () {\r\n        var self = this;\r\n        var tabContainers = self.getElementsByType(\"tab\");\r\n        var tabs = $.map(tabContainers, function (tabContainer) {\r\n            return { tab: tabContainer.properties.id, selected: tabContainer.activeTab };\r\n        });\r\n        var selectedTabs = {};\r\n        for (var i = 0, length = tabs.length; i < length; i++) {\r\n            selectedTabs[tabs[i].tab] = tabs[i].selected;\r\n        }\r\n        return selectedTabs;\r\n    },\r\n    /*\r\n    *   Template method to get the buttons objects\r\n    */\r\n    getButtons: function () {\r\n    },\r\n    /*\r\n    *   Adds an action on the fly to process the submit on change\r\n    */\r\n    addSubmitAction: function (xpath, action) {\r\n        var self = this;\r\n        self.actionController.processInternalSubmitAction(xpath, action);\r\n    },\r\n    /**\r\n     *   Adds an overlay to the form, and sets a waiting message\r\n     *\r\n     *   @argument {bool} delay Apply delay\r\n     */\r\n    startLoading: function () {\r\n        var self = this;\r\n        var waitingTemplate = self.renderFactory.getTemplate(\"form-waiting\");\r\n\r\n        if (self.waitingOverlay && self.waitingMessage)\r\n            return;\r\n\r\n        // This hack is only for desktop\r\n        if (!bizagi.util.isTabletDevice()) {\r\n            // Detect canvas parent with scroll\r\n            var isSharePoint = self.params.context === \"sharepoint\";\r\n            var canvas = self.params.canvas;\r\n            if (isSharePoint) {\r\n                canvas = bizagi.util.scrollTop(canvas);\r\n\r\n                if (!!!canvas.context) {\r\n                    canvas = $(\"body\", $(document));\r\n                }\r\n            } else {\r\n                canvas = $(\"body\", $(document));\r\n            }\r\n\r\n            // Configures overlay\r\n            var size = this.getSize();\r\n            var position = this.getOffset();\r\n            if (size.height == $(window).height()) {\r\n                position.top = 0;\r\n            }\r\n            self.waitingOverlay = $('<div class=\"ui-widget-overlay\" />').appendTo(canvas);\r\n            self.waitingMessage = $.tmpl(waitingTemplate).appendTo(canvas);\r\n            self.waitingOverlay.css({\r\n                \"height\": \"100%\",\r\n                \"width\": \"100%\",\r\n                \"min-height\": size.height,\r\n                \"min-width\": size.width\r\n            });\r\n            self.waitingMessage.css({\r\n                \"top\": (position.top + Math.ceil((size.height - self.waitingMessage.outerHeight()) / 2)) + \"px\",\r\n                \"left\": (Math.ceil((size.width - self.waitingMessage.outerWidth()) / 2)) + \"px\"\r\n            });\r\n            canvas.css(\"position\", \"relative\");\r\n\r\n        } else {\r\n            // Configures overlay\r\n            self.waitingOverlay = $('<div class=\"ui-widget-overlay\" />').appendTo(\"body\", $(document));\r\n            self.waitingMessage = $.tmpl(waitingTemplate).appendTo(\"body\", $(document));\r\n        }\r\n    },\r\n    /*\r\n    *   Removes the overlay and restores the form edition\r\n    */\r\n    endLoading: function () {\r\n        var self = this;\r\n        if (self.waitingOverlay && self.waitingMessage) {\r\n            self.waitingOverlay.remove();\r\n            self.waitingMessage.remove();\r\n            self.waitingOverlay = null;\r\n            self.waitingMessage = null;\r\n\r\n            var canvas = self.params.canvas;\r\n\r\n            if (canvas != undefined)\r\n                canvas.css(\"position\", \"\");\r\n        }\r\n    },\r\n    /*\r\n    *   Get the focused render in the current request\r\n    */\r\n    getFocusedElement: function () {\r\n        var self = this;\r\n        return self.focus;\r\n    },\r\n    /*\r\n    *   Set the focused render in the current request\r\n    */\r\n    setFocusedElement: function (focus) {\r\n        var self = this;\r\n        self.focus = focus;\r\n    },\r\n    /*\r\n    *   Publish a global event that the facade will replicate\r\n    */\r\n    triggerGlobalHandler: function (eventType, data) {\r\n        return this.triggerHandler(\"globalHandler\", { eventType: eventType, data: data });\r\n    },\r\n    /*\r\n    *   Generic handler to attach fail workflow for some operations\r\n    */\r\n    failHandler: function (error) {\r\n        var self = this;\r\n\r\n        // Check if the error is in multiaction format\r\n        try {\r\n            error = JSON.parse(error);\r\n        } catch (e) {\r\n        }\r\n\r\n        //This double validation has the purpose to get the real error object from two different levels ( error.error or error.error.error )\r\n        if (error & error.length && error.length > 1) error = error[0];\r\n        if (error.error) error = error.error;\r\n        if (error.error) error = error.error;\r\n\r\n        // Handle normal messages\r\n        if (typeof error == \"object\" && error.message) {\r\n            if (error.errorType === \"WaitForCompletionPlanException\" || error.errorType === \"InvalidPlanStateException\" || error.errorType === \"CustomMessageException\") {\r\n                error = bizagi.localization.getResource(error.message);\r\n            }\r\n            else {\r\n                error = error.message;\r\n            }\r\n\r\n        } else if (typeof error == \"string\") {\r\n            // Parse to json\r\n            try {\r\n                var errorJson = JSON.parse(error);\r\n                if (errorJson.errorType === \"WaitForCompletionPlanException\" || errorJson.errorType === \"InvalidPlanStateException\" || error.errorType === \"CustomMessageException\") {\r\n                    errorJson.message = bizagi.localization.getResource(errorJson.message);\r\n                }\r\n                error = errorJson.message;\r\n            } catch (e) {\r\n            }\r\n        }\r\n\r\n        // Workflow engine error, we gotta show it with error\r\n        self.addErrorMessage(error);\r\n        self.endLoading();\r\n    },\r\n    /* \r\n    *   Resizes the element\r\n    */\r\n    resize: function (size) {\r\n        // Just save the size, for reference\r\n        this.setSize(size);\r\n    },\r\n    /*\r\n    *   Sets the internal size for the form\r\n    */\r\n    setSize: function (size) {\r\n        this.size = size;\r\n    },\r\n    /*\r\n    *   Gets the internal size for the form\r\n    */\r\n    getSize: function () {\r\n        if (this.size) {\r\n            return this.size;\r\n        }\r\n        var canvas = (this.params.canvas) ? this.params.canvas : this.getFormContainer().container;\r\n\r\n        var canvasWidth = canvas.width();\r\n        var canvasHeight = canvas.height();\r\n\r\n        return {\r\n            width: canvasWidth,\r\n            height: canvasHeight\r\n        };\r\n    },\r\n    getOffset: function () {\r\n        var canvas = this.getFormContainer().container;\r\n\r\n        return canvas.offset();\r\n    },\r\n    /**\r\n     * This function execute action to save all data of render, but\r\n     * the server service dont execute any rule on the server\r\n     */\r\n    submitData: function (args) {\r\n        var self = this;\r\n\r\n        // Collect data\r\n        var data = self.collectRenderValuesForSubmit();\r\n\r\n        // Check is offline form        \r\n        var isOfflineForm = bizagi.util.isOfflineForm({ context: self });\r\n\r\n        if (isOfflineForm && (self.properties && !self.properties.idPageCache)) {\r\n            self.properties.idPageCache = \"\";\r\n        }\r\n\r\n        // Mark data collected as original values\r\n        $.each(data, function (key, value) {\r\n            var renders = self.getRenders(key);\r\n            $.each(renders, function (i, render) {\r\n                render.updateOriginalValue();\r\n            });\r\n        });\r\n\r\n        // Don't do anything if there is no data\r\n        if ($.isEmptyObject(data)) {\r\n            return;\r\n        }\r\n\r\n        // Call the service\r\n        return $.when(self.dataService.multiaction().submitData({\r\n            action: \"SUBMITDATA\",\r\n            data: data,\r\n            idPageCache: self.properties.idPageCache,\r\n            xpathContext: self.properties.xpathContext,\r\n            contexttype: self.properties.contexttype || \"\"\r\n        })).fail(function (message) {\r\n            message = self.processFailMessage(message);\r\n        });\r\n    },\r\n    /**\r\n     * This function send a request to the server to execute a rule\r\n     */\r\n    executeRule: function (args) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpathContext = args.xpathContext;\r\n\r\n        if (properties.xpathContext != \"\") {\r\n            // Concat inheritance context\r\n            xpathContext = (xpathContext != \"\") ? properties.xpathContext + \".\" + xpathContext : properties.xpathContext;\r\n        }\r\n\r\n\r\n        // Perform the service\r\n        return $.when(self.dataService.multiaction().executeRule({\r\n            idPageCache: properties.idPageCache,\r\n            rule: args.rule,\r\n            xpathContext: xpathContext,\r\n            contexttype: self.properties.contexttype || \"\"\r\n        })).done(function (message) {\r\n            // Check for validation messages\r\n            self.getFormContainer().clearValidationMessages({ clearOnlyServer: true });\r\n            if (message && message.type == \"validationMessages\") {\r\n                self.getFormContainer().addValidationMessage.apply(self, [message.messages, undefined, undefined, undefined, false, \"serverMessage\"]);\r\n            }\r\n            if(bizagi.detectDevice() == \"desktop\" && message.type == \"alertMessages\"){\r\n                bizagi.modalError.show(message.messages.join(\"\\n\\n\"), 'workportal-general-word-information', false);\r\n            }\r\n        }).fail(function (message) {\r\n            message = self.processFailMessage(message);\r\n        });\r\n    },\r\n    /**\r\n     * This function send a request to the server to execute an interface\r\n     */\r\n    executeInterface: function (args) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpathContext = args.xpathContext;\r\n\r\n        if (properties.xpathContext != \"\") {\r\n            // Concat inheritance context\r\n            xpathContext = (xpathContext != \"\") ? properties.xpathContext + \".\" + xpathContext : properties.xpathContext;\r\n        }\r\n\r\n        // Perform the service\r\n        return $.when(self.dataService.multiaction().executeInterface({\r\n            idPageCache: properties.idPageCache,\r\n            interface: args.interface,\r\n            xpathContext: xpathContext,\r\n            contexttype: self.properties.contexttype || \"\"\r\n        })).done(function (message) {\r\n            // Check for validation messages\r\n            self.getFormContainer().clearValidationMessages();\r\n            if (message && message.type == \"validationMessages\") {\r\n                self.getFormContainer().addValidationMessage(message.messages);\r\n            }\r\n\r\n        }).fail(function (message) {\r\n            message = self.processFailMessage(message);\r\n        });\r\n    },\r\n    executeSAPConnector: function (args) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpathContext = args.xpathContext;\r\n\r\n        if (properties.xpathContext != \"\") {\r\n            // Concat inheritance context\r\n            xpathContext = (xpathContext != \"\") ? properties.xpathContext + \".\" + xpathContext : properties.xpathContext;\r\n        }\r\n\r\n        // Perform the service\r\n        return $.when(self.dataService.multiaction().executeSAPConnector({\r\n            idPageCache: properties.idPageCache,\r\n            guidsap: args.guidsap,\r\n            xpathContext: xpathContext,\r\n            contexttype: self.properties.contexttype || \"\"\r\n        })).done(function (message) {\r\n            // Check for validation messages\r\n            self.getFormContainer().clearValidationMessages();\r\n            if (message && message.type == \"validationMessages\") {\r\n                self.getFormContainer().addValidationMessage(message.messages);\r\n            }\r\n\r\n        }).fail(function (message) {\r\n            message = self.processFailMessage(message);\r\n        });\r\n\r\n    },\r\n\r\n    executeConnector: function (args) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpathContext = args.xpathContext;\r\n\r\n        if (properties.xpathContext != \"\") {\r\n            // Concat inheritance context\r\n            xpathContext = (xpathContext != \"\") ? properties.xpathContext + \".\" + xpathContext : properties\r\n                .xpathContext;\r\n        }\r\n\r\n        // Perform the service\r\n        return $.when(self.dataService.multiaction().executeConnector({\r\n            idPageCache: properties.idPageCache,\r\n            guidConnector: args.guidConnector,\r\n            xpathContext: xpathContext,\r\n            contexttype: self.properties.contexttype || \"\"\r\n        })).done(function (message) {\r\n            // Check for validation messages\r\n            self.getFormContainer().clearValidationMessages();\r\n            if (message && message.type == \"validationMessages\") {\r\n                self.getFormContainer().addValidationMessage(message.messages);\r\n            }\r\n\r\n        }).fail(function (message) {\r\n            message = self.processFailMessage(message);\r\n        });\r\n\r\n    },\r\n\r\n    /*\r\n    *   Re-binds pending actions that could not be set because the renders did not exist when the form loaded\r\n    */\r\n    refreshActions: function (actions) {\r\n        var self = this;\r\n        self.actionController.refreshActions(actions);\r\n    },\r\n    /*\r\n    *   Re-binds pending actions that could not be set because the renders did not exist when the form loaded\r\n    */\r\n    removeActions: function () {\r\n        var self = this;\r\n        self.actionController.unbindActions();\r\n    },\r\n    /*\r\n    *   Iterate through all renders and collect the data to send, then update original values for each render\r\n    */\r\n    collectRenderValuesForSubmit: function (data) {\r\n        var self = this;\r\n        data = data || {};\r\n\r\n        // Collect data\r\n        self.collectRenderValues(data);\r\n\r\n        // Mark data collected as original values\r\n        $.each(data, function (key, value) {\r\n            var renders = self.getRenders(key);\r\n            $.each(renders, function (i, render) {\r\n                render.updateOriginalValue();\r\n            });\r\n        });\r\n\r\n        return data;\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param params {data, bRefreshForm,properties}\r\n     * @returns {*}\r\n     */\r\n    internalSubmitOnChange: function (params) {\r\n        params = params || {};\r\n        var self = this, idCase;\r\n        var properties = params.properties;\r\n        // var form = self.getFormContainer();\r\n        var defer = new $.Deferred();\r\n        var data = params.data || {};\r\n        var bRefreshForm = typeof (params.bRefreshForm) != \"undefined\" ? params.bRefreshForm : true;\r\n        var notCollect = params.notCollect ? params.notCollect : undefined;\r\n\r\n        // Collect data\r\n        if (!(notCollect && !$.isEmptyObject(data))) {\r\n            self.collectRenderValuesForSubmit(data);\r\n        }\r\n        self.startLoading();\r\n\r\n        //idCase = self.getCacheIdCase();\r\n\r\n        var deferredsToWait = null;\r\n        if (data.deferreds) {\r\n            deferredsToWait = $.when.apply($, data.deferreds);\r\n            delete data.deferreds;\r\n        }\r\n\r\n        $.when(deferredsToWait).then(function () {\r\n            // Submit the form\r\n            self.dataService.submitData({\r\n                action: \"SUBMITONCHANGE\",\r\n                data: data,\r\n                idRender: properties.id,\r\n                xpath: properties.xpath,\r\n                xpathContext: self.properties.xpathContext,\r\n                idPageCache: properties.idPageCache,\r\n                contexttype: properties.contexttype\r\n            }).done(function (response) {\r\n                // Cancel previous multiactions and process property value\r\n                self.cancelPreviousRequest();\r\n                // After successfully response refresh the form\r\n                self.endLoading();\r\n                // If response message has error in validation, do not refresh the form\r\n                // and show validation message\r\n                if (response && response.type == \"validationMessages\") {\r\n                    if (typeof self.clearValidationMessages == \"function\") {\r\n                        self.clearValidationMessages();\r\n                    }\r\n\r\n                    self.addValidationMessage(response.messages);\r\n                    defer.resolve();\r\n                } else if (bRefreshForm) {\r\n                    var focusIdentifier = {\r\n                        id: properties.id,\r\n                        xpath: properties.xpath\r\n                    };\r\n                    if (properties.idCase !== undefined) {\r\n                        $.extend(focusIdentifier, {\r\n                            idCaseObject: bizagi.cache.idCaseObject\r\n                        });\r\n                    }\r\n                    if (response.IdScope) {\r\n                        self.properties.idStartScope = response.IdScope;\r\n                    }\r\n                    $.when(self.refreshForm(focusIdentifier)).done(function () {\r\n                        defer.resolve();\r\n                    }).fail(function () {\r\n                        defer.resolve();\r\n                    });\r\n                } else {\r\n                    defer.resolve();\r\n                }\r\n            }).fail(function (message) {\r\n                self.endLoading();\r\n                var objMessage = JSON.parse((typeof message == 'object' && message.responseText) ? message.responseText : {}) || {};\r\n                var strMessage = objMessage.message || message;\r\n                // Clear previous validations\r\n                self.validationController.clearValidationMessages();\r\n                if (objMessage.type == \"alert\") {\r\n                    self.validationController.showAlertMessage(strMessage);\r\n                } else {\r\n                    self.validationController.showErrorMessage(strMessage);\r\n                }\r\n                defer.resolve();\r\n            });\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    cancelPreviousRequest: function () {\r\n        if (bizagi.multiactionConnection && bizagi.multiactionConnection.length) {\r\n            var length = bizagi.multiactionConnection.length;\r\n            var i = 0, connection;\r\n            for (; i < length; i++) {\r\n                connection = bizagi.multiactionConnection.pop();\r\n                if (connection && connection.abort) {\r\n                    bizagi.showErrorAlertDialog = false;\r\n                    connection.abort();\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    prepareCheckpointAction: function (buttonId) {\r\n        var self = this;\r\n\r\n        var checkpointAction = self.dataService.sendCheckpoint({\r\n            url: self.properties.checkpointUrl,\r\n            idRender: buttonId,\r\n            xpath: \"\",\r\n            xpathContext: self.properties.xpathContext,\r\n            idPageCache: self.properties.idPageCache,\r\n            prepare: true\r\n        });\r\n\r\n        checkpointAction.tag = \"checkpoint\";\r\n\r\n        return checkpointAction;\r\n    },\r\n\r\n    prepareCommitAction: function (buttonId) {\r\n        var self = this;\r\n\r\n        var commitAction = self.dataService.commitLinkForm({\r\n            url: self.properties.commitUrl,\r\n            idRender: buttonId,\r\n            xpath: \"\",\r\n            xpathContext: self.properties.xpathContext,\r\n            idPageCache: self.properties.idPageCache,\r\n            prepare: true\r\n        });\r\n\r\n        commitAction.tag = \"commit\";\r\n\r\n        return commitAction;\r\n    },\r\n\r\n    sendRollbackAction: function (buttonId) {\r\n        var self = this;\r\n\r\n        self.dataService.rollbackLinkForm({\r\n            url: self.properties.rollbackUrl,\r\n            idRender: buttonId,\r\n            xpath: \"\",\r\n            xpathContext: self.properties.xpathContext,\r\n            idPageCache: self.properties.idPageCache\r\n        });\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n        self.endLoading();\r\n\r\n        setTimeout(function () {\r\n            if (self.params) {\r\n                delete self.params.canvas;\r\n            }\r\n            delete self.params;\r\n            delete self.control;\r\n            if (self.validationController) {\r\n                self.unbind(\"rendervalidate\");\r\n                delete self.validationController;\r\n            }\r\n\r\n            if (self.actionController) {\r\n                self.actionController.unbindActions();\r\n                delete self.actionController;\r\n            }\r\n        }, bizagi.override.disposeTime || 50);\r\n\r\n        // Call base\r\n        self._super();\r\n    },\r\n    getButton: function (guid) {\r\n        return $(\".ui-bizagi-button[data-id='\" + guid + \"']\", this.container);\r\n    },\r\n\r\n    getFloatingButton: function (guid) {\r\n        return $(\"li[data-id='\" + guid + \"']\", this.container);\r\n    },\r\n\r\n    propagateExternalEvents: function (evt) {\r\n        // Menu-Overflow\r\n        var $menuOverflow = $(\".bz-overflow-menu\");\r\n        if ($menuOverflow)\r\n            $(document).trigger('click.overflow');\r\n\r\n        // ECM with preview image\r\n        var zoomIsOpen = $(\".jquery-image-zoom\") && $(\".jquery-image-zoom\").css(\"display\") == \"block\";\r\n\r\n        if (zoomIsOpen)\r\n            $(\"div.jquery-image-zoom a\").click();\r\n    },\r\n\r\n    getButtonAction: function (action) {\r\n        return this.allowValidateAndSaveAction && action === \"validate\" ? \"save\" : action;\r\n    }\r\n\r\n});\r\n","/**\r\n * Render a new type of form called template\r\n *\r\n * @author Edward Morales\r\n */\r\n$.Class.extend(\"bizagi.rendering.formTemplate\", {\r\n\r\n    /**\r\n     *   Constructor\r\n     */\r\n    init: function (params) {\r\n        this._super(params);\r\n        if(params.paramsRender && params.paramsRender.contextEvent){\r\n            self.contextEvent = params.paramsRender.contextEvent;\r\n        }\r\n    },\r\n\r\n\t/**\r\n\t * Process controls on template\r\n\t * @param template\r\n\t * @param controls\r\n\t * @return {*}\r\n\t */\r\n\tprocessTemplate: function(template, controls) {\r\n\t    var regexControl = /\\{\\{([\\w:]*)\\s*(\\{[\"':,-\\[\\]\\w\\s]*\\})\\}\\}/g;\r\n\t\tvar regexRepeater = /\\{\\{(((repeater)\\s*(\\{[\"':,-\\[\\]\\w\\s]*\\}))|([\\/repeater]+:item)|(\\/repeater)|(repeater)|(separator))\\}\\}/g;\r\n\r\n\t\t// Remove all repeaters key words\r\n\t\tvar processedTemplate = template.replace(regexRepeater, \"\");\r\n\r\n\t\t// replace controls\r\n\t\tprocessedTemplate = processedTemplate.replace(regexControl, function(match, g1, g2, offset, string) {\r\n\t\t    var parameters = JSON.parse(g2);\r\n            \r\n\t\t\treturn controls[parameters.id] || '';\r\n\t\t});\r\n\r\n\t    processedTemplate = processedTemplate.replace(/{{([\\w:]*)\\s*}}/g, function() {\r\n\t        return '';\r\n\t    });\r\n\r\n\r\n\t\treturn processedTemplate;\r\n\t},\r\n\r\n\t/**\r\n\t * Render layout container\r\n\t * @return {*}\r\n\t */\r\n\trenderContainer: function() {\r\n\t\tvar self = this;\r\n\t\tvar layoutCollection = self.getRenderByType(\"layout\");\r\n\t\tvar layout = (layoutCollection.length > 0) ? layoutCollection[0] : {};\r\n\t\tvar template = (typeof layout.getTemplate == \"function\") ? layout.getTemplate() : \"\";\r\n\t\tvar css = (typeof layout.getCss == \"function\") ? layout.getCss() : \"\";\r\n\t\tvar mode = self.getMode();\r\n\t\tvar layoutGuid = self.properties.layoutguid || Math.guid();\r\n\r\n\t\tvar controls = {};\r\n\r\n\t\t/**\r\n\t\t * Render all elements within first layout container\r\n\t\t */\r\n\t\tif(layout.children) {\r\n\t\t\t$.each(layout.children, function(i, child) {\r\n\t\t\t    // ignore layoutPlaceholder control in execution\r\n\t\t\t    if (!(mode == 'execution' && child.properties.type == 'layoutPlaceholder')) {\r\n\r\n\t\t\t        var type = child.getElementType();\r\n\t\t\t        if (type == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n\t\t\t            controls[child.properties.id] = child.renderElement();\r\n\t\t\t        }\r\n\t\t\t        if (type == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n\t\t\t            controls[child.properties.id] = child.renderContainerHtml();\r\n\t\t\t        }\r\n\t\t\t        self.childrenHash[child.properties.uniqueId] = child;\r\n\t\t\t    }\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t// Load css\r\n\t\tbizagi.util.loadStyle(css, layoutGuid);\r\n\r\n\t\treturn self.processTemplate(template, controls);\r\n\t},\r\n\r\n    /**\r\n     * Get the context in which loads the formTemplate\r\n     *\r\n     */\r\n    getContextEvent: function(){\r\n        return self.contextEvent;\r\n    }\r\n});\r\n","$.Class.extend(\"bizagi.rendering.layout\", {}, {\r\n\r\n\t/**\r\n\t * Get html template\r\n\t * @return {*}\r\n\t */\r\n\tgetTemplate: function() {\r\n\t    var self = this;\r\n\t    var mode = self.getMode();\r\n\t    var html = self.properties.html || \"\";\r\n\r\n        // Add a container, this is important in design to calculate the scroll \r\n\t    if (mode == 'design' && html) {\r\n            html = \"<div class='bz-design-template'>\" + html + \"</div>\"\r\n\t    }\r\n\t\t\r\n\t\treturn bizagi.util.stripslashes(html);\r\n\t},\r\n\r\n\t/**\r\n\t * Get string css of layout container\r\n\t * @return {*}\r\n\t */\r\n\tgetCss: function() {\r\n\t    var self = this;\r\n\t\tvar css = self.properties.css || \"\";\r\n\r\n\t\tvar mode = self.getMode();\r\n\t\tif (mode == \"design\") {\r\n\t\t    css = css && css.desktop;\r\n\t\t}\r\n\r\n\t\treturn bizagi.util.stripslashes(css);\r\n\t},\r\n\r\n\r\n\t/*\r\n\t *   Template method to process each jquery object\r\n\t *   must be overriden in each container\r\n\t */\r\n\tpostRenderContainer: function(container) {\r\n\t\tvar self = this;\r\n\t\tvar mode = self.getMode();\r\n\r\n\t\t// Resolve rendering deferred\r\n\t\tif(self.renderingDeferred)\r\n\t\t\tself.renderingDeferred.resolve();\r\n\r\n\t\t// Process children elements\r\n\t\tself.container = container;\r\n\t\tself.executeChildrenPostRender(container);\r\n\r\n\t\tif(mode == \"execution\") {\r\n\t\t\t// Apply handlers\r\n\t\t\tself.configureHandlers();\r\n\t\t}\r\n\t\tif(mode == \"design\") {\r\n\t\t\t// Configure view\r\n\t\t\tself.configureDesignView();\r\n\t\t}\r\n\t\tif(mode == \"layout\") {\r\n\t\t\t// Configure view\r\n\t\t\tself.configureDesignView();\r\n\t\t\tself.configureLayoutView();\r\n\t\t}\r\n\t}\r\n});","/*\r\n*   Name: BizAgi Accordion Container Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a accordion container class for all devices\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.accordion\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    initializeData: function (params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Enumerate the children appending a property\r\n        $.each(self.children, function (i, child) {\r\n            child.properties.ordinal = i;\r\n        });\r\n    },\r\n\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"accordion\");\r\n\r\n        // Render the accordion\r\n        var html = $.fasttmpl(template, {\r\n            uniqueId: properties.uniqueId\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Accordion Item Container Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a accordion item class for all devices\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.accordionItem\", {}, {\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"accordionItem\");\r\n\r\n        // Render the accordionItem\r\n        var html = $.fasttmpl(template, {\r\n            id: properties.id,\r\n            ordinal: properties.ordinal,\r\n            displayName: properties.displayName,\r\n            orientation: properties.orientation,\r\n            uniqueId: properties.uniqueId\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    *   Fires when the accordionItem is selected \r\n    */\r\n    activate: function () {\r\n        var self = this;\r\n        self.active = true;\r\n    },\r\n\r\n    /*  \r\n    *   Return the current focuses container\r\n    */\r\n    getFocus: function () {\r\n        var self = this;\r\n        var focus = self._super();\r\n        if (bizagi.util.isEmpty(focus) && self.active) {\r\n            focus = self.properties.id;\r\n        }\r\n\r\n        return focus;\r\n    }\r\n\r\n\r\n});\r\n\r\n","/*\r\n*   Name: Bizagi Render CollectionNavigator\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will define basic stuff for collection navigator renders\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.collectionnavigator\", {}, {\r\n\r\n    initializeData: function (params) {\r\n        var self = this;\r\n\r\n        self._super(params);\r\n\r\n        var properties = self.properties;\r\n        properties.allowAdd = (typeof properties.allowAdd != \"undefined\") ? bizagi.util.parseBoolean(properties.allowAdd) : true;\r\n        properties.withAddForm = properties.withAddForm && properties.allowAdd;\r\n        properties.allowEdit = (typeof properties.allowEdit != \"undefined\") ? bizagi.util.parseBoolean(properties.allowEdit) : true;\r\n        properties.withEditForm = properties.withEditForm && properties.allowEdit;\r\n        properties.allowDetail = (typeof properties.allowDetail != \"undefined\") ? bizagi.util.parseBoolean(properties.allowDetail) : false;\r\n        properties.inlineAdd = (typeof properties.inlineAdd != \"undefined\") ? bizagi.util.parseBoolean(properties.inlineAdd) : true;\r\n        properties.inlineAdd = properties.inlineAdd && properties.allowAdd;\r\n        properties.inlineEdit = (typeof properties.inlineEdit != \"undefined\") ? bizagi.util.parseBoolean(properties.inlineEdit) : true;\r\n        properties.inlineEdit = properties.inlineEdit && properties.allowEdit;\r\n        properties.allowDelete = (typeof properties.allowDelete != \"undefined\") ? bizagi.util.parseBoolean(properties.allowDelete) : true;\r\n\r\n        self.orientation = self.properties.orientation || \"ltr\",\r\n        self.data = self.properties.data;\r\n        self.keys = self.data ? self.getKeys(self.data.rows) : [];\r\n        self.pointer = 0;\r\n        self.totalRows = 0;\r\n        self.inlineAddRecords = [];\r\n\r\n        if (self.data) {\r\n            self.totalRows = self.data.rows.length;\r\n        }\r\n    },\r\n    /*\r\n    * Normalize keys\r\n    */\r\n    getKeys: function (rows) {\r\n        rows = rows || [];\r\n        var keys = [];\r\n\r\n        for (var i = 0, l = rows.length; i < l; i++) {\r\n            var row = rows[i];\r\n            keys.push(row[0]);\r\n        }\r\n        return keys;\r\n    },\r\n\r\n    /*\r\n    *   Render the control\r\n    */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var templateItem = \"collectionnavigator\";\r\n        var template = self.renderFactory.getTemplate(templateItem);\r\n        var mode = self.getMode();\r\n\r\n        // Render the container\r\n        var html = $.fasttmpl(template, {\r\n            uniqueId: properties.uniqueId,\r\n            displayName: properties.displayName ? properties.displayName : \"\",\r\n            id: properties.id,\r\n            guid: properties.guid,\r\n            showPreview: self.showPreview(),\r\n            mode: mode,\r\n            orientation: self.getFormContainer().properties.orientation\r\n        });\r\n\r\n        html = self.drawControls(html);\r\n\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    * Render version readonly of control\r\n    */\r\n    renderReadOnly: function () {        \r\n        return this.renderControl();\r\n    },\r\n\r\n    /*\r\n    * Draw navigation controls\r\n    */\r\n    drawControls: function (html) {\r\n\r\n    },\r\n\r\n    /*\r\n    *  render several actions in the navigation palete\r\n    *  ex. save, cancel \r\n    */\r\n    drawActions: function (controls) {\r\n\r\n    },\r\n\r\n    /*\r\n    * Render navigation controls (next, previous, last, first. etc )\r\n    */\r\n    drawControl: function (controls) {\r\n\r\n    },\r\n\r\n    /*\r\n    * Draw forms options (add form, edit form, navigation form)\r\n    */\r\n    drawForms: function (controls) {\r\n\r\n    },\r\n\r\n    /*\r\n    * Draw a preview views, it will be show when the collection hasn't records\r\n    */\r\n    drawPreview: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var templateItem = (mode === \"execution\") ? \"collectionnavigator-execution\" : \"collectionnavigator-preview\";\r\n        var template = self.renderFactory.getTemplate(templateItem);\r\n        var html = $.tmpl(template);\r\n\r\n        self.canvas.append(html);\r\n\r\n    },\r\n\r\n    /*\r\n    * Returns true if the collection has data\r\n    */\r\n    hasData: function () {        \r\n        return this.getTotalRows() > 0;\r\n    },\r\n\r\n    /*\r\n    * Returns the key of current row\r\n    */\r\n    getRow: function () {        \r\n        return this.keys[this.pointer];\r\n    },\r\n\r\n    /*\r\n    * Returns the key of next row\r\n    */\r\n    getNextRow: function () {\r\n        var self = this;\r\n\r\n        if (self.getTotalRows() > (self.pointer + 1))\r\n            self.pointer += 1;\r\n\r\n        return self.getRow();\r\n    },\r\n\r\n    /*\r\n    * Returns the key of previous row\r\n    */\r\n    getPreviousRow: function() {\r\n        var self = this;\r\n\r\n        if (self.pointer > 0)\r\n            self.pointer -= 1;\r\n\r\n        return self.getRow();\r\n    },\r\n\r\n    /*\r\n    * Returns the key of first row\r\n    */\r\n    getFirstRow: function () {\r\n        var self = this;\r\n\r\n        self.pointer = 0;\r\n        return self.getRow();\r\n    },\r\n\r\n    /*\r\n    * Returns the key of last row\r\n    */\r\n    getLastRow: function () {\r\n        var self = this;\r\n\r\n        self.pointer = self.keys.length - 1;\r\n        return self.getRow();\r\n    },\r\n\r\n    /*\r\n    * Returns the total numbers of rows in collection\r\n    */\r\n    getTotalRows: function () {        \r\n        return this.keys.length;\r\n    },\r\n\r\n    getIndexes: function () {        \r\n        return this.properties.data.rows;\r\n    },\r\n\r\n    /*\r\n    * Sets the pointer to a specific position\r\n    */\r\n    setPointer: function (index) {        \r\n        this.pointer = index - 1;\r\n    },\r\n\r\n    /*\r\n    * Returns true is there is a inline row pending to save\r\n    */\r\n    isTherePendingInlineRow: function() {\r\n        return this.inlineAddRecords.length > 0;\r\n    },\r\n\r\n    /*\r\n    * Adds new row to collection\r\n    */\r\n    addKey: function (newId) {        \r\n        this.keys.push(newId);\r\n    },\r\n\r\n    /*\r\n    * Removes row in collection\r\n    */\r\n    removeKey: function () {\r\n        var self = this;\r\n        var index = self.pointer;\r\n\r\n        if (index >= 0) {\r\n            self.keys.splice(index, 1);\r\n\r\n            var totalRows = self.getTotalRows();\r\n            if (totalRows > 0 && index >= totalRows) {\r\n                self.setPointer(totalRows);\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Returns true if the control should show the preview view\r\n    * ex. if the collection is empty \r\n    */\r\n    showPreview: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var properties = self.properties;\r\n\r\n        if (mode == \"execution\") {\r\n            return !self.hasData();\r\n        } else {\r\n            return !bizagi.util.parseBoolean(properties.navigationform);\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Returns the parameters needed for the request\r\n    */\r\n    getParameters: function (params) {\r\n        var self = this;\r\n\r\n        var parameters = {};\r\n        var properties = self.properties;\r\n        var recordXpath = properties.xpath + \"[id=\" + params.id + \"]\";\r\n\r\n        parameters.idRender = properties.id;\r\n        parameters.recordXPath = recordXpath;\r\n        parameters.xpathContext = properties.xpathContext;\r\n        parameters.idPageCache = properties.idPageCache;\r\n        parameters.requestedForm = params.requestedForm;\r\n        parameters.contextType = properties.contextType || properties.contexttype;\r\n        parameters.url = params.url;\r\n        parameters.editable = params.editable;\r\n        orientation: properties.orientation || \"ltr\";\r\n\r\n\r\n        return parameters;\r\n    },\r\n\r\n    /*\r\n    *   Submits a collection navigator add record request\r\n    *   Returns a deferred when done, the server returns an id for the new record\r\n    */\r\n    submitAddRequest: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var request = self.dataService.addGridRecord({\r\n            url: properties.addUrl,\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contextType || properties.contexttype,\r\n            idPageCache: properties.idPageCache,\r\n            orientation: properties.orientation || \"ltr\"\r\n        });\r\n\r\n        var filterResponse = request.pipe(function (data) {\r\n            // Parses response\r\n            return data.idEntity;\r\n        });\r\n\r\n        return filterResponse.promise();\r\n    },\r\n\r\n    /*\r\n    *   Submits a edit record request for the given id \r\n    *   Returns a deferred\r\n    */\r\n    submitEditRequest: function (id) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpath = properties.xpath + \"[id=\" + id + \"]\";\r\n\r\n        return self.dataService.editGridRecord({\r\n            url: properties.editUrl,\r\n            idRender: properties.id,\r\n            xpath: xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            contexttype: properties.contextType || properties.contexttype || '',\r\n            orientation: properties.orientation || \"ltr\"\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Submits a collection delete record request for the given id \r\n    *   Returns a deferred\r\n    */\r\n    submitDeleteRequest: function (id) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpath = properties.xpath + \"[id=\" + id + \"]\";\r\n\r\n        return self.dataService.deleteGridRecord({\r\n            url: properties.deleteUrl,\r\n            idRender: properties.id,\r\n            xpath: xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            contexttype: properties.contextType || properties.contexttype\r\n        }).pipe(function (data) {\r\n            if (data.type == \"validationMessages\") {\r\n                var form = self.getFormContainer();\r\n                var message = data.messages.join(\" \");\r\n                form.failHandler({ message: message });\r\n            }\r\n\r\n            return data;\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Submits a collection navigator edit record request for the given id \r\n    *   Returns a deferred\r\n    */\r\n    submitSaveRequest: function (id, data) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = $.Deferred();\r\n\r\n        // Calculate xpath context\r\n        var xpathContext = properties.xpathContext.length > 0 ? properties.xpathContext + \".\" + properties.xpath + \"[id=\" + id + \"]\" : properties.xpath + \"[id=\" + id + \"]\";\r\n\r\n        var deferredsToWait = null;\r\n        if (data.deferreds) {\r\n            deferredsToWait = $.when.apply($, data.deferreds);\r\n            delete data.deferreds;\r\n        }\r\n\r\n        $.when(deferredsToWait).then(function() {\r\n\r\n            self.dataService.saveGridRecord({\r\n                url: properties.saveUrl,\r\n                idRender: properties.id,\r\n                xpath: properties.xpath,\r\n                xpathContext: xpathContext,\r\n                contexttype: properties.contextType || properties.contexttype || \"\",\r\n                submitData: data\r\n            }).done(function(response) {\r\n                defer.resolve(response);\r\n            }).fail(function (dataFail) {\r\n                var form = self.getFormContainer();\r\n                var message = (dataFail.responseText) ? dataFail.responseText : ((typeof dataFail == \"string\") ? dataFail : dataFail.toString());\r\n                //Convert String to object\r\n                if (typeof message == \"string\") {\r\n                    try {\r\n                        message = JSON.parse(message).message;\r\n                    } catch (e) {\r\n                        message = message.match(/\"message\":(.*)\",/)[0];\r\n                        message = message.substr(11, message.length - 13);\r\n                    }\r\n    \r\n                } else if (!message.message) {\r\n                    message = dataFail;\r\n                }\r\n                form.validateForm();\r\n                form.clearValidationMessages();\r\n                form.addValidationMessage(message);\r\n            });\r\n\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n    *   Submits a collection navigator rollback request\r\n    *   Returns a deferred when done\r\n    */\r\n    submitRollbackRequest: function (error) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return self.dataService.rollbackGridAction({\r\n            url: properties.rollbackUrl,\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: error.idPageCache,\r\n            contexttype: self.properties.contexttype || \"\"\r\n        });\r\n    },\r\n    /*\r\n    *   Fetch the data into a deferred\r\n    */\r\n    getRemoteData: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set params\r\n        params = params || {};\r\n        $.extend(params, {\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contextType || properties.contexttype,\r\n            idPageCache: properties.idPageCache\r\n\r\n        });\r\n\r\n        return self.dataService.getData(params);\r\n    },\r\n\r\n    isValid: function (invalidElements) {\r\n        var form = this.form;\r\n\r\n        if (typeof (form) !== \"undefined\") {\r\n            (form.children || []).forEach(function (child) {\r\n                if (child.properties.visible) {\r\n                    if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\r\n                        // Go though container\r\n                        child.isValid(invalidElements);\r\n\r\n                    } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\r\n                        // Go to the render\r\n                        if (!child.isValid(invalidElements)) {\r\n                            var content = invalidElements[invalidElements.length - 1];\r\n                            invalidElements[invalidElements.length - 1] = $.extend(content, {\r\n                                id: child.properties.id\r\n                            });\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        return invalidElements.length === 0;\r\n    },\r\n\r\n    validateControls: function(invalidElements) {\r\n        if (!this.form) return false;\r\n        return this.form.validationController.performValidations(invalidElements);\r\n    }\r\n\r\n});","/*\r\n*   Name: Bizagi Group Container Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a group container class for all devices\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.group\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    initializeData: function (params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(params);\r\n\r\n        // Default properties\r\n        var properties = self.properties;\r\n\r\n        properties.helpText = properties.helpText || properties.displayName;\r\n\r\n        // Extend css property \r\n        properties.cssclass = properties.cssclass || \"cssClassContainer\";\r\n\r\n        properties.collapse = (typeof properties.collapse != \"undefined\" && bizagi.util.parseBoolean(properties.collapse)) ? true : false;\r\n    },\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"group\");\r\n\r\n        // Define icons\r\n        self.expandedIcon = self.getExpandedIcon();\r\n        self.collapsedIcon = self.getCollapsedIcon();\r\n\r\n        // Render the panel\r\n        var html = $.fasttmpl(template, {\r\n            expandedClassIcon: self.expandedIcon,\r\n            displayName: properties.displayName,\r\n            editable: properties.editable,\r\n            orientation: properties.orientation,\r\n            uniqueId: properties.uniqueId,\r\n            collapse: properties.collapse,\r\n            isDesign: (self.getMode() !== \"execution\"),            \r\n            messageValidation: properties.messageValidation,\r\n            cssclass: properties.cssclass,\r\n            guid: properties.guid\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    *   Returns the expanded icon\r\n    */\r\n    getExpandedIcon: function () { },\r\n\r\n    /*\r\n    *   Returns the collapsed icon\r\n    */\r\n    getCollapsedIcon: function () { },\r\n\r\n    /* \r\n    *   Expands or collapse the container \r\n    */\r\n    toogleContainer: function (argument, bImmediate) { }\r\n\r\n});","/*\r\n*   Name: BizAgi Horizontal Container Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a tab item class for all devices\r\n*/\r\n\r\n\r\n$.Class.extend(\"bizagi.rendering.horizontal\", {}, {\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"horizontal\");\r\n\r\n        // Render the container\r\n        var html = $.fasttmpl(template, {\r\n            uniqueId: properties.uniqueId\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: Bizagi Panel Container Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a panel container class for all devices\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.panel\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    initializeData: function(params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(params);\r\n\r\n        // Override properties\r\n        var properties = self.properties;\r\n        properties.displayName = properties.displayName || \"\";\r\n    },\r\n\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function() {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"panel\");\r\n\r\n        // Render the panel\r\n        var html = $.fasttmpl(template, {\r\n            displayName: properties.displayName,\r\n            loading: properties.loading,\r\n            message: properties.message,\r\n            orientation: properties.orientation,\r\n            uniqueId: properties.uniqueId,\r\n            cssClass: properties.cssclass\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    *   Process the html rendering object\r\n    */\r\n    postRenderContainer: function(panel) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set height\r\n        if (properties.height) {\r\n            panel.height(properties.height);\r\n        }\r\n\r\n        // Call base\r\n        self._super(panel);\r\n    }\r\n\r\n});","/*\r\n*   Name: Bizagi Panel Container Class\r\n*   Author: David Romero\r\n*   Comments:\r\n*   -   This script will define a panel container class for all devices\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.contentPanel\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    initializeData: function (params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(params);\r\n\r\n        // Override properties\r\n        var properties = self.properties;\r\n        properties.displayName = properties.displayName || \"\";\r\n    },\r\n\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"contentPanel\");\r\n\r\n        // Render the panel\r\n        var html = $.fasttmpl(template, {\r\n            displayName: properties.displayName,\r\n            mode: self.getMode(),\r\n            uniqueId: properties.uniqueId,\r\n            isDesign: self.getMode() === \"design\",\r\n            messageValidation: properties.messageValidation,\r\n            cssClass: properties.cssclass,\r\n            guid: properties.guid\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    *   Process the html rendering object\r\n    */\r\n    postRenderContainer: function (panel) {\r\n        // Call base\r\n        this._super(panel);\r\n    }\r\n\r\n});","/*\r\n*   Name: BizAgi Panel Container Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a panel container class for all devices\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.searchForm\", {}, {\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"searchForm\");\r\n\r\n\r\n        if (properties.contexttype != \"entity\" && self.parent) {\r\n            properties.contexttype = (typeof self.parent.getContextType == 'function') ? self.parent.getContextType() : \"\";\r\n        } \r\n\r\n        // Render the panel\r\n        var html = $.fasttmpl(template, {\r\n            displayName: properties.displayName,\r\n            uniqueId: properties.uniqueId\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n\r\n        // Render result\r\n        html = html.replace(\"{{result}}\", self.renderResult());\r\n\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    *   Perform a search and render the results\r\n    */\r\n    performSearch: function (searchParams) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set parameter to search\r\n        properties.searchParams = searchParams;\r\n\r\n        // Submit the search to the server\r\n        self.submitSearch();\r\n    },\r\n\r\n    /*\r\n    *   Submits the query to the server\r\n    */\r\n    submitSearch: function () {\r\n        var self = this;\r\n\r\n        // Makes the results to update its contents\r\n        self.refreshResults();\r\n    },\r\n\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready\r\n    */\r\n    ready: function () {\r\n        var self = this;\r\n        return self.parent.ready();\r\n    },\r\n\r\n    /*\r\n    *   Method to fill the result data\r\n    *   (THIS IS CALLED WITHIN GRID RENDER SCOPE)\r\n    */\r\n    getRemoteData: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n\r\n        // Collect data\r\n        var data = self.collectSearchValues();\r\n\r\n        if (bizagi.util.isMapEmpty(data)) {\r\n            bizagi.showMessageBox(this.getResource(\"render-search-advanced-no-filters\"), this.getResource(\"render-form-dialog-box-search\"), \"error\");\r\n            return null;\r\n        }\r\n\r\n        params.rows = (properties.searchParams && properties.searchParams.maxRecords && properties.searchParams.maxRecords > 0) ? properties.searchParams.maxRecords : params.rows;\r\n\r\n        // The Grid only support one row per page in smartphone (DRAGON-41733 / QAF-3916)         \r\n        if (properties.searchParams && typeof(properties.searchParams.maxRows) !== \"undefined\") {\r\n            params.rows = properties.searchParams.maxRows || params.rows;\r\n        }\r\n\r\n        // Resolve with remote data\r\n        self.dataService.submitSearch($.extend(params, {\r\n            url: properties.dataUrl,\r\n            idRender: properties.idRender,\r\n            idPageCache: properties.idPageCache,\r\n            idSearchForm: properties.id,\r\n            allowFullSearch: (properties.searchParams.allowFullSearch ? properties.searchParams.allowFullSearch : null),\r\n            maxRecords: (properties.searchParams.maxRecords > 0 ? properties.searchParams.maxRecords : null),\r\n            criteria: data\r\n\r\n        })).done(function (response) {\r\n\r\n            // Resolve with fetched data    \r\n            properties.page = response.page;\r\n            properties.records = response.records;\r\n            properties.totalPages = response.totalPages || 0;\r\n\r\n            //In tablets are allowed about 10000 records as maximum\r\n            if (response.records > 10000) {\r\n                properties.deviceMaxRecordsExceeded = true;\r\n                response.deviceMaxRecordsExceeded = true;\r\n            } else {\r\n                delete properties.deviceMaxRecordsExceeded;\r\n            }\r\n            \r\n            defer.resolve(response);\r\n\r\n            // Call virtual method\r\n            self.onSearchFinished();\r\n        }).fail(function (errorObject) {\r\n            bizagi.showErrorAlertDialog = false;\r\n            if (errorObject.responseText) {\r\n                try {\r\n                    var message = JSON.parse(errorObject.responseText).message;\r\n                    bizagi.showMessageBox(message, \"\", \"error\");\r\n                } catch (e) { }\r\n            }\r\n            defer.reject();\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n    *   Iterate through all the renders in the container and fills the hashtable\r\n    *   - Overriden because server needs this in array\r\n    */\r\n    collectSearchValues: function () {\r\n        var self = this;\r\n\r\n        // Collect data\r\n        var data = {};\r\n        this.collectRenderValues(data);\r\n\r\n        // Changes to array\r\n        var submitArray = [];\r\n        for (key in data) {\r\n            var xpath = key;\r\n            var value = data[key];\r\n            var operation = self.getCriteriaOperation(self.getRender(xpath));\r\n            var criteriaData = {};\r\n            if (!bizagi.util.isEmpty(value)) {\r\n                criteriaData[\"xpath\"] = xpath;\r\n                criteriaData[\"value\"] = value;\r\n                criteriaData[\"operation\"] = operation;\r\n                submitArray.push(criteriaData);\r\n            }\r\n        }\r\n\r\n        return submitArray;\r\n    },\r\n\r\n    /*\r\n    *   This method find out the criterial operation to be executed according to\r\n    *   data type. Text renders use LIKE operation, but other data types such like\r\n    *   numerics use exact match operatiors\r\n    */\r\n    getCriteriaOperation: function (render) {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        var operation = \"EQUALS\";\r\n        if (render.properties.dataType == \"15\") {\r\n            if (typeof render.properties.typeSearch === \"undefined\" || render.properties.typeSearch === \"approx\"){\r\n                if (properties.allowFullSearch) {\r\n                    operation = \"FULLLIKE\";\r\n                }\r\n                else {\r\n                    operation = \"LIKE\";\r\n                }\r\n            }\r\n        }\r\n        return operation;\r\n    },\r\n\r\n    /*\r\n    *   Render the result controls for the query\r\n    *   Resolved in each device\r\n    */\r\n    renderResult: function () { },\r\n\r\n    /*\r\n    *   Refresh the result panel, making it to query data with current criteria\r\n    */\r\n    refreshResults: function () { },\r\n\r\n    /*\r\n    *   Function to parse the dataType\r\n    */\r\n    parseAdditionalProperties: function (dataType) {\r\n\r\n        // Number\r\n        if (dataType == 1 || dataType == 2 || dataType == 3 ||\r\n            dataType == 4 || dataType == 6 || dataType == 7 ||\r\n            dataType == 10 || dataType == 11 ) {\r\n\r\n            return { type: \"columnNumber\" };\r\n        }\r\n\r\n\r\n        // Oracle Number\r\n        if (dataType == 29) {\r\n\r\n            return { type: \"columnNumberScientificNotation\" };\r\n        }\r\n\r\n        // Money\r\n        if (dataType == 8) {\r\n\r\n            return { type: \"columnMoney\" };\r\n        }\r\n\r\n        // Date\r\n        if (dataType == 12 || dataType == 13) {\r\n\r\n            return { type: \"columnDate\" };\r\n        }\r\n\r\n        // Boolean\r\n        if (dataType == 5) {\r\n\r\n            return { type: \"columnBoolean\" };\r\n        }\r\n\r\n        // Text\r\n        return { type: \"columnText\" };\r\n    },\r\n\r\n    /*\r\n    *\r\n    */\r\n    onSearchFinished: function () {\r\n        // Empty function, overrided for Tablet version for now\r\n    }\r\n\r\n\r\n});\r\n\r\n","/*\r\n *   Name: BizAgi Tab Container Class\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define a tab container class for all devices\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.tab\", {}, {\r\n\r\n    /*\r\n     *   Constructor\r\n     */\r\n    initializeData: function(params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Default properties\r\n        var properties = self.properties;\r\n        properties.helpText = properties.helpText || properties.displayName;\r\n\r\n        // Extend css property\r\n        properties.cssclass = properties.cssclass || \"\";\r\n    },\r\n\r\n    /*\r\n     *   Render the container layout\r\n     */\r\n    renderContainer: function() {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var tabItems = $.map(self.children, function(child, key) {\r\n            child.properties.counter = key;\r\n            child.properties.tooltip =  child.properties.tooltip || child.properties.displayName || \"\";\r\n            return child.properties;\r\n        });\r\n        var template = self.renderFactory.getTemplate(\"tab\");\r\n        var mode = self.getMode();\r\n\r\n        // Render the tab\r\n        var html = $.fasttmpl(template, {\r\n            id: properties.id,\r\n            tabs: tabItems,\r\n            mode: mode,\r\n            isDesign: (self.getMode() !== \"execution\"),\r\n            editable: properties.editable,\r\n            tabOrientation: properties.orientation,\r\n            uniqueId: properties.uniqueId,\r\n            cssclass: properties.cssclass\r\n        });\r\n\r\n        // Get active container based on focus\r\n        var activeTab = self.activeTab = self.getActiveTab();\r\n\r\n        // Render children\r\n        for (var i = 0, length = self.children.length; i < length; i++) {\r\n            // Load on demand other tabs besides the first one\r\n            self.children[i].properties.loadOnDemand = (i != activeTab);\r\n        }\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    },\r\n\r\n    /*\r\n     *   Return the active tab containing the focus, or the first tab\r\n     */\r\n    getActiveTab: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var formParams = this.getFormContainer().getParams();\r\n        var mode = self.getMode();\r\n\r\n        if (mode === \"execution\") {\r\n            if (!formParams.isRefresh && properties.activeTab) {\r\n                self.getFormContainer().setFocusedElement(properties.activeTab);\r\n            }\r\n        }\r\n\r\n        var selectedTabs = formParams && formParams.selectedTabs ? formParams.selectedTabs : {};\r\n\r\n        // Fetch from selected tabs collection\r\n        if (selectedTabs[self.properties.id] >= 0) {\r\n            return selectedTabs[self.properties.id];\r\n        }\r\n\r\n        // Check for focused elements\r\n        for (var i = 0, length = self.children.length; i < length; i++) {\r\n            // Load on demand other tabs besides the first one\r\n            if (self.children[i].containsFocusedElement()) return i;\r\n        }\r\n        return 0;\r\n    },\r\n\r\n    /**\r\n     * Update position of tab\r\n     * @param index\r\n     */\r\n    setActiveTab: function (index) {\r\n        var self = this;\r\n\r\n        self.triggerHandler(\"selected\", { index: index, tab: self.children[index] });\r\n\r\n        if (self.children[index]) {\r\n            var form = self.getFormContainer();\r\n\r\n            self.children[index].activate();\r\n            self.activeTab = index;\r\n\r\n            var selectedTab = {};\r\n            selectedTab[self.children[index].parent.properties.id] = index;\r\n            form.setParam(\"selectedTabs\", selectedTab);\r\n        }\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Tab Item Container Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define a tab item class for all devices\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.tabItem\", {}, {\r\n\r\n    /*\r\n    *   Render the container layout\r\n    */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"tabItem\");\r\n\r\n        // Render the tabItem\r\n        var html = $.fasttmpl(template, {\r\n            id: properties.id,\r\n            uniqueId: properties.uniqueId,\r\n            counter: properties.counter,\r\n            isDesign: (self.getMode() !== \"execution\")\r\n        });\r\n\r\n        // Render content\r\n        html = self.renderTabContent(html);\r\n\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    * Renders the tab content\r\n    */\r\n    renderTabContent: function (html) {\r\n        // Render children\r\n        return this.replaceChildrenHtml(html, this.renderChildrenHtml());\r\n    },\r\n\r\n    /*\r\n    *   Fires when the tab is selected \r\n    */\r\n    activate: function () {\r\n        this.active = true;\r\n    },\r\n\r\n    /*  \r\n    *   Return the current focuses container\r\n    */\r\n    getFocus: function () {\r\n        var self = this;\r\n        var focus = self._super();\r\n        if (bizagi.util.isEmpty(focus) && self.active) {\r\n            focus = self.properties.id;\r\n        }\r\n\r\n        return focus;\r\n    },\r\n\r\n    /*\r\n    *   Return true if this tab contains the active focused element\r\n    */\r\n    containsFocusedElement: function () {\r\n        var self = this;\r\n        var focus = self.getFormContainer().getFocusedElement();\r\n\r\n        if (focus) {\r\n\r\n            // Locate element\r\n            if (focus.xpath) {\r\n                // Search by xpath and id\r\n                var elements = self.getFormContainer().getRenders(focus.xpath);\r\n                var element;\r\n\r\n                $.each(elements, function (i, item) {\r\n                    // Just select editable control\r\n                    if (item.properties.id == focus.id && item.properties.editable) {\r\n                        element = item;\r\n                    }\r\n                });\r\n            } else {\r\n                // Search just using id\r\n                var element = self.getFormContainer().getContainer(focus) || self.getFormContainer().getRenderById(focus);\r\n            }\r\n\r\n            // Search element parent\r\n            if (element) {\r\n                while (element.parent) {\r\n                    if (element.properties.id == self.properties.id || element.parent.properties.id == self.properties.id) return true;\r\n                    element = element.parent;\r\n                }\r\n            }\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n});\r\n\r\n","/*\r\n*   Name: BizAgi Nested Form Container Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a nested form container class for all devices\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.nestedForm\", {}, {\r\n\r\n});","/**\r\n * Base definition of Action Launcher and Entity template controls\r\n *\r\n * @author: Edward Morales\r\n */\r\n$.Class.extend(\"bizagi.rendering.actionLauncher\", {}, {\r\n\r\n    /*\r\n     * Initialize the control with data provided\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n        var form = self.getFormContainer();\r\n        this.typeForm = form.properties.typeForm || \"\";\r\n        var mode = self.getMode();\r\n        var properties = self.properties;\r\n\r\n        self.deferredActions = new $.Deferred();\r\n        self.deferredActions.promise();\r\n\r\n        if (mode == \"execution\") {\r\n            self.engine = new bizagi.templateEngine({\r\n                renderFactory: self.renderFactory,\r\n                cache: true,\r\n                autoGenerateData: false,\r\n                templateGuid: properties.selecttemplate\r\n            });\r\n        }\r\n\r\n        // Data of get process property value\r\n        self.processPropertyValueArgs = {\r\n            \"pcaseId\": self.getIdCase(),\r\n            \"pguidEntity\": self.properties.guidEntity,\r\n            \"idRender\": self.properties.id,\r\n            \"xpathContext\": form.properties.xpathContext,\r\n            \"idPageCache\": form.properties.idPageCache,\r\n            \"property\": \"data\",\r\n            \"psurrogatedKey\": self.properties.surrogatedKey,\r\n            \"ptags\": self.properties.tagslist || [],\r\n            \"pmaxitems\": self.properties.maxItems,\r\n            \"pactionXpath\": self.properties.xpathActions\r\n        };\r\n\r\n        self.processPropertyValueDataTmplArgs = {\r\n            \"pactionXpath\": self.properties.xpathActions,\r\n            \"idRender\": self.properties.id,\r\n            \"xpathContext\": form.properties.xpathContext,\r\n            \"idPageCache\": form.properties.idPageCache,\r\n            \"ptemplateGuid\": properties.selecttemplate,\r\n            \"property\": \"dataTemplate\",\r\n            \"xpathActions\": self.properties.xpathActions\r\n        };\r\n\r\n        self.properties.valueWidth = 100;\r\n        self.properties.displayType = \"value\";\r\n        var defaultAllowActions = data.properties.type === \"entityTemplate\" ? false : true;\r\n        self.properties.allowactions = (typeof data.properties.allowactions == \"undefined\")\r\n            ? defaultAllowActions : data.properties.allowactions;\r\n        self.properties.isHorizontal = (typeof data.properties.isHorizontal == \"undefined\")\r\n            ? true : data.properties.isHorizontal;\r\n        self.properties.allowSearch = (typeof data.properties.allowSearch == \"undefined\")\r\n            ? false : data.properties.allowSearch;\r\n        self.properties.selecttemplate = (typeof data.properties.selecttemplate == \"undefined\")\r\n            ? \"\" : data.properties.selecttemplate;\r\n        self.properties.templatetype = (typeof properties.templatetype != \"undefined\")\r\n            ? properties.templatetype : 'none';\r\n\r\n        self.properties.sessionId = form.params.data.sessionId;\r\n\r\n        if (!self.properties.value) {\r\n            self.properties.value = self.value = [];\r\n            self.properties.originalValue = [];\r\n        } else if (typeof self.properties.value == \"string\") {\r\n            self.properties.value = self.value = JSON.parse(self.properties.value);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Send processpropertyvalue in order to execute an Action\r\n     * This method is used when this control stay in Summary form or Global form\r\n     * @param action\r\n     */\r\n    executeActionImmediately: function (action) {\r\n        var self = this;\r\n        //Execute action immediately\r\n        var form = self.getFormContainer();\r\n\r\n        var processPropertyValueExecuteAction = {\r\n            \"idRender\": self.properties.id,\r\n            \"xpathContext\": form.properties.xpathContext,\r\n            \"idPageCache\": form.properties.idPageCache,\r\n            \"property\": \"executeAction\",\r\n            \"psurrogatedKey\": self.properties.surrogatedKey,\r\n            \"pguidAction\": action.guidAction,\r\n            \"pparameters\": JSON.encode({\r\n                \"idStartScope\": action.idStartScope,\r\n                \"pactionXpath\": self.properties.xpathActions,\r\n                \"idPageCache\": action.idPageCache\r\n            })\r\n        };\r\n\r\n        self.dataService.executeActions(processPropertyValueExecuteAction).done(function (data) {\r\n            self.notifyExecution(data, action);\r\n        }).fail(function (error) {\r\n            // TODO: Create generic mechanism to send notifications\r\n            self.notifyExecution(\"Error\", action);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * notify action execution status\r\n     * @param response\r\n     * @param actionName\r\n     */\r\n    notifyExecution: function (response, actionName) {\r\n        // To override in each device\r\n    },\r\n\r\n    /**\r\n     * Render control in read only mode: properties.editable = false\r\n     * @return {*}\r\n     */\r\n    renderReadOnly: function () {\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Make a postrender of readonly control\r\n     */\r\n    postRenderReadOnly: function () {\r\n        this.properties.readOnly = true;\r\n        this.postRender();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @return {string}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n        var template;\r\n        var html = \"\";\r\n\r\n        // Render template\r\n        if (mode == \"design\") {\r\n            template = self.renderFactory.getTemplate(\"render-actionLauncher-design\");\r\n            var params = {\r\n                type: properties.type,\r\n                isHorizontal: properties.isHorizontal,\r\n                allowSearch: properties.allowSearch,\r\n                templateDefined: properties.templatetype != 'none',\r\n                allowactions: properties.allowactions\r\n            };\r\n            html = $.fasttmpl(template, params);\r\n        } else if (properties.surrogatedKey) {\r\n            template = self.renderFactory.getTemplate(\"render-actionLauncher\");\r\n            html = $.fasttmpl(template, { allowactions: self.properties.allowactions });\r\n        }\r\n        return html;\r\n    },\r\n\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param invalidElements\r\n     * @return {*}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this,\r\n            properties = self.properties;\r\n        var value = self.getValue();\r\n        var bValid = false;\r\n\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.visible) == false) {\r\n            return true;\r\n        }\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.editable) == false) {\r\n            return true;\r\n        }\r\n\r\n        // Check required\r\n        if (properties.required) {\r\n            if (self.value) {\r\n                if (self.value.length > 0)\r\n                    return true;\r\n                message = self.getResource(\"render-required-register-action\");\r\n                invalidElements.push({ xpath: properties.xpath, message: message });\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        // TODO: write functionality\r\n        // Set internal value\r\n        self.setValue(value, false);\r\n    },\r\n\r\n    /**\r\n     * Process an action\r\n     * @param action\r\n     */\r\n    actionManager: function (action) {\r\n        var self = this;\r\n        var guidProcess = action.guidProcess || \"\";\r\n        var def = new $.Deferred();\r\n\r\n        action.recordXpath = self.getFormContainer().properties.recordXpath;\r\n\r\n        /**\r\n         * Check if action is a process\r\n         */\r\n        switch (action.actionType) {\r\n            case \"Process\":\r\n                // Verify if case has startform\r\n                var params = {\r\n                    guidWFClass: guidProcess\r\n                };\r\n\r\n                $.when(self.dataService.hasStartForm(params)).done(function (result) {\r\n                    if (result.hasStartForm) {\r\n                        // Open a dialog with startform and wait for Scope\r\n                        $.when(self.processStartForm({\r\n                            guidprocess: guidProcess,\r\n                            title: action.displayName,\r\n                            recordXpath: action.recordXpath\r\n                        })).done(function (idStartScope) {\r\n                            action.idStartScope = idStartScope;\r\n                            def.resolve(action);\r\n                        });\r\n                    } else {\r\n                        // Just add action to queue to be executed on nextEvent\r\n                        def.resolve(action);\r\n                    }\r\n                });\r\n\r\n                break;\r\n            case \"Rule\":\r\n                // Just add action to queue to be executed on nextEvent\r\n                def.resolve(action);\r\n                break;\r\n            case \"Form\":\r\n                // If it has additional xpath this action is a form of collection\r\n                if (action.xpathContext) {\r\n                    $.when(self.processActionFormCollection(action)).done(function (idStartScope) {\r\n                        action.idStartScope = idStartScope;\r\n                        def.resolve(action);\r\n                    });\r\n                } else {\r\n\r\n                    if (action.actionType === \"Form\") {\r\n                        action.xpathContext = undefined;\r\n                        action.contextType = \"entitytemplate\";\r\n                        action.guidEntity = action.guidEntity || self.properties.guidEntity;\r\n                    }\r\n\r\n                    $.when(self.processActionForm(action)).done(function (idStartScope) {\r\n                        action.idStartScope = idStartScope;\r\n                        def.resolve(action);\r\n                    });\r\n                }\r\n                break;\r\n        }\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Add actions within value object\r\n     * @param action\r\n     */\r\n    addActionToQueue: function (action) {\r\n        var self = this;\r\n        var actionsList = self.getValue();\r\n        var formParams = self.getFormContainer().getParams();\r\n\r\n        action.params = action.params || {};\r\n\r\n        var recordXpath = self.properties.xpathContext;\r\n\r\n        switch (action.actionType) {\r\n            case \"Process\":\r\n                action.params = {\r\n                    idStartScope: action.idStartScope,\r\n                    additionalXpaths: self.properties.additionalXpath.join(\",\"),\r\n                    idParentWorkitem: formParams.idWorkitem || bizagi.context.idWorkItem,\r\n                    recordXpath: recordXpath\r\n                };\r\n                break;\r\n            case \"Form\":\r\n                action.params = {\r\n                    idStartScope: action.idStartScope,\r\n                    additionalXpaths: self.properties.additionalXpath.join(\",\"),\r\n                    entityXpath: self.properties.xpathActions,\r\n                    idParentWorkitem: formParams.idWorkitem || bizagi.context.idWorkItem,\r\n                    idEntity: action.idEntity\r\n                };\r\n                break;\r\n            case \"Rule\":\r\n                action.params = {\r\n                    xpathActions: action.xpathActions || \"\",\r\n                    recordXpath: recordXpath\r\n                };\r\n                break;\r\n        }\r\n\r\n        var newValueActionsList = bizagi.clone(actionsList);\r\n        newValueActionsList.push(action);\r\n        self.setValue(newValueActionsList);\r\n        self.setDisplayValue(newValueActionsList);\r\n    },\r\n\r\n    /**\r\n     * Remove action within value object\r\n     * @param index\r\n     */\r\n    removeActionToQueue: function (index) {\r\n        var self = this;\r\n        var newValueActionsList = bizagi.clone(self.getValue());\r\n        newValueActionsList.splice(index, 1);\r\n        self.setValue(newValueActionsList);\r\n        self.setDisplayValue(newValueActionsList);\r\n    },\r\n    /**\r\n     * Add the render data to the given collection in order to send data to the server\r\n     * @param renderValues\r\n     */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        if (self.controlValueIsChanged()) {\r\n            var properties = self.properties;\r\n            var xpath = properties.xpath;\r\n            var controlValue = self.getValue();\r\n            var actions = [];\r\n            $.each(controlValue, function (index, value) {\r\n                var action = {};\r\n                action.params = value.params || {};\r\n                action.guidAction = value.guidAction;\r\n\r\n                actions.push(action);\r\n            });\r\n            renderValues[xpath] = (actions.length == 0) ? \"\" : JSON.encode(actions);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Util to count how many actions are there\r\n     * @param action\r\n     * @return {number}\r\n     */\r\n    countSameActions: function (action) {\r\n        var self = this;\r\n        var value = self.getValue();\r\n        var count = 0;\r\n        $.each(value, function (key, value) {\r\n            if (value.guidAction == action.guidAction) {\r\n                count++;\r\n            }\r\n        });\r\n        return count;\r\n    },\r\n\r\n    /**\r\n    * Normalize action launcher control properties\r\n    * @param actionsLaucher\r\n    * @returns {*}\r\n    */\r\n    getPropertiesActionLaucher: function (actionsLaucher) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        /**\r\n         * The properties of actionLaucher have to 7 properties mandatory\r\n         * 0: guidProcess\r\n         * 1: displayName\r\n         * 2: title\r\n         * 3: actionType\r\n         * 4: guidaction\r\n         * 5: xpathContext\r\n         * 6: readOnlyForm: default: false\r\n         */\r\n        for (var i = 0, length = actionsLaucher.length, j = length; i < j; i += 1) {\r\n            //some ocassions server return 6 or 7 items\r\n            //return 6 properties when launch form action from action launcher control.\r\n            //in this case dont return xpathContext.\r\n            // So, add item position 5, simulate xpathContext empty.\r\n            if (actionsLaucher[i].length === 6) {\r\n                actionsLaucher[i].splice(5, 0, \"\");\r\n\r\n                if (actionsLaucher[i][3] == \"Process\" && form.properties.xpathContext) {\r\n                    actionsLaucher[i][5] = form.properties.xpathContext;\r\n                }\r\n            }\r\n        }\r\n\r\n        return actionsLaucher;\r\n    }\r\n});\r\n","/**\r\n * Base definition of entity template\r\n *\r\n * @author: Andres Fernando Muñoz\r\n * based on action launcher control\r\n */\r\n$.Class.extend(\"bizagi.rendering.entityTemplate\", {}, {\r\n    /**\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    /**\r\n     * Initialize the control with data provided\r\n     */\r\n    initializeData: function(data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n        var form = self.getFormContainer();\r\n\r\n        self.deferredActions = new $.Deferred();\r\n        self.deferredActions.promise();\r\n\r\n        // Data of get process property value\r\n        self.processPropertyValueArgs = {\r\n            \"pcaseId\": self.getIdCase(),\r\n            \"pguidEntity\": self.properties.guidEntity,\r\n            \"idRender\": self.properties.id,\r\n            \"xpathContext\": form.properties.xpathContext,\r\n            \"idPageCache\": form.properties.idPageCache,\r\n            \"property\": \"data\",\r\n            \"psurrogatedKey\": self.properties.surrogatedKey\r\n        };\r\n\r\n        self.properties.valueWidth = 100;\r\n        self.properties.displayType = \"value\";\r\n        self.properties.allowactions = (typeof data.properties.allowactions == \"undefined\") ? true : data.properties.allowactions;\r\n\r\n        if(!self.properties.value) {\r\n            self.properties.value = self.value = [];\r\n        } else if(typeof self.properties.value == \"string\") {\r\n            self.properties.value = self.value = JSON.parse(self.properties.value);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var template;\r\n        var html = \"\";\r\n        // Render template\r\n        if (mode == \"design\") {\r\n            template = self.renderFactory.getTemplate(\"render-entityTemplate-design\");\r\n            html = $.fasttmpl(template, {});\r\n        }\r\n        else if(self.properties.surrogatedKey) {\r\n            template = self.renderFactory.getTemplate(\"render-entityTemplate\");\r\n            html = $.fasttmpl(template, {allowactions: self.properties.allowactions});\r\n        }\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this,\r\n            properties = self.properties;\r\n        // Call base\r\n        var bValid = this._super(invalidElements);\r\n        var value = self.getValue();\r\n        // TODO: write functionality\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        // TODO: write functionality\r\n        // Set internal value\r\n        self.setValue(value, false);\r\n    }\r\n});","/**\r\n * Base definition of Polymorphic launcher\r\n *\r\n * @author: Edward J Morales\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.polymorphicLauncher\", {}, {\r\n\t/*\r\n\t * Constructor\r\n\t */\r\n\tinit: function(params) {\r\n\t\t// Call base\r\n\t\tthis._super(params);\r\n\t},\r\n\r\n\t/*\r\n\t * Initialize the control with data provided\r\n\t */\r\n\tinitializeData: function(data) {\r\n\t\tvar self = this;\r\n\t\t// Call base\r\n\t\tthis._super(data);\r\n\t\tvar form = self.getFormContainer();\r\n\t\tthis.typeForm = form.properties.typeForm || \"\";\r\n\t\tvar mode = self.getMode();\r\n\r\n\t\tself.deferredActions = new $.Deferred();\r\n\t\tself.deferredActions.promise();\r\n\r\n\t\tself.properties.valueWidth = 100;\r\n\t\tself.properties.displayType = \"value\";\r\n\t\tself.properties.allowSearch = (typeof data.properties.allowSearch == \"undefined\") ? false : data.properties.allowSearch;\r\n\t\tself.properties.additionalXpath = self.properties.additionalXpath || [];\r\n\r\n\t\tif(!self.properties.value) {\r\n\t\t\tself.properties.value = self.value = [];\r\n\t\t\tself.properties.originalValue = [];\r\n\t\t} else if(typeof self.properties.value == \"string\") {\r\n\t\t\tself.properties.value = self.value = JSON.parse(self.properties.value);\r\n\t\t}\r\n\r\n\t\t// Data of get process property value\r\n\t\tself.processPropertyValueArgs = {\r\n\t\t\t\"pcaseId\": self.getIdCase(),\r\n\t\t\t\"pguidEntity\": self.properties.guidEntity,\r\n\t\t\t\"idRender\": self.properties.id,\r\n\t\t\t\"xpathContext\": form.properties.xpathContext,\r\n\t\t\t\"idPageCache\": form.properties.idPageCache,\r\n\t\t\t\"property\": \"data\",\r\n\t\t\t\"ptags\": self.getTagList(self.properties.tagslist),\r\n\t\t\t\"additionalXpaths\": self.properties.additionalXpath\r\n\t\t};\r\n\t},\r\n\r\n\t/**\r\n\t * Send processpropertyvalue in order to execute an Action\r\n\t * This method is used when this control stay in Summary form or Global form\r\n\t * @param action\r\n\t */\r\n\texecuteActionImmediately: function(action) {\r\n\t\tvar self = this;\r\n\t\t//Execute action immediately\r\n\t\tvar form = self.getFormContainer();\r\n\r\n\t\tvar processPropertyValueExecuteConstructor = {\r\n\t\t\t\"idRender\": self.properties.id,\r\n\t\t\t\"xpathContext\": form.properties.xpathContext,\r\n\t\t\t\"idPageCache\": form.properties.idPageCache,\r\n\t\t\t\"property\": \"executeConstructor\",\r\n\t\t\t\"psurrogatedKey\": self.properties.surrogatedKey,\r\n\t\t\t\"pguidConstructor\": action.guidConstructor,\r\n\t\t\t\"pparameters\": JSON.encode({\r\n\t\t\t\t\"idStartScope\": action.idStartScope,\r\n\t\t\t\t\"pactionXpath\": self.properties.xpathActions,\r\n\t\t\t\t\"idPageCache\": action.idPageCache\r\n\t\t\t})\r\n\t\t};\r\n\r\n\t\tself.dataService.executeActions(processPropertyValueExecuteConstructor).done(function(data) {\r\n\t\t\tself.notifyExecution(data.response, action);\r\n\t\t}).fail(function(error) {\r\n\t\t\t// TODO: Create generic mechanism to send notifications\r\n\t\t\tself.notifyExecution(\"Error\", action);\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * notify action execution status\r\n\t * @param response\r\n\t */\r\n\tnotifyExecution: function(response, actionName) {\r\n\t\t// To override in each device\r\n\t},\r\n\r\n\t/**\r\n\t * Render control in read only mode: properties.editable = false\r\n\t * @return {*}\r\n\t */\r\n\trenderReadOnly: function() {\r\n\t\treturn this.renderControl();\r\n\t},\r\n\r\n\t/**\r\n\t * Make a postrender of readonly control\r\n\t */\r\n\tpostRenderReadOnly: function() {\r\n\t\tthis.properties.readOnly = true;\r\n\t\tthis.postRender();\r\n\t},\r\n\r\n\t/**\r\n\t * Template method to implement in each children to customize each control\r\n\t * @return {string}\r\n\t */\r\n\trenderControl: function() {\r\n\t\tvar self = this;\r\n\t\tvar properties = self.properties;\r\n\t\tvar mode = self.getMode();\r\n\t\tvar template;\r\n\t\tvar html = \"\";\r\n\r\n\t\t// Render template\r\n\t\tif(mode == \"design\") {\r\n\t\t\ttemplate = self.renderFactory.getTemplate(\"render-polymorphicLauncher-design\");\r\n\t\t\tvar params = {\r\n\t\t\t\ttype: properties.type,\r\n\t\t\t\tallowSearch: properties.allowSearch\r\n\t\t\t};\r\n\t\t\thtml = $.fasttmpl(template, params);\r\n\t\t} else if(properties.surrogatedKey) {\r\n\t\t\ttemplate = self.renderFactory.getTemplate(\"render-polymorphicLauncher\");\r\n\t\t\thtml = $.fasttmpl(template);\r\n\t\t}\r\n\t\treturn html;\r\n\t},\r\n\r\n\r\n\t/**\r\n\t * Public method to determine if a value is valid or not\r\n\t * @param invalidElements\r\n\t * @return {*}\r\n\t */\r\n\tisValid: function(invalidElements) {\r\n\t\tvar self = this,\r\n\t\t\tproperties = self.properties;\r\n\t\t// Call base\r\n\t\tvar bValid = this._super(invalidElements);\r\n\t\tvar value = self.getValue();\r\n\t\t// TODO: write functionality\r\n\t\treturn bValid;\r\n\t},\r\n\r\n\t/**\r\n\t * Sets the value in the rendered control\r\n\t * @param value\r\n\t */\r\n\tsetDisplayValue: function(value) {\r\n\t\tvar self = this;\r\n\t\t// Set internal value\r\n\t\tself.setValue(value, false);\r\n\t},\r\n\r\n\t/**\r\n\t * Process an action\r\n\t * @param action\r\n\t */\r\n\tactionManager: function(action) {\r\n\t\tvar self = this;\r\n\t\tvar guidProcess = action.guidObject || \"\";\r\n\t\tvar def = new $.Deferred();\r\n\r\n        action.recordXpath = self.getFormContainer().properties.recordXpath;\r\n\r\n\t\t/**\r\n\t\t/**\r\n\t\t * Check if action is a process\r\n\t\t */\r\n\t\tswitch(action.actionType) {\r\n\t\t\tcase \"Process\":\r\n\t\t\t\t// Verify if case has startform\r\n\t\t\t\tvar params = {\r\n\t\t\t\t\tguidWFClass: guidProcess\r\n\t\t\t\t};\r\n\r\n\t\t\t\t$.when(self.dataService.hasStartForm(params)).done(function(result) {\r\n\t\t\t\t\tif(result.hasStartForm) {\r\n\t\t\t\t\t\t// Open a dialog with startform and wait for Scope\r\n\t\t\t\t\t\t$.when(self.processStartForm({\r\n\t\t\t\t\t\t\tguidprocess: guidProcess,\r\n\t\t\t\t\t\t\ttitle: action.displayNamee,\r\n                            recordXpath: action.recordXpath\r\n\t\t\t\t\t\t})).done(function(idStartScope) {\r\n\t\t\t\t\t\t\taction.idStartScope = idStartScope;\r\n\t\t\t\t\t\t\tdef.resolve(action);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// Just add action to queue to be executed on nextEvent\r\n\t\t\t\t\t\tdef.resolve(action);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Rule\":\r\n\t\t\t\t// Just add action to queue to be executed on nextEvent\r\n\t\t\t\tdef.resolve(action);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Form\":\r\n\t\t\t\t$.when(self.processActionForm(action)).done(function(idStartScope) {\r\n\t\t\t\t\taction.idStartScope = idStartScope;\r\n\t\t\t\t\tdef.resolve(action);\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\treturn def.promise();\r\n\t},\r\n\r\n\t/**\r\n\t * Add actions within value object\r\n\t * @param action\r\n\t */\r\n\taddActionToQueue: function(action) {\r\n\t\tvar self = this;\r\n\t\tvar actionsList = self.getValue();\r\n\t\tvar formParams = self.getFormContainer().getParams();\r\n\t\t\r\n\t\taction.params = action.params || {};\r\n\r\n        var recordXpath = self.properties.xpathContext;\r\n\r\n\t\tswitch(action.actionType) {\r\n\t\t\tcase \"Process\":\r\n\t\t\t\taction.params = {\r\n\t\t\t\t\tadditionalXpaths: self.properties.additionalXpath.join(\",\"),\r\n\t\t\t\t\tidParentWorkitem: formParams.idWorkitem || bizagi.context.idWorkItem,\r\n                    recordXpath: recordXpath\r\n\t\t\t\t};\r\n                if (typeof action.idStartScope !== \"undefined\") {\r\n                    action.params.idStartScope = action.idStartScope;\r\n                }\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Form\":\r\n\t\t\t\taction.params = {\r\n\t\t\t\t\tidStartScope: action.idStartScope,\r\n\t\t\t\t\tadditionalXpaths: self.properties.additionalXpath.join(\",\"),\r\n\t\t\t\t\tentityXpath: self.properties.xpathActions,\r\n\t\t\t\t\tidParentWorkitem: formParams.idWorkitem || bizagi.context.idWorkItem,\r\n\t\t\t\t\tidEntity: action.idEntity,\r\n\t\t\t\t\tguidEntity: action.guidEntity\r\n\t\t\t\t};\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Rule\":\r\n\t\t\t\t//TODO\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tactionsList.push(action);\r\n\t\tself.setValue(actionsList);\r\n\t\tself.setDisplayValue(actionsList);\r\n\t},\r\n\r\n\t/**\r\n\t * Remove action within value object\r\n\t * @param index\r\n\t */\r\n\tremoveActionToQueue: function(index) {\r\n\t\tvar self = this;\r\n\t\tvar value = self.getValue();\r\n\t\tvalue.splice(index, 1);\r\n\t\tself.setValue(value);\r\n\t\tself.setDisplayValue(value);\r\n\t},\r\n\t/**\r\n\t * Add the render data to the given collection in order to send data to the server\r\n\t * @param renderValues\r\n\t */\r\n\tcollectData: function(renderValues) {\r\n\t\tvar self = this;\r\n\t\tif(self.controlValueIsChanged()) {\r\n\t\t\tvar properties = self.properties;\r\n\t\t\tvar xpath = properties.xpath;\r\n\t\t\tvar controlValue = self.getValue();\r\n\t\t\tvar actions = [];\r\n\t\t\t$.each(controlValue, function(index, value) {\r\n\t\t\t\tvar action = {};\r\n\t\t\t\taction.params = value.params || {};\r\n\t\t\t\taction.guidAction = value.guidObject || value.guidAction;\r\n\t\t\t\taction.displayName = value.displayName;\r\n\t\t\t\taction.guidConstructor = value.guidConstructor;\r\n\t\t\t\taction.actionType = value.actionType;\r\n\t\t\t\taction.xpathContext = value.xpathContext;\r\n\t\t\t\taction.guidEntity = value.guidEntity;\r\n\t\t\t\tactions.push(action);\r\n\t\t\t});\r\n\t\t\trenderValues[xpath] = (actions.length == 0) ? \"\" : JSON.encode(actions);\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n\t * Util to count how many actions are there\r\n\t * @param action\r\n\t * @return {number}\r\n\t */\r\n\tcountSameActions: function(action) {\r\n\t\tvar self = this;\r\n\t\tvar value = self.getValue();\r\n\t\tvar count = 0;\r\n\t\t$.each(value, function(key, value) {\r\n\t\t\tif(value.guidAction == action.guidAction) {\r\n\t\t\t\tcount++;\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn count;\r\n\t},\r\n\r\n\t/**\r\n\t * Get list of tags\r\n\t * @param taglist\r\n\t * @return {Array}\r\n\t */\r\n\tgetTagList: function(taglist) {\r\n\t\ttaglist = taglist || [];\r\n\t\tvar result = [];\r\n\r\n\t\tfor(var i = taglist.length; i > 0; i--) {\r\n\t\t\tresult.push(taglist[i - 1].value);\r\n\t\t}\r\n\t\treturn (result.length > 0) ? result : \"\";\r\n\t}\r\n});","/**\r\n *   Name: Bizagi Render Combo Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for combo renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.combo\", {}, {\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        properties.hasLocalData = properties.data || false;\r\n        // TODO: Review additional value in radio control\r\n        properties.value = properties.value && properties.value.length > 0 ? properties.value[0] : (properties.defaultValue && properties.defaultValue.length > 0 ? properties.defaultValue[0] : null);\r\n\r\n        if (typeof (properties.enableTyping) === \"undefined\") properties.enableTyping = true;\r\n        if (properties.value && properties.value.id === undefined) properties.value = null;\r\n        this.value = properties.value;\r\n\r\n        // Add empty node if configured\r\n        if (properties.hasLocalData) {\r\n            properties.data = this.complementData(properties.data);\r\n        }\r\n\r\n        // This line is to set a flag to fetch the data when rendering, or on demand, by default is false, overriding it on desktop implementation\r\n        properties.loadOnDemand = false;\r\n    },\r\n\r\n\r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var params = {};\r\n        var renderType = bizagi.util.normalizeType(self.properties.type);\r\n\r\n        if (self.isDependant && self.properties && /^cascadingcombo$/i.test(renderType) && self.getParentCombo) {\r\n            var valueControl = self.getParentCombo().getValue();\r\n            if (valueControl && valueControl.id) {\r\n                params[self.Class.BA_ACTION_PARAMETER_PREFIX + \"parent\"] = valueControl.id;\r\n            }\r\n        }\r\n\r\n        return self.renderCombo(params);\r\n    },\r\n\r\n    /*\r\n    *   Renders the combo\r\n    */\r\n    renderCombo: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (properties.loadOnDemand) {\r\n            // Render the combo without data\r\n            var html = self.renderComboTemplate();\r\n            return html;\r\n        } else {\r\n\r\n            // Set data promise \r\n            var defer = new $.Deferred();\r\n            var dataPromise = self.getData(params);\r\n\r\n            // Attach callback \r\n            $.when(dataPromise).done(function (data) {\r\n                // Render combo\r\n                var html = self.renderComboTemplate(data);\r\n                self.properties.data = data;\r\n                defer.resolve(html);\r\n\r\n            }).fail(function (data) {\r\n                var html = self.renderComboTemplate({});\r\n                defer.resolve(html);\r\n            });\r\n\r\n            // Returns a promise so we can hold post-render method until this is done\r\n            return defer.promise();\r\n        }\r\n    },\r\n\r\n    renderComboTemplate: function (data) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(self.getTemplateName());\r\n        var emptyValue = bizagi.override.emptyLabelForCombo || self.getResource(\"render-combo-empty-selection\");\r\n        var value = properties.value ? \"\" : emptyValue;\r\n        data = data || self.properties.data || {};\r\n\r\n        if (self.properties.type === \"columnCombo\" && value === \"\" && typeof properties.value === \"object\" && properties.value.id === \"\" && (properties.value.value === \"\" || properties.value.value === self.getResource(\"render-combo-empty-value\"))) {\r\n            value = self.getResource(\"render-combo-empty-selection\");\r\n        }\r\n\r\n        var html = $.fasttmpl(template, $.extend(self.getTemplateParams(), {\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            unique: bizagi.util.randomNumber(10000, 1000000),\r\n            idPageCache: properties.idPageCache,\r\n            items: data,\r\n            align: properties.valueAlign,\r\n            value: value,\r\n            editable: properties.editable\r\n        }));\r\n\r\n\r\n        return html;\r\n    },\r\n\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed in read-only mode\r\n    */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        self._super();\r\n        var item = self.getValue();\r\n        var control = self.getControl();\r\n\r\n        if (self.control && self.control.parent()) {\r\n            self.control.parent().addClass(\"ui-bizagi-noneditable-\" + self.properties.displayType);\r\n        }\r\n        if (item) {\r\n\r\n            if (item.value != null && typeof (item.value) === \"boolean\") {\r\n                if (bizagi.util.parseBoolean(item.value) === true) {\r\n                    item.value = this.getResource(\"render-boolean-yes\");\r\n\r\n                } else if (bizagi.util.parseBoolean(item.value) == false) {\r\n                    item.value = this.getResource(\"render-boolean-no\");\r\n                }\r\n            }\r\n\r\n            // Returns the cached value from the properties to avoid server side fetching\r\n            if (self.getResource(\"render-combo-empty-value\") === item.value || self.getResource(\"render-combo-empty-selection\") === item.value) {\r\n                control.text(\"\");\r\n            } else {\r\n                control.html(\"<label class='readonly-control'>\" + self.formatItem(item.value) + \"</label>\");\r\n            }\r\n        } else {\r\n            // Render empty \r\n            control.text(\"\");\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Gets the template used by the combo render\r\n    *   can be overriden in subclasses to reuse logic and just change the template\r\n    */\r\n    getTemplateName: function () {\r\n        return \"combo\";\r\n    },\r\n\r\n    /*\r\n    *   Determines if we need to show the empty node or not\r\n    *   Can be overriden to change behaviour\r\n    */\r\n    showEmpty: function () {\r\n        return true;\r\n    },\r\n\r\n    /*\r\n    *   Determines if we need to show the current data regardless if it belongs to data or not\r\n    *   Can be overriden to change behaviour\r\n    */\r\n    showCurrentData: function () {\r\n        return true;\r\n    },\r\n\r\n    /*\r\n    *   Fetch the data into a deferred\r\n    */\r\n    getData: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n        var mode = self.getMode();\r\n\r\n        // Just execute ajax calls when rendering in execution mode\r\n        if (mode !== \"execution\") return self.getDummyData();\r\n\r\n        if (properties.hasLocalData) {\r\n\r\n            // Resolve with local data    \r\n            defer.resolve(properties.data);\r\n\r\n        } else {\r\n            var renderType = bizagi.util.normalizeType(properties.type);\r\n\r\n            // Check if the data has been cached\r\n            if (properties.remoteDataLoaded && !(/^cascadingcombo$/i.test(renderType))) {\r\n                defer.resolve(properties.data);\r\n            } else {\r\n                // Go to server\r\n                self.dataService.multiaction().getData({\r\n                    url: properties.dataUrl,\r\n                    xpath: properties.xpath,\r\n                    idRender: properties.id,\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: properties.idPageCache,\r\n                    extra: params,\r\n                    contexttype: self.properties.contexttype || null\r\n                }).done(function (data) {\r\n\r\n                    // Resolve the data\r\n                    if (!properties.recalculate) {\r\n                        properties.remoteDataLoaded = true;\r\n                    }\r\n                    properties.data = self.complementData(data);\r\n                    defer.resolve(properties.data);\r\n\r\n                }).fail(function (data) {\r\n\r\n                    if (data.type === \"not-processed\")\r\n                        return;\r\n\r\n                    // Show error from server\r\n                    var form = self.getFormContainer();\r\n                    var msgObj = self.properties.displayName + \": \";\r\n\r\n                    if (typeof data === \"string\") {\r\n                        var auxMsg = JSON && JSON.parse(data) || $.parseJSON(data);\r\n                    } else {\r\n                        var auxMsg = data;\r\n                    }\r\n\r\n                    msgObj += auxMsg.message;\r\n\r\n                    form.addValidationMessage(msgObj);\r\n\r\n                    defer.reject(data);\r\n                });\r\n            }\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n    *   Creates a set of dummy data in order to display it when rendering in design or layout mode\r\n    */\r\n    getDummyData: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        if (properties.data) {\r\n            return properties.data;\r\n\r\n        } else {\r\n            properties.data = [];\r\n            properties.data = self.complementData(properties.data);\r\n\r\n            // Add another data\r\n            properties.data.push({id: \"\", value: \"Item 1\"});\r\n            properties.data.push({id: \"\", value: \"Item 2\"});\r\n\r\n            return properties.data;\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Resets the data in order to fetch it again when needed\r\n    */\r\n    resetData: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        properties.hasLocalData = false;\r\n        properties.data = null;\r\n        properties.remoteDataLoaded = false;\r\n    },\r\n\r\n    /* \r\n    *   Gets the display value of the render\r\n    */\r\n    getDisplayValue: function () {\r\n        var self = this;\r\n\r\n        if (self.combo && self.combo.length > 0) {\r\n            // When there is a combo painted, we fetch the selected value from it\r\n            return self.getSelectedValue();\r\n        } else {\r\n            var displayValue = \"\";\r\n            var item = self.getValue();\r\n\r\n            if (item) {\r\n                // Check on cached propert from server first if the key exists\r\n                displayValue = self.formatItem(item.value);\r\n            }\r\n\r\n            return displayValue;\r\n        }\r\n    },\r\n\r\n\r\n    /*\r\n    *   Returns the selected value in the template\r\n    */\r\n    getSelectedValue: function () {\r\n    },\r\n\r\n    /*\r\n    *   Adds custom parameters to process the template\r\n    */\r\n    getTemplateParams: function () {\r\n        return {};\r\n    },\r\n\r\n    /**\r\n     * Formats value of each item\r\n     * @param {string, boolean or array} value\r\n     * @example\r\n     * value = \"string\" => \"string\"\r\n     * value = true => \"yes\" or \"si\", the localized value\r\n     * value = false => \"no\", the localized value\r\n     * value = [\"string 1\", \"string 2\"] => \"string 1 - string 2\"\r\n     * @returns {string}\r\n     */\r\n    formatItem: function (value) {\r\n\r\n        if (value !== undefined && value !== null) {\r\n            if ($.isArray(value)) {\r\n\r\n                for (var i = 0, length = value.length; i < length; i++) {\r\n                    if (value[i] != null && typeof (value[i]) === \"boolean\") {\r\n                        if (bizagi.util.parseBoolean(value[i]) === true) {\r\n                            value[i] = this.getResource(\"render-boolean-yes\");\r\n                        } else if (bizagi.util.parseBoolean(value[i]) === false) {\r\n                            value[i] = this.getResource(\"render-boolean-no\");\r\n                        }\r\n                    }\r\n                }\r\n                return value.join(\" - \");\r\n            } else {\r\n                return value;\r\n            }\r\n        } else {\r\n            return \"\";\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Add the render data to the given collection in order to send data to the server\r\n    */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Add the render value\r\n        var xpath = properties.xpath;\r\n        var value = self.getValue();\r\n\r\n        if (self.controlValueIsChanged()) {\r\n            // Filter by valid xpaths and valid values\r\n            // Remove empty validation for value for combos        \r\n            if (!bizagi.util.isEmpty(xpath) && value !== null && typeof (value) !== \"undefined\") {\r\n                // Add a validation because sometimes value contains an empty not null object\r\n                if (typeof (value) === \"object\" && (value.id === undefined || value.id === \"\")) {\r\n                    renderValues[properties.xpath] = \"\";\r\n                } else {\r\n                    // Add the value to the server\r\n                    renderValues[properties.xpath] = typeof (value.id) !== \"undefined\" ? value.id : \"\";\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    controlValueIsChanged: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var currentValue = self.getValue();\r\n        var originalValue = properties.originalValue;\r\n        var defaultValue = properties.defaultValue;\r\n\r\n        var result = true;\r\n\r\n        if ($.forceCollectData) {\r\n            return result;\r\n        }\r\n\r\n        currentValue = currentValue && currentValue.length !== undefined ? currentValue[0] : currentValue;\r\n        originalValue = originalValue && originalValue.length !== undefined ? originalValue[0] : originalValue;\r\n        defaultValue = defaultValue && defaultValue.length !== undefined ? defaultValue[0] : defaultValue;\r\n\r\n        currentValue = currentValue && currentValue.id !== undefined ? currentValue.id : currentValue;\r\n        originalValue = originalValue && originalValue.id !== undefined ? originalValue.id : originalValue;\r\n        defaultValue = defaultValue && defaultValue.id !== undefined ? defaultValue.id : defaultValue;\r\n\r\n        if (defaultValue !== undefined) {\r\n            if (defaultValue != originalValue || defaultValue != currentValue) {\r\n                result = true;\r\n            } else {\r\n                result = false;\r\n            }\r\n        } else {\r\n            result = currentValue != originalValue ? true : false;\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    * Parses additional values info in order to format them correctly\r\n    */\r\n    parseAdditionalValues: function (data) {\r\n        var self = this;\r\n\r\n        return $.map(data, function (item) {\r\n            var value = item.value ? self.formatItem(item.value) : item;\r\n            var newItem = {id: item.id, value: value};\r\n\r\n            if (item.hidden) newItem.hidden = true;\r\n            return item;\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Complement data from server before control implementation\r\n    */\r\n    complementData: function (data) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var bCurrentDataFound = false;\r\n        $.each(data, function (i, item) {\r\n\r\n            if (item.value !== undefined && item.value !== null) {\r\n                item.value = self.formatItem(item.value);\r\n                if (properties.value) {\r\n                    if (item.id == properties.value.id) {\r\n                        bCurrentDataFound = true;\r\n                    }\r\n                }\r\n            } else {\r\n                item.value = \"\";\r\n            }\r\n        });\r\n\r\n        // Add empty node if configured\r\n        if (self.showEmpty()) {\r\n            var emptyFound = false;\r\n            for (var i = 0, length = data.length; i < length; i++) {\r\n                if (data[i].id === \"\") {\r\n                    emptyFound = true;\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if (!emptyFound) {\r\n                var dataValue = bizagi.override.emptyLabelForCombo || bizagi.localization.getResource(\"render-combo-empty-value\")\r\n                data.unshift({id: \"\", value: dataValue});\r\n            }\r\n        }\r\n\r\n        if (properties.value) {\r\n            if (!bCurrentDataFound && self.showCurrentData()) {\r\n                data.unshift({id: properties.value.id, value: properties.value.value, hidden: true});\r\n            }\r\n        }\r\n\r\n        // Add additional value\r\n        return self.parseAdditionalValues(data);\r\n    },\r\n\r\n    /*\r\n    *   Check if a render has no value for required validation\r\n    */\r\n    hasValue: function () {\r\n        var self = this;\r\n        var currentValue = self.getValue();\r\n\r\n        if (bizagi.util.isEmpty(currentValue)) return false;\r\n        if (Object.prototype.toString.apply(currentValue) === \"[object Object]\" && (bizagi.util.isEmpty(currentValue.id) || currentValue.id == 0)) return false;\r\n\r\n        // Else\r\n        return true;\r\n    },\r\n\r\n    /*\r\n    * Cleans current data\r\n    */\r\n    cleanData: function () {\r\n        var self = this;\r\n        var value = {id: \"\", label: \"\"};\r\n\r\n        self.setDisplayValue(value);\r\n        self.setValue(value, false);\r\n    },\r\n\r\n    beforeToRefresh: function () {\r\n        this.column && !this.column.comboData && this.getData();\r\n    },\r\n\r\n    isExtraItem: function () {\r\n        var self = this;\r\n        var data = self.value || {};\r\n        var value = data.value || \"\";\r\n\r\n        return value === \"\" || value === self.getResource(\"render-combo-empty-selection\") || value === self.getResource(\"render-combo-empty-value\");\r\n    },\r\n\r\n    escapeValue: function (value) {\r\n        if (bizagi.util.isString(value)) {\r\n            var valueToReturn = value.replaceAll(\"<\", \"&lt;\").replaceAll(\">\", \"&gt;\");\r\n            return valueToReturn;\r\n        } else {\r\n            return value;\r\n        }\r\n    },\r\n\r\n    /**\r\n     *  Maps the value, when this one comes from actions\r\n     * @param value\r\n     * @returns {*}\r\n     */\r\n    mapValue: function (value) {\r\n        if (value && value.fromAction) {\r\n            return {\r\n                id: value.value,\r\n                value: value.label,\r\n                label: value.label\r\n            }\r\n        }\r\n\r\n        return value;\r\n    },\r\n\r\n    validateValue: function (value) {\r\n        if ((value.id != undefined) && ((typeof value.id === \"number\" && value.id !== null) || (typeof value.id === \"string\" && value.id.length > 0))) {\r\n            if (value.value !== null && typeof value.value === \"boolean\") {\r\n                translated = true;\r\n                if (bizagi.util.parseBoolean(value.value) === true) {\r\n                    value.value = bizagi.localization.getResource(\"render-boolean-yes\");\r\n                } else if (bizagi.util.parseBoolean(value.value) === false) {\r\n                    value.value = bizagi.localization.getResource(\"render-boolean-no\");\r\n                }\r\n            } else if (value.value != null && typeof value.value === \"object\") {\r\n                for (var i = 0, length = value.value.length; i < length; i++) {\r\n                    if (value.value[i] != null && typeof (value.value[i]) === \"boolean\") {\r\n                        if (bizagi.util.parseBoolean(value.value[i]) === true) {\r\n                            value.value[i] = bizagi.localization.getResource(\"render-boolean-yes\");\r\n                        } else if (bizagi.util.parseBoolean(value.value[i]) === false) {\r\n                            value.value[i] = bizagi.localization.getResource(\"render-boolean-no\");\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return value;\r\n    },\r\n\r\n    /**\r\n     * Finds an element in the combo data values by id\r\n     * @param {int} id\r\n     * @returns {Object}\r\n     */\r\n    findDataValueById: function (id) {\r\n        return (this.properties.data || []).find(function (e) {\r\n            return e.id == id;\r\n        });\r\n    }\r\n\r\n});","/**\r\n *   Name: Bizagi Render Check Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for check renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.check\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.value = typeof (properties.value) != \"undefined\" ? bizagi.util.parseBoolean(properties.value) : null;\r\n\r\n        properties.showLetters = (bizagi.override && bizagi.override.enableCheck === true) && !properties.editable;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var template = this.renderFactory.getTemplate(\"check\");\r\n        var randomId = bizagi.util.randomNumber(100, 10000000);\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            id: randomId,\r\n            editable: this.properties.editable\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderReadOnly: function () {\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * Gets the display value of the render\r\n     */\r\n    getDisplayValue: function () {\r\n        var value = this.getValue();\r\n\r\n        if (bizagi.util.parseBoolean(value) === true) {\r\n            return this.getResource(\"render-boolean-yes\");\r\n        } else if (bizagi.util.parseBoolean(value) === false) {\r\n            return this.getResource(\"render-boolean-no\");\r\n        } else {\r\n            return \"\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Check if a render has no value for required validation\r\n     */\r\n    hasValue: function () {\r\n        var value = this.getValue();\r\n\r\n        if (bizagi.util.isEmpty(value)) return false;\r\n\r\n        var booleanValue = bizagi.util.parseBoolean(value);\r\n\r\n        return !(booleanValue === false && this.properties.required);\r\n    }\r\n\r\n});","/*\r\n*   Name: Bizagi Render Number Class\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will define basic stuff for numbers\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.number\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        var format = this.getResource(\"numericFormat\");\r\n\r\n        properties.allowDecimals = (typeof (properties.allowDecimals) !== \"undefined\") ? bizagi.util.parseBoolean(properties.allowDecimals) : this.getDefaultAllowDecimals(properties.dataType);\r\n        properties.numDecimals = properties.allowDecimals ? (properties.numDecimals ? properties.numDecimals : (typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits : 2)) : 0;\r\n        properties.symbol = '';\r\n        properties.positiveFormat = format.positiveFormat;\r\n        properties.negativeFormat = format.negativeFormat;\r\n        properties.decimalSymbol = typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator : format.decimalSymbol;\r\n        properties.digitGroupSymbol = typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.groupSeparator : format.digitGroupSymbol;\r\n        properties.groupDigits = this.setGroupDigits();\r\n        properties.colorize = properties.colorizeOnNegative || false;\r\n        properties.dataTypeMinValue = this.calculateMinValue(properties.dataType);\r\n        properties.dataTypeMaxValue = this.calculateMaxValue(properties.dataType);\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"number\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            editable: self.properties.editable,\r\n            value: bizagi.isMobile() ? self.getDisplayValue() : \"\", // Only apply to mobile because in the template value is required (Bug: 11624)\r\n            type: bizagi.util.isAndroidDevice() ? \"tel\" : \"text\", // Change type control for android device\r\n            isDesign: self.getMode() !== \"execution\"\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        self._super();\r\n\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n\r\n        self.numericInput = control.find(\"input\");\r\n\r\n        // Add numeric plugin to avoid invalid keystrokes\r\n        self.numericInput.numeric(self.properties.decimalSymbol);\r\n\r\n        // Attach event for retype double\r\n        if (properties.retype === \"double\") {\r\n            self.attachRetypeDouble();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Method to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        // Attach Format Currency Plugin to format the input\r\n        this.attachFormatCurrency();\r\n    },\r\n\r\n    /**\r\n     * Removes Validation Messages\r\n     */\r\n    removeValidations: function () {\r\n        var form = this.getFormContainer().parent || this.getFormContainer();\r\n\r\n        form.clearValidationMessages();\r\n    },\r\n\r\n    /**\r\n     * Function virtual implements on children (desktop,smartphone...).\r\n     * @returns {}\r\n     */\r\n    attachRetypeDouble: function () {\r\n    },\r\n\r\n    /**\r\n     * Adds the format currency plugin\r\n     * @returns {}\r\n     */\r\n    attachFormatCurrency: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var message = bizagi.localization.getResource(\"render-number-retype-fail\");\r\n        self.isValidRender = self.isValidRender || true;\r\n\r\n        // Extend formatCurrency language\r\n        if ($.formatCurrency.regions[bizagi.language] == null)\r\n            $.formatCurrency.regions[bizagi.language] = this.getResource(\"numericFormat\");\r\n\r\n        // Attach events\r\n        self.numericInput.blur(function () {\r\n            if (typeof (self.getFormContainer().validationController) == \"undefined\") self.getFormContainer().validationController = new bizagi.command.controllers.validation(self.getFormContainer(), self.validations);\r\n            var validationController = self.getFormContainer().validationController || self.getFormContainer().parent.validationController;\r\n            var decimalSeparator = \".\";\r\n            var digitGroupSeparator = \",\";\r\n            if (typeof (BIZAGI_DEFAULT_CURRENCY_INFO) == \"undefined\") {\r\n                decimalSeparator = self.getResource(\"numericFormat\").decimalSymbol || \".\";\r\n                digitGroupSeparator = self.getResource(\"numericFormat\").digitGroupSymbol || \",\";\r\n            }\r\n            else {\r\n                decimalSeparator = BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator;\r\n                digitGroupSeparator = BIZAGI_DEFAULT_CURRENCY_INFO.groupSeparator;\r\n            }\r\n\r\n            var minValue = self.getMinValue();\r\n            var maxValue = self.getMaxValue();\r\n\r\n            if(properties.percentage)self.numericInput.val(self.numericInput.val().replace(\"%\", \"\"));\r\n            var inputValue = self.numericInput.val();\r\n            inputValue = (decimalSeparator == \",\") ? inputValue.replace(/\\,0+$/, '') : inputValue.replace(/\\.0+$/, '');\r\n            inputValue = inputValue.replace(properties.symbol, \"\");\r\n            //Replace all the ocurrences of the digitGroupSeparator\r\n            inputValue = bizagi.util.replaceAll(inputValue, digitGroupSeparator, \"\");\r\n            if (inputValue.toString().indexOf(decimalSeparator) != -1) {\r\n                if (decimalSeparator == \",\") inputValue = inputValue.replace(/([0-9]+(\\,[0-9]+[1-9])?)(\\,?0+$)/, '$1');\r\n                if (decimalSeparator == \".\") inputValue = inputValue.replace(/([0-9]+(\\.[0-9]+[1-9])?)(\\.?0+$)/, '$1');\r\n            }\r\n\r\n            if (inputValue != undefined && inputValue.length > 0) self.numericInput.val(inputValue);\r\n\r\n            if (/(.+)-$/.test(inputValue)) {\r\n                inputValue = inputValue.replace(/(.+)-$/, '-$1');\r\n                self.numericInput.val(inputValue);\r\n            }\r\n\r\n            var inputLength = inputValue.replace(/[^0-9]+/g, \"\").length;\r\n            var xPath = self.properties.xpath;\r\n            var oldVal = self.numericInput.val();\r\n\r\n\r\n            if ((self.isInvalidFormat != null && self.isInvalidFormat == true)\r\n                || (inputValue != \"\" && [\"$\", \"£\", \"€\", \"¥\", properties.symbol].indexOf(inputValue) != -1)) {\r\n                self.setValue(\"\");\r\n                self.getControl().find(\"input\").val(\"\");\r\n                self.numericInput.val(\"\");\r\n                return;\r\n            }\r\n\r\n            if (bizagi.util.trim(inputValue) == \"\") {\r\n                self.setValue(\"\");\r\n                return;\r\n            }\r\n\r\n            //The \",\" is changed to \".\" For the correct operation of \"parseFloat ()\"\r\n            var tempValue = parseFloat(inputValue.replace(\",\", \".\"));\r\n            if (isNaN(tempValue)) {\r\n                tempValue = self.numericInput.asNumber();\r\n            }\r\n\r\n            if (minValue !== undefined && minValue != null && tempValue < minValue) {\r\n                message = bizagi.localization.getResource(\"render-numeric-minimum-validation\")\r\n                    .replaceAll(\"#label#\", properties.displayName + \" (\" + oldVal + \")\")\r\n                    .replaceAll(\"#minValue#\", minValue.toString());\r\n            }\r\n            else if (maxValue !== undefined && maxValue !== null && tempValue > maxValue) {\r\n                message = bizagi.localization.getResource(\"render-numeric-maximum-validation\")\r\n                    .replaceAll(\"#label#\", properties.displayName + \" (\" + oldVal + \")\")\r\n                    .replaceAll(\"#maxValue#\", maxValue.toString());\r\n            } else\r\n                message = message + \" \" + oldVal + \"\";\r\n\r\n\r\n            // Do datatype validations\r\n            if (\r\n                (minValue !== undefined && minValue !== null && tempValue < minValue)\r\n                || (maxValue !== undefined && maxValue !== null && tempValue > maxValue)\r\n                || (self.properties.dataType == 10 && inputLength > 15)\r\n                || (self.properties.dataType == 1 && inputLength > 19)\r\n                || (self.properties.dataType == 11 && inputLength > 7)\r\n                || (self.properties.dataType == 11 && inputLength > 7)\r\n                || (oldVal.match(/[^$£€¥,-.()\\d]/))\r\n            ) {\r\n                if (typeof validationController != \"undefined\" && validationController != null) {\r\n                    self.removeValidations();\r\n\r\n                    var messageToShow = message;\r\n                    if(messageToShow.indexOf(oldVal) === -1){\r\n                        messageToShow = message + \" \" + oldVal + \"\";\r\n                    }\r\n\r\n                    validationController.showValidationMessage(messageToShow, xPath);\r\n                    self.isValidRender = false;\r\n                    self.isValidRenderMessage = messageToShow;\r\n                }\r\n                message = message.replace(oldVal, \"\");\r\n                return;\r\n            }\r\n            else {\r\n                self.isValidRender = true;\r\n                self.isValidRenderMessage = \"\";\r\n            }\r\n\r\n            // Fix decimals specially when it starts with 0 (0000234 -> 234, 00000 -> 0)\r\n            if (this.value.toString().length > 0 && !properties.allowDecimals && !properties.groupDigits) {\r\n                this.value = this.value.toString().replace(/^0+/, '');\r\n                if (properties.symbol.length > 0) this.value = this.value.toString().replace(properties.symbol + \"0\", properties.symbol);\r\n                this.value = this.value.toString().replace(/^0+/, '');\r\n                if (this.value.replaceAll('0', '').length == 0)\r\n                    this.value = properties.symbol + \"0\";\r\n                else if (this.value.toString() == parseInt(this.value)) this.value = properties.symbol + this.value;\r\n            } else {\r\n                //Fix type money when number start with 0 (0000234 -> 234, 00000 -> 0)\r\n                if(self.properties.type === \"money\" || self.properties.type === \"number\" || self.properties.type === \"columnMoney\" || self.properties.type === \"columnNumber\"){\r\n                    this.value = this.value.toString().replace(/^0+/, '');\r\n                    if(this.value === \"\"){\r\n                        this.value = 0;\r\n                    }\r\n                }\r\n            }\r\n            self.executeFormatCurrencyPlugin();\r\n\r\n            // Updates internal value\r\n            self.setValue(self.numericInput.asNumber({\r\n                symbol: properties.symbol,\r\n                positiveFormat: properties.positiveFormat,\r\n                negativeFormat: properties.negativeFormat,\r\n                decimalSymbol: properties.decimalSymbol,\r\n                digitGroupSymbol: properties.digitGroupSymbol,\r\n                groupDigits: properties.groupDigits\r\n            }));\r\n\r\n            if (properties.percentage) {\r\n                if (self.numericInput && self.numericInput.val().indexOf(\"%\") == -1)\r\n                    self.numericInput.val(self.numericInput.val() + '%');\r\n            }\r\n            message = message.replace(oldVal, \"\");\r\n        })\r\n\r\n        // Avoiding pasting invalid characters\r\n            .bind('paste', function (e) {\r\n                try {\r\n                    var tmpData = (bizagi.util.isIE() || bizagi.util.isIE11()) ? window.clipboardData.getData(\"text\") : e.originalEvent.clipboardData.getData(\"Text\");\r\n\r\n\r\n\r\n                    // Next lines checks if there is something different to numbers symbol, decimalSymbol and digitGroupSybol\r\n                    var totalVal = \"/[^0-9\";\r\n                    if (properties.decimalSymbol.length > 0) {\r\n                        totalVal += properties.decimalSymbol;\r\n                    }\r\n                    // Next lines only for currency type\r\n                    if (properties.dataType == 8) {\r\n                        if (properties.symbol.length > 0) {\r\n                            totalVal += properties.symbol;\r\n                        }\r\n                        if (properties.digitGroupSymbol.length > 0) {\r\n                            totalVal += properties.digitGroupSymbol;\r\n                        }\r\n                    }\r\n                    totalVal += \"\\\\-\\\\s]/gi\";\r\n                    try {\r\n                        if (tmpData.replace(eval(totalVal), '').length != tmpData.length)\r\n                            e.preventDefault();\r\n                    }\r\n                    catch (e) {\r\n                    }\r\n                }\r\n                catch (e) {\r\n                    bizagi.log(\"Error to pasting content\");\r\n                    self.isInvalidFormat = true;\r\n                }\r\n            })\r\n            // Now we implement keydown instead of keyup in order to include preventDefault\r\n            .keydown(function (e) {\r\n                self.previousValue = this.value;\r\n                e = (window.event && window.event.preventDefault) ? window.event : e;\r\n                var keyUnicode = e.charCode || e.keyCode;\r\n                // Validation for currency info\r\n                if (typeof (BIZAGI_DEFAULT_CURRENCY_INFO) != \"undefined\")\r\n                    if (BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits == 0) properties.allowDecimals = false;\r\n                if (properties.dataType < 5 || (properties.dataType == 8 && properties.allowDecimals == false))\r\n                    if (keyUnicode == 188 || keyUnicode == 190 || keyUnicode == 110)\r\n                        e.preventDefault();\r\n                if (this.value)\r\n                    if (e !== undefined && this.value.length > 0 && (properties.dataType == 8 || properties.dataType == 10)) {\r\n                        // Just numbers\r\n                        if (keyUnicode > 47 && keyUnicode < 58) {\r\n                            if (self.formatTimeout) {\r\n                                clearTimeout(self.formatTimeout);\r\n                            }\r\n\r\n                            var floatPart = this.value + \"\";\r\n                            //var  floatPart = stringPart.replaceAll(properties.digitGroupSymbol, \"\").replaceAll(properties.symbol,\"\").trim().replaceAll(properties.decimalSymbol,\".\");\r\n                            if (properties.digitGroupSymbol && properties.digitGroupSymbol.length > 0) {\r\n                                floatPart = floatPart.replaceAll(properties.digitGroupSymbol, \"\");\r\n                            }\r\n                            if (properties.symbol.length > 0) {\r\n                                floatPart = floatPart.replaceAll(properties.symbol, \"\");\r\n                            }\r\n\r\n                            floatPart = $.trim(floatPart);\r\n                            if (properties.decimalSymbol && properties.decimalSymbol.length > 0) {\r\n                                floatPart = floatPart.replaceAll(properties.decimalSymbol, \".\");\r\n                            }\r\n                            // If increasing one digit (x10) will overtake the maxValue\r\n                            if (floatPart * 10 > properties.dataTypeMaxValue) {\r\n                                e.preventDefault();\r\n                            }\r\n                        }                  \r\n                        else if (keyUnicode == 109 || keyUnicode == 189) {\r\n                            if (this.selectionStart != 0 || this.selectionEnd != this.value.length) {\r\n                                var currentPosition = this.selectionEnd;\r\n                                this.value = properties.symbol + \"-\" + this.value.replace(properties.symbol, \"\");\r\n                                this.selectionStart = this.selectionEnd = currentPosition + 1;\r\n                            } else if (this.selectionStart == 0 && this.selectionEnd == this.value.length) {\r\n                                this.value = \"-\";\r\n                                this.selectionStart = this.selectionEnd = this.value.length;\r\n                            }\r\n                        }\r\n                    }                    \r\n            })\r\n\r\n            .keyup(function (e) {\r\n                e = window.event || e;\r\n                var keyUnicode = e.charCode || e.keyCode;\r\n                if (e !== undefined) {\r\n                    switch (keyUnicode) {\r\n                        case 16:\r\n                            break; // Shift\r\n                        case 17:\r\n                            break; // Ctrl\r\n                        case 13:\r\n                            break; // Intro\r\n                        case 18:\r\n                            break; // Alt\r\n                        case 27:\r\n                            this.value = '';\r\n                            break; // Esc: clear entry\r\n                        case 35:\r\n                            break; // End\r\n                        case 36:\r\n                            break; // Home\r\n                        case 37:\r\n                            break; // cursor left\r\n                        case 38:\r\n                            break; // cursor up\r\n                        case 39:\r\n                            break; // cursor right\r\n                        case 40:\r\n                            break; // cursor down\r\n                        case 78:\r\n                            break; // N (Opera 9.63+ maps the \".\" from the number key section to the \"N\" key too!) (See: http://unixpapa.com/js/key.html search for \". Del\")\r\n                        case 110:\r\n                            break; // . number block (Opera 9.63+ maps the \".\" from the number block to the \"N\" key (78) !!!)\r\n                        case 188:\r\n                            break; // , comma\r\n                        case 190:\r\n                            break; // .\r\n                        default:\r\n                        {\r\n\r\n                        }\r\n                    }\r\n                }                \r\n            }).keypress(function (e) {\r\n            e = (window.event && window.event.preventDefault) ? window.event : e;\r\n            var keyUnicode = e.charCode || e.keyCode;\r\n            if (typeof (e) !== \"undefined\") {\r\n                if (keyUnicode == 35 || keyUnicode == 37 || keyUnicode == 39) {\r\n                    e.preventDefault();\r\n                } else if (properties.dataType != 8 && keyUnicode == 36) {\r\n                    e.preventDefault();\r\n                }\r\n\r\n                // When no decimals are permited\r\n                var character = String.fromCharCode(keyUnicode);\r\n                if (properties.allowDecimals === false && properties.numDecimals === 0 && character === properties.decimalSymbol)\r\n                    e.preventDefault();\r\n            }\r\n        });\r\n\r\n    },\r\n\r\n    executeFormatCurrencyPlugin: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (self.numericInput) {\r\n            self.numericInput.formatCurrency({\r\n                symbol: properties.symbol,\r\n                positiveFormat: properties.positiveFormat,\r\n                negativeFormat: properties.negativeFormat,\r\n                decimalSymbol: properties.decimalSymbol,\r\n                digitGroupSymbol: properties.digitGroupSymbol,\r\n                groupDigits: properties.groupDigits,\r\n                roundToDecimalPlace: properties.numDecimals,\r\n                colorize: properties.colorize\r\n            });\r\n        }\r\n\r\n        if (properties.dataType !== 8 && bizagi.override.removeTrailingZeros === true) {\r\n            var value = self.numericInput.val();\r\n            var positive = true;\r\n\r\n            if (value.indexOf(\")\") !== -1) {\r\n                positive = false;\r\n                value = value.replace(\"(\", \"\").replace(\")\", \"\")\r\n            }\r\n\r\n            var regExp = new RegExp(\"(\" + properties.decimalSymbol + \"\\\\d*?[1-9])0+$\", \"g\");\r\n            value = value.replace(regExp, \"$1\")\r\n\r\n            regExp = new RegExp(\"\\\\\" + properties.decimalSymbol + \"0+$\", \"g\");\r\n            value = value.replace(regExp, \"\");\r\n            self.numericInput.val(value);\r\n\r\n            if (!positive) self.numericInput.val(\"(\" + value + \")\");\r\n        }\r\n\r\n        if (properties.percentage)\r\n            self.numericInput.val(self.numericInput.val() + '%');\r\n    },\r\n\r\n    /**\r\n     * Returns the display value of the render\r\n     * @returns {*}\r\n     */\r\n    getDisplayValue: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n        var value = self.getValue() !== undefined ? self.getValue() : $(\"input\", control).val() || \"\";\r\n\r\n        // Workaround to get the display value by the format currency plugin, because it requires a control\r\n        var label = $('<label/>').html(value);\r\n\r\n        label.formatCurrency({\r\n            symbol: properties.symbol,\r\n            positiveFormat: properties.positiveFormat,\r\n            negativeFormat: properties.negativeFormat,\r\n            decimalSymbol: properties.decimalSymbol,\r\n            digitGroupSymbol: properties.digitGroupSymbol,\r\n            groupDigits: properties.groupDigits,\r\n            roundToDecimalPlace: properties.numDecimals,\r\n            colorize: properties.colorize\r\n        });\r\n\r\n        if (properties.percentage)\r\n            label = $('<label/>').html(label.text() + '%');\r\n\r\n        // Removing unrequired zeros as requested by BA26331\r\n        if (!properties.editable && properties.dataType !== 8 && bizagi.override.removeTrailingZeros === true) {\r\n            value = label.text();\r\n            var positive = true;\r\n\r\n            if (value.toString().indexOf(\")\") !== -1) {\r\n                positive = false;\r\n                value = value.replace(\"(\", \"\").replace(\")\", \"\");\r\n            }\r\n\r\n            var re = new RegExp(\"(\" + properties.decimalSymbol + \"\\\\d*?[1-9])0+$\", \"g\");\r\n            value = value.replace(re, \"$1\");\r\n\r\n            re = new RegExp(\"\\\\\" + properties.decimalSymbol + \"0+$\", \"g\");\r\n            value = value.replace(re, \"\");\r\n\r\n            if (!positive) value = \"(\" + value + \")\";\r\n            return value;\r\n        }\r\n\r\n        return label.text();\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param invalidElements\r\n     * @returns {*}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        var bValid = this._super(invalidElements);\r\n        var value = self.getValue();\r\n        var message;\r\n        var minValue = self.getMinValue();\r\n        var maxValue = self.getMaxValue();\r\n\r\n        if (typeof (value) == \"string\" && value != \"\") {\r\n            value = Number(value);\r\n        }\r\n\r\n        // Check min value\r\n        if (self.hasValue()) {\r\n            if (!bizagi.util.isEmpty(minValue)) {\r\n                if (value < minValue) {\r\n                    message = this.getResource(\"render-numeric-minimum-validation\").replaceAll(\"#label#\", properties.displayName.toString() + \" (\" + value + \")\").replaceAll(\"#minValue#\", minValue.toString());\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    bValid = false;\r\n                }\r\n            }\r\n            // Check max value\r\n            if (!bizagi.util.isEmpty(maxValue)) {\r\n                if (value > maxValue) {\r\n                    message = this.getResource(\"render-numeric-maximum-validation\").replaceAll(\"#label#\", properties.displayName.toString() + \" (\" + value + \")\").replaceAll(\"#maxValue#\", maxValue.toString());\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    bValid = false;\r\n                }\r\n            }\r\n\r\n        }\r\n\r\n        if (self.isValidRender === false && !(bValid && bizagi.util.isMobileDevice())) {\r\n            bValid = false;\r\n            var validMessage = self.isValidRenderMessage ? self.isValidRenderMessage : \"error\";\r\n            invalidElements.push({xpath: properties.xpath, message: validMessage});\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * Get minimum value\r\n     * @returns {*}\r\n     */\r\n    getMinValue: function () {\r\n        var minValue = this.properties.minValue;\r\n\r\n        if (minValue !== undefined && minValue !== null)\r\n            return minValue;\r\n\r\n        return this.properties.dataTypeMinValue;\r\n    },\r\n\r\n    /**\r\n     * Get maximum value\r\n     * @returns {*}\r\n     */\r\n    getMaxValue: function () {\r\n        var maxValue = this.properties.maxValue;\r\n\r\n        if (maxValue !== undefined && maxValue !== null)\r\n            return maxValue;\r\n\r\n        return this.properties.dataTypeMaxValue;\r\n    },\r\n\r\n    /**\r\n     * Return the allow decimals default property based on the datatype\r\n     * @param dataType\r\n     * @returns {boolean}\r\n     */\r\n    getDefaultAllowDecimals: function (dataType) {\r\n        if (dataType) {\r\n            // Integer data types\r\n            if (dataType === 1 || dataType === 2 || dataType === 3 || dataType === 4 || dataType === 7) {\r\n                return false;\r\n            }\r\n            // Decimal and money data types\r\n            if (dataType === 6 || dataType === 8 || dataType === 10 || dataType === 11) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    },\r\n    /**\r\n     * Return the group digits default property based on the datatype\r\n     * @param dataType\r\n     * @returns {boolean}\r\n     */\r\n    getDefaultGroupDigits: function (dataType) {\r\n        if (dataType) {\r\n            // Integer data types\r\n            if (dataType === 1 || dataType === 2 || dataType === 3 || dataType === 4 || dataType === 7) {\r\n                return false;\r\n            }\r\n\r\n            // Decimal data types\r\n            if (dataType === 6 || dataType === 8 || dataType === 10 || dataType === 11) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Return the group digits default property based on digitGroupSymbol\r\n     * @returns {*}\r\n     */\r\n    setGroupDigits: function () {\r\n        var self = this;\r\n        if (typeof (self.properties.thousands) !== \"undefined\") {\r\n            if (self.properties.digitGroupSymbol) { //some cultures\r\n                return bizagi.util.parseBoolean(self.properties.thousands);\r\n            } else {\r\n                return false;\r\n            }\r\n        } else if (self.properties.digitGroupSymbol) { //some cultures\r\n            return this.getDefaultGroupDigits(self.properties.dataType);\r\n        } else {\r\n            return false;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Calculate Minimum Value\r\n     * @param dataType\r\n     * @returns {*}\r\n     */\r\n    calculateMinValue: function (dataType) {\r\n        if (dataType === 8 || dataType === 10) {\r\n            return -922337203685477; // Money\r\n        }\r\n        if (dataType === 4) {\r\n            return 0; // tinyint\r\n        }\r\n        if (dataType === 3) {\r\n            return -32768; // smallint\r\n        }\r\n        if (dataType === 2) {\r\n            return -2147483648; // int\r\n        }\r\n        if (dataType === 1) {\r\n            return -999999999999999; // bigint\r\n        }\r\n        return null;\r\n    },\r\n\r\n    /**\r\n     * Calculate Maximum Value\r\n     * @param dataType\r\n     * @returns {*}\r\n     */\r\n    calculateMaxValue: function (dataType) {\r\n        if (dataType === 8 || dataType === 10) {\r\n            return 922337203685477; // Money\r\n        }\r\n        if (dataType === 4) {\r\n            return 255; // tinyint\r\n        }\r\n        if (dataType === 3) {\r\n            return 32767; // smallint\r\n        }\r\n        if (dataType === 2) {\r\n            return 2147483647; // int\r\n        }\r\n        if (dataType === 1) {\r\n            return 999999999999999; // bigint\r\n        }\r\n        return null;\r\n    },\r\n\r\n    changeMinValue: function (value) {\r\n        var self = this;\r\n        var newValue = Number(value);\r\n\r\n        self.properties.minValue = self.properties.dataTypeMinValue = Number.isNaN(newValue) ? self.calculateMinValue(self.properties.dataType) : newValue;\r\n    },\r\n\r\n    changeMaxValue: function (value) {\r\n        var newValue = Number(value);\r\n\r\n        this.properties.maxValue = this.properties.dataTypeMaxValue = Number.isNaN(newValue) ? this.calculateMaxValue(this.properties.dataType) : newValue;\r\n    },\r\n\r\n    createTooltip: function (control, currentValue, currentTitle) {\r\n        control.data(\"oldValue\", currentValue);\r\n        control.val(\"\");\r\n\r\n        try {\r\n            // Destroy tooltips\r\n            control.tooltip(\"destroy\");\r\n        } catch (e) {\r\n        }\r\n\r\n        control.attr(\"title\", currentTitle);\r\n        control.tooltip();\r\n\r\n        var toolTipZindex = $.getMaxZindex();\r\n        control.tooltip().on(\"tooltipopen\", function (event, ui) {\r\n            ui.tooltip.zIndex(toolTipZindex);\r\n        });\r\n\r\n        // Create new tooltip\r\n        control.tooltip(\"open\");\r\n\r\n        setTimeout(function () {\r\n            control.focus();\r\n        }, 100);\r\n    }\r\n});\r\n\r\n","\r\n/*\r\n*   Name: Bizagi Render Number Scientific notation Class\r\n*   Author: Laura Ariza\r\n*   Comments:\r\n*   -   This script will define basic stuff for scientific notation numbers\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.numberScientificNotation\", {\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function(data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = self.properties;\r\n\r\n        properties.decimalSymbol = typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\"\r\n            ? BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator : format.decimalSymbol;\r\n    },\r\n\r\n    renderControl: function() {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"numberScientificNotation\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {});\r\n        return html;\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        self.numericInput = control.find(\"input\");\r\n        // Add numeric plugin to avoid invalid keystrokes\r\n        self.numericInput.numericSN(self.properties.decimalSymbol);\r\n\r\n    },\r\n\r\n    getDisplayValue: function() {\r\n        var self = this;\r\n        return self.getValue().replace('.', self.properties.decimalSymbol);\r\n    },\r\n\r\n    setValue: function(value) {\r\n        var self = this;\r\n        value = (value || '').toString().replace(self.properties.decimalSymbol, '.');\r\n        self._super(value);\r\n    },\r\n    controlValueIsChanged: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var value = self.getValue() || \"\";\r\n        var compareValue = properties.originalValue || \"\";\r\n        var result = true;\r\n\r\n        // Flag to force to collect data\r\n        if ($.forceCollectData) {\r\n            return true;\r\n        }\r\n        result = (compareValue.toLowerCase() == value.toLowerCase()) ? false : true;\r\n        return result;\r\n    }\r\n\r\n});","/*\r\n*   Name: BizAgi Render Date Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define basic stuff for date renders\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.date\", {}, {\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        var dateFormat = this.getResource(\"dateFormat\");\r\n        var timeFormat = this.getResource(\"timeFormat\");\r\n\r\n        // We will hold here the value to display\r\n        properties.displayValue = \"\";\r\n        properties.showTime = properties.showTime !== undefined ? bizagi.util.parseBoolean(properties.showTime) : false;\r\n        properties.dateFormat = properties.dateFormat || dateFormat;\r\n        properties.timeFormat = properties.timeFormat || timeFormat;\r\n        properties.fullFormat = properties.dateFormat;\r\n\r\n        // Check if it has the showtime property\r\n        if (properties.showTime) {\r\n            if (properties.fullFormat.search(/[h|H]+/ig) === -1) {\r\n                properties.fullFormat = properties.fullFormat + ' ' + properties.timeFormat;\r\n            }\r\n        }\r\n\r\n        // Read always parameter from server in invariant format\r\n        if (properties.value) {\r\n\r\n            var date = bizagi.util.dateFormatter.getDateFromInvariant(properties.value, properties.showTime);\r\n            // Format date to current format\r\n            if (date != 0) {\r\n                // Value must always hold the value with invariant format\r\n                self.value = properties.value;\r\n                var datePickerRegional = bizagi.localization.getResource(\"datePickerRegional\");\r\n                properties.displayValue = bizagi.util.dateFormatter.formatDate(date, properties.fullFormat, datePickerRegional);\r\n            } else {\r\n                self.value = null;\r\n            }\r\n        }\r\n    },\r\n    \r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"date\");\r\n        var indexDateTimeSeparation = properties.dateFormat.substring(0, properties.dateFormat.indexOf(\":\")).lastIndexOf(\" \");\r\n        var dateFormat = (indexDateTimeSeparation > 0) ? properties.dateFormat.substring(0, indexDateTimeSeparation) : properties.dateFormat;\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            showTime: properties.showTime,\r\n            value: properties.value,\r\n            editable: properties.editable,\r\n            dateFormat: bizagi.override && bizagi.override.uppercaseDatePlaceholder === true ? dateFormat.toUpperCase() : dateFormat,\r\n            timeFormat: (properties.showTime && indexDateTimeSeparation > 0) ? properties.dateFormat.substring(indexDateTimeSeparation) : \"\",\r\n            rtl: (properties.orientation == \"rtl\")\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function (intHandler, isNow) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set control references\r\n        var dateControl = self.getDateControl();\r\n        var timeControl = self.getTimeControl();\r\n\r\n        // Set mask\r\n        if (properties.mask) {\r\n            dateControl.mask({\r\n                mask: properties.mask\r\n            });\r\n        }\r\n\r\n        // Attach change event\r\n        dateControl.bind(\"change\", function () {\r\n            self.onChangeHandler();\r\n        });\r\n        if (properties.showTime) {\r\n            timeControl.bind(\"change\", function (e, isNow) {\r\n                if (self.updatingTime) {\r\n                    delete self.updatingTime;\r\n                    return;\r\n                }\r\n                self.onChangeHandler(isNow);\r\n            });\r\n        }\r\n    },\r\n\r\n    /* \r\n    *   Formats the date time value to the hidden control\r\n    */\r\n    onChangeHandler: function () {\r\n    },\r\n\r\n    getDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var displayValue;\r\n\r\n        if (!properties.displayValue && value) {\r\n            var date = bizagi.util.dateFormatter.getDateFromInvariant(value, properties.showTime);\r\n            var datePickerRegional = bizagi.localization.getResource(\"datePickerRegional\");\r\n            displayValue = bizagi.util.dateFormatter.formatDate(date, properties.fullFormat, datePickerRegional);\r\n        } else {\r\n            displayValue = \"\";\r\n        }\r\n\r\n        // We can return the display value isntance\r\n        return properties.displayValue || displayValue || \"\";\r\n    },\r\n\r\n    /*\r\n    *   Add the render data to the given collection in order to send data to the server\r\n    */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Add the render value\r\n        var xpath = properties.xpath;\r\n        var value = self.getValue();\r\n\r\n        if (self.controlValueIsChanged()) {\r\n            // Filter by valid xpaths and valid values\r\n            if (!bizagi.util.isEmpty(xpath)) {\r\n                if (!bizagi.util.isEmpty(value)) {\r\n                    // Formats the value in full invariant (with time) in order to send to the server\r\n                    var date = bizagi.util.dateFormatter.getDateFromInvariant(value, properties.showTime);\r\n                    if (typeof (date) != \"undefined\")\r\n                        if (date !== 0) {\r\n                            if (!properties.showTime) {\r\n                                date.setHours(0, 0, 0, 0);\r\n                            }\r\n                            renderValues[properties.xpath] = bizagi.util.dateFormatter.formatInvariant(date, true);\r\n                        }\r\n                } else if (value === \"\") {\r\n                    renderValues[properties.xpath] = \"\";\r\n                }\r\n            }\r\n\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Gets the date control\r\n    */\r\n    getDateControl: function () { },\r\n\r\n    /*\r\n    *   Gets the time control\r\n    */\r\n    getTimeControl: function () { },\r\n\r\n    /* \r\n    * Public method to determine if a value is valid or not\r\n    */\r\n    isValid: function (invalidElements) {\r\n        var self = this,\r\n        properties = self.properties;\r\n\r\n        // Call base\r\n        var bValid = this._super(invalidElements);\r\n        var value = self.getValue();\r\n        if (value) {\r\n            if (bizagi.util.parseBoolean(properties.editable) === true) {\r\n                value = bizagi.util.dateFormatter.getDateFromInvariant(value, properties.showTime);\r\n                var message;\r\n\r\n                // Check that we have a valid data\r\n                if (value != 0) {\r\n                    // Clear seconds and milliseconds for validations\r\n                    value.setSeconds(0);\r\n                    value.setMilliseconds(0);\r\n\r\n                    // Check min value\r\n                    if (properties.minValue && (typeof properties.minValue === 'string' || typeof properties.minValue == 'number')) {\r\n                        var minValue = typeof properties.minValue == 'string' ? bizagi.util.dateFormatter.getDateFromInvariant(properties.minValue, properties.showTime) : new Date(properties.minValue);\r\n                        minValue.setSeconds(0);\r\n                        minValue.setMilliseconds(0);\r\n\r\n                        if (value < minValue) {\r\n                            message = this.getResource(\"render-date-minimum-validation\").replaceAll(\"#label#\", properties.displayName).replaceAll(\"#minValue#\", bizagi.util.dateFormatter.formatDate(minValue, properties.fullFormat));\r\n                            invalidElements.push({\r\n                                xpath: properties.xpath,\r\n                                message: message\r\n                            });\r\n                            bValid = false;\r\n                        }\r\n                    }\r\n\r\n                    // Check max value\r\n                    if (properties.maxValue && (typeof properties.maxValue == 'string' || typeof properties.maxValue == 'number')) {\r\n                        var maxValue = typeof properties.maxValue == 'string' ? bizagi.util.dateFormatter.getDateFromInvariant(properties.maxValue, properties.showTime) : new Date(properties.maxValue);\r\n                        maxValue.setSeconds(0);\r\n                        maxValue.setMilliseconds(0);\r\n\r\n                        if (value > maxValue) {\r\n                            message = this.getResource(\"render-date-maximum-validation\").replaceAll(\"#label#\", properties.displayName).replaceAll(\"#maxValue#\", bizagi.util.dateFormatter.formatDate(maxValue, properties.fullFormat));\r\n                            invalidElements.push({\r\n                                xpath: properties.xpath,\r\n                                message: message\r\n                            });\r\n                            bValid = false;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Check that both controls (data and time) are filled out\r\n        if (properties.showTime) {\r\n            if (bizagi.util.parseBoolean(properties.editable) === true) {\r\n                // Check required\r\n                if (properties.required && self.hasValue()) {\r\n\r\n                    // Check both controls\r\n                    var dateControl = self.getDateControl();\r\n                    var timeControl = self.getTimeControl();\r\n\r\n                    // If date is filled but time is not ... show validation\r\n                    if (dateControl.length > 0 && timeControl.length > 0) {\r\n                        if (dateControl.val().length > 0 && timeControl.val().length == 0) {\r\n                            message = self.getResource(\"render-required-text\").replaceAll(\"#label#\", properties.displayName);\r\n                            invalidElements.push({\r\n                                xpath: properties.xpath,\r\n                                message: message\r\n                            });\r\n                            return false;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return bValid;\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Text Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for text renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.extendedText\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Check if offline forms is supported\r\n        this.isOfflineForm = bizagi.util.isOfflineForm({context: self});\r\n        this.hasMaxLines = this.properties.maxLines ? true : false;\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        // Fill default properties\r\n        properties.maxLines = this.properties.maxLines || 6;\r\n\r\n        if (properties.regularExpressionExpression) {\r\n            var message = properties.regularExpressionMessage || self.getResource(\"render-text-regular-expression-default-message\");\r\n\r\n            properties.regularExpression = {\"expression\": properties.regularExpressionExpression, \"message\": message};\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var template = this.renderFactory.getTemplate(\"extendedText\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            isEmptyField: typeof (this.properties.value) === \"undefined\",\r\n            editable: this.properties.editable\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        self._super();\r\n\r\n        var control = self.getControl();\r\n        self.textarea = control.find(\"textarea\");\r\n\r\n        // If is textarea, then enable resize element.\r\n        if (self.textarea) {\r\n            self.textarea.css({resize: \"both\"});\r\n        } else {\r\n            self.textarea.css({resize: \"none\"});\r\n        }\r\n\r\n        // Attach event for retype double\r\n        if (self.properties.retype === \"double\")\r\n            self.attachRetypeDouble();\r\n    },\r\n\r\n    /**\r\n     * Function virtual implements on children (desktop,samrtphone...).\r\n     */\r\n    attachRetypeDouble: function () {\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set the default maxlength for the input if is 0 or undefined set to infinity\r\n        // this resolve issue with scope strings that don't have maxlength\r\n        if (properties.maxLength)\r\n            self.textarea.prop('maxlength', properties.maxLength);\r\n\r\n        if (properties.maxLines) {\r\n            self.textarea.prop('rows', properties.maxLines)\r\n        } else {\r\n            self.textarea.prop('rows', 6);\r\n        }\r\n\r\n        // Attach change event\r\n        self.textarea.bind(\"change\", function () {\r\n\r\n            // Updates internal value\r\n            self.setValue(self.textarea.val());\r\n\r\n            // Check that the value is valid\r\n            var validationMessages = [];\r\n            if (properties.retype !== \"duplicate\") {\r\n                if (self.isValid(validationMessages) || typeof (properties.regularExpression) === \"undefined\") {\r\n                    // Update value again triggering handlers\r\n                    self.setValue(self.textarea.val(), true);\r\n                } else {\r\n                    // Set error message\r\n                    var message = validationMessages[0].message;\r\n                    bizagi.showMessageBox(message, \"Bizagi\", \"error\");\r\n                }\r\n            }\r\n        });\r\n\r\n        // Attach blur event\r\n        self.textarea.bind(\"blur\", function () {\r\n            // Updates internal value\r\n            self.setValue(self.textarea.val());\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param {} invalidElements\r\n     * @returns {}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var message;\r\n\r\n        // Call base\r\n        var bValid = this._super(invalidElements);\r\n        var value = self.getValue();\r\n        var regEx = new RegExp(\".*?(<|\\\\u003C)(.+?)(>|\\\\u003E)(.?)|eval\\\\(|eval\\\\u0028\", \"g\");\r\n\r\n        // Offline capability\r\n        if (this.isOfflineForm && bizagi.util.isMobileDevice()) {\r\n            value = value && typeof (value) === \"object\" && value.value ? value.value : value;\r\n        }\r\n\r\n        // Check regular expression\r\n        if (properties.regularExpression) {\r\n\r\n            if (value && ((value.match(regEx)) || (!value.match(new RegExp(properties.regularExpression.expression)) && (self.properties && self.properties.xpath === \"userName\")))) {\r\n                message = properties.regularExpression.message;\r\n                invalidElements.push({xpath: properties.xpath, message: message});\r\n                bValid = false;\r\n            } else {\r\n                if (value && ((value.match(regEx)) || (!value.match(new RegExp(properties.regularExpression.expression))))) {\r\n                    message = properties.regularExpression.message;\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    bValid = false;\r\n                }\r\n            }\r\n        } else {\r\n            if (value && (value.match(new RegExp(\".*?eval\\\\(\", \"g\"))) && (value.match(new RegExp(\".*?eval\\\\u0028\", \"g\")))) {\r\n                if (properties.editable) {\r\n                    message = this.getResource(\"render-text-regular-expression-default-message\");\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    bValid = false;\r\n                }\r\n            }\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param {} value\r\n     * @returns {}\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var decodedValue = bizagi.util.decodeURI(value);\r\n\r\n        if (self.properties.editable == false) {\r\n            // Render as simple value\r\n            if (typeof (value) == \"string\") {\r\n\r\n                // Replace line breaks for html line breaks\r\n                var valueToDisplay = bizagi.util.decodedDisplayValue(self.getDisplayValue());\r\n\r\n                control.html(valueToDisplay);\r\n            }\r\n        }\r\n\r\n        // Set internal value\r\n        self.setValue(decodedValue, false);\r\n    },\r\n\r\n    /**\r\n     * Add the render data to the given collection in order to send data to the server\r\n     * @param {} renderValues\r\n     * @returns {}\r\n     */\r\n    collectData: function (renderValues) {\r\n        // Call base\r\n        this._super(renderValues);\r\n    },\r\n\r\n    /**\r\n     * Extend setValue to fix all encode data from database\r\n     * More information SUITE-9407\r\n     * @param {} value\r\n     * @returns {}\r\n     */\r\n    setValue: function (value) {\r\n        var decodedValue = bizagi.util.decodeURI(value);\r\n\r\n        this._super(decodedValue);\r\n    },\r\n\r\n    /**\r\n     * Helptext tooltip\r\n     * @param {} control\r\n     * @param {} currentValue\r\n     * @param {} currentTitle\r\n     */\r\n    createTooltip: function (control, currentValue, currentTitle) {\r\n        control.data(\"oldValue\", currentValue);\r\n        control.val(\"\");\r\n\r\n        try {\r\n            // Destroy tooltips\r\n            control.tooltip(\"destroy\");\r\n        } catch (e) {\r\n        }\r\n\r\n        control.attr(\"title\", currentTitle);\r\n        control.tooltip();\r\n\r\n        var toolTipZindex = $.getMaxZindex();\r\n        control.tooltip().on(\"tooltipopen\", function (event, ui) {\r\n            ui.tooltip.zIndex(toolTipZindex);\r\n        });\r\n\r\n        // Create new tooltip\r\n        control.tooltip(\"open\");\r\n\r\n        setTimeout(function () {\r\n            control.focus();\r\n        }, 100);\r\n    },\r\n\r\n    //#region No side effects funtions    \r\n    /**\r\n     * Gets the string with the correct size\r\n     * @param {string} value String value to validate\r\n     * @param {Int} maxLength Maximum size of the string\r\n     * @returns {string} String value validated\r\n     */\r\n    validateValue: function (value, maxLength) {\r\n        if(maxLength<1 || value.length<=maxLength)return value;\r\n        return value.substr(0, maxLength)\r\n    }\r\n    //#endregion No side effects funtions\r\n});\r\n","/*\r\n *   Name: Bizagi Render Grid Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for grids\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.grid\", {}, {\r\n\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        self.originalData = bizagi.clone(data.properties);\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        self.initProperties();\r\n\r\n        // Set columns\r\n        var areThereEditableColumns;\r\n        var areThereTotalizedColumns;\r\n        self.columns = [];\r\n        self.columnsIds = [];\r\n        self.enabledChecks = {};\r\n        self.exclusiveChanges = {};\r\n        self.originalEnabledChecks = [];\r\n        $.each(data.elements, function (i, column) {\r\n            var columnProperties = column.render.properties;\r\n\r\n            // the groupby property is taken of column\r\n            if (columnProperties.groupBy) {\r\n                properties.groupBy = columnProperties.xpath || \"\";\r\n                properties.allowGrouping = !bizagi.util.isEmpty(properties.groupBy) ? true : false;\r\n            }\r\n            if (columnProperties.type === \"columnLabel\") {\r\n                self.spliceRowData(data.properties.data, i + 1);\r\n            }\r\n\r\n            if (columnProperties.type === \"columnBoolean\" && columnProperties.isExclusive) {\r\n                var params = {\r\n                    xpath: columnProperties.xpath\r\n                };\r\n                if (data.properties.data) {\r\n                    self.enabledChecks[columnProperties.xpath] = [];\r\n                    for (var j = 0; j < data.properties.data.rows.length; j++) {\r\n                        var row = data.properties.data.rows[j];\r\n                        var item = row[i + 1];\r\n                        if (item) {\r\n                            self.originalEnabledChecks.push(row[0]);\r\n                            self.enabledChecks[columnProperties.xpath].push([row[0], item]);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            // If inlineEdit is false then all columns must be read only\r\n            if (!self.properties.inlineEdit) {\r\n                column.render.properties.editable = false;\r\n            }\r\n\r\n            // Create renderColumns\r\n            var columnRender = self.renderFactory.getColumn({\r\n                type: columnProperties.type,\r\n                data: column.render,\r\n                parent: self,\r\n                singleInstance: properties.singleInstance\r\n            });\r\n\r\n            self.columns.push(columnRender);\r\n            self.columnsIds.push(column.render.properties.id);\r\n\r\n            if (columnProperties.editable) {\r\n                areThereEditableColumns = true;\r\n            }\r\n\r\n            if (columnProperties.totalize && columnProperties.totalize.operation) {\r\n                areThereTotalizedColumns = true;\r\n\r\n                // Default summary format\r\n                columnProperties.totalize.format = columnProperties.totalize.format || {};\r\n                columnProperties.totalize.format.bold = columnProperties.totalize.format.bold !== undefined ? columnProperties.totalize.format.bold : true;\r\n            }\r\n        });\r\n\r\n        // Reverse columns when using right to left orientation\r\n        if (properties.orientation === \"rtl\")\r\n            self.columns = self.columns.reverse();\r\n\r\n        // Turn off inline edit if there are any editable columns        \r\n        if (properties.inlineEdit && !areThereEditableColumns) {\r\n            properties.inlineEdit = false;\r\n            properties.allowEdit = false;\r\n        }\r\n\r\n        // Check if the grid has totalizers\r\n        if (areThereTotalizedColumns) {\r\n            properties.showSummary = true;\r\n            properties.rowsPerPage = 0;\r\n        }\r\n    },\r\n\r\n    initProperties: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var properties = self.properties;\r\n\r\n        /** Edit properties\r\n         * @default editable true\r\n         */\r\n        properties.editable = bizagi.util.parseBoolean(properties.editable) || false;\r\n        properties.allowEdit = bizagi.util.parseBoolean(properties.allowEdit) != null ? bizagi.util.parseBoolean(properties.allowEdit) : true;\r\n        properties.inlineEdit = bizagi.util.parseBoolean(properties.inlineEdit) != null ? bizagi.util.parseBoolean(properties.inlineEdit) : true;\r\n        properties.withEditForm = bizagi.util.parseBoolean(properties.withEditForm) != null ? bizagi.util.parseBoolean(properties.withEditForm) : false;\r\n\r\n        /** Add properties\r\n         * @default  allowAdd true\r\n         */\r\n        properties.allowAdd = bizagi.util.parseBoolean(properties.allowAdd) != null ? bizagi.util.parseBoolean(properties.allowAdd) : true;\r\n        properties.inlineAdd = (properties.allowAdd) ? (bizagi.util.parseBoolean(properties.inlineAdd) != null) ? bizagi.util.parseBoolean(properties.inlineAdd) : true : false;\r\n\r\n        /* Define Delete properties */\r\n        properties.allowDelete = bizagi.util.parseBoolean(properties.allowDelete) != null ? bizagi.util.parseBoolean(properties.allowDelete) : true;\r\n\r\n        /* Define details properties*/\r\n        properties.allowDetail = bizagi.util.parseBoolean(properties.allowDetail) != null ? bizagi.util.parseBoolean(properties.allowDetail) : false;\r\n\r\n        /* Define general properties */\r\n        properties.keyColumn = \"\";\r\n        properties.data = properties.data || null;\r\n        properties.displayType = \"value\";\r\n        properties.skipInitialLoad = properties.skipInitialLoad || false;\r\n        properties.allowMore = bizagi.util.parseBoolean(properties.allowMore) || false;\r\n        properties.allowFilter = bizagi.util.parseBoolean(properties.allowFilter) || false;\r\n        properties.allowGrouping = false;\r\n        properties.groupBy = \"\";\r\n        properties.groupSummary = properties.groupSummary || null;\r\n        properties.groupText = this.getResource(\"render-grid-group-text\");\r\n        properties.groupCollapsed = bizagi.util.parseBoolean(properties.groupCollapsed) || false;\r\n        properties.groupOrder = properties.groupOrder || \"asc\";\r\n        properties.formShowMode = bizagi.util.parseBoolean(properties.formShowMode) || \"popup\";\r\n        properties.floatingHeader = bizagi.util.parseBoolean(properties.floatingHeader) || false;\r\n\r\n        properties.sortBy = properties.sortBy ? properties.sortBy : properties.data && properties.data.sort ? properties.data.sort : properties.keyColumn;\r\n        properties.sortOrder = properties.sortOrder !== undefined && properties.sortOrder !== null ? (properties.sortOrder === \"True\" ? \"asc\" : \"desc\") : properties.data && properties.data.order ? properties.data.order : \"asc\";\r\n        properties.sort = properties.sortBy + \" \" + properties.sortOrder;\r\n\r\n        properties.rowsPerPage = properties.allowGrouping ? 1000 : (properties.rowsPerPage || 20);\r\n        properties.page = 1;\r\n        properties.records = 0;\r\n        properties.totalPages = 0;\r\n\r\n        properties.addLabel = properties.addLabel || this.getResource(\"render-grid-add-label\") + properties.displayName;\r\n        properties.editLabel = properties.editLabel || $.trim(this.getResource(\"render-grid-edit-label\")) + \" \" + properties.displayName;\r\n        properties.deleteLabel = properties.deleteLabel || this.getResource(\"render-ecm-confirm-bt-delete\") + \" \" + properties.displayName;\r\n        properties.exportOptionsLabel = properties.exportOptionsLabel || this.getResource(\"render-grid-export-options-label\") + properties.displayName;\r\n        properties.detailLabel = properties.detailLabel || this.getResource(\"render-collection-navigator-details-form\");\r\n\r\n\r\n        // Apply style to entire table\r\n        properties.tableCssClass = properties.cssClass || \"\";\r\n\r\n        properties.alreadySaved = false;\r\n\r\n        // When grid open in modal window and the parent is entity\r\n        if (properties.contexttype != \"entity\") {\r\n            properties.contexttype = (typeof self.parent.getContextType == 'function') ? self.parent.getContextType() : \"\";\r\n        }\r\n\r\n        // Define if it is editable or not        \r\n        /* This part change all cells in the table to no editable,\r\n         * you must use it when the parent container has noeditable property,\r\n         * so this table is noeditable too.\r\n         */\r\n        try {\r\n            if ((self.parent && typeof self.parent.properties.editable == \"boolean\" && !self.parent.properties.editable) || !properties.editable) {\r\n                properties.allowAdd = false;\r\n                properties.allowEdit = false;\r\n                properties.allowDelete = false;\r\n                properties.inlineEdit = false;\r\n                properties.inlineAdd = false;\r\n                properties.editable = false;\r\n            }\r\n        } catch (e) {\r\n        }\r\n\r\n\r\n        // If grid has not allowEdit property in true, all fields within the grid\r\n        // must be no editables, so these lines changes this behavior\r\n        if (!properties.allowEdit || (!properties.inlineEdit && !properties.withEditForm)) {\r\n            properties.editable = false;\r\n        }\r\n\r\n        // Calculate render width\r\n        properties.labelWidth = 0;\r\n        properties.valueWidth = \"100%\";\r\n\r\n        // This property will be used to make custom grids with another data source\r\n        properties.overrideGetRemoteData = properties.overrideGetRemoteData || undefined;\r\n        //this property use to create a single decorated or a array of decorated\r\n        properties.singleInstance = bizagi.util.isEmpty(properties.singleInstance) ? true : properties.singleInstance;\r\n\r\n        // Check if the grid its opened whitin dialog form and has contextType\r\n        properties.contextType = (form.params && form.params.data && form.params.data.contextType) ? form.params.data.contextType : null;\r\n\r\n        // Create a collection to collect changes\r\n        self.changes = {};\r\n\r\n        // Create a collection to override properties per cell\r\n        self.cellOverrides = {};\r\n\r\n\r\n        // Check orientation and change order of data if its necesary (rtl)\r\n        if (self.isRTL() && properties.data != null) {\r\n            properties.data.rows = self.changeOrderData(properties.data.rows);\r\n        }\r\n    },\r\n\r\n    /*\r\n   *   Check if a render has no value for required validation\r\n   */\r\n    hasValue: function () {\r\n        return this.properties.data && this.properties.data.rows.length > 0;\r\n    },\r\n\r\n    isRTL: function () {\r\n        var properties = this.properties;\r\n        if (!properties) return true;\r\n        return (typeof properties.orientation == \"string\" && properties.orientation.toUpperCase() == \"RTL\") ? true : false;\r\n    },\r\n    changeOrderData: function (data) {\r\n        var reverseDataRows = [];\r\n        var rows = data || [];\r\n        var rowKey;\r\n\r\n        $.each(rows, function (key, value) {\r\n            // Extract row key\r\n            rowKey = value.shift();\r\n            reverseDataRows = value.reverse();\r\n            // add element in the start\r\n            reverseDataRows.unshift(rowKey);\r\n\r\n            rows[key] = reverseDataRows;\r\n        });\r\n\r\n        return rows;\r\n    },\r\n\r\n    /**\r\n     * Specific fix RTL with localizated\r\n     * @param data\r\n     * @returns {*|Array}\r\n     */\r\n    removeRemainingColumns: function (data, numColumns) {\r\n        var rows = data || [];\r\n        var remainingColumns = 0;\r\n        if (rows.length > 0) {\r\n            // \"- 1\" because the first column represent id row\r\n            remainingColumns = rows[0].length - numColumns - 1;\r\n        }\r\n        if (remainingColumns > 0) {\r\n            $.each(rows, function (key, value) {\r\n                // Remove remaining columns\r\n                for (var i = 0; i < remainingColumns; i++) {\r\n                    value.pop();\r\n                }\r\n            });\r\n        }\r\n        return rows;\r\n    },\r\n\r\n    /* \r\n     *   Gets a column definition by xpath\r\n     */\r\n    getColumn: function (xpath) {\r\n        var self = this;\r\n        var result = null;\r\n        $.each(self.columns, function (i, column) {\r\n            if (column.properties.xpath == xpath || column.properties.id == xpath) {\r\n                result = column;\r\n            }\r\n        });\r\n\r\n        return result;\r\n    },\r\n\r\n    getColumnType: function (id) {\r\n        var self = this;\r\n        var columnIndex = self.columnsIds.indexOf(id);\r\n\r\n        if (columnIndex != -1) {\r\n            return self.columns[columnIndex].properties.type;\r\n        }\r\n\r\n        return null;\r\n    },\r\n\r\n    /*\r\n     *   Template method to implement in each children to customize each control\r\n     *   Returns a promise that will be resolved when all the columns has been loaded\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var defer = new $.Deferred();\r\n\r\n        // Set dummy data when not in execution mode\r\n        var mode = self.getMode();\r\n        if (mode !== \"execution\") {\r\n            properties.data = self.getDummyData();\r\n        }\r\n\r\n        var template = self.getGridTemplate();\r\n\r\n        // Render template\r\n        var html = self.applyTemplate(template);\r\n\r\n        // Initialize columns\r\n        var columnInitializers = [];\r\n        $.each(self.columns, function (i, column) {\r\n\r\n            // Add to column initializer array so we can synch out the promises\r\n            var result = column.initialize();\r\n            if (result)\r\n                columnInitializers.push(result);\r\n        });\r\n\r\n        // Resolve when all columns has been loaded\r\n        $.when.apply($, columnInitializers).done(function () {\r\n            defer.resolve(html);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n    /*\r\n     *   Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Call base\r\n        this._super();\r\n\r\n        // Make control to behave as a block container\r\n        // TODO: Move to instances. This does not apply to mobiles\r\n        control.addClass(\"ui-bizagi-render-grid-container\")\r\n            .addClass(\"ui-bizagi-render-display-block\");\r\n    },\r\n\r\n    /*\r\n     *   Returns the grid template to be used\r\n     */\r\n    getGridTemplate: function () {\r\n        return this.renderFactory.getTemplate(\"grid\");\r\n    },\r\n\r\n    /*\r\n     *   Applies the template to the render and returns the resolved element\r\n     */\r\n    applyTemplate: function (template) {\r\n        var self = this,\r\n            properties = self.properties;\r\n        orientation = self.properties.orientation;\r\n\r\n        return $.fasttmpl(template, {\r\n            id: bizagi.util.encodeXpath(properties.xpath),\r\n            displayName: bizagi.util.encodeXpath(properties.displayName),\r\n            allowAdd: properties.allowAdd,\r\n            addLabel: properties.addLabel\r\n        });\r\n    },\r\n    /*\r\n     *   Method to render non editable values\r\n     *   Returns a promise that will be resolved when all the columns has been loaded\r\n     */\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n\r\n        // Override read-only presets\r\n        //  properties.allowAdd = false;\r\n        // Render the same, just change some presets\r\n        return self.renderControl();\r\n    },\r\n    /*\r\n     *   Fetch the data into a deferred\r\n     */\r\n    getRemoteData: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set params\r\n        params = params || {};\r\n        $.extend(params, {\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contextType,\r\n            idPageCache: properties.idPageCache,\r\n            sort: properties.sortBy,\r\n            order: properties.sortType,\r\n            page: properties.page,\r\n            rows: properties.rowsPerPage,\r\n            searchFilter: properties.searchFilter,\r\n            orientation: properties.orientation || \"ltr\"\r\n        });\r\n\r\n        // Check if a custom method has been given\r\n        if (properties.overrideGetRemoteData) {\r\n            return properties.overrideGetRemoteData(params);\r\n        } else {\r\n            // Resolve with remote data\r\n            return self.dataService.multiaction().getGridData(params).then(function (data) {\r\n                self.originalData = self.originalData || {};\r\n                self.originalData.data = bizagi.clone(data);\r\n\r\n                // Resolve with fetched data\r\n                properties.page = data.page;\r\n                properties.records = data.records;\r\n                properties.totalPages = data.totalPages;\r\n\r\n                return data;\r\n            });\r\n        }\r\n    },\r\n    /*\r\n     insert a blank item in the selected column in the data matrix\r\n     */\r\n    spliceRowData: function (data, index) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        if (mode === \"execution\" && (data && data.rows)) {\r\n            $.each(data.rows, function (key, value) {\r\n                var spliceIndex = index || data.rows[key].length;\r\n                data.rows[key].splice(spliceIndex, 0, \"\");\r\n            });\r\n        }\r\n    },\r\n\r\n    spliceRowDataVisible: function(data, index) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        if (mode === \"execution\" && (data && data.visible)) {\r\n            $.each(data.visible, function (key, value) {\r\n                var spliceIndex = index || data.visible[key].length;\r\n                data.visible[key].splice(spliceIndex, 0, true);\r\n            });\r\n        }\r\n    },\r\n\r\n    spliceRowDataEditable: function(data, index) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        if (mode === \"execution\" && (data && data.editable)) {\r\n            $.each(data.editable, function (key, value) {\r\n                var spliceIndex = index || data.editable[key].length;\r\n                data.editable[key].splice(spliceIndex, 0, true);\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Creates a set of dummy data in order to display it when rendering in design or layout mode\r\n     */\r\n    getDummyData: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        if (properties.data) {\r\n            return properties.data;\r\n\r\n        } else {\r\n            var rowTemplate = [\"1\"];\r\n\r\n            // Add a value for each column\r\n            for (var i = 0; i < self.columns.length; i++) {\r\n                rowTemplate.push(\"\");\r\n            }\r\n\r\n            var data = {\r\n                \"page\": 1,\r\n                \"total\": 1,\r\n                \"records\": 1,\r\n                \"rows\": [rowTemplate]\r\n            };\r\n\r\n            return data;\r\n        }\r\n    },\r\n    /*\r\n     *   Submits a grid edit record request for the given id\r\n     *   Returns a deferred\r\n     */\r\n    submitEditRequest: function (id) {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        var xpath = properties.xpath + self.buildCellXpathFilter(id);\r\n\r\n        return self.dataService.editGridRecord({\r\n            url: properties.editUrl,\r\n            idRender: properties.id,\r\n            xpath: xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            contexttype: properties.contextType\r\n        });\r\n    },\r\n    /*\r\n     *   Submits a grid edit record request for the given id\r\n     *   Returns a deferred\r\n     */\r\n    submitSaveRequest: function (id, data) {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        // Check if there are deferreds to wait\r\n        var deferredsToWait = null;\r\n        if (data.deferreds) {\r\n            deferredsToWait = $.when.apply($, data.deferreds);\r\n            delete data.deferreds;\r\n        }\r\n\r\n        // Calculate xpath context\r\n        var xpathContext = properties.xpathContext.length > 0 ? properties.xpathContext + \".\" + properties.xpath + self.buildCellXpathFilter(id) : properties.xpath + self.buildCellXpathFilter(id);\r\n\r\n        return $.when(deferredsToWait).pipe(function () {\r\n            self.startLoading();\r\n            return self.dataService.saveGridRecord({\r\n                url: properties.saveUrl,\r\n                idRender: properties.id,\r\n                xpath: properties.xpath,\r\n                xpathContext: xpathContext,\r\n                submitData: data,\r\n                contexttype: properties.contextType,\r\n                disableServerGridValidations: data.disableServerGridValidations || false\r\n            }).pipe(function (dataResp) {\r\n                self.endLoading();\r\n                return dataResp;\r\n            }).fail(function (dataFail) {\r\n                var form = self.getFormContainer();\r\n                var message = (dataFail.responseText) ? dataFail.responseText : ((typeof dataFail == \"string\") ? dataFail : dataFail.toString());\r\n                //Convert String to object\r\n                if (typeof message == \"string\") {\r\n                    try {\r\n                        message = JSON.parse(message).message;\r\n                    } catch (e) {\r\n                        message = message.match(/\"message\":(.*)\",/)[0];\r\n                        message = message.substr(11, message.length - 13);\r\n                    }\r\n\r\n                } else if (!message.message) {\r\n                    message = dataFail;\r\n                }\r\n                form.validateForm();\r\n                form.clearValidationMessages();\r\n                form.addValidationMessage(message);\r\n            });\r\n        });\r\n    },\r\n    /*\r\n     *   Submits a grid delete record request for the given id\r\n     *   Returns a deferred\r\n     */\r\n    submitDeleteRequest: function (id) {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        var xpath = properties.xpath + self.buildCellXpathFilter(id);\r\n\r\n        return self.dataService.deleteGridRecord({\r\n            url: properties.deleteUrl,\r\n            idRender: properties.id,\r\n            xpath: xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            contexttype: properties.contextType\r\n        }).pipe(function (data) {\r\n            if (data.type == \"validationMessages\") {\r\n                var form = self.getFormContainer();\r\n                var message = data.messages.join(\" \");\r\n                form.failHandler({message: message});\r\n            }\r\n\r\n            return data;\r\n        });\r\n    },\r\n    /*\r\n     *   Submits a grid add record request\r\n     *   Returns a deferred when done, the server returns an id for the new record\r\n     */\r\n    submitAddRequest: function () {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        var request = self.dataService.addGridRecord({\r\n            url: properties.addUrl,\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contextType,\r\n            idPageCache: properties.idPageCache\r\n        });\r\n\r\n        var filterResponse = request.pipe(function (data) {\r\n            // Parses response\r\n            return data.idEntity;\r\n        });\r\n\r\n        return filterResponse.promise();\r\n    },\r\n    /*\r\n     *   Submits a grid rollback request\r\n     *   Returns a deferred when done\r\n     */\r\n    submitRollbackRequest: function (params) {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        return self.dataService.rollbackGridAction({\r\n            url: properties.rollbackUrl,\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: params ? params.idPageCache : properties.idPageCache,\r\n            contexttype: self.properties.contexttype || \"\"\r\n        });\r\n    },\r\n    /*\r\n     *   Collect a single cell change made in the grid to send the data when the user saves the form\r\n     */\r\n    collectGridChange: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n        var id = params.id;\r\n        var xpath = params.xpath;\r\n        var value = params.value;\r\n        var trigger = typeof (params.trigger) !== \"undefined\" ? params.trigger : true;\r\n        var isPressed = params.pressed || false;\r\n\r\n        self.changes[id] = self.changes[id] || {};\r\n        self.changes[id][xpath] = value;\r\n\r\n        if (trigger)\r\n            self.triggerRenderChange({key: id, column: xpath, pressed: isPressed});\r\n    },\r\n    /*\r\n     *   Configures a column to perform a submit on change when the user changes a cell\r\n     */\r\n    configureColumnSubmitOnChange: function (xpath) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Build action\r\n        var action = {\r\n            commands: [{\r\n                xpath: properties.xpath,\r\n                command: 'submit-value',\r\n                argument: 'all'\r\n            }],\r\n            conditions: {\r\n                operator: 'and',\r\n                expressions: [\r\n                    {\r\n                        simple: {\r\n                            operator: 'cell-change',\r\n                            xpath: properties.xpath + '[].' + xpath,\r\n                            argumentType: 'text',\r\n                            argument: xpath\r\n                        }\r\n                    }\r\n                ]\r\n            },\r\n            dependencies: [properties.xpath]\r\n        };\r\n\r\n        // Add action when form ends its rendering\r\n        $.when(self.ready())\r\n            .done(function () {\r\n                var form = self.getFormContainer();\r\n                form.addSubmitAction(xpath, action);\r\n            });\r\n    },\r\n    /*\r\n     *   Add the render data to the given collection in order to send data to the server\r\n     */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var keysToDelete = [];\r\n\r\n        for (var id in self.changes) {\r\n            // Dont collect data from totalizers \r\n            if (id != \"summary\") {\r\n                for (var columnXpath in self.changes[id]) {\r\n                    // Check if the render can submit data\r\n                    if (self.canColumnBeSent(id, columnXpath)) {\r\n                        var xpath = properties.xpath + self.buildCellXpathFilter(id) + \".\" + columnXpath;\r\n                        var columnSimpleXpath = properties.xpath + self.buildCellXpathFilter(id) + \".\" + (columnXpath.substr(columnXpath.lastIndexOf('.') + 1, columnXpath.length) || columnXpath);\r\n                        var value = self.changes[id][columnXpath];\r\n\r\n                        renderValues[xpath] = value;\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Clean changes \r\n            keysToDelete.push(id);\r\n\r\n        }\r\n\r\n        if (self.exclusiveChanges) {\r\n            for (var id in self.exclusiveChanges) {\r\n\r\n                var columnExclusiveChanges = self.exclusiveChanges[id];\r\n                var columnEnabledChecks = self.enabledChecks[id];\r\n                var lengthEnabledChecks = columnEnabledChecks.length;\r\n                if (columnExclusiveChanges && columnEnabledChecks) {\r\n                    for (var i = 0; i < lengthEnabledChecks; i++) {\r\n                        var columnSimpleXpathEnabled = properties.xpath + self.buildCellXpathFilter(self.enabledChecks[id].shift()[0]) + \".\" + id;\r\n                        renderValues[columnSimpleXpathEnabled] = false;\r\n                    }\r\n\r\n                    var columnSimpleXpath = properties.xpath + self.buildCellXpathFilter(columnExclusiveChanges.key) + \".\" + columnExclusiveChanges.xpath;\r\n                    renderValues[columnSimpleXpath] = columnExclusiveChanges.value;\r\n\r\n                }\r\n            }\r\n        }\r\n\r\n        // Clean changes array in order to prevent duplicate data\r\n        // when execute SUBMITDATA in multiaction, that make and error\r\n        // in circular dependencies, specially when we add inline record\r\n        $.each(keysToDelete, function (key, v) {\r\n            delete self.changes[v];\r\n        });\r\n    },\r\n\r\n    hasChanged: function (result) {\r\n        var self = this;\r\n        if (!$.isEmptyObject(self.changes)) {\r\n            result.push(true);\r\n            return true;\r\n        } else {\r\n            if (!$.isEmptyObject(self.exclusiveChanges)) {\r\n                result.push(true);\r\n                return true;\r\n            } else {\r\n                return false;\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Check if a column data can be sent to the server\r\n     */\r\n    canColumnBeSent: function (id, columnXpath) {\r\n        var self = this, i, j, xpath;\r\n        for (i in self.columns) {\r\n            if (self.columns.hasOwnProperty(i)) {\r\n                var column = self.columns[i];\r\n                if (column.properties.type !== \"columnUserfield\") {\r\n                    if (column.properties.xpath == columnXpath) {\r\n                        var cellOverride = self.getCellOverride(id, column.columnIndex - 1);\r\n                        return column.canBeSent(id, cellOverride);\r\n                    }\r\n                } else {\r\n                    for (j in column.properties) {\r\n                        if (column.properties.hasOwnProperty(j)) {\r\n                            if (Object.prototype.toString.apply(column.properties[j]) === \"[object String]\") {\r\n                                xpath = column.properties[j].substr(column.properties[j].lastIndexOf(\".\") + 1);\r\n                                if (xpath === columnXpath) {\r\n                                    return true;\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n\r\n            }\r\n        }\r\n\r\n        return false;\r\n    },\r\n    /* \r\n     *  Method to determine if the render value can be sent to the server or not\r\n     */\r\n    canBeSent: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var displayOnly = bizagi.util.parseBoolean(properties.displayOnly) || false;\r\n\r\n        // The render can be sent if it is \"display only\" and inline Edit is available\r\n        if (!displayOnly && (properties.inlineEdit || properties.inlineAdd || !$.isEmptyObject(self.changes))) {\r\n            return true;\r\n        }\r\n        return false;\r\n    },\r\n    /*\r\n     *   Return the value for a requested cell\r\n     */\r\n    getCellValue: function (key, xpath) {\r\n        var self = this;\r\n        var data = self.properties.data.rows;\r\n        for (var i = 0; i < data.length; i++) {\r\n            if (data[i][0] == key) {\r\n                for (var j = 0; j < self.columns.length; j++) {\r\n                    if (self.columns[j].properties.xpath == xpath) {\r\n                        var result = data[i][j + 1];\r\n                        return result;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return null;\r\n    },\r\n    /*\r\n     *\r\n     */\r\n    getCellCurrentValue: function (key, xpath) {\r\n        var self = this;\r\n\r\n        var control = self.getControlCell(key, xpath);\r\n        if (control && typeof control.getValue === \"function\") {\r\n            return control.getValue();\r\n        }\r\n        return null;\r\n    },\r\n    /*\r\n     *   Gets control\r\n     */\r\n    getControlCell: function (key, xpath) {\r\n        var self = this;\r\n        var control = null;\r\n        if (typeof (self.columns) != \"undefined\")\r\n            for (var j = 0; j < self.columns.length; j++) {\r\n                if (self.columns[j].properties.xpath == xpath || self.columns[j].properties.id == xpath) {\r\n                    control = self.columns[j].getDecorated(key);\r\n                    break;\r\n                }\r\n            }\r\n\r\n\r\n        return control;\r\n    },\r\n\r\n    changeRequired: function (argument) {\r\n        this.properties.required = argument;\r\n        this.changeRequiredLabel(argument);\r\n    },\r\n\r\n    changeRequiredLabel: function (argument) {\r\n        var control = this.getControl();\r\n\r\n        if (control.length > 0) {\r\n            if (this.getMode() !== \"execution\") {\r\n                if (bizagi.util.parseBoolean(argument) == true && this.properties.editable) {\r\n                    control.addClass(\"grid-control-required\");\r\n                } else {\r\n                    control.removeClass(\"grid-control-required\");\r\n                }\r\n            } else {\r\n                if (bizagi.util.parseBoolean(argument) == true && !this.hasValue() && this.properties.editable) {\r\n                    control.addClass(\"grid-control-required\");\r\n                } else {\r\n                    control.removeClass(\"grid-control-required\");\r\n                }\r\n            }\r\n        }\r\n\r\n        this.triggerRenderValidate();\r\n    },\r\n\r\n    /*\r\n     *   Fetch the data again and updates the content\r\n     */\r\n    refresh: function () {\r\n    },\r\n    /*\r\n     *   Sets an error on the cell\r\n     */\r\n    setError: function (key, columnXpath) {\r\n    },\r\n    /*\r\n     *   Changes the background for a cell\r\n     */\r\n    changeCellBackgroundColor: function (key, xpath, argument) {\r\n    },\r\n    /*\r\n     *   Changes the background for a cell\r\n     */\r\n    changeCellColor: function (key, xpath, argument) {\r\n    },\r\n    /*\r\n     *   Changes the visibility for a cell\r\n     */\r\n    changeCellVisibility: function (key, xpath, argument) {\r\n    },\r\n    /*\r\n     *   Changes the editability for a cell\r\n     */\r\n    changeCellEditability: function (key, xpath, argument) {\r\n    },\r\n    /*\r\n     *  Changes the required for cell\r\n     */\r\n    changeCellRequired: function (key, xpath, argument) {\r\n    },\r\n    /*\r\n     *  Refresh behaviors of cell\r\n     */\r\n    changeCellProperties: function (key, xpath, argument) {\r\n\r\n    },\r\n    /*\r\n     *  Changes the max value for a cell\r\n     */\r\n    changeCellMaxValue: function (key, xpath, argument) {\r\n\r\n    },\r\n    /*\r\n     *  Changes the min value for a cell\r\n     */\r\n    changeCellMinValue: function (key, xpath, argument) {\r\n\r\n    },\r\n    /*\r\n     *  Clean data of cell\r\n     */\r\n    cleanCellData: function (key, xpath) {\r\n    },\r\n\r\n    changeEditability: function (argument) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        self.saveGrid().done(function () {\r\n\r\n            // Renders again\r\n            var properties = {properties: $.extend({editable: bizagi.util.parseBoolean(argument)}, self.originalData)};\r\n\r\n            // Clears control\r\n            control.empty();\r\n\r\n            bizagi.rendering.render.prototype.initializeData.apply(self, [properties]);\r\n\r\n            self.initProperties();\r\n            self.changeColumnsEditability(argument);\r\n\r\n            if (typeof self.internalRenderControl == \"function\") {\r\n                $.when(self.internalRenderControl()).done(function (html) {\r\n                    control.append(html);\r\n                    self.postRenderElement(self.element);\r\n                });\r\n\r\n            }\r\n\r\n        });\r\n\r\n    },\r\n\r\n    saveGrid: function () {\r\n        var self = this;\r\n        var defer = $.Deferred();\r\n\r\n        var rows = $(\"[data-bizagi-component=rows]\", self.element).find(\"[data-new-row=true]\");\r\n        if (rows.length > 0) {\r\n            rows = $.map(rows, function (row, i) {\r\n                return $(row).data(\"business-key\");\r\n            });\r\n            self.saveInlineAddedRows(rows).done(function () {\r\n                defer.resolve();\r\n            });\r\n        } else {\r\n            defer.resolve();\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    changeColumnsEditability: function (value) {\r\n        var self = this;\r\n        var columns = self.columns || [];\r\n\r\n        $.each(columns, function (i, column) {\r\n            column.properties.editable = value;\r\n        });\r\n    },\r\n\r\n    /**\r\n     *   Refresh behaviors of cell\r\n     */\r\n    refreshCell: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var key = params.key;\r\n        var column = params.column;\r\n        var xpathContext = (params.xpathContext !== \"\") ? params.xpathContext + \".\" + self.properties.xpath + self.buildCellXpathFilter(key) : self.properties.xpath + self.buildCellXpathFilter(key);\r\n        var cell = self.getControlCell(key, params.column);\r\n        var form = self.getFormContainer();\r\n        var idForm = form.properties.id;\r\n\r\n        if (!cell) {\r\n            return;\r\n        }\r\n\r\n        // Execute personalized stuff before to refresh it\r\n        cell.beforeToRefresh();\r\n\r\n        // Call service\r\n        return $.when(self.dataService.multiaction().refreshGridCell({\r\n            idRender: properties.id,\r\n            column: cell.properties.id,\r\n            idPageCache: properties.idPageCache,\r\n            xpathContext: xpathContext,\r\n            idForm: idForm,\r\n            typeRender: cell.properties.type\r\n        })).done(function (data) {\r\n            // Extract values\r\n            var getDepthData = function (target) {\r\n                if (target && typeof target == \"object\" && target.length >= 1) {\r\n                    return (target[0].length >= 1) ? target[0][0] : target[0];\r\n                }\r\n                return \"\";\r\n            };\r\n            var newValue = getDepthData(data.rows);\r\n            var editable = getDepthData(data.editable);\r\n            if (!bizagi.util.isBoolean(editable)) {\r\n                editable = editable || true;\r\n            }\r\n            var visible = getDepthData(data.visible);\r\n            if (!bizagi.util.isBoolean(visible)) {\r\n                visible = visible || true;\r\n            }\r\n            \r\n            // Change Visibility & Editability\r\n            self.changeCellVisibility(key, column, visible);\r\n            self.changeCellEditability(key, column, editable);\r\n\r\n            // Change control value\r\n            cell.setValue(newValue);\r\n            cell.setDisplayValue(newValue);\r\n\r\n            // Trigger grid change\r\n            self.triggerRenderChange({key: key, column: column, changed: false});\r\n\r\n            // Update the affected cell manually after a refresh\r\n            //TODO:temporary solution\r\n            //review the DRAGON-5982 \r\n            if (cell.column != undefined && bizagi.util.detectDevice() == \"desktop\") {\r\n                self.updateAffectedCellManually(key, newValue, cell.column.columnIndex);\r\n            }\r\n\r\n\r\n            // Execute personalized stuff after to refresh it\r\n            cell.afterToRefresh();\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Triggers the render change event\r\n     */\r\n    triggerRenderChange: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n        // Property to verify exporting updated grids\r\n        if (!bizagi.util.isEmpty(params) && params.changed != false)\r\n            self.properties.canBeExported = false;\r\n        self.triggerHandler(\"renderchange\", {\r\n            render: self,\r\n            surrogateKey: params.key,\r\n            column: params.column,\r\n            changed: params.changed,\r\n            rowDeleted: params.rowDeleted,\r\n            pressed: params.pressed\r\n        });\r\n    },\r\n\r\n    /*\r\n     *   Validate the grid\r\n     */\r\n    validate: function () {\r\n        this.isValid([]);\r\n    },\r\n    /* \r\n     * Public method to determine if a value is valid or not\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var bValid = true;\r\n\r\n        // Clear error message\r\n        self.hasErrors = false;\r\n        self.setValidationMessage(\"\");\r\n\r\n        // Check for required columns and null values\r\n        if (self.properties.data && self.properties.data.rows) {\r\n            var newRows = self.getDataNewRows();\r\n            // Preserve elements in data.rows\r\n            // Check required\r\n            if (newRows.length == 0 && bizagi.util.parseBoolean(self.properties.required)) {\r\n                if (!self.hasValue()) {\r\n                    message = self.getResource(\"render-required-text\").replaceAll(\"#label#\", self.properties.displayName);\r\n                    invalidElements.push({\r\n                        xpath: self.properties.xpath,\r\n                        message: message\r\n                    });\r\n                    bValid = false;\r\n                }\r\n            }\r\n\r\n            var data = $.merge($.merge([], self.properties.data.rows), newRows);\r\n\r\n            for (var i = 0; i < self.columns.length; i++) {\r\n                var messages = [];\r\n                var uniqueMessages = {};\r\n\r\n                for (var j = 0; j < data.length; j++) {\r\n                    var value = data[j][i + 1];\r\n                    var key = data[j][0];\r\n                    var xpath = self.columns[i].properties.xpath;\r\n                    if (self.changes[key] !== undefined && self.changes[key][self.columns[i].properties.xpath] !== undefined) {\r\n                        value = self.changes[key][self.columns[i].properties.xpath];\r\n                    }\r\n\r\n                    // Check if the column is valid\r\n                    var valueValid = self.columns[i].isValueValid(key, value, messages, self.getCellOverride(key, i));\r\n                    if (!valueValid) {\r\n                        bValid = false;\r\n\r\n                        self.hasErrors = true;\r\n                        self.setError(key, self.columns[i].properties.xpath);\r\n                    }\r\n                }\r\n                for (var k = 0, messagesLength = messages.length; k < messagesLength; k++) {\r\n                    if (uniqueMessages[messages[k]] == null) {\r\n                        uniqueMessages[messages[k]] = messages[k];\r\n                    }\r\n                }\r\n\r\n                if (messages.length > 0) {\r\n                    var gridValidationMessage = self.getResource(\"render-grid-validation\").replaceAll(\"#grid#\", self.properties.displayName);\r\n                    for (key in uniqueMessages) {\r\n                        invalidElements.push({\r\n                            xpath: self.properties.xpath,\r\n                            message: gridValidationMessage + \" \" + key\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n    /*\r\n     *   Enables submit on change feature for the current render\r\n     */\r\n    configureSubmitOnChange: function () {\r\n        // Don't do anything we will trigger submit on change manually only when the grid add or edit form has been edited   \r\n    },\r\n    /*\r\n     *   Get cell override\r\n     */\r\n    getCellOverride: function (key, column) {\r\n        var self = this;\r\n\r\n        // Convert to numbers\r\n        key = Number(key);\r\n        column = Number(column);\r\n\r\n        // Find overrides\r\n        var columnProperties = self.columns[column].properties;\r\n        if (!self.cellOverrides[key])\r\n            self.cellOverrides[key] = {};\r\n        if (!self.cellOverrides[key][column]) {\r\n            self.cellOverrides[key][column] = {\r\n                visible: columnProperties.visible,\r\n                editable: columnProperties.editable,\r\n                required: columnProperties.required\r\n            };\r\n        }\r\n\r\n        return self.cellOverrides[key][column];\r\n    },\r\n\r\n    /*\r\n     * Set cell overrides based on the data\r\n     */\r\n    setCellOverrides: function (data, columns) {\r\n        var self = this;\r\n        var key;\r\n\r\n        // Init visibility overrides\r\n        if (data.visible) {\r\n            for (var i = 0, len = data.visible.length; i < len; i++) {\r\n                key = data.visible[i][0];\r\n                for (var j = 0, len_v = data.visible[i].length; j < len_v; j++) {\r\n                    // Skip key columns\r\n                    if (j > 0)\r\n                        self.getCellOverride(key, j - 1).visible = bizagi.util.parseBoolean(data.visible[i][j]);\r\n                }\r\n            }\r\n        }\r\n\r\n        // Init editability overrides\r\n        if (data.editable) {\r\n            for (var i = 0, len = data.editable.length; i < len; i++) {\r\n                key = data.editable[i][0];\r\n                for (var j = 0, len_v = data.editable[i].length; j < len_v; j++) {\r\n                    // Skip key columns\r\n                    if (j > 0) {\r\n                        var columnEditable = columns ? bizagi.util.parseBoolean(columns[j - 1].properties.editable) : true;\r\n                        self.getCellOverride(key, j - 1).editable = columnEditable ? bizagi.util.parseBoolean(data.editable[i][j]) : false;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Init required overrides\r\n        if (data.required) {\r\n            for (var i = 0, len = data.required.length; i < len; i++) {\r\n                key = data.required[i][0];\r\n                for (var j = 0, len_v = data.required[i].length; j < len_v; j++) {\r\n                    // Skip key columns\r\n                    if (j > 0)\r\n                        self.getCellOverride(key, j - 1).required = bizagi.util.parseBoolean(data.required[i][j]);\r\n                }\r\n            }\r\n        }\r\n    },\r\n    /*\r\n     *   Returns the row indexes for the data\r\n     */\r\n    getIndexes: function () {\r\n        var self = this;\r\n        var data = $.merge(self.properties.data.rows, self.getDataNewRows());\r\n        return $.map(data, function (item, i) {\r\n            return item[0];\r\n        });\r\n    },\r\n    /**\r\n     *  Return object with value of all new records unsaved within the grid\r\n     *  @return {object} all new records\r\n     */\r\n    getDataNewRows: function () {\r\n        var self = this;\r\n        var newRows = [];\r\n\r\n        if (typeof self.newRecords == \"object\" && !$.isEmptyObject(self.newRecords)) {\r\n            $.each(self.newRecords, function (rowKey) {\r\n                var cellValue = [];\r\n                cellValue.push(Number(rowKey));\r\n                for (var i = 0, length = self.columns.length; i < length; i++) {\r\n                    cellValue.push(self.getCellCurrentValue(rowKey, self.columns[i].properties.xpath));\r\n                }\r\n                // Add cell value row to new rows\r\n                newRows.push(cellValue);\r\n            });\r\n        }\r\n        return newRows;\r\n    },\r\n\r\n    /*\r\n     * Return the object with the required url to access the exported grid to the desired format\r\n     *  @return {object} render attributes, including id, xpathContext, idPagecache, disposition (inline or attachment), and exportType (XLS or PDF)\r\n     */\r\n    getGridExportUrl: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return self.dataService.getGridExportUrl({\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext || \"\",\r\n            idPageCache: properties.idPageCache,\r\n            disposition: params.disposition,\r\n            exportType: params.exportType,\r\n            sort: properties.sort,\r\n            sessionId: self.getSessionId(),\r\n            idForm: self.getFormContainer().properties.id\r\n\r\n        });\r\n    },\r\n\r\n    submitForGridChange: function () {\r\n        var self = this;\r\n        return self.submitOnChange(null, false);\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n\r\n        setTimeout(function () {\r\n            if (self.columns) {\r\n                $.each(self.columns, function (i, column) {\r\n                    column.dispose();\r\n                });\r\n            }\r\n        }, bizagi.override.disposeTime || 50);\r\n\r\n        // Call base\r\n        self._super();\r\n    },\r\n\r\n    getEnabledChecks: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        params = params || {};\r\n        $.extend(params, {\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contextType,\r\n            idPageCache: properties.idPageCache,\r\n            rows: properties.rowsPerPage,\r\n            xpathfilter: params.xpath\r\n        });\r\n        // Default ajax call\r\n        var defer = new $.Deferred();\r\n        // Resolve with remote data\r\n        self.dataService.multiaction().getGridDataExclusivesSelected(params).done(function (data) {\r\n            // Resolve with fetched data\r\n            properties.page = data.page;\r\n            properties.records = data.records;\r\n            properties.totalPages = data.totalPages;\r\n\r\n            // Check RTL\r\n            if (self.isRTL()) {\r\n                data.rows = self.changeOrderData(data.rows);\r\n            }\r\n            defer.resolve(data);\r\n        });\r\n        return defer.promise();\r\n    },\r\n\r\n    buildCellXpathFilter: function (key) {\r\n        if (bizagi.util.isNumeric(key)) return \"[id=\" + key + \"]\";\r\n        return \"[id='\" + key + \"']\";\r\n    },\r\n\r\n    cleanNewRecords: function () {\r\n        // Mark it as saved\r\n        this.newRecords = {};\r\n    },\r\n\r\n    /**\r\n     *\r\n     * Customizes render background color\r\n     *\r\n     * This method is called when the backgroud color is setted by Form Designer\r\n     *\r\n     * @param color\r\n     */\r\n    changeBackgroundColor: function (color) {\r\n        this._super(color);\r\n\r\n        var control = this.getControl();\r\n        control.find(\".bz-rn-grid-header-title\").css(\"background-color\", color, \"!important\");\r\n        control.find(\".bz-rn-grid-container-foother\").css(\"background-color\", color, \"!important\");\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Check has header format\r\n     * @returns {boolean}\r\n     */\r\n    hasColorHeader: function () {\r\n        var headerFormat = this.properties.headerFormat || {};\r\n\r\n        return headerFormat ? !bizagi.util.isEmpty(headerFormat.color) : false;\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Hidden Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for hiddens\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.hidden\", {}, {\r\n\r\n    /**\r\n     * Returns the in-memory processed element\r\n     */\r\n    renderControl: function () {\r\n        if (this.getMode() === \"design\") {\r\n            return \"<div>\" + bizagi.localization.getResource(\"render-hidden-displayName\") + \"</div>\";\r\n        } else {\r\n            return \"<div />\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var properties = this.properties;\r\n\r\n        // Call base\r\n        this._super();\r\n\r\n        // Set the initial value\r\n        if (properties.value !== undefined) {\r\n            this.setDisplayValue(properties.value);\r\n        }\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Label Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for labels\r\n */\r\n$.Class.extend(\"bizagi.rendering.label\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     * @returns {}\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // A label itself is never \"required\" as other controls\r\n        var properties = self.properties;\r\n        properties.required = false;\r\n\r\n        // Set properties\r\n        self.properties.displayType = \"label\";\r\n        //self.properties.labelAlign = self.originalProperties.labelAlign || \"left\";\r\n        self.properties.displayName = data.properties.displayName || \"\";\r\n\r\n        if (bizagi.util.parseBoolean(self.properties.allowDinamiclabel)) {\r\n            this.properties.displayName = data.properties.displayName || bizagi.localization.getResource(\"render-label-default-display-name\");\r\n        }\r\n\r\n        self.bindingValue();\r\n\r\n        // Calculate layout properties\r\n        self.calculateInitialLayoutProperties();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        this._super();\r\n        // Just apply display-type: label, align it to the left\r\n        this.changeDisplayOption(\"label\");\r\n        //this.changeLabelAlign(this.properties.labelAlign || \"left\");\r\n\r\n        if (typeof this.configureHelpText == \"function\")\r\n            this.configureHelpText();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        this._super();\r\n        // Just apply display-type: label, align it to the left\r\n        this.changeDisplayOption(\"label\");\r\n        this.changeLabelAlign(this.properties.labelAlign || \"left\");\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param {} invalidElements\r\n     */\r\n    isValid: function (invalidElements) {\r\n        // Automatically this render is valid, so we can't check a required label\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {}\r\n     */\r\n    canBeSent: function () {\r\n        // This render cannot be sent because it is full ajax\r\n        return false;\r\n    },\r\n\r\n    bindingValue: function () {\r\n        var self = this;\r\n\r\n        if (self.properties.allowDinamiclabel && self.properties.value) {\r\n            if (typeof (self.properties.value) === \"object\" && self.properties.value[0]) {\r\n                self.properties.displayName = self.properties.value[0].value;\r\n            } else if (typeof (self.properties.value) === \"string\" && self.properties.value !== \"\") {\r\n                self.properties.displayName = self.properties.value;\r\n            }\r\n        }\r\n    },\r\n\r\n    controlValueIsChanged: function(){\r\n        //Labels never change\r\n        return false;\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: Bizagi Render Search Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for search renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.search\", {}, {\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     * @returns {}\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        properties.searchForms = properties.searchForms || [];\r\n\r\n        // Default maxRecords is 20\r\n        properties.maxRecords = Number(properties.maxRecords) || 20;\r\n        properties.advancedSearch = (bizagi.util.parseBoolean(properties.advancedSearch) === null) ? false : bizagi.util.parseBoolean(properties.advancedSearch);\r\n        properties.allowSuggest = bizagi.util.parseBoolean(properties.allowSuggest) !== null ? bizagi.util.parseBoolean(properties.allowSuggest) : false;\r\n        properties.allowFullSearch = properties.allowFullSearch || false;\r\n        properties.allowAdd = bizagi.util.parseBoolean(properties.allowAdd) || false;\r\n        properties.allowTyping = bizagi.util.parseBoolean(properties.allowTyping) !== null ? bizagi.util.parseBoolean(properties.allowTyping) : false;\r\n        properties.allowTyping = bizagi.util.parseBoolean(properties.allowSuggest) ? true : properties.allowTyping;\r\n        properties.allowClear = bizagi.util.parseBoolean(properties.allowClear) !== null ? bizagi.util.parseBoolean(properties.allowClear) : false;\r\n        properties.editable = bizagi.util.parseBoolean(properties.editable) !== null ? bizagi.util.parseBoolean(properties.editable) : true;\r\n\r\n        // This length defines the behavior of the suggest, 2 characters are used by default meaning after 2 characters are written the search will take place\r\n        properties.searchLength = properties.searchLength || 2;\r\n\r\n        // Expire local storage cache\r\n        properties.enableLocalStorage = false;\r\n        properties.expireCache = 1000 * 60 * 15; // 15 minutes\r\n\r\n        // QAF-3297 - Compatibility for old versions of advanced search where the \"submitOnChange\" property default is true\r\n        // New \"submitVersion\" property default is 2\r\n        if (properties.advancedSearch && self.getMode() === \"execution\") {\r\n            properties.submitOnChange = bizagi.util.parseBoolean(properties.submitOnChange) || false;\r\n            properties.submitOnChange = (properties.submitVersion || 1) > 1 ? properties.submitOnChange : true;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"search\");\r\n\r\n        return $.fasttmpl(template, {\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            allowTyping: properties.allowTyping,\r\n            advancedSearch: properties.advancedSearch,\r\n            allowSuggest: properties.allowSuggest,\r\n            editable: properties.editable,\r\n            allowClear: properties.allowClear,\r\n            hasValue: self.hasValue(),\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Fetch the data into a deferred\r\n     * @param {} params\r\n     * @returns {}\r\n     */\r\n    getData: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n        var form = self.getFormContainer();\r\n        var contextType = form.getContextType() || form.params.contexttype || false;\r\n\r\n        params = params || {};\r\n\r\n        // Verify context type\r\n        if (self.properties.contexttype) {\r\n            params.h_contexttype = self.properties.contexttype;\r\n        } else if (contextType) {\r\n            params.h_contexttype = contextType;\r\n        }\r\n\r\n        params.h_contexttype = self.properties.enableQuerySuggestBehavior ? \"metadata\" : params.h_contexttype;\r\n\r\n        // QA-471 When the contexttype is metadata it does not send xpathcontext\r\n        if (params && params.h_contexttype && params.h_contexttype === 'metadata') {\r\n            properties.xpathContext = '';\r\n        }\r\n\r\n        // BA35025 - JFA\r\n        if (properties.term.indexOf(\"\\'\") > -1) {\r\n            var regexC = new RegExp(\"\\'\", \"g\");\r\n            properties.term = properties.term.replace(regexC, \"\\\\'\\\\'\");\r\n        }\r\n\r\n        // QAF-6448 - JFA\r\n        if (properties.term.indexOf(\"\\\"\") > -1) {\r\n            var regexC = new RegExp(\"\\\"\", \"g\");\r\n            properties.term = properties.term.replace(regexC, \"\\\"\");\r\n        }\r\n\r\n        // Resolve with remote data\r\n        self.dataService.multiaction().getSearchData({\r\n            url: properties.dataUrl,\r\n            contexttype: params.h_contexttype,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            term: (properties.allowFullSearch) ? \"%\" + properties.term : properties.term,\r\n            extra: params\r\n        }).done(function (data) {\r\n            // Resolve with fetched data\r\n            properties.data = data;\r\n            defer.resolve(properties.data);\r\n        }).fail(function (data) {\r\n            var hideStatus = data.hideStatus || false;\r\n\r\n            defer.resolve({});\r\n\r\n            if (!hideStatus) {\r\n                self.trigger(\"onSearchError\", data);\r\n            }\r\n        });\r\n\r\n        return defer.promise(defer);\r\n    },\r\n\r\n    /**\r\n     * Sets the internal value\r\n     * @param {} value\r\n     * @param {} triggerEvents\r\n     * @returns {}\r\n     */\r\n    setValue: function (value, triggerEvents) {\r\n        var self = this;\r\n        triggerEvents = triggerEvents !== undefined ? triggerEvents : true;\r\n\r\n        self._super(value, triggerEvents);\r\n\r\n        if (value != undefined) {\r\n            this.value = value;\r\n            this.selectedValue = value.label;\r\n        } else {\r\n            this.value = null;\r\n            this.selectedValue = null;\r\n        }\r\n    },\r\n\r\n    /* Maps the value, when this one comes from actions*/\r\n    mapValue: function (value) {\r\n        if (value && value.fromAction) {\r\n            return {\r\n                id: value.value,\r\n                value: value.label,\r\n                label: value.label\r\n            }\r\n        }\r\n\r\n        return value;\r\n    },\r\n\r\n    /*\r\n    *   Add the render data to the given collection in order to send data to the server\r\n     */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var xpath = self.properties.xpath;\r\n        var value = self.getValue();\r\n\r\n        if (self.controlValueIsChanged()) {\r\n            // Filter by valid xpaths and valid values\r\n            // Remove empty validation for value for combos\r\n            if (!bizagi.util.isEmpty(xpath) && value !== null && typeof (value) !== \"undefined\") {\r\n                // Add a validation because sometimes value contains an empty not null object\r\n                if (typeof (value) == \"object\" && value.id === undefined)\r\n                    return;\r\n                // Add the value to the server\r\n                renderValues[xpath] = value;\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Submits the selected data to the server in order to be saved\r\n     * @returns {}\r\n     */\r\n    submitData: function () {\r\n        var self = this;\r\n        var data = {};\r\n\r\n        // Add current data\r\n        if (!self.grid) {\r\n            data[self.properties.xpath] = self.getValue();\r\n        }\r\n\r\n        // Executes submit on change\r\n        self.submitOnChange(data, undefined, false);\r\n    },\r\n\r\n    /**\r\n     * Check if control is valid or not\r\n     * @param {} invalidElements\r\n     * @returns {}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        return this._super(invalidElements);\r\n    },\r\n\r\n    hasValue: function () {\r\n        var value = this.getValue();\r\n\r\n        if (typeof (value) == \"undefined\" || value == null) return false;\r\n\r\n        if (typeof value === \"object\" && value.id !== \"\" && typeof (value.id) !== \"undefined\") return true;\r\n        return !bizagi.util.isEmpty(value);\r\n    },\r\n\r\n    /**\r\n     * Formats value of each item\r\n     * @param {string, boolean or array} value\r\n     * @example\r\n     * value = \"string\" => \"string\"\r\n     * value = true => \"yes\" or \"si\", the localized value\r\n     * value = false => \"no\", the localized value\r\n     * value = [\"string 1\", \"string 2\"] => \"string 1 - string 2\"\r\n     * @returns {string}\r\n     */\r\n    formatItem: function (value) {\r\n        return bizagi.util.formatItem(value);\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Text Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for text renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.text\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        if (properties.regularExpressionExpression) {\r\n            var message = properties.regularExpressionMessage || this.getResource(\"render-text-regular-expression-default-message\");\r\n            properties.regularExpression = {\"expression\": properties.regularExpressionExpression, \"message\": message};\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*}\r\n     */\r\n    renderControl: function () {\r\n        var template = this.renderFactory.getTemplate(\"text\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            value: this.properties.value,\r\n            isEmptyField: typeof (this.properties.value) === \"undefined\",\r\n            helpText: this.properties.helpText,\r\n            editable: this.properties.editable\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     */\r\n    renderReadOnly: function () {\r\n        var template = this.renderFactory.getTemplate(\"text-read-only\");\r\n        var value = this.getValue();\r\n\r\n        if (bizagi.util.isString(value)) {\r\n            value = value.replaceAll(\"`\", \"&#96;\");\r\n        }\r\n\r\n        // Render template\r\n        return $.fasttmpl(template, {value: value, editable: this.properties.editable});\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        // Call base\r\n        this._super();\r\n\r\n        this.input = this.getControl().find(\"input\");\r\n\r\n        //Attach event for retype double\r\n        if (this.properties.retype === \"double\")\r\n            this.attachRetypeDouble();\r\n    },\r\n\r\n    /**\r\n     * function virtual implements on children (desktop,samrtphone...).\r\n     */\r\n    attachRetypeDouble: function () {\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Check mask property\r\n        if (properties.mask)\r\n            self.input.mask({mask: properties.mask});\r\n\r\n        // Attach change event\r\n        self.input.bind(\"change\", function () {\r\n\r\n            // Updates internal value\r\n            self.setValue(self.input.val(), false);\r\n\r\n            // Check that the value is valid\r\n            var validationMessages = [];\r\n            if (properties.retype !== \"duplicate\") {\r\n                if (self.isValid(validationMessages) || typeof (properties.regularExpression) === \"undefined\") {\r\n                    // Update value again triggering handlers\r\n                    self.setValue(self.input.val(), true);\r\n                }\r\n            }\r\n\r\n        }).keypress(function (e) {\r\n            e = window.event || e;\r\n            var keyUnicode = e.charCode || e.keyCode;\r\n\r\n            if (e !== undefined) {\r\n                if (keyUnicode == 13) {\r\n                    $(this).trigger(\"change\");\r\n                }\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param invalidElements\r\n     * @returns {*}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        // Call base\r\n        var bValid = this._super(invalidElements);\r\n        var value = self.getValue();\r\n\r\n        // When the form have big data, block browser executing RegExp. QAF-1418.\r\n        // Check regular expression\r\n        if (typeof value == \"string\") {\r\n            if (properties.regularExpression) {\r\n                var regex = new RegExp(\"\");\r\n                try {\r\n                    regex = new RegExp(properties.regularExpression.expression);\r\n                } catch (e) {\r\n                    if (bizagi.override.showDesignValidations) {\r\n                        bizagi.log(e);\r\n                        invalidElements.push({xpath: properties.xpath, message: e.message});\r\n                        bValid = false;\r\n                    }\r\n                }\r\n\r\n                if (value && ((value.match(new RegExp(\".*?(<|\\\\u003C)(.+?)(>|\\\\u003E)(.?)|eval\\\\(|eval\\\\u0028\", \"g\"))) || (!value.match(regex) && self.properties && self.properties.xpath === \"userName\"))) {\r\n                    var message = properties.regularExpression.message;\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    bValid = false;\r\n                } else {\r\n                    if (value && ((value.match(new RegExp(\".*?(<|\\\\u003C)(.+?)(>|\\\\u003E)(.?)|eval\\\\(|eval\\\\u0028\", \"g\"))) || (!value.match(regex)))) {\r\n                        var message = properties.regularExpression.message;\r\n                        invalidElements.push({xpath: properties.xpath, message: message});\r\n                        bValid = false;\r\n                    }\r\n                }\r\n            } else {\r\n                // Strange behavior on IE. When matchs are united on IE have is very slow\r\n                // solution, divide matchs\r\n                //.*? means for more information search: \"Lazy matching regexp\"\r\n                if (value && (value.match(new RegExp(\".*?eval\\\\(\", \"g\"))) && (value.match(new RegExp(\".*?eval\\\\u0028\", \"g\")))) {\r\n                    if (properties.editable) {\r\n                        var message = this.getResource(\"render-text-regular-expression-default-message\");\r\n\r\n                        invalidElements.push({xpath: properties.xpath, message: message});\r\n                        bValid = false;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var decodedValue = bizagi.util.decodeURI(value);\r\n\r\n        if (!bizagi.util.parseBoolean(self.properties.editable)) {\r\n            // Render as simple value\r\n            if (typeof (value) === \"string\") {\r\n                // Replace line breaks for html line breaks\r\n                var valueToDisplay = bizagi.util.decodedDisplayValue(self.getDisplayValue());\r\n\r\n                control.html(\"<label class='readonly-control'>\" + valueToDisplay + \"</label>\");\r\n            } else {\r\n                if (bizagi.util.isNull(value)) {\r\n                    control.html(\"\");\r\n                }\r\n            }\r\n        }\r\n\r\n        // Set internal value\r\n        self.setValue(decodedValue, false);\r\n    },\r\n\r\n    /**\r\n     * Extend setValue to fix all encode data from database\r\n     * @param value\r\n     */\r\n    setValue: function (value) {\r\n        this._super(value);\r\n    },\r\n\r\n    /**\r\n     * Helptext tooltip\r\n     * @param {} control\r\n     * @param {} currentValue\r\n     * @param {} currentTitle\r\n     */\r\n    createTooltip: function (control, currentValue, currentTitle) {\r\n        control.data(\"oldValue\", currentValue);\r\n        control.val(\"\");\r\n\r\n        try {\r\n            // Destroy tooltips\r\n            control.tooltip(\"destroy\");\r\n        } catch (e) {\r\n        }\r\n\r\n        control.attr(\"title\", currentTitle);\r\n        control.tooltip();\r\n\r\n        var toolTipZindex = $.getMaxZindex();\r\n        control.tooltip().on(\"tooltipopen\", function (event, ui) {\r\n            ui.tooltip.zIndex(toolTipZindex);\r\n        });\r\n\r\n        // Create new tooltip\r\n        control.tooltip(\"open\");\r\n\r\n        setTimeout(function () {\r\n            control.focus();\r\n        }, 100);\r\n    },\r\n\r\n\r\n    //#region No side effects funtions    \r\n    /**\r\n     * Gets the string with the correct size\r\n     * @param {string} value String value to validate\r\n     * @param {Int} maxLength Maximum size of the string\r\n     * @returns {string} String value validated\r\n     */\r\n    validateValue: function (value, maxLength) {\r\n        if(maxLength<1 || value.length<=maxLength)return value;\r\n        return value.substr(0, maxLength)\r\n    }\r\n    //#endregion No side effects funtions\r\n\r\n});","/**\r\n *   Name: Bizagi Render Button Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for button renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.button\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     * @returns {}\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.caption = properties.caption || \"\";\r\n\r\n        // set default value from normal to value\r\n        properties.displayType = \"value\";\r\n\r\n        // A button cannot be required\r\n        properties.required = false;\r\n\r\n        // This flag enable/disable default behaviors of buttons\r\n        // auto save and execute rule\r\n        properties.preventDefault = properties.preventDefault || false;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"button\");\r\n\r\n        // Render template\r\n        return $.fasttmpl(template, {\r\n            caption: self.properties.caption,\r\n            cssClass: self.properties.cssclass || \"\",\r\n            editable: self.properties.editable\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {}\r\n     */\r\n    renderReadOnly: function () {\r\n        // Executes the same template than normal render\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        // call base\r\n        this._super();\r\n\r\n        this.getLabel().addClass('bz-form-label--hidden');\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render behaviour after to be processed\r\n     */\r\n    postRender: function () {\r\n        // call base\r\n        this._super();\r\n\r\n        this.getLabel().addClass('bz-form-label--hidden');\r\n    },\r\n\r\n    /**\r\n     * Saves the form\r\n     * @returns {}\r\n     */\r\n    saveForm: function () {\r\n        var form = this.getFormContainer();\r\n        return form.saveForm();\r\n    },\r\n\r\n    /**\r\n     * Executes the button action\r\n     * @returns {}\r\n     */\r\n    executeButton: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpathContext = properties.xpathContext || \"\";\r\n\r\n        if (properties.submitOnChangexpathContextRow) {\r\n            xpathContext = xpathContext ? xpathContext + \".\" + properties.submitOnChangexpathContextRow : properties.submitOnChangexpathContextRow;\r\n        }\r\n\r\n        // Set the loading feedback\r\n        self.getFormContainer().startLoading();\r\n\r\n        return self.dataService.multiaction().executeButton({\r\n            idRender: properties.id,\r\n            xpath: properties.xpath || \"\",\r\n            xpathContext: xpathContext || \"\",\r\n            idPageCache: properties.idPageCache\r\n        }).always(function () {\r\n            self.getFormContainer().endLoading();\r\n            return arguments ? arguments[0] : undefined;\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Refresh the current form\r\n     * @returns {}\r\n     */\r\n    refreshForm: function () {\r\n        var form = this.getFormContainer();\r\n        form.refreshForm(this.properties.id);\r\n    },\r\n\r\n    /**\r\n     * Process the button actions workflow\r\n     * @returns {}\r\n     */\r\n    processButton: function () {\r\n        var self = this;\r\n\r\n        if (self.properties.editable) {\r\n            // Save the form prior opening the dialog\r\n            self.runButtonAction();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Triggers the render change event\r\n     * @param {} params\r\n     * @returns {}\r\n     */\r\n    triggerRenderChange: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n\r\n        var pressed = params.pressed || false;\r\n\r\n        self.triggerHandler(\"renderchange\", {render: self, pressed: pressed});\r\n    },\r\n\r\n    /**\r\n     * Run button actions\r\n     * @returns {}\r\n     */\r\n    runButtonAction: function () {\r\n        var self = this;\r\n\r\n        // Save the form prior opening the dialog\r\n        self.getFormContainer().clearValidationMessages();\r\n\r\n        self.saveForm().pipe(function () {\r\n            return self.executeButton();\r\n        }).done(function (result) {\r\n\r\n            if (result == null || result == true || result.result === \"success\" || result.type === \"success\") {\r\n                return self.refreshForm();\r\n            } else if (result.type === \"validationMessages\") {\r\n                try {\r\n                    // Add validation messages\r\n                    self.getFormContainer().addValidationMessage(result.messages);\r\n                } catch (e) {\r\n                    // bizagi.showMessageBox(result.messages, \"Error\"); // TODO\r\n                }\r\n            }\r\n        }).fail(function (a, b, message) {\r\n            // Add error messages\r\n            try {\r\n                self.getFormContainer().addErrorMessage(message);\r\n            } catch (e) {\r\n                // bizagi.showMessageBox(message, \"Error\"); // TODO\r\n            }\r\n        });\r\n    },\r\n\r\n    processLayout: function (isLabelFormat, format) {\r\n        if (isLabelFormat) {\r\n            this.changeBackgroundColor(format.background);\r\n            this._super(!isLabelFormat, format);\r\n        }\r\n    },\r\n\r\n    changeBackgroundColor: function (color) {\r\n        if (typeof color === \"undefined\") return this;\r\n\r\n        if (color !== \"none\") {\r\n            this.getElementsToStylize(this.getControl()).style(\"background\", color, \"important\");\r\n        } else {\r\n            this.getElementsToStylize(this.getControl()).css(\"background\", \"\");\r\n        }\r\n\r\n        return this;\r\n    },\r\n\r\n    getElementsToStylize: function ($context) {\r\n        return $(\"input\", $context);\r\n    },\r\n\r\n    /**\r\n     *  Method to determine if the render value can be sent to the server or not\r\n     * @returns {}\r\n     */\r\n    canBeSent: function () {\r\n        // This render cannot be sent because it is full ajax\r\n        return false;\r\n    }\r\n});","/*\r\n *   Name: BizAgi Render Fileprint Class\r\n *   Author: Christian Collazos\r\n *   Comments:\r\n *   -   This script will define basic stuff for fileprint renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.fileprint\", {}, {\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.caption = (properties.caption && properties.caption != \" \")? properties.caption : \"render-fileprint-property-caption\";\r\n        properties.filesCount = properties.filesCount ? properties.filesCount : 0;\r\n\r\n        // set default value from normal to value\r\n        properties.displayType = \"value\";\r\n\r\n        // Calculate layout properties\r\n        this.calculateInitialLayoutProperties();\r\n\r\n        // A button cannot be required\r\n        properties.required = false;\r\n    },\r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"fileprint\");\r\n\r\n        return $.fasttmpl(template, {\r\n            caption: properties.caption\r\n        });\r\n    },\r\n    /*\r\n    *   Method to render non editable values\r\n    */\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n\r\n        // Executes the same template than normal render\r\n        return self.renderControl();\r\n    },\r\n\r\n    /*\r\n    *   get the fileprint url\r\n    */\r\n    getFilePrintUrl: function (disposition) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return self.dataService.getFilePrintUrl({\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext || \"\",\r\n            idPageCache: properties.idPageCache,\r\n            disposition: disposition,\r\n            sessionId: self.getSessionId()\r\n        });\r\n\r\n    },\r\n\r\n    /*\r\n    *   Refresh the current form\r\n    */\r\n    refreshForm: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var form = self.getFormContainer();\r\n        form.refreshForm(properties.id);\r\n    },\r\n\r\n     /*\r\n    *   Saves the form\r\n    */\r\n    saveForm: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        return form.saveForm();\r\n    }\r\n});","/**\r\n *   Name: Bizagi Render Simple Link Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for link renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.link\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     * @returns {}\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Set properties\r\n        var properties = this.properties;\r\n        properties.required = false;\r\n        properties.displayType = \"value\";\r\n\r\n        // Calculate layout properties\r\n        this.calculateInitialLayoutProperties();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"link\");\r\n\r\n        // Render template\r\n        return $.fasttmpl(template, {\r\n            displayName: self.properties.displayName,\r\n            align: self.properties.valueAlign,\r\n            editable: self.properties.editable\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        this._super();\r\n        this.getLabel().addClass(\"bz-form-label--hidden\");\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {*}\r\n     */\r\n    renderReadOnly: function () {\r\n        // Executes the same template than normal render\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        this._super();\r\n        this.getLabel().addClass(\"bz-form-label--hidden\");\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param invalidElements\r\n     */\r\n    isValid: function (invalidElements) {\r\n        // Automatically this render is valid, so we can't check a required link\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        // Do nothing\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {boolean}\r\n     */\r\n    canBeSent: function () {\r\n        return false;\r\n    }\r\n\r\n});","/*\r\n *   Name: BizAgi Render Radio Class\r\n *   Author: Ivan Ricardo Taimal Narvaez\r\n *   Comments:\r\n *   -   This script will define basic stuff for radio renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.checkList\", {}, {\r\n\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.horizontal = bizagi.util.parseBoolean(properties.horizontal) || false;\r\n        self.setValue(properties.items);\r\n        self.updateOriginalValue();\r\n    },\r\n\r\n    /*\r\n     *   Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Call base\r\n        self._super();\r\n        self.checkListGroup = $(\".ui-bizagi-render-checkList .ui-bizagi-render-checkList-item\", control);\r\n    },\r\n\r\n    /*\r\n     *   Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(self.getTemplateName());\r\n        var items = self.properties.items || [];\r\n\r\n        var html = $.fasttmpl(template, $.extend(self.getTemplateParams(), {\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            unique: bizagi.util.randomNumber(10000, 1000000),\r\n            idPageCache: properties.idPageCache,\r\n            items: items\r\n        }));\r\n        return html;\r\n    },\r\n\r\n    /*\r\n     *   Gets the template used by the combo render\r\n     *   can be overriden in subclasses to reuse logic and just change the template\r\n     */\r\n    getTemplateName: function () {\r\n        return \"checkList\";\r\n    },\r\n\r\n    /*\r\n     *   Determines if we need to show the empty node or not\r\n     *   Can be overriden to change behaviour\r\n     */\r\n    showEmpty: function () {\r\n        return false;\r\n    },\r\n\r\n    /*\r\n     *   Determines if we need to show the current data regardless if it belongs to data or not\r\n     *   Can be overriden to change behaviour\r\n     */\r\n    showCurrentData: function () {\r\n        return false;\r\n    },\r\n\r\n    /*\r\n     *   Adds custom parameters to process the template\r\n     */\r\n    getTemplateParams: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return {\r\n            vertical: !properties.horizontal\r\n        };\r\n    },\r\n    /*\r\n     * Cleans current data\r\n     */\r\n    cleanData: function () {\r\n\r\n    },\r\n\r\n    setValue: function (value) {;\r\n        this.value = bizagi.clone(value);\r\n    },\r\n\r\n    getValue: function (data) {;\r\n        return this.value || [];\r\n    }\r\n\r\n});\r\n\r\n","/*\r\n*   Name: BizAgi Render Layout Render Class\r\n*   Author: Andrés Fernando Muñoz\r\n*   Comments:\r\n*   -   This script will define a base layout render class with common stuff related to all renders\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutRender\", {}, {\r\n\t/*\r\n\t *   Returns the html templated element\r\n\t */\r\n\trenderElement: function (template) {\r\n\t\tvar self = this;\r\n\t\tvar properties = self.properties;\r\n\t\tvar form = self.getFormContainer();\r\n\t\t// Start rendering deferred\r\n\t\tself.renderingDeferred = new $.Deferred();\r\n\r\n\t\t// Set render template\r\n\t\ttemplate = template || \"render-layout\";\r\n\t\tvar renderTemplate = self.renderFactory.getTemplate(template);\r\n\r\n\t\t// Resolve render label\r\n\t\tvar label = properties.displayName;\r\n\t\tif (typeof label == \"string\") {\r\n\t\t\tlabel = label.replaceAll(\"&\", \"&amp;\");\r\n\t\t\tlabel = label.replaceAll(\"$\", \"&#36;\");\r\n\t\t\tlabel = label.replaceAll(\"<\", \"&lt;\").replaceAll(\">\", \"&gt;\");\r\n\t\t\tlabel = label.replaceAll(\"\\\"\", \"&#34;\").replaceAll(\"'\", \"&#39;\").replaceAll(\"/\", \"&#47;\");\r\n\t\t\tlabel = label.replaceAll(\"\\\\n\", \"<br/>\");\r\n\t\t\tlabel = label.replaceAll(\"\\n\", \"<br/>\");\r\n\t\t}\r\n\r\n\t\t// Render template\r\n\t\tvar html = $.fasttmpl(renderTemplate, {\r\n\t\t\tlabel: label,\r\n\t\t\tisExtendedText: (properties.type == \"text\" && properties.isExtended),\r\n\t\t\torientation: properties.orientation,\r\n\t\t\tuniqueId: properties.uniqueId,\r\n\t\t\tid: properties.id,\r\n\t\t\tisDesign: self.getMode() === \"design\",\r\n\t\t\tmessageValidation: properties.messageValidation,\r\n\t\t\tprintVersion: form.params.printversion,\r\n\t\t\tcssClass: properties.cssclass || \"\",\r\n\t\t\thide: properties.hide\r\n\t\t});\r\n\r\n\t\t// Render internal control html\r\n\t\tvar result = self.internalRenderControl();\r\n\t\tif (!result) {\r\n\t\t\tresult = \"\";\r\n\t\t}\r\n\r\n\t\t// Check if this is an async element or not\r\n\t\tvar async = typeof (result) === \"object\" && result.done;\r\n\t\tif (!async) {\r\n\t\t\thtml = self.replaceControlHtml(html, result);\r\n\r\n\t\t} else {\r\n\t\t\tif (result.state() === \"resolved\") {\r\n\t\t\t\t// Fetch resolved result\r\n\t\t\t\thtml = self.replaceControlHtml(html, self.resolveResult(result));\r\n\t\t\t\tself.asyncRenderDeferred = null;\r\n\t\t\t} else {\r\n\t\t\t\t// Wait for result\r\n\t\t\t\tself.asyncRenderDeferred = result;\r\n\t\t\t\thtml = self.replaceControlHtml(html, \"\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn html;\r\n\t},\r\n\r\n    /*\r\n    *   Template method to get the control element\r\n    */\r\n\tgetControl: function () {\r\n\t\tvar self = this;\r\n\t\tif (!self.control || (self.control instanceof jQuery && self.control.length === 0)) {\r\n\t\t\tself.control = self.element;\r\n\t\t}\r\n\t\tif (!self.control || self.control.length == 0) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn self.control;\r\n\t},\r\n\r\n    /*\r\n    * Customizes the font italic style *\r\n    */\r\n\tchangeFontItalic: function (italic) {\r\n\t\tif (bizagi.util.parseBoolean(italic)) {\r\n\t\t\tthis.getControl().css(\"font-style\", \"italic\", \"!important\");\r\n\t\t} else {\r\n\t\t\tthis.getControl().css(\"font-style\", \"normal\", \"!important\");\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n    /*\r\n    * Customizes the font underline\r\n    */\r\n\tchangeFontUnderline: function (underline) {\r\n\t\tvar valueFormat = this.properties.valueFormat || {},\r\n\t\t\tvaluestrikethru = bizagi.util.parseBoolean(valueFormat.strikethru) ? \"line-through \" : \"\";\r\n\r\n\t\tif (bizagi.util.parseBoolean(underline)) {\r\n\t\t\tthis.getControl().css(\"text-decoration\", valuestrikethru + \"underline\", \"!important\");\r\n\t\t} else {\r\n\t\t\tthis.getControl().find(\"*\").each(function (i, element) {\r\n\t\t\t\t$(element).css(\"text-decoration\", valuestrikethru, \"!important\");\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n});","/*\r\n*   Name: BizAgi render layout Image Class\r\n*   Author: Andrés Fernando Muñoz\r\n*   Comments:\r\n*   -   This script will define basic stuff for non editable image control inside templates\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutImage\", { }, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this,\r\n            mode = self.getMode(),\r\n            useDefaultImage = false,\r\n            valueObj = self.properties.value || {},\r\n            uri= \"\";\r\n\r\n        //\r\n        var templateUri = self.renderFactory.getTemplate(\"layout-image\");\r\n\r\n        //Solucion temporal mientras se ajusta la respuesta del servicio cambiar despues de demo de 21/07/2015\r\n        /*if (value.value && value.value !== \"\" && value.value.length > 100){\r\n            var template64 = self.renderFactory.getTemplate(\"layout-image64\");\r\n            return $.fasttmpl(template64, { url: value.value, useDefaultImage: useDefaultImage });\r\n        }*/\r\n\r\n        /* if (mode === 'execution' && valueObj.value && valueObj.value.length > 0) {\r\n            uri = self.getImageUri();\r\n        }\r\n        else{\r\n            useDefaultImage = true;\r\n        } */\r\n\r\n        return $.fasttmpl(templateUri, {useDefaultImage: true });\r\n    },\r\n\r\n    /**\r\n     * Gets the base 64 image, specify in each device in order to change the size\r\n     */\r\n    getImage64: function () {\r\n        var self = this;\r\n        //Gets the real value of the image\r\n        var params = {\r\n            xpath: self.properties.xpath,\r\n            entity: self.value.guid,\r\n            surrogateKey: self.value.surrogateKey,\r\n            width: 96,\r\n            height: 96\r\n        };\r\n\r\n        return self.dataService.getEntityImage64(params);\r\n    },\r\n\r\n    /**\r\n     * Gets the url to get the array image, specify in each device in order to change the size\r\n     */\r\n    getImageUri: function () {\r\n        var self = this;\r\n\r\n        var map = {\r\n            entity: self.value.guid,\r\n            surrogateKey: self.value.surrogateKey,\r\n            xpath: self.properties.xpath,\r\n            width: 96,\r\n            height: 96,\r\n            hash: self.value.value\r\n        };\r\n\r\n        return self.dataService.serviceLocator.getUrl(\"render-entity-layout-imageByteArray\").replaceMultiple(map);\r\n    }\r\n\r\n});","/*\r\n *   Name: BizAgi Render Layout Simple Link Class\r\n *   Author: Andrés Fernando Muñoz\r\n *   Comments:\r\n *   -   This script will define basic stuff for non editable link renders inside templates\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutLink\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"layout-link\");\r\n        // Render template\r\n        var html = $.fasttmpl(template, {displayName: self.properties.displayName});\r\n        return html;\r\n    }\r\n});","/*\r\n *   Name: BizAgi Render Layout Label Class\r\n *   Author: Mauricio Sánchez\r\n *   Comments:\r\n *   -   This script will define basic stuff for labels inside templates\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutLabel\", {}, {\r\n\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n\r\n        this.properties.required = false;\r\n\r\n        // Set properties\r\n        this.properties.displayType = \"label\";\r\n        this.properties.labelAlign = this.originalProperties.labelAlign || \"left\";\r\n\r\n        // Calculate layout properties\r\n        this.calculateInitialLayoutProperties();\r\n\r\n\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"layout-label\");\r\n        var value = self.properties.displayName || self.properties.value || \"\";\r\n        // Render template\r\n        var html = $.fasttmpl(template, {value: value});\r\n        return html;\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Render Layout Text Class\r\n*   Author: Mauricio Sanchez\r\n*   Comments:\r\n*   -   This script will define basic stuff for text renders inside templates\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutText\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        //properties.editable = false;\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"layout-text\");\r\n        // Render template\r\n        var html = $.fasttmpl(template, {value: self.properties.value,editable: self.properties.editable});\r\n        return html;\r\n    },\r\n    /*\r\n     *   Method to render non editable values\r\n     */\r\n    renderReadOnly: function() {\r\n        var self = this;\r\n        // Executes the same template than normal render\r\n        return self.renderControl();\r\n    }\r\n});","/*\r\n *   Name: BizAgi Render Layout Simple Upload Class\r\n *   Author: Elkin Fernando Siabato Cruz\r\n *   Comments:\r\n *   -   This script will define basic stuff for non editable upload renders inside templates\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutUpload\", {\r\n   // Statics\r\n   BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n   BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\r\n   BA_PAGE_CACHE: bizagi.render.services.service.BA_PAGE_CACHE\r\n}, {\r\n   /**\r\n    * Constructor\r\n    */\r\n   init: function (params) {\r\n      // Call base\r\n      this._super(params);\r\n   },\r\n\r\n   /**\r\n    *   Update or init the element data\r\n    */\r\n   initializeData: function (data) {\r\n      var self = this;\r\n      // Call base\r\n      this._super(data);\r\n\r\n      var form = self.getFormContainer();\r\n\r\n      // Fill default properties\r\n      var properties = this.properties;\r\n\r\n      properties.editable = true;\r\n      properties.allowDelete = true;\r\n\r\n      properties.contexttype = (form.params && form.params.data && form.params.data.contextType) ? form.params.data.contextType : \"\";\r\n      properties.allowSendInMail = properties.allowSendInMail || false;\r\n   },\r\n\r\n   /**\r\n    * Get value files by data\r\n    */\r\n   getValueFilesByData: function(properties){\r\n      var self = this;\r\n      var defer = $.Deferred();\r\n      var dataFiles;\r\n      if (properties.value.value) {//Normal entityTemplate in form QAF-2319\r\n          dataFiles = properties.value.value;\r\n      }\r\n      else {//QAF-2210\r\n          dataFiles = properties.value;\r\n      }\r\n      var valueAuxFiles;\r\n      try{\r\n         if(self.isContextContainerWidgetRender()){\r\n            valueAuxFiles = JSON.parse(\"{ \\\"files\\\": \" + dataFiles  + \"}\");\r\n            defer.resolve(properties, valueAuxFiles);\r\n         }\r\n         else{//context: my stuff\r\n            $.when(self.getDataFilesWithoutScope()).done(function(valueResult){\r\n               valueAuxFiles = JSON.parse(\"{ \\\"files\\\": \" + valueResult  + \"}\");\r\n               defer.resolve(properties, valueAuxFiles);\r\n            });\r\n         }\r\n      }\r\n      catch(err){\r\n         valueAuxFiles = JSON.parse(\"{ \\\"files\\\": []}\");\r\n         defer.resolve(properties, valueAuxFiles);\r\n         console.warn(\"Exception converting data files. Error: \", err);\r\n      }\r\n      return defer.promise();\r\n   },\r\n\r\n   isContextContainerWidgetRender: function(){\r\n      var self = this;\r\n\r\n      var formContainer = self.getFormContainer();\r\n      return formContainer.params.paramsRender && formContainer.params.paramsRender.idRender;\r\n   },\r\n\r\n\r\n   /**\r\n    * Get data files when access from My stuff\r\n    */\r\n   getDataFilesWithoutScope: function(){\r\n      var self = this;\r\n      //Gets the real value of the image\r\n      var params = {\r\n         xpath: self.properties.xpath,\r\n         entity: self.value.guid,\r\n         surrogateKey: self.value.surrogateKey\r\n      };\r\n\r\n      return self.dataService.getFilesDataForLayoutUploadControl(params);\r\n   },\r\n\r\n   /**\r\n    *   Returns the internal value\r\n    */\r\n   getValue: function () {\r\n      return this.files;\r\n   },\r\n\r\n   /**\r\n    *   Returns the xpath to be used\r\n    */\r\n   getUploadXpath: function () {\r\n      return this.properties.xpath;\r\n   }\r\n\r\n});","/*\r\n*   Name: BizAgi Render Layout Boolean Class\r\n*   Author: Alexander Mejia\r\n*   Comments:\r\n*   -   This script will define basic stuff for boolean renders inside templates\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutBoolean\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.editable = false;\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"layout-boolean\");\r\n        // Render template\r\n        var html = $.fasttmpl(template, {value: this.properties.value});\r\n        return html;\r\n    },\r\n    /*\r\n     *   Method to render non editable values\r\n     */\r\n    renderReadOnly: function() {\r\n        var self = this;\r\n        // Executes the same template than normal render\r\n        return self.renderControl();\r\n    },\r\n\r\n    setValue: function (value, triggerEvents) {\r\n        if(value === null || value === \"\"){\r\n            this.properties.value = \"\";\r\n        }\r\n        else if (value.toString().toLowerCase() === \"true\" || value.toString().toLowerCase() === \"false\"){\r\n            this.properties.value = bizagi.util.parseBoolean(value) ? this.getResource(\"render-boolean-yes\") : this.getResource(\"render-boolean-no\");\r\n        }\r\n        this._super(this.properties.value, triggerEvents);\r\n    }\r\n});","/**\r\n * Name: BizAgi Render Layout DateTime Class\r\n * Author: Andres Fernando Muñoz\r\n * Comments:\r\n * - This script will define basic stuff for text renders inside templates\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutDateTime\", {}, {\r\n    /**\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = self.properties;\r\n        var dateFormat = self.getResource(\"dateFormat\");\r\n        var timeFormat = self.getResource(\"timeFormat\");\r\n\r\n        // We will hold here the value to display\r\n        properties.displayValue = \"\";\r\n        properties.showTime = properties.showTime !== undefined ? bizagi.util.parseBoolean(properties.showTime) : false;\r\n        properties.dateFormat = properties.dateFormat || dateFormat;\r\n        properties.timeFormat = properties.timeFormat || timeFormat;\r\n        properties.fullFormat = properties.dateFormat;\r\n\r\n        // Check if it has the showtime property\r\n        if (properties.showTime) {\r\n            if (properties.fullFormat.search(/[h|H]+/ig) === -1) {\r\n                properties.fullFormat = properties.fullFormat + ' ' + properties.timeFormat;\r\n            }\r\n        }\r\n        else{\r\n            var indexHour = properties.fullFormat.search(/[h|H]+/ig);\r\n            if (indexHour !== -1) {\r\n                properties.fullFormat = properties.fullFormat.substring(0, indexHour - 1);\r\n            }\r\n        }\r\n\r\n        // Read always parameter from server in invariant format\r\n        if (properties.value) {\r\n            var date = bizagi.util.dateFormatter.getDateFromInvariant(properties.value, properties.showTime);\r\n\r\n            // Format date to current format\r\n            if (date != 0) {\r\n                var datePickerRegional = bizagi.localization.getResource(\"datePickerRegional\");\r\n                self.value = properties.value; // Value must always hold the value with invariant format\r\n                properties.displayValue = bizagi.util.dateFormatter.formatDate(date, properties.fullFormat, datePickerRegional);\r\n            }\r\n            else {\r\n                self.value = null;\r\n            }\r\n        }\r\n        else {\r\n            self.value = null;\r\n            properties.value = \"\";\r\n            properties.displayValue = \"\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"layout-date-time\");\r\n        var value = (self.properties.value === null || self.properties.value === \"\") ?  \"\" : self.properties.value;\r\n\r\n        // Render template\r\n        return $.fasttmpl(template, {value: value});\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this, dateObj;\r\n        var properties = self.properties;\r\n        var dateControl = self.getDateControl();\r\n        var INVARIANT_FORMAT = \"MM/dd/yyyy H:mm:ss\";\r\n        self.i18n = bizagi.localization.getResource(\"datePickerRegional\");\r\n\r\n        if (value.length == INVARIANT_FORMAT.length || value.length == (INVARIANT_FORMAT.length + 1)) {\r\n            dateObj = bizagi.util.dateFormatter.getDateFromInvariant(value, true);\r\n        }\r\n        else {\r\n            dateObj = bizagi.util.dateFormatter.getDateFromInvariant(value);\r\n            if (dateObj && !isNaN(Date.parse(dateObj)) && !$.isNumeric(dateObj)) {\r\n                dateObj.setHours(0, 0, 0, 0);\r\n            }\r\n\r\n        }\r\n        // Set value in input\r\n        if (value && !isNaN(Date.parse(value))) {\r\n            var formattedDateTime = bizagi.util.dateFormatter.formatDate(dateObj, properties.fullFormat, self.i18n);\r\n            dateControl.text(formattedDateTime);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Gets the date control\r\n     */\r\n    getDateControl: function () {\r\n        var self = this;\r\n        self.dateControl = $(\".ui-bizagi-render-date-time\", self.getControl());\r\n        return self.dateControl;\r\n    }\r\n});","/*\r\n*   Name: BizAgi Render Layout number Class\r\n*   Author: Andres Fernando Muñoz\r\n*   Comments:\r\n*   -   This script will define basic stuff for text renders inside templates\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutNumber\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        var format = this.getResource(\"numericFormat\");\r\n\r\n        properties.allowDecimals = typeof (properties.allowDecimals) !== \"undefined\" ? bizagi.util.parseBoolean(properties.allowDecimals) : this.getDefaultAllowDecimals(properties.dataType);\r\n        properties.numDecimals = properties.allowDecimals ? (properties.numDecimals ? properties.numDecimals : (typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits : 2)) : 0;\r\n        properties.symbol = '';\r\n        properties.positiveFormat = format.positiveFormat;\r\n        properties.negativeFormat = format.negativeFormat;\r\n        properties.decimalSymbol = typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator : format.decimalSymbol;\r\n        properties.digitGroupSymbol = typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.groupSeparator : format.digitGroupSymbol;\r\n        properties.groupDigits = this.getDefaultGroupDigits(properties.dataType);\r\n        properties.colorize = properties.colorizeOnNegative || false;\r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"layout-number\");\r\n        // Render template\r\n        var html = $.fasttmpl(template, {value: self.properties.value});\r\n        return html;\r\n    },\r\n    /*\r\n     *   Method to render non editable values\r\n     */\r\n    renderReadOnly: function() {\r\n        var self = this;\r\n        // Executes the same template than normal render\r\n        return self.renderControl();\r\n    },\r\n\r\n    /*\r\n     *   Returns the display value of the render\r\n     */\r\n    getDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        // Workaround to get the display value by the format currency plugin, because it requires a control\r\n        var label = $('<label/>').html(value);\r\n        var regExp2 = /[\\u20AC \\u0024\\u00A3]/;\r\n        if (!value.toString().match(regExp2)) {\r\n            label.formatCurrency(\r\n                {\r\n                    symbol: properties.symbol,\r\n                    positiveFormat: properties.positiveFormat,\r\n                    negativeFormat: properties.negativeFormat,\r\n                    decimalSymbol: properties.decimalSymbol,\r\n                    digitGroupSymbol: properties.digitGroupSymbol,\r\n                    groupDigits: properties.groupDigits,\r\n                    roundToDecimalPlace: properties.numDecimals,\r\n                    colorize: properties.colorize\r\n                });\r\n        }\r\n        return label.text();\r\n    },\r\n\r\n    /*\r\n     *   Return the allow decimals default property based on the datatype\r\n     */\r\n    getDefaultAllowDecimals: function (dataType) {\r\n        if (dataType) {\r\n            // Integer data types\r\n            if (dataType == 1 || dataType == 2 || dataType == 3 || dataType == 4 || dataType == 7) {\r\n                return false;\r\n            }\r\n            // Decimal data types\r\n            if (dataType == 6 || dataType == 8 || dataType == 10 || dataType == 11) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    },\r\n    /*\r\n     *   Return the group digits default property based on the datatype\r\n     */\r\n    getDefaultGroupDigits: function (dataType) {\r\n        if (dataType) {\r\n            // Integer data types\r\n            if (dataType == 1 || dataType == 2 || dataType == 3 || dataType == 4 || dataType == 7) {\r\n                return false;\r\n            }\r\n            // Decimal data types\r\n            if (dataType == 6 || dataType == 8 || dataType == 10 || dataType == 11) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n});","/*\r\n*   Name: BizAgi Render Layout Money Class\r\n*   Author: Andrés Fernando Muñoz\r\n*   Comments:\r\n*   -   This script will define basic stuff for money renders inside templates\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutMoney\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        var format = this.getResource(\"numericFormat\");\r\n\r\n        // Configures symbol\r\n        properties.showsymbol = typeof (properties.showsymbol) !== \"undefined\" ? properties.showsymbol : true;\r\n\r\n        if (properties.showsymbol) {\r\n            properties.symbol = properties.currencySymbol ? properties.currencySymbol :\r\n                (typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.symbol : format.symbol);\r\n        }\r\n        else {\r\n            properties.symbol = \"\";\r\n        }\r\n        properties.groupDigits = true;\r\n    }\r\n});","/*\r\n *   Name: BizAgi Render Layout Label Class\r\n *   Author: Mauricio Sánchez\r\n *   Comments:\r\n *   -   This script will define basic stuff for labels inside templates\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.layoutPlaceholder\", {}, {\r\n\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n                \r\n    },\r\n\r\n    /*\r\n     *   Update or init the element data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n             \r\n    },\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"layout-placeholder\");\r\n        var value = self.properties.value || self.properties.displayName || \"\";\r\n        // Render template\r\n        var html = $.fasttmpl(template, {value: value});\r\n        return html;\r\n    }\r\n});\r\n","/**\r\n *   Name: Bizagi Render Geolocation control\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for geolocation renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.geolocation\", {}, {\r\n\r\n    /**\r\n     * Constructor\r\n     * @param {} data\r\n     */\r\n    init: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n        this.geolocation = window.navigator.geolocation;\r\n\r\n        var properties = this.properties;\r\n        properties.allowUpdate = bizagi.util.parseBoolean(properties.allowUpdate) === true;\r\n\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"geolocation\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, self.properties);\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param {} invalidElements\r\n     */\r\n    isValid: function (invalidElements) {\r\n        // Call base\r\n        return this._super(invalidElements);\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param {} value\r\n     * @returns {}\r\n     */\r\n    setDisplayValue: function (value) {\r\n        // Set internal value\r\n        this.setValue(value, false);\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     * @returns {}\r\n     */\r\n    configureHandlers: function () {\r\n\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param {} succes_callback\r\n     * @param {} fail_callback\r\n     */\r\n    getCurrentPosition: function (succes_callback, fail_callback) {\r\n        var self = this;\r\n\r\n        if (typeof (self.geolocation) === \"undefined\") {\r\n            if (fail_callback)\r\n                fail_callback(bizagi.localization.getResource(\"render-control-unsuported-by-browser\").replace(\"{0}\", self.properties.type));\r\n            return;\r\n        }\r\n\r\n        var onSuccess = function (position) {\r\n            if (succes_callback)\r\n                succes_callback(position);\r\n        };\r\n\r\n        var onError = function (error) {\r\n            var strMessage = self.getErrorMessage(error);\r\n\r\n            if (fail_callback)\r\n                fail_callback(strMessage);\r\n        };\r\n\r\n        return self.geolocation.getCurrentPosition(onSuccess, onError);\r\n    },\r\n\r\n    /**\r\n     * Get message of error\r\n     * @param error\r\n     * @returns {*|string}\r\n     */\r\n    getErrorMessage: function (error) {\r\n        var strMessage = \"\";\r\n\r\n        // Check for known errors\r\n        switch (error.code) {\r\n            case error.PERMISSION_DENIED:\r\n            case 1:\r\n                strMessage = bizagi.localization.getResource(\"render-geolocation-permission-denied\");\r\n                break;\r\n            case error.POSITION_UNAVAILABLE:\r\n            case 2:\r\n                strMessage = bizagi.localization.getResource(\"render-geolocation-position-unavailable\");\r\n                break;\r\n            case error.TIMEOUT:\r\n            case 3:\r\n                strMessage = bizagi.localization.getResource(\"render-geolocation-timeout\");\r\n                break;\r\n            default:\r\n                strMessage = \"WD: \" + bizagi.localization.getResource(\"render-geolocation-permission-denied\");\r\n                break;\r\n        }\r\n\r\n        return strMessage;\r\n    },\r\n\r\n    /**\r\n     * Change precision number of coordinates\r\n     * @param data\r\n     * @returns {*}\r\n     */\r\n    performPrecision: function (data) {\r\n        var geolocation = data.split(\" \") || \"\";\r\n\r\n        if (!geolocation) return data;\r\n\r\n        try {\r\n            var latitude = parseFloat(geolocation[0].trim());\r\n            var longitude = parseFloat(geolocation[1].trim());\r\n\r\n            return latitude.toPrecision(10) + \" \" + longitude.toPrecision(10);\r\n        } catch (e) {\r\n            return data;\r\n        }\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Render Association Class\r\n*   Author: Edward Morales\r\n*   Comments:\r\n*   -   This script will define basic stuff for association renders\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.association\", {}, {\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        var properties = self.properties;\r\n\r\n        // Fill default properties\r\n        properties.property = \"flipped\";\r\n        properties.idRender = self.properties.id;\r\n        properties.allowFlip = (typeof properties.allowFlip != \"undefined\") ? bizagi.util.parseBoolean(properties.allowFlip) : true;\r\n        properties.flipped = (typeof properties.flipped != \"undefined\") ? bizagi.util.parseBoolean(properties.flipped) : false;\r\n        properties.flipstate = properties.flipped;\r\n\r\n\r\n        // data of entities (left and right)\r\n        properties.leftData = properties.leftData || [];\r\n        properties.rightData = properties.rightData || [];\r\n\r\n        if (properties.value) {\r\n            self.processPropertyValue();\r\n        }\r\n    },\r\n\r\n\r\n\r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"association\");\r\n        var def = new $.Deferred();\r\n\r\n        self.properties.property = \"flipped\";\r\n        self.properties.idRender = self.properties.id;\r\n\r\n        // Define flipped\r\n        $.when(self.getFlipAssociation())\r\n            .done(function (flip) {\r\n\r\n                // Make json base, create self.properties.formatJson\r\n                self.makeJsonBase();\r\n\r\n                self.properties.flipped = bizagi.util.parseBoolean(flip) || false;\r\n\r\n                var html = $.fasttmpl(template, self.properties, {\r\n                    getColumnData: self.getColumnData,\r\n                    getRightAssociation: self.getRightAssociation\r\n                });\r\n\r\n                /* by default need set self.properties.formatJson */\r\n                self.setValue(JSON.encode(self.properties.formatJson));\r\n\r\n                def.resolve(html);\r\n            });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n\r\n    /*\r\n    * Returns the flip state\r\n    */\r\n    getFlipAssociation: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        if (mode == \"execution\")\r\n            return self.dataService.getFlipAssociation(self.properties);\r\n\r\n        return false;\r\n    },\r\n\r\n    /* \r\n    *   Gets the display value of the render\r\n    */\r\n    getDisplayValue: function () {\r\n        var self = this;\r\n        var value = self.getValue();\r\n\r\n        return value;\r\n    },\r\n\r\n    /*\r\n    *   Get the template \r\n    */\r\n    getTemplateName: function () {\r\n        return \"association\";\r\n    },\r\n\r\n\r\n    /**\r\n    * Get Left Data, verify if flipper flags sets true\r\n    * \r\n    * @param column {'0'||'1'}\r\n    */\r\n    getColumnData: function () {\r\n        var self = this;\r\n        var properties = self.data;\r\n        var data = [];\r\n        var associationData = properties.flipped ? properties.rightData : properties.leftData;\r\n\r\n        $.each(associationData, function(key, item) {\r\n            data.push({ id: item.id, value: item.value });\r\n        });\r\n\r\n        return data;\r\n    },\r\n\r\n    /**\r\n    * Association of right elements\r\n    */\r\n    getRightAssociation: function (leftId) {\r\n        var self = this;\r\n        var properties = self.data;\r\n        var association = [];\r\n\r\n\r\n        var isChecked = function (leftId, idRight) {\r\n            var checked = false;\r\n            $.each(properties.formatJson.value, function (key, value) {\r\n                if (!checked && value.id == leftId && value.value.indexOf(idRight) >= 0) {\r\n                    checked = true;\r\n                }\r\n            });\r\n\r\n            return checked;\r\n        };\r\n\r\n        // create association and check element\r\n        if (properties.flipped) {\r\n            // left element\r\n            $.each(properties.leftData, function (key, data) {\r\n                association.push({\r\n                    id: data.id,\r\n                    name: data.value,\r\n                    checked: isChecked(data.id, leftId)\r\n                });\r\n\r\n            });\r\n        } else {\r\n            $.each(properties.rightData, function (key, data) {\r\n                association.push({\r\n                    id: data.id,\r\n                    name: data.value,\r\n                    checked: isChecked(leftId, data.id)\r\n                });\r\n            });\r\n        }\r\n\r\n        return association;\r\n    },\r\n\r\n\r\n    removeElement: function (leftId, rightId) {\r\n        var self = this;\r\n\r\n        $.each(self.properties.formatJson.value, function (key, data) {\r\n            if (self.properties.flipped) {\r\n                if (data.id == rightId) {\r\n                    // Remove right element from left panel\r\n                    $.each(self.properties.formatJson.value[key][\"value\"], function (removeKey, removeValue) {\r\n                        if (leftId == removeValue) {\r\n                            // Splice from array\r\n                            self.properties.formatJson.value[key][\"value\"].splice(removeKey, 1);\r\n                        }\r\n                    });\r\n                }\r\n            } else if (data.id == leftId) {\r\n                // Remove right element from left panel\r\n                $.each(self.properties.formatJson.value[key][\"value\"], function (removeKey, removeValue) {\r\n                    if (rightId == removeValue) {\r\n                        // Splice from array\r\n                        self.properties.formatJson.value[key][\"value\"].splice(removeKey, 1);\r\n                    }\r\n                });\r\n            }\r\n        });\r\n        self.setValue(JSON.encode(self.properties.formatJson));\r\n    },\r\n\r\n\r\n    addElement: function (leftId, rightId) {\r\n        var self = this;\r\n\r\n        $.each(self.properties.formatJson.value, function (key, data) {\r\n            if (self.properties.flipped) {\r\n                if (data.id == rightId) {\r\n                    // Add right element to left panel\r\n                    self.properties.formatJson.value[key][\"value\"].push(leftId);\r\n                }\r\n            } else if (data.id == leftId) {\r\n                // Add right element to left panel\r\n                self.properties.formatJson.value[key][\"value\"].push(rightId);\r\n            }\r\n        });\r\n        self.setValue(JSON.encode(self.properties.formatJson));\r\n    },\r\n\r\n    makeJsonBase: function () {\r\n        var self = this;\r\n        self.properties.formatJson = self.properties.formatJson || {\r\n            leftXpath: self.properties.leftXpath,\r\n            rightXpath: self.properties.rightXpath,\r\n            leftFactName: self.properties.leftFactName,\r\n            rightFactName: self.properties.rightFactName,\r\n            value: self.properties.value\r\n        };\r\n    },\r\n\r\n\r\n    /*\r\n    *   Check if a render has no value for required validation\r\n    */\r\n    hasValue: function () {\r\n        var self = this;\r\n\r\n        if (self.properties.formatJson) {\r\n            var values = self.properties.formatJson.value;\r\n        } else {            \r\n            values = self.properties.value;\r\n        }\r\n       \r\n\r\n        for (var i = 0, l = values.length; i < l; i++) {\r\n            var data = values[i];\r\n            if (data && data.value.length > 0) {\r\n                return true;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    },\r\n\r\n    /*\r\n    * This method process the value.\r\n    * changes the format to send request\r\n    */\r\n    processPropertyValue: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var values = properties.value;\r\n        var result = [];\r\n\r\n        for (var i = 0, l = values.length; i < l; i++) {\r\n            var value = values[i];\r\n            result.push({ id: value[0], value: value[1] });\r\n        }\r\n\r\n        properties.value = result;\r\n    }\r\n});","/**\r\n *   Name: Bizagi Render Upload Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for uploads\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.upload\", {}, {\r\n    /***\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        var form = self.getFormContainer();\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        var maxFileSizeOfProperty = Number(properties.maxSize) || 0;\r\n        var maxFileSizeOfUser = typeof (BIZAGI_SETTINGS) !== \"undefined\" && typeof (BIZAGI_SETTINGS.UploadMaxFileSize) !== \"undefined\" ? Number(BIZAGI_SETTINGS.UploadMaxFileSize) : 4091904;\r\n\r\n        properties.maxSize = maxFileSizeOfProperty || maxFileSizeOfUser;\r\n        properties.maxfiles = Number(properties.maxfiles) || 999;\r\n        properties.validExtensions = properties.validExtensions || \"\";\r\n\r\n        if (properties.validExtensions.length > 0 && properties.validExtensions.indexOf(\".\") < 0) {\r\n            var singleExtensions = properties.validExtensions.replace(/\\ /gi, '').split(\";\");\r\n            var defExtensions = [];\r\n\r\n            for (var i = 0; i < singleExtensions.length; i++) {\r\n                if (singleExtensions[i].length > 0) {\r\n                    defExtensions.push(\"*.\" + singleExtensions[i]);\r\n                } else {\r\n                    //Removes the empty element\r\n                    var index = singleExtensions.indexOf(singleExtensions[i]);\r\n                    singleExtensions.splice(i, 1);\r\n                }\r\n            }\r\n\r\n            properties.validExtensions = defExtensions.join(\";\");\r\n        }\r\n\r\n        properties.addUrl = properties.addUrl || self.dataService.getUploadAddUrl();\r\n        properties.deleteUrl = properties.deleteUrl || undefined;\r\n        properties.editable = bizagi.util.parseBoolean(properties.editable) || false;\r\n        properties.allowDelete = (bizagi.util.parseBoolean(properties.allowDelete) !== null && properties.editable) ? bizagi.util.parseBoolean(properties.allowDelete) : false;\r\n\r\n        properties.contexttype = (form.params && form.params.data && form.params.data.contextType) ? form.params.data.contextType : \"\";\r\n        properties.allowSendInMail = properties.allowSendInMail || false;\r\n\r\n        // Set files property\r\n        self.files = properties.value || [];\r\n        self.filesCount = self.files.length;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"upload\");\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            xpath: bizagi.util.encodeXpath(self.getUploadXpath()),\r\n            editable: properties.editable,\r\n            haveFiles: self.filesCount !== 0,\r\n            noFiles: self.filesCount === 0,\r\n            allowSendInMail: properties.allowSendInMail\r\n        });\r\n\r\n        // Render current children\r\n        var items = \"\";\r\n        for (var i = 0; i < self.filesCount; i++) {\r\n            var file = {id: self.files[i][0], fileName: self.files[i][1]};\r\n            var item = self.renderUploadItem(file);\r\n\r\n            items += item;\r\n        }\r\n\r\n        html = self.replaceFilesHtml(html, items);\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {*|*|jQuery}\r\n     */\r\n    renderReadOnly: function () {\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Renders a single upload item\r\n     * @param file\r\n     * @returns {jQuery|*}\r\n     */\r\n    renderUploadItem: function (file) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var itemTemplate = self.getTemplateItemName();\r\n        var template = self.renderFactory.getTemplate(itemTemplate);\r\n\r\n        // Don't render urls when not running in execution mode\r\n        var url = !self.isExecutionMode() ? \"\" : self.buildItemUrl(file); // TODO: Review if need it: javascript:void(0);\r\n\r\n        var html = $.fasttmpl(template, {\r\n            id: file.id,\r\n            mode: mode,\r\n            url: url,\r\n            allowDelete: self.properties.allowDelete,\r\n            filename: file.fileName,\r\n            editable: self.properties.editable\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Builds the upload item url\r\n     * @param file\r\n     * @returns {*}\r\n     */\r\n    buildItemUrl: function (file) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n\r\n        return self.dataService.getUploadFileUrl({\r\n            idRender: properties.id,\r\n            xpath: self.getUploadXpath(),\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            fileId: file.id,\r\n            sessionId: form.properties.sessionId,\r\n            contexttype: properties.contexttype\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Replaces a {{files}} tag in the container for the specified \"replace\" element\r\n     * @param html\r\n     * @param replace\r\n     * @returns {*}\r\n     */\r\n    replaceFilesHtml: function (html, replace) {\r\n        return html.replace(\"{{files}}\", replace);\r\n    },\r\n\r\n    /**\r\n     * Removes a file from the upload control\r\n     * @param item\r\n     * @param fileId\r\n     * @returns {*} Returns a deferred\r\n     */\r\n    deleteUploadItem: function (item, fileId) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var xpath = self.getUploadXpath() + (bizagi.util.isNumeric(fileId) ? \"[id=\" + fileId + \"]\" : \"[id='\" + fileId + \"']\");\r\n\r\n        return self.dataService.deleteUploadFile({\r\n            url: properties.deleteUrl,\r\n            idRender: properties.id,\r\n            xpath: xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            contexttype: properties.contexttype\r\n        }).pipe(function () {\r\n\r\n            // Subtract counter\r\n            self.filesCount = self.filesCount - 1;\r\n\r\n            // Remove from local collection\r\n            self.files = $.grep(self.files, function (fileItem) {\r\n                return fileItem[0] != fileId;\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {boolean}\r\n     */\r\n    canBeSent: function () {\r\n        // This render cannot be sent because it is full ajax\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Sets the internal value\r\n     * @param value\r\n     * @param triggerEvents\r\n     */\r\n    setValue: function (value, triggerEvents) {\r\n        var self = this;\r\n\r\n        // Set files property\r\n        self.files = value || []; // Dont remove this line\r\n        self.filesCount = self.files.length;\r\n\r\n        // Call base\r\n        self._super(value, triggerEvents);\r\n    },\r\n\r\n    /**\r\n     * Returns the internal value\r\n     * @returns {*}\r\n     */\r\n    getValue: function () {\r\n        return this.files;\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param invalidElements\r\n     * @returns {boolean}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var message;\r\n        var bValid = true;\r\n\r\n        // Clear error message\r\n        self.setValidationMessage(\"\");\r\n\r\n        // Check required\r\n        if (properties.required && properties.editable) {\r\n            var newRow = self.grid && self.grid.isFromCreatedRow.apply(self);\r\n\r\n            if (self.filesCount <= 0 && !newRow) {\r\n                var inlineEdit = self.grid ? self.grid.properties.inlineEdit : true;\r\n\r\n                if (inlineEdit) {\r\n                    message = self.getResource(\"render-required-upload\").replaceAll(\"#label#\", properties.displayName);\r\n                    invalidElements.push({xpath: properties.xpath, message: message});\r\n                    bValid = false;\r\n                }\r\n            }\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * Build add params to send to the server\r\n     */\r\n    buildAddParams: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var data = {};\r\n        var prefix = self.Class.BA_CONTEXT_PARAMETER_PREFIX;\r\n\r\n        data[prefix + \"xpath\"] = self.getUploadXpath();\r\n        data[prefix + \"idRender\"] = properties.id;\r\n        data[prefix + \"xpathContext\"] = properties.xpathContext;\r\n        data[prefix + self.Class.BA_PAGE_CACHE] = properties.idPageCache;\r\n        data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = form.properties.sessionId;\r\n        data[prefix + \"contexttype\"] = properties.contexttype;\r\n\r\n        try {\r\n            if (typeof (BIZAGI_SESSION_NAME) !== \"undefined\") {\r\n                data[BIZAGI_SESSION_NAME] = form.properties.sessionId\r\n            } else {\r\n                data[\"JSESSIONID\"] = form.properties.sessionId;\r\n            }\r\n        } catch (e) {\r\n            data[\"JSESSIONID\"] = form.properties.sessionId;\r\n        }\r\n\r\n        return data;\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used\r\n     * @returns {*}\r\n     */\r\n    getUploadXpath: function () {\r\n        return this.properties.xpath;\r\n    },\r\n\r\n    checkRequired: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (bizagi.util.parseBoolean(properties.required)) {\r\n            if (self.grid && self.grid.properties.inlineAdd === true) {\r\n                if (!self.hasValue() && !(self.getControl().parents(\"tr\").data(\"new-row\"))) {\r\n                    self.setRenderRequired(invalidElements, properties);\r\n                    return false;\r\n                }\r\n            } else {\r\n                if (!self.hasValue()) {\r\n                    self.setRenderRequired(invalidElements, properties);\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    setRenderRequired: function (invalidElements, properties) {\r\n        var self = this;\r\n        var message = self.getResource(\"render-required-text\").replaceAll(\"#label#\", properties.displayName);\r\n        invalidElements.push({xpath: properties.xpath, message: message});\r\n    },\r\n\r\n    /**\r\n     * Templates\r\n     */\r\n    getTemplateItemName: function () {\r\n        return \"uploadItem\";\r\n    }\r\n});","/**\r\n *   Name: Bizagi Render ECM upload control\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for ECM Control\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.ecm\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        properties.maxSize = Number(properties.maxSize) || (typeof (BIZAGI_SETTINGS) !== \"undefined\" && typeof (BIZAGI_SETTINGS.UploadMaxFileSize) !== \"undefined\" ? Number(BIZAGI_SETTINGS.UploadMaxFileSize) : properties.maxSize = Number(properties.maxSize) || 4091904);\r\n        properties.maxFiles = Number(properties.maxfiles) || 999;\r\n        properties.validExtensions = properties.validExtensions || \"\";\r\n\r\n        if (properties.validExtensions.length > 0 && properties.validExtensions.indexOf(\".\") < 0) {\r\n            var singleExtensions = properties.validExtensions.split(\";\");\r\n            for (var i = 0; i < singleExtensions.length; i++) {\r\n                singleExtensions[i] = \"*.\" + singleExtensions[i];\r\n            }\r\n            properties.validExtensions = singleExtensions.join(\";\");\r\n        }\r\n\r\n        properties.addUrl = self.dataService.serviceLocator.getUrl(\"render-ecm-upload-url\") + \"?action=uploadECMFile\";\r\n        properties.editUrl = self.dataService.serviceLocator.getUrl(\"render-ecm-upload-url\") + \"?action=updateECMFileContent\";\r\n        properties.deleteUrl = properties.deleteUrl || undefined;\r\n        properties.allowDelete = bizagi.util.parseBoolean(properties.allowDelete) !== null ? bizagi.util.parseBoolean(properties.allowDelete) : true;\r\n        properties.q_xpath = bizagi.util.encodeXpath(properties.xpath);\r\n        properties.showMetadata = properties.showMetadata === undefined || properties.showMetadata === null ? true : bizagi.util.parseBoolean(properties.showMetadata);\r\n\r\n        var dateFormat = this.getResource(\"dateFormat\");\r\n        var timeFormat = this.getResource(\"timeFormat\");\r\n\r\n        // We will hold here the value to display\r\n        properties.displayValue = \"\";\r\n        properties.showTime = properties.showTime !== undefined ? bizagi.util.parseBoolean(properties.showTime) : false;\r\n        properties.dateFormat = properties.dateFormat || dateFormat;\r\n        properties.timeFormat = properties.timeFormat || timeFormat;\r\n        properties.fullFormat = properties.dateFormat;\r\n\r\n        // Set files property\r\n        self.files = properties.value || [];\r\n        self.filesCount = self.files.length;\r\n\r\n        properties.xpathContext = this.parent.properties.xpathContext || properties.xpathContext || \"\";\r\n\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @param listControl\r\n     * @param fileProperties\r\n     * @returns {*}\r\n     */\r\n    renderControl: function (listControl, fileProperties) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"ecm\");\r\n        var mode = self.getMode();\r\n        var defer = new $.Deferred();\r\n\r\n        properties.value = (fileProperties) ? [[fileProperties.idFileUpload, fileProperties.fileName]] : self.value;\r\n        var html = $.fasttmpl(template, properties, {\r\n            getFileExtension: self.getFileExtension,\r\n            isImage: self.isImage\r\n        });\r\n\r\n        if (self.properties.value != undefined) {\r\n\r\n            var lengthValues = self.properties.value.length;\r\n\r\n            if (lengthValues === 0) {\r\n                defer.resolve(html);\r\n            }\r\n\r\n            $.each(self.properties.value, function (key, value) {\r\n                var data = {};\r\n\r\n                data.idFileUpload = value[0];\r\n                data.fileName = value[1];\r\n                data.idPageCache = self.properties.idPageCache;\r\n                data.xpathContext = self.getXpathContext();\r\n                data.xPath = self.properties.xpath;\r\n                data.editable = self.properties.editable;\r\n                data.idAttrib = self.properties.idAttrib;\r\n\r\n                var form = self.getFormContainer();\r\n                if (form && form.properties && form.properties.sessionId) {\r\n                    data.sessionId = form.properties.sessionId;\r\n                }\r\n\r\n                if (mode === \"execution\") {\r\n                    $.when(self.renderFileLayout(data, fileProperties)).done(function (item) {\r\n                        lengthValues--;\r\n\r\n                        if (bizagi.loader.productBuildToAbout && bizagi.loader.productBuildToAbout.indexOf(\"10.4\") === 0) {\r\n                            item = item.replaceAll(\"Handlers/MetadataFile\", \"Handlers/Metadata\");\r\n                        }\r\n\r\n                        html = self.replaceItemHtml(html, self.properties.id + \"-\" + data.idFileUpload, item);\r\n                        if (lengthValues === 0) {\r\n                            defer.resolve(html);\r\n                        }\r\n                    });\r\n\r\n                }\r\n            });\r\n        } else {\r\n            defer.resolve(html);\r\n        }\r\n        return defer.promise();\r\n    },\r\n\r\n    replaceItemHtml: function (html, id, replace) {\r\n        return html.replace(\"{{\" + id + \"}}\", replace);\r\n    },\r\n\r\n    renderFileLayout: function (data, fileProperties) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var metadataTemplate = self.renderFactory.getTemplate(\"ecm-metadata\");\r\n\r\n        var deferred = $.Deferred();\r\n\r\n        $.when(self.dataService.getECMMetadata(data),\r\n            (fileProperties) ? [fileProperties] : self.dataService.getFileProperties(data)\r\n        ).done(function (metaData, fileProperties) {\r\n\r\n            fileProperties[0].data = data;\r\n\r\n            // Make xpath context\r\n            fileProperties[0].xpathContext = fileProperties[0].xpathContext || form.properties.xpathContext || \"\";\r\n            fileProperties[0].xpath = self.properties.xpath;\r\n\r\n            metaData[0].filename = data.fileName;\r\n            metaData[0].url = self.buildItemUrl(fileProperties[0]);\r\n\r\n            // Define File Properties\r\n            metaData[0].ecm_ecmStatus = fileProperties[0].ecmStatus;\r\n            metaData[0].ecm_isVisible = fileProperties[0].isVisible;\r\n            metaData[0].ecm_allowUpdateMetadata = fileProperties[0].allowUpdateMetadata;\r\n            metaData[0].ecm_allowDelete = fileProperties[0].allowDelete;\r\n            metaData[0].ecm_allowUpdateContent = fileProperties[0].allowUpdateContent;\r\n            metaData[0].ecm_allowView = fileProperties[0].allowView;\r\n            metaData[0].ecm_allowCheckOut = fileProperties[0].allowCheckOut;\r\n            metaData[0].ecm_allowCancelCheckOut = fileProperties[0].allowCancelCheckOut;\r\n            metaData[0].ecm_allowEdit = data.editable && fileProperties[0].allowEdit;\r\n            metaData[0].ecm_ecmStatus = fileProperties[0].ecmStatus;\r\n            metaData[0].idFileUploads = fileProperties[0].idFileUpload;\r\n            metaData[0].xpath = fileProperties[0].xpath;\r\n            metaData[0].value = bizagi.util.parseBoolean(fileProperties[0].value);\r\n            metaData[0].deviceType = bizagi.detectDevice();\r\n\r\n            var html = $.fasttmpl(metadataTemplate, metaData[0]);\r\n            deferred.resolve(html);\r\n        });\r\n\r\n        return deferred.promise();\r\n    },\r\n\r\n    isImage: function (file) {\r\n        var extension = this.getFileExtension(file);\r\n        var image = [\"JPG\", \"JPEG\", \"GIF\", \"PNG\", \"BMP\"];\r\n\r\n        return (image.indexOf(extension.toUpperCase()) > -1) ? true : false;\r\n    },\r\n\r\n    replaceFilesHtml: function (html, replace) {\r\n        return html.replace(\"{{files}}\", replace);\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {*}\r\n     */\r\n    renderReadOnly: function () {\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {boolean}\r\n     */\r\n    canBeSent: function () {\r\n        // This render cannot be sent because it is full ajax\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Builds the upload item url\r\n     * @param file\r\n     * @returns {*}\r\n     */\r\n    buildItemUrl: function (file) {\r\n        var self = this;\r\n        var p_sessionId = bizagi.cookie(\"JSESSIONID\");\r\n\r\n        if(!file.data) {\r\n            file.data = {fileName: file.fileName, idAttrib: file.idAttrib}\r\n        }\r\n\r\n        return self.dataService.getECMFileUrl({\r\n            idFileUpload: file.idFileUpload,\r\n            xPath: file.xpath || file.xPath,\r\n            xpathContext: file.xpathContext,\r\n            idAttrib: file.data.idAttrib,\r\n            idPageCache: self.properties.idPageCache,\r\n            fileName: file.data.fileName.replace(/ /g, \"_\"),\r\n            p_sessionId: p_sessionId,\r\n            sessionId: file.data.sessionId || \"\"\r\n        });\r\n    },\r\n\r\n    buildAddParams: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var data = {};\r\n\r\n        // data.fileExt = properties.validExtensions;\r\n        // data.fileDesc = properties.validExtensions ? self.getResource(\"render-upload-allowed-extensions\") + properties.validExtensions : \"\";\r\n        data.xPath = properties.xpath;\r\n        data.idAttrib = properties.idAttrib;\r\n        data.xpathContext = properties.xpathContext;\r\n        data.metaValues = [];\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = properties.idPageCache;\r\n\r\n        return data;\r\n    },\r\n\r\n    /**\r\n     * Get name of file extension\r\n     * @param fileName\r\n     * @returns {*}\r\n     */\r\n    getFileExtension: function (fileName) {\r\n        fileName = fileName || \"\";\r\n        return fileName.split(\".\").pop();\r\n    },\r\n\r\n    /**\r\n     * Sets the internal value\r\n     * @param value\r\n     * @param triggerEvents\r\n     */\r\n    setValue: function (value, triggerEvents) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        self._super(value, triggerEvents);\r\n\r\n        // Set files property\r\n        self.files = properties.value || [];\r\n        self.filesCount = (self.files.length) ? self.files.length : properties.value;\r\n    },\r\n\r\n    /**\r\n     * Gets xpath context\r\n     * @returns {*|string}\r\n     */\r\n    getXpathContext: function () {\r\n        return this.properties.xpathContext || \"\";\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used\r\n     * @returns {*}\r\n     */\r\n    getUploadXpath: function () {\r\n        return this.properties.xpath;\r\n    },\r\n\r\n    /**\r\n     * Removes a file from the ECM control\r\n     * @param item\r\n     * @param fileId\r\n     * @returns {*} Returns a deferred\r\n     */\r\n    deleteUploadItem: function (item, fileId) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var params = {\r\n            idFileUpload: fileId,\r\n            xPath: properties.xpath,\r\n            idAttrib: properties.idAttrib,\r\n            idPageCache: properties.idPageCache,\r\n            xpathContext: self.getXpathContext()\r\n        };\r\n\r\n        return self.dataService.deleteECMFile(params).pipe(function () {\r\n\r\n            // Subtract counter\r\n            self.filesCount = self.filesCount - 1;\r\n\r\n            // Remove from local collection\r\n            self.files = $.grep(self.files, function (fileItem) {\r\n                return fileItem[0] != fileId;\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Lock a file from the ECM control\r\n     * @param item\r\n     * @param fileId\r\n     * @returns {*} Returns a deferred\r\n     */\r\n    lockUploadItem: function (fileId) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var params = {\r\n            idFileUpload: fileId,\r\n            xPath: properties.xpath,\r\n            idAttrib: properties.idAttrib,\r\n            idPageCache: properties.idPageCache,\r\n            xpathContext: self.getXpathContext()\r\n        };\r\n\r\n        return self.dataService.checkOutFile(params);\r\n    },\r\n\r\n    /**\r\n     * Unlock a file from the ECM control\r\n     * @param item\r\n     * @param fileId\r\n     * @returns {*} Returns a deferred\r\n     */\r\n    unlockUploadItem: function (fileId) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var params = {\r\n            idFileUpload: fileId,\r\n            xPath: properties.xpath,\r\n            idAttrib: properties.idAttrib,\r\n            idPageCache: properties.idPageCache,\r\n            xpathContext: self.getXpathContext()\r\n        };\r\n\r\n        return self.dataService.cancelCheckOut(params);\r\n    }\r\n\r\n});","/**\r\n *   Name: Bizagi Render Yes-no Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for yes-no renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.yesno\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.value = typeof (properties.value) != \"undefined\" ? bizagi.util.parseBoolean(properties.value) : null;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var template = this.renderFactory.getTemplate(\"yesno\");\r\n        var randomId = bizagi.util.randomNumber(100, 10000000);\r\n\r\n        // Render template\r\n        var html = $.fasttmpl(template, {\r\n            id: randomId,\r\n            editable: this.properties.editable\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Gets the display value of the render\r\n     */\r\n    getDisplayValue: function () {\r\n        var value = this.getValue();\r\n\r\n        if (bizagi.util.parseBoolean(value) === true) {\r\n            return this.getResource(\"render-boolean-yes\");\r\n        } else if (bizagi.util.parseBoolean(value) === false) {\r\n            return this.getResource(\"render-boolean-no\");\r\n        } else {\r\n            return \"\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Check if a render has no value for required validation\r\n     * @returns {boolean}\r\n     */\r\n    hasValue: function () {\r\n        var value = this.getValue();\r\n\r\n        if (bizagi.util.isEmptyValue(value)) return false;\r\n        return bizagi.util.parseBoolean(value) !== null;\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Letter Class\r\n*   Author: Diego Parra\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for letter renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.letter\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Create a variable to check if the letter has been opened when editable\r\n        this.letterOpened = false;\r\n    },\r\n\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {}\r\n     */\r\n    renderControl: function () {\r\n        var template = this.renderFactory.getTemplate(\"letter\");\r\n\r\n        // Render template\r\n        return $.fasttmpl(template);\r\n    },\r\n\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     */\r\n    renderReadOnly: function () {\r\n        var template = this.renderFactory.getTemplate(\"letter.readonly\");\r\n\r\n        // Render template\r\n        return $.fasttmpl(template);\r\n    },\r\n\r\n    /**\r\n     * Returns the letter content from the server\r\n     */\r\n    getLetterContent: function () {\r\n        // Set flag to true\r\n        this.letterOpened = true;\r\n\r\n        return this.dataService.getLetterContent({\r\n            url: this.properties.getUrl,\r\n            idRender: this.properties.id,\r\n            xpath: this.getXpath(),\r\n            xpathContext: this.getContextXpath(),\r\n            idPageCache: this.properties.idPageCache\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Sends the content to the server in order to save\r\n     * @param {} content\r\n     */\r\n    saveLetterContent: function (content) {\r\n        return this.dataService.saveLetterContent({\r\n            url: this.properties.saveUrl,\r\n            idRender: this.properties.id,\r\n            xpath: this.getXpath(),\r\n            xpathContext: this.getContextXpath(),\r\n            idPageCache: this.properties.idPageCache,\r\n            content: content\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Returns the letter content from the server\r\n     */\r\n    getCanGenerateLetter: function () {\r\n        return this.dataService.getCanGenerateLetter({\r\n            idRender: this.properties.id,\r\n            xpath: this.getXpath(),\r\n            xpathContext: this.getContextXpath(),\r\n            idPageCache: this.properties.idPageCache\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Saves the form\r\n     */\r\n    saveForm: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        return form.saveForm();\r\n    },\r\n\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var message;\r\n\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.visible) == false) return true;\r\n\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.editable) == false) return true;\r\n\r\n        // Clear error message\r\n        self.setValidationMessage(\"\");\r\n\r\n        // Check required\r\n        if (properties.required) {\r\n            if (self.letterOpened == false) {\r\n                message = self.getResource(\"render-letter-required-text\").replaceAll(\"#label#\", properties.displayName);\r\n                invalidElements.push({xpath: properties.xpath, message: message});\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * Returns the current xpath\r\n     */\r\n    getXpath: function () {\r\n        return this.properties.xpath;\r\n    },\r\n\r\n    /**\r\n     * Returns the current context xpath\r\n     */\r\n    getContextXpath: function () {\r\n        return this.properties.xpathContext;\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Form Link Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for form link renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.formLink\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Set properties\r\n        var properties = this.properties;\r\n\r\n        properties.displayType = \"value\";\r\n        properties.maximized = bizagi.util.parseBoolean(this.properties.maximized) != null ? bizagi.util.parseBoolean(this.properties.maximized) : false;\r\n\r\n        // Calculate layout properties\r\n        this.calculateInitialLayoutProperties();\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"formLink\");\r\n\r\n        // Render template\r\n        return $.fasttmpl(template, {\r\n            id: properties.id,\r\n            align: properties.valueAlign,\r\n            displayName: properties.displayName,\r\n            value: properties.value,\r\n            editable: properties.editable,\r\n            likeButton: bizagi.util.parseBoolean(properties.likeButton) || false\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {*|*|jQuery}\r\n     */\r\n    renderReadOnly: function () {\r\n        // Executes the same template than normal render\r\n        return this.renderControl();\r\n\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        this._super();\r\n        this.getLabel().addClass(\"bz-form-label--hidden\");\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        this._super();\r\n        this.getLabel().addClass(\"bz-form-label--hidden\");\r\n    },\r\n\r\n    /**\r\n     * Submits a edit request for a link display form\r\n     * @returns {*} Returns a deferred\r\n     */\r\n    submitEditRequest: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Don't send request when the link is not editable\r\n        if (!properties.editable && !properties.value)\r\n            return null;\r\n\r\n        return self.dataService.editLinkForm({\r\n            url: properties.editUrl,\r\n            idRender: properties.id,\r\n            xpath: self.getFormLinkXpath(),\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Submits a link save request for the displayed form\r\n     * @param data\r\n     * @returns {*} Returns a deferred\r\n     */\r\n    submitSaveRequest: function (data) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Don't send request when the link is not editable\r\n        if (!properties.editable && !properties.value)\r\n            return null;\r\n\r\n        var xpath = self.getFormLinkXpath();\r\n        var xpathContext = xpath;\r\n\r\n        if (typeof (properties.xpathContext) !== \"undefined\" && properties.xpathContext !== \"\") {\r\n            xpathContext = xpath ? properties.xpathContext + \".\" + xpath : properties.xpathContext;\r\n        }\r\n\r\n        return self.dataService.saveLinkForm({\r\n            url: properties.saveUrl,\r\n            idRender: properties.id,\r\n            xpathContext: xpathContext,\r\n            submitData: data\r\n        }).done(function (response) {\r\n            var executeSubmitOnChange = true;\r\n\r\n            if (response && response.type === \"validationMessages\")\r\n                executeSubmitOnChange = false;\r\n\r\n            if (executeSubmitOnChange)\r\n                self.submitOnChange({});\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Submits a rollback request\r\n     * @param params\r\n     * @returns {*} Returns a deferred when done\r\n     */\r\n    submitRollbackRequest: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return $.when(function(){\r\n            // Don't send request when the link is not editable\r\n            if (!properties.editable && !properties.value){\r\n                return null;\r\n            }\r\n            else{\r\n                return self.dataService.rollbackLinkForm({\r\n                    url: properties.rollbackUrl,\r\n                    idRender: properties.id,\r\n                    xpath: self.getFormLinkXpath(),\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: params ? params.idPageCache : properties.idPageCache\r\n                });\r\n            }\r\n        }());\r\n    },\r\n\r\n    /**\r\n     * Submits a commit request\r\n     * @returns {*} Returns a deferred when done\r\n     */\r\n    submitCommitRequest: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return $.when(function(){\r\n            // Don't send request when the link is not editable\r\n            if (!properties.editable && !properties.value){\r\n                return null;\r\n            } else {\r\n                return self.dataService.commitLinkForm({\r\n                    url: properties.commitUrl,\r\n                    idRender: properties.id,\r\n                    xpath: self.getFormLinkXpath(),\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: properties.idPageCache\r\n                });\r\n            }\r\n        }());\r\n    },\r\n\r\n    /**\r\n     * Submits a checkpoint request\r\n     * @returns {*} Returns a deferred when done\r\n     */\r\n    submitCheckpointRequest: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return $.when(function(){\r\n            // Don't send request when the link is not editable\r\n            if (!properties.editable && !properties.value){\r\n                return null;\r\n            } else {\r\n                return self.dataService.sendCheckpoint({\r\n                    url: properties.checkpointUrl,\r\n                    idRender: properties.id,\r\n                    xpath: self.getFormLinkXpath(),\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: properties.idPageCache\r\n                });\r\n            }\r\n        }());\r\n    },\r\n\r\n    /**\r\n     * Submits a submitData request\r\n     * @returns {*} Returns a deferred when done\r\n     */\r\n    submitDataRequest: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return $.when(function () {\r\n            // Don't send request when the link is not editable\r\n            if (!properties.editable && !properties.value) {\r\n                return null;\r\n            } else {\r\n\r\n\r\n                return self.dataService.submitData({\r\n                    url: properties.checkpointUrl,\r\n                    action: \"SUBMITDATA\",\r\n                    idRender: properties.id,\r\n                    xpath: self.getFormLinkXpath(),\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: properties.idPageCache\r\n                });\r\n            }\r\n        }());\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     * @param invalidElements\r\n     */\r\n    isValid: function (invalidElements) {\r\n        // Automatically this render is valid, so we can't check a required link\r\n    },\r\n\r\n    /**\r\n     * Get Form Link xpath to use\r\n     * @returns {*}\r\n     */\r\n    getFormLinkXpath: function () {\r\n        return this.properties.xpath;\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {boolean}\r\n     */\r\n    canBeSent: function () {\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        // Don't do anything\r\n    }\r\n\r\n});\r\n\r\n","/**\r\n *   Name: Bizagi Render Document Generator\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for document generator render\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.document\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        var properties = this.properties;\r\n\r\n        properties.validate = bizagi.util.parseBoolean(properties.validate) != null ? bizagi.util.parseBoolean(properties.validate) : false;\r\n        properties.downloadalldocuments = properties.downloadalldocuments ? properties.downloadalldocuments : false;\r\n        properties.allowGenerate = properties.allowGenerate !== undefined ? properties.allowGenerate : true;\r\n        properties.append = properties.append ? properties.append : false;\r\n\r\n        if (properties.caption) {\r\n            properties.caption = bizagi.util.trim(properties.caption);\r\n\r\n            if (properties.caption.length === 0) {\r\n                properties.caption = this.getResource(\"render-documentgenerator-button-label\");\r\n            }\r\n        } else {\r\n            properties.caption = this.getResource(\"render-documentgenerator-button-label\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n\r\n        self.preRenderControl();\r\n\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n        var downloadAllDocuments = properties.downloadalldocuments;\r\n        var allowGenerate = properties.allowGenerate;\r\n        var template = self.renderFactory.getTemplate(self.getTemplate());\r\n        var documents = properties.value || [];\r\n        var noFiles = documents ? (documents.length === 0) : true;\r\n\r\n        // Render template\r\n        var html = self.getControlHtml(template, mode, downloadAllDocuments, allowGenerate, properties, noFiles);\r\n\r\n        // Render current children\r\n        var items = this.renderDocumentsHtml(documents);\r\n        items += this.renderActionsHtml(documents, noFiles, downloadAllDocuments);\r\n\r\n        html = self.replaceFilesHtml(html, items);\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @param template\r\n     * @param mode\r\n     * @param downloadAllDocuments\r\n     * @param allowGenerate\r\n     * @param properties\r\n     * @param noFiles\r\n     * @returns {*|jQuery}\r\n     */\r\n    getControlHtml: function (template, mode, downloadAllDocuments, allowGenerate, properties, noFiles) {\r\n        var self = this;\r\n\r\n        return $.fasttmpl(template, {\r\n            noActivateButton: false,\r\n            editable: mode !== \"execution\",\r\n            mode: mode,\r\n            downloadalldocuments: downloadAllDocuments,\r\n            required: properties.required,\r\n            allowgenerate: allowGenerate,\r\n            xpath: self.getXpath(properties.xpath),\r\n            append: properties.append,\r\n            caption: properties.caption,\r\n            noFiles: noFiles,\r\n            allowSendInMail: properties.allowSendInMail\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @param xpath\r\n     * @returns {*}\r\n     */\r\n    getXpath: function (xpath) {\r\n        return xpath;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    preRenderControl: function () {\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {boolean}\r\n     */\r\n    activateButton: function () {\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used\r\n     * @param xpath\r\n     * @returns {*}\r\n     */\r\n    getDocumentXpath: function (xpath) {\r\n        return xpath;\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used\r\n     * @returns {*}\r\n     */\r\n    getContextXpath: function () {\r\n        return this.properties.xpathContext;\r\n    },\r\n\r\n    /**\r\n     * Renders a single document item\r\n     * @param file\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderDocumentItem: function (file) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var template = self.renderFactory.getTemplate(self.getTemplateItem());\r\n        var url = self.buildItemUrl(file);\r\n\r\n        // Don't render urls when not running in execution mode\r\n        if (mode !== \"execution\") url = \"javascript:void(0);\";\r\n\r\n        var html = $.fasttmpl(template, {\r\n            url: url,\r\n            allowDelete: self.properties.allowDelete,\r\n            filename: file.fileName,\r\n            mode: mode,\r\n            editable: self.properties.editable,\r\n            joined: false\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Builds the upload item url\r\n     * @param file\r\n     * @returns {*}\r\n     */\r\n    buildItemUrl: function (file) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return self.dataService.getUploadFileUrl({\r\n            idRender: properties.id,\r\n            xpath: self.getDocumentXpath(properties.xpath),\r\n            xpathContext: self.getContextXpath(),\r\n            idPageCache: properties.idPageCache,\r\n            fileId: file.id,\r\n            sessionId: self.getSessionId()\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Builds the download all items item url\r\n     * @returns {*}\r\n     */\r\n    buildAllDocumentsUrl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var returnLink = self.dataService.getAllDocumentsDownloadUrl({\r\n            xpath: self.getDocumentXpath(properties.xpath),\r\n            xpathContext: self.getContextXpath(),\r\n            idPageCache: properties.idPageCache,\r\n            idCase: properties.caseId,\r\n            idWorkItem: properties.workitemId,\r\n            sessionId: self.getSessionId()\r\n        });\r\n\r\n        return returnLink;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed (Virtual method)\r\n     * @returns {string}\r\n     */\r\n    postRender: function () {\r\n        // Call base\r\n        this._super();\r\n\r\n        return \"<div></div>\";\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed in read-only mode\r\n     */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        if (mode !== \"design\") {\r\n            var control = self.getControl();\r\n            var htmlControl = self.renderControl();\r\n\r\n            control.append(htmlControl);\r\n\r\n            self.updateControlForPrintMode(control);\r\n\r\n            // Execute the same as post-render\r\n            self.postRender();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Saves the form before the document generation\r\n     * @returns {*}\r\n     */\r\n    validateContainer: function () {\r\n        // Check if the form is valid, then generate\r\n        var form = this.getFormContainer();\r\n        return form.validateForm();\r\n    },\r\n\r\n    /**\r\n     * Saves the form before the document generation\r\n     * @returns {*}\r\n     */\r\n    save: function () {\r\n        var form = this.getFormContainer();\r\n\r\n        return form.saveForm();\r\n    },\r\n\r\n    /**\r\n     * Replaces a {{files}} tag in the container for the specified \"replace\" element\r\n     * @param html\r\n     * @param replace\r\n     * @returns {*}\r\n     */\r\n    replaceFilesHtml: function (html, replace) {\r\n        return html.replace(\"{{files}}\", replace);\r\n    },\r\n\r\n    /**\r\n     * Replaces a {{actions}} tag in the container for the specified \"replace\" element\r\n     * @param html\r\n     * @param replace\r\n     * @returns {*}\r\n     */\r\n    replaceActionsHtml: function (html, replace) {\r\n        return html.replace(\"{{actions}}\", replace);\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {boolean}\r\n     */\r\n    canBeSent: function () {\r\n        // This render cannot be sent because it is full ajax\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @param invalidElements\r\n     * @returns {boolean}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this,\r\n            properties = self.properties,\r\n            message;\r\n\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.visible) === false) {\r\n            return true;\r\n        }\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(properties.editable) === false) {\r\n            return true;\r\n        }\r\n\r\n        // Clear error message\r\n        self.setValidationMessage(\"\");\r\n\r\n        // Check required\r\n        if (properties.required && !properties.buttonExecuted) {\r\n            if (self.value) {\r\n                if (self.value.length > 0) return true;\r\n                message = self.getResource(\"render-document-required-text\");\r\n                invalidElements.push({xpath: properties.xpath, message: message});\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var mode = self.getMode();\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Attach handler\r\n        var generateLink = $(\".ui-bizagi-button-documentgenerator\", control);\r\n        if (mode === \"execution\") {\r\n            generateLink.click(function (e) {\r\n                if (e.isPropagationStopped()) return;\r\n                e.stopPropagation();\r\n\r\n                self.properties.buttonExecuted = true;\r\n\r\n                if (self.properties.validate) {\r\n                    // Check if the form is valid, then generate\r\n                    var isValid = self.validateContainer();\r\n                    if (isValid) {\r\n                        self.documentTemplateGenerate();\r\n                    }\r\n                } else {\r\n                    // Just generate the form\r\n                    self.documentTemplateGenerate();\r\n                }\r\n\r\n                self.properties.buttonExecuted = false;\r\n            });\r\n        }\r\n\r\n        // Configure preview handler\r\n        $(\".ui-bizagi-document-preview\", control).click(function (e) {\r\n            if (e.isPropagationStopped()) return;\r\n            e.stopPropagation();\r\n\r\n            self.showDocumentPreview($(this).data(\"url\"), $(this).data(\"filename\"));\r\n        });\r\n\r\n        // Configure preview handler\r\n        $(\".ui-bizagi-container-documents-item-delete\", control).click(function (e) {\r\n            if (e.isPropagationStopped()) return;\r\n            e.stopPropagation();\r\n\r\n            self.deleteDocumentTemplate($(this).data(\"filename\"));\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Creates the event of generation of templates.\r\n     * @param filename\r\n     */\r\n    deleteDocumentTemplate: function (filename) {\r\n        var self = this;\r\n        var params = {\r\n            xpath: self.properties.xpath + \"[fileName='\" + filename + \"']\",\r\n            idRender: self.properties.id,\r\n            xpathContext: self.getContextXpath(),\r\n            idPageCache: self.properties.idPageCache\r\n        };\r\n\r\n        self.startLoading();\r\n\r\n        $.when(self.dataService.deleteUploadFile(params))\r\n            .done(function () {\r\n                $.when(self.dataService.multiaction().getPropertyData({\r\n                    xpath: self.properties.xpath,\r\n                    idRender: self.properties.id,\r\n                    xpathContext: self.getContextXpath(),\r\n                    idPageCache: self.properties.idPageCache,\r\n                    property: \"value\"\r\n                })).done(function (documents) {\r\n                    self.resolveDeleteDocumentTemplate(documents, false, self.properties.downloadalldocuments);\r\n\r\n                    // Finish loading\r\n                    self.endLoading();\r\n                });\r\n            });\r\n    },\r\n\r\n    /**\r\n     * Creates the event of generation of templates.\r\n     */\r\n    documentTemplateGenerate: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        self.startLoading();\r\n\r\n        //Get the context xPath\r\n        properties.xpathcontext = self.getContextXpath();\r\n        properties.xpath = self.getDocumentXpath(properties.xpath);\r\n\r\n        self.save().done(function () {\r\n\r\n            bizagi.showErrorAlertDialog = false;\r\n\r\n            $.when(self.dataService.generateDocumentTemplate(properties))\r\n                .done(function () {\r\n\r\n                    // Fetch again the value property\r\n                    $.when(self.dataService.multiaction().getPropertyData({\r\n                        xpath: properties.xpath,\r\n                        idRender: properties.id,\r\n                        xpathContext: self.getContextXpath(),\r\n                        idPageCache: properties.idPageCache,\r\n                        property: \"value\"\r\n                    })).done(function (documents) {\r\n                        self.resolveDocumentTemplateGenerate(documents, false, properties.downloadalldocuments);\r\n\r\n                        // Finish loading\r\n                        self.endLoading();\r\n                    });\r\n\r\n                }).fail(function (error) {\r\n                self.endLoading();\r\n\r\n                // Add error messages\r\n                self.showErrorMessage(error);\r\n            });\r\n        }).fail(function (message) {\r\n            self.endLoading();\r\n\r\n            // Add error messages\r\n            self.showErrorMessage(error);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Show the error message when something went wrong with the service.\r\n     * @param error\r\n     */\r\n    showErrorMessage: function (error) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var messageText = self.resources.getResource('render-upload-alert-maxsize').replace(\"{0}\", BIZAGI_SETTINGS.UploadMaxFileSize);\r\n\r\n        try {\r\n            messageText = error && typeof (error.responseText) !== \"undefined\" ? JSON.parse(error.responseText).message : error;\r\n        } catch (e) {\r\n        }\r\n\r\n        form.addErrorMessage(messageText);\r\n        form.endLoading();\r\n    },\r\n\r\n    /**\r\n     * Shows the document if the flag is set. (virtual Function)\r\n     */\r\n    autoOpenDocuments: function () {\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed (Virtual method)\r\n     * @param url\r\n     * @param filename\r\n     */\r\n    showDocumentPreview: function (url, filename) {\r\n    },\r\n\r\n    /**\r\n     * Identifies the extension of the file in a simpler way that ECM does\r\n     * @param file\r\n     * @returns {string}\r\n     */\r\n    returnCssTypeFile: function (file) {\r\n\r\n        if (file == undefined || file.lenght === 0) {\r\n            return \"ui-bizagi-document-upload-item-generic-file\";\r\n        }\r\n\r\n        var extension = file.substr((file.lastIndexOf('.') + 1));\r\n\r\n        switch (extension) {\r\n            case 'docx':\r\n                return \"ui-bizagi-document-upload-item-doc\";\r\n            case 'pdf':\r\n                return \"ui-bizagi-document-upload-item-pdf\";\r\n            case 'xlsx':\r\n                return \"ui-bizagi-document-upload-item-xls\";\r\n            default:\r\n                return \"ui-bizagi-document-upload-item-generic-file\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Redraw documents when needed\r\n     * @param documents\r\n     * @param noFiles\r\n     * @param downloadAllDocuments\r\n     */\r\n    redrawDocuments: function (documents, noFiles, downloadAllDocuments) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var html = \"\";\r\n        var documentContainer = $(\"[data-component='files']\", control);\r\n\r\n        // Clear current links\r\n        documentContainer.empty();\r\n\r\n        // Draw links again\r\n        html += this.renderDocumentsHtml(documents);\r\n\r\n        // Check if there are documents and the flag to download all are available to show the link.\r\n        html += this.renderActionsHtml(documents, noFiles, downloadAllDocuments);\r\n\r\n        documentContainer.append(html);\r\n\r\n        //Set value\r\n        self.setValue(documents);\r\n    },\r\n\r\n    /**\r\n     * This method must be implemented by the specific class of each device. (Virtual method)\r\n     * @param file\r\n     * @returns {*|*|*}\r\n     */\r\n    renderAllDocumentDownload: function (file) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n\r\n        var template = self.renderFactory.getTemplate(self.getTemplateItem());\r\n        var url = self.buildAllDocumentsUrl();\r\n\r\n        // Don't render urls when not running in execution mode\r\n        if (mode !== \"execution\") url = \"javascript:void(0);\";\r\n\r\n        var html = $.fasttmpl(template, {\r\n            url: url,\r\n            allowDelete: properties.allowDelete,\r\n            filename: file.fileName,\r\n            mode: mode,\r\n            joined: true\r\n        });\r\n\r\n        return self.removeDeleteButton(html);\r\n    },\r\n\r\n    /**\r\n     * removeDeleteButton\r\n     * @param html\r\n     * @returns {*}\r\n     */\r\n    removeDeleteButton: function (html) {\r\n        var startIndex = html.indexOf(\"<span class=\\\"ui-bizagi-container-documents-item-delete\");\r\n\r\n        if (startIndex > 0) {\r\n            var restOfWord = html.substring(startIndex);\r\n            var finishIndex = restOfWord.indexOf(\"</span>\") + 7;\r\n\r\n            return html.substring(0, startIndex) + restOfWord.substring(finishIndex);\r\n        } else {\r\n            return html;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Process request of DeleteDocumentTemplate action\r\n     * @param documents\r\n     * @param noFiles\r\n     * @param downloadAllDocuments\r\n     */\r\n    resolveDocumentTemplateGenerate: function (documents, noFiles, downloadAllDocuments) {\r\n        // Redraw documents\r\n        this.redrawDocuments(documents, noFiles, downloadAllDocuments);\r\n        this.value = documents;\r\n\r\n        // This does not apply for mobile.\r\n        this.autoOpenDocuments();\r\n        this.configureHandlers();\r\n    },\r\n\r\n    /**\r\n     * Process request of DocumentTemplateGenerate action\r\n     * @param documents\r\n     * @param noFiles\r\n     * @param downloadAllDocuments\r\n     */\r\n    resolveDeleteDocumentTemplate: function (documents, noFiles, downloadAllDocuments) {\r\n        // Redraw documents\r\n        this.redrawDocuments(documents, noFiles, downloadAllDocuments);\r\n        this.value = documents;\r\n\r\n        // This does not apply for mobile.\r\n        this.configureHandlers();\r\n    },\r\n\r\n    /**\r\n     * Method to renders the documents\r\n     * @param documents\r\n     * @returns {string}\r\n     */\r\n    renderDocumentsHtml: function (documents) {\r\n        var items = \"\";\r\n\r\n        for (var i = 0; i < documents.length; i++) {\r\n            var document = {id: documents[i][0], fileName: documents[i][1]};\r\n            var item = this.renderDocumentItem(document);\r\n\r\n            items += item;\r\n        }\r\n\r\n        return items;\r\n    },\r\n\r\n    /**\r\n     * Methos to renders action of document\r\n     * @param documents\r\n     * @param noFiles\r\n     * @param downloadAllDocuments\r\n     * @returns {string}\r\n     */\r\n    renderActionsHtml: function (documents, noFiles, downloadAllDocuments) {\r\n        var actions = \"\";\r\n\r\n        if (downloadAllDocuments && (!noFiles && documents.length > 0)) {\r\n            var downloadAllDocumentsLink = {fileName: this.getResource(\"render-document-downloadalldocuments\")};\r\n            var action = this.renderAllDocumentDownload(downloadAllDocumentsLink);\r\n\r\n            actions += action;\r\n        }\r\n\r\n        return actions;\r\n    },\r\n\r\n    getTemplate: function () {\r\n        return \"document\";\r\n    },\r\n\r\n    getTemplateItem: function () {\r\n        return \"document-item\";\r\n    },\r\n\r\n    getErrorTemplate: function () {\r\n        return \"form-error\";\r\n    },\r\n\r\n    getTemplateDownload: function () {\r\n        return \"document-download\";\r\n    },\r\n\r\n    getTemplateReadonly: function () {\r\n        return \"document-readonly\";\r\n    }\r\n\r\n});","/*\r\n*   Name: Bizagi Render Cascading Combo Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define basic stuff for cascading combo renders\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.cascadingCombo\", {\r\n    // Statics\r\n    BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n    BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX\r\n}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(params);\r\n\r\n        // Create dependency collection\r\n        self.dependants = [];\r\n        self.isDependant = false;\r\n    },\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.hasLocalData = bizagi.util.isEmpty(properties.parentCombo) ? properties.hasLocalData : false;\r\n\r\n        if (properties.value && properties.value.id === undefined)\r\n            properties.value = null;\r\n\r\n        self.value = properties.value;\r\n\r\n        // Add empty node if configured\r\n        if (properties.hasLocalData)\r\n            properties.data = self.complementData(properties.data);\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        // Check if this is a dependant combo\r\n        var parentCombo = self.parentCombo = self.getParentCombo();\r\n        if (parentCombo != null) {\r\n            var renderType = bizagi.util.normalizeType(parentCombo.properties.type);\r\n\r\n            if (/^cascadingcombo$/i.test(renderType)) {\r\n                self.isDependant = true;\r\n            }\r\n        }\r\n\r\n        // Apply element plugin, set a flag to avoid dependant combo ajax requests\r\n        self.initializingCascadingCombo = true;\r\n\r\n        // Call base\r\n        var result = this._super();\r\n\r\n        if (mode !== \"execution\") {\r\n            self.initializingCascadingCombo = false;\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        self.initializingCascadingCombo = false;\r\n\r\n        // Bind with parent combo\r\n        if (self.isDependant) {\r\n            self.parentCombo.bindDependantCombo(self);\r\n        }\r\n    },\r\n\r\n    configureReadOnlyHandlers: function () {\r\n        var self = this;\r\n        self.initializingCascadingCombo = false;\r\n\r\n        // Bind with parent combo\r\n        if (self.isDependant) {\r\n            self.parentCombo.bindDependantCombo(self);\r\n        }\r\n    },\r\n    /*\r\n    *   Refresh the combo, after it has been painted\r\n    */\r\n    refresh: function (params, isInitialValue) {\r\n        var self = this;\r\n\r\n        // Wait until current element is rendered\r\n        $.when(self.isRendered()).done(function () {\r\n\r\n            // Unbind previous handler\r\n            // self.parentCombo.unbindDependantCombo(self);\r\n\r\n            // Clear current control\r\n            var control = self.getControl();\r\n            var mode = self.getMode();\r\n            control.empty();\r\n\r\n            // Render combo again\r\n            $.when(self.renderCombo(params)).then(function (html) {\r\n                // Append new element\r\n                control.html(html);\r\n\r\n                // Post-render method\r\n                self.postRender();\r\n\r\n                if (mode == \"execution\") {\r\n                    self.configureHandlers();\r\n                }\r\n\r\n                // Set current value\r\n                if (self.getValue() !== undefined) {\r\n                    self.setDisplayValue(self.getValue());\r\n                }\r\n\r\n                if (self.deferredVisible) {\r\n                    self.deferredVisible.resolve();\r\n                }\r\n\r\n                self.trigger(\"select\", [self.value, isInitialValue]);\r\n\r\n            });\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Fetch the data into a deferred\r\n    */\r\n    getData: function (params) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        // Just execute ajax calls when rendering in execution mode\r\n        if (mode != \"execution\") return self.getDummyData();\r\n\r\n        // Do not load dependant combos when there are no parent id\r\n        if (self.isDependant) {\r\n            if (self.parentCombo && params) {\r\n                self.properties.remoteDataLoaded = false;\r\n            }\r\n\r\n            // Return an empty array when there are no parent defined when the combo is dependant\r\n\r\n            var parentValue = (self.parentCombo.selectedValue) ? self.parentCombo.selectedValue.id : '';\r\n\r\n            if (parentValue != '') {\r\n                return this._super(params);\r\n            } else {\r\n                return [];\r\n            }\r\n        }\r\n\r\n        return this._super(params);\r\n    },\r\n\r\n\r\n    /* \r\n    *   Bind the combos to create the cascading feature\r\n    */\r\n    bindDependantCombo: function (dependantCombo) {\r\n        var self = this;\r\n        var renderType = bizagi.util.normalizeType(dependantCombo.properties.type);\r\n\r\n        // Check it is a cascading combo\r\n        if (/^cascadingcombo$/i.test(renderType)) {\r\n\r\n            // Append to dependant combos\r\n            self.dependants.push(dependantCombo);\r\n\r\n            // When this combo is selected we need to make the other combo to auto fill with an extra filter\r\n            dependantCombo.onChangeFunction = function (event, item, isInitialValue) {\r\n                // Fill items for next combo\r\n                self.refreshDependantCombo(dependantCombo, item.id, self.focusDependant, isInitialValue);\r\n\r\n                //if initial value is true, it prevents deleting the next combo\r\n                if (!isInitialValue) {\r\n                    // Clean next inputs\r\n                    dependantCombo.cleanInput();\r\n                }\r\n            };\r\n\r\n            if (!self.isEventBinded(\"select\")) {\r\n                self.bind(\"select\", dependantCombo.onChangeFunction);\r\n            }\r\n\r\n            // After the event binding has been made, we need to fill the new dependant render if this instance (the parent) has a value\r\n            if (!bizagi.util.isEmpty(self.getValue())) {\r\n\r\n                // Auto fill dependant items with current value\r\n                if (self.properties.hasLocalData) {\r\n                    self.refreshDependantCombo(dependantCombo, self.getValue().id);\r\n                }\r\n\r\n            }\r\n        }\r\n    },\r\n    isEventBinded: function (event) {\r\n        if (typeof $._data(this.observableElement.get(0), \"events\") === \"undefined\") {\r\n            return false;\r\n        } else {\r\n            if (typeof $._data(this.observableElement.get(0), \"events\")[event] === \"undefined\") {\r\n                return false;\r\n            } else {\r\n                return true;\r\n            }\r\n        }\r\n    },\r\n\r\n\r\n    /* \r\n    *   Unbind the combos that are being redrawn\r\n    */\r\n    unbindDependantCombo: function (dependantCombo) {\r\n        // When this combo is selected we need to make the other combo to auto fill with an extra filter\r\n        this.unbind(\"select\", dependantCombo.onChangeFunction);\r\n    },\r\n\r\n    /*\r\n    *   Fills the next dependant combo based on the given value\r\n    */\r\n    refreshDependantCombo: function (dependant, parentValue, focus, isInitialValue) {\r\n        var self = this;\r\n        var params = {};\r\n        params[self.Class.BA_ACTION_PARAMETER_PREFIX + \"parent\"] = parentValue;\r\n\r\n        dependant.deferredVisible = $.Deferred();\r\n\r\n        if (!isInitialValue) {\r\n            // Clear dependant value\r\n            dependant.setValue(\"\", false);\r\n        }\r\n\r\n        dependant.refresh(params, isInitialValue);\r\n\r\n        if (focus) {\r\n            $.when(dependant.deferredVisible.promise()).done(function () {\r\n                dependant.inputCombo.trigger(\"click\");\r\n            });\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Empty html when render from action\r\n     */\r\n\r\n    emptyControlByChangeEditability: function () {\r\n        var control = this.getControl();\r\n        control.empty();\r\n    },\r\n\r\n    /* \r\n    *   Cleans the combo value\r\n    */\r\n    cleanInput: function () {\r\n        this.triggerHandler(\"select\", {id: 0});\r\n    },\r\n\r\n    /*\r\n    *   Search for the other cascading combo refering this one, by idRender\r\n    */\r\n    getParentCombo: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Check if parentCombo is defined\r\n        if (properties.parentCombo === undefined)\r\n            return null;\r\n\r\n        // Get form reference\r\n        var form = self.getFormContainer();\r\n        var renderType = bizagi.util.normalizeType(self.properties.type);\r\n        var controls = /^cascadingcombo$/i.test(renderType) ? form.getRenderByType(properties.type) : [];\r\n\r\n        var i = 0;\r\n        var j = 0;\r\n        var parents = [];\r\n\r\n        var control = null;\r\n\r\n        for (; i < controls.length; i++) {\r\n            if (properties.parentCombo === controls[i].properties.id) {\r\n                parents.push({control: controls[i], index: i});\r\n            }\r\n        }\r\n\r\n        if (parents.length > 1) {\r\n            var parentLength, parent, xpathParent, parentArray;\r\n\r\n            for (; j < parents.length; j++) {\r\n                parent = parents[j].control;\r\n                xpathParent = parent.properties.xpath;\r\n                parentArray = xpathParent.split(\".\");\r\n                parentLength = parentArray.length;\r\n                xpathParent = parentArray.slice(0, parentLength - 1).join(\".\");\r\n\r\n                if (xpathParent === properties.xpath) {\r\n                    control = controls[parents[j].index];\r\n                    break;\r\n                }\r\n            }\r\n        } else {\r\n            control = form.getRenderById(properties.parentCombo);\r\n        }\r\n\r\n        // Return parent combo\r\n        return control;\r\n    },\r\n\r\n    /* \r\n    *  Method to determine if the render value can be sent to the server or not\r\n    */\r\n    canBeSent: function () {\r\n        var self = this;\r\n\r\n        // If the render has dependants we can't send to the server\r\n        return self._super() && bizagi.util.isMapEmpty(self.dependants);\r\n    },\r\n\r\n    /*\r\n    *   Determines if we need to show the current data regardless if it belongs to data or not\r\n    *   Can be overriden to change behaviour\r\n    */\r\n    showCurrentData: function () {\r\n        var mode = this.getMode();\r\n\r\n        if (mode != \"execution\") return true;\r\n        return false;\r\n    },\r\n\r\n    /*\r\n    *   Enables submit on change feature for the current render\r\n    */\r\n    configureSubmitOnChange: function () {\r\n        var self = this;\r\n\r\n        if (!self.configured) {\r\n            // Call super\r\n            self._super();\r\n            self.configured = true;\r\n        }\r\n    },\r\n\r\n    internalSubmitOnChange: function (data, bRefreshForm) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        if (self.isDependant && self.canBeSent() && self.itemSelected !== undefined)\r\n            return self._super(data, bRefreshForm);\r\n        return defer.resolve();\r\n    },\r\n    /*\r\n    *   Sets the initial value for the renders\r\n    */\r\n    internalSetInitialValue: function () {\r\n        var self = this;\r\n        // Call original method\r\n        self._super();\r\n\r\n        if (self.value && self.isDependant == false) {\r\n            self.internalSetInitialValueFlag = true;\r\n            self.trigger(\"select\", [self.value, true]);\r\n        }\r\n\r\n        self.internalSetInitialValueFlag = false;\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: Bizagi Render List Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define basic stuff for list renders\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.list\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data \r\n     * @returns {} \r\n     */\r\n    initializeData: function(data) {      \r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.listSize = properties.listSize || 0;\r\n    },\r\n\r\n    /**\r\n     * Gets the template used by the combo render can be overriden in subclasses\r\n     * to reuse logic and just change the template\r\n     * @returns {} \r\n     */\r\n    getTemplateName: function() {\r\n        return \"list\";\r\n    },\r\n\r\n    /**\r\n     * Determines if we need to show the current data regardless if it belongs\r\n     * to data or not Can be overriden to change behaviour    \r\n     * @returns {} \r\n     */\r\n    showCurrentData: function() {\r\n        return false;\r\n    }\r\n\r\n});","/*\r\n *   Name: Bizagi Render MultiSelect Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for multiselect renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.multiSelect\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.editable = bizagi.util.parseBoolean(properties.editable) !== null ? bizagi.util.parseBoolean(properties.editable) : true;\r\n        properties.maxRecords = Number(properties.maxRecords) || 20;\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*|jQuery}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"list-multiselect\");\r\n\r\n        return $.fasttmpl(template, {\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            editable: properties.editable,\r\n            align: properties.valueAlign\r\n        }, {\r\n            formatItem: self.formatItem\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     */\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"list-multiselect\");\r\n\r\n        return $.fasttmpl(template, {\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            editable: properties.editable,\r\n            align: properties.valueAlign\r\n        }, {\r\n            formatItem: self.formatItem\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Fetch the data into a deferred\r\n     * @returns {*[]}\r\n     */\r\n    getData: function () {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n        var properties = this.properties;\r\n\r\n        // Go to server\r\n        self.dataService.multiaction().getData({\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            contexttype: properties.contexttype || null,\r\n            idPageCache: properties.idPageCache\r\n        }).done(function (data) {\r\n\r\n            properties.data = data;\r\n            defer.resolve(properties.data);\r\n\r\n        }).fail(function (data) {\r\n            if (data.type === \"not-processed\")\r\n                return;\r\n\r\n            // Show error from server\r\n            var auxMsg = \"\";\r\n            var form = self.getFormContainer();\r\n            var msgObj = self.properties.displayName + \": \";\r\n\r\n            if (typeof data == \"string\") {\r\n                auxMsg = JSON && JSON.parse(data) || $.parseJSON(data);\r\n            } else {\r\n                auxMsg = data;\r\n            }\r\n\r\n            msgObj += auxMsg.message;\r\n\r\n            form.addValidationMessage(msgObj);\r\n\r\n            defer.reject(data);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Sets the internal value\r\n     * @param value\r\n     * @param triggerEvents\r\n     */\r\n    setValue: function (value, triggerEvents) {\r\n        triggerEvents = triggerEvents !== undefined ? triggerEvents : true;\r\n\r\n        value = JSON.encode({\"value\": value});\r\n\r\n        this._super(value, triggerEvents);\r\n    },\r\n\r\n    /**\r\n     * Sets the value in the rendered control\r\n     * @param value\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n\r\n        // Set internal value\r\n        self.setValue(value, false);\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {boolean}\r\n     */\r\n    canBeSent: function () {\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * Returns the internal value\r\n     * @returns {*|Array}\r\n     */\r\n    getValue: function () {\r\n        return this.value || [];\r\n    },\r\n\r\n    /**\r\n     * Get list of data\r\n     * @returns {*|Array}\r\n     */\r\n    getDataValue: function () {\r\n        var list;\r\n\r\n        try {\r\n            list = JSON.parse(this.value);\r\n\r\n            return list.value || [];\r\n        } catch (e) {\r\n            return [];\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Check if a render has no value for required validation\r\n     * @returns {*|Array|boolean}\r\n     */\r\n    hasValue: function () {\r\n        var values = this.getDataValue();\r\n\r\n        return values && values.length > 0;\r\n    },\r\n\r\n    getElementsToStylize: function (context) {\r\n        return $(\".bz-multiselect .bz-multiselect__tag:not(.bz-multiselect__plus)\", context);\r\n    },\r\n\r\n    /**\r\n     * Add elements to global value\r\n     * @param value\r\n     */\r\n    addElement: function (value) {\r\n        var newValue = this.getDataValue();\r\n\r\n        newValue.push(value);\r\n\r\n        this.setValue(newValue);\r\n    },\r\n\r\n    /**\r\n     * Remove elements to global value\r\n     * @param value\r\n     */\r\n    removeElement: function (value) {\r\n        var idToRemove = value.id;\r\n        var newValue = this.getDataValue()\r\n            .filter(function (item) {\r\n                return item.id !== idToRemove;\r\n            });\r\n\r\n        this.setValue(newValue);\r\n    },\r\n\r\n    /**\r\n     * Submit the selected data to the server in order to be saved\r\n     */\r\n    submitData: function () {\r\n        var data = {};\r\n\r\n        // Add current data\r\n        data[this.properties.xpath] = this.getValue();\r\n\r\n        // Executes submit on change\r\n        this.submitOnChange(data);\r\n    },\r\n\r\n    /**\r\n     * Mark a item how checked\r\n     * @param id\r\n     * @returns {*}\r\n     */\r\n    markAsChecked: function (id) {\r\n        var self = this;\r\n\r\n        return self.selected.some(function (item, index) {\r\n            var found = item.id === id;\r\n\r\n            if (found) self.selected.splice(index, 1);\r\n            return found;\r\n        });\r\n    },\r\n\r\n    isChecked: function (values, id) {\r\n        return values.some(function (item) {\r\n            return item.id == id;\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to verify if can add more items\r\n     * @param $tagsContainer\r\n     * @returns {boolean}\r\n     */\r\n    canAddMoreItems: function ($tagsContainer) {\r\n        var self = this;\r\n        var containerWidth = parseInt($tagsContainer.css(\"width\"));\r\n        var $children = $tagsContainer.children();\r\n\r\n        var childrenWidth = $children\r\n            .toArray()\r\n            .reduce(function (acc, child) {\r\n                acc += self.getElementWidth(child);\r\n                return acc;\r\n            }, 0);\r\n\r\n        return containerWidth > (childrenWidth + self.Class.MORE_OPTION_WIDTH)\r\n\r\n    },\r\n\r\n    /**\r\n     * getElementWidth\r\n     * @param element\r\n     * @returns {*}\r\n     */\r\n    getElementWidth: function (element) {\r\n        var styles = window.getComputedStyle(element);\r\n        var outerWidth = $(element).outerWidth();\r\n        return outerWidth + [\r\n            \"padding-left\",\r\n            \"padding-right\",\r\n            \"margin-left\",\r\n            \"margin-right\"\r\n        ].reduce(function (acc, property) {\r\n            acc += parseInt(styles[property]);\r\n            return acc;\r\n        }, 0);\r\n    },\r\n\r\n    /**\r\n     * Filtering list of elements\r\n     * @param query\r\n     * @param $container\r\n     */\r\n    filterList: function (query, $container) {\r\n\r\n        $container.filter(function () {\r\n            var stringContainer = $(this).text().toUpperCase();\r\n            var stringToSearch = query.toUpperCase();\r\n\r\n            if (stringContainer.indexOf(stringToSearch) >= 0) {\r\n                return $(this);\r\n            } else {\r\n                $(this).hide();\r\n            }\r\n        }).show();\r\n\r\n    },\r\n\r\n    /**\r\n     * addSelectedElements\r\n     */\r\n    addSelectedElements: function () {\r\n    },\r\n\r\n    /**\r\n     * Find item by id\r\n     * @param id\r\n     * @returns {[]}\r\n     */\r\n    findItemById: function (id) {\r\n        return (this.properties.data || []).find(function (item) {\r\n            return item.id == id;\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Formats value of each item\r\n     * @param {string, boolean or array} value\r\n     * @example\r\n     * value = \"string\" => \"string\"\r\n     * value = true => \"yes\" or \"si\", the localized value\r\n     * value = false => \"no\", the localized value\r\n     * value = [\"string 1\", \"string 2\"] => \"string 1 - string 2\"\r\n     * @returns {string}\r\n     */\r\n    formatItem: function (value) {\r\n        return bizagi.util.formatItem(value);\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: Bizagi Render Search List Control\r\n*   Author: UI Forms Team\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.searchList\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data \r\n     * @returns {} \r\n     */\r\n    initializeData: function(data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.maxRecords = Number(properties.maxRecords) || 20;\r\n        properties.editable = bizagi.util.parseBoolean(properties.editable) !== null ? bizagi.util.parseBoolean(properties.editable) : true;\r\n\r\n        // Set value\r\n        self.setValue(properties.value);\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {} \r\n     */\r\n    renderControl: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"searchList\");\r\n\r\n        return $.fasttmpl(template, {\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            value: properties.value,\r\n            allowTyping: properties.allowTyping,\r\n            items: properties.value,\r\n            hasSearchForm: properties.searchForms ? true : false,\r\n            editable: properties.editable\r\n        }, {\r\n            formatItem: self.formatItem\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {} \r\n     */\r\n    renderReadOnly: function() {\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * Sets the internal value\r\n     * @param {} value \r\n     * @returns {} \r\n     */\r\n    setValue: function(value) {\r\n        this.value = JSON.encode({ \"value\": value });\r\n        this.triggerRenderChange();\r\n    },\r\n\r\n    /**\r\n     * Add elements to global value\r\n     * @param value = { id:integer,value:[string || array] }\r\n     * @returns {} \r\n     */\r\n    addElement: function(value) {\r\n        var list = JSON.parse(this.value);\r\n\r\n        list.value.push(value);\r\n\r\n        this.setValue(list.value);\r\n    },\r\n\r\n    /**\r\n     * Remove elements to global value\r\n     * @param value = { id:integer }\r\n     * @returns {} \r\n     */\r\n    removeElement: function(value) {\r\n        var list = JSON.parse(this.value);\r\n        var result = [];\r\n\r\n        $.each(list.value, function(key, val) {\r\n            if (val.id != value.id) {\r\n                result.push({ id: val.id, value: val.value });\r\n            }\r\n        });\r\n\r\n        this.setValue(result);\r\n    },\r\n\r\n    /**\r\n     * Remove last element to global value\r\n     * @returns {} \r\n     */\r\n    removeLastElement: function() {\r\n        var list = JSON.parse(this.value);\r\n\r\n        if (list.value.length > 0) {\r\n            list.value.pop();\r\n            this.setValue(list.value);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Fetch the data into a deferred\r\n     * @param {} params \r\n     * @returns {} \r\n     */\r\n    getData: function(params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n\r\n        // Resolve with remote data\r\n        self.dataService.getSearchData({\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            term: properties.term,\r\n            extra: params\r\n        }).done(function(data) {\r\n            // Resolve with fetched data\r\n            properties.data = data;\r\n            defer.resolve(properties.data);\r\n        }).fail(function(data) {\r\n            var hideStatus = data.hideStatus || false;\r\n\r\n            defer.resolve({});\r\n\r\n            if (!hideStatus) {\r\n                self.trigger(\"onSearchError\", data);\r\n            }\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Submits the selected data to the server in order to be saved\r\n     * @returns {} \r\n     */\r\n    submitData: function() {\r\n        var data = {};\r\n\r\n        // Add current data\r\n        data[this.properties.xpath] = this.getValue();\r\n\r\n        // Executes submit on change\r\n        this.submitOnChange(data);\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {} \r\n     */\r\n    canBeSent: function() {\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * Check if the control has value\r\n     * @returns {} \r\n     */\r\n    hasValue: function() {\r\n        var list = this.getListItems();\r\n\r\n        return list.length > 0;\r\n    },\r\n\r\n    getListItems: function(){\r\n        var value = this.getValue();\r\n        var finalValue = typeof (value) === \"string\" ? JSON.parse(value).value : value.value;\r\n\r\n        return finalValue || [];\r\n    },\r\n    \r\n    /**\r\n     * Formats value of each item\r\n     * @param {string, boolean or array} value\r\n     * @example\r\n     * value = \"string\" => \"string\"\r\n     * value = true => \"yes\" or \"si\", the localized value\r\n     * value = false => \"no\", the localized value\r\n     * value = [\"string 1\", \"string 2\"] => \"string 1 - string 2\"\r\n     * @returns {string}\r\n     */\r\n    formatItem: function (value) {\r\n        return bizagi.util.formatItem(value);\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Money Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for money numbers\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.money\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param {} data\r\n     * @returns {}\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = self.properties;\r\n        var format = this.getResource(\"numericFormat\");\r\n\r\n        // Configures symbol\r\n        properties.showsymbol = typeof (properties.showsymbol) !== \"undefined\" ? properties.showsymbol : true;\r\n\r\n        if (properties.showsymbol) {\r\n            var symbol = typeof (BIZAGI_DEFAULT_CURRENCY_INFO) !== \"undefined\" ? BIZAGI_DEFAULT_CURRENCY_INFO.symbol : format.symbol;\r\n            properties.symbol = properties.currencySymbol ? properties.currencySymbol : symbol;\r\n        } else {\r\n            properties.symbol = \"\";\r\n        }\r\n\r\n        properties.groupDigits = true;\r\n    }\r\n\r\n});\r\n","/**\r\n *   Name: Bizagi Render Radio Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define basic stuff for radio renders\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.radio\", {}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.horizontal = bizagi.util.parseBoolean(properties.horizontal) || false;\r\n\r\n        // Set a random identifier to fix a problem when using radio buttons inside grids and the plugin mismatch the elements because all of them have the same name\r\n        properties.unique = bizagi.util.randomNumber(1000, 1000000);\r\n    },\r\n\r\n    /**\r\n     * Gets the template used by the combo render\r\n     * Can be overridden in subclasses to reuse logic and just change the template\r\n     * @returns {string}\r\n     */\r\n    getTemplateName: function () {\r\n        return \"radio\";\r\n    },\r\n\r\n    /**\r\n     * Determines if we need to show the empty node or not\r\n     * Can be overridden to change behaviour\r\n     * @returns {boolean}\r\n     */\r\n    showEmpty: function () {\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Determines if we need to show the current data regardless if it belongs to data or not\r\n     * Can be overridden to change behaviour\r\n     * @returns {boolean}\r\n     */\r\n    showCurrentData: function () {\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Adds custom parameters to process the template\r\n     * @returns {{vertical: boolean}}\r\n     */\r\n    getTemplateParams: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        return {\r\n            vertical: !properties.horizontal,\r\n            horizontal: properties.horizontal\r\n        };\r\n    },\r\n\r\n    /**\r\n     * Cleans current data\r\n     */\r\n    cleanData: function () {\r\n        var self = this;\r\n        var value = {id: \"\", label: \"\"};\r\n        var selectedItem = self.element.find(\".ui-radio-state-checked\");\r\n\r\n        selectedItem.removeClass(\"ui-radio-state-checked\");\r\n        self.setDisplayValue(value);\r\n        self.setValue(value, false);\r\n        self.clearDisplayValue();\r\n    },\r\n\r\n    /**\r\n     * Check value of control is changed\r\n     * @returns {boolean}\r\n     */\r\n    controlValueIsChanged: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var value = self.getValue();\r\n        var compareValue = properties.originalValue;\r\n        var baseValue = properties.defaultValue;\r\n\r\n        var result = true;\r\n\r\n        if (value && value.length !== undefined) {\r\n            value = value[0];\r\n        }\r\n        if (compareValue && compareValue.length !== undefined) {\r\n            compareValue = compareValue[0];\r\n        }\r\n        if (baseValue && baseValue.length !== undefined) {\r\n            baseValue = baseValue[0];\r\n        }\r\n\r\n        value = value && value.id !== undefined ? value.id : value;\r\n        compareValue = compareValue && compareValue.id !== undefined ? compareValue.id : compareValue;\r\n        baseValue = baseValue && baseValue.id !== undefined ? baseValue.id : baseValue;\r\n\r\n        if (baseValue !== undefined) {\r\n            if ((baseValue == value) && (value == compareValue)) {\r\n                result = false;\r\n            } else {\r\n                if ((value === null || value === \"\") && (compareValue === null || compareValue === \"\")) {\r\n                    result = false;\r\n                } else {\r\n                    result = (compareValue == value) ? false : true;\r\n                }\r\n            }\r\n        } else {\r\n            if ((value === null || value === \"\") && (compareValue === null || compareValue === \"\")) {\r\n                result = false;\r\n            } else {\r\n                result = (compareValue == value) ? false : true;\r\n            }\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n});\r\n\r\n","/*\r\n*   Name: BizAgi User field render\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define the basic behavior for userfields\r\n*/\r\n$.Class.extend(\"bizagi.rendering.userfieldDefinition\", {}, {\r\n\r\n    /*************************************************************/\r\n    /* Private section of the userfield                          */\r\n    /*************************************************************/\r\n\r\n    /*\r\n    *   Method to be overriden by userfields in order to ensure that custom files are loaded before the execution\r\n    */\r\n    getFileDependencies: function () {\r\n        return null;\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        var defer = $.Deferred();\r\n        var fileDependencies = self.getFileDependencies();\r\n        if (fileDependencies && fileDependencies.length > 0) {\r\n            bizagi.loader.loadFile(fileDependencies)\r\n\t\t\t.then(function () {\r\n\t\t\t    // After all dependencies has been resolved\r\n\t\t\t    self.internalRenderControl();\r\n\t\t\t    defer.resolve();\r\n\t\t\t});\r\n\r\n        } else {\r\n            $.when( self.renderUserfieldControl()).done(function () {\r\n                defer.resolve();\r\n            });\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    renderUserfieldControl: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var def = new $.Deferred();\r\n\r\n        if (properties.extendedData && properties.extendedData.length > 0) {\r\n            self.extendedData = bizagi.services.ajax.parseJSON(properties.extendedData);\r\n        } else {\r\n            self.extendedData = {};\r\n        }\r\n\r\n\r\n        var loadUserfield = function () {\r\n            var userEditableControl = self.getEditableControl();\r\n            if (userEditableControl) {\r\n                self.input = control.html(userEditableControl);\r\n            }\r\n            self.renderComplex();\r\n            def.resolve();\r\n        };\r\n\r\n        \r\n            loadUserfield();\r\n    \r\n        \r\n        return def.promise();\r\n    },\r\n\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n\r\n        if (properties.extendedData && properties.extendedData.length > 0) {\r\n            self.extendedData = bizagi.services.ajax.parseJSON(properties.extendedData);\r\n        } else {\r\n            self.extendedData = {};\r\n        }\r\n\r\n        var loadUserfieldReadOnly = function () {\r\n            try {\r\n                var userReadOnlyControl = self.getReadonlyControl();\r\n                if (userReadOnlyControl) {\r\n                    self.input = control.html(userReadOnlyControl);\r\n                }                                                 \r\n                self.renderComplex();\r\n                \r\n            } catch (error) {\r\n                var displayName = self.properties.displayName || \"Widget\";\r\n                control.html(\"<h6>\" + displayName  + \"</h6>\")\r\n            }\r\n            \r\n        };\r\n\r\n        if (self.ready) {\r\n            self.ready().done(function () {\r\n                loadUserfieldReadOnly();\r\n            });\r\n        } else {\r\n            loadUserfieldReadOnly();\r\n        }\r\n    },\r\n\r\n    getDisplayValue: function () {\r\n        var self = this;\r\n        return self.getReadonlyValue();\r\n    },\r\n\r\n    /*\r\n    *   Sets the value in the rendered control \r\n    */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self.setValue(value);\r\n\r\n        // Set editable value in control\r\n        self.setEditableValue(value);\r\n    },\r\n\r\n    getValue: function () {\r\n        var self = this;\r\n        return self.getEditableValue();\r\n    },\r\n\r\n    getPropertyValue: function (propertyName, params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n        self.dataService.multiaction().getPropertyData({\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            property: propertyName,\r\n            extra: params,\r\n            dataType: params ? params.dataType : null\r\n        }).done(function (data) {\r\n            if (data.type == \"error\") {\r\n                // Workflow engine error, we gotta show it with error\r\n                self.getFormContainer().addErrorMessage(data.message);\r\n                defer.reject(data);\r\n            } else {\r\n                defer.resolve(data);\r\n            }\r\n        }).fail(function (jqXHR, textStatus, errorThrown) {\r\n            defer.reject(jqXHR, textStatus, errorThrown);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n    *   Saves the form\r\n    */\r\n    saveForm: function () {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        return form.saveForm();\r\n    },\r\n\r\n    /**\r\n    * Returns all the elements that match the given xpath\r\n    */\r\n    getRenderElements: function (xpath) {\r\n        var self = this;\r\n        var result = $();\r\n        var controls = self.getFormContainer().getRenders(xpath);\r\n        $.each(controls, function (i, item) {\r\n            result = result.add($(item.element));\r\n        });\r\n\r\n        return result;\r\n    },\r\n\r\n    getServerResourceURL: function (resource) {\r\n        var self = this;\r\n        var url = \"Rest/Userfields/{0}/resource/{1}/{2}\";\r\n        url = url.replace(\"{0}\", self.properties.userfieldGuid);\r\n        resource = resource.replace(\"\\\\\", \"__\").replace(\"/\", \"__\");\r\n        var device = bizagi.util.detectDevice();\r\n        url = url.replace(\"{1}\", device);\r\n        url = url.replace(\"{2}\", resource);\r\n        //Rest/Userfields/{0}/resource/desktop/{1}\r\n        return url;\r\n    },\r\n\r\n    /**\r\n    * Returns all the elements that match the given xpath\r\n    */\r\n    getRenderValue: function (xpath) {\r\n        var self = this;\r\n        var controls = self.getFormContainer().getRenders(xpath);\r\n        var control;\r\n        $.each(controls, function (index, item) {\r\n            if (!control || item.properties.editable) {\r\n                control = item;\r\n            }\r\n        });\r\n        if (control) {\r\n            return control.getValue();\r\n        } else {\r\n            return null;\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Refresh the current form\r\n    */\r\n    refreshForm: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var form = self.getFormContainer();\r\n        form.refreshForm(properties.id);\r\n    },\r\n\r\n    /*\r\n    * Shows a jquery dialog\r\n    */\r\n    showDialog: function (url, params) {\r\n        bizagi.util.mustImplement(\"Must implement the showDialog method\");\r\n    },\r\n\r\n    /*\r\n    *   Shows a browser popup\r\n    */\r\n    showPopup: function (url, params) {\r\n        bizagi.util.mustImplement(\"Must implement the showPopup method\");\r\n    },\r\n\r\n    updateOriginalValue: function () {\r\n        var self = this;\r\n        self.properties.originalValue = self.value = self.properties.value;\r\n    }\r\n\r\n\r\n});\r\n\r\n\r\n$.Class.extend(\"bizagi.rendering.basicUserField\", {}, {\r\n\r\n    /*************************************************************/\r\n    /* methods to be overriden by the implementations            */\r\n    /*************************************************************/\r\n    getEditableControl: function () {\r\n    },\r\n\r\n    renderComplex: function () {\r\n    },\r\n\r\n    // Returns the value of the control\r\n    getEditableValue: function () {\r\n        return bizagi.rendering.render.prototype.getValue.apply(this, arguments);\r\n    },\r\n\r\n    // \r\n    setEditableValue: function (value) {\r\n        return bizagi.rendering.render.prototype.setValue.apply(this, arguments);\r\n    },\r\n\r\n    getReadonlyControl: function () {\r\n    },\r\n\r\n    getReadonlyValue: function () {\r\n        // if the method is not overriden then call the parent method \r\n        return bizagi.rendering.render.prototype.getDisplayValue.apply(this, arguments);\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n    }\r\n\r\n});\r\n\r\n/*\r\n*   This control will wrap any userfield in order to load the code remotely, \r\n*   when executing renderControl, which is an async method\r\n*/\r\n$.Class.extend(\"bizagi.rendering.userfieldWrapper\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(params);\r\n        // Save userfield guid and name\r\n        self.initialParams = params;\r\n        self.userfieldGuid = this.properties.userfieldGuid;\r\n        self.userfieldName = this.properties.control;\r\n    },\r\n\r\n    /*\r\n    *   Returns the in-memory processed element\r\n    */\r\n    internalPostRender: function () {\r\n        var self = this;\r\n        $.when(self.getUserfieldControl())\r\n        .done(function (control) {\r\n            control.element = self.element;\r\n\r\n            // Add grid and surrogatekey properties if the userfield is a column userfield\r\n            if (self.column) {\r\n                control.isColumn = true;\r\n                control.grid = self.grid;\r\n                control.surrogateKey = self.surrogateKey;\r\n                control.properties.xpathContext = self.getControlXpathContext(control);\r\n                control.getControl = self.column.getControl;\r\n            }\r\n\r\n            return control.internalPostRender();\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Helper for userfields to fetch the xpathContext\r\n    */\r\n    getControlXpathContext: function (control) {\r\n        var self = this;\r\n        var properties = control.properties;\r\n\r\n        if (control.isColumn) {\r\n            return properties.xpathContext.length > 0 ? properties.xpathContext + \".\" + control.grid.properties.xpath + \"[id=\" + control.surrogateKey + \"]\" : control.grid.properties.xpath + \"[id=\" + control.surrogateKey + \"]\";\r\n        }\r\n\r\n        return properties.xpathContext;\r\n    },\r\n\r\n\r\n    getUserFieldInstance: function(params){\r\n        console.log(\"not implemented\");\r\n    },\r\n\r\n    /*\r\n    *   Replicate all userfield methods to this instance in order to create a proxy\r\n    */\r\n    replicateUserfieldMethods: function (control) {\r\n        var self = this;\r\n        for (var key in control.Class.prototype) {\r\n            // Omit the folowing methods\r\n            if (key == \"init\" || key == \"constructor\" || key == \"Class\" || key == \"subscribe\" || key == \"unsubscribe\" ||\r\n                key == \"publish\" || key == \"render\" || key == \"triggerHandler\" || key == \"dispose\") continue;\r\n\r\n            // Replicate instance methods\r\n            self[key] = eval('var tmp = function(){ if (this.userfieldInstance) return this.userfieldInstance.' + key + '.apply(this.userfieldInstance, arguments); return null;};tmp');\r\n        }\r\n\r\n        // Replicate properties and value\r\n        control.properties = self.properties;\r\n        control.value = self.value;\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n\r\n        setTimeout(function () {\r\n            if (self.userfieldInstance) {\r\n                self.userfieldInstance.unbind(\"renderchange\");\r\n                self.userfieldInstance.dispose();\r\n            }\r\n        }, bizagi.override.disposeTime || 50);\r\n\r\n        // Call base\r\n        self._super();\r\n    }\r\n});\r\n\r\n","/**\r\n*   Name: Bizagi Render Image Class\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will define basic stuff for image control\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.image\", {\r\n    // Statics\r\n    BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n    BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\r\n    BA_PAGE_CACHE: bizagi.render.services.service.BA_PAGE_CACHE\r\n}, {\r\n\r\n    /**\r\n     * Update or init the element data\r\n     * @param data\r\n     */\r\n    initializeData: function (data) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(data);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        var maxSize = 4091904;\r\n\r\n        if(properties.maxSize) {\r\n            maxSize = Number(properties.maxSize);\r\n        } else if (typeof (BIZAGI_SETTINGS) !== \"undefined\" && typeof (BIZAGI_SETTINGS.UploadMaxFileSize) !== \"undefined\") {\r\n            maxSize = Number(BIZAGI_SETTINGS.UploadMaxFileSize);\r\n        }\r\n\r\n        properties.maxSize = maxSize;\r\n        properties.editable = bizagi.util.parseBoolean(properties.editable) === true;\r\n        properties.validExtensions = properties.validExtensions || \"\";\r\n\r\n        if (properties.validExtensions.length > 0 && properties.validExtensions.indexOf(\".\") < 0) {\r\n            var singleExtensions = properties.validExtensions.replace(/\\ /gi, '').split(\";\");\r\n\r\n            for (var i = 0; i < singleExtensions.length; i++) {\r\n                if (singleExtensions[i].length != 0) {\r\n                    singleExtensions[i] = \"*.\" + singleExtensions[i].replaceAll(\" \", \"\");\r\n                } else {\r\n                    //Removes the empty element\r\n                    var index = singleExtensions.indexOf(singleExtensions[i]);\r\n                    singleExtensions.splice(i, 1);\r\n                }\r\n            }\r\n\r\n            properties.validExtensions = singleExtensions.join(\";\");\r\n        }\r\n\r\n        properties.addUrl = properties.addUrl || self.dataService.getUploadAddFileUrl(properties.isUserPreference);\r\n        properties.allowDelete = bizagi.util.parseBoolean(properties.allowDelete) !== null\r\n\r\n        properties.isAutoWidth = false;\r\n        properties.isAutoHeight = false;\r\n\r\n        if (properties.width === -1) {\r\n            properties.width = \"100%\";\r\n            properties.isAutoWidth = true;\r\n        } else {\r\n            properties.width = properties.width + \"px\";\r\n        }\r\n\r\n        if (properties.height === -1) {\r\n            properties.height = \"auto\";\r\n            properties.isAutoHeight = true;\r\n        } else {\r\n            properties.height = properties.height + \"px\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * @returns {*}\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var def = new $.Deferred(); //design\r\n        var template = self.renderFactory.getTemplate(\"image\");        \r\n\r\n        $.when(self.buildItemUrl()).done(function (dataUrl) {\r\n            if (!self.isDisposed()) {\r\n                self.properties.url = dataUrl !== \"\" ? dataUrl : \"\";\r\n                self.properties.value = self.value = self.properties.url.length > 0 ? [self.properties.url] : null;\r\n                self.setValue(self.properties.value);                \r\n\r\n                var html = $.fasttmpl(template, { url: self.properties.url });\r\n                def.resolve(html);\r\n            }\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {*}\r\n     */\r\n    renderReadOnly: function () {\r\n        var template = this.renderFactory.getTemplate(\"image-readonly\");\r\n        var html = $.fasttmpl(template);\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * This method return the name of template of items, please make a override in each device\r\n     * @returns {*}\r\n     */\r\n    getTemplateItem: function () {\r\n        return this.renderFactory.getTemplate(\"image-item\");\r\n    },\r\n\r\n    /**\r\n     * Renders a single upload item\r\n     * @param file\r\n     * @returns {*}\r\n     */\r\n    renderUploadItem: function (file) {\r\n        var self = this;\r\n        var mode = self.getMode();        \r\n        var def = new $.Deferred();\r\n        var template = self.getTemplateItem();\r\n\r\n        $.when(self.buildItemUrl()).done(function (dataUrl) {\r\n            var url = dataUrl || \"\";\r\n\r\n            var html = $.fasttmpl(template, {\r\n                url: url,\r\n                allowDelete: self.properties.allowDelete,\r\n                editable: self.properties.editable,\r\n                mode: mode,                \r\n            });\r\n\r\n            self.properties.url = url;\r\n            self.properties.value = url.length > 0 ? [url] : null;\r\n\r\n            def.resolve(html);\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Builds the upload item url\r\n     * @param params\r\n     * @returns {*}\r\n     */\r\n    buildItemUrl: function (params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var def = new $.Deferred();\r\n        var url = \"\";\r\n\r\n        if (!this.isExecutionMode()) {\r\n            url = \"\"; // TODO: Review the use of \"javascript:void(0);\";\r\n            def.resolve(url);\r\n        } else {\r\n            var parameters = {\r\n                url: properties.dataUrl,\r\n                xpath: properties.xpath,\r\n                idRender: properties.id,\r\n                xpathContext: properties.xpathContext,\r\n                idPageCache: properties.idPageCache,\r\n                property: params && params.property ? params.property : \"fileContent\",\r\n                dataType: \"text\"\r\n            };\r\n\r\n            if (properties.contexttype) {\r\n                parameters.contexttype = properties.contexttype;\r\n            }\r\n\r\n            if (properties.isUserPreference) {\r\n                self.currentUser = bizagi.currentUser.idUser;\r\n                parameters.xpathContext = \"@Context.Users[id == \" + self.currentUser + \"]\";\r\n                parameters.contexttype = \"entity\";\r\n                parameters.surrogatekey = self.currentUser;\r\n            }\r\n\r\n            self.dataService.multiaction().getPropertyData(parameters, \"text\")\r\n                .done(function (data) {\r\n                    if (data.charAt(0) === \"\\\"\") {\r\n                        data = data.slice(1, -1);\r\n                    }\r\n\r\n                    if (data !== \"\") {\r\n                        url = \"data:image/png;base64,\" + data;\r\n                    }\r\n\r\n                    def.resolve(url);\r\n                });\r\n        }\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    buildItemUrlOffline: function(parameters){\r\n        var def = new $.Deferred();\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var formParams = self.getFormParams();\r\n        var parameters = {\r\n            idCase: formParams.idCase,\r\n            idWorkitem: formParams.idWorkitem,\r\n            id: properties.xpath,\r\n            offlineType: formParams.offlineType\r\n        }\r\n        $.when(self.dataService.getOfflineImage(parameters, \"base64\"))\r\n        .done( function(imageValue){\r\n            properties.value = imageValue;\r\n            def.resolve(bizagi.util.getDataUrl(properties));\r\n        });\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Create an image offline\r\n     * @param path File in Browser or Path in Mobile Devices\r\n     * @param promise Promise to be resolved when save is completed\r\n     */\r\n    saveImageOffline: function (path, promise) {\r\n        var self = this;        \r\n        var blobPromise = new $.Deferred();\r\n\r\n        if(self.isNative){\r\n            var fileName = self.fileProperties.name;            \r\n            if (!bizagi.util.isAndroidDevice()) {\r\n                path = bizagi.util.media.normalizeIOSFilePath(path);\r\n            }\r\n            else{\r\n                // Fix android 4.4 getting images from recent folder\r\n                path = bizagi.util.media.getImagePath(path);\r\n            }\r\n            \r\n            var errorHandler = function (error) {\r\n                bizagi.log('error converting path to blob', error);  \r\n                blobPromise.reject(error);\r\n            };\r\n    \r\n            window.resolveLocalFileSystemURL(path, function (fileEntry) {\r\n                fileEntry.file(function (file) {    \r\n                    var reader = new FileReader();\r\n                    reader.onloadend = function () {\r\n                        var blob = new Blob([this.result], {type: file.type});\r\n                        blob.name = fileName;\r\n                        blobPromise.resolve(blob);\r\n                    }    \r\n                    reader.readAsArrayBuffer(file);\r\n                }, errorHandler);\r\n            }, errorHandler);\r\n        }\r\n        else {\r\n            blobPromise.resolve(path);\r\n        }        \r\n\r\n        $.when(blobPromise)\r\n        .done( function(blobImage) {\r\n            // Save the image as attachment \r\n            var formParams = self.getFormParams();\r\n            var parameters = {\r\n                idCase: formParams.idCase,\r\n                idWorkitem: formParams.idWorkitem,\r\n                id: self.properties.xpath,\r\n                operationType: \"edition\",\r\n                offlineType: formParams.offlineType\r\n            }\r\n\r\n            $.when(self.dataService.saveOfflineImage(parameters, blobImage))\r\n            .done( function() {\r\n                promise.resolve();\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Builds the upload item url in real size\r\n     * @returns {*}\r\n     */\r\n    buildFullItemUrl: function () {\r\n        var def = new $.Deferred();\r\n\r\n        $.when(this.buildItemUrl({\"property\": \"fileFullContent\"}))\r\n            .done(function (dataUrl) {\r\n                def.resolve(dataUrl);\r\n            });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Method to determine if the render value can be sent to the server or not\r\n     * @returns {boolean}\r\n     */\r\n    canBeSent: function () {\r\n        // This render cannot be sent because it is full ajax\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * Sets the internal value\r\n     * @param value\r\n     * @param triggerEvents\r\n     */\r\n    setValue: function (value, triggerEvents) {\r\n        // Call base\r\n        this._super(value, triggerEvents);\r\n    },\r\n\r\n    /**\r\n     * Returns the internal value\r\n     * @returns {*|Array}\r\n     */\r\n    getValue: function () {\r\n        return this.properties.value || [];\r\n    },\r\n\r\n    /**\r\n     * Check if control is valid or not\r\n     * @param invalidElements\r\n     * @returns {boolean}\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n\r\n        // Don't check non-editable renders\r\n        if (bizagi.util.parseBoolean(self.properties.visible) === false) {\r\n            return true;\r\n        }\r\n\r\n        // Don't check non- editable renders\r\n        if (bizagi.util.parseBoolean(self.properties.editable) === false) {\r\n            return true;\r\n        }\r\n\r\n        // Clear error message\r\n        self.setValidationMessage(\"\");\r\n\r\n        // Check required\r\n        if (self.properties.required) {\r\n            var newRow = self.grid && self.grid.isFromCreatedRow.apply(self);\r\n\r\n            if (!newRow) {\r\n                var value = self.getValue();\r\n\r\n                if (value.length === 0) {\r\n                    var message = self.getResource(\"render-required-text\").replaceAll(\"#label#\", self.properties.displayName);\r\n                    invalidElements.push({ xpath: self.properties.xpath, message: message });\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * Build add params to send to the server\r\n     */\r\n    buildAddParams: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var data = {};\r\n\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = self.getUploadXpath();\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = properties.id;\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = properties.xpathContext;\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = properties.idPageCache;\r\n        data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = form.properties.sessionId;\r\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = 'savefile';\r\n\r\n        if (properties.contexttype) {\r\n            data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = properties.contexttype;\r\n        }\r\n\r\n        try {\r\n            if (typeof (BIZAGI_SESSION_NAME) !== \"undefined\") {\r\n                data[BIZAGI_SESSION_NAME] = form.properties.sessionId;\r\n            } else {\r\n                data[\"JSESSIONID\"] = form.properties.sessionId;\r\n            }\r\n        } catch (e) {\r\n            data[\"JSESSIONID\"] = form.properties.sessionId;\r\n        }\r\n\r\n        return data;\r\n    },\r\n\r\n    /**\r\n     * Returns the xpath to be used\r\n     * @returns {*}\r\n     */\r\n    getUploadXpath: function () {\r\n        return this.properties.xpath;\r\n    },\r\n\r\n    /**\r\n     * Clean html because some scenarios render twice\r\n     */\r\n    emptyControlByAsyncRenderDeferred: function () {\r\n        var $control = this.getControl();\r\n        $control.empty();\r\n    }\r\n});","/*\r\n *   Name: BizAgi Render Column Decorator Class\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define basic stuff for Columns\r\n */\r\n\r\nbizagi.rendering.element.extend(\"bizagi.rendering.columns.column\", {}, {\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n\r\n        this.decoratedClass = params.decorated;\r\n        this.data = params.data;\r\n        if (params.singleInstance) {\r\n            this.decorated = new this.decoratedClass({\r\n                data: this.data,\r\n                parent: this.parent,\r\n                renderFactory: this.renderFactory,\r\n                dataService: this.dataService\r\n            });\r\n            this.decorated.getControl = this.getControl;\r\n            params.decorated = this.decorated;\r\n            this.decorated.properties.isColumn = true;\r\n        } else {\r\n            this.decorateRenders = [];\r\n        }\r\n        this.grid = params.parent;\r\n\r\n        // Set base column styles\r\n        var properties = this.properties;\r\n        properties.columnVisible = bizagi.util.parseBoolean(properties.columnVisible) != null ? bizagi.util.parseBoolean(properties.columnVisible) : true;\r\n        properties.align = properties.align || 'center';\r\n        properties.textFormat = properties.textFormat || {};\r\n        properties.submitOnChange = (typeof properties.submitOnChange != \"undefined\") ? bizagi.util.parseBoolean(properties.submitOnChange) : false;\r\n        properties.singleInstance = params.singleInstance;\r\n        properties.editable = (typeof properties.editable != \"undefined\") ? bizagi.util.parseBoolean(properties.editable) : true;\r\n        properties.visible = (typeof properties.visible != \"undefined\") ? bizagi.util.parseBoolean(properties.visible) : true;\r\n        properties.required = (typeof properties.required != \"undefined\") ? bizagi.util.parseBoolean(properties.required) : false;\r\n        properties.showColumn = (typeof properties.showColumn != \"undefined\") ? bizagi.util.parseBoolean(properties.showColumn) : true;\r\n\r\n        // Define if it is editable or not        \r\n        try {\r\n            if (params.parent && typeof params.parent.properties.editable == \"boolean\" && !params.parent.properties.editable) {\r\n                properties.editable = false;\r\n            }\r\n        } catch (e) {\r\n        }\r\n\r\n        // Define if the column is readonly\r\n        this.readonly = properties.readonly !== undefined ? properties.readonly : false;\r\n        if (this.readonly) properties.editable = required = false;\r\n\r\n        // Save original properties\r\n        this.originalProperties = JSON.parse(JSON.encode(properties));\r\n    },\r\n\r\n    /*\r\n    *   Return true if the column is read-only, so we can make a quick render\r\n    */\r\n    isReadonly: function () {\r\n        return false;\r\n    },\r\n\r\n\r\n    /*\r\n    *   Method to retrieve the decorated control\r\n    */\r\n    getControl: function () {\r\n        var self = this;\r\n        return $(\".ui-bizagi-render-control\", self.element || self.observableElement);\r\n    },\r\n    /*\r\n    *   Returns the decorated cell instance to use\r\n    */\r\n    getDecorated: function (surrogateKey) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        if (properties.singleInstance) {\r\n            return self.decorated;\r\n        }\r\n        else {\r\n            var decorated = self.decorateRenders[surrogateKey];\r\n            if (decorated == undefined) {\r\n                if (typeof self.decorateRenders != \"object\") {\r\n                    self.decorateRenders = [];\r\n                }\r\n                var instanceDecoratedClass = new this.decoratedClass({\r\n                    data: bizagi.clone(this.data),\r\n                    parent: this.parent,\r\n                    renderFactory: this.renderFactory,\r\n                    dataService: this.dataService\r\n                });\r\n                decorated = instanceDecoratedClass;\r\n                self.decorateRenders[surrogateKey] = instanceDecoratedClass;\r\n\r\n                // Set surrogate key to all controls\r\n                decorated.surrogateKey = surrogateKey;\r\n\r\n                // Execute decorated overrides\r\n                self.applyOverrides(decorated);\r\n\r\n                // Also override setDisplayValue on summary row for non numeric columns\r\n                if (surrogateKey == \"summary\" && decorated.properties.type != \"columnMoney\" && decorated.properties.type != \"columnNumber\") {\r\n\r\n                    decorated.setDisplayValue = function (value) {\r\n                        var control = this.getControl();\r\n\r\n                        // Replace line breaks for html line breaks\r\n                        control.html(value);\r\n                    };\r\n                }\r\n            }\r\n            return decorated;\r\n        }\r\n    },\r\n    /*\r\n    *   Set a ready function to execute when the render has been inserted in the dom\r\n    */\r\n    ready: function () {\r\n        return this.readyDeferred.promise();\r\n    },\r\n    /*\r\n    *   Load stuff needed for the column\r\n    *   It could return a promise if the column need to load async stuff\r\n    */\r\n    initialize: function () {\r\n        // Override to do any stuff needed here\r\n    },\r\n    /* \r\n    *  Method to determine if the render value can be sent to the server or not\r\n    */\r\n    canBeSent: function (surrogateKey, cellOverrides) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n\r\n        if (cellOverrides) {\r\n            decorated.properties.visible = cellOverrides.visible;\r\n            decorated.properties.editable = cellOverrides.editable;\r\n        }\r\n        return decorated.canBeSent() || (!self.properties.editable && self.hasChanged()) || (!decorated.properties.editable && self.hasChanged());\r\n    },\r\n    /*\r\n    *   Method to check if a value is valid or not in this render\r\n    */\r\n    isValueValid: function (surrogateKey, value, messages, propertyOverrides) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var invalidElements = [];\r\n\r\n        if (propertyOverrides.visible) {\r\n            self.setValue(surrogateKey, value);\r\n\r\n            // Override properties\r\n            decorated.properties = $.extend(decorated.properties, propertyOverrides);\r\n\r\n            if (self.grid && typeof(decorated.grid) === \"undefined\") {\r\n                decorated.grid = self.grid;\r\n            }\r\n\r\n            // Validate field\r\n            decorated.isValid(invalidElements);\r\n        }\r\n\r\n        if (invalidElements.length > 0) {\r\n            $.each(invalidElements, function (i, invalidElement) {\r\n                messages.push(invalidElement.message);\r\n            });\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    },\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n    },\r\n    /*\r\n    *   Returns the in-memory processed element \r\n    *   so the caller could append it to any place\r\n    */\r\n    render: function (surrogateKey, value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        // Set grid and id references to the control in order to render the content\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        decorated.grid = self.grid;\r\n        decorated.column = this;\r\n        decorated.surrogateKey = surrogateKey;\r\n\r\n        // Set cell value\r\n        self.setValue(surrogateKey, value);\r\n\r\n        // Override render properties\r\n        self.overrideDecoratedRenderProperties(surrogateKey);\r\n\r\n        // Set flag to check when a render has changed\r\n        self.changed = false;\r\n\r\n        // If the render is not editable return the readonly version of the column\r\n        //Fix: Uncaught RangeError: Maximum call stack size exceeded\r\n        if (!properties.editable && arguments[3] !== \"CALLER_RENDER_READ_ONLY_COLUMNSLINK\")\r\n            return self.renderReadOnly.apply(self, arguments);\r\n\r\n        // Returns the decorated render inside a custom layout for columns\r\n        self.readyDeferred = new $.Deferred();\r\n        var cell = decorated.render(\"cell\");\r\n\r\n        // If the render changes set the flag on\r\n        decorated.bind(\"renderchange\", function () {\r\n            self.changed = true;\r\n        });\r\n\r\n        self.bind(\"rendered\", function () {\r\n            self.readyDeferred.resolve();\r\n        });\r\n\r\n        return cell;\r\n    },\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        decorated.postRenderElement(cell);\r\n    },\r\n    /*\r\n    *   Returns the in-memory processed element when the element is read-only\r\n    */\r\n    renderReadOnly: function (surrogateKey, value) {\r\n        var self = this;\r\n        // Set grid and id references to the control in order to render the content\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        decorated.grid = self.grid;\r\n        decorated.column = this;\r\n        decorated.surrogateKey = surrogateKey;\r\n\r\n        // Set cell value\r\n        self.setValue(surrogateKey, value);\r\n\r\n        // Override render properties\r\n        self.overrideDecoratedRenderProperties(surrogateKey);\r\n\r\n        // Changes editable to false to render read-only\r\n        decorated.properties.editable = false;\r\n\r\n        // Perform the internal render\r\n        self.readyDeferred = new $.Deferred();\r\n        var result = decorated.render(\"cell.readonly\");\r\n\r\n        self.bind(\"rendered\", function () {\r\n            self.readyDeferred.resolve();\r\n        });\r\n\r\n        // Returns the decorated render inside a custom layout for columns\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    *  Returns the html template to draw the summary cell\r\n    */\r\n    renderSummary: function (key, value) {\r\n        var self = this;\r\n        var result = self.renderFactory.getTemplate(\"cell.summary\")\r\n        return $.tmpl(result).html();\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function (surrogateKey, cell) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var editable = self.properties.editable;\r\n        decorated.properties.editable = false;\r\n        if (self.properties.singleInstance) {\r\n            decorated.element = cell;\r\n        }\r\n        decorated.postRenderElement(cell);\r\n        decorated.properties.editable = editable;\r\n    },\r\n\r\n    /*\r\n    * Return false to all columns that doesn't need special treatment (like number or currency)\r\n    */\r\n    postRenderSummary: function () {\r\n        return false;\r\n    },\r\n\r\n    /*\r\n    *   Returns the cell html to be inserted in the table\r\n    */\r\n    getCell: function () {\r\n        return this.decorated.getDisplayValue();\r\n    },\r\n    /*\r\n    *   Sets the surrogate key for this row\r\n    */\r\n    setSurrogateKey: function (key) {\r\n        this.surrogateKey = key;\r\n    },\r\n    /*\r\n    *   Sets the internal value, only must be called internally\r\n    */\r\n    setValue: function (surrogateKey, value) {\r\n        var self = this;\r\n\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        if (decorated != \"undefined\" && decorated != null) {\r\n\r\n            decorated.properties.originalValue = value;\r\n            decorated.properties.previousValue = value;\r\n\r\n            if ((value === null || value === undefined) && self.properties.defaultvalue !== undefined && decorated.grid != undefined) {\r\n                value = self.setDefaultValue(surrogateKey, decorated);\r\n            }\r\n\r\n            decorated.properties.value = value;\r\n            decorated.setValue(value, false);\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Set the cell default value and make this action as a change to send it to server\r\n    */\r\n    setDefaultValue: function (surrogateKey, decorated) {\r\n        var self = this;\r\n        var value = self.properties.defaultvalue;\r\n\r\n        decorated.grid.changes[surrogateKey] = decorated.grid.changes[surrogateKey] || {};\r\n        decorated.grid.changes[surrogateKey][self.properties.xpath] = value;\r\n\r\n        return value;\r\n    },\r\n    /*\r\n    *   Gets the internal value\r\n    */\r\n    getValue: function (surrogateKey) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        return decorated.getValue();\r\n    },\r\n    /*\r\n    *   Gets the composite value (applies for non-standard render values)\r\n    */\r\n    getCompositeValue: function (surrogateKey) {\r\n        return this.getValue(surrogateKey);\r\n    },\r\n    /*\r\n    *   Returns the element type\r\n    */\r\n    getElementType: function () {\r\n        return bizagi.rendering.element.ELEMENT_TYPE_COLUMN;\r\n    },\r\n    /*\r\n    *   Determines if a render has changed its value\r\n    */\r\n    hasChanged: function () {\r\n        return this.changed;\r\n    },\r\n    /*\r\n    *   Triggers an event inside the control\r\n    */\r\n    trigger: function (eventType, data) {\r\n        if (this.decorated)\r\n            this.decorated.trigger(eventType, data);\r\n    },\r\n    /*\r\n    *   Triggers an event handler inside the control\r\n    */\r\n    triggerHandler: function (eventType, data) {\r\n        if (this.decorated)\r\n            this.decorated.triggerHandler(eventType, data);\r\n    },\r\n    /*\r\n    *   Binds to an event\r\n    */\r\n    bind: function (eventType, fn) {\r\n        if (this.decorated)\r\n            this.decorated.bind(eventType, fn);\r\n    },\r\n    /*\r\n    *   Unbinds to an event\r\n    */\r\n    unbind: function (eventType, fn) {\r\n        if (this.decorated)\r\n            this.decorated.unbind(eventType, fn);\r\n    },\r\n    /*\r\n    *   Override decorated properties\r\n    */\r\n    overrideDecoratedRenderProperties: function (surrogateKey) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n\r\n        // Override decorated control properties\r\n        decorated.properties.editable = this.properties.editable;\r\n        decorated.properties.visible = this.properties.visible;\r\n        decorated.properties.required = this.properties.required;\r\n    },\r\n\r\n    overrideProperties: function (properties) {\r\n        var self = this;\r\n\r\n        self.properties.editable = properties.editable || self.properties.editable;\r\n        self.properties.visible = properties.visible || self.properties.visible;\r\n        self.properties.required = properties.required || self.properties.required;\r\n    },\r\n\r\n    /*\r\n    *   Returns the xpath used to sort the grid\r\n    */\r\n    getSortName: function () {\r\n        var self = this;\r\n\r\n        // Check if there is an override for the default behaviour \r\n        var decorated = self.getAnyDecoratedInstance();\r\n        if (decorated && decorated.getSortColumn) {\r\n            return decorated.getSortColumn();\r\n        }\r\n\r\n        // Default behaviour\r\n        return self.properties.xpath;\r\n    },\r\n\r\n    /*\r\n    *   Returns any of the decorated instances, if there are none, return null\r\n    */\r\n    getAnyDecoratedInstance: function () {\r\n        var self = this;\r\n        var first;\r\n\r\n        // Get the first key for the hash\r\n        for (first in this.decorateRenders) break;\r\n\r\n        // Return the first decorated render\r\n        if (first) return this.decorateRenders[first];\r\n\r\n        return null;\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n\r\n        setTimeout(function () {\r\n            if (self.decorated) {\r\n                self.decorated.unbind(\"renderchange\");\r\n                self.decorated.dispose();\r\n            }\r\n        \r\n            if (self.decorateRenders) {\r\n                bizagi.util.arrayEach(self.decorateRenders, function (key, render) {\r\n                    if (render) {\r\n                        render.unbind(\"renderchange\");\r\n                        render.dispose();\r\n                    }\r\n                });\r\n            }\r\n        }, bizagi.override.disposeTime || 50);\r\n        \r\n        // Call base\r\n        self._super();\r\n    }\r\n});\r\n\r\n","/*\r\n *   Name: BizAgi Render Column ReadOnlyDecorator Class\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define basic stuff for readonly-columns\r\n */\r\n\r\n// Extends itself\r\n$.Class.extend(\"bizagi.rendering.columns.readonly\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Set base column styles\r\n        var properties = this.properties;\r\n\r\n        // Define the column as readonly\r\n        properties.editable = required = false;\r\n    },\r\n\r\n    /*\r\n    *   Return true if the column is read-only, so we can make a quick render\r\n    */\r\n    isReadonly: function () {\r\n        return true;\r\n    },\r\n\r\n    /*\r\n    *   Returns the in-memory processed element \r\n    *   so the caller could append it to any place\r\n    */\r\n    render: function (surrogateKey, value) {\r\n        if (typeof value === \"string\") {\r\n            var valueToDisplay = value.replaceAll(\"\\\\n\", \"<br/>\");\r\n            valueToDisplay = valueToDisplay.replaceAll(\"\\n\", \"<br/>\");\r\n            return valueToDisplay;\r\n        }\r\n        else if (value === null){\r\n            return \"\";\r\n        }\r\n\r\n        return value;\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell) {\r\n        // DON'T DO ANYTHING\r\n    },\r\n\r\n    /*\r\n    *   Returns the in-memory processed element when the element is read-only\r\n    */\r\n    renderReadOnly: function (surrogateKey, value) {\r\n        return this.render(surrogateKey, value);\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function (surrogateKey, cell) {\r\n        // DON'T DO ANYTHING\r\n    },\r\n    \r\n    /*\r\n    *   Method to check if a value is valid or not in this render\r\n    */\r\n    isValueValid: function () {\r\n        // It is always valid because the column is readonly\r\n        return true;\r\n    }\r\n});\r\n\r\n","/*\r\n*   Name: BizAgi Render Combo Column Decorator Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define basic stuff for Combo Columns\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.columns.combo\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Set base column styles\r\n        var properties = this.properties;\r\n        properties.recalculate = bizagi.util.parseBoolean(properties.recalculate) || false;\r\n    },\r\n\r\n\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n        var properties = this.properties;\r\n\r\n        this._super(decorated);\r\n\r\n        if (!properties.recalculate) {\r\n            decorated.originalGetData = decorated.getData;\r\n            decorated.getData = this.getDataForAllCells;\r\n            decorated.findDataById = this.findDataById;\r\n        }\r\n    },\r\n\r\n    findDataById: function (id) {\r\n        var self = this;\r\n        var result = {};\r\n        if (this.column && this.column.comboData) {\r\n            $.each(this.column.comboData, function (key, value) {\r\n                if (value.id == id) {\r\n                    result = value;\r\n                }\r\n            });\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    *   Single data fetch for all the cells\r\n    */\r\n    getDataForAllCells: function (params) {\r\n        var column = this.column;\r\n        if (column.comboData) return column.comboData;\r\n        if (column.fetchingData) return column.dataPromise;\r\n\r\n        // Start fetching\r\n        column.fetchingData = true;\r\n        column.dataPromise = $.when(this.originalGetData(params))\r\n        .pipe(function (result) {\r\n            column.comboData = result;\r\n            column.fetchingData = false;\r\n            return result;\r\n        });\r\n\r\n        return column.dataPromise;\r\n    },\r\n\r\n    /*\r\n    *   Sets the internal value\r\n    */\r\n    setValue: function(surrogateKey, value) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        if (decorated === null) {\r\n            return;\r\n        }\r\n\r\n        // Perform default set value when rendering summary row\r\n        if (surrogateKey == \"summary\") return self._super(surrogateKey, value);\r\n\r\n        if (value && bizagi.util.isString(value)) {        \r\n            self._super(surrogateKey, value);\r\n        } else if (value && value.length > 0) {\r\n            // Create the value property\r\n            var newValue = {\r\n                id: value[0][0],\r\n                value: value[0].length > 2 ? $.grep(value[0], function(item, i) { return i != 0; }) : value[0][1]\r\n            };\r\n            // Call base\r\n            self._super(surrogateKey, newValue);\r\n            decorated.selectedValue = newValue.value;\r\n        } else if (value && value.id && value.value) {\r\n            self._super(surrogateKey, value);\r\n            decorated.selectedValue = value.value;\r\n        } else if (self.properties.type == \"columnRadio\") {\r\n            self._super(surrogateKey, null);\r\n            decorated.selectedValue = value;\r\n        } else if (value && typeof (value) == \"number\") {\r\n            self._super(surrogateKey, value);\r\n        } else {\r\n            // Set null values when the entry array is null\r\n            self._super(surrogateKey, null);\r\n            decorated.selectedValue = \"\";\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Gets the internal value\r\n    */\r\n    getCompositeValue: function (surrogateKey) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var value = decorated.getValue();\r\n        var label = decorated.getSelectedValue();\r\n\r\n        // Build value for grid data\r\n        var valueForGrid = [];\r\n        if (value && (value.id > 0 || bizagi.util.isString(value.id))) {\r\n            valueForGrid.push([]);\r\n            valueForGrid[0].push(value.id);\r\n            valueForGrid[0].push(label);\r\n        } else {\r\n            valueForGrid.push([]);\r\n        }\r\n\r\n        return valueForGrid;\r\n    },\r\n\r\n    /*\r\n    *   Gets the internal value\r\n    */\r\n    getValue: function (surrogateKey) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var value = decorated.getValue();\r\n        if (value) return value.id;\r\n        return value;\r\n    },\r\n\r\n    /*\r\n    *   Returns the in-memory processed element \r\n    *   so the caller could append it to any place\r\n    */\r\n    render: function (surrogateKey, value, tableCell) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var properties = self.properties;\r\n\r\n        // If the control needs to recalculate data, reset it on the decorated render\r\n        if (properties.recalculate) {\r\n            decorated.resetData();\r\n        }\r\n\r\n        // Change the xpath context\r\n        var xpathContext = properties.xpathContext.length > 0 ? properties.xpathContext + \".\" + self.grid.properties.xpath + \"[id=\" + surrogateKey + \"]\" : self.grid.properties.xpath + \"[id=\" + surrogateKey + \"]\";\r\n        decorated.properties.xpathContext = xpathContext;\r\n\r\n        // Render the control\r\n        var result = this._super(surrogateKey, value, tableCell);\r\n\r\n        return result;\r\n    },\r\n\r\n    renderReadOnly: function (key, value) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(key);\r\n        var properties = self.properties;\r\n\r\n        // Change the xpath context\r\n        var xpathContext = properties.xpathContext.length > 0 ? properties.xpathContext + \".\" + self.grid.properties.xpath + \"[id=\" + key + \"]\" : self.grid.properties.xpath + \"[id=\" + key + \"]\";\r\n        decorated.properties.xpathContext = xpathContext;\r\n\r\n        // Render the control\r\n        var result = this._super(key, value);\r\n\r\n        return result;\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Render Date Column Decorator Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define basic stuff for Date Columns\r\n*/\r\n\r\n\r\n$.Class.extend(\"bizagi.rendering.columns.date\", {}, {\r\n\r\n    /*\r\n    *   Sets the internal value\r\n    */\r\n    setValue: function (surrogateKey, value) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        if (decorated === null) return;\r\n\r\n        self._super(surrogateKey, value);\r\n        if ((value === null || value === undefined) && self.properties.defaultvalue !== undefined) {\r\n            value = self.setDefaultValue(surrogateKey, decorated);\r\n        }\r\n\r\n        // Perform default set value when rendering summary row\r\n        if (surrogateKey === \"summary\") return self._super(surrogateKey, value);\r\n\r\n        if (value == null) {\r\n            decorated.setValue(value, false);\r\n            decorated.properties.displayValue = \"\";\r\n        }\r\n\r\n        var date = bizagi.util.dateFormatter.getDateFromInvariant(value, decorated.properties.showTime);\r\n\r\n        if (date === 0) {\r\n            // force another attempt in order to check invariant format for the value with time or without time (reverse option)\r\n            date = bizagi.util.dateFormatter.getDateFromInvariant(value, !decorated.properties.showTime);\r\n        }\r\n        // Format date to current format\r\n        if (date !== 0) {\r\n            var datePickerRegional = bizagi.localization.getResource(\"datePickerRegional\");\r\n            var formattedDate = bizagi.util.dateFormatter.formatDate(date, decorated.properties.fullFormat, datePickerRegional);\r\n\r\n            // Set formatted value in display value property\r\n            decorated.properties.displayValue = formattedDate;\r\n\r\n            // Send original value to decorated control, because it must be with invariant format\r\n            decorated.setValue(value, false);\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Set the cell default value and make this action as a change to send it to server\r\n    */\r\n    setDefaultValue: function (surrogateKey, decorated) {\r\n        var self = this;\r\n        var value = self.properties.defaultvalue;\r\n\r\n        decorated.grid.changes[surrogateKey] = decorated.grid.changes[surrogateKey] || {};\r\n\r\n        value = bizagi.util.dateFormatter.getDateFromInvariant(value, decorated.properties.showTime || false);\r\n\r\n        value = bizagi.util.dateFormatter.formatInvariant(value, true);\r\n        decorated.grid.changes[surrogateKey][self.properties.xpath] = value;\r\n\r\n        return value;\r\n    }\r\n});\r\n\r\n","/*\r\n*   Name: BizAgi Render Combo Column Decorator Class\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define basic stuff for Combo Columns\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.columns.search\", {}, {\r\n\r\n\t/*\r\n\t*   Constructor\r\n\t*/\r\n\tinit: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Set base column styles\r\n        var properties = this.properties;\r\n\r\n        if (properties.advancedSearch && this.getMode() === \"execution\") {\r\n            properties.submitOnChange = bizagi.util.parseBoolean(properties.submitOnChange) || false;\r\n            properties.submitOnChange = (properties.submitVersion || 1) > 1 ? properties.submitOnChange : true;\r\n        }\r\n    },\r\n\r\n\t/*\r\n\t*   Returns the in-memory processed element \r\n\t*   so the caller could append it to any place\r\n\t*/\r\n\trender: function (surrogateKey, value, tableCell) {\r\n\t\tvar self = this;\r\n\t\tvar decorated = self.getDecorated(surrogateKey);\r\n\t\tvar properties = self.properties;\r\n\r\n\t\t// If the control needs to recalculate data, reset it on the decorated render\r\n\t\tif (properties.recalculate) {\r\n\t\t\tdecorated.resetData();\r\n\t\t}\r\n\r\n\t\t// Change the xpath context\r\n\t\tvar xpathContext = properties.xpathContext.length > 0 ? properties.xpathContext + \".\" + self.grid.properties.xpath + \"[id=\" + surrogateKey + \"]\" : self.grid.properties.xpath + \"[id=\" + surrogateKey + \"]\";\r\n        decorated.properties.xpathContext = xpathContext;\r\n\r\n\t\t// Render the control\r\n\t\tvar result = this._super(surrogateKey, value, tableCell);\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\t/*\r\n    *   Gets the internal value\r\n    */\r\n    getValue: function (surrogateKey) {\r\n        var self = this;\r\n    \tvar decorated = self.getDecorated(surrogateKey);\r\n        var value = decorated.getValue();\r\n        if (value && typeof(value) == \"object\" ) return value.id;\r\n        \t\r\n    \treturn value;\r\n    },\r\n    setValue: function (surrogateKey, value) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        if (decorated === null) { return; }\r\n\r\n        // Perform default set value when rendering summary row\r\n        if (surrogateKey == \"summary\") return self._super(surrogateKey, value);\r\n\r\n        if (value && value.length > 0) {\r\n            // Create the value property\r\n            var newValue = {\r\n                id: value[0][0],\r\n                value: value[0].length > 2 ? $.grep(value[0], function (item, i) { return i != 0; }) : value[0][1]\r\n            };\r\n            // Call base\r\n            self._super(surrogateKey, newValue);\r\n            decorated.selectedValue = newValue.value;\r\n        } else if (value && value.id && value.value) {\r\n            self._super(surrogateKey, value);\r\n            decorated.selectedValue = value.value;\r\n        } else if(value && value.id && value.label){\r\n            self._super(surrogateKey, value);\r\n            decorated.selectedValue = value.label;\r\n        }\r\n        else{\r\n            self._super(surrogateKey, value);\r\n            decorated.selectedValue = \"\";\r\n        }\r\n    }\r\n\r\n});\r\n","/**\r\n * Base definition of a range control\r\n *\r\n * @author: Andres Fernando Munoz\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.range\", {}, {\r\n    /*\r\n     * Constructor\r\n     */\r\n    init: function(params) {\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    /*\r\n     * Initialize the control with data provided\r\n     */\r\n    initializeData: function(data) {\r\n        var self = this;\r\n        // Call base\r\n        this._super(data);\r\n    },\r\n\r\n\r\n    /*\r\n     * Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function() {\r\n        var self = this,\r\n            properties = self.properties;\r\n        var template;\r\n        var html = \"\";\r\n        // Render template\r\n        template = self.renderFactory.getTemplate(\"render-range\");\r\n        html = $.fasttmpl(template, {});\r\n        return html;\r\n    },\r\n    /**\r\n     * Sets the range controls in DOM\r\n     * @param minControl: min range control\r\n     * @param maxControl: max range control\r\n     */\r\n    setRanageControls: function (minControl, maxControl){\r\n        var self = this;\r\n        self.minControl = minControl || null;\r\n        self.maxControl = maxControl || null;\r\n        var control = self.getControl();\r\n\r\n        var $maxCanvas = $(\".bz-range-maximum\", control);\r\n        var $minCanvas = $(\".bz-range-minimum\", control);\r\n\r\n        //var $maxCanvas = $('<div>hola</div>');\r\n        //var $minCanvas = $('<div>hola</div>');\r\n\r\n        self.renderRangeControl($minCanvas, minControl);\r\n        self.renderRangeControl($maxCanvas, maxControl);\r\n    },\r\n\r\n    /*\r\n     *   Returns the internal value\r\n     */\r\n    getValue: function () {\r\n        var self = this;\r\n        var minValue = self.minControl.getValue();\r\n        var maxValue = self.maxControl.getValue();\r\n\r\n        var value = {\r\n            min: minValue,\r\n            max: maxValue\r\n        };\r\n        return value;\r\n    },\r\n\r\n    renderRangeControl: function ($canvas, control){\r\n        $.when(control.render(\"render\")).done(function (html) {\r\n            $canvas.empty().append(html);\r\n            control.postRenderElement($canvas);\r\n        });\r\n    }\r\n});\r\n","/**\r\n * Base definition of a range date control\r\n *\r\n * @author: Andres Fernando Munoz\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.rangeDate\", {}, {\r\n\r\n    /**\r\n     * Defines de min date an de max date to the range control\r\n     */\r\n    defineRangeControl: function (params) {\r\n        var self = this;\r\n\r\n        var dateMin = bizagi.rendering.date.extend({\r\n            suscribe: function (control) {\r\n                this.observer = this.observer || [];\r\n                this.observer.push(control);\r\n            },\r\n\r\n            notify: function (value) {\r\n                for (var i = this.observer.length - 1 ; i >= 0; i--) {\r\n                    this.observer[i].changeMinValue(value);\r\n                }\r\n            },\r\n\r\n            setValue: function (value) {\r\n                value = value || \"\";\r\n                this._super(value);\r\n                this.notify(value);\r\n            }\r\n        });\r\n\r\n        var dateMax = bizagi.rendering.date.extend({\r\n            suscribe: function (control) {\r\n                this.observer = this.observer || [];\r\n                this.observer.push(control);\r\n            },\r\n\r\n            notify: function (value) {\r\n                for (var i = this.observer.length - 1; i >= 0; i--) {\r\n                    this.observer[i].changeMaxValue(value);\r\n                }\r\n            },\r\n\r\n            setValue: function (value) {\r\n                value = value || \"\";\r\n                this._super(value);\r\n                this.notify(value);\r\n            }\r\n        });\r\n\r\n\r\n        var minControl = new dateMin(self.getRenderProperties(\"min\"));\r\n        var maxControl = new dateMax(self.getRenderProperties(\"max\"));\r\n\r\n        minControl.suscribe(maxControl);\r\n        maxControl.suscribe(minControl);\r\n\r\n\r\n        self.setRanageControls(minControl, maxControl);\r\n    },\r\n\r\n    getRenderProperties: function (typeRangeControl) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var properties = self.properties;\r\n\r\n        var renderProperties = {\r\n            data: {\r\n                properties: {\r\n                    \"id\": properties.id,\r\n                    \"xpath\": properties.xpath + \"_\" + typeRangeControl,\r\n                    \"displayType\": \"value\"\r\n                }\r\n            },\r\n            mode: \"execute\",\r\n            parent: form,\r\n            renderFactory: self.renderFactory,\r\n            resources: bizagi.localization,\r\n            dataService: self.dataService\r\n        };\r\n\r\n        if (typeRangeControl === \"min\") {\r\n            renderProperties.data.properties.displayName = \"From\";\r\n        } else {\r\n            renderProperties.data.properties.displayName = \"To\";\r\n        }\r\n\r\n        return renderProperties;\r\n    }\r\n});\r\n","/**\r\n * Base definition of a range money control\r\n *\r\n * @author: Andres Fernando Munoz\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.rangeMoney\", {}, {\r\n    \r\n    /**\r\n     * Defines de min money an de max money to the range control\r\n     */\r\n    defineRangeControl: function () {\r\n        var self = this;\r\n\r\n        var moneyMin = bizagi.rendering.money.extend({\r\n            suscribe: function (control) {\r\n                this.observer = this.observer || [];\r\n                this.observer.push(control);\r\n            },\r\n\r\n            notify: function (value) {\r\n                for (var i = this.observer.length - 1 ; i >= 0; i--) {\r\n                    this.observer[i].changeMinValue(value);\r\n                }\r\n            },\r\n\r\n            setValue: function (value) {\r\n                value = value || \"\";\r\n                this._super(value);\r\n                this.notify(value);\r\n            }\r\n        });\r\n\r\n        var moneyMax = bizagi.rendering.money.extend({\r\n            suscribe: function (control) {\r\n                this.observer = this.observer || [];\r\n                this.observer.push(control);\r\n            },\r\n\r\n            notify: function (value) {\r\n                for (var i = this.observer.length - 1; i >= 0; i--) {\r\n                    this.observer[i].changeMaxValue(value);\r\n                }\r\n            },\r\n\r\n            setValue: function (value) {\r\n                value = value || \"\";\r\n                this._super(value);\r\n                this.notify(value);\r\n            }\r\n        });\r\n\r\n        var minControl = new moneyMin(self.getRenderProperties(\"min\"));\r\n        var maxControl = new moneyMax(self.getRenderProperties(\"max\"));\r\n\r\n        minControl.suscribe(maxControl);\r\n        maxControl.suscribe(minControl);\r\n\r\n        self.setRanageControls(minControl, maxControl);\r\n    },\r\n\r\n\r\n    getRenderProperties: function (typeRangeControl){\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var properties = self.properties;\r\n\r\n        var renderProperties = {\r\n            data: {\r\n                properties: {\r\n                    \"id\": properties.id,\r\n                    \"xpath\": properties.xpath + \"_\" + typeRangeControl,\r\n                    \"displayType\": \"value\"\r\n                }\r\n            },\r\n            mode: \"execute\",\r\n            parent: form,\r\n            renderFactory: self.renderFactory,\r\n            resources: bizagi.localization,\r\n            dataService: self.dataService\r\n        };\r\n        return renderProperties;\r\n    }\r\n});\r\n","/**\r\n * Base definition of a range number control\r\n *\r\n * @author: Andres Fernando Munoz\r\n */\r\n\r\n $.Class.extend(\"bizagi.rendering.rangeNumber\", {}, {\r\n\r\n    /**\r\n    * Defines de min number an de max number to the range control\r\n    */\r\n    defineRangeControl: function () {\r\n        var self = this;\r\n\r\n        var numberMin = bizagi.rendering.number.extend({\r\n            suscribe: function (control) {\r\n                this.observer = this.observer || [];\r\n                this.observer.push(control);\r\n            },\r\n\r\n            notify: function (value) {\r\n                for (var i = this.observer.length - 1 ; i >= 0; i--) {\r\n                    this.observer[i].changeMinValue(value);\r\n                }\r\n            },\r\n\r\n            setValue: function (value) {\r\n                value = value || \"\";\r\n                this._super(value);\r\n                this.notify(value);\r\n            }\r\n        });\r\n\r\n        var numberMax = bizagi.rendering.number.extend({\r\n            suscribe: function (control) {\r\n                this.observer = this.observer || [];\r\n                this.observer.push(control);\r\n            },\r\n\r\n            notify: function (value) {\r\n                for (var i = this.observer.length - 1; i >= 0; i--) {\r\n                    this.observer[i].changeMaxValue(value);\r\n                }\r\n            },\r\n\r\n            setValue: function (value) {\r\n                value = value || \"\";\r\n                this._super(value);\r\n                this.notify(value);\r\n            }\r\n        });\r\n\r\n        var minControl = new numberMin(self.getRenderProperties(\"min\"));\r\n        var maxControl = new numberMax(self.getRenderProperties(\"max\"));\r\n\r\n        minControl.suscribe(maxControl);\r\n        maxControl.suscribe(minControl);\r\n\r\n        self.setRanageControls(minControl, maxControl);\r\n    },\r\n\r\n\r\n    getRenderProperties: function (typeRangeControl){\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var properties = self.properties;\r\n\r\n        var renderProperties = {\r\n            data: {\r\n                properties: {\r\n                    \"id\": properties.id,\r\n                    \"xpath\": properties.xpath + \"_\" + typeRangeControl,\r\n                    \"displayType\": \"value\"\r\n                }\r\n            },\r\n            mode: \"execute\",\r\n            parent: form,\r\n            renderFactory: self.renderFactory,\r\n            resources: bizagi.localization,\r\n            dataService: self.dataService\r\n        };\r\n\r\n        return renderProperties;\r\n    }\r\n});\r\n","/*\r\n *   Name: Bizagi Tablet slide form implementation\r\n *   Author: Bizagi Mobile Team\r\n *   Comments:\r\n *   -   Serves as an slide form that can render a inner form\r\n */\r\n\r\n// Extends itself\r\n$.Class.extend('bizagi.rendering.tablet.slide.form', {}, {\r\n\r\n    /* CONSTRUCTOR\r\n     =====================================================*/\r\n    init: function (dataService, renderFactory, slideFormParams) {\r\n\r\n        var self = this;\r\n\r\n        // Define instance variables\r\n        self.dataService = dataService;\r\n        self.renderFactory = renderFactory;\r\n        self.slideFormParams = slideFormParams || {};\r\n\r\n        if (self.slideContainer && self.slideContainer.destroy) {\r\n            self.slideContainer.destroy();\r\n        }\r\n        // Create container\r\n        self.slideContainer = self.slideFormParams.navigation.createRenderContainer({ title: self.slideFormParams.title });\r\n        self.configureViewHandlers();\r\n    },\r\n\r\n    /**\r\n     * Go back and destroy\r\n     * @returns {}\r\n     */\r\n    goBack: function () {\r\n        var self = this;\r\n        self.slideContainer.destroy();\r\n    },\r\n\r\n    /**\r\n     * Handlers de la vista de kendo\r\n     * @returns {}\r\n     */\r\n    configureViewHandlers: function () {\r\n        var self = this;\r\n    },\r\n\r\n    /**\r\n     * Render the form\r\n     * The params are the same that will be send to the ajax service\r\n     * @param {} params\r\n     * @returns {} Returns a deferred\r\n     */\r\n    render: function (params) {\r\n        var self = this;\r\n        // Fill content\r\n        self.renderSlideForm(params);\r\n    },\r\n\r\n    /* RENDERS slideForm\r\n     =====================================================*/\r\n    renderSlideForm: function (params) {\r\n\r\n        var self = this;\r\n\r\n        var defer = new $.Deferred();\r\n\r\n        // Load template and data\r\n        $.when(self.dataService.getFormData(params)).then(function (data) {\r\n            /*** SUCCESS FILTER **/\r\n            // Apply editable param\r\n            if (params.editable === false) {\r\n                data.form.properties.editable = false;\r\n            }\r\n\r\n            // Render dialog template\r\n            var formClass = bizagi.rendering.form.extend({\r\n                submitForm: function () {\r\n                    if (self.form) {\r\n                        this.endLoading();\r\n                        // Perform validations\r\n                        if (self.form.validateForm()) {\r\n                            // Collect data\r\n                            var data = {};\r\n\r\n                            self.form.collectRenderValues(data);\r\n\r\n                            // Add page cache for this form\r\n                            data.idPageCache = self.form.getPageCache();\r\n\r\n                            // Call user callback\r\n                            if (self.slideFormParams.onSave) {\r\n                                $.when(self.slideFormParams.onSave(data))\r\n                                    .done(function (result) {\r\n                                        if (result === null || result === true || result.type === \"success\") {\r\n                                            defer.resolve();\r\n                                            self.goBack();\r\n                                        } else if (result.type === \"validationMessages\") {\r\n                                            // Add validation messages\r\n                                            self.form.addValidationMessage(result.messages);\r\n                                            // Update original value to use as reference to other futures changes in the dialogBox\r\n                                            $.each(data, function (key, value) {\r\n                                                var renders = self.form.getRenders(key);\r\n                                                $.each(renders, function (i, render) {\r\n                                                    render.updateOriginalValue();\r\n                                                });\r\n                                            });\r\n                                        } else if (result.type === \"error\") {\r\n                                            // Add error messages\r\n                                            self.form.addErrorMessage(result.message);\r\n                                        }\r\n                                    });\r\n\r\n                            } else {\r\n                                defer.resolve();\r\n                                self.goBack();\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n\r\n            var containerParams = $.extend({\r\n                type: \"form\",\r\n                data: data.form,\r\n                navigation: self.slideFormParams.navigation,\r\n                view_container: self.slideContainer\r\n            }, {\r\n                renderFactory: self.renderFactory,\r\n                dataService: self.renderFactory.dataService\r\n            });\r\n\r\n            // Stop creating forms like there's no tomorrow\r\n            if (!self.form) {\r\n                self.form = new formClass(containerParams);\r\n            }\r\n\r\n            // Return rendering promise\r\n            return self.form.render();\r\n        }).done(function (element) {\r\n            // Append form  in the view\r\n            self.slideContainer.element.html(element);\r\n\r\n            // Navigate on view\r\n            self.slideFormParams.navigation.navigate(self.slideContainer.id);\r\n\r\n            $(\".ui-bizagi-button-container div\", self.form.container).remove();\r\n\r\n            $(\".ui-bizagi-button-container\", self.form.container)\r\n                .append('<div ordinal=\"0\" id=\"formButton0\" class=\"action-button ui-bizagi-form-button\">Save</div>')\r\n                .delegate('div[ordinal=\"0\"]', \"click\", function () {\r\n                    self.form.submitForm();\r\n                });\r\n\r\n            $(\".ui-bizagi-button-container\", self.form.container)\r\n                .append('<div ordinal=\"1\" id=\"formButton1\" class=\"action-button ui-bizagi-form-button\">'\r\n                    + bizagi.localization.getResource(\"render-form-dialog-box-cancel\") + \"</div>\")\r\n                .delegate('div[ordinal=\"1\"]', \"click\", function () {\r\n                    self.slideFormParams.onCancel && self.slideFormParams.onCancel();\r\n                    self.goBack();\r\n                });\r\n\r\n            // Publish an event to check if the form has been set in the DOM\r\n            self.form.triggerHandler(\"ondomincluded\");\r\n\r\n            // Attach a refresh handler to recreate all the form\r\n            self.form.bind(\"refresh\", function () {\r\n                self.renderSlideForm(params);\r\n            });\r\n        }).fail(function (xhr, errorType, message) {\r\n            /*** FAIL FILTER **/\r\n            var errorTemplate = self.renderFactory.getCommonTemplate(\"form-error\");\r\n            var error_message = message.message || \"Error\";\r\n\r\n            $.kendoTmpls(errorTemplate, { message: error_message }).appendTo(self.slideContainer.element);\r\n            // Navigate on view\r\n            self.slideFormParams.navigation.navigate(self.slideContainer.id);\r\n        });\r\n\r\n        return defer.promise();\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Tablet slide view implementation\r\n *   Author: Richar Urbano - RicharU\r\n *   Comments:\r\n *   -   Serves as an slide form that can render a inner form\r\n */\r\n\r\n// Extends itself\r\n/**\r\n * @todo-nelson VIEW\r\n * @type {*}\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.tablet.slide.view\", {}, {\r\n    /* CONSTRUCTOR\r\n     =====================================================*/\r\n    init: function (dataService, renderFactory, slideFormParams) {\r\n        var self = this;\r\n\r\n        // Define instance variables\r\n        self.dataService = dataService;\r\n        self.renderFactory = renderFactory;\r\n        self.slideFormParams = slideFormParams || {};\r\n        self.slideFormDeferred = new $.Deferred();\r\n        self.container = self.slideFormParams.navigation.createRenderContainer({ title: self.slideFormParams.title });\r\n    },\r\n\r\n    buttons: [],\r\n\r\n    processButtons: function (form) {\r\n        var self = this;\r\n\r\n        var onSaveClick = function onSaveClick () {\r\n            if (form) {\r\n                // Perform validations\r\n                if (form.validateForm()) {\r\n\r\n                    // Collect data\r\n                    var data = {};\r\n                    form.collectRenderValues(data);\r\n\r\n                    if (self.slideFormParams.allowGetOriginalFormValues) {\r\n                        data.formValues = form.children;\r\n                    }\r\n\r\n                    // Add page cache for this form\r\n                    data.idPageCache = form.getPageCache();\r\n\r\n                    // Call user callback\r\n                    if (self.slideFormParams.onSave) {\r\n                        $.when(self.slideFormParams.onSave(data))\r\n                            .done(function (result) {\r\n                                if ( !result || result === true || result.type === \"success\") {\r\n                                    // Close slide\r\n                                    self.goBack();\r\n\r\n                                    // Resolve deferred\r\n                                    self.slideFormDeferred.resolve(data);\r\n\r\n                                } else if (result.type === \"validationMessages\") {\r\n                                    // Add validation messages\r\n                                    form.addValidationMessage(result.messages);\r\n                                } else if (result.type === \"error\") {\r\n                                    // Add error messages\r\n                                    form.addErrorMessage(result.message);\r\n                                }\r\n                            }).fail(function (dataFail) {\r\n\r\n                            var message = (dataFail.responseText) ? dataFail.responseText : ((typeof dataFail === \"string\") ? dataFail : dataFail.toString());\r\n\r\n                            // Convert String to object\r\n                            if (typeof message === \"string\") {\r\n                                try {\r\n                                    message = JSON.parse(message).message;\r\n                                } catch (e) {\r\n                                    message = message.match(/\"message\":(.*)\",/)[0];\r\n                                    message = message.substr(11, message.length - 13);\r\n                                }\r\n\r\n                            } else if (!message.message) {\r\n                                message = dataFail;\r\n                            }\r\n\r\n                            form.validateForm();\r\n                            form.clearValidationMessages();\r\n                            form.addValidationMessage(message);\r\n\r\n                            // Close slide\r\n                            self.goBack();\r\n\r\n                            //reject defered\r\n                            self.slideFormDeferred.resolve(data);\r\n                        });\r\n\r\n                    } else {\r\n                        // Close slide\r\n                        self.goBack();\r\n\r\n                        //reject defered\r\n                        self.slideFormDeferred.reject();\r\n                    }\r\n                }\r\n            }\r\n        };\r\n\r\n        var onCancelClick = function onCancelClick () {\r\n            // Close slide\r\n            self.goBack();\r\n            //reject defered\r\n            self.slideFormDeferred.reject();\r\n        };\r\n\r\n        form.buttons =  [$.extend(form.buttons[0] || {},\r\n            {\r\n                \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-save\"),\r\n                \"actions\": [\"submitData\", \"refresh\"],\r\n                \"submitData\": true,\r\n                \"refresh\": true,\r\n                \"ordinal\": 0,\r\n                \"action\": \"save\",\r\n                \"save\": true,\r\n                \"style\": \"\",\r\n                callback: onSaveClick\r\n            }),\r\n            $.extend(form.buttons[1] || {},{\r\n                \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n                \"actions\": [\"submitData\", \"refresh\"],\r\n                \"submitData\": true,\r\n                \"refresh\": true,\r\n                \"ordinal\": 1,\r\n                \"action\": \"back\",\r\n                \"save\": true,\r\n                \"style\": \"\",\r\n                callback: onCancelClick\r\n            })\r\n        ];\r\n\r\n        // If form is editable, add \"save\" button\r\n        if (!self.slideFormParams.showSaveButton) {\r\n            form.buttons.shift();\r\n        }\r\n\r\n        //self._renderButtons(form);\r\n    },\r\n\r\n    /*\r\n     *   Render the form\r\n     *   The params are the same that will be send to the ajax service\r\n     *   Returns a deferred\r\n     */\r\n    render: function (params) {\r\n        var self = this;\r\n\r\n        // Fill content\r\n        self.renderSlideForm(self.slideForm, params);\r\n\r\n        // Return promise\r\n        return self.slideFormDeferred.promise();\r\n    },\r\n\r\n    /* RENDERS slideForm\r\n     =====================================================*/\r\n    renderSlideForm: function(slideForm, params) {\r\n\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        bizagi.loading.start();\r\n\r\n        // Load template and data\r\n        $.when(self.dataService.getFormData(params))\r\n            .then(function(data) {\r\n                /*** SUCCESS FILTER **/\r\n                if (params.recordXPath) {\r\n                    data.form.properties.recordXpath = params.recordXPath;\r\n                }\r\n\r\n                // Apply editable param\r\n                if (!self.slideFormParams.showSaveButton || params.editable === false) {\r\n                    data.form.properties.editable = false;\r\n                }\r\n\r\n                if (typeof (data.form.properties) !== \"undefined\"){\r\n                    data.form.properties.orientation = self.slideFormParams.orientation || \"ltr\";\r\n                }\r\n\r\n                // Render dialog template\r\n                self.form = self.renderFactory.getContainer({\r\n                    type: \"form\",\r\n                    data: data.form,\r\n                    navigation: self.slideFormParams.navigation,\r\n                    view_container: self.container\r\n                });\r\n\r\n                self.form.params = params.formParams;\r\n\r\n                self.processButtons(self.form);\r\n\r\n                // Return rendering promise\r\n                return self.form.render();\r\n\r\n            }).done(function(element) {\r\n\r\n            // Append form in the slide view\r\n            self.container.element.html(element);\r\n\r\n            if (!params.isRefresh) {\r\n                self.slideFormParams.navigation.navigate(self.container.id);\r\n            }\r\n\r\n            self.container.setNavigationButtons(self.form);\r\n\r\n            // Remove default form buttons\r\n            $(\".ui-bizagi-button-container .action-button\", self.form.container).remove();\r\n            // Add Button\r\n            $(\".ui-bizagi-button-container\", self.form.container).append(self.buttonContainer);\r\n\r\n            // Publish an event to check if the form has been set in the DOM\r\n            self.form.triggerHandler(\"ondomincluded\");\r\n\r\n            // Attach a refresh handler to recreate all the form\r\n            self.form.bind(\"refresh\", function(data, refreshParams) {\r\n                refreshParams.formParams = refreshParams.params || self.form.params;\r\n                self.render(refreshParams);\r\n            });\r\n        }).fail(function(message) {\r\n            /*** Form load failure ***/\r\n\r\n            var errorTemplate = self.renderFactory.getCommonTemplate(\"form-error\");\r\n            var error_message = message.message || \"Error\";\r\n\r\n            $.kendoTmpls(errorTemplate, { message: error_message }).appendTo(self.container.element);\r\n            // Navigate on view\r\n            self.slideFormParams.navigation.navigate(self.container.id);\r\n        }).always(function() {\r\n            bizagi.loading.stop();\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    // Go back and destroy\r\n    goBack: function () {\r\n        this.container.destroy();\r\n    },\r\n\r\n    /**\r\n     * Process render buttons\r\n     */\r\n    _renderButtons: function (form) {\r\n        var self = this;\r\n        var content = $(\"<div class='bz-slide-button-container'></div>\");\r\n\r\n        $.each(form.buttons, function (ui, value) {\r\n            $(\"<div class='action-button'>\" + value.caption + \"</div>\").click(\r\n                value.callback\r\n            ).appendTo(content);\r\n        });\r\n\r\n        self.buttonContainer = content;\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Tablet slide grid view implementation\r\n *   Author: Richar Urbano - RicharU\r\n *   Comments:\r\n *   -   Serves as an slide view that will show hidden columns for a grid\r\n */\r\n\r\n// Extends itself\r\n$.Class.extend(\"bizagi.rendering.tablet.slide.view.grid\", {}, {\r\n\r\n    /* CONSTRUCTOR\r\n     =====================================================*/\r\n    init: function (dataService, renderFactory, slideFormParams) {\r\n\r\n        var self = this;\r\n\r\n        // Define instance variables\r\n        this.dataService = dataService;\r\n        this.renderFactory = renderFactory;\r\n        this.slideFormDeferred = new $.Deferred();\r\n        this.slideFormParams = slideFormParams || {};\r\n\r\n        // Create container\r\n        self.container = self.slideFormParams.navigation.createRenderContainer({title: self.slideFormParams.title});\r\n    },\r\n\r\n    /**\r\n     * Render the grid view form\r\n     * The params are the same that will be send to the ajax service\r\n     * @param {} params\r\n     * @returns {} Returns a deferred\r\n     */\r\n    render: function (params) {\r\n        var self = this;\r\n\r\n        // Fill content\r\n        self.renderSlideForm(self.slideForm, params);\r\n\r\n        self.slideFormDeferred.resolve();\r\n\r\n        // Return promise\r\n        return self.slideFormDeferred.promise();\r\n    },\r\n\r\n    /* RENDERS slideForm\r\n     =====================================================*/\r\n    renderSlideForm: function (slideForm, params) {\r\n\r\n        var self = this;\r\n        var data = self.transformData(params);\r\n\r\n        // Load template and data\r\n        self.form = self.renderFactory.getContainer({\r\n            type: \"form\",\r\n            data: data.form,\r\n            navigation: self.slideFormParams.navigation,\r\n            view_container: self.container\r\n        });\r\n\r\n        self.form.buttons = [$.extend(self.form.buttons[0] || {},\r\n            {\r\n                \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-save\"),\r\n                \"actions\": [\"submitData\", \"refresh\"],\r\n                \"submitData\": true,\r\n                \"refresh\": true,\r\n                \"ordinal\": 0,\r\n                \"action\": \"save\",\r\n                \"save\": true,\r\n                \"style\": \"\",\r\n                // This callback avoid to call the default processButton in the form\r\n                callback: function () {\r\n                    self.goBack();\r\n                    // Resolve deferred with form data\r\n                    var data = {};\r\n                    self.form.collectRenderValues(data);\r\n                    self.slideFormDeferred.resolve(data);\r\n                }\r\n            }),\r\n            $.extend(self.form.buttons[1] || {},\r\n                {\r\n                    \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n                    \"actions\": [\"submitData\", \"refresh\"],\r\n                    \"submitData\": true,\r\n                    \"refresh\": true,\r\n                    \"ordinal\": 1,\r\n                    \"action\": \"back\",\r\n                    \"save\": true,\r\n                    \"style\": \"\",\r\n                    //This callback avoid to call the default processButton in the form\r\n                    callback: function () {\r\n                        // Close slide\r\n                        self.goBack();\r\n                        self.slideFormDeferred.reject();\r\n                    }\r\n                })\r\n        ];\r\n\r\n        // Add save button if the form is editable\r\n        if (!self.slideFormParams.allowEdition) {\r\n            self.form.buttons.shift();\r\n        }\r\n\r\n        //self._renderButtons(self.form);\r\n\r\n        $.when(self.form.render())\r\n            .done(function (element) {\r\n\r\n                // Append form in the slide view\r\n                self.container.element.html(element);\r\n\r\n                self.slideFormParams.navigation.navigate(self.container.id);\r\n\r\n                self.container.setNavigationButtons(self.form);\r\n\r\n                // Remove default form buttons\r\n                $(\".ui-bizagi-button-container .action-button\", self.form.container).remove();\r\n\r\n                // Add Button\r\n                $(\".ui-bizagi-button-container\", self.form.container).append(self.buttonContainer);\r\n\r\n                // Publish an event to check if the form has been set in the DOM\r\n                self.form.triggerHandler(\"ondomincluded\");\r\n            });\r\n    },\r\n\r\n    /**\r\n     * Transform data into a JSON standard rendering format\r\n     * @param {} params\r\n     * @returns {}\r\n     */\r\n    transformData: function (params) {\r\n        var self = this;\r\n        var row = params.row;\r\n        var columns = params.columns;\r\n\r\n        // Set xpath context\r\n        var xpathContext = params.xpathContext.length > 0\r\n            ? params.xpathContext + \".\" + params.xpath + \"[\" + params.row[0] + \"]\"\r\n            : params.xpath + \"[id=\" + params.row[0] + \"]\";\r\n\r\n        var data = {\r\n            type: \"form\",\r\n            form: {\r\n                elements: [],\r\n                pageCacheId: params.pageCacheId,\r\n                sessionId: params.sessionId,\r\n                properties: {\r\n                    xpathContext: xpathContext\r\n                },\r\n                actions: self.transformActions(params.xpath, params.actions),\r\n                validations: self.transformValidations(params.xpath, params.validations)\r\n            }\r\n        };\r\n\r\n        $.each(row, function (i, item) {\r\n\r\n            // Skip first data (key not need to be rendered)\r\n            if (i > 0) {\r\n                var element = {render: {properties: $.extend({}, columns[i - 1].properties)}};\r\n\r\n                // Hack properties\r\n                element.render.properties.type = self.mapRenderType(element.render.properties.type);\r\n                element.render.properties.displayType = 'both';\r\n                if (self.slideFormParams.allowEdition == false) element.render.properties.editable = false;\r\n                element.render.properties.value = self.mapValue(element.render.properties.type, item);\r\n                if (element.render.properties.recalculate) element.render.properties.data = null;\r\n\r\n                // Check columnVisible property\r\n                if (typeof (element.render.properties.columnVisible) != \"undefined\") {\r\n                    element.render.properties.visible = element.render.properties.columnVisible;\r\n                }\r\n\r\n                // Fix upload columns\r\n                if (element.render.properties.type == \"upload\") {\r\n                    element.render.properties.isColumn = true;\r\n                }\r\n\r\n                // Fix search columns\r\n                if (element.render.properties.type == \"search\") {\r\n                    var value = element.render.properties.value;\r\n                    if (value.length > 0) {\r\n                        value = [].concat(value[0]);\r\n                        element.render.properties.value = {\r\n                            id: value[0],\r\n                            label: value[1],\r\n                            additionallabel: value[2] || undefined\r\n                        }\r\n                    }\r\n                }\r\n\r\n\r\n                // Add element\r\n                data.form.elements.push(element);\r\n            }\r\n        });\r\n\r\n        return data;\r\n    },\r\n\r\n    /**\r\n     * Map column renderType into normal render\r\n     * @param {} type\r\n     * @returns {}\r\n     */\r\n    mapRenderType: function (type) {\r\n        type = type.substring(6, type.length);\r\n\r\n        //some exceptions\r\n        if (type === \"FormLink\") {\r\n            return \"formLink\";\r\n        }\r\n\r\n        type = type.toLowerCase();\r\n        return type;\r\n    },\r\n\r\n    /**\r\n     * Method to traslate grid values into render values\r\n     * @param {} type\r\n     * @param {} value\r\n     * @returns {}\r\n     */\r\n    mapValue: function (type, value) {\r\n        if (type === \"combo\" || type === \"radio\") {\r\n            if (value && value.length > 0) {\r\n\r\n                // Transform the value property\r\n                return [{\r\n                    id: value[0][0],\r\n                    value: value[0].length > 2\r\n                        ? $.grep(value[0], function (item, i) {\r\n                            return i !== 0;\r\n                        })\r\n                        : value[0][1]\r\n                }];\r\n\r\n            } else {\r\n                return null;\r\n            }\r\n        }\r\n\r\n        // Else: Don't do anything\r\n        return value;\r\n    },\r\n\r\n    /**\r\n     * Parse form actions into just grid form actions\r\n     * @param {} xpath\r\n     * @param {} actions\r\n     * @returns {}\r\n     */\r\n    transformActions: function (xpath, actions) {\r\n        var self = this;\r\n        var gridActions = [];\r\n\r\n        if (bizagi.util.isEmpty(actions)) return gridActions;\r\n\r\n        $.each(actions, function (i, action) {\r\n            var bDependencyFound = false;\r\n            for (var i = 0; i < action.dependencies.length; i++) {\r\n                if (action.dependencies[i].indexOf(xpath) != -1) {\r\n                    bDependencyFound = true;\r\n                }\r\n            }\r\n\r\n            if (bDependencyFound) {\r\n                var newAction = JSON.parse(JSON.encode(action));\r\n\r\n                // Replace dependencies\r\n                for (var i = 0; i < newAction.dependencies.length; i++) {\r\n                    newAction.dependencies[i] = newAction.dependencies[i].replaceAll(xpath + \"[].\", \"\");\r\n                }\r\n\r\n                // Replace conditions\r\n                self.transformConditions(xpath, newAction.conditions);\r\n\r\n                // Replace commands\r\n                self.transformCommands(xpath, newAction.commands);\r\n                self.transformCommands(xpath, newAction.elseCommands);\r\n\r\n                // Add to grid actions\r\n                gridActions.push(newAction);\r\n            }\r\n        });\r\n\r\n        return gridActions;\r\n    },\r\n\r\n    /*\r\n     *   Parse form validations into just grid form validations\r\n     */\r\n    transformValidations: function (xpath, validations) {\r\n        var self = this;\r\n        var gridValidations = [];\r\n\r\n        if (bizagi.util.isEmpty(validations)) return gridValidations;\r\n\r\n        $.each(validations, function (i, validation) {\r\n            var newValidation = JSON.parse(JSON.encode(validation));\r\n\r\n            // Replace conditions\r\n            self.transformConditions(xpath, newValidation.conditions);\r\n\r\n            // Add to grid actions\r\n            gridValidations.push(newValidation);\r\n\r\n        });\r\n\r\n        return gridValidations;\r\n    },\r\n\r\n    /**\r\n     * Parse a single condition or a complex condition in order to prepare a grid action/validation\r\n     * @param {} xpath\r\n     * @param {} condition\r\n     * @returns {}\r\n     */\r\n    transformConditions: function (xpath, condition) {\r\n        var self = this;\r\n\r\n        if (condition.expressions) {\r\n            for (i in condition.expressions) {\r\n                self.transformConditions(xpath, condition.expressions[i]);\r\n            }\r\n\r\n        } else if (condition.simple) {\r\n            self.transformConditions(xpath, condition.simple);\r\n\r\n        } else if (condition.complex) {\r\n            self.transformConditions(xpath, condition.complex);\r\n\r\n        } else {\r\n            if (condition.xpath) {\r\n                condition.xpath = condition.xpath.replaceAll(xpath + \"[].\", \"\");\r\n                if (condition.argumentType == 'xpath') {\r\n                    condition.argument = condition.argument.replaceAll(xpath + \"[].\", \"\");\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Parse a command action to prepare a grid action\r\n     * @param {} xpath\r\n     * @param {} commands\r\n     * @returns {}\r\n     */\r\n    transformCommands: function (xpath, commands) {\r\n        var self = this;\r\n        var refreshIndex = null;\r\n        if (commands == null || commands.length === 0) return;\r\n\r\n        for (var i = 0; i < commands.length; i++) {\r\n            if (commands[i].command === \"refresh\") {\r\n                refreshIndex = i;\r\n            } else {\r\n                if (commands[i].xpath) {\r\n                    commands[i].xpath = commands[i].xpath.replaceAll(xpath + \"[].\", \"\");\r\n                }\r\n                if (commands[i].argumentType === 'xpath') {\r\n                    commands[i].argument = commands[i].argument.replaceAll(xpath + \"[].\", \"\");\r\n                }\r\n            }\r\n        }\r\n\r\n        if (refreshIndex != null) {\r\n            commands.splice(i, 1);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Go back and destroy\r\n     * @returns {}\r\n     */\r\n    goBack: function () {\r\n        var self = this;\r\n        self.container.destroy();\r\n    },\r\n\r\n    /**\r\n     * Process render buttons\r\n     * @param {} options\r\n     * @returns {}\r\n     */\r\n    _renderButtons: function (form) {\r\n        var self = this;\r\n        var content = $(\"<div class='bz-slide-button-container'></div>\");\r\n\r\n        $.each(form.buttons, function (ui, value) {\r\n            var button = $(\"<div class='action-button'>\" + value.caption + \"</div>\").click(\r\n                value.callback\r\n            ).appendTo(content);\r\n        });\r\n\r\n        self.buttonContainer = content;\r\n    }\r\n\r\n});","\r\n/*\r\n*   Name: Bizagi Tablet slide view Upload implementation\r\n*   Author: Richar Urbano - RicharU\r\n*   Comments:\r\n*   -   Serves as an slide view that will show an upload file without exiting the application\r\n*/\r\n\r\n// Extends itself\r\n$.Class.extend(\"bizagi.rendering.tablet.slide.view.upload\", {}, {\r\n    /* CONSTRUCTOR\r\n    =====================================================*/\r\n    init: function (dataService, renderFactory, slideFormParams) {\r\n\r\n        var self = this;\r\n\r\n        // Define instance variables\r\n        this.dataService = dataService;\r\n        this.renderFactory = renderFactory;\r\n        this.slideFormDeferred = new $.Deferred();\r\n        this.slideFormParams = slideFormParams || {};\r\n\r\n        // Create container    \t\r\n        self.slideContainer = self.slideFormParams.navigation.createRenderContainer({title : self.slideFormParams.title});\r\n\r\n        self.processButtons()\r\n            .done(function (data) {\r\n                self.slideFormDeferred.resolve(data);\r\n            }).fail(function () {\r\n                self.slideFormDeferred.reject();\r\n            });\r\n    },\r\n\r\n    /**\r\n     * Shows the slideForm form container in the browser \r\n     * @returns {} Returns a promise that the dialog will be closed\r\n     */\r\n    processButtons: function () {\r\n        var self = this;\r\n        var dfd = new $.Deferred();\r\n\r\n        // Create buttons object\r\n        var slideOptions = { buttons: [] };\r\n\r\n        // Add cancel button by default\r\n        var onClose = function onClose() {\r\n            // Close slide\r\n            self.goBack();\r\n            //reject defered\r\n            dfd.reject();\r\n        };\r\n        slideOptions.buttons.push({\r\n            text: bizagi.localization.getResource(\"workportal-case-dialog-box-close\"),\r\n            caption: bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n            actions: [\"submitData\", \"refresh\"],\r\n            submitData: false,\r\n            refresh: false,\r\n            ordinal: 0,\r\n            action: \"back\",\r\n            save: true,\r\n            style: \"\",\r\n            //This callback avoid to call the default processButton in the form\r\n            callback: onClose,\r\n            click: onClose,\r\n        });\r\n\r\n        // Apply dialog plugin\r\n        this.slideFormParams = $.extend(slideOptions, this.slideFormParams);\r\n        self._renderButtons(this.slideFormParams);\r\n\r\n        // Return promise\r\n        return dfd.promise();\r\n    },\r\n\r\n    /**\r\n     * Render the grid view form\r\n     * The params are the same that will be send to the ajax service\r\n     * @param {} params \r\n     * @returns {} Returns a deferred\r\n     */\r\n    render: function (params) {\r\n        var self = this;\r\n\r\n        // Fill content\r\n        self.renderUploadFile(self.slideForm, params);\r\n\r\n        // Return promise\r\n        return self.slideFormDeferred.promise();\r\n    },\r\n\r\n    /* Render the file inside a frame\r\n    =====================================================*/\r\n    renderUploadFile: function (slideForm, params) {\r\n        var self = this;\r\n        var template = self.renderFactory.getCommonTemplate(\"uploadSlide\");\r\n\r\n        // Render template\r\n        var content = $.kendoTmpls(template, { url: params.url });\r\n\r\n        // Append content in the slide view\r\n        self.slideContainer.element.html(content);\r\n\r\n        // Navigate on view\r\n        self.slideFormParams.navigation.navigate(self.slideContainer.id);\r\n        // Add Button\r\n        // $(\".ui-bizagi-button-container\", self.slideContainer).append(self.buttonContainer);\r\n\r\n        // No need to create a real form cause it just shows the back button\r\n        var virtualForm = $.extend({\r\n            originalProperties: {\r\n                uniqueId: 101,\r\n                id: 101,\r\n            },\r\n        }, self.slideFormParams);\r\n        virtualForm.container = self.slideContainer.element;\r\n\r\n        self.slideFormParams.navigation.setNavigationButtons(virtualForm);\r\n\r\n        content.find(\".ui-slide-upload-link\").click(function () {\r\n            $.when(bizagi.showConfirmationBox(bizagi.localization.getResource(\"render-tablet-slide-upload-confirmation\")))\r\n                .done(function () {\r\n                    window.location.href = params.url;\r\n                });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Go back and destroy\r\n     * @returns {} \r\n     */\r\n    goBack: function () {\r\n        var self = this;\r\n\r\n        self.slideContainer.destroy();\r\n    },\r\n\r\n    /**\r\n     * Process render buttons\r\n     * @param {} options \r\n     * @returns {} \r\n     */\r\n    _renderButtons: function (options) {\r\n        var self = this;\r\n        var content = $(\"<div class=\\\"bz-slide-button-container\\\"></div>\");\r\n\r\n        $.each(options.buttons, function (ui, value) {\r\n            $(\"<div class=\\\"action-button\\\">\" + value.text + \"</div>\").click(\r\n                value.click\r\n            ).appendTo(content);\r\n        });\r\n\r\n        self.buttonContainer = content;\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Tablet Search Slide view Implementation\r\n*   Author: Richar Urbano - RicharU\r\n*   Comments:\r\n*   -   This script will shows a sliding search form  order to edit\r\n*/\r\n\r\n// Extends itself\r\n$.Class.extend(\"bizagi.rendering.tablet.slide.view.search\", {}, {\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (dataService, renderFactory, searchForms, searchParams, slideParams) {\r\n        var self = this;\r\n\r\n        self.dataService = dataService;\r\n        self.renderFactory = renderFactory;\r\n        self.searchForms = searchForms;\r\n        self.searchParams = searchParams;\r\n        self.slideParams = slideParams;\r\n        self.slideDeferred = new $.Deferred();\r\n        self.extraButtons = (slideParams.hasOwnProperty(\"buttons\")) ? slideParams.buttons : false;\r\n\r\n        // Create container\r\n        self.container = self.slideParams.navigation.createRenderContainer({ title: self.slideParams.title });\r\n\r\n        self.processButtons()\r\n            .done(function (data) {\r\n                self.slideDeferred.resolve(data);\r\n            }).fail(function () {\r\n                self.slideDeferred.reject();\r\n            });\r\n\r\n        self.configureViewHandlers();\r\n    },\r\n\r\n    /**\r\n     * Render the form\r\n     * The params are the same that will be send to the ajax service\r\n     * @param {} params \r\n     * @returns {} Returns a deferred\r\n     */\r\n    render: function (params) {\r\n        var self = this;\r\n\r\n        self.properties = params;\r\n\r\n        //Render the search form\r\n        self.renderSearchDialog(params);\r\n\r\n        // Return promise\r\n        return self.slideDeferred.promise();\r\n    },\r\n\r\n    /**\r\n     * Render the search form\r\n     * @param {} params \r\n     * @returns {} \r\n     */\r\n    renderSearchDialog: function (params) {\r\n        var self = this;\r\n\r\n        bizagi.util.tablet.startLoading();\r\n\r\n        // Creates a dialog\r\n        $.when(self.getSearchContainerData(params)).pipe(function (data) {\r\n            if (data.form.properties){\r\n                data.form.properties.orientation = self.searchParams.orientation || \"ltr\";\r\n            }\r\n\r\n            // Render dialog form\r\n            var form = self.renderFactory.getContainer({\r\n                type: \"form\",\r\n                data: data.form,\r\n                navigation: self.slideParams.navigation,\r\n                view_container: self.container\r\n            });\r\n\r\n            form.buttons = [\r\n                {\r\n                  ordinal: 1,\r\n                  action: \"search\",\r\n                  caption: bizagi.localization.getResource(\"render-form-dialog-box-search\"),\r\n                  callback: function () {\r\n                    self.currentSearchForm.performSearch(self.searchParams);\r\n                  },\r\n                },\r\n                {\r\n                  ordinal: 2,\r\n                  action: \"cancel\",\r\n                  caption: \"cancel\",\r\n                  callback: function () {\r\n                    // Close slide\r\n                    self.goBack();\r\n                  },\r\n                },\r\n                {\r\n                  ordinal: 3,\r\n                  action: \"add\",\r\n                  caption: bizagi.localization.getResource(\"render-form-dialog-box-add\"),\r\n                  callback: function () {\r\n                    var params = {\r\n                      idCase: self.slideParams.idCase,\r\n                      idRender: self.properties.idRender,\r\n                      displayName: self.properties.displayName,\r\n                      idPageCache: self.properties.idPageCache\r\n                    };\r\n\r\n                    self.renderAddForm(params);\r\n                  },\r\n                },\r\n            ];\r\n\r\n            if (!self.slideParams.allowNew) {\r\n              form.buttons.pop();\r\n            }\r\n\r\n            // Save form reference\r\n            self.form = form;\r\n\r\n            // Return rendering promise\r\n            return form.render();\r\n        }).done(function (element) {\r\n            // Append form in the slide view\r\n            self.container.element.html(element);\r\n\r\n            self.slideParams.navigation.navigate(self.container.id);\r\n\r\n            // Add Button\r\n            $(\".ui-bizagi-button-container\", self.form.container).append(self.buttonContainer);\r\n\r\n            // Hide title of html content\r\n            self.searchResultContainer = $(\".ui-bizagi-container-search-results\", element);\r\n            self.searchResultContainer.hide();\r\n\r\n            // Publish an event to check if the form has been set in the DOM\r\n            self.form.triggerHandler(\"ondomincluded\");\r\n\r\n            // Set currents search form\r\n            self.currentSearchForm = self.form.firstChild();\r\n            self.currentSearchForm.triggerHandler(\"ondomincluded\");\r\n\r\n            self.currentSearchForm.bind(\"instancerefresh\", function () {\r\n                // Show search results container\r\n                self.searchResultContainer.show();\r\n            });\r\n\r\n            self.form.bind(\"refresh\", function (_, refreshParams) {\r\n                refreshParams.scrollTop = self.form.container.parent().scrollTop();\r\n                refreshParams = $.extend({\r\n                    focus: focus,\r\n                    selectedTabs: self.form.getSelectedTabs(),\r\n                    isRefresh: true,\r\n                    contextType: self.properties.contextType || \"\",\r\n                    navigation: self.searchFormParams.navigation,\r\n                    view_container: self.container\r\n                }, refreshParams);\r\n\r\n                return self.renderSearchDialog(refreshParams);\r\n            });\r\n\r\n            // Add row selected handlers to resolve the deferred\r\n            self.currentSearchForm.bind(\"instanceSelected\", function (ev, ui) {\r\n                // Close slide      \r\n                self.goBack();\r\n\r\n                self.slideBoxDeferred.resolve({\r\n                    id: ui.id,\r\n                    label: \"\"\r\n                });\r\n            });\r\n            // if is any modal view displayed, hide it to allow this search form been displayed\r\n            self.handleSearchFormZindex(\"show\");\r\n\r\n            self.containerSearchCriteria = self.currentSearchForm.container.find(\".ui-bizagi-container-search-criteria\");\r\n        }).always(function () {\r\n            bizagi.util.tablet.stopLoading();\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Get the addform and show it\r\n     * @param {} params \r\n     * @returns {} \r\n     */\r\n    renderAddForm: function(params) {\r\n        var self = this;\r\n        params = params || {};\r\n        var properties = self.properties;\r\n\r\n        if (typeof self.addContainer === \"undefined\") {\r\n            self.addContainer =\r\n                self.slideParams.navigation.createRenderContainer({\r\n                    title: bizagi.localization.getResource(\"render-dialog-entity\")\r\n                });\r\n        }\r\n\r\n        var isRefresh = params.isRefresh || false;\r\n\r\n        var getFormParams = {\r\n            idPageCache: params.idPageCache,\r\n            guidEntity: properties.entity,\r\n            contextType: \"entity\"\r\n        };\r\n\r\n        if (isRefresh) {\r\n            getFormParams.isRefresh = true;\r\n            getFormParams.idStartScope = params.idStartScope;\r\n        } else {\r\n            getFormParams.idRender = properties.idRender;\r\n            getFormParams.requestedForm = \"addForm\";\r\n        }\r\n\r\n        bizagi.util.tablet.startLoading();\r\n\r\n        //Get the addform\r\n        $.when(self.dataService.getFormData(getFormParams)).pipe(function(data) {\r\n            if (params.editable === false) {\r\n                data.form.properties.editable = false;\r\n            }\r\n\r\n            if (data.form.properties) {\r\n                data.form.properties.orientation = self.searchParams.orientation || \"ltr\";\r\n            }\r\n\r\n            data.form.contextType = \"entity\";\r\n\r\n            var form = self.renderFactory.getContainer($.extend({}, self.addFormParams, {\r\n                type: \"form\",\r\n                data: data.form,\r\n                focus: params.focus || false,\r\n                selectedTabs: params.selectedTabs,\r\n                isRefresh: isRefresh,\r\n                requestedForm: params.requestedForm,\r\n                navigation: self.slideParams.navigation,\r\n                view_container: self.addContainer\r\n\r\n            }));\r\n\r\n            form.buttons = [\r\n                $.extend(\r\n                    self.form.buttons[0] || {},\r\n                    {\r\n                        \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-save\"),\r\n                        \"actions\": [\"submitData\", \"refresh\"],\r\n                        \"submitData\": true,\r\n                        \"refresh\": true,\r\n                        \"ordinal\": 0,\r\n                        \"action\": \"save\",\r\n                        \"save\": true,\r\n                        \"style\": \"\",\r\n                    },\r\n                    {\r\n                        //This callback avoid to call the default processButton in the form\r\n                        callback: function() {\r\n                            // When the data is saved then\r\n                            self.saveDataAddForm(form).done(function() {\r\n                                self.addContainer.destroy();\r\n                                delete self.addContainer;\r\n\r\n                                // Force a search after a new item is created!\r\n                                self.currentSearchForm.performSearch(self.searchParams);\r\n                            });\r\n                        }\r\n                    }),\r\n                $.extend(\r\n                    self.form.buttons[1] || {},\r\n                    {\r\n                        \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n                        \"actions\": [\"submitData\", \"refresh\"],\r\n                        \"submitData\": true,\r\n                        \"refresh\": true,\r\n                        \"ordinal\": 1,\r\n                        \"action\": \"back\",\r\n                        \"save\": true,\r\n                        \"style\": \"\",\r\n                    },\r\n                    {\r\n                        //This callback avoid to call the default processButton in the form\r\n                        callback: function() {\r\n                            self.addContainer.destroy();\r\n                            delete self.addContainer;\r\n                        }\r\n                    }),\r\n            ];\r\n\r\n            $.extend(form, {\r\n                processButtons: function() {\r\n                    //not send information set in memory and save\r\n\r\n                    $.each(form.buttons, function(index, element) {\r\n                        switch (element[\"ordinal\"]) {\r\n                        case 1: //next button will behave as a cancel button\r\n                            $(form.getButtons()[index]).click(function() {\r\n                                self.addContainer.destroy();\r\n                                delete self.addContainer;\r\n                            });\r\n                            form.getButtons()[index].innerHTML = bizagi.localization.getResource(\"render-form-dialog-box-close\");\r\n                            form.buttons[index].caption = bizagi.localization.getResource(\"render-form-dialog-box-close\");\r\n                            form.buttons[index].action = \"back\";\r\n                            break;\r\n\r\n                        default:\r\n                            $(form.getButtons()[index]).click(function() {\r\n                                self.saveDataAddForm(form);\r\n                                self.addContainer.destroy();\r\n                                delete self.addContainer;\r\n                            });\r\n                            break;\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n\r\n            for (var indicator in form.children) {\r\n                form.children[indicator].params = $.extend({}, form.children[indicator].params, self.addFormParams);\r\n            }\r\n\r\n            return $.when(form.render()).done(function(element) {\r\n                // Set currents search form\r\n                self.currentAddForm = form.firstChild();\r\n\r\n                self.addContainer.element.html(element);\r\n                if (!isRefresh) {\r\n                    self.slideParams.navigation.navigate(self.addContainer.id, \"overlay:up\");\r\n                }\r\n\r\n                self.addContainer.setNavigationButtons(form);\r\n\r\n                form.triggerHandler(\"ondomincluded\");\r\n\r\n                // if is any modal view displayed, hide it to allow this search form been displayed\r\n                self.handleSearchFormZindex(\"show\");\r\n\r\n                form.bind(\"refresh\", function(_, refreshParams) {\r\n                    refreshParams.scrollTop = self.form.container.parent().scrollTop();\r\n                    refreshParams = $.extend({\r\n                        focus: focus,\r\n                        selectedTabs: self.form.getSelectedTabs(),\r\n                        isRefresh: true,\r\n                        contextType: self.properties.contextType || \"\",\r\n                        navigation: self.slideParams.navigation,\r\n                        view_container: self.addContainer\r\n                    }, refreshParams);\r\n\r\n                    return self.renderAddForm(refreshParams);\r\n                });\r\n            });\r\n        }).fail(function() {\r\n            self.addContainer.destroy();\r\n            delete self.addContainer;\r\n            console.log(\"there was an error :(\");\r\n        }).always(function() {\r\n            bizagi.util.tablet.stopLoading();\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Save data to add form\r\n     * @param {} form \r\n     * @returns {} \r\n     */\r\n    saveDataAddForm: function (form) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = $.Deferred();\r\n        if (form.validateForm()) {\r\n            var data = {};\r\n            $.forceCollectData = true;\r\n\r\n            form.collectRenderValues(data);\r\n            data.idPageCache = form.idPageCache;\r\n\r\n            var params = {\r\n                action: \"SAVE\",\r\n                data: data,\r\n                idPageCache: data.idPageCache,\r\n                guidEntity: form.properties.entity,\r\n                contexttype: \"entity\",\r\n            };\r\n\r\n            // Check if the add form has data\r\n            var formData = {};\r\n\r\n            form.collectRenderValuesForSubmit(formData);\r\n\r\n            // Turn off flag\r\n            $.forceCollectData = false;\r\n\r\n            if (!bizagi.util.isMapEmpty(formData)) {\r\n\r\n                bizagi.util.tablet.startLoading();\r\n\r\n                $.when(self.dataService.submitData(params)).done(function () {\r\n                    function dataHasXpath(xpath) {\r\n                        var render = self.currentSearchForm.getRender(xpath);\r\n                    if (typeof render === \"object\" && render !== null) {\r\n                            return { \"found\": true, \"obj\": render };\r\n                        }\r\n                        return { \"found\": false, \"obj\": {} };\r\n                    }\r\n                    for (var i in formData) {\r\n                        var mapping = dataHasXpath(i);\r\n                        if (mapping.found) {\r\n                            mapping.obj.setValue(formData[i]);\r\n                            self.setDisplayValueToControl(mapping.obj, form, i, formData);\r\n                        }\r\n                    }\r\n\r\n                    defer.resolve();\r\n                }).fail(function (jqXHR, type, message) {\r\n                    form.addValidationMessage(message.message);\r\n                    defer.reject();\r\n                }).always(function () {\r\n                    bizagi.util.tablet.stopLoading();\r\n                });\r\n            } else {\r\n                // Form has not data\r\n                bizagi.showMessageBox(bizagi.localization.getResource(\"render-search-advanced-no-filters\"));\r\n                defer.reject();\r\n            }\r\n        }\r\n        else {\r\n          defer.reject();\r\n        }\r\n        return defer;\r\n    },\r\n\r\n    /***\r\n     * Set display value by control type, when add new record\r\n     * @param renderControlSearchForm\r\n     * @param addForm\r\n     * @param xpath\r\n     * @param formData\r\n     */\r\n    setDisplayValueToControl: function (renderControlSearchForm, addForm, xpath, formData){\r\n        if(renderControlSearchForm.properties.type === \"searchSuggest\"){\r\n            renderControlSearchForm.setDisplayValue(addForm.getRender(xpath).getDisplayValue());\r\n        }\r\n        else{\r\n            renderControlSearchForm.setDisplayValue(formData[xpath]);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Shows the dialog box in the browser\r\n     * @returns {} Returns a promise that the dialog will be closed\r\n     */\r\n    processButtons: function () {\r\n        var self = this;\r\n        self.slideBoxDeferred = new $.Deferred();\r\n\r\n        // Create buttons object\r\n        var slideOptions = { buttons: [] };\r\n\r\n        // Add search button by default\r\n        slideOptions.buttons.push({\r\n            text: bizagi.localization.getResource(\"render-form-dialog-box-search\"),\r\n            click: function () {\r\n                self.currentSearchForm.performSearch(self.searchParams);\r\n            }\r\n        });\r\n\r\n        if (self.slideParams.allowNew) {\r\n            slideOptions.buttons.push({\r\n                text: bizagi.localization.getResource(\"render-form-dialog-box-add\"),\r\n                click: function () {\r\n                    var params = {\r\n                        \"idCase\": self.slideParams.idCase,\r\n                        \"idRender\": self.properties.idRender,\r\n                        \"displayName\": self.properties.displayName,\r\n                        \"idPageCache\": self.properties.idPageCache\r\n                    };\r\n\r\n                    self.renderAddForm(params);\r\n                }\r\n            });\r\n        }\r\n\r\n        slideOptions.buttons.push({\r\n            text: bizagi.localization.getResource(\"render-form-dialog-box-cancel\"),\r\n            click: function () {\r\n                // Close slide      \r\n                self.goBack();\r\n            }\r\n        });\r\n\r\n        // Apply slide plugin\r\n        slideOptions = $.extend(slideOptions, self.slideParams);\r\n        self._renderButtons(slideOptions);\r\n\r\n        // Return promise\r\n        return self.slideBoxDeferred.promise();\r\n    },\r\n\r\n    /**\r\n     * Creates the search dialog sub-containers\r\n     * @param {} params \r\n     * @returns {} \r\n     */\r\n    getSearchContainerData: function (params) {\r\n        var self = this;\r\n        var deferred = new $.Deferred();\r\n        var data = {\r\n            form: { properties: {}, elements: [] }\r\n        };\r\n\r\n        var container = data.form;\r\n        var searchFormToLoad = self.searchForms[0];\r\n\r\n        // When there are more than one search form, render a tab container\r\n        if (self.searchForms.length > 1) {\r\n\r\n            var tabContainer = {};\r\n            tabContainer.properties = { type: \"tab\" };\r\n            tabContainer.elements = [];\r\n            var otherElements = [];\r\n\r\n            $.each(self.searchForms, function (i, searchForm) {\r\n                var isDefault = searchForm[\"default\"] || false;\r\n\r\n                // Create tab item\r\n                var tab = {};\r\n                tab.properties = {\r\n                    id: i,\r\n                    type: \"tabItem\",\r\n                    displayName: searchForm.caption\r\n                };\r\n\r\n                tab.elements = [];\r\n\r\n                // Append children \r\n                if (isDefault) {\r\n\r\n                    tabContainer.elements.push({ container: tab });\r\n\r\n                    // Set properties to load default container\r\n                    container = tab;\r\n                    searchFormToLoad = self.searchForms[0];\r\n\r\n                } else {\r\n                    otherElements.push({ container: tab });\r\n                }\r\n            });\r\n\r\n            // Append no defaults elements\r\n            $.each(otherElements, function (i, element) {\r\n                tabContainer.elements.push(element);\r\n            });\r\n\r\n            data.form.elements.push({\r\n                container: tabContainer\r\n            });\r\n        }\r\n\r\n        bizagi.util.tablet.startLoading();\r\n\r\n        // Loads default form\r\n        $.when(self.getSearchFormData(params, searchFormToLoad))\r\n            .done(function (searchFormData) {\r\n                container.elements.push(searchFormData);\r\n                container.properties.id = Math.guid();\r\n\r\n                // Resolve deferred\r\n                deferred.resolve(data);\r\n            }).always(function () {\r\n                bizagi.util.tablet.stopLoading();\r\n            });\r\n\r\n        return deferred.promise();\r\n    },\r\n\r\n    /**\r\n     * Loads a search form\r\n     * @param {} params \r\n     * @param {} searchForm \r\n     * @returns {} \r\n     */\r\n    getSearchFormData: function (params, searchForm) {\r\n        var self = this;\r\n        return self.dataService.getSearchFormData($.extend(params, {\r\n            idSearchForm: searchForm.id,\r\n            url: searchForm.url\r\n\r\n        })).pipe(function (data) {\r\n            // Append search render properties\r\n            data.form.properties.idRender = params.idRender;\r\n\r\n            return data;\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Go back and destroy\r\n     * @returns {} \r\n     */\r\n    goBack: function () {\r\n        var self = this;\r\n\r\n        self.handleSearchFormZindex(\"hide\");\r\n        self.container.destroy();\r\n    },\r\n\r\n    /**\r\n     * Handlers kendo view\r\n     * @returns {} \r\n     */\r\n    configureViewHandlers: function () {\r\n    },\r\n\r\n    /**\r\n      * Process render buttons\r\n      * @param {} options \r\n      * @returns {} \r\n      */\r\n    _renderButtons: function (options) {\r\n        var self = this;\r\n        var content = $(\"<div class='bz-slide-button-container'></div>\");\r\n\r\n        $.each(options.buttons, function (ui, value) {\r\n            $(\"<div class='action-button'>\" + value.text + \"</div>\").click(\r\n                value.click\r\n            ).appendTo(content);\r\n        });\r\n\r\n        self.buttonContainer = content;\r\n    },\r\n\r\n    handleSearchFormZindex: function (option) {\r\n\r\n        //if there is an open modal, change z-index to make searchForm visible\r\n        var modalViewDisplayed = jQuery.grep($(\".km-modalview-root\"), function (n) {\r\n            return ($(n).css(\"display\") == \"block\");\r\n        });\r\n\r\n        if (modalViewDisplayed.length > 0) {\r\n            if (option == \"show\") {\r\n                $(modalViewDisplayed).css(\"z-index\", 0);\r\n            } else {\r\n                $(modalViewDisplayed).css(\"z-index\", 10001);\r\n            }\r\n        }\r\n    }\r\n});\r\n","/*\r\n *   Name: Bizagi Tablet slide form implementation\r\n *   Author: Bizagi Mobile Team\r\n *   Comments:\r\n *   -   Serves as an slide form that can render a inner form\r\n */\r\n\r\n// Extends itself\r\n$.Class.extend('bizagi.rendering.tablet.startForm', {}, {\r\n\r\n    /* CONSTRUCTOR\r\n     =====================================================*/\r\n    init: function (dataService, renderFactory, slideFormParams) {\r\n\r\n        var self = this;\r\n\r\n        // Define instance variables\r\n        self.dataService = dataService;\r\n        self.renderFactory = renderFactory;\r\n        self.slideFormParams = slideFormParams || {};\r\n\r\n        // Create container        \r\n        self.slideContainer = self.slideFormParams.navigation.createRenderContainer({ title: self.slideFormParams.title });\r\n        self.configureViewHandlers();\r\n    },\r\n\r\n    /**\r\n     * Handlers kendo view\r\n     * @returns {} \r\n     */\r\n    configureViewHandlers: function () {\r\n        var self = this;\r\n    },\r\n\r\n    /**\r\n     * Go back and destroy\r\n     * @returns {} \r\n     */\r\n    goBack: function () {\r\n        var self = this;\r\n        self.slideContainer.destroy();\r\n    },\r\n\r\n    /**\r\n     * Render the form\r\n     * The params are the same that will be send to the ajax service\r\n     * @param {} params \r\n     * @returns {} Returns a deferred\r\n     */\r\n    render: function (params) {\r\n        var self = this;\r\n        // Fill content\r\n        self.renderSlideForm(params);\r\n    },\r\n\r\n    /* RENDERS slideForm\r\n     =====================================================*/\r\n    renderSlideForm: function (params) {\r\n\r\n        var self = this;\r\n\r\n        var defer = new $.Deferred();\r\n\r\n        // Load template and data\r\n        $.when(self.dataService.getStartForm(params)).then(function (data) {\r\n            /*** SUCCESS FILTER **/\r\n            // Apply editable param\r\n            if (params.editable === false) {\r\n                data.form.properties.editable = false;\r\n            }\r\n\r\n            // Render dialog template\r\n            var formClass = bizagi.rendering.form.extend({\r\n                submitForm: function () {\r\n                    if (self.form) {\r\n                        this.endLoading();\r\n                        // Perform validations\r\n                        if (self.form.validateForm()) {\r\n                            // Collect data\r\n                            var data = {};\r\n\r\n                            self.form.collectRenderValues(data);\r\n\r\n                            // Add page cache for this form\r\n                            data.idPageCache = self.form.getPageCache();\r\n\r\n                            // Call user callback\r\n                            if (self.slideFormParams.onSave) {\r\n                                $.when(self.slideFormParams.onSave(data))\r\n                                    .done(function (result) {\r\n                                        if (result == null || result == true || result.type == \"success\") {\r\n                                            defer.resolve();\r\n                                            self.goBack();\r\n                                        } else if (result.type == \"validationMessages\") {\r\n                                            // Add validation messages\r\n                                            self.form.addValidationMessage(result.messages);\r\n                                            // Update original value to use as reference to other futures changes in the dialogBox\r\n                                            $.each(data, function (key, value) {\r\n                                                var renders = self.form.getRenders(key);\r\n                                                $.each(renders, function (i, render) {\r\n                                                    render.updateOriginalValue();\r\n                                                });\r\n                                            });\r\n                                        } else if (result.type == \"error\") {\r\n                                            // Add error messages\r\n                                            self.form.addErrorMessage(result.message);\r\n                                        }\r\n                                    });\r\n\r\n                            } else {\r\n                                defer.resolve();\r\n                                self.goBack();\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n\r\n            var containerParams = $.extend({\r\n                type: \"form\",\r\n                data: data.form,\r\n                navigation: self.slideFormParams.navigation,\r\n                view_container: self.slideContainer\r\n            }, {\r\n                renderFactory: self.renderFactory,\r\n                dataService: self.renderFactory.dataService\r\n            });\r\n\r\n            self.form = new formClass(containerParams);\r\n\r\n\r\n            // Attach a refresh handler to recreate all the form\r\n            self.form.bind(\"refresh\", function (_, refreshParams) {\r\n                refreshParams = $.extend({\r\n                    selectedTabs: self.form.getSelectedTabs(),\r\n                    isRefresh: true\r\n                }, params, refreshParams, { idStartScope: self.form.properties.idStartScope });\r\n\r\n                self.renderSlideForm(refreshParams);\r\n            });\r\n            \r\n            self.form.buttons = [\r\n                $.extend(\r\n                    self.form.buttons[0] || {},\r\n                    {\r\n                        \"caption\": self.slideFormParams.saveButtonLabel,\r\n                        \"actions\": [\"submitData\", \"refresh\"],\r\n                        \"submitData\": true,\r\n                        \"refresh\": true,\r\n                        \"ordinal\": 0,\r\n                        \"action\": \"save\",\r\n                        \"save\": true,\r\n                        \"style\": \"\",\r\n                    })];\r\n\r\n            // Return rendering promise\r\n            return self.form.render();\r\n        }).done(function (element) {\r\n            // Append form  in the view\r\n            self.slideContainer.element.html(element);\r\n\r\n            if (!params.isRefresh) {\r\n                self.slideFormParams.navigation.navigate(self.slideContainer.id);\r\n            }\r\n\r\n            $('.ui-bizagi-button-container div', self.form.container).remove();\r\n\r\n            $('.ui-bizagi-button-container', self.form.container).append('<div ordinal=\"0\" id=\"formButton0\" class=\"action-button ui-bizagi-form-button\">' + (self.slideFormParams.saveButtonLabel ? self.slideFormParams.saveButtonLabel : bizagi.localization.getResource(\"render-form-dialog-box-save\")) + '</div>').delegate('div[ordinal=\"0\"]', 'click', function () {\r\n                self.form.submitForm();\r\n            });\r\n\r\n            $('.ui-bizagi-button-container', self.form.container).append('<div ordinal=\"1\" id=\"formButton1\" class=\"action-button ui-bizagi-form-button\">' + bizagi.localization.getResource(\"render-form-dialog-box-cancel\") + '</div>').delegate('div[ordinal=\"1\"]', 'click', function () {\r\n                self.slideFormParams.onCancel && self.slideFormParams.onCancel();\r\n                self.goBack();\r\n            });\r\n\r\n            //self.view.scroller.reset();\r\n            // Publish an event to check if the form has been set in the DOM\r\n            self.form.triggerHandler(\"ondomincluded\");\r\n        }).fail(function (xhr, errorType, message) {\r\n            /*** FAIL FILTER **/\r\n            var errorTemplate = self.renderFactory.getCommonTemplate(\"form-error\");\r\n            var error_message = message.message || \"Error\";\r\n\r\n            $.kendoTmpls(errorTemplate, { message: error_message }).appendTo(self.slideContainer.element);\r\n            // Navigate on view\r\n            self.slideFormParams.navigation.navigate(self.slideContainer.id);\r\n        });\r\n\r\n        return defer.promise();\r\n    }\r\n});","/*\r\n*   Name: BizAgi Tablet Form Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the container class to adjust to tablet devices\r\n*   -   Will apply a desktop form template\r\n*/\r\n\r\n// Auto extend\r\nbizagi.rendering.form.extend(\"bizagi.rendering.form\", {\r\n\r\n    /**\r\n     * CONSTRUCTOR\r\n     * \r\n     * @param {} params \r\n     * @returns {} \r\n     */\r\n    init: function (params) {\r\n        var self = this;\r\n        params = params || {};\r\n        // Define variables\r\n        self.warnings = {};\r\n        self.errors = {};\r\n\r\n        // Call base\r\n        this._super(params);\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the container's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var complexGatewayContainer;\r\n        var form = self.container;\r\n\r\n        if (form.length > 1) {\r\n            $(form).each(function () {\r\n                if ($(this).hasClass('ui-bizagi-container-complexgateway')) {\r\n                    complexGatewayContainer = this;\r\n                }\r\n            });\r\n        } else {\r\n            complexGatewayContainer = $(\".ui-bizagi-container-complexgateway\", form);\r\n        }\r\n\r\n        // activeTransitions is used to store ids of activities in Complex Gateway\r\n        self.activeTransitions = {};\r\n\r\n        // Process buttons\r\n        self.processButtons(form);\r\n        // Check for dom included event\r\n        self.bind(\"ondomincluded\", function () {\r\n            // Creates validation controller after the form is ready\r\n            self.validationController = new bizagi.command.controllers.validation(self, self.validations);\r\n            // Creates action controller after the form is ready\r\n            self.actionController = new bizagi.command.controllers.action(self, self.actions);\r\n\r\n            // Resolve this deferred to start executing DOM dependant plugins\r\n            self.configureMediaQueryHandlers();\r\n            self.readyDeferred.resolve();\r\n        });\r\n\r\n\r\n        //Event to notify the native code the form will be showing a modal view \r\n        self.bind(\"modalViewDidAppear\", function () {\r\n            self.params.navigation.modalViewDidAppear();\r\n        });\r\n\r\n        //Event to notify the native code the form will be hiding a modal view \r\n        self.bind(\"modalViewDidDisappear\", function () {\r\n            self.params.navigation.modalViewDidDisappear();\r\n        });\r\n\r\n        // Set events for complex gateway interface - Tablet flat\r\n        $(\".bz-rn-cg-checkbox-control\", complexGatewayContainer).bind(\"click\", function () {\r\n            var checkboxLabel = $(\"label\", this);\r\n            var transitionId = checkboxLabel.data(\"value\") || \"\";\r\n\r\n            if (typeof self.activeTransitions[transitionId] == \"undefined\") {\r\n                self.activeTransitions[transitionId] = false;\r\n            }\r\n\r\n            if (bizagi.util.parseBoolean(checkboxLabel.data(\"checked\"))) {\r\n                // Uncheck element\r\n                checkboxLabel.removeClass(\"ui-checkbox-state-checked\");\r\n                checkboxLabel.removeClass(\"bz-check\").addClass(\"bz-full-ball\");\r\n                checkboxLabel.data(\"checked\", false);\r\n                self.activeTransitions[transitionId] = false;\r\n            } else {\r\n                // Check element\r\n                checkboxLabel.addClass(\"ui-checkbox-state-checked\");\r\n                checkboxLabel.addClass(\"bz-mo-icon\").addClass(\"bz-check\").removeClass(\"bz-full-ball\");\r\n                checkboxLabel.data(\"checked\", true);\r\n                self.activeTransitions[transitionId] = true;\r\n            }\r\n        });\r\n\r\n    },\r\n\r\n    /**\r\n     * Just to tablet devices is called after the form is in the dom\r\n     * in order to define if the form must be showed vertical\r\n     * @param {}\r\n     * @returns {}\r\n     */\r\n    configureMediaQueryHandlers: function () {\r\n        var self = this;\r\n        var mediaquery = window.matchMedia(\"(max-width: 600px)\");\r\n        function handleOrientationChange(mediaquery) {\r\n            if (mediaquery.matches) {\r\n                // mediaquery dentro de 600                \r\n                if (self.container) {\r\n                    $(\".ui-bizagi-render\", self.container).addClass(\"vertical\");\r\n                }\r\n            } else {\r\n                // mediaquery fuera de 600                \r\n                if (self.container) {\r\n                    $(\".ui-bizagi-render\", self.container).removeClass(\"vertical\");\r\n                }\r\n            }\r\n        }\r\n        mediaquery.addListener(handleOrientationChange);\r\n        handleOrientationChange(mediaquery);\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each container after processed\r\n     * \r\n     * @param {} container \r\n     * @returns {} \r\n     */\r\n    postRenderContainer: function (container) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        self._super(container);\r\n        var buttons = self.getButtons();\r\n\r\n        //disable overflow-scrolling touch untill the form is loaded QA-2178\r\n        if (bizagi.util.detectDevice() != \"tablet_android\") {\r\n            $(\".km-native-scroller\").css(\"-webkit-overflow-scrolling\", \"inherit\");\r\n        }\r\n\r\n        // Show warnings\r\n        if (!bizagi.util.isObjectEmpty(self.warnings)) {\r\n            var warningContainer = $('<ul class=\"ui-bizagi-form-warnings\"></ul>');\r\n            for (var key in self.warnings) {\r\n                warningContainer.append($('<li>' + key + '</li>'));\r\n            }\r\n\r\n            // Add button\r\n            $(\"<button>\" + \"X\" + \"</button>\").appendTo(warningContainer);\r\n\r\n            // Append to body \r\n            warningContainer.prependTo(self.container);\r\n            warningContainer.click(function () {\r\n                warningContainer.detach();\r\n            });\r\n        }\r\n\r\n        // Show errors\r\n        if (!bizagi.util.isObjectEmpty(self.errors)) {\r\n            var errorContainer = $('<ul class=\"ui-bizagi-form-errors\"></ul>');\r\n            for (var ekey in self.errors) {\r\n                errorContainer.append($('<li>' + ekey + '</li>'));\r\n            }\r\n\r\n            // Add button\r\n            $(\"<button>\" + \"X\" + \"</button>\").prependTo(errorContainer);\r\n\r\n            // Append to body \r\n            errorContainer.appendTo(self.container);\r\n            errorContainer.click(function () {\r\n                errorContainer.detach();\r\n            });\r\n\r\n            // Hide routing buttons when an error was found\r\n            $.each(properties.buttons, function (i, button) {\r\n                if (button.routing) {\r\n                    self.getButtons().eq(i).prop(\"disabled\", true);\r\n                }\r\n            });\r\n        }\r\n\r\n        //Set button length\r\n        var lengthButtons = (buttons) ? buttons.length : 0;\r\n\r\n        if (lengthButtons) {\r\n\r\n            $(document).data(\"auto-save\", \"auto-save\");\r\n\r\n            //bind event auto-save\r\n            $(document).unbind(\"save-form\").bind(\"save-form\", function (e, deferredSave) {\r\n                self.autoSaveEvents(deferredSave);\r\n            });\r\n\r\n            //bind event beforeunload\r\n            $(window).unbind('beforeunload').bind('beforeunload', function (e) {\r\n                var newData = {};\r\n                self.collectRenderValues(newData);\r\n\r\n                //if there are changes in the form show a message\r\n                if (!$.isEmptyObject(newData) && $(document).data('auto-save'))\r\n                    return bizagi.localization.getResource(\"confirmation-savebox-message2\");                \r\n\r\n                return;\r\n            });\r\n\r\n        }\r\n\r\n        //enable overflow-scrolling touch to avoid black frame over the form QA-2178\r\n        if (bizagi.util.detectDevice() != \"tablet_android\") {\r\n            setTimeout(function () {\r\n                $(\".km-native-scroller\").css(\"-webkit-overflow-scrolling\", \"touch\");\r\n            }, 1000);\r\n        }\r\n\r\n    },\r\n    /**\r\n     * Auto Save Events\r\n     * \r\n     * @param {} deferredSave \r\n     * @param {} saveBox \r\n     * @returns {} \r\n     */\r\n    autoSaveEvents: function (deferredSave, saveBox) {\r\n        var self = this;\r\n        var data = {};\r\n        var hasChanges = false;\r\n\r\n        if(bizagi.util.isOfflineForm({ context: self })){\r\n            data = [];\r\n            self.hasChanged(data)\r\n            hasChanges = !bizagi.util.isEmpty(data);\r\n\r\n        }else{\r\n            self.collectRenderValues(data);\r\n            hasChanges = !$.isEmptyObject(data);\r\n        }\r\n\r\n\r\n        if (hasChanges) {\r\n\r\n            $.when(bizagi.showSaveBox(bizagi.localization.getResource(\"confirmation-savebox-message1\"), \"Bizagi\", \"warning\")).done(function () {\r\n                self.saveForm();\r\n                deferredSave.resolve();\r\n            }).fail(function () {\r\n                deferredSave.resolve();\r\n            });\r\n\r\n        } else {\r\n            deferredSave.resolve();\r\n        }\r\n    },\r\n\r\n    internalSubmitForm: function (buttonProperties) {\r\n        var self = this;\r\n        // Assemble the actions\r\n        var actions = [];\r\n        var defer = $.Deferred();\r\n        var submitDataAction = null, executeButtonAction = null, performAction = null, checkpointAction = null, commitAction = null;\r\n        var data;\r\n\r\n        // Fill data hash\r\n        if (buttonProperties.submitData || buttonProperties.executeRule || buttonProperties.createnewcase) {\r\n            // Collect data\r\n            data = self.collectRenderValuesForSubmit();\r\n        }\r\n\r\n        // Start asynchronous operation\r\n        $.when(self.startLoading()).done(function () {\r\n            $('html, body').animate({ scrollTop: $('.ui-bizagi-loading-icon') }, 'slow');\r\n        });\r\n\r\n        // Prepare actions\r\n        if (buttonProperties.executeRule) {  // When the button has to execute any rule (MUST SUBMIT DATA BEFORE ALWAYS)\r\n\r\n            submitDataAction = self.dataService.submitData({\r\n                action: \"SUBMITDATA\",\r\n                data: data,\r\n                xpathContext: self.properties.xpathContext,\r\n                idPageCache: self.properties.idPageCache,\r\n                prepare: true\r\n            });\r\n            submitDataAction.tag = \"submitData\";\r\n\r\n            checkpointAction = self.prepareCheckpointAction(buttonProperties.id);\r\n\r\n            // Reset data because when an execute rule operation has been performed, it saved already all the data\r\n            data = {};\r\n            executeButtonAction = self.dataService.executeButton({\r\n                idRender: buttonProperties.id,\r\n                xpathContext: self.properties.xpathContext || \"\",\r\n                idPageCache: self.properties.idPageCache,\r\n                prepare: true\r\n            });\r\n            executeButtonAction.tag = \"executeRule\";\r\n\r\n            commitAction = self.prepareCommitAction(buttonProperties.id);\r\n        }\r\n\r\n        if (buttonProperties.next || buttonProperties.back || buttonProperties.save || buttonProperties.createnewcase) {\r\n            // Verify transitions\r\n            if (self.transitions) {\r\n                var transitions = [];\r\n                $.each(this.activeTransitions, function (key, value) {\r\n                    (value) ? transitions.push(key) : \"\";\r\n                });\r\n\r\n                if (bizagi.util.countProps(transitions) == 0) {\r\n                    bizagi.showMessageBox(bizagi.localization.getResource(\"render-widget-complexgateway-path\"), bizagi\r\n                        .localization.getResource(\"render-widget-complexgateway-error\"), \"info\", false);\r\n                    self.endLoading();\r\n                    defer.reject();\r\n                    return defer.promise();\r\n                }\r\n            }\r\n\r\n            performAction = self.dataService.submitData({\r\n                action: buttonProperties.action,\r\n                forcePlanCompletion: buttonProperties.forcePlanCompletion,\r\n                data: data,\r\n                xpathContext: self.properties.xpathContext,\r\n                idPageCache: self.properties.idPageCache,\r\n                prepare: true,\r\n                transitions: transitions || \"\",\r\n                contexttype: self.properties.contextType,\r\n                surrogatekey: self.properties.surrogateKey\r\n            });\r\n\r\n            performAction.tag = \"performAction\";\r\n        }\r\n\r\n        if (executeButtonAction) {\r\n            actions.push(submitDataAction);\r\n\r\n            //Validates if the method CHECKPOINT is supported\r\n            if(checkpointAction) {\r\n                actions.push(checkpointAction);\r\n            }\r\n\r\n            actions.push(executeButtonAction);\r\n\r\n            ///Validates if the method COMMIT is supported\r\n            if(commitAction) {\r\n                actions.push(commitAction);\r\n            }\r\n\r\n            actions.push(executeButtonAction);\r\n        }\r\n\r\n        if (performAction) {\r\n            actions.push(performAction);\r\n        }\r\n\r\n        // Execute the batch\r\n        bizagi.chrono.initAndStart(\"submitForm-ajax\");\r\n\r\n        //Evaluate if there are deferreds to evaluate, like inline add in grid, that must send a ADDRELATIONWITHDATA before to savedata\r\n        var flowControlDeferred = new $.Deferred();\r\n        if (data && data.deferreds) {\r\n            $.when.apply(this, data.deferreds)\r\n                .done(function (response) {\r\n                    flowControlDeferred.resolve(response);\r\n                })\r\n                .fail(function () {\r\n                    flowControlDeferred.reject();\r\n                    console.log(\"Error: It was not possible resolve async actions on form \")\r\n                });\r\n        } else {\r\n            flowControlDeferred.resolve();\r\n        }\r\n\r\n        $.when(flowControlDeferred).done(function () {\r\n            bizagi.util.tablet.startLoading();\r\n            $.when(self.dataService.multiaction().execute({ actions: actions })).done(function (responses) {\r\n                bizagi.chrono.stop(\"submitForm-ajax\");\r\n                // Find validations\r\n                var bHasValidations;\r\n                $.each(responses, function (i, response) {\r\n                    if (response.result.type == \"validationMessages\") {\r\n                        // Something went wrong, we gotta display messages in notifications grid\r\n                        self.addValidationMessage(response.result.messages);\r\n                        bHasValidations = true;\r\n                    }\r\n                });\r\n\r\n                if (!bHasValidations) {\r\n                    // Everything went ok .. succesfully response from the server\r\n                    if (!self.postProcessButton(responses, buttonProperties)) {\r\n                        return;\r\n                    }\r\n\r\n                    // After successfully response refresh the form\r\n                    if (buttonProperties.refresh) {\r\n                        self.refreshForm();\r\n                    }\r\n\r\n                    // If needs routing publish an event\r\n                    if (buttonProperties.routing) {\r\n                        self.triggerHandler(\"routing\", {\r\n                            idCase: self.params.idCase\r\n                        });\r\n                    }\r\n\r\n                    // Create case\r\n                    if (buttonProperties.createnewcase) {\r\n                        if (responses.length > 0) {\r\n                            self.triggerHandler(\"routing\", {\r\n                                idCase: responses[0].result.IdCase,\r\n                                caseNumber: responses[0].result.CaseNumber\r\n                            });\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    if (buttonProperties.executeRule) {\r\n                        self.sendRollbackAction(buttonProperties.id);\r\n                    }\r\n                }\r\n\r\n                //Removes the nonSupportedMethods to prevent further iterations\r\n                delete self.nonSupportedMethods;\r\n\r\n                defer.resolve();\r\n            }).fail(function (_, _, response) {\r\n                if (buttonProperties.executeRule) {\r\n                    self.sendRollbackAction(buttonProperties.id);\r\n                }\r\n\r\n                if (response && response.error && (response.error.errorType === \"WaitForCompletionPlanException\" ||\r\n                    response.error.errorType === \"InvalidPlanStateException\" || response.error.errorType === \"CustomMessageException\")) {\r\n                    self.endLoading();\r\n                    $.when(bizagi.showConfirmationBox(bizagi.localization.getResource(response.error.message), null, false)).then(function () {\r\n                        return $.when(self.internalSubmitForm($.extend({}, buttonProperties, { forcePlanCompletion: true })));\r\n                    }).done(function () {\r\n                        defer.resolve();\r\n                    }).fail(function () {\r\n                        defer.reject();\r\n                    });\r\n                } else {\r\n                    self.failHandler({ \"error\": typeof (response) === \"undefined\" ? bizagi.localization.getResource(\"workportal-general-error\") : response });\r\n                    defer.reject(response);\r\n                }\r\n            }).always(function(){\r\n                bizagi.util.tablet.stopLoading();\r\n            });\r\n        }).always(function(){\r\n            bizagi.util.tablet.stopLoading();\r\n        });\r\n        return defer.promise();\r\n    },\r\n\r\n    prepareCheckpointAction: function(id){\r\n        var self = this;\r\n        if(bizagi.util.validateFeatureSupport(\"commitRollbackActions\")) {\r\n            return self._super(id);\r\n        }\r\n\r\n        return null;\r\n    },\r\n\r\n    prepareCommitAction: function(id){\r\n        var self = this;\r\n        if(bizagi.util.validateFeatureSupport(\"commitRollbackActions\")) {\r\n            return self._super(id);\r\n        }\r\n\r\n        return null;\r\n    },\r\n\r\n    /**\r\n     * Retorna el pane donde se pintó la forma para facilitar navegacion de kendo\r\n     * @returns {*}\r\n     */\r\n    getPane: function () {\r\n        var self = this;\r\n        return self.pane;\r\n    },\r\n\r\n    /* TEMPLATE METHOD TO GET THE BUTTONS OBJECTS\r\n     ======================================================*/\r\n    getButtons: function () {\r\n        var self = this;\r\n        var container = self.container;\r\n\r\n        return $(\".ui-bizagi-button-container .action-button\", container);\r\n    },\r\n\r\n    processButtons: function () {\r\n        var self = this;\r\n        var params = self.getParams();\r\n\r\n        //si no es con un if es con un publish\r\n        if (params && params.processButtons) {\r\n            var handler = params.processButtons;\r\n            handler(self);\r\n        }\r\n\r\n        var properties = self.properties;\r\n        var buttons = self.getButtons();\r\n\r\n        properties.buttons = self.buttons || buttons;\r\n\r\n        //to cache a submit Data Buttom if exist\r\n        self.saveButton = null;\r\n        self.nextButton = null;\r\n\r\n        //Set saveButton and nextButton if exist\r\n        for (var i = 0, length = properties.buttons.length; i < length; i++) {\r\n            if (properties.buttons[i].action == 'save') {\r\n                self.saveButton = properties.buttons[i];\r\n            } else if (properties.buttons[i].action == 'next') {\r\n                self.nextButton = properties.buttons[i];\r\n            }\r\n        }\r\n\r\n        var navigation = self.getNavigation();\r\n\r\n        if (typeof (navigation) !== \"undefined\") {\r\n            //si tiene un viewConteiner sera proque es una forma dentro de container de edicion\r\n            var view_container = self.getViewContainer();\r\n            if (typeof view_container !== \"undefined\") {\r\n                view_container.setNavigationButtons(self);\r\n            }\r\n            else\r\n            {\r\n                navigation.setNavigationButtons(self);\r\n            }\r\n        }\r\n\r\n        self._super();\r\n    },\r\n\r\n    /*\r\n     *   Refresh the current form\r\n     */\r\n    refreshForm: function (focus) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var params = self.getParams();\r\n        var deferred = $.Deferred();\r\n        var options;\r\n\r\n        focus = focus || self.getFocus();\r\n\r\n        // Normalize new focus structure if not present\r\n        if (focus && !focus.id) {\r\n            focus = {\r\n                id: focus\r\n            };\r\n        }\r\n\r\n        options = {\r\n            idCase: self.params.idCase || \"\",\r\n            idWorkitem: self.params.idWorkitem || \"\",\r\n            idTask: self.params.idTask || \"\",\r\n            focus: focus,\r\n            selectedTabs: self.getSelectedTabs(),\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            isRefresh: true,\r\n            action: self.getEndPointAction(),\r\n            idStartScope: self.properties.idStartScope || \"\",\r\n            navigation: params.navigation,\r\n            view_container: params.view_container\r\n        };\r\n\r\n        if (params.postRenderEdit || params.processButtons) {\r\n            options.isOfflineForm = self.params.isOfflineForm || false;\r\n            options.formsRenderVersion = self.params.formsRenderVersion || 0;\r\n            options.postRenderEdit = params.postRenderEdit;\r\n            options.processButtons = params.processButtons;\r\n            options.originalParams = params.originalParams || {};\r\n            options.getButtons = params.getButtons;\r\n        }\r\n\r\n        $(\".km-native-scroller\").css(\"-webkit-overflow-scrolling\", \"inherit\");\r\n\r\n        // Notify the refresh event so the consumer takes the decision about what to do\r\n        self.startLoading();\r\n        $.when(self.triggerHandler(\"refresh\", options)).done(function () {\r\n            setTimeout(function () {\r\n                $(\".km-native-scroller\").css(\"-webkit-overflow-scrolling\", \"touch\");\r\n            }, 1000);\r\n\r\n            deferred.resolve();\r\n        }).fail(function () {\r\n            deferred.reject();\r\n        }).always(function () {\r\n            self.endLoading();\r\n        });\r\n\r\n        return deferred.promise();\r\n    },\r\n\r\n    checkWidgetsData: function () {\r\n        var popupResponse = null;\r\n        if (bizagi.workportal.tablet.popup) {\r\n            if (bizagi.workportal.tablet.popup.instance) {\r\n                if (bizagi.workportal.tablet.popup.instance.getResponseValues) {\r\n                    popupResponse = bizagi.workportal.tablet.popup.instance.getResponseValues(bizagi.workportal.tablet.popup.instance.getResponseValuesParams);\r\n                    if (popupResponse === null) {\r\n                        bizagi.showMessageBox(bizagi.localization.getResource(\"workportal-widget-complexgateway-path\"),\r\n                            bizagi.localization.getResource(\"workportal-widget-complexgateway-error\"));\r\n                        return -1;\r\n                    } else {\r\n                        bizagi.workportal.tablet.popup.instance.dontClose = false;\r\n                        bizagi.workportal.tablet.popup.instance.close();\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return popupResponse;\r\n    },\r\n\r\n    repaintComplexGateway: function () {\r\n        var self = this;\r\n        if (self.focus !== undefined) {\r\n            if (self.focus.idCaseObject !== undefined) {\r\n                if (self.focus.idCaseObject.isComplex !== undefined) {\r\n                    self.dataService.getWorkitems({\r\n                        idCase: self.focus.idCaseObject.idCase\r\n                    }).done(function (data) {\r\n                        if (data.workItems.length == 1) {\r\n                            if (data.workItems[0].taskType == \"ComplexGateway\") {\r\n                                var transitions = data.workItems[0].transitions;\r\n\r\n                                self.currentPopup = \"complexgateway\";\r\n                                $(document).triggerHandler(\"popupWidget\", {\r\n                                    widgetName: bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_COMPLEXGATEWAY,\r\n                                    options: {\r\n                                        transitions: transitions,\r\n                                        sourceElement: \".ui-bizagi-form\",\r\n                                        insertAfter: \".ui-bizagi-form .ui-bizagi-button-container\",\r\n                                        height: 'auto',\r\n                                        offset: \"8 0\", //x y\r\n                                        activeScroll: false,\r\n                                        dontClose: true,\r\n                                        closed: function () {\r\n                                            self.currentPopup = null;\r\n                                        }\r\n                                    }\r\n                                });\r\n                            }\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    /* METHOD TO ADD WARNINGS TO THE FORM\r\n    ======================================================*/\r\n    addWarning: function (message) {\r\n        var self = this;\r\n        self.warnings[message] = message;\r\n    },\r\n\r\n    /* METHOD TO ADD ERRORS TO THE FORM\r\n    ======================================================*/\r\n    addError: function (message) {\r\n        var self = this;\r\n        self.errors[message] = message;\r\n    },\r\n\r\n    /*  Executes a single button action\r\n    ======================================================= */\r\n    processButton: function (buttonProperties) {\r\n        var self = this;\r\n        var deferred = $.Deferred();\r\n\r\n        // Disable routing button\r\n        if (!bizagi.util.isObjectEmpty(self.errors)) {\r\n            deferred.resolve();\r\n            if (bizagi.util.parseBoolean(buttonProperties.routing))\r\n                return deferred.promise();\r\n        }\r\n\r\n        // Call base\r\n        return this._super(buttonProperties);\r\n    },\r\n\r\n\r\n    getNavigation: function () {\r\n        var params = this.getFormContainer().getParams();\r\n        return params.navigation;\r\n    },\r\n\r\n    getViewContainer: function () {\r\n        var params = this.getFormContainer().getParams();\r\n        return params.view_container;\r\n    },\r\n\r\n    isFloatingButtonsEnabled: function () {\r\n        var navigation = this.getNavigation();\r\n        return navigation && navigation.isFloatingButtonsEnabled();\r\n    },\r\n\r\n    /**\r\n    *   Adds an overlay to the form, and sets a waiting message\r\n    *\r\n    *   @argument {bool} delay Apply delay\r\n    */\r\n    startLoading: function () {\r\n        bizagi.loading.start();\r\n    },\r\n\r\n    /*\r\n    *   Removes the overlay and restores the form edition\r\n    */\r\n    endLoading: function () {\r\n        bizagi.loading.stop();\r\n    },\r\n\r\n    dispose: function (params) {\r\n        var self = this;\r\n\r\n        // Active refresh on tablet\r\n        if (typeof (params) === \"undefined\" || (typeof (params.isRefresh) === \"undefined\" || params.isRefresh == false)) {\r\n            self._super();\r\n        }\r\n    },\r\n\r\n    failHandler: function (error) {\r\n        var self = this;\r\n        self._super(error);\r\n\r\n        var error_obj = {};\r\n        try {\r\n            error_obj = JSON.parse(error) || {};\r\n        } catch (e) {\r\n            error_obj = (error.length && error.length > 1) ? error[0] : error;\r\n        } finally {\r\n\r\n            //This double validation has the purpose to get the real error object from two different levels ( error.error or error.error.error )\r\n            if (error_obj.error) error_obj = error_obj.error;\r\n            if (error_obj.error) error_obj = error_obj.error;\r\n            \r\n            //trigger the routing event in order to refresh the case\r\n            if (typeof error_obj.code !== \"undefined\" && error_obj.code == \"AUTH_ERROR\") {\r\n\r\n                $.notifier.add({\r\n                    class_name: \"error\",\r\n                    title: \"Error\",\r\n                    text: bizagi.localization.getResource(\"render-idle-expired-error\", \"Idle timer expired. For safety reasons this view will be refreshed automatically in 5 seconds. Note that any unsaved data is lost.\").replace(\"%s\", \"5\"),\r\n                    sticky: false,\r\n                    time: 5000\r\n                });\r\n\r\n                setTimeout(function () {\r\n                    self.triggerHandler(\"routing\", {\r\n                        idCase: self.params.idCase,\r\n                        idWorkitem: self.params.idWorkitem\r\n                    });\r\n                }, 5000);\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n  *   Build the container html\r\n  */\r\n    renderContainer: function () {\r\n        var self = this;\r\n        var properties = this.properties;\r\n        var template = self.renderFactory.getTemplate(\"form\");\r\n        var idCase = \"\";\r\n\r\n        // Render the form\r\n        var html = $.kendoTmpl(template, {\r\n            buttons: self.buttons,\r\n            transitions: self.transitions,\r\n            uniqueId: properties.uniqueId,\r\n            helptext: properties.helpText,\r\n            mode: self.getMode(),\r\n            queryForm: self.getFormType() == \"queryForm\",\r\n            summaryForm: self.params.summaryForm || false,\r\n            globalForm: self.properties.displayAsReadOnly || false,            \r\n            idCase: idCase,\r\n            displayName: self.params.displayName || idCase,\r\n            processPath: properties.processPath,\r\n            breadCrumb: properties.breadCrumb,\r\n            orientation: properties.orientation\r\n        });\r\n\r\n        // Render children\r\n        html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\r\n        return html;\r\n    }\r\n});","/*\r\n*   Name: BizAgi Desktop Panel Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the container class to adjust to desktop devices\r\n*/\r\n\r\n// Auto extend\r\nbizagi.rendering.panel.extend(\"bizagi.rendering.panel\", {}, {\r\n\r\n    \r\n});\r\n","/*\r\n*   Name: BizAgi Tablet Tab Container Extension\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This script will redefine the container class to adjust to tablet devices\r\n*/\r\n\r\n// Auto extend\r\nbizagi.rendering.tab.extend(\"bizagi.rendering.tab\", {\r\n    VISIBLE_TABS: 4\r\n}, {\r\n\r\n    /* POST RENDER CONTAINER ACTIONS\r\n    =================================================*/\r\n    postRenderContainer: function (tab) {\r\n        var self = this;\r\n        self._super(tab);\r\n\r\n        // Apply any plugin or custom code to implement smartphone tabs\r\n        self.suscribeMethods();\r\n    },\r\n\r\n    suscribeMethods: function () {\r\n        var self = this;\r\n        var tab = self.container;\r\n\r\n        //tabs\r\n        $(tab).bztabs({\r\n            activeTab: (self.activeTab !== undefined && self.activeTab !== null) ? self.activeTab : 0,\r\n            tabNumber: self.Class.VISIBLE_TABS,\r\n            domIncluded: self.ready(),\r\n            activate: function (event, ui) {\r\n                self.activeTab = $(event.currentTarget) ? $(event.currentTarget).data(\"index\") : 0;\r\n\r\n                var index = self.activeTab;\r\n                var form = self.getFormContainer();\r\n                var selectedTab = {};\r\n                selectedTab[self.children[index].parent.properties.id] = index;\r\n                form.setParam(\"selectedTabs\", selectedTab);\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Checks the visibility of the plus icon after partial refresh of itemTabs\r\n     */\r\n    checkPlusVisibility: function () {\r\n        var self = this;\r\n        var visible_tabs = $(\".bz-header_select > .bz-wp-tabs-ui:not(:hidden)\", self.container);\r\n        if(visible_tabs.length <= self.Class.VISIBLE_TABS){\r\n            $(\".bz-wp-tabs-arrow-container.show-pluss\", self.container).hide();\r\n        }\r\n        else{\r\n            $(\".bz-wp-tabs-arrow-container.show-pluss\", self.container).show();\r\n        }\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Tablet Panel Extension\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This script will redefine the container class to adjust to tablet devices\r\n*/\r\n\r\n// Auto extend\r\nbizagi.rendering.tabItem.extend(\"bizagi.rendering.tabItem\", {}, {\r\n\r\n    /*\r\n     *   Constructor\r\n     */\r\n    init: function (params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Set tab ready deferred\r\n        self.tabReadyDeferred = new $.Deferred();\r\n        self.loadingDeferred = new $.Deferred();\r\n        self.tabActiveDeferred = new $.Deferred();\r\n    },\r\n\r\n    /**\r\n     * Change selected item \r\n     * \r\n     * @param {} argument \r\n     * @returns {} \r\n     */\r\n    setAsActiveContainer: function (argument) {\r\n        var self = this;\r\n\r\n        $.when(self.ready()).done(function () {\r\n            // Changes item\r\n            var tabContainer = self.parent;\r\n            if (tabContainer && tabContainer.container.tabs.hasOwnProperty(\"option\")) {\r\n                tabContainer.container.tabs(\"option\", \"active\", self.container.data(\"tab-counter\"));\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Focus on container\r\n     * \r\n     * @returns {} \r\n     */\r\n    focus: function () {\r\n        var self = this;\r\n\r\n        // Set this tab as an active container\r\n        self.setAsActiveContainer();\r\n\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     *  Hides / Show container \r\n     * \r\n     * @param {} argument \r\n     * @returns {} \r\n     */\r\n    changeVisibility: function (argument) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var tabContainer = self.parent.container;\r\n        var activeTab = self.parent.getActiveTab();\r\n\r\n        var id = \"ui-bizagi-tab-\" + properties.id;\r\n        var header = $(\".bz-wp-tabs-item[data-reference-tab='#\" + id + \"']\", tabContainer);\r\n\r\n        // Store in properties\r\n        properties.visible = bizagi.util.parseBoolean(argument);\r\n\r\n        $.when(self.ready())\r\n            .done(function () {\r\n                // Hide - show the render\r\n                if (properties.visible) {\r\n                    self.container.css(\"display\", \"\");\r\n                    self.setAsActiveContainer();\r\n                    if (header && header.css(\"display\", \"none\")) {\r\n                        var headerShow = $(\"div[data-reference-tab='#\" + id + \"']\", tabContainer);\r\n                        headerShow && headerShow.css(\"display\", \"\");\r\n                    }\r\n\r\n                } else {\r\n                    self.container.hide();\r\n                    if (header && header.css(\"display\", \"block\")) {\r\n                        var headerHide = $(\"div[data-reference-tab='#\" + id + \"']\", tabContainer);\r\n                        headerHide && headerHide.hide();                        \r\n                    }\r\n                }\r\n            }).always(function () {\r\n                if (tabContainer && tabContainer.tabs.hasOwnProperty(\"option\")) {\r\n                    tabContainer.tabs(\"option\", \"active\", activeTab);\r\n                }\r\n                self.parent.checkPlusVisibility();\r\n            });\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Tablet Horizontal Container Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the horizontal container class to adjust to tablet devices\r\n*/\r\n\r\n// Auto extend\r\nbizagi.rendering.horizontal.extend(\"bizagi.rendering.horizontal\", {}, {\r\n    // TODO: Review Scenario\r\n    /*\r\n    postRenderContainer: function(container) {\r\n        var self = this;\r\n        var children = self.children;\r\n        var iCount = children.length;\r\n\r\n        // Call base\r\n        self._super(container);\r\n\r\n        //console.log(\"bizagi.rendering.horizontal: \" + iCount);\r\n\r\n        // Process each child\r\n        $.each(children, function(i, child) {\r\n            // Process width\r\n            var renderWidth = child.properties.width;\r\n            if (renderWidth == null || renderWidth.length == 0) {\r\n                // Set default size\r\n                renderWidth = 100;\r\n                // renderWidth = 100 / iCount;\r\n            } else {\r\n                // Set custom size\r\n                renderWidth = bizagi.util.percent2Number(renderWidth);\r\n            }\r\n\r\n            // Set width\r\n            if (i != (iCount - 1)) {\r\n                child.getRenderedElement().css({ width: renderWidth + \"%\" });\r\n            } else {\r\n                // Set class for last render\r\n                child.getRenderedElement().addClass(\"ui-bizagi-render-last\");\r\n                child.getRenderedElement().css({ width: (renderWidth - 3.3) + \"%\" });\r\n            }\r\n        });\r\n    }\r\n    */\r\n});\r\n","/*\r\n*   Name: BizAgi Tablet Accordion Container Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the container class to adjust to tablet devices\r\n*/\r\n\r\n// Auto extend\r\nbizagi.rendering.accordion.extend(\"bizagi.rendering.accordion\", {}, {\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Tablet Panel Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the container class to adjust to tablet devices\r\n*/\r\n\r\n// Auto extend\r\nbizagi.rendering.accordionItem.extend(\"bizagi.rendering.accordionItem\", {}, {\r\n\r\n\r\n    /* \r\n    *   Change selected item \r\n    */\r\n    setAsActiveContainer: function (argument) {\r\n        \r\n    },\r\n\r\n    /* \r\n    *   Focus on container\r\n    */\r\n    focus: function () {\r\n        var self = this;\r\n\r\n        self.setAsActiveContainer();\r\n\r\n        // Call base\r\n        this._super();\r\n    }        \r\n});\r\n","/*\r\n*   Name: BizAgi Tablet Group Extension\r\n*   Author: Edward Morales\r\n*   Comments:\r\n*   -   This script will redefine the group class to adjust to tablet devices\r\n*/\r\n\r\n// Auto extend\r\nbizagi.rendering.group.extend(\"bizagi.rendering.group\", {}, {\r\n    /* \r\n    *   Template method to implement in each device to customize each container after processed\r\n    */\r\n    postRenderContainer: function (group) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        // Call base\r\n        self._super(group);\r\n\r\n        group = self.container;\r\n\r\n        // Define expanded property\r\n        properties.expanded = true;\r\n\r\n        self.subscribeOnTouch();\r\n    },\r\n\r\n    /**\r\n    * Check if group its open\r\n    * \r\n    * @return boolean\r\n    */\r\n    isOpen: function () {\r\n        var self = this;\r\n        var group = self.container;\r\n\r\n        return ($(\".childrenContainer\", group).is(\":visible\")) ? true : false;\r\n    },\r\n\r\n    /* Focus on container*/\r\n    focus: function () {\r\n        var self = this;\r\n\r\n        // Expand container\r\n        self.expand();\r\n\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /* \r\n    *   Expands group container \r\n    */\r\n    expand: function () {\r\n        var self = this;\r\n        var group = self.container;\r\n\r\n        if (!self.isOpen()) {\r\n            $(\"h1\", group).trigger(\"click\");\r\n        }\r\n    },\r\n\r\n    /* \r\n    *   Collapses group container \r\n    */\r\n    collapse: function () {\r\n        var self = this;\r\n        var group = self.container;\r\n\r\n        if (self.isOpen()) {\r\n            $(\"h1\", group).trigger(\"click\");\r\n        }\r\n    },\r\n\r\n    /* \r\n    *   Expands or collapse the container \r\n    */\r\n    toogleContainer: function (argument) {\r\n        var self = this;\r\n\r\n        if (argument) {\r\n            self.expand();\r\n        } else {\r\n            self.collapse();\r\n        }\r\n    },\r\n\r\n    subscribeOnTouch: function () {\r\n        var self = this;\r\n        var group = self.container;\r\n\r\n        // Delegate event click\r\n        $(group).find(\">div.headertitle\").bind(\"click\", function () {\r\n            $(group).toggleClass(\"collapsed\");\r\n        });\r\n    }\r\n});","/*\r\n*   Name: BizAgi Tablet Search Form Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the container class to adjust to tablet devices\r\n*/\r\n\r\n// Auto extend\r\nbizagi.rendering.searchForm.extend(\"bizagi.rendering.searchForm\", {}, {\r\n    /*\r\n    *   Render the results of the query\r\n    *   Resolved in each device\r\n    */\r\n    renderResult: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Creates grid definition\r\n        var data = {};\r\n        data.properties = {\r\n            displayName: self.getResource(\"render-search-advanced-results-label\"),\r\n            type: \"grid\",\r\n            xpath: \"searchForm\" + properties.id,\r\n            id: properties.id,\r\n            skipInitialLoad: true,\r\n            rowsPerPage: 10,\r\n            visible: false,\r\n            sortBy: properties.sortBy,\r\n            sortOrder: properties.sortOrder,\r\n            overrideGetRemoteData: function(params) {\r\n                return self.getRemoteData(params);\r\n            }\r\n        };\r\n\r\n        data.elements = [];\r\n\r\n        // Creates columns\r\n        var columns = properties.columns;\r\n        $.each(columns, function(i) {\r\n            var column = {\r\n                render: {}\r\n            };\r\n\r\n            column.render.properties = {\r\n                displayName: columns[i].caption,\r\n                xpath: columns[i].xpath,\r\n                editable: false\r\n            };\r\n\r\n            $.extend(column.render.properties, self.parseAdditionalProperties(columns[i].dataType));\r\n\r\n            // Next conditional added to print only columns and not labels\r\n            // if type = label then column is not rendered on the results table\r\n            if (columns[i].dataType == 0)\r\n                column.render.properties.columnVisible = false;\r\n\r\n            // if column is number or monetary push allowDecimals property\r\n            if (columns[i].dataType == 7 || columns[i].dataType == 8)\r\n                column.render.properties.allowDecimals = columns[i].allowDecimals;\r\n\r\n            // if column is real or float set allowDecimals property to true\r\n            if (columns[i].dataType == 10 || columns[i].dataType == 11)\r\n                column.render.properties.allowDecimals = true;          \r\n\r\n            // if column is date push showtime property\r\n            if (columns[i].dataType == 12)\r\n                column.render.properties.showTime = columns[i].showTime;\r\n\r\n            data.elements.push(column);\r\n        });\r\n\r\n        var grid = self.renderFactory.getRender({\r\n            type: \"grid\",\r\n            data: data,\r\n            parent: self,\r\n            mode: self.getMode()\r\n        });\r\n\r\n        grid.properties.inlineAdd = false;\r\n        grid.properties.allowDelete = false;\r\n        grid.properties.allowAdd = false;\r\n        grid.properties.allowEdit = false;\r\n\r\n        // Saves reference\r\n        self.resultsGrid = grid;\r\n\r\n        return grid.render();\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each container after processed\r\n    */\r\n    postRenderContainer: function (container) {\r\n        var self = this;        \r\n        var searchCriteria = container.find(\".ui-bizagi-container-search-criteria\");\r\n        var results = container.find(\".ui-bizagi-container-search-results\");\r\n        var childrenElements = searchCriteria.children();\r\n        var mode = self.getMode();\r\n\r\n        // Process children elements\r\n        self.container = container;\r\n        $.each(childrenElements, function (i, childElement) {\r\n            childElement = $(childElement);\r\n            var id = Number(childElement.data(\"unique-id\"));\r\n            if (id) {\r\n                var child = self.childrenHash[id];\r\n                if (child) {\r\n                    var type = child.getElementType();\r\n                    if (type == bizagi.rendering.element.ELEMENT_TYPE_RENDER) child.postRenderElement(childElement);\r\n                    if (type == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) child.postRenderContainer(childElement);\r\n                }\r\n            }\r\n        });\r\n\r\n        // Process result\r\n        var grid = $(results.children()[0]);\r\n        self.resultsGrid.postRenderElement(grid);\r\n\r\n        if (mode == \"execution\") {\r\n            // Apply handlers\r\n            self.configureHandlers();\r\n        }\r\n        if (mode == \"design\") {\r\n            // Configure view\r\n            self.configureDesignView();\r\n        }\r\n        if (mode == \"layout\") {\r\n            // Configure view\r\n            self.configureDesignView();\r\n            self.configureLayoutView();\r\n        }\r\n\r\n    },\r\n\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the container's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        // Saves reference\r\n        self.criteriaContainer = $(\".ui-bizagi-container-search-criteria\", self.container);\r\n        self.resultsContainer = $(\".ui-bizagi-container-search-results\", self.container);\r\n\r\n        // Bind to grid row select event\r\n        self.resultsGrid.bind(\"rowSelected\", function (e, ui) {\r\n            if (self.properties.searchParams.hasOwnProperty(\"multiSelect\")) {\r\n                self.trigger(\"multiSelect\", ui);\r\n            } else {\r\n                // Trigger event to bubble up to main container\r\n                self.trigger(\"instanceSelected\", ui);\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Refresh the result panel, making it to query data with current criteria\r\n    */\r\n    refreshResults: function () {\r\n        var self = this;\r\n\r\n        self.trigger(\"instancerefresh\");\r\n        self.resultsGrid.refresh();\r\n    },\r\n\r\n    /*\r\n    * Method added for IPAD version. Before showing search results form\r\n    */\r\n    onSearchFinished: function() {\r\n        var self = this;\r\n\r\n        if (!self.properties.deviceMaxRecordsExceeded) {\r\n\r\n            // Next line returns visibility with the results of the search\r\n            self.resultsGrid.changeVisibility(true);\r\n\r\n            if (self.properties)\r\n                if (self.properties.records == 0) {\r\n                    $(\".ui-bizagi-container-search-results .ui-bizagi-label\", self.container).hide();\r\n                } else {\r\n                    $(\".ui-bizagi-container-search-results .ui-bizagi-label\", self.container).show();\r\n                }\r\n        }\r\n    }\r\n\r\n});\r\n","/**\r\n * Device definition of Polymorphic launcher\r\n *\r\n * @author: Ricardo Perez\r\n */\r\n\r\nbizagi.rendering.polymorphicLauncher.extend(\"bizagi.rendering.polymorphicLauncher\", {}, {\r\n\t/**\r\n\t * Render a specific implementation for Tablet device\r\n\t */\r\n\tpostRender: function() {\r\n\t\tvar self = this;\r\n\t\tvar properties = self.properties;\r\n\t\tvar mode = self.getMode();\r\n\t\tvar html, template;\r\n\r\n\t\tif(mode == \"design\" || !self.properties.surrogatedKey) {\r\n\t\t\treturn \"\";\r\n\t\t}\r\n\r\n\t\tself.configureQueueVisibility();\r\n\r\n\t\t/**\r\n\t\t * Define params to get list of actions\r\n\t\t */\r\n\t\treturn $.when(self.dataService.multiaction().getPolymorphicActions(self.processPropertyValueArgs)).done(function(response) {\r\n\t\t\t// Convert default response to tree data structure\r\n\t\t\tresponse = self.dataService.serializePolymorphicActions(response);\r\n\t\t\tself.totalActions = bizagi.clone(response);\r\n\t\t\tvar actions = bizagi.clone(response);\r\n\t\t\tself.lessActions = bizagi.clone(actions);\r\n\r\n\t\t\t// NOTE: Code extracted\r\n\t\t\tvar templateArguments = {\r\n\t\t\t\tactions: actions,\r\n\t\t\t\tallowSearch: properties.allowSearch,\r\n\t\t\t\ttreeActionsList: self.getTreeItems(actions)\r\n\t\t\t};\r\n\t\t\ttemplate = self.renderFactory.getTemplate(\"render-polymorphicLauncher-vertical-tree\");\r\n\r\n\t\t\tvar control = self.getControl();\r\n\t\t\tvar actionsContainer = $(\".bz-polymorphic-launcher-constructors-container\", control);\r\n\t\t\tactionsContainer.append($.kendoTmpl(template, templateArguments));\r\n\t\t\tself.bindHandlers();\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Get rendered html of each node of constructors\r\n\t * @param actions\r\n\t * @param level\r\n\t * @return {string}\r\n\t */\r\n\tgetTreeItems: function(actions, level) {\r\n\t\tvar self = this;\r\n\t\tvar item = \"<ul>\";\r\n\t\tvar templateTreeItem = self.renderFactory.getTemplate(\"render-polymorphicLauncher-vertical-tree-item\");\r\n\t\tactions = actions || {};\r\n\t\tlevel = level || 1;\r\n\r\n\t\t$.each(actions, function(key, value) {\r\n\t\t\titem += $.kendoTmpl(templateTreeItem, value);\r\n\r\n\t\t\tif(value.children) {\r\n\t\t\t\titem += self.getTreeItems(value.children, level + 1);\r\n\t\t\t}\r\n\t\t});\r\n        item += \"</ul>\";\r\n        return item;\r\n\t},\r\n\r\n\t/**\r\n\t * Add binding to html elements\r\n\t */\r\n\tbindHandlers: function() {\r\n\t\tvar self = this;\r\n\t\tvar control = self.getControl();\r\n        var actionLauncherControls = $(\".bz-polymorphic-launcher-constructors-container li span\", control);\r\n\r\n\t\t//Binding for click action on buttons\r\n\t\tactionLauncherControls.on(\"click\", function() {\r\n\t\t\tvar $targetData = $(this).parent();\r\n\t\t\tvar action = {\r\n\t\t\t\tguidEntity: $targetData.data(\"guidentity\"),\r\n\t\t\t\tguidObject: $targetData.data(\"guidobject\"),\r\n\t\t\t\tguidConstructor: $targetData.data(\"guidconstructor\"),\r\n\t\t\t\tdisplayName: $targetData.data(\"display-name\"),\r\n\t\t\t\tactionType: $targetData.data(\"action-type\"),\r\n\t\t\t\txpathContext: $targetData.data(\"xpathcontext\")\r\n\t\t\t};\r\n\t\t\tself.onActionClicked(action);\r\n\t\t});\r\n\t\t//Catch the typed text in the search field and filter the action list\r\n\t\t$.expr[\":\"].FilterAction = function(entity, i, array) {\r\n\t\t\tvar search = array[3];\r\n\t\t\tif(!search) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\treturn new RegExp(search, \"i\").test($(entity).text());\r\n\t\t};\r\n        $(\"input#ui-bizagi-render-action-launcher-filter-input\", control).keyup(function() {\r\n            var search = $(this).val();\r\n            $(\".bz-polymorphic-launcher-constructors-container li\", control).show();\r\n            if(search) {\r\n                $(\".bz-polymorphic-launcher-constructors-container li\", control).not(\":FilterAction(\" + search + \")\").hide();\r\n            }\r\n        });\r\n\r\n\t},\r\n\t/**\r\n\t * Execute an Action\r\n\t * @param action\r\n\t */\r\n\tonActionClicked: function(action) {\r\n\t\tvar self = this;\r\n\r\n\t\t$.when(self.actionManager(action)).done(function(act) {\r\n\t\t\tself.executeAction(act);\r\n\t\t});\r\n\t},\r\n\t/**\r\n\t * Show a message when action has been executed\r\n\t * @param status\r\n\t * @param action\r\n\t */\r\n\tnotifyExecution: function(status, action) {\r\n\t\tvar self = this;\r\n\t\tif(status == \"success\"){\r\n\t\t\t$.notifier.add({\r\n                class_name: \"success\",\r\n                title: action.displayName,\r\n                text: self.getResource(\"render-action-launcher-success-excecution\").replace('%s',  action.displayName),\r\n                sticky: false\r\n            });\r\n\r\n\t\t}else{\r\n\t\t\t$.notifier.add({\r\n                class_name: \"error\",\r\n                title: action.displayName,\r\n                text: self.getResource(\"render-action-launcher-failed-excecution\").replace('%s',  action.displayName),\r\n                sticky: false\r\n            });\r\n\t\t}\r\n\t},\r\n\t/**\r\n\t * Show a dialog with a form\r\n\t * @param action\r\n\t * @return {*}\r\n\t */\r\n\tprocessActionForm: function(action) {\r\n\t\tvar self = this;\r\n\t\tvar properties = self.properties;\r\n\t\tvar form = self.getFormContainer();\r\n\t\tvar additionalXpaths = self.properties.additionalXpath.join(\",\");\r\n\t\tvar def = new $.Deferred();\r\n\t\tvar xpathContext = action.xpathContext || \"\";\r\n\t\tvar formParams = form.getParams();\r\n\r\n        var recordXpath = self.properties.recordXpath;\r\n\r\n\t\t// Show dialog with new form after that\r\n        var slideForm = new bizagi.rendering.tablet.slide.form(self.dataService, self.renderFactory,{\r\n\t\t\ttitle: properties.detailLabel || bizagi.localization.getResource(\"render-grid-details-form\"),\r\n\t\t\tnavigation: formParams.navigation,\r\n\t\t\tshowSaveButton: true,\r\n\t\t\tcancelButtonLabel: bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n\t\t\tonSave: function(data) {\r\n\t\t\t\tvar pageCache = data.idPageCache;\r\n\t\t\t\tdata.idPageCache = null;\r\n\t\t\t\t// Submit the form\r\n\t\t\t\treturn self.dataService.multiaction().submitData({\r\n\t\t\t\t\taction: \"SAVE\",\r\n\t\t\t\t\tdata: data,\r\n                    xpathContext: slideForm.form.properties.xpathContext, //self.properties.xpathContext,\r\n\t\t\t\t\tidPageCache: pageCache,\r\n\t\t\t\t\tisOfflineForm: false,\r\n\t\t\t\t\tisActionStartForm: true\r\n\t\t\t\t}).done(function(savedData) {\r\n\t\t\t\t\tif(!action.editMode && self.countSameActions(action) == 0) {\r\n\t\t\t\t\t\taction.idStartScope = savedData.IdScope;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdef.resolve(savedData.IdScope);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tonCancel: function(data) {\r\n\r\n\t\t\t}\r\n\t\t});\r\n\r\n        slideForm.render({\r\n\t\t\t\"idForm\": action.guidObject,\r\n\t\t\t\"contextType\": \"entity\",\r\n\t\t\t\"guidEntity\": action.guidEntity,\r\n\t\t\t\"idCase\": self.properties.caseId,\r\n\t\t\t\"idWorkitem\": self.typeForm != \"SummaryForm\" ? formParams.idWorkitem : undefined,\r\n\t\t\t\"additionalXpaths\": additionalXpaths,\r\n\t\t\t//\"xpathContext\": xpathContext,\r\n\t\t\t\"idStartScope\": action.idStartScope,\r\n\t\t\t\"surrogateKey\": self.properties.surrogatedKey,\r\n            \"recordXpath\": recordXpath\r\n\t\t});\r\n\r\n\t\treturn def.promise();\r\n\t},\r\n\r\n\t/**\r\n\t * Process a start form\r\n\t * @param args\r\n\t * @return {*}\r\n\t */\r\n\tprocessStartForm: function(args) {\r\n\t\tvar self = this;\r\n\t\tvar properties = self.properties;\r\n\t\tvar form = self.getFormContainer();\r\n\t\tvar def = new $.Deferred();\r\n\t\tvar formParams = form.getParams();\r\n\t\targs = args || {};\r\n\r\n\r\n        var slideForm = new bizagi.rendering.tablet.startForm(self.dataService, self.renderFactory,{\r\n\t\t\t//showSaveButton: properties.editable,\r\n\t\t\tmaximized: properties.maximized,\r\n\t\t\ttitle: args.title || \"\",\r\n\t\t\tnavigation: formParams.navigation,\r\n\t\t\tsaveButtonLabel: (self.typeForm == \"GlobalForm\" || this.typeForm == \"SummaryForm\") ? bizagi.localization.getResource(\"render-form-button-create\") : bizagi.localization.getResource(\"render-form-dialog-box-save\"),\r\n\t\t\tonSave: function(data) {\r\n\t\t\t\tform.startLoading();\r\n\r\n\t\t\t\t// Submit the form\r\n\t\t\t\treturn self.dataService.multiaction().submitData({\r\n\t\t\t\t\taction: \"SAVE\",\r\n\t\t\t\t\tdata: data,\r\n\t\t\t\t\txpathContext: self.properties.xpathContext,\r\n\t\t\t\t\tidPageCache: data.idPageCache,\r\n\t\t\t\t\tisOfflineForm: false,\r\n\t\t\t\t\tisActionStartForm: true\r\n\t\t\t\t}).done(function(savedData) {\r\n\t\t\t\t\tform.endLoading();\r\n\t\t\t\t\tdef.resolve(savedData.IdScope);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\r\n        slideForm.render({\r\n\t\t\tguidprocess: args.guidprocess,\r\n\t\t\tidStartScope: args.idStartScope,\r\n\t\t\tidCase: self.properties.caseId,\r\n            idWorkitem: self.typeForm != \"SummaryForm\" ? formParams.idWorkitem : undefined,\r\n\t\t\tadditionalXpaths: self.properties.additionalXpath.join(\",\"),\r\n\t\t\tsurrogatedKey: self.properties.surrogatedKey,\r\n            recordXpath: args.recordXpath,\r\n            mappingstakeholders: true\r\n\t\t});\r\n\r\n\t\treturn def.promise();\r\n\t},\r\n\t/**\r\n\t * Execute and action if a form is global form or summary, or send to queue\r\n\t * @param action\r\n\t */\r\n\texecuteAction: function(action) {\r\n\t    var self = this;\r\n\r\n\t    if (self.typeForm == \"GlobalForm\" || self.typeForm == \"SummaryForm\") {\r\n\t        var message = bizagi.localization.getResource(\"render-action-launcher-immediatly-action-confirmation\");\r\n\r\n\t        $.when(bizagi.showConfirmationBox(message, \"Bizagi\", \"info\"))\r\n\t            .done(function() {\r\n\t                self.executeActionImmediately(action);\r\n\t            });\r\n\t    } else {\r\n\t        self.addActionToQueue(action);\r\n\t    }\r\n\t},\r\n\r\n    /**\r\n     * Show confirmation dialog\r\n     * @param action\r\n     */\r\n    showConfirmationDialog: function(action) {\r\n\t    var self = this;\r\n\t    var message = bizagi.localization.getResource(\"render-action-launcher-single-action-confirmation\");\r\n\r\n\t    $.when(bizagi.showConfirmationBox(message, \"Bizagi\", \"info\"))\r\n\t        .done(function() {\r\n\t            self.setValue([]);\r\n\r\n\t            $.when(self.actionManager(action))\r\n\t                .done(function(act) {\r\n\t                    self.executeAction(act);\r\n\t                });\r\n\t        });\r\n\t},\r\n\r\n\t/**\r\n\t * Render actual value of control and set events\r\n\t * @param data\r\n\t */\r\n\tsetDisplayValue: function(data) {\r\n\t\tvar self = this;\r\n\t\tvar control = self.getControl();\r\n        var actionsToExecuteContainer = $(\".bz-polymorphic-launcher-constructors-to-execute-container\", control);\r\n\t\tvar template = self.renderFactory.getTemplate(\"render-polymorphicLauncher-actions-to-execute\");\r\n\t\tself.configureQueueVisibility();\r\n\r\n\t\t$.when($.kendoTmpl(template, {actions: data})).done(function(html) {\r\n\t\t\tactionsToExecuteContainer.empty();\r\n\t\t\tactionsToExecuteContainer.append(html);\r\n                var removeActionSelector = $(\".action-to-execute-control .delete-action\", actionsToExecuteContainer);\r\n                var openActionSelector = $(\".action-to-execute-control label\", actionsToExecuteContainer);\r\n                removeActionSelector.on(\"click\", function() {\r\n\t\t\t\tvar index = $(this).parent().data(\"index\");\r\n\t\t\t\tself.removeActionToQueue(index);\r\n\t\t\t});\r\n\t\t\topenActionSelector.bind(\"click\", function() {\r\n\t\t\t\tvar $target = $(this).parent();\r\n\t\t\t\tvar type = $target.data(\"actiontype\");\r\n\t\t\t\tvar guidprocess = $target.data(\"guidprocess\");\r\n\t\t\t\tvar idStartScope = $target.data(\"idstartscope\");\r\n\t\t\t\tvar title = $target.data(\"title\");\r\n\t\t\t    var xpathContext = $target.data(\"xpathcontext\");\r\n\t\t\t\tvar idEntity = $target.data(\"identity\") || \"\";\r\n\t\t\t\tvar guidEntity = $target.data(\"guidentity\");\r\n                var recordXpath = xpathContext || self.properties.xpathContext;\r\n\r\n\t\t\t\tswitch(type) {\r\n\t\t\t\t\tcase \"Process\":\r\n\t\t\t\t\t\tif(idStartScope) {\r\n\t\t\t\t\t\t\tself.processStartForm({\r\n\t\t\t\t\t\t\t\tguidprocess: guidprocess,\r\n\t\t\t\t\t\t\t\tidStartScope: idStartScope,\r\n\t\t\t\t\t\t\t\ttitle: title,\r\n\t\t\t\t\t\t\t\txpathContext: xpathContext,\r\n                                recordXpath: recordXpath\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Form\":\r\n\t\t\t\t\t\tvar action = {\r\n\t\t\t\t\t\t\tguidProcess: guidprocess,\r\n\t\t\t\t\t\t\tidStartScope: idStartScope,\r\n\t\t\t\t\t\t\teditMode: true,\r\n\t\t\t\t\t\t\txpathContext: xpathContext,\r\n\t\t\t\t\t\t\tidEntity: idEntity,\r\n\t\t\t\t\t\t\tguidEntity: guidEntity,\r\n\t\t\t\t\t\t\tguidObject: guidprocess\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\tself.processActionForm(action);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Rule\":\r\n\t\t\t\t\t\t// Rules dont have forms or something like that\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t},\r\n\t/**\r\n\t * Show container if it has actions\r\n\t */\r\n\tconfigureQueueVisibility: function() {\r\n\t\tvar self = this;\r\n\t\tvar control = self.getControl();\r\n        var actionsToExecuteContainer = $(\".bz-polymorphic-launcher-constructors-to-execute-container\", control);\r\n\t\tvar actionsToExecuteTitle = $(\".actions-to-execute-title\", control);\r\n\t\tif(self.getValue().length > 0) {\r\n\t\t\tactionsToExecuteContainer.show();\r\n\t\t\tactionsToExecuteTitle.show();\r\n\t\t} else {\r\n\t\t\tactionsToExecuteContainer.hide();\r\n\t\t\tactionsToExecuteTitle.hide();\r\n\t\t}\r\n\t}\r\n});","/**\r\n * Tablet definition of Action Launcher\r\n *\r\n * @author: Ricardo Pérez\r\n */\r\n\r\nbizagi.rendering.actionLauncher.extend(\"bizagi.rendering.actionLauncher\", {}, {\r\n    /**\r\n     * Render a specific implementation for Desktop device\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template;\r\n        var def = new $.Deferred();\r\n        self.actions = [];\r\n\r\n        self.configureQueueVisibility();\r\n\r\n        self.startLoading();\r\n\r\n        // Define params to get list of actions        \r\n        $.when(self.dataService.multiaction().getActions(self.processPropertyValueArgs))\r\n            .then(function (response) {\r\n                response = self.getPropertiesActionLaucher(response);\r\n                self.actions = response;\r\n                self.deferredActions.resolve(response);\r\n\r\n                if (properties.isHorizontal) {\r\n                    if (properties.templatetype !== \"none\") {\r\n                        return self.dataService.multiaction().getPropertyData(self.processPropertyValueDataTmplArgs)\r\n                            .then(function (templateData) {\r\n                                return self.engine.render($.extend(templateData, {\r\n                                    isDefaultTemplate: properties.templatetype === \"default\",\r\n                                    sessionId: self.properties.sessionId\r\n                                }), $.extend({}, self.processPropertyValueDataTmplArgs, {formParams: self.getFormParams(self.getFormContainer())}));\r\n                            }).then(function (tmpl) {\r\n                                template = self.renderFactory.getTemplate(\"render-actionLauncher-horizontal\");\r\n                                var html = $($.kendoTmpl(template, {\r\n                                    actions: self.actions,\r\n                                    template: true\r\n                                }));\r\n\r\n                                $(\".template-container\", html.wrap(\"<div>\").parent()).append(tmpl);\r\n                                return html;\r\n                            });\r\n                    } else {\r\n                        template = self.renderFactory.getTemplate(\"render-actionLauncher-horizontal\");\r\n                        return $.kendoTmpl(template, {\r\n                            actions: self.actions,\r\n                            maxItems: properties.maxItems\r\n                        });\r\n                    }\r\n                } else {\r\n                    template = self.renderFactory.getTemplate(\"render-actionLauncher-vertical\");\r\n                    return $.kendoTmpl(template, {\r\n                        actions: self.actions,\r\n                        allowSearch: properties.allowSearch,\r\n                        maxItems: properties.maxItems\r\n                    });\r\n                }\r\n\r\n            }).done(function (html) {\r\n                var control = self.getControl();\r\n                var actionsContainer = $(\".bz-action-launcher-actions-container\", control);\r\n\r\n                self.endLoading();\r\n\r\n                actionsContainer.append(html);\r\n                self.configureHandlers();\r\n                self.configureTemplateHandlers();\r\n\r\n                def.resolve(actionsContainer);\r\n            }).fail(function (error) {\r\n                self.endLoading();\r\n                def.fail(error);\r\n            });\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * \r\n    */\r\n    getFormParams: function (form) {\r\n        if (form.parent) {\r\n            return this.getFormParams(form.parent.getFormContainer());\r\n        }\r\n        else {\r\n            return form.getParams();\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n     * Add binding to html elements\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var multipleSelection = (typeof properties.multipleSelection == \"undefined\") ? true : properties\r\n            .multipleSelection;\r\n        var actionLauncherControls = $(\".action-launcher-control\", control);\r\n\r\n        //Binding for click action on buttons\r\n        actionLauncherControls.on(\"click\", function () {\r\n            var item = self.actions[parseInt($(this).data(\"index\"))];\r\n            var action = {\r\n                guidProcess: item[0],\r\n                guidAction: item[4],\r\n                displayName: item[1],\r\n                actionType: item[3],\r\n                xpathContext: (typeof item[5] !== \"undefined\" && item[5] === \"true\"),\r\n                readOnlyForm: item[6] || false,\r\n                guidEntity: self.properties.guidEntity,\r\n                xpathActions: self.properties.xpathActions || \"\"\r\n            };\r\n\r\n            if (multipleSelection) {\r\n                if (action.actionType == \"Form\" && self.countSameActions(action) >= 1 && !action.xpathContext) {\r\n                    //Open action\r\n                    $(\".action-to-execute-control[data-guidaction='\" + action.guidAction + \"'] label\", control).click();\r\n                } else {\r\n                    $.when(self.actionManager(action)).done(function (act) {\r\n                        self.executeAction(act);\r\n                    });\r\n                }\r\n            } else if (self.getValue().length > 0) {\r\n                self.showConfirmationDialog(action);\r\n            } else {\r\n                $.when(self.actionManager(action)).done(function (act) {\r\n                    self.executeAction(act);\r\n                });\r\n            }\r\n        });\r\n\r\n        // Catch the typed text in the search field and filter the action list\r\n        $.expr[\":\"].FilterAction = function (entity, i, array) {\r\n            var search = array[3];\r\n            if (!search) {\r\n                return false;\r\n            }\r\n            return new RegExp(search, \"i\").test($(entity).text());\r\n        };\r\n\r\n        var plusBtn = $(\".action-container .wp-action-more span\", control);\r\n\r\n        $(\".action-container .wp-action-more\", control).click(function () {\r\n            if (plusBtn.hasClass(\"km-minus\")) {\r\n                hideActions();\r\n            } else {\r\n                showActions();\r\n            }\r\n        });\r\n\r\n        function hideActions() {\r\n            plusBtn.addClass(\"km-plus\").removeClass(\"km-minus\");\r\n            $(\".action-container .bz-actions-to-hide\", control).addClass('hidden');\r\n        }\r\n\r\n        function showActions() {\r\n            plusBtn.addClass(\"km-minus\").removeClass(\"km-plus\");\r\n            $(\".action-container .bz-actions-to-hide\", control).removeClass('hidden');\r\n        }\r\n\r\n        $(\"input#ui-bizagi-render-action-launcher-filter-input\", control).keyup(function () {\r\n            var search = $(this).val();\r\n            $(\".ui-bizagi-render-actionLauncher-actions-list .action-launcher-control\", control).show();\r\n            if (search) {\r\n                if (plusBtn.hasClass(\"km-plus\")) {\r\n                    showActions();\r\n                }\r\n                $(\".ui-bizagi-render-actionLauncher-actions-list .action-launcher-control\", control)\r\n                    .not(\":FilterAction(\" + search + \")\").hide();\r\n            }\r\n        });\r\n    },\r\n    /**\r\n     *\r\n     */\r\n    configureTemplateHandlers: function () {\r\n        var self = this;\r\n\r\n        //Catch the event from the layout link\r\n        self.engine.subscribe(\"onLoadDataNavigation\", function (ev, params) {\r\n            params.filters = [];\r\n            params.calculateFilters = params.calculateFilters || true;\r\n            self.triggerGlobalHandler(\"dataNavigation\", params);\r\n        });\r\n    },\r\n    /**\r\n     *\r\n     * @param data\r\n     * @param action\r\n     */\r\n    notifyExecution: function (data, action) {\r\n        var self = this;\r\n\r\n        if (data.response == \"success\") {\r\n            $.notifier.add({\r\n                class_name: \"success\",\r\n                title: action.displayName,\r\n                text: self.getResource(\"render-action-launcher-success-excecution\").replace(\"%s\", action.displayName),\r\n                sticky: false\r\n            });\r\n        } else {\r\n            $.notifier.add({\r\n                class_name: \"error\",\r\n                title: action.displayName,\r\n                text: self.getResource(\"render-action-launcher-failed-excecution\").replace(\"%s\", action.displayName),\r\n                sticky: false\r\n            });\r\n        }\r\n    },\r\n    /**\r\n     *\r\n     * @param action\r\n     * @returns {*}\r\n     */\r\n    processActionForm: function (action) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var formParams = self.getParams();\r\n        var additionalXpaths = self.properties.additionalXpath.join(\",\");\r\n        var xpathContext = (action.xpathContext) ? self.properties.xpathActions + \".\" + action.xpathContext : self\r\n            .properties.xpathActions;\r\n        var def = new $.Deferred();\r\n\r\n        // Show dialog with new form after that\r\n        var slideForm = new bizagi.rendering.tablet.slide.form(self.dataService, self.renderFactory, {\r\n            title: properties.detailLabel || bizagi.localization.getResource(\"render-grid-details-form\"),\r\n            navigation: formParams.navigation,\r\n            showSaveButton: true,\r\n            cancelButtonLabel: bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n            onSave: function (data) {\r\n                // Submit the form\r\n                return self.dataService.multiaction().submitData({\r\n                    action: \"SAVE\",\r\n                    data: data,\r\n                    xpathContext: slideForm.form.properties.xpathContext,\r\n                    idPageCache: data.idPageCache,\r\n                    isOfflineForm: false,\r\n                    isActionStartForm: true\r\n                }).done(function (savedData) {\r\n                    if (!action.editMode && self.countSameActions(action) == 0) {\r\n                        action.idStartScope = savedData.IdScope;                        \r\n                    }\r\n                    def.resolve(savedData.IdScope);\r\n                });\r\n            },\r\n            onCancel: function (data) {\r\n\r\n            }\r\n        });\r\n\r\n        var renderParams = {\r\n            \"idForm\": action.guidProcess,\r\n            \"contextType\": \"start\",\r\n            \"idCase\": self.properties.caseId,\r\n            \"idWorkitem\": self.typeForm != \"SummaryForm\" ? formParams.idWorkitem : undefined,\r\n            \"additionalXpaths\": additionalXpaths,\r\n            \"xpathContext\": xpathContext,\r\n            \"idStartScope\": action.idStartScope,\r\n            \"surrogateKey\": self.properties.surrogatedKey,\r\n            \"readOnlyForm\": action.readOnlyForm,\r\n            \"recordXpath\": action.recordXpath\r\n        }\r\n\r\n        if (action.actionType === \"Form\") {\r\n            renderParams.contextType = \"entitytemplate\";\r\n            renderParams.xpathContext = undefined;\r\n            renderParams.guidEntity = action.guidEntity;\r\n            renderParams.rewriteContextType = true;\r\n        }\r\n\r\n        slideForm.render(renderParams);\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param action\r\n     * @returns {*}\r\n     */\r\n    processActionFormCollection: function (action) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var additionalXpaths = self.properties.additionalXpath.join(\",\");\r\n        var def = new $.Deferred();\r\n        var xpathContext = (action.xpathContext) ? self.properties.xpathActions + \".\" + action.xpathContext : self\r\n            .properties.xpathActions;\r\n        var xpathPattern = \"%s[id=%s]\";\r\n        var xpathPatternWithoutkey = \"%s[]\";\r\n        var xpathContextWithKey = (xpathContext !== \"\") ? printf(xpathPattern, xpathContext, action.idEntity)\r\n            : xpathContext;\r\n        var xpathContextWithoutKey = (xpathContext !== \"\") ? printf(xpathPatternWithoutkey, xpathContext)\r\n            : xpathContext;\r\n        var formParams = form.getParams();\r\n\r\n        var slideForm = new bizagi.rendering.tablet.slide.form(self.dataService, self.renderFactory, {\r\n            title: properties.detailLabel || bizagi.localization.getResource(\"render-grid-details-form\"),\r\n            navigation: formParams.navigation,\r\n            showSaveButton: true,\r\n            cancelButtonLabel: bizagi.localization.getResource(\"render-form-dialog-box-close\"),\r\n            onSave: function (data) {\r\n                if (action.editMode) {\r\n                    return self.dataService.multiaction().submitData({\r\n                        action: \"SAVE\",\r\n                        data: data,\r\n                        xpathContext: xpathContextWithKey,\r\n                        idPageCache: data.idPageCache,\r\n                        isOfflineForm: false,\r\n                        isActionStartForm: true\r\n                    }).done(function (savedData) {\r\n                        def.resolve(savedData.IdScope);\r\n                    });\r\n                } else {\r\n                    return self.dataService.addGridRecordData({\r\n                        idRender: properties.id,\r\n                        //xpath: properties.xpath,\r\n                        xpathContext: xpathContext,\r\n                        contexttype: \"start\",\r\n                        idPageCache: data.idPageCache,\r\n                        submitData: data\r\n                    }).done(function (savedData) {\r\n                        action.idStartScope = savedData.IdScope;\r\n                        action.idEntity = savedData.IdEntity;\r\n                        self.addActionToQueue(action);\r\n                        def.resolve(savedData.IdScope);\r\n                    });\r\n                }\r\n            },\r\n            onCancel: function (data) {\r\n\r\n            }\r\n        });\r\n\r\n        slideForm.render({\r\n            \"idForm\": action.guidProcess,\r\n            \"contextType\": \"start\",\r\n            \"idCase\": formParams.idCase,\r\n            \"additionalXpaths\": additionalXpaths,\r\n            \"xpathContext\": (action.editMode) ? xpathContextWithKey : xpathContextWithoutKey,\r\n            \"idStartScope\": action.idStartScope,\r\n            \"surrogateKey\": self.properties.surrogatedKey,\r\n            \"readOnlyForm\": action.readOnlyForm,\r\n            \"recordXpath\": action.recordXpath\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n    /**\r\n     * Process a start form\r\n     * @param args\r\n     * @return {*}\r\n     */\r\n    processStartForm: function (args) {\r\n        var self = this;\r\n        var def = new $.Deferred();\r\n        args = args || {};\r\n        var formParams = self.getFormContainer().getParams();\r\n\r\n        // Show dialog\r\n        var slideForm = new bizagi.rendering.tablet.startForm(self.dataService, self.renderFactory, {\r\n            title: args.title || \"\",\r\n            navigation: formParams.navigation,\r\n            saveButtonLabel: (self.typeForm == \"GlobalForm\" || self.typeForm === \"SummaryForm\") ? bizagi.localization.getResource(\"render-form-button-create\")\r\n                : bizagi.localization.getResource(\"render-form-dialog-box-save\"),\r\n            onSave: function (data) {\r\n                // Submit the form\r\n                return self.dataService.multiaction().submitData({\r\n                    action: \"SAVE\",\r\n                    data: data,\r\n                    xpathContext: self.properties.xpathContext,\r\n                    idPageCache: data.idPageCache,\r\n                    isOfflineForm: false,\r\n                    isActionStartForm: true\r\n                }).done(function (savedData) {\r\n                    def.resolve(savedData.IdScope);\r\n                });\r\n            }\r\n        });\r\n\r\n        // Render the search form\r\n        slideForm.render({\r\n            guidprocess: args.guidprocess,\r\n            idStartScope: args.idStartScope,\r\n            idCase: self.properties.caseId,\r\n            idWorkitem: self.typeForm != \"SummaryForm\" ? formParams.idWorkitem : undefined,\r\n            additionalXpaths: self.properties.additionalXpath.join(\",\"),\r\n            surrogatedKey: self.properties.surrogatedKey,\r\n            recordXpath: args.recordXpath,\r\n            mappingstakeholders: true\r\n        });\r\n\r\n        return def.promise();\r\n    },\r\n    /**\r\n     *\r\n     * @param action\r\n     */\r\n    executeAction: function (action) {\r\n        var self = this;\r\n\r\n        if (self.typeForm == \"GlobalForm\" || self.typeForm == \"SummaryForm\") {\r\n            var message = bizagi.localization.getResource(\"render-action-launcher-immediatly-action-confirmation\");\r\n\r\n            $.when(bizagi.showConfirmationBox(message, \"Bizagi\", \"info\"))\r\n                .done(function () {\r\n                    self.executeActionImmediately(action);\r\n                });\r\n        } else {\r\n            self.addActionToQueue(action);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Show the confirmation dialog\r\n     * bizagi.createOkCancelPopup\r\n     * @param action\r\n     * */\r\n    showConfirmationDialog: function (action) {\r\n        var self = this;\r\n        var message = bizagi.localization.getResource(\"render-action-launcher-single-action-confirmation\");\r\n\r\n        $.when(bizagi.showConfirmationBox(message, \"Bizagi\", \"info\"))\r\n            .done(function () {\r\n                self.setValue([]);\r\n\r\n                $.when(self.actionManager(action)).done(function (act) {\r\n                    self.executeAction(act);\r\n                });\r\n            });\r\n    },\r\n\r\n    /**\r\n     * Render actual value of control and set events\r\n     * @param data\r\n     */\r\n    setDisplayValue: function (data) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var actionsToExecuteContainer = $(\".bz-action-launcher-actions-to-execute-container\", control);\r\n        var template = self.renderFactory.getTemplate(\"render-actionLauncher-actions-to-execute\");\r\n\r\n        self.configureQueueVisibility();\r\n        $.when(self.deferredActions).done(function (listOfActions) {\r\n            var getMappingAction = function (guidAction) {\r\n                var mapping = [];\r\n                $.each(listOfActions, function (key, value) {\r\n                    if (value[4] == guidAction) {\r\n                        mapping = value;\r\n                    }\r\n                });\r\n                return mapping;\r\n\r\n            };\r\n            $.each(data, function (key, value) {\r\n                var mapping = getMappingAction(value.guidAction);\r\n                data[key].displayName = mapping[1];\r\n                data[key].guidProcess = mapping[0];\r\n                data[key].actionType = mapping[3];\r\n                data[key].xpathContext = mapping[5];\r\n                data[key].readOnlyForm = mapping[6];\r\n\r\n                if (data[key].params && data[key].params.idStartScope) {\r\n                    data[key].idStartScope = data[key].params.idStartScope;\r\n                }\r\n                if (data[key].params && data[key].params.idPageCache) {\r\n                    data[key].idPageCache = data[key].params.idPageCache;\r\n                }\r\n                if (data[key].params && data[key].params.idEntity) {\r\n                    data[key].idEntity = data[key].params.idEntity;\r\n                }\r\n            });\r\n            $.when($.kendoTmpl(template, { actions: data })).done(function (html) {\r\n                actionsToExecuteContainer.empty();\r\n                actionsToExecuteContainer.append(html);\r\n                var removeActionSelector = $(\".action-to-execute-control .delete-action\", actionsToExecuteContainer);\r\n                var openActionSelector = $(\".action-to-execute-control label\", actionsToExecuteContainer);\r\n\r\n                removeActionSelector.on(\"click\", function () {\r\n                    var index = $(this).parent().data(\"index\");\r\n                    self.removeActionToQueue(index);\r\n                });\r\n\r\n                openActionSelector.on(\"click\", function () {\r\n                    var target = $(this).parent();\r\n                    var type = target.data(\"actiontype\");\r\n                    var guidprocess = target.data(\"guidprocess\");\r\n                    var idStartScope = target.data(\"idstartscope\");\r\n                    var title = target.data(\"title\");\r\n                    // When undefined return string \"undefined\" instead of type \"undefined\"\r\n                    var xpathContext = target.data(\"xpathcontext\");\r\n                    var readOnlyForm = target.data(\"readonlyform\") || false;\r\n                    var idEntity = target.data(\"identity\") || \"\";\r\n                    var guidAction = target.data(\"guidaction\");\r\n                    var recordXpath = xpathContext || self.properties.xpathContext;\r\n\r\n                    switch (type) {\r\n                        case \"Process\":\r\n                            if (idStartScope) {\r\n                                self.processStartForm({\r\n                                    guidprocess: guidprocess,\r\n                                    idStartScope: idStartScope,\r\n                                    title: title,\r\n                                    xpathContext: xpathContext,\r\n                                    recordXpath: recordXpath\r\n                                });\r\n                            }\r\n                            break;\r\n                        case \"Form\":\r\n                            var action = {\r\n                                guidProcess: guidprocess,\r\n                                idStartScope: idStartScope,\r\n                                editMode: true,\r\n                                xpathContext: xpathContext,\r\n                                readOnlyForm: readOnlyForm,\r\n                                idEntity: idEntity,\r\n                                recordXpath: recordXpath\r\n                            };\r\n\r\n                            if (action.xpathContext) {\r\n                                self.processActionFormCollection(action);\r\n\r\n                            } else {\r\n                                // Convert string \"undefined\" into type \"undefined\"                                \r\n                                action.xpathContext = undefined;\r\n\r\n                                // Add parameters if action form\r\n                                var extraParams = {};\r\n                                var dataAction = self.value.filter(function (item) {\r\n                                    return item.guidAction == guidAction;\r\n                                });\r\n\r\n                                if (dataAction.length > 0) {\r\n                                    extraParams = {\r\n                                        actionType: \"Form\",\r\n                                        contextType: \"entitytemplate\",\r\n                                        guidEntity: self.properties.guidEntity || dataAction[0].guidEntity\r\n                                    };\r\n                                }\r\n\r\n                                self.processActionForm($.extend(action, extraParams));\r\n                            }\r\n                            break;\r\n                        case \"Rule\":\r\n                            // Rules dont have forms or something like that\r\n                            break;\r\n                    }\r\n                });\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Show container if it has actions\r\n     */\r\n    configureQueueVisibility: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var actionsToExecuteContainer = $(\".bz-action-launcher-actions-to-execute-container\", control);\r\n        var actionsToExecuteTitle = $(\".action-to-execute-label\", control);\r\n\r\n        if (self.getValue().length > 0) {\r\n            actionsToExecuteContainer.show();\r\n            actionsToExecuteTitle.show();\r\n        } else {\r\n            actionsToExecuteContainer.hide();\r\n            actionsToExecuteTitle.hide();\r\n        }\r\n    }\r\n});\r\n","/**\r\n * Tablet definition of entity template\r\n *\r\n * @author: Ricardo Pérez\r\n */\r\n\r\nbizagi.rendering.actionLauncher.extend(\"bizagi.rendering.entityTemplate\", {}, {\r\n\r\n    /**\r\n     * Render a specific implementation for Desktop device\r\n     */\r\n    postRender: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var def = new $.Deferred();\r\n\r\n        self.actions = [];\r\n\r\n        self.configureQueueVisibility();\r\n\r\n        /**\r\n         * Define params to get template\r\n         */\r\n        self.startLoading();\r\n        self.dataService.multiaction().getPropertyData(self.processPropertyValueDataTmplArgs)\r\n            .then(function(templateData) {\r\n                return self.engine.render(templateData, self.processPropertyValueDataTmplArgs)\r\n                    .then(function(tmpl) {\r\n                        var template = self.renderFactory.getTemplate(\"render-actionLauncher-horizontal\");\r\n                        if (properties.allowactions) {\r\n                            return self.dataService.multiaction().getActions(self.processPropertyValueArgs)\r\n                                .then(function(response) {\r\n                                    self.deferredActions.resolve(response);\r\n                                    self.actions = response;\r\n                                    var htmlTemplate = $($.kendoTmpl(template, {\r\n                                        actions: self.actions,\r\n                                        template: true\r\n                                    }));\r\n                                    $(\".template-container\", htmlTemplate.wrap('<div>').parent()).append(tmpl);\r\n                                    return htmlTemplate;\r\n                                });\r\n                        } else {\r\n                            var htmlTemplate = $($.kendoTmpl(template, { template: true }));\r\n                            $(\".template-container\", htmlTemplate.wrap('<div>').parent()).append(tmpl);\r\n                            return htmlTemplate;\r\n                        }\r\n                    });\r\n\r\n            }).done(function(html) {\r\n                var control = self.getControl();\r\n                var actionsContainer = $(\".bz-action-launcher-actions-container\", control);\r\n\r\n                self.endLoading();\r\n\r\n                actionsContainer.append(html);\r\n                self.configureHandlers();\r\n                self.configureTemplateHandlers();\r\n\r\n                def.resolve(actionsContainer);\r\n            }).fail(function(error) {\r\n                self.endLoading();\r\n                def.fail(error);\r\n            });\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n     * Add binding to html elements\r\n     */\r\n    configureHandlers: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var entityTemplateControls = $(\".action-launcher-control\", control);\r\n\r\n        /**\r\n         * Binding for click action on buttons\r\n         */\r\n        entityTemplateControls.on(\"click\", function() {\r\n            var item = self.actions[parseInt($(this).data(\"index\"))];\r\n            var action = {\r\n                guidProcess: item[0],\r\n                guidAction: item[4],\r\n                displayName: item[1],\r\n                actionType: item[3],\r\n                xpathContext: (typeof item[5] !== \"undefined\" && item[5] === \"true\"),\r\n                xpathActions: self.properties.xpathActions || \"\"\r\n            };\r\n\r\n            if (action.actionType === \"Form\") {\r\n                action.xpathContext = undefined;\r\n                action.contextType = \"entitytemplate\";\r\n                action.guidEntity = self.properties.guidEntity;\r\n            }\r\n\r\n            $.when(self.actionManager(action)).done(function(act) {\r\n                self.executeAction(act);\r\n            });\r\n        });\r\n    },\r\n\r\n    configureTemplateHandlers: function() {\r\n        var self = this;\r\n        /**\r\n         * Catch the event from the layout link\r\n         */\r\n        self.engine.subscribe(\"onLoadDataNavigation\", function(ev, params) {\r\n            params.filters = [];\r\n            params.calculateFilters = params.calculateFilters || true;\r\n            self.triggerGlobalHandler(\"dataNavigation\", params);\r\n        });\r\n    }\r\n\r\n});","/*\r\n*   Name: BizAgi Tablet Render Text Extension\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This script will redefine the text render class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.text.extend(\"bizagi.rendering.text\", {}, {\r\n\r\n    /* POSTRENDER \r\n    =====================================================*/\r\n    postRender: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Set the default maxlenght for the input\r\n        if (properties.maxLength > 0) {\r\n            self.input.prop(\"maxlength\", properties.maxLength);\r\n        }\r\n    },\r\n\r\n    /**\r\n    * Creates the markup for the readonly text field\r\n    * Comment: includes the default value in the markup\r\n    * @returns {html}\r\n    */\r\n    renderReadOnly: function () {        \r\n        var template = this.renderFactory.getTemplate(\"readonly\");\r\n        return $.kendoTmpl(template, {});\r\n    },\r\n\r\n   /**\r\n    * Readonly\r\n    * @returns {} \r\n    */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        self._super();\r\n        self.input = control.find(\".bz-rn-readonly\");\r\n    },\r\n\r\n    /* SETS THE VALUE IN THE RENDERED CONTROL\r\n    =====================================================*/\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var decodedValue = bizagi.util.decodeURI(value);\r\n\r\n        // Set value in input\r\n        if (!bizagi.util.isEmpty(value) && properties.editable) {\r\n            value = value.replaceAll(\"\\\\n\", \" \").replaceAll(\"\\n\", \" \");\r\n            value = value.replaceAll(\"&amp;\", \"&\");\r\n            self.input.prop(\"value\", value);\r\n        } else if (!self.properties.editable) {\r\n            value = typeof (value) == \"boolean\" ? value.toString() : value;\r\n\r\n            // Render as simple value\r\n            if (typeof (value) == \"string\") {\r\n                var displayValue = self.getDisplayValue();\r\n                var decodedDisplayValue = bizagi.util.decodeURI(displayValue);\r\n\r\n                // Replace line breaks for html line breaks\r\n                var valueToDisplay = decodedDisplayValue.replaceAll(\"&\", \"&amp;\");\r\n                valueToDisplay = valueToDisplay.replaceAll(\"<\", \"&lt;\").replaceAll(\">\", \"&gt;\");\r\n                valueToDisplay = valueToDisplay.replaceAll(\"\\\"\", \"&#34;\").replaceAll(\"'\", \"&#39;\").replaceAll(\"/\", \"&#47;\");\r\n                valueToDisplay = valueToDisplay.replaceAll(\"\\\\n\", \"<br/>\");\r\n                valueToDisplay = valueToDisplay.replaceAll(\"\\n\", \"<br/>\");\r\n\r\n                self.input.html(valueToDisplay);\r\n\r\n            } else {\r\n                if (bizagi.util.isNull(value)) {\r\n                    self.input.html(\"\");\r\n                }\r\n            }\r\n        }\r\n        // Set internal value\r\n        self.setValue(decodedValue, false);\r\n    },\r\n\r\n    attachRetypeDouble: function () {\r\n        var self = this;\r\n        var element = self.element;\r\n\r\n        var input = $(\"input\", element);\r\n        if (!input || input.length === 0) return;\r\n\r\n        // Apply blur handler to check value\r\n        input.blur(function () {\r\n            var control = $(this);\r\n            if ($(control).attr(\"type\") !== \"hidden\" &&\r\n                $(control).css(\"display\") !== \"none\" &&\r\n                $(control).css(\"visibility\") !== \"hidden\") {\r\n\r\n                if (!control.data(\"oldValue\") || $(this).data(\"oldValue\") === \"\") {\r\n\r\n                    // Check that there is something in the value\r\n                    // Check if a value has already been set\r\n                    if (control.val() === \"\" || control.val() === control.attr(\"newValue\"))\r\n                        return;\r\n\r\n                    control.data(\"oldValue\", control.val());\r\n                    control.val(\"\");\r\n\r\n                    try {\r\n                        // Create new tooltip\r\n                        control.tooltip(\"destroy\");\r\n                    } catch (e) {\r\n\r\n                    }\r\n\r\n                    control.attr(\"title\", self.getResource(\"render-number-retype\")); //\"Re-escriba el valor\"\r\n                    control.tooltip();\r\n                    control.tooltip(\"open\");\r\n\r\n                    // Focus after 100ms to avoid bubbling\r\n                    setTimeout(function () {\r\n                        control.focus();\r\n                    }, 100);\r\n\r\n                } else {\r\n                    if (control.val() !== control.data(\"oldValue\")) {\r\n                        self.setValue(\"\");\r\n                        control.val(\"\");\r\n                        control.data(\"oldValue\", \"\");\r\n                        control.tooltip(\"destroy\");\r\n                        control.attr(\"title\", self.getResource(\"render-text-retype-error\"));\r\n                        control.tooltip();\r\n                        control.tooltip(\"open\");\r\n\r\n                        setTimeout(function () {\r\n                            control.focus();\r\n                        }, 100);\r\n\r\n                    } else {\r\n\r\n                        control.data(\"newValue\", control.val());\r\n                        control.data(\"oldValue\", \"\");\r\n                        // Destroy tooltips\r\n                        control.tooltip(\"destroy\");\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Tablet Render Text Extension\r\n*   Author: Bizagi Mobile Team\r\n*   Comments: Extended text implementation\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.extendedText.extend(\"bizagi.rendering.extendedText\", {}, {\r\n\r\n    /* CONSTRUCTOR\r\n    =====================================================*/\r\n    init: function (params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super(params);\r\n\r\n        // Fill default properties\r\n        var properties = self.properties;\r\n\r\n        // Set rowSize default\r\n        properties.rowSize = properties.maxLines || 6;\r\n    },\r\n\r\n    /**\r\n     * Creates the markup for the readonly extendedText field\r\n     * Comment: includes the default value in the markup\r\n     * @returns {html}\r\n     */\r\n    renderReadOnly: function () {        \r\n        var template = this.renderFactory.getTemplate(\"readonlyExtendedText\");        \r\n        return $.kendoTmpl(template);        \r\n    },\r\n\r\n    /* POSTRENDER\r\n    =====================================================*/\r\n    postRender: function () {\r\n\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var counter = 0;\r\n\r\n        // Call base \r\n        this._super();\r\n\r\n        if(!properties.editable) {\r\n            self.textarea = $(\".ui-bizagi-render-text-extended pre\", self.getControl());\r\n        } else {\r\n            self.textarea = $(\".ui-bizagi-render-text-extended\", self.getControl());\r\n        }\r\n\r\n        if (self.textarea.length > 0) {\r\n            // Increase default textarea rows to improve readability\r\n            self.textarea.prop(\"rows\", properties.rowSize);\r\n\r\n            // Define max length of element\r\n            if (properties.maxLength > 0)\r\n                self.textarea.attr(\"maxlength\", properties.maxLength);\r\n\r\n            // extend textArea to allow to see all the content\r\n            var autoAdjustIntervalMethod = function () {\r\n                if ((counter > 2000) || (typeof (self.textarea) !== \"undefined\" && self.textarea[0] && self.textarea[0].scrollHeight > 0)) {\r\n                    self.autoAdjustExtendedFrame(self.textarea[0]);\r\n                    stopAutoAdjustInterval();\r\n                }\r\n                counter += 500;\r\n            };\r\n\r\n            var stopAutoAdjustInterval = function () {\r\n                clearInterval(autoAdjustInterval);\r\n            };\r\n\r\n            var autoAdjustInterval = properties.autoExtend ? setInterval(function () { autoAdjustIntervalMethod(); }, 500) : null;\r\n        }\r\n    },\r\n\r\n    /*\r\n    *\r\n    */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        self.element.addClass(\"bz-rn-read-only bz-rn-non-editable\");\r\n        self.textarea = $(\".ui-bizagi-render-text-extended pre\", self.getControl());\r\n    },\r\n\r\n    /* SETS THE VALUE IN THE RENDERED CONTROL\r\n    =====================================================*/\r\n    setDisplayValue: function(value) {\r\n        var self = this;        \r\n        var properties = self.properties;\r\n        var decodedValue = bizagi.util.decodeURI(value);\r\n        var isOfflineForm = bizagi.util.isOfflineForm({ context: self });\r\n        value = typeof decodedValue == \"string\" ? decodedValue : \"\";\r\n\r\n        // Call base\r\n        this._super(value);\r\n\r\n        // Set value in input\r\n        if (value && properties.editable) {\r\n            if (isOfflineForm) {\r\n                value = typeof(value) === \"object\" && value.value ? value.value : value;\r\n            }\r\n            var resolvedValue = $.br2nl(value);\r\n            self.textarea.val(resolvedValue);\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;        \r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        // Define max length of element\r\n        if (self.properties.maxLength > 0) {\r\n            if (self.properties.autoExtend) {\r\n                $(self.textarea).bind(\"keydown keypress\", function (e) {\r\n                    self.autoAdjustExtendedFrame(this);\r\n                });\r\n            }\r\n        }\r\n    },\r\n\r\n    autoAdjustExtendedFrame: function (element) {\r\n        // If scrollHeight <= 0 a div must be created with the same content \r\n        // to get the height that should have the extendedText \r\n        if (element.scrollHeight <= 0) {\r\n            var hiddenDiv = $(document.createElement(\"div\"));\r\n            var content = null;\r\n\r\n            $(hiddenDiv).attr(\"display\", \"none\");\r\n            $(\"body\").append(hiddenDiv);\r\n\r\n            content = $(element).val();\r\n            content = content.replace(/\\n/g, \"<br>\");\r\n            hiddenDiv.html(content + \"<br>\");\r\n\r\n            $(element).css('height', hiddenDiv.height());\r\n\r\n            hiddenDiv.remove();\r\n        } else {\r\n\r\n            if ($(element).height() > 100) {\r\n                $(element).height($(element).height() - 20);\r\n            }\r\n            while ($(element).outerHeight() < element.scrollHeight) {\r\n                $(element).height($(element).height() + 1);\r\n            };\r\n        }\r\n    }\r\n});","/*\r\n*   Name: BizAgi Tablet Render Label Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the label render class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.label.extend(\"bizagi.rendering.label\", {}, {\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        // Apply a css class\r\n        self.getLabel().addClass(\"ui-bizagi-render-label\");\r\n    },\r\n\r\n    /*\r\n    *   Method to render non editable values\r\n    */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n\r\n        // Apply a css class\r\n        self._super();\r\n        self.getLabel().addClass(\"ui-bizagi-render-label\");\r\n    }\r\n});","/*\r\n*   Name: BizAgi Tablet Render Number Extension\r\n*   Author: Bizagi Mobile Team \r\n*   Comments:\r\n*   -   This script will redefine the number render class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.number.extend(\"bizagi.rendering.number\", {}, {\r\n\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n        var value = self._super();\r\n        var template = self.renderFactory.getTemplate(\"readonlyNumber\");\r\n\r\n        return $.kendoTmpl(template, {value: value});\r\n    },\r\n\r\n    /* POSTRENDER \r\n    =====================================================*/\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n        self.numericInput = $(\"input\", self.getControl());\r\n\r\n        //Adjust the input in order to accept the comma input as decimal separator for certain language standars\r\n        if(self.properties.decimalSymbol == ',') {\r\n            self.numericInput.attr(\"lang\", \"en-150\");\r\n        }\r\n\r\n        var input = $(\"input\", self.element);\r\n        if (!input || input.length === 0) return;\r\n    },\r\n\r\n    postRenderReadOnly: function() {\r\n        var self = this;\r\n        var control = self.getControl();        \r\n\r\n        control.closest(\".ui-bizagi-render\").addClass(\"bz-rn-read-only\");\r\n        self.numericInput = $(\".ui-bizagi-render-numeric\", control);\r\n    },\r\n\r\n    /* SETS THE VALUE IN THE RENDERED CONTROL\r\n    =====================================================*/\r\n    setDisplayValue: function(value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set internal value\r\n        self.setValue(value, false);\r\n\r\n        if (typeof (value) == \"string\" || typeof (value) == \"number\") {\r\n            if (properties.editable && self.numericInput) {\r\n                self.numericInput.prop(\"value\", value);\r\n\r\n                // Formats the input\r\n                self.executeFormatCurrencyPlugin();\r\n            } else if (!properties.editable) {\r\n                self.numericInput.text(self.getDisplayValue());\r\n            }\r\n        }\r\n    },\r\n\r\n    attachRetypeDouble: function() {\r\n        var self = this;\r\n        var element = self.element;\r\n        var input = $(\"input\", element);\r\n\r\n        if (!input || input.length === 0) return;\r\n\r\n        // Apply blur handler to check value\r\n        input.blur(function() {\r\n            var control = $(this);\r\n\r\n            self.retypeDouble(control);\r\n        });\r\n    },\r\n\r\n    retypeDouble: function(control) {\r\n        var self = this;\r\n\r\n        if ($(control).attr(\"type\") !== \"hidden\" &&\r\n            $(control).css(\"display\") !== \"none\" &&\r\n            $(control).css(\"visibility\") !== \"hidden\") {\r\n\r\n            if (!control.data(\"oldValue\") || $(this).data(\"oldValue\") === \"\") {\r\n\r\n                // Check that there is something in the value or if a value has already been set\r\n                if (control.val() === \"\" || control.val() === control.attr(\"newValue\"))\r\n                    return;\r\n\r\n                control.data(\"oldValue\", control.val());\r\n                control.val(\"\");\r\n\r\n                // Create new tooltip\r\n                try {\r\n                    control.tooltip(\"destroy\");\r\n                } catch (e) { }\r\n\r\n                // Re-type value\r\n                control.attr(\"title\", self.getResource(\"render-number-retype\"));\r\n                control.tooltip();\r\n                control.tooltip(\"open\");\r\n\r\n                // Focus after 100ms to avoid bubbling\r\n                setTimeout(function() {\r\n                    control.focus();\r\n                }, 100);\r\n\r\n            } else {\r\n\r\n                // Check that there is something in the value\r\n                if (control.val() === \"\") {\r\n                    return;\r\n                }\r\n\r\n                if (control.val() !== control.data(\"oldValue\")) {\r\n                    self.setValue(\"\");\r\n                    control.val(\"\");\r\n                    control.data(\"oldValue\", \"\");\r\n\r\n                    try {\r\n                        // Destroy tooltips\r\n                        control.tooltip(\"destroy\");\r\n                    } catch (e) { }\r\n\r\n                    control.attr(\"title\", self.getResource(\"render-number-retype-fail\"));\r\n                    control.tooltip();\r\n                    control.tooltip(\"open\");\r\n\r\n                    setTimeout(function() {\r\n                        control.focus();\r\n                    }, 100);\r\n\r\n                } else {\r\n                    control.data(\"newValue\", control.val());\r\n                    control.data(\"oldValue\", \"\");\r\n\r\n                    try {\r\n                        // Destroy tooltips\r\n                        control.tooltip(\"destroy\");\r\n                    } catch (e) { }\r\n                }\r\n\r\n            }\r\n        }\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: Bizagi Rendering Tablet numberScientificNotation\r\n *   Author: Luis Cabarique - LuisCE\r\n *   Comments:\r\n *   -   This script will define a base class to define the Scientific number notation\r\n */\r\n\r\n\r\nbizagi.rendering.numberScientificNotation.extend(\"bizagi.rendering.numberScientificNotation\", {}, {\r\n\r\n    /*\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        self.inputDisplay = $(\"input\", control).first();\r\n        self.numericInput = self.input = $(\"input\", control).last();\r\n        self.numericIcon = $(\"span\", self.getControl());\r\n\r\n        // Add numeric plugin to avoid invalid keystrokes\r\n        self.numericInput.numericSN(self.properties.decimalSymbol);\r\n\r\n        // Attach Format Currency Plugin to format the input\r\n        self.attachFormatSientificNotation();\r\n\r\n    },\r\n\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var value = bizagi.util.scientificNotationFormat(value, properties.decimalSymbol, 38);\r\n        var displayValue = bizagi.util.scientificNotationFormat(value, properties.decimalSymbol, 20);\r\n\r\n\r\n        this._super(displayValue);\r\n\r\n        // Set value in input\r\n        if (value != null && properties.editable) {\r\n            self.numericInput.val(value);\r\n            self.inputDisplay.val(displayValue);\r\n        }\r\n\r\n    },\r\n\r\n    attachFormatSientificNotation: function () {\r\n        var self = this;\r\n\r\n        self.inputDisplay.focus(function () {\r\n            $(this).val(self.getDisplayValue());\r\n        });\r\n\r\n        // Attach events\r\n        self.inputDisplay.blur(function () {\r\n            if (typeof (self.getFormContainer().validationController) == \"undefined\") self.getFormContainer().validationController = new bizagi.command.controllers.validation(self.getFormContainer(), self.validations);\r\n\r\n            var scientificNotationNumber = bizagi.util.scientificNotationFormat(self.inputDisplay.val(), self.properties.decimalSymbol, 38);\r\n            var scientificNotationNumberDisplay = bizagi.util.scientificNotationFormat(self.inputDisplay.val(), self.properties.decimalSymbol, 20);\r\n\r\n            self.numericInput.val(scientificNotationNumber);\r\n            self.inputDisplay.val(scientificNotationNumberDisplay);\r\n            // Updates internal value\r\n            self.setValue(scientificNotationNumber);\r\n        });\r\n    }\r\n});","/**\r\n*   Name: Bizagi Tablet Render Date Extension\r\n*   Author: Cristian Olaya\r\n*   Date: 2015-sep-29\r\n*   Comments:\r\n*   -   This script will redefine the Date render class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.date.extend(\"bizagi.rendering.date\", {\r\n    DEFAULT_PROPERTIES: {\r\n        \"maxYearsToDisplay\": 100\r\n    }\r\n}, {\r\n    /**\r\n     *  Rendering the control\r\n     * */\r\n    initializeDateControl: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        //Getting the input\r\n        self.input = $(\".bz-rn-date-control\", control);\r\n    },\r\n\r\n    configureHandlers: function () {\r\n    },\r\n\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"readonlyDate\");\r\n\r\n        return $.kendoTmpl(template, {});\r\n    },\r\n\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        self._super();\r\n\r\n        var control = self.getControl();\r\n\r\n        $(\"i\", control).addClass(\"bz-calendar-input\");\r\n        self.input = $(\"span\", control);\r\n\r\n        if (!self.isValidMinMaxValue()) {\r\n            self.setValue(\"\");\r\n            self.input.prop('value', \"\");\r\n            self.properties.displayValue = \"\";\r\n        }\r\n    },\r\n    /**\r\n     * To configure the mobiscroll plugin\r\n     * */\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        self._super();\r\n\r\n        //Initializing the control\r\n        self.initializeDateControl();\r\n\r\n        var inputControl = self.getDateControl();\r\n        var controlElements = self.properties.showTime ? [\"calendar\", \"time\"] : [\"calendar\"];\r\n        var defaultDateControl = self.getFormattedDate(self.properties.value, self.properties.showTime, true);\r\n        var minDateControl = self.getFormattedDate(self.properties.minValue, self.properties.showTime, false);\r\n        var maxDateControl = self.getFormattedDate(self.properties.maxValue, self.properties.showTime, false);\r\n        var timeFormat = self.properties.showTime ? self.getTimeFormat() : \"\";\r\n\r\n        //Adds a gap of years to show if the user doest not include min years\r\n        if (isNaN(Date.parse(minDateControl))) {\r\n            minDateControl = new Date();\r\n            minDateControl.setFullYear(minDateControl.getFullYear() - self.Class.DEFAULT_PROPERTIES.maxYearsToDisplay);\r\n            minDateControl.setHours(0, 0, 0, 0);\r\n        }\r\n\r\n        //Adds a gap of years to show if the user doest not include min years\r\n        if (isNaN(Date.parse(maxDateControl))) {\r\n            maxDateControl = new Date();\r\n            maxDateControl.setFullYear(maxDateControl.getFullYear() + self.Class.DEFAULT_PROPERTIES.maxYearsToDisplay);\r\n            maxDateControl.setHours(23, 59, 59);\r\n        }\r\n\r\n        $(\".bz-calendar-input\", self.control).click(function () {\r\n            inputControl.click();\r\n        });\r\n\r\n        if (!self.isValidMinMaxValue()) {\r\n            self.setValue(\"\");\r\n            self.input.prop('value', \"\");\r\n            self.properties.displayValue = \"\";\r\n        }\r\n\r\n        inputControl.mobiscroll().calendar({\r\n            //theme: theme,\r\n            mode: \"mixed\",       // Specify scroller mode like: mode: \"mixed\" or omit setting to use default\r\n            display: \"bottom\", // Specify display mode like: display: \"bottom\" or omit setting to use default\r\n            controls: controlElements,\r\n            min: minDateControl,\r\n            max: maxDateControl,\r\n            defaultValue: defaultDateControl,\r\n            timeFormat: timeFormat,\r\n            lang: bizagi.util.languages[BIZAGI_LANGUAGE] || \"en\",\r\n            buttons: [\r\n            \"set\",\r\n            {\r\n                text: this.getResource(\"render-plugin-search-users-clear-button-name\"),\r\n                handler: function (e, inst) {\r\n                    self.date = undefined;\r\n                    self.time = undefined;\r\n                    self.timeS = undefined;\r\n                    self.onChangeHandler(true);\r\n                    inst.clear();\r\n                }\r\n            },\r\n            \"cancel\"\r\n            ],\r\n            onSet: function (e, inst) {\r\n                var data = inst.getVal();\r\n                self.date = { \"day\": data.getDate(), \"month\": data.getMonth(), \"year\": data.getFullYear() };\r\n\r\n                //Checks if its has time, and included it\r\n                if (self.properties.showTime) {\r\n                    self.time = { \"hours\": data.getHours(), \"minutes\": data.getMinutes() };\r\n                    if (!self.is24h) {\r\n                        self.timeS = data.getHours() < 12 ? \"am\" : \"pm\";\r\n                    }\r\n                }\r\n\r\n                self.onChangeHandler();\r\n            },\r\n            onBeforeShow: function (event, inst) {\r\n                // Your custom event handler goes here\r\n                self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n\r\n                self.changeMinValue(self.properties.minValue);\r\n                self.changeMaxValue(self.properties.maxValue);\r\n            },\r\n            onClose: function (event, inst) {\r\n                // Your custom event handler goes here\r\n                self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n                $(\".mbsc-fr-scroll\").css(\"overflow-y\", \"auto\");\r\n            },\r\n            onShow: function (event, inst) {\r\n                $(\".mbsc-fr-scroll\").css(\"overflow-y\", \"hidden\");\r\n            }\r\n        });\r\n\r\n        // Bind event for change value\r\n        inputControl.on(\"focus\", function (e) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n\r\n            if (bizagi.util.isCordovaSupported() && bizagi.util.isAndroidDevice()) {\r\n                cordova.plugins.Keyboard.disableScroll(true);\r\n                cordova.plugins.Keyboard.close();\r\n            }\r\n        });\r\n\r\n        //Set input displayValue if it has default value\r\n        if (self.properties.displayValue === \"\" && self.properties.value) {\r\n            var date = self.getFormattedDate(self.properties.value, self.properties.showTime, true, false);\r\n            if (typeof (date) !== \"undefined\") {\r\n                var displayValue = bizagi.util.dateFormatter.formatDate(date, self.properties.fullFormat);\r\n                self.input.prop(\"value\", displayValue);\r\n            }\r\n        }\r\n\r\n        inputControl.attr(\"keyboard\", \"disable\");\r\n    },\r\n\r\n    /**\r\n     * Configure the timeformat\r\n     * */\r\n    getTimeFormat: function () {\r\n        var self = this;\r\n\r\n        if (self.properties.timeFormat.indexOf(\"H\") !== -1 || self.properties.timeFormat.indexOf(\"HH\") !== -1) {\r\n            self.is24h = true;\r\n            return \"HH:ii\";\r\n        } else {\r\n            self.is24h = false;\r\n            return \"hh:ii A\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Get Date whit the Invariant and ISO Format applied.\r\n     * */\r\n    getFormattedDate: function (date, showTime, initializer) {\r\n        var self = this;\r\n\r\n        if (!date || bizagi.util.isObjectEmpty(date)) return;\r\n\r\n        //There are some dates that haven't time,... actions and validations for example or when we have to put a initial value (default value without time),\r\n        //in that cases we should identify the case and if the date haven't the time value, we have to add (00:00:00) it to can apply the format (getDateFromInvariant).\r\n        var time = (showTime && (self.getTime() === \"0:0\" || initializer)) ? \" \" + date.substr(date.length - 8, date.length) : \"\";\r\n\r\n        var currentDate = (initializer && showTime && time.split(\"/\").length > 1) || (date.split(\":\").length === 1) ? date += \" 00:00:00\" : date;\r\n        date = bizagi.util.dateFormatter.getDateFromInvariant(currentDate, showTime);\r\n\r\n        var currentTime = showTime ? time !== \"\" ? time : \" \" + self.getTime() : \" 00:00\";\r\n        var fullDateFormated = self.setHour(self.getFullFormatedDate(date, currentTime));\r\n\r\n        fullDateFormated = bizagi.util.dateFormatter.getDateFromISO(fullDateFormated, true);\r\n\r\n        return fullDateFormated;\r\n    },\r\n\r\n    /*\r\n     *   Changes the render min value\r\n     */\r\n    changeMinValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var dateControl = self.getDateControl();\r\n\r\n        // Set value in control\r\n        if (value && self.properties.editable) {\r\n            if (typeof (value) === \"number\") {\r\n                value = new Date(value);\r\n                dateControl.mobiscroll('option', { min: value});\r\n                value = bizagi.util.dateFormatter.formatInvariant(value, properties.showTime); // Set as invariant\r\n            } else {\r\n                dateControl.mobiscroll('option', { min: bizagi.util.dateFormatter.getDateFromInvariant(value, true) });\r\n            }\r\n\r\n            properties.minValue = value;\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Changes the render max value\r\n     */\r\n    changeMaxValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var dateControl = self.getDateControl();\r\n\r\n        // Set value in control\r\n        if (value && self.properties.editable) {\r\n            if (typeof (value) === \"number\") {\r\n                value = new Date(value);\r\n                dateControl.mobiscroll('option', { max: value});\r\n                value = bizagi.util.dateFormatter.formatInvariant(value, properties.showTime); // Set as invariant\r\n            } else {\r\n                dateControl.mobiscroll('option', { max: bizagi.util.dateFormatter.getDateFromInvariant(value, true) });\r\n            }\r\n\r\n            properties.maxValue = value;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Set the display value on input     \r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var date = self.getFormattedDate(value, properties.showTime, false);\r\n        var displayValue = self.preprocessDateValue(date);\r\n\r\n        if (properties.editable === false) {\r\n            // Render as simple value\r\n            if (typeof (displayValue) === \"string\" || typeof (displayValue) === \"number\") {\r\n                self.input.html(displayValue);\r\n            }\r\n        } else {\r\n            self.input.prop(\"value\", displayValue);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Get the DOM Control\r\n     * */\r\n    getDateControl: function () {\r\n        var self = this;\r\n        return $(\"input.bz-rn-date-control\", self.getControl());\r\n    },\r\n\r\n    /**\r\n     * Get Time from mobiscroll\r\n     * */\r\n    getTime: function () {\r\n        var self = this;\r\n\r\n        //Converting the time in 24h format.\r\n        if (self.properties.showTime && (self.time && self.time[\"minutes\"] !== \"\")) {\r\n            var time = self.time[\"hours\"] + \":\" + self.time[\"minutes\"];\r\n            time += self.timeS;\r\n\r\n            if (time.indexOf(\"am\") != -1 && self.time[\"hours\"] == 12) {\r\n                time = time.replace(\"12\", \"0\");\r\n            }\r\n\r\n            if (time.indexOf(\"pm\") != -1 && self.time[\"hours\"] < 12) {\r\n                time = time.replace(self.time[\"hours\"], (parseInt(self.time[\"hours\"]) + 12));\r\n            }\r\n\r\n            return time.replace(/(am|pm)/, \"\");\r\n        } else {\r\n            return \"\";\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Get Date from mobiscroll\r\n     * */\r\n    getDate: function () {\r\n        var self = this;\r\n        return (self.date && self.date[\"month\"] !== \"\") ? self.date[\"year\"] + \"-\" + (parseInt(self.date[\"month\"]) + 1) + \"-\" + self.date[\"day\"] : \"\";\r\n    },\r\n\r\n    /**\r\n     * Set the control value when the control change\r\n     */\r\n    onChangeHandler: function (isClearButton) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var currentDate = self.getDate();\r\n        var currentTime = (properties.showTime) ? \" \" + self.getTime() : \" 0:00\";\r\n\r\n        // If curren date is empty reset actual value\r\n        if ((currentDate === \"\" && !properties.showTime) || (currentDate === \"\" && currentTime === \"\") || (isClearButton)) {\r\n            self.setValue(\"\");\r\n            self.input.prop(\"value\", \"\");\r\n            properties.displayValue = \"\";\r\n        } else {\r\n            var formatedFullDate = self.setHour(self.getFullFormatedDate(currentDate, currentTime));\r\n\r\n            formatedFullDate = bizagi.util.dateFormatter.getDateFromISO(formatedFullDate, true);\r\n\r\n            if (!formatedFullDate || formatedFullDate == 0) return;\r\n\r\n            // Set date value\r\n            self.setNewDateValue(formatedFullDate, properties.showTime);\r\n\r\n            var displayValue = self.preprocessDateValue(formatedFullDate);\r\n            properties.displayValue = displayValue;\r\n\r\n            self.input.prop(\"value\", self.properties.displayValue);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Apply the final format that will be showed on the input\r\n     * */\r\n    getFullFormatedDate: function (currentDate, currentTime) {\r\n        var fullDate = \"\";\r\n\r\n        if (currentDate.length > 0) {\r\n            fullDate = currentDate;\r\n        } else if (currentDate !== undefined) {\r\n            fullDate = bizagi.util.dateFormatter.formatISO(currentDate, false);\r\n        } else {\r\n            fullDate = bizagi.util.dateFormatter.formatISO(new Date(), false);\r\n        }\r\n\r\n        fullDate += currentTime;\r\n        var dateFromFormat = bizagi.util.dateFormatter.getDateFromFormat(fullDate, \"yyyy-MM-dd H:m\");\r\n\r\n        return bizagi.util.dateFormatter.formatDate(dateFromFormat !== 0 ? dateFromFormat : currentDate, \"yyyy-MM-dd H:mm:ss\");\r\n    },\r\n\r\n    /**\r\n     * Set the control value\r\n     * */\r\n    setNewDateValue: function (formatedFullDate, showTime) {\r\n        var self = this;\r\n        var value = formatedFullDate != \"\" ? bizagi.util.dateFormatter.formatInvariant(formatedFullDate, showTime) : \"\";\r\n        self.setValue(value);\r\n    },\r\n\r\n    /**\r\n     * Removing the time when be necesary\r\n     * */\r\n    applyDateFormat: function (date, showTime) {\r\n        if (!showTime) {\r\n            var initIndexTime = null;\r\n\r\n            if (date.indexOf(\"00:00\") != -1) {\r\n                initIndexTime = date.indexOf(\"00:00\");\r\n            } else if (date.indexOf(\"0:00\") != -1) {\r\n                initIndexTime = date.indexOf(\"0:00\");\r\n            } else if (date.indexOf(\"12:00\") != -1) {\r\n                initIndexTime = date.indexOf(\"12:00\");\r\n            } else {\r\n                initIndexTime = \"-1\";\r\n            }\r\n\r\n            var endIndexTime = initIndexTime + 8;\r\n            date = initIndexTime === -1 ? date : date.replace(date.substring(initIndexTime, endIndexTime), \"\").replace(\" am\", \"\").replace(\" pm\", \"\");\r\n        }\r\n\r\n        return date;\r\n    },\r\n\r\n    /*\r\n     *  Checks if the date could be localized using site language\r\n     * */\r\n    preprocessDateValue: function (date) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var displayValue;\r\n\r\n        displayValue = bizagi.util.dateFormatter.formatDate(date, properties.fullFormat);\r\n\r\n        return displayValue;\r\n    },\r\n\r\n    /**\r\n     * Public method to determine if a value is valid or not\r\n     */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var bValid = true;\r\n        var value = self.getValue();\r\n\r\n        if (value) {\r\n            if (bizagi.util.parseBoolean(properties.editable)) {\r\n                value = bizagi.util.dateFormatter.getDateFromInvariant(value);\r\n\r\n                if (value !== 0) {\r\n                    // Clear time for validations\r\n                    value.setHours(0, 0, 0, 0);\r\n\r\n                    // Check min value and max value\r\n                    if (properties.minValue && typeof properties.minValue == \"string\") {\r\n                        bValid = self.validateMinAndMaxValue(value, true, properties, invalidElements) ? false : bValid;\r\n                    }\r\n\r\n                    if (properties.maxValue && typeof properties.maxValue == \"string\") {\r\n                        bValid = self.validateMinAndMaxValue(value, false, properties, invalidElements) ? false : bValid;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        if (bizagi.util.parseBoolean(properties.editable)) {\r\n            // Check required\r\n            if (properties.required && self.hasValue()) {\r\n                var control = self.getDateControl();\r\n\r\n                if (control.length > 0 && control.val().length <= 0) {\r\n                    bValid = self.showMandatoryMessage(properties, invalidElements);\r\n                }\r\n            } else if (properties.required && !self.hasValue()) {\r\n                self.showMandatoryMessage(properties, invalidElements);\r\n            }\r\n        }\r\n\r\n        if (bValid) {\r\n            // Clear error message\r\n            self.setValidationMessage(\"\");\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * To validate the min and max values\r\n     * */\r\n    validateMinAndMaxValue: function (value, isMinValue, properties, invalidElements) {\r\n        var vValue = bizagi.util.dateFormatter.getDateFromInvariant(isMinValue ? properties.minValue : properties.maxValue);\r\n\r\n        //In case the value from the minValue or maxValue are assigned from a Date control that does not have the option  \"showTime!\r\n        if (vValue == 0) {\r\n            var resultValue = \"\";\r\n            if (properties.timeFormat.indexOf(\":ss\") == -1) {\r\n                if (isMinValue) {\r\n                    resultValue = properties.minValue + \":00\";\r\n                } else {\r\n                    resultValue = properties.maxValue + \":00\";\r\n                }\r\n            }\r\n\r\n            vValue = bizagi.util.dateFormatter.getDateFromFormat(resultValue, properties.fullFormat + \":ss\");\r\n        }\r\n\r\n        vValue.setHours(0, 0, 0, 0);\r\n\r\n        if ((isMinValue && value < vValue) || (!isMinValue && value > vValue)) {\r\n            var formatedDate = bizagi.util.dateFormatter.formatDate(vValue, properties.fullFormat);\r\n            var message = isMinValue ?\r\n            this.getResource(\"render-date-minimum-validation\").replaceAll(\"#label#\", properties.displayName).replaceAll(\"#minValue#\", formatedDate)\r\n            : this.getResource(\"render-date-maximum-validation\").replaceAll(\"#label#\", properties.displayName).replaceAll(\"#maxValue#\", formatedDate);\r\n\r\n            invalidElements.push({ xpath: properties.xpath, message: message });\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * To show the mandatory values message\r\n     * */\r\n    showMandatoryMessage: function (properties, invalidElements) {\r\n        var self = this;\r\n        var message = self.getResource(\"render-required-text\").replaceAll(\"#label#\", properties.displayName);\r\n\r\n        invalidElements.push({ xpath: properties.xpath, message: message });\r\n\r\n        return false;\r\n    },\r\n\r\n    setHour: function (date) {\r\n        return date.replace(\" 0:\", \" 00:\").replace(\" 1:\", \" 01:\").replace(\" 2:\", \" 02:\").replace(\" 3:\", \" 03:\").replace(\" 4:\", \" 04:\").replace(\" 5:\", \" 05:\").replace(\" 6:\", \" 06:\").replace(\" 7:\", \" 07:\").replace(\" 8:\", \" 08:\").replace(\" 9:\", \" 09:\");\r\n    },\r\n\r\n    /**\r\n     * Cleans the control fields as it requires\r\n     * */\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n\r\n        self.date = undefined;\r\n        self.time = undefined;\r\n        self.timeS = undefined;\r\n        self.onChangeHandler(true);\r\n        self.setDisplayValue('');\r\n    },\r\n\r\n    isValidMinMaxValue: function () {\r\n        var self = this;\r\n        var bValid = true;\r\n        var value = self.getValue();\r\n\r\n        if (value) {\r\n            value = bizagi.util.dateFormatter.getDateFromInvariant(value);\r\n\r\n            if (value !== 0) {\r\n                // Clear time for validations\r\n                value.setHours(0, 0, 0, 0);\r\n\r\n                // Check min value and max value\r\n                if (self.properties.minValue && typeof (self.properties.minValue) === 'string')\r\n                    bValid = self.validateMinAndMaxValue(value, true);\r\n\r\n                if (self.properties.maxValue && typeof (self.properties.maxValue) === 'string')\r\n                    bValid = self.validateMinAndMaxValue(value, false);\r\n            }\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    validateMinAndMaxValue: function (currentDate, isMinValue) {\r\n        var self = this;\r\n        var date = isMinValue ? self.properties.minValue : self.properties.maxValue;\r\n        var formattedDate = bizagi.util.dateFormatter.getDateFromInvariant(date);\r\n\r\n        formattedDate.setHours(0, 0, 0, 0);\r\n\r\n        return !((isMinValue && currentDate < formattedDate) || (!isMinValue && currentDate > formattedDate));\r\n\r\n    }\r\n});","/*\r\n*   Name: BizAgi Tablet Render Yes-No Extension\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This script will redefine the Yes-No render class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.yesno.extend(\"bizagi.rendering.yesno\", {}, {\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Call base \r\n        this._super();\r\n\r\n        // Set control container to behave as a block\r\n        control.addClass(\"ui-bizagi-render-display-block\");\r\n        control.addClass(\"ui-bizagi-render-boolean-yesno\");\r\n\r\n        // Bind change event\r\n        control.bind(\"optiongroupchange\", function (evt, ui) {\r\n            // Only change the internal value when it truly changes\r\n            if (self.value != ui.value) {\r\n                self.setValue(ui.value);\r\n            }\r\n        });\r\n        \r\n        control.find(\".ui-bizagi-render-boolean-radio\").bind(\"click\", function () {\r\n            self.getControl().find(\".ui-bizagi-render-boolean-radio\").removeClass(\"ui-radio-state-checked\");\r\n            self.getControl().find(\".ui-bizagi-render-boolean-radio\").removeClass(\"bz-check\").addClass(\"bz-unchecked\");\r\n\r\n            $(this).addClass(\"ui-radio-state-checked\");\r\n            $(this).addClass(\"ui-radio-state-checked\").addClass(\"bz-check\").removeClass(\"bz-unchecked\");\r\n\r\n            var val = $(this).attr(\"value\");\r\n\r\n            if (self.value != val) {\r\n                self.setValue(val);\r\n            }\r\n        });\r\n    },\r\n\r\n    /* SETS THE VALUE IN THE RENDERED CONTROL\r\n    =====================================================*/\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        self.setValue(value.toString().toLowerCase(), false);\r\n\r\n        // Set value in control\r\n        if (value != null && properties.editable) {\r\n            var parsedValue = bizagi.util.parseBoolean(value);\r\n            control.find(\".ui-bizagi-render-boolean-radio.yes\")\r\n                .prop(\"checked\", parsedValue === true)\r\n                .toggleClass(\"bz-unchecked\", parsedValue !== true)\r\n                .toggleClass(\"bz-check\", parsedValue === true);\r\n\r\n            control.find(\".ui-bizagi-render-boolean-radio.no\")\r\n                .prop(\"checked\", parsedValue === false)\r\n                .toggleClass(\"bz-unchecked\", parsedValue !== false)\r\n                .toggleClass(\"bz-check\", parsedValue === false);\r\n        }else{\r\n            // Call base\r\n            this._super(value);\r\n        }\r\n    }\r\n});\r\n","/**\r\n*   Name: BizAgi Tablet Render Check\r\n*   Author: Bizagi Mobile Team\r\n*   Comments: Check implementation for tablet\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.check.extend(\"bizagi.rendering.check\", {}, {\r\n\r\n    /**\r\n     * Post render control\r\n     * @returns {} \r\n     */\r\n    postRender: function() {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        self.input = self.getControl().find(\"input\");\r\n\r\n        // Bind changes to set value\r\n        self.input.change(function() {\r\n            var isChecked = self.input.is(\":checked\");\r\n            if (isChecked) {\r\n                self.input.removeClass(\"bz-unchecked\").addClass(\"bz-check\");\r\n            } else {\r\n                self.input.addClass(\"bz-unchecked\").removeClass(\"bz-check\");\r\n            }\r\n            self.setValue(isChecked);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Set display value\r\n     * @param {} value \r\n     * @returns {} \r\n     */\r\n    setDisplayValue: function(value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var input = self.getControl().find(\"input\");\r\n\r\n        self.setValue(value, false);\r\n\r\n        var parsedValue = \"\";\r\n        if (properties.editable) {\r\n            parsedValue = bizagi.util.parseBoolean(value);\r\n        } else {\r\n            parsedValue = bizagi.util.parseBoolean(self.properties.value);\r\n        }\r\n\r\n        input.prop(\"checked\", parsedValue === true);\r\n        input.toggleClass(\"bz-check\", parsedValue === true).toggleClass(\"bz-unchecked\", parsedValue !== true);\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi smartphone Render option select\r\n *   Author: CristianO\r\n *   Date: 29/10/2015\r\n *   Comments:\r\n *   -   Render a single input with a modal view, this modal view contain a\r\n *       selectable list.\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.combo.extend(\"bizagi.rendering.combo\", {}, {\r\n\r\n    /**\r\n    * Generates the read-only render control\r\n    */\r\n    renderReadOnly: function () {        \r\n        var template = this.renderFactory.getTemplate(\"readonlyCombo\");\r\n        return $.kendoTmpl(template, {});\r\n    },\r\n\r\n    /**\r\n     * Initilizing the combo control\r\n     * */\r\n    initializeCombo: function() {\r\n        var self = this;\r\n\r\n        self._super();\r\n\r\n        var properties = self.properties;\r\n        var container = self.getRenderedElement();\r\n        var control = self.getControl();\r\n        var params = {};\r\n\r\n        // Flag to set or not the display value on cascading combos.\r\n        self.showDisplayValue = false;\r\n\r\n        // Getting the input\r\n        self.input = $(\".bz-rn-combo-control\", control);\r\n        if (properties.parentComboValue && properties.parentComboValue != null) {\r\n            params[self.Class.BA_ACTION_PARAMETER_PREFIX + \"parent\"] = properties.parentComboValue;\r\n\r\n            //If is a cascading combo, and has a parent and has its own value, then set the display value.\r\n            self.showDisplayValue = self.parentCombo && self.parentCombo.value && self.parentCombo.value.value !== \"\" && self.properties.value && self.properties.value.value;\r\n        }\r\n\r\n        if (!properties.editable) {\r\n            self.inputSpan = $('.bz-rn-text', control);\r\n            container.addClass(\"bz-rn-non-editable bz-command-edit-inline\");\r\n\r\n            if (self.value != null) {\r\n                self.inputSpan.text(self.value.value || self.value.id);\r\n            }\r\n        } else {\r\n            if (typeof self.initialValueSet !== \"undefined\" && !self.initialValueSet) {\r\n                $.when(self.renderCombo(params)).done(function(html) {\r\n                    self.getControl().html(html);\r\n                    self.input = self.combo = self.getControl();\r\n                    self.configureCombo();\r\n                    self.processLayout(false, self.properties.valueFormat || {});\r\n                });\r\n            } else {\r\n                self.configureCombo();\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Postrender Method\r\n     * */\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        //Initialicing the control\r\n        self.initializeCombo();\r\n\r\n        var properties = self.properties;\r\n        var container = self.getRenderedElement();\r\n\r\n        if (properties.editable) {\r\n            container.addClass(\"bz-command-edit-inline\");\r\n        }\r\n\r\n        self.configureHelpText();\r\n        self._super();\r\n        self.processLayout(false, self.properties.valueFormat || {});\r\n    },\r\n\r\n    /*\r\n    *\r\n    */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var item = self.getValue();\r\n        var template;\r\n\r\n        //self._super();\r\n\r\n        control.closest(\".ui-bizagi-render\").addClass(\"bz-rn-read-only\");\r\n        self.inputSpan = $(\".bz-rn-text\", control);\r\n\r\n        if (item) {\r\n            if (item.value != null && typeof item.value == \"boolean\") {\r\n                if (bizagi.util.parseBoolean(item.value) == true) {\r\n                    item.value = this.getResource(\"render-boolean-yes\");\r\n                } else if (bizagi.util.parseBoolean(item.value) == false) {\r\n                    item.value = this.getResource(\"render-boolean-no\");\r\n                }\r\n            }\r\n            // Returns the cached value from the properties to avoid server side fetching\r\n            (self.getResource(\"render-combo-empty-value\") == item.value || self.getResource(\"render-combo-empty-selection\") == item.value) ? self.inputSpan.text(\"\") : self.inputSpan.text(self.formatItem(item.value));\r\n        } else {\r\n            self.inputSpan.text(\"\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Setting the combo's handlers\r\n     * */\r\n    configureCombo: function() {\r\n        var self = this;\r\n\r\n        self.inputSpan = self.input.find(\".bz-rn-cm-text-label\");\r\n        self.inputSpan.html($(\"option:selected\", self.input).text());\r\n        self.inputSpan.val($(\"option:selected\", self.input).text());\r\n\r\n        $(\".bz-rn-container-combo\", self.control).unbind().bind(\"click\", function() {\r\n            //After click on input combo, remove focus of it.\r\n            self.input.find(\".bz-rn-combo-control\").blur();\r\n            $(self.input).blur();\r\n\r\n            self.input.attr(\"keyboard\", \"disable\");\r\n\r\n            // Creating modal view\r\n            self.processComboData(self.properties.data);\r\n            var template = self.renderFactory.getTemplate('comboModalView');\r\n            var modalViewTemplate = kendo.template(template, {\r\n                useWithBlock: false\r\n            });\r\n            var data = {\r\n                'items': self.properties.data,\r\n                'displayName': self.properties.displayName || \"\",\r\n                \"orientation\": self.properties.orientation\r\n            };\r\n\r\n            var modalView = $($.trim(modalViewTemplate(data)))\r\n\r\n            modalView.kendoMobileModalView({\r\n                close: function() {\r\n                    self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n\r\n                    this.destroy();\r\n                    this.element.remove();\r\n                },\r\n                useNativeScrolling: true,\r\n                modal: false\r\n            });\r\n\r\n            self.configureModalViewHandlers(modalView);\r\n\r\n            self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n            modalView.kendoMobileModalView(\"open\");\r\n\r\n            modalView.closest(\".k-animation-container\").addClass(\"bz-rn-new-modalview-position\");\r\n        });\r\n\r\n        //Setting the Display Value\r\n        /**\r\n         * Case 1: Is a cascading combo and all combos have values (when form is rendering or the form is saved)\r\n         * Case 2: Is a cascading combo and in the parent combo was selected a new value\r\n         * Case 3: Is a normal combo.\r\n         * */\r\n        //        if (self.initializingCascadingCombo && self.properties.value) {\r\n        //            self.onComboChange(self.properties.value);\r\n        //            self.setDisplayValue(self.properties.value);\r\n        //        } else if (self.initializingCascadingCombo != undefined && !self.initializingCascadingCombo && self.parentCombo && self.parentCombo.properties.previousValue && self.parentCombo.properties.value && self.parentCombo.properties.value.value != (self.parentCombo.properties.previousValue.value || self.parentCombo.properties.previousValue[0].value)) {\r\n        //            self.setDisplayValue({ id: \"\", value: \"-------------\" });\r\n        //        } else if (self.initializingCascadingCombo != undefined && !self.initializingCascadingCombo && self.properties.value) {\r\n        //            self.setDisplayValue(self.properties.value);\r\n        //        } else if (self.properties.value) {\r\n        //            self.setDisplayValue(self.properties.value);\r\n        //       }\r\n    },\r\n\r\n    /**\r\n     * Configure the modalView Handlers for the new combo control.\r\n     * */\r\n    configureModalViewHandlers: function(inputContainer){\r\n        var self = this;\r\n\r\n        var closeModalViewPromise = new $.Deferred();\r\n\r\n        //getting combo list elements\r\n        var container = inputContainer.find(\".bz-wp-modalview-results-list li\");\r\n\r\n        //Hide the clear text icon\r\n        inputContainer.find(\".bz-wp-modalview-header-cancel-search\").hide(500);\r\n\r\n        inputContainer.delegate(\"#ui-bizagi-cancel-button\", \"click\", function () {\r\n            closeModalViewPromise.reject();\r\n            inputContainer.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        //Filtering list\r\n        inputContainer.find(\".bz-wp-modalview-header-input-search\").bind('change keypress  keyup change', function () {\r\n            self.filterList(this.value, container, inputContainer);\r\n        });\r\n\r\n        //Cleaning list\r\n        inputContainer.find(\".bz-wp-modalview-header-cancel-search\").bind(\"click\", function () {\r\n            self.filterList(\"\", container, inputContainer);\r\n            inputContainer.find(\".bz-wp-modalview-header-input-search\").val(\"\");\r\n            $(this).hide(500);\r\n        });\r\n\r\n        //Configuring list as a selectable element\r\n        self.list = $(\".bz-wp-modalview-results-list\", inputContainer);\r\n        self.setModalViewDisplayValue(self.properties.value || false);\r\n\r\n        self.inputSpan = inputContainer.find(\".bz-rn-cm-text-label\");\r\n        self.inputSpan.html($(\"li.ui-selected\", self.list).text());\r\n        self.inputSpan.val($(\"li.ui-selected\", self.list).text());\r\n\r\n        //Setting the initial selected display value\r\n        self.list.find(\"li\").bind(\"click\", function () {\r\n            var selectedElements = self.list.find(\".ui-state-active\");\r\n            self._newSelectedElement = this;\r\n\r\n            selectedElements.each(function (index, element) {\r\n                if (self._newSelectedElement.id !== element.id) {\r\n                    $(element).removeClass(\"ui-state-focus ui-selected ui-state-active\");\r\n                }\r\n            });\r\n\r\n            $(this).addClass(\"ui-state-focus ui-selected ui-state-active\");\r\n\r\n            self.input.blur();\r\n            $(\".bz-wp-modalview-header-input-search\", inputContainer).blur();\r\n        });\r\n\r\n        inputContainer.delegate(\".ui-bizagi-apply-button\", \"click\", function () {\r\n            closeModalViewPromise.resolve();\r\n            inputContainer.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        inputContainer.find(\".bz-wp-modalview-close\").bind(\"click\", function () {\r\n            closeModalViewPromise.reject();\r\n            inputContainer.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        $.when(closeModalViewPromise).done(function () {\r\n            var selected = $(\"li.ui-selected\", self.list);\r\n            var value = $(selected).data(\"value\");\r\n            var label = $(selected).text();\r\n\r\n            //Update internal value\r\n            var newValue = {\r\n                id: value,\r\n                value: label\r\n            };\r\n\r\n            //self.setValue(newValue);\r\n            self.selectedValue = newValue.value;\r\n            self.setDisplayValue(newValue);\r\n            //self.changeCombo(newValue.value, newValue);\r\n        }).fail(function() {});\r\n    },\r\n\r\n    /**\r\n     * Filtering list of elements\r\n     * */\r\n    filterList: function (search, $li, inputContainer) {\r\n        if (search !== \"\") {\r\n            inputContainer.find(\".bz-wp-modalview-header-cancel-search\").show(500);\r\n        } else {\r\n            inputContainer.find(\".bz-wp-modalview-header-cancel-search\").hide(500);\r\n        }\r\n\r\n        $li.filter(function () {\r\n            var stringContainer = $(this).text().toUpperCase();\r\n            var stringToSearch = search.toUpperCase();\r\n\r\n            if (stringContainer.indexOf(stringToSearch) >= 0) {\r\n                return $(this);\r\n            } else {\r\n                $(this).hide();\r\n            }\r\n        }).show();\r\n    },\r\n\r\n    actionSave: function () {\r\n        var self = this;\r\n        var selected = this.inputEdition.find(\".bz-rn-combo-selected\");\r\n        var valueItem = selected.find(\">div >span\").html();\r\n        var valueObjet = {\r\n            id: selected.attr(\"id\"),\r\n            value: valueItem\r\n        };\r\n        self.changeCombo(valueItem, valueObjet);\r\n    },\r\n\r\n    /**\r\n     * Setting the selected element.\r\n     * */\r\n    setModalViewDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (self.list && properties.editable && (typeof (value) !== \"undefined\") && value !== null && value.id !== \"\") {\r\n            self.list.find(\"#ui-bizagi-list-\" + value.id)\r\n            .addClass(\"ui-state-focus ui-selected ui-state-active\");\r\n        }\r\n    },\r\n\r\n    processComboData: function(data){\r\n        var self = this;\r\n\r\n        data.forEach(function(value){\r\n            self.validateValue(value);\r\n        });\r\n    },\r\n\r\n    validateValue: function(value){\r\n        var self = this;\r\n\r\n        if (!bizagi.util.isEmpty(value) && ((typeof (value.id) !== \"undefined\") &&  ((typeof value.id === \"number\" && value.id !== null) ||  (typeof value.id === \"string\" && value.id.length > 0)))) {\r\n            var translated = false;//When the parametric entity have a boolean attribute\r\n            if (value.value !== null && typeof value.value === \"boolean\") {\r\n                translated = true;\r\n                if (bizagi.util.parseBoolean(value.value) === true) {\r\n                    value.value = bizagi.localization.getResource(\"render-boolean-yes\");\r\n                } else if (bizagi.util.parseBoolean(value.value) === false) {\r\n                    value.value = bizagi.localization.getResource(\"render-boolean-no\");\r\n                }\r\n            } else if (value.value != null && typeof value.value === \"object\") {\r\n                for (var i = 0, length = value.value.length; i < length; i++) {\r\n                    if (value.value[i] != null && typeof (value.value[i]) === \"boolean\") {\r\n                        if (bizagi.util.parseBoolean(value.value[i]) === true) {\r\n                            value.value[i] = bizagi.localization.getResource(\"render-boolean-yes\");\r\n                        } else if (bizagi.util.parseBoolean(value.value[i]) === false) {\r\n                            value.value[i] = bizagi.localization.getResource(\"render-boolean-no\");\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Setting the display value.\r\n     * */\r\n    setDisplayValue: function(value) {\r\n        if (value && (typeof value === \"object\" && typeof value.label !== \"undefined\")) {\r\n            var comboValue = (value.label != \"\" && !bizagi.util.isNumeric(value.label)) ? value.label : (this.findDataValueById(value.value).value || \"\");\r\n\r\n            if ($.isArray(comboValue)) {\r\n                comboValue = comboValue.join(\" - \");\r\n            }\r\n\r\n            value = ({\r\n                id: value.value,\r\n                value: comboValue\r\n            });\r\n        }\r\n\r\n        var control = this.getControl();\r\n        $(\"input\", control).val(this.formatItem(value.value));\r\n\r\n        //Set Value\r\n        this.setValue(value);\r\n    },\r\n\r\n    /**\r\n     * Cleans the control's data\r\n     * */\r\n    resetData: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        properties.hasLocalData = false;\r\n        properties.data = [];\r\n        properties.remoteDataLoaded = false;\r\n\r\n    },\r\n\r\n    /**\r\n     * Cleans the control's data\r\n     * */\r\n    cleanData: function() {\r\n        var value = {\r\n            id: \"\",\r\n            value: \"\"\r\n        };\r\n        this.setDisplayValue(value);\r\n    },\r\n\r\n    /**\r\n     * Getting the templates\r\n     * */\r\n    getTemplateName: function () {\r\n        return \"combo\";\r\n    },\r\n\r\n    /**\r\n     * Getting the templates\r\n     * */\r\n    getTemplateEditionName: function () {\r\n        return \"edition.combo\";\r\n    }\r\n});","﻿/*\r\n *   Name: Bizagi Tablet Render upload Extension\r\n *   Author: Bizagi Mobile Team\r\n *   Comments:\r\n *   -   This script will redefine the label render class to adjust to smartphones devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.upload.extend(\"bizagi.rendering.upload\", {\r\n    BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n    BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\r\n    QUALITY_PICTURE: 50,\r\n    LIMIT: 1, // limit: The maximum number of multimedia files in the device user can record in a single capture operation.\r\n    EXTENSIONSIMG: [\"image/jpeg\", \"jpeg\", \"image\", \"png\", \"jpg\", \"bmp\"],\r\n    EXTENSIONSFILE: [\"doc\", \"docx\", \"xls\", \"xlsx\", \"ppt\", \"pptx\", \"pdf\", \"zip\", \"rar\", \"txt\"],\r\n    EXTENSIONSVIDEO: [\"video/quicktime\", \"quicktime\", \"qt\", \"mov\"],\r\n    EXTENSIONSAUDIO: [\"audio/wav\", \"audio\", \"wav\", \"mp3\"]\r\n}, {\r\n\r\n    /**\r\n     * Template method to implement in each children to customize each control     \r\n     */\r\n    renderControl: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"upload\");\r\n        var allow_upload = true;\r\n        var items = \"\";\r\n\t\r\n        // Check files extensions\r\n        self.checkExtensions();\r\n\r\n        if (bizagi.util.isCordovaSupported()) {\r\n            allow_upload = self.validOptions && (self.validOptions.image || self.validOptions.video);\r\n        }\r\n\r\n        // Render template\r\n        var html = $.kendoTmpl(template, {\r\n            xpath: bizagi.util.encodeXpath(self.getUploadXpath()),\r\n            editable: properties.editable && allow_upload,\r\n            noFiles: (self.filesCount == 0),\r\n            allow_upload: allow_upload,\r\n            nonSupportedExtension: self.nonSupportedExtension,\r\n            allowSendInMail: properties.allowSendInMail\r\n        });\r\n\r\n        // Render current children       \r\n        for (var i = 0; i < self.filesCount; i++) {\r\n            var file = { id: self.files[i][0], fileName: self.files[i][1] };\r\n            var item = self.renderUploadItem(file);\r\n            items += item;\r\n        }\r\n\r\n\thtml = self.replaceFilesHtml(html, items);\r\n        return html;\r\n    },\r\n\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        if ((!bizagi.util.isCordovaSupported() && !bizagi.util.media.fileAPISupported()) || !properties.editable) {\r\n            self.addEventToOpenSlide();\r\n        } else if (!bizagi.util.isCordovaSupported()) {\r\n            self.activeUploadWebControl();\r\n        } else {\r\n            self.activateUploadNative();\r\n        }\r\n\r\n        // Handler to download the file\r\n        $(\"ul.files\", self.getControl()).on(\"click\", \".ui-bizagi-render-link.button\", function (e) {\r\n            bizagi.loading.start();\r\n            $.when(bizagi.util.media.downloadFile($(this).data(\"url\"), this.title)).fail(function (error) {\r\n                self.executeFormFailHandler(error);\r\n            }).always(function () {\r\n                bizagi.loading.stop();\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n    * Render readonly\r\n    * @returns {}\r\n    */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var container = self.getControl();\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        if (!bizagi.util.isOfflineForm({ context: self }) && typeof (self.files) !== \"undefined\" && self.files.length > 0) {\r\n            var filesLinkElements = container.find(\".ui-bizagi-render-link\");\r\n\r\n            filesLinkElements.on(\"click\", function () {\r\n                bizagi.loading.start();\r\n                $.when(bizagi.util.media.downloadFile($(this).data(\"url\"), this.title)).fail(function (error) {\r\n                    self.executeFormFailHandler(error);\r\n                }).always(function () {\r\n                    bizagi.loading.stop();\r\n                });\r\n            });\r\n        }\r\n    },\r\n\r\n    /**\r\n    * Attach open slide\r\n    * @returns {}\r\n    */\r\n    addEventToOpenSlide: function () {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var container = self.getControl();\r\n\r\n        self.itemAddfile = $(\".bz-rn-upload-show-menu\", container);\r\n        self.itemAddfile.hide();\r\n\r\n        if (!bizagi.util.isCordovaSupported() && !bizagi.util.media.fileAPISupported()) {\r\n            self.element.addClass(\"bz-rn-read-only\");\r\n        }\r\n\r\n        $(\"li\", container).click(function (event) {\r\n            if (mode === \"execution\") {\r\n                bizagi.loading.start();\r\n                // Avoid redirect & download\r\n                event.preventDefault();\r\n                event.stopPropagation();\r\n\r\n                var title = this.title || $(this).data(\"name\");\r\n\r\n                $.when(bizagi.util.media.downloadFile($(this).data(\"url\"), title)).fail(function (error) {\r\n                    self.executeFormFailHandler(error);\r\n                }).always(function () {\r\n                    bizagi.loading.stop();\r\n                });\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n    * Active upload by native mode\r\n    * @returns {}\r\n    */\r\n    activateUploadNative: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var container = self.getControl();\r\n\r\n        self.renderControl();\r\n        self.itemAddfile = $(\".bz-rn-upload-show-menu\", container);\r\n\r\n        if (!bizagi.util.isCordovaSupported() || !properties.editable) {\r\n            self.itemAddfile.hide();\r\n        }\r\n\r\n        // Check files number\r\n        self.checkMaxFiles();\r\n\r\n        // Attach delete option\r\n        self.attachDeleteHandler();\r\n\r\n        // Not has valid extensions\r\n        if (self.validOptions && (!self.validOptions.image && !self.validOptions.video)) {\r\n            $(\"> *\", self.itemAddfile).hide();\r\n            return;\r\n        }\r\n\r\n        var uploadTemplate = self.renderFactory.getTemplate(\"uploadModalView\");\r\n        var kendoTemplate = kendo.template(uploadTemplate, { useWithBlock: false });\r\n\r\n        // Check is offline form\r\n        var isOfflineForm = bizagi.util.isOfflineForm({ context: self });\r\n\r\n        // Creating modal view\r\n        var $modalView = $.trim(kendoTemplate({\r\n            editable: self.properties.editable,\r\n            noFiles: self.properties.noFiles,\r\n            displayName: self.properties.displayName || \"\",\r\n            validExtensions: self.validOptions,\r\n            isOfflineForm: isOfflineForm\r\n        }));\r\n\r\n        self.itemAddfile.bind(\"click\", function (e) {\r\n            var modalView = new kendo.mobile.ui.ModalView($modalView, {\r\n                close: function() {\r\n                    self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n\r\n                    this.destroy();\r\n                    this.element.remove();\r\n                },\r\n                modal: false,\r\n                useNativeScrolling: true\r\n            });\r\n\r\n            self.configureModalViewHandlers(modalView.element);\r\n\r\n            self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n            modalView.open();\r\n        });\r\n    },\r\n\r\n    /**\r\n    * Configure the modalView Handlers for the new combo control.\r\n    * @param {} inputContainer\r\n    * @returns {}\r\n    */\r\n    configureModalViewHandlers: function (inputContainer) {\r\n        var self = this;\r\n\r\n        // Getting combo list elements\r\n        self.listOptions = inputContainer.find(\".bz-rn-upload-options li\");\r\n\r\n        // Setting the initial selected display value\r\n        self.listOptions.bind(\"click\", function () {\r\n            self.applyPlugin($(this).data(\"role\"), this.getBoundingClientRect());\r\n        });\r\n\r\n        inputContainer.find(\".bz-wp-modalview-close\").bind(\"click\", function () {\r\n            if (inputContainer.data(\"kendoMobileModalView\")) {\r\n                inputContainer.data(\"kendoMobileModalView\").close();\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n    * Attach delete option\r\n    * @returns {}\r\n    */\r\n    attachDeleteHandler: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        $(\".bz-rn-upload-delete-icon\", control).bind(\"click\", function () {\r\n            var item = $(this).parent(\".ui-bizagi-render-upload-item\");\r\n            var file = item.data();\r\n\r\n            $.when(self.deleteUploadItem(item, file.id))\r\n                .done(function () {\r\n                    // Remove item\r\n                    item.hide();\r\n                    item.remove();\r\n\r\n                    // Update value\r\n                    self.setValue(self.files, false);\r\n\r\n                    // Check maxFiles\r\n                    self.checkMaxFiles();\r\n\r\n                    // Trigger change\r\n                    self.triggerRenderChange();\r\n                });\r\n        });\r\n    },\r\n\r\n    /**\r\n    * Apply plugin\r\n    * @param {} option\r\n    * @param {} coordinates\r\n    * @returns {}\r\n    */\r\n    applyPlugin: function (option, coordinates) {\r\n        var self = this;\r\n        var resolutionUpload;\r\n\r\n        // If android version is less than 4.4 avoid to show upload sizes due to compatibility with blob files\r\n        var version = bizagi.util.getAndroidVersion();\r\n        var hideUploadSizes = version && version <= 4.4;\r\n\r\n        // Resolution upload menu\r\n        if (hideUploadSizes) {\r\n            resolutionUpload = [\r\n                { \"guid\": 4, \"displayName\": bizagi.localization.getResource(\"workportal-size-original\") }\r\n            ];\r\n        } else {\r\n            resolutionUpload = bizagi.util.media.getImageResolutionItems();\r\n        }\r\n\r\n        // Attach document\r\n        $(\".bz-resolution-container\", self.getControl()).actionSheet({\r\n            actions: resolutionUpload,\r\n            actionClicked: function (action) {\r\n                bizagi.loading.start();\r\n\r\n                $.when(self.resolutionButtonHandler(action.guid)).always(function () {\r\n                    bizagi.loading.stop();\r\n                });\r\n            },\r\n            appear: function (action) {\r\n                self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n            },\r\n            cancelClicked: function (action) {\r\n                self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n            }\r\n        });\r\n\r\n        switch (option) {\r\n            case \"image\":\r\n                // Check is offline form\r\n                var isOfflineForm = bizagi.util.isOfflineForm({ context: self });\r\n\r\n                // Select image\r\n                var popover = new CameraPopoverOptions(coordinates.left, coordinates.top - 20, 200, 100, 4);\r\n                var options = {\r\n                    quality: self.Class.QUALITY_PICTURE,\r\n                    sourceType: Camera.PictureSourceType.PHOTOLIBRARY,\r\n                    popoverOptions: popover\r\n                };\r\n\r\n                navigator.camera.getPicture(function (dataImage) {\r\n                    self.dataImage = dataImage;\r\n                    var extensions = self.Class.EXTENSIONSIMG\r\n                        .concat(self.Class.EXTENSIONSVIDEO);\r\n\r\n                    bizagi.loading.start();\r\n                    self.closeModalView();\r\n\r\n                    $.when(bizagi.util.media.checkMaxSize(dataImage, self.properties))\r\n                        .then(function () {\r\n                            return $.when(bizagi.util.media.getFileDataInfo(self.dataImage))\r\n                                .then(function (file) {\r\n\r\n                                    self.fileProperties = file;\r\n\r\n                                    if (bizagi.util.media.checkFileTypes(file, self.properties, extensions)) {\r\n                                        // \"new Blob\" constructor is not supported in android version 4.2.2\r\n                                        var version = bizagi.util.getAndroidVersion();\r\n\r\n                                        if ((version && version <= 4.2) || isOfflineForm) {\r\n                                            return self.saveImage(self, self.dataImage);\r\n                                        } else {\r\n\r\n                                            if (!bizagi.util.isAndroid()) {\r\n                                                return $.when(bizagi.util.media.modalResolutionUpload()).then(\r\n                                                    function (buttonIndex) {\r\n                                                        if (buttonIndex <= bizagi.util.media.getImageResolutionItems().length) {\r\n                                                            return self.resolutionButtonHandler(buttonIndex);\r\n                                                        }\r\n                                                    });\r\n\r\n                                            } else {\r\n                                                // Force click to show actionsheet menu\r\n                                                $(\".bz-resolution-container\", self.getControl()).click();\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                })\r\n                        }).always(function () {\r\n                            bizagi.loading.stop();\r\n                        });\r\n                }, self.onFail.bind(self), options);\r\n                break;\r\n\r\n            case \"file\":\r\n                // TODO: Add handlers to upload web                \r\n                break;\r\n\r\n            case \"cimage\":\r\n                navigator.camera.getPicture(function (dataImage) {\r\n                    bizagi.loading.start();\r\n                    self.closeModalView();\r\n\r\n                    $.when(bizagi.util.media.checkMaxSize(dataImage, self.properties)).then(function () {\r\n                        return $.when(bizagi.util.media.getFileDataInfo(dataImage)).then(function (file) {\r\n                            self.fileProperties = file;\r\n                            return self.saveImage(self, dataImage);\r\n                        });\r\n                    }).always(function () {\r\n                        bizagi.loading.stop();\r\n                    });\r\n                }, self.onFail.bind(self), {\r\n                    quality: self.Class.QUALITY_PICTURE,\r\n                    targetWidth: 1280,\r\n                    targetHeight: 960,\r\n                    correctOrientation: true\r\n                });\r\n                break;\r\n\r\n            case \"cvideo\":\r\n                navigator.device.capture.captureVideo(function (dataImage) {\r\n                    bizagi.loading.start();\r\n                    self.closeModalView();\r\n\r\n                    $.when(bizagi.util.media.checkMaxSizeVideo(dataImage, self.properties)).then(function () {\r\n                        return self.saveVideo(self, dataImage);\r\n                    }).always(function () {\r\n                        bizagi.loading.stop();\r\n                    });\r\n                }, self.onFail.bind(self), { limit: self.Class.LIMIT });\r\n                break;\r\n\r\n            default:\r\n                break;\r\n        }\r\n    },\r\n\r\n    closeModalView: function () {\r\n        var self = this;\r\n        var modalView = self.listOptions.closest(\".modalview-upload-options\");\r\n\r\n        if (self.listOptions && modalView) {\r\n            if (modalView.data(\"kendoMobileModalView\")) {\r\n                modalView.data(\"kendoMobileModalView\").close();\r\n            }\r\n        }\r\n    },\r\n\r\n    resolutionButtonHandler: function (ordinal) {\r\n        var self = this;\r\n        var actionSelected = ordinal || 0;\r\n\r\n        $(\".ui-bizagi-resolution-container\").css(\"display\", \"none\");\r\n        $(\".ui-bizagi-mask\").remove();\r\n\r\n        // If original, save image normally, if not, reduce quality and size\r\n        if (actionSelected === bizagi.util.media.ResolutionType.ORIGINAL) {\r\n            return self.saveImage(self, self.dataImage);\r\n        } else {\r\n            var resolution = bizagi.util.media.getImageResolution(actionSelected);\r\n\r\n            return $.when(bizagi.util.media.transformImageSize(self.dataImage, resolution))\r\n                .then(function (result) {\r\n                    self.editedImageURL = result.localUrl;\r\n                    self.properties.url = result.base64Image;\r\n\r\n                    return self.saveImage(self, self.dataImage);\r\n                });\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n    * Call the form failhandler with an specific error\r\n    * @param {} error\r\n    * @returns {}\r\n    */\r\n    executeFormFailHandler: function (error) {\r\n        var self = this;\r\n        var errorResponse = error.responseText ? error.responseText : bizagi.localization.getResource(\"workportal-general-error\");\r\n        self.getFormContainer().failHandler(errorResponse);\r\n    },\r\n\r\n    renderUploadItem: function (file) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n        var template = self.renderFactory.getTemplate(\"uploadItem\");\r\n\r\n        // Don't render urls when not running in execution mode\r\n        var url = mode !== \"execution\" ? \"javascript:void(0);\" : self.buildItemUrl(file);\r\n\r\n        var html = $.kendoTmpl(template, {\r\n            url: url,\r\n            image: false,\r\n            allowDelete: properties.allowDelete,\r\n            editable: properties.editable,\r\n            filename: file.fileName,\r\n            id: file.id,\r\n            mode: mode,\r\n            isNativeContext: bizagi.util.isNativePluginSupported(),\r\n            isCordovaSupported: bizagi.util.isCordovaSupported()\r\n        });\r\n\r\n        return html;\r\n\r\n    },\r\n\r\n    getTemplateName: function () {\r\n        return \"upload\";\r\n    },\r\n\r\n    getTemplateItemName: function () {\r\n        return \"uploadItem\";\r\n    },\r\n\r\n    getTemplateEditionName: function () {\r\n        return \"edition.upload\";\r\n    },\r\n\r\n    getTemplateEditionMenu: function () {\r\n        return \"edition.upload.menu\";\r\n    },\r\n\r\n    /**\r\n    * Send image using HTTP\r\n    * @param {} context\r\n    * @param {} dataImage\r\n    * @returns {}\r\n    */\r\n    saveImage: function (context, dataImage) {\r\n        var self = context;\r\n        var params = {};\r\n        var addParams = self.buildAddParams();\r\n        var fileName = self.fileProperties.name;\r\n\r\n        if (self.editedImageURL) {\r\n            params.dataFile = self.editedImageURL;\r\n        } else {\r\n            params.dataFile = self.fileProperties.url;\r\n        }\r\n\r\n        addParams.queueID = \"q_\" + bizagi.util.encodeXpath(self.getUploadXpath());\r\n        params.data = addParams;\r\n        params.options = new FileUploadOptions();\r\n        params.options.fileKey = \"file\";\r\n        params.options.fileName = fileName;\r\n        params.options.mimeType = \"image/jpeg\";\r\n        params.options.uploadKey = { key: addParams[\"h_xpath\"] };\r\n        params.options.addUrl = self.properties.addUrl;\r\n\r\n        //Cleans variables related previous gallery uploads\r\n        self.editedImageURL = null;\r\n        self.fileProperties = null;\r\n\r\n        // Fix android 4.4 getting images from recent folder\r\n        params.dataFile = bizagi.util.media.getImagePath(params.dataFile);\r\n\r\n        return $.when(bizagi.util.media.uploadFile(params)).done(function (r) {\r\n            var response = JSON.parse(decodeURIComponent(r.response));\r\n            if (response.type === \"error\") {\r\n                bizagi.showMessageBox(response.message, response.errorType);\r\n            } else {\r\n                self.onUploadFileCompleted(context, response);\r\n            }\r\n        }).fail(function (error) {\r\n            var response = JSON.parse(decodeURIComponent(error.responseText));\r\n            bizagi.showMessageBox(response.message, response.type);\r\n        });\r\n    },\r\n\r\n    /**\r\n    * saveVideo\r\n    * @param {} context\r\n    * @param {} dataVideo\r\n    * @returns {}\r\n    */\r\n    saveVideo: function (context, dataVideo) {\r\n        var self = context;\r\n        var params = {};\r\n        var addParams = self.buildAddParams();\r\n\r\n        addParams.queueID = \"q_\" + bizagi.util.encodeXpath(self.getUploadXpath());\r\n\r\n        params.data = addParams;\r\n        params.options = new FileUploadOptions();\r\n        params.options.fileName = dataVideo[0].name;\r\n        params.options.mimeType = \"video/quicktime\";\r\n        params.options.uploadKey = { key: addParams[\"h_xpath\"] };\r\n        params.options.addUrl = self.properties.addUrl;\r\n        params.dataFile = dataVideo[0].fullPath;\r\n\r\n        return $.when(bizagi.util.media.uploadFile(params)).done(function (r) {\r\n            var response = JSON.parse(decodeURIComponent(r.response));\r\n            if (response.type === \"error\") {\r\n                bizagi.showMessageBox(response.message, response.errorType);\r\n            } else {\r\n                self.onUploadFileCompleted(context, response);\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Management fail messages\r\n     */\r\n    onFail: function (error) {                \r\n        var messageError = bizagi.util.processFailMessage(error);                \r\n\r\n        if (typeof (messageError) == \"string\" && messageError.indexOf(\"No Activity found to handle Intent\") !== -1) {\r\n            var hasResource = bizagi.util.isValidResource(\"render-upload-error-media-app\");\r\n            var message = hasResource ? bizagi.localization.getResource(\"render-upload-error-media-app\") : \"Your device does not have an app to execute this action.\";\r\n\r\n            bizagi.showMessageBox(message);\r\n        }\r\n    },\r\n\r\n    onUploadFileCompleted: function (context, result) {\r\n        var self = context;\r\n        var control = self.getControl();\r\n        var uploadWrapper = $(\"ul.files\", control);                \r\n\r\n        if (result.id && result.fileName) {\r\n            // Locate it before the upload wrapper\r\n            var newItem = self.renderUploadItem(result);\r\n            $(uploadWrapper).append(newItem);\r\n\r\n            // Increment counter\r\n            self.filesCount = self.filesCount + 1;\r\n\r\n            // Copy the files value but not its reference\r\n            var files = self.files.slice();\r\n\r\n            //Add the new item to this temporal array\r\n            files.push([result.id, result.fileName]);\r\n\r\n            // Update value\r\n            self.setValue(files, true);\r\n\r\n            // Check maxFiles\r\n            self.checkMaxFiles();\r\n\r\n            control.find(\".ui-bizagi-render-upload-item-no-upload\").hide();\r\n\r\n            //Add delete functionality just for elements included in common forms, not inside columns\r\n            if (self.properties.type !== \"columnUpload\" && (self.properties.allowDelete && self.properties.editable)) {\r\n                self.attachDeleteHandler();\r\n            }\r\n\r\n            self.editedImageURL = null;\r\n        } else {            \r\n            bizagi.showMessageBox(result.message, \"Error\");\r\n        }\r\n    },   \r\n\r\n    /**\r\n    * Checks if the total files uploaded reachs the maximun supported\r\n    * @returns {}\r\n    */\r\n    checkMaxFiles: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n        var maxFiles = properties.maxfiles;\r\n        var actualFiles = properties.value ? properties.value.length : 0;\r\n\r\n        if (properties.editable) {\r\n            if (maxFiles !== 0 && ((self.filesCount >= maxFiles && actualFiles >= maxFiles))) {\r\n                self.itemAddfile.hide();\r\n            } else {\r\n                self.itemAddfile.show();\r\n            }\r\n        } else {\r\n            //Checks if the files count is equals to 0, to show the no files dialog\r\n            if (self.filesCount == 0) {\r\n                $(\"#no-files\", control).show();\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n    * Checks the file Extension in each filetype that the device supports\r\n    * @returns {}\r\n    */\r\n    checkExtensions: function() {\r\n        var self = this;\r\n        var validExtensions = self.properties.validExtensions || \"\";\r\n\r\n        //Helps to get the non-supported extensions for mobile\r\n        var nonSupportedExtensionsArr = [];\r\n\r\n        // Remove spaces in the list\r\n        validExtensions = validExtensions.replace(/\\s+/g, \"\").toLowerCase();\r\n        validExtensions = validExtensions.split(\";\");\r\n\r\n        // Initizalice the nonSupportedExtension element\r\n        self.nonSupportedExtension = \"\";\r\n\r\n        self.validOptions = { video: false, image: false, file: false };\r\n\r\n        if (typeof (validExtensions) === \"undefined\" || validExtensions[0] === \"\") {\r\n            self.validOptions = { video: true, image: true, file: false };\r\n\r\n            return;\r\n        }\r\n\r\n        if (validExtensions.length === 1 && validExtensions[0].indexOf(\"*.*\") !== -1) return;\r\n\r\n        for (var index = 0, length = validExtensions.length; index < length; index++) {\r\n            validExtensions[index] = validExtensions[index].replace(\"*.\", \"\");\r\n\r\n            /*if (self.Class.EXTENSIONSFILE.toString().indexOf(validExtensions[index]) >= 0) {\r\n                self.validOptions.file = true;\r\n            } else */\r\n            if (self.Class.EXTENSIONSIMG.toString().indexOf(validExtensions[index]) >= 0) {\r\n                self.validOptions.image = true;\r\n            } else if (self.Class.EXTENSIONSVIDEO.toString().indexOf(validExtensions[index]) >= 0) {\r\n                self.validOptions.video = true;\r\n            } else {\r\n                //If the extension is not part or any category, it is stored in nonSupportedExtensions array\r\n                nonSupportedExtensionsArr.push(validExtensions[index]);\r\n            }\r\n        }\r\n\r\n        // Adjust file extension, in order to make it multiline & Stores the non-supported extensions\r\n        self.nonSupportedExtension = nonSupportedExtensionsArr.join(\", \") || \"\";\r\n    },\r\n\r\n    /**\r\n    * Active upload web control\r\n    * @returns {}\r\n    */\r\n    activeUploadWebControl: function () {\r\n        var self = this;\r\n        var container = self.getControl();\r\n        var uploadfile = $(\".bz-rn-upload-web\", container);\r\n        var file = $(\".bz-rn-upload-show-menu span.bz-cm-icon\", container);\r\n\r\n        self.itemAddfile = $(\".bz-rn-upload-show-menu\", container);\r\n\r\n        // Check maximum files number\r\n        if (self.itIsMaxNumberFilesReached()) {\r\n            self.itemAddfile.hide();\r\n        }\r\n\r\n        self.itemAddfile.click(function () {\r\n            uploadfile.click();\r\n        });\r\n\r\n        // attach events to file-icon\r\n        file.addClass(\"bz-rn-upload-native\");\r\n        file.on(\"click\", function () {\r\n            uploadfile.click();\r\n        });\r\n\r\n        // Attach event to upload-control\r\n        uploadfile.on(\"change\", function() {\r\n            var that = this;\r\n            var dataFile = that.files[0];\r\n            var extensions = self.Class.EXTENSIONSIMG.concat(self.Class.EXTENSIONSFILE, self.Class.EXTENSIONSVIDEO);\r\n\r\n            dataFile.fullPath = that.value;\r\n\r\n            bizagi.loading.start();\r\n\r\n            if (bizagi.util.media.checkMaxSizeFile(dataFile, self.properties) && bizagi.util.media.checkFileTypes(dataFile, self.properties, extensions)) {\r\n\r\n                $.when(self.processUploadFile(dataFile))\r\n                    .then(function(result) {\r\n                        self.onUploadFileCompleted(self, JSON.parse(decodeURIComponent(result)));\r\n                    }).fail(function(error) {\r\n                        if (error.statusText !== \"Unauthorized\" || error.statusText.toLowerCase() !== \"ok\") {\r\n                            bizagi.showMessageBox(self.getResource(\"workportal-widget-admin-language-error\"));\r\n                        }\r\n                    }).always(function() {\r\n                        bizagi.loading.stop();\r\n                    });\r\n            } else {\r\n                bizagi.loading.stop();\r\n            }\r\n\r\n            // Clearing input Values\r\n            $(that).val(\"\");\r\n        });\r\n\r\n        // Check files number\r\n        self.checkMaxFiles();\r\n\r\n        // Attach delete option\r\n        self.attachDeleteHandler();\r\n    },\r\n\r\n    /**\r\n    * Check the maximun file than can be uploaded\r\n    * @returns {}\r\n    */\r\n    itIsMaxNumberFilesReached: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var maxFiles = properties.maxfiles;\r\n        var actualFiles = properties.value ? properties.value.length : 0;\r\n\r\n        return maxFiles !== 0 && (actualFiles >= maxFiles);\r\n    },\r\n\r\n    /**\r\n    * Build add params to send to the server\r\n    * @param {} dataFile\r\n    * @returns {}\r\n    */\r\n    buildAddFileParams: function (dataFile) {\r\n        var self = this;\r\n        var prefix = self.Class.BA_CONTEXT_PARAMETER_PREFIX;\r\n        var properties = self.properties;\r\n\r\n        // Get form data for POSTing\r\n        var formData = new FormData();\r\n        var form = self.getFormContainer();\r\n\r\n        // Build add params to send to the server\r\n        formData.append(prefix + \"xpath\", self.getUploadXpath());\r\n        formData.append(prefix + \"idRender\", properties.id);\r\n        formData.append(prefix + \"xpathContext\", properties.xpathContext);\r\n        formData.append(prefix + self.Class.BA_PAGE_CACHE, properties.idPageCache);\r\n        formData.append(self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\", form.properties.sessionId);\r\n        formData.append(properties.xpath, dataFile);\r\n\r\n        if (properties.contexttype) {\r\n            formData.append(prefix + \"contexttype\", properties.contexttype);\r\n        }\r\n\r\n        try {\r\n            if (typeof (BIZAGI_SESSION_NAME) !== \"undefined\") {\r\n                formData.append(BIZAGI_SESSION_NAME, form.properties.sessionId);\r\n            } else {\r\n                formData.append(\"JSESSIONID\", form.properties.sessionId);\r\n            }\r\n        } catch (e) {\r\n            formData.append(\"JSESSIONID\", form.properties.sessionId);\r\n        }\r\n\r\n        return formData;\r\n    },\r\n\r\n    /**\r\n    * Process an upload file into the server\r\n    * @param {} context\r\n    * @param {} dataFile\r\n    * @returns {}\r\n    */\r\n    processUploadFile: function(dataFile) {\r\n        var data = { url: this.properties.addUrl, formData: this.buildAddFileParams(dataFile) };\r\n        return this.dataService.processUploadFile(data);\r\n    },\r\n\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        var items = $(\".ui-bizagi-render-upload-item\", self.getControl());\r\n\r\n        items.each(function (index, item) {\r\n            item = $(item);\r\n            var file = item.data();\r\n            $.when(self.deleteUploadItem(item, file.id)).done(function () {\r\n                // Remove item\r\n                item.hide();\r\n                item.remove();\r\n\r\n                // Update value\r\n                self.setValue(self.files, false);\r\n\r\n                // Check maxFiles\r\n                self.checkMaxFiles();\r\n\r\n                // Trigger change\r\n                self.triggerRenderChange();\r\n            });\r\n        });\r\n    }\r\n});","/*\r\n*   Name: BizAgi Tablet Render upload Extension\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This script will redefine the label render class to adjust to smartphones devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.upload.extend(\"bizagi.rendering.upload.offline\", {\r\n    BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n    BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\r\n    QUALITY_PICTURE: 50,\r\n    LIMIT: 1, // limit: The maximum number of multimedia files in the device user can record in a single capture operation.\r\n    EXTENSIONSIMG: [\"image/jpeg\", \"jpeg\", \"image\", \"png\", \"jpg\", \"bmp\"],\r\n    EXTENSIONSFILE: [\"doc\", \"docx\", \"xls\", \"xlsx\", \"ppt\", \"pptx\", \"pdf\", \"zip\", \"rar\", \"txt\"],\r\n    EXTENSIONSVIDEO: [\"video/quicktime\", \"quicktime\", \"qt\", \"mov\"],\r\n    EXTENSIONSAUDIO: [\"audio/wav\", \"audio\", \"wav\", \"mp3\"]\r\n}, {\r\n    postRender: function () {\r\n        var self = this;       \r\n\r\n        if (!bizagi.util.isCordovaSupported() || !self.properties.editable) {\r\n            self.addEventToOpenSlide();\r\n        } else {\r\n            self.activateUploadNative();\r\n        }\r\n\r\n        \r\n\r\n        // Attach Events\r\n        self.atachOpenFileEvent();\r\n        self.configureHelpText();\r\n    },\r\n\r\n    /**\r\n     * Attach open slide\r\n     * @returns {} \r\n     */\r\n    addEventToOpenSlide: function () {        \r\n        this.itemAddfile = $(\".bz-rn-upload-show-menu\", this.getControl());\r\n        this.itemAddfile.hide();\r\n    },\r\n\r\n    atachOpenFileEvent: function() {\r\n        var self = this;\r\n        // Handler to open or download the file\r\n        $(\"ul.files\", self.getControl()).on(\"click\", \".ui-bizagi-render-link.button\", function (e) {\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n            var dataIndex = $(this).data(\"index\");\r\n            var selectedValue = typeof(dataIndex) == \"number\" ? self.properties.value[dataIndex] : null;\r\n\r\n\t\t\tif (selectedValue){\r\n\t\t\t\tvar fileData =  selectedValue[1] ? selectedValue[1].value : \"\";\r\n\t\t\t\tvar fileMimeType =  selectedValue[2] ? selectedValue[2].value : \"image/jpeg\";\r\n\t\t\t\t\r\n\t\t\t\tbizagi.loading.start();\r\n\t\t\t\t$.when(bizagi.util.media.openOfflineFile(fileData, fileMimeType, this.title)).fail(function (error) {\r\n                    bizagi.showMessageBox(self.getResource(\"workportal-widget-admin-language-error\"));\r\n\t\t\t\t}).always(function () {\r\n\t\t\t\t\tbizagi.loading.stop();\r\n\t\t\t\t});\r\n\t\t\t}\r\n        });\r\n    },\r\n\r\n    /**  \r\n     *  Template method to implement in each children to customize each control\r\n     * @returns {} \r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n        var allow_upload = true;        \r\n        var items = \"\";\r\n        var template = self.renderFactory.getTemplate(\"upload\");\r\n\r\n        // Check files extensions\r\n        self.checkExtensions();\r\n        \r\n        if (bizagi.util.isCordovaSupported()) {\r\n            allow_upload = self.validOptions && self.validOptions.image;\r\n        }     \r\n\t\r\n        var maxFileSizeOfProperty = Number(self.properties.maxSize) || 1048576;\r\n        var maxFileSizeOfUser = typeof (BIZAGI_SETTINGS) !== \"undefined\" && typeof (BIZAGI_SETTINGS.UploadMaxFileSize) !== \"undefined\" ? Number(BIZAGI_SETTINGS.UploadMaxFileSize) : 1048576;\r\n\r\n        self.properties.maxSize = maxFileSizeOfProperty < maxFileSizeOfUser ? maxFileSizeOfProperty : maxFileSizeOfUser;\r\n\r\n        // Render template\r\n        var html = $.kendoTmpl(template, {\r\n            xpath: bizagi.util.encodeXpath(self.getUploadXpath()),\r\n            editable: self.properties.editable && allow_upload,\r\n            noFiles: (self.filesCount === 0),\r\n            allow_upload: allow_upload,\r\n            validExtensions: self.properties.validExtensions,\r\n            nonSupportedExtension: self.nonSupportedExtension,\r\n            allowSendInMail: self.properties.allowSendInMail\r\n        });\r\n\r\n        // Render current children        \r\n        for (var i = 0, length = self.filesCount; i < length; i++) {\r\n            var item = self.renderUploadItem(self.files[i],i);\r\n            items += item;\r\n        }\r\n\r\n        html = self.replaceFilesHtml(html, items);\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Render readonly\r\n     * @returns {} \r\n     */\r\n    postRenderReadOnly: function () {        \r\n        this._super();\r\n        this.atachOpenFileEvent();\r\n    },\r\n\r\n    /**\r\n     * Active upload by native mode\r\n     * @returns {} \r\n     */\r\n    activateUploadNative: function () {        \r\n        this._super();\r\n    },\r\n\r\n    getTemplateName: function () {\r\n        return \"upload\";\r\n    },\r\n\r\n    getTemplateItemName: function () {\r\n        return \"uploadItem\";\r\n    },\r\n\r\n    getTemplateEditionName: function () {\r\n        return \"edition.upload\";\r\n    },\r\n\r\n    getTemplateEditionMenu: function () {\r\n        return \"edition.upload.menu\";\r\n    },\r\n\r\n    saveImage: function(context, dataImage) {\r\n        var self = this;\r\n\r\n        // Fix android 4.4 getting images from recent folder        \r\n        dataImage = bizagi.util.media.getImagePath(dataImage);\r\n\r\n        // Load image\r\n        self.getDataUri(dataImage, function(dataUrl) {            \r\n            var fileExtension = self.fileProperties ? self.fileProperties.extension: \"\";\r\n            var fileName = bizagi.util.uniqueID() + fileExtension;\r\n\r\n            self.onUploadFileCompletedOffline(fileName, dataUrl);\r\n        });\r\n    },\r\n   \r\n   /**\r\n    * Create an offline image\r\n    * @param {} context \r\n    * @param {} url \r\n    * @param {} callback \r\n    * @returns {} \r\n    */\r\n    getDataUri: function(path, callback) {\r\n        var self = this;\r\n        var xhr = new XMLHttpRequest();\r\n\r\n        try {\r\n\r\n            xhr.onload = function() {\r\n                var reader = new FileReader();\r\n\r\n                reader.onloadend = function() {\r\n                    var content = reader.result;\r\n                    callback(content);\r\n                }\r\n                reader.readAsDataURL(xhr.response);\r\n            };\r\n\r\n            xhr.open(\"GET\", path);\r\n            xhr.responseType = \"blob\";\r\n            xhr.send();\r\n\r\n        } catch (error) {\r\n            callback(\"\");\r\n        }\r\n    },\r\n\r\n    saveVideo: function (context, dataVideo) {\r\n        var self = context;\r\n\r\n        window.resolveLocalFileSystemURL(dataVideo[0].fullPath, function (fileEntry) {\r\n            fileEntry.file(function (file) {\r\n                var reader = new FileReader();\r\n\r\n                reader.onloadend = function (evt) {\r\n                    var fileExtension = bizagi.util.media.getFileExtension(dataVideo[0].name);\r\n                    var fileName = bizagi.util.uniqueID() + fileExtension;\r\n\r\n                    self.onUploadFileCompletedOffline(fileName, evt.target.result);\r\n                };\r\n\r\n                reader.readAsDataURL(file);\r\n            }, self.failReadFile);\r\n        }, self.failReadFile);\r\n    },\r\n\r\n    renderUploadItem: function (objectUpload, index) {\r\n        var self = this;        \r\n        var mode = self.getMode();\r\n        var template = self.renderFactory.getTemplate(\"uploadItem\");\r\n\r\n        var html = $.kendoTmpl(template, {\r\n            url: \"javascript:void(0);\",\r\n            image: false,\r\n            allowDelete: self.properties.allowDelete || false,\r\n            id: bizagi.util.randomNumber(),\r\n            mode: mode,\r\n            editable: self.properties.editable,\r\n            filename: objectUpload[0].value,\r\n            isNativeContext: false,\r\n            isCordovaSupported: bizagi.util.isCordovaSupported(),\r\n            index:index\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * Collect Data\r\n     * @param {} renderValues \r\n     * @returns {} \r\n     */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n\r\n        if (self.filesCount > 0) {\r\n            renderValues[self.properties.xpath] = self.files;\r\n        } else if (self.properties.method === \"delete\") {\r\n            renderValues[self.properties.xpath] = [];\r\n\r\n            delete self.properties.method;\r\n        }\r\n    },\r\n\r\n    onUploadFileCompletedOffline: function (name, dataimage) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var uploadWrapper = $(\"ul.files\", control);\r\n        var dataUrltoSave = dataimage.replace(/^data:.*;base64,/, \"\");\r\n\t\tvar properties = self.properties;\r\n\t\tvar dataMimeType = dataimage.match(/data:([a-zA-Z0-9]+\\/[a-zA-Z0-9-.+]+).*,.*/);\r\n        dataMimeType = (dataMimeType && dataMimeType.length) ? dataMimeType[1] : \"image/jpeg\";\r\n\r\n        var fileToSave = [\r\n            { xpath: \"fileName\", DataType: \"15\", value: name },\r\n            { xpath: \"data\", DataType: \"19\", value: dataUrltoSave },\r\n            { xpath: \"mimeType\", DataType : \"15\" , value : dataMimeType}\r\n        ];\r\n\r\n        // Locate it before the upload wrapper\r\n        var newItem = self.renderUploadItem(fileToSave,self.filesCount);\r\n        $(uploadWrapper).append(newItem)\r\n\r\n        // Copy the files value but not its reference\r\n        var files = self.files.slice();\r\n\r\n        //Add the new item to this temporal array\r\n        files.push(fileToSave);\r\n\r\n        // Increment counter\r\n        self.filesCount = self.filesCount + 1;\r\n\r\n        // Update value\r\n        self.setValue(files, false);\r\n\r\n        // Check maxFiles\r\n        self.checkMaxFiles();\r\n\r\n        self.triggerRenderChange();\r\n\r\n        control.find(\".ui-bizagi-render-upload-item-no-upload\").hide();\r\n\r\n        if (properties.allowDelete && properties.editable) {\r\n            self.attachDeleteHandler();\r\n        }\r\n\r\n        // Close modalview\r\n        self.closeModalView();\r\n        bizagi.util.tablet.stopLoading();\r\n    },\r\n\r\n    failReadFile: function (evt) {\r\n        try {\r\n            bizagi.log(\"Error code: \" + evt.target.error.code);\r\n        } catch (e) {\r\n        }\r\n    },\r\n\r\n    onFail: function (error) {\r\n        this._super(error);\r\n        this.closeModalView();\r\n    },\r\n\r\n    checkMaxFiles: function () {\r\n        bizagi.rendering.upload.prototype.checkMaxFiles.apply(this, arguments);\r\n    },\r\n\r\n    checkExtensions: function () {\r\n        var self = this;\r\n        var validExtensions = self.properties.validExtensions || \"\";\r\n\r\n        //Helps to get the non-supported extensions for mobile\r\n        var nonSupportedExtensionsArr = [];\r\n\r\n        // Remove spaces in the list\r\n        validExtensions = validExtensions.replace(/\\s+/g, \"\").toLowerCase();\r\n        validExtensions = validExtensions.split(\";\");\r\n\r\n        // Initialize the nonSupportedExtension element\r\n        self.nonSupportedExtension = \"\";\r\n\r\n        self.validOptions = { video: false, image: false, file: false };\r\n\r\n        if (typeof (validExtensions) === \"undefined\" || validExtensions[0] === \"\") {\r\n            self.validOptions.image = true;\r\n\r\n            return;\r\n        }\r\n\r\n        if (validExtensions.length === 1 && validExtensions[0].indexOf(\"*.*\") !== -1) return;\r\n\r\n        for (var index = 0, length = validExtensions.length; index < length; index++) {\r\n            validExtensions[index] = validExtensions[index].replace(\"*.\", \"\");\r\n\r\n            if (self.Class.EXTENSIONSIMG.toString().indexOf(validExtensions[index]) >= 0) {\r\n                self.validOptions.image = true;\r\n            } else {\r\n                // If the extension is not part or any category, it is stored in nonSupportedExtensions array\r\n                nonSupportedExtensionsArr.push(validExtensions[index]);\r\n            }\r\n        }\r\n\r\n        // Adjust file extension, in order to make it multiline & Stores the non-supported extensions\r\n        self.nonSupportedExtension = nonSupportedExtensionsArr.join(\", \") || \"\";\r\n    },\r\n\r\n    checkMaxSize: function (objectUri) {        \r\n        return bizagi.util.media.checkMaxSize(objectUri, this.properties);\r\n    },\r\n\r\n    checkMaxSizeVideo: function (objectVideo) {        \r\n        return bizagi.util.media.checkMaxSizeVideo.apply(objectVideo, this.properties);\r\n    },\r\n\r\n    /**  \r\n     * This render cannot be sent because it is full ajax\r\n     * @returns {} \r\n     */\r\n    canBeSent: function () {\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * Attach delete option & Removes a file from the upload control\r\n     * @returns {} \r\n     */\r\n    attachDeleteHandler: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        $(\".bz-rn-upload-delete-icon\", control).bind(\"click\", function () {\r\n            var context = $(this);\r\n            var item = context.parent(\".ui-bizagi-render-upload-item\");\r\n            var file = item.data();\r\n            var fileIndex = item.index();\r\n\r\n            // Substract counter\r\n            self.filesCount = self.filesCount - 1;\r\n\r\n            if (self.filesCount === 0) {\r\n                self.properties.method = \"delete\";\r\n            }\r\n\r\n            // Remove from local collection\r\n            self.files = $.grep(self.files, function (fileItem, index) {\r\n                return (index !== fileIndex && fileItem !== file.name);\r\n            });\r\n\r\n            // Remove item\r\n            item.hide();\r\n            item.remove();\r\n\r\n            // Update value\r\n            self.setValue(self.files, false);\r\n\r\n            // Check maxFiles\r\n            self.checkMaxFiles();\r\n\r\n            // Trigger change\r\n            self.triggerRenderChange();\r\n        });\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Tablet Render Grid Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the grid render class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.grid.extend(\"bizagi.rendering.grid\", {\r\n    GRID_PAGE_SIZE: 10\r\n}, {\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        var self = this;\r\n        var data = params.data;\r\n\r\n        // Create a single instance for each cell\r\n        data.properties.singleInstance = false;\r\n\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Create a data-structure to keep track of each cell properties\r\n        this.cellMetadata = {};\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        var form = self.getFormContainer();\r\n\r\n        // If not helptext configured, Just apply display-type: vertical, align it to the left\r\n        if (self.properties.helpText && self.properties.helpText != null && self.properties.helpText != \"\") {\r\n            properties.displayType = \"value\";\r\n        } else {\r\n            properties.displayType = \"vertical\";\r\n        }\r\n\r\n        properties.labelAlign = \"left\";\r\n\r\n        if (properties.groupBy || properties.groupSummary) {\r\n            // Add warning\r\n            form.addWarning(self.getResource(\"render-tablet-warning-grid\"));\r\n        }\r\n    },\r\n\r\n    /* method overrides\r\n    *  from base or virtual\r\n    */\r\n\r\n    /*\r\n    *   Update or init the element data\r\n    */\r\n    initializeData: function (data) {\r\n\r\n        // Create a single instance for each cell\r\n        data.properties.singleInstance = false;\r\n\r\n        // Call base\r\n        this._super(data);\r\n    },\r\n\r\n    /*\r\n    * Updates manually the affected cell \r\n    */\r\n    updateAffectedCellManually: function () {\r\n    },\r\n\r\n    /*\r\n    * Get the row index using the key as a reference\r\n    */\r\n    getRowIndexByKey: function () {\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        self.initialLoadDone = false;\r\n        self.isPaginatorActive = false;\r\n\r\n        // Call base \r\n        self._super();\r\n\r\n        // Find component holder\r\n        self.grid = $(\">div\", control);\r\n\r\n        // Hide common label\r\n        self.getLabel().hide();\r\n\r\n        // Grid plugin\r\n        self.applyGridPlugin();\r\n\r\n        // Set initial data\r\n        if (properties.data) {\r\n            self.updateData(properties.data);\r\n\r\n            // Trigger change in order to start up the actions when the controls is ready\r\n            $.when(self.ready())\r\n                .done(function () {\r\n                    self.triggerRenderChange({ changed: false });\r\n                });\r\n        }\r\n\r\n        // Execute pending actions\r\n        self.initialLoadDone = true;\r\n\r\n        for (var i in self.pendingActions) {\r\n            if (self.pendingActions.hasOwnProperty(i)) {\r\n                self.pendingActions[i].method.apply(self, self.pendingActions[i].arguments);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     * @returns {} \r\n     */\r\n    applyGridPlugin: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var mode = self.getMode();\r\n        var grid = self.grid;\r\n\r\n        // Check is offline form        \r\n        var isOfflineForm = bizagi.util.isOfflineForm({ context: self });\r\n\r\n        // Build column metadata\r\n        var columns = self.buildColumnModel();\r\n    \r\n        var columnsTotalizers = jQuery.grep(columns, function (a) {\r\n            return (a.summarizeBy);\r\n        });\r\n\r\n        // Apply grid plugin\r\n        grid.bizagi_grid_tablet({\r\n            columns: columns,\r\n            maxColumns: 4,\r\n            title: properties.displayName,\r\n            isOfflineForm: isOfflineForm || false,\r\n            mode: mode,\r\n            template: {\r\n                grid: self.renderFactory.getTemplate(\"bizagi.grid.grid\"),\r\n                waiting: self.renderFactory.getTemplate(\"bizagi.grid.waiting\"),\r\n                table: self.renderFactory.getTemplate(\"bizagi.grid.table\"),\r\n                emptyTable: self.renderFactory.getTemplate(\"bizagi.grid.table.empty\"),\r\n                column: self.renderFactory.getTemplate(\"bizagi.grid.column\"),\r\n                specialColumn: self.renderFactory.getTemplate(\"bizagi.grid.column.special\"),\r\n                row: self.renderFactory.getTemplate(\"bizagi.grid.row\"),\r\n                rowButtons: self.renderFactory.getTemplate(\"bizagi.grid.row.buttons\"),\r\n                cell: self.renderFactory.getTemplate(\"bizagi.grid.cell\"),\r\n                specialCell: self.renderFactory.getTemplate(\"bizagi.grid.cell.special\"),\r\n                pager: self.renderFactory.getTemplate(\"bizagi.grid.pager\"),\r\n                buttons: self.renderFactory.getTemplate(\"bizagi.grid.buttons\"),\r\n                dynamicPager: self.renderFactory.getTemplate(\"bizagi.grid.dynamicpager\"),\r\n                totalizer: self.renderFactory.getTemplate(\"bizagi.grid.totalizer\")\r\n            },\r\n            actions: {\r\n                add: properties.allowAdd, //|| properties.inlineAdd,\r\n                edit: (properties.allowEdit && properties.withEditForm && properties.data != null),\r\n                remove: properties.allowDelete,\r\n                inlineAdd: false, //properties.inlineAdd,\r\n                allowMore: properties.allowMore,\r\n                enableXlsExport: false,\r\n                enablePdfExport: false,\r\n                hasTotalizer: columnsTotalizers.length > 0 && properties.data.rows.length > 0 ? true : false\r\n            },\r\n            pageRequested: function (ui) {\r\n                if (mode != \"execution\") return;\r\n                self.fetchData(ui.page, ui.sortBy, ui.sortType);\r\n            },\r\n            sortRequested: function (ui) {\r\n                if (mode != \"execution\") return;\r\n                self.fetchData(ui.page, ui.sortBy, ui.sortType);\r\n            },\r\n            drawCell: function (ui) {\r\n                return self.drawCell(ui.column, ui.key, ui.value, ui.isNewRow);\r\n            },\r\n            cellReady: function (ui) {\r\n                return self.onCellReady(ui.column, ui.key, ui.cell, ui.isNewRow);\r\n            },\r\n            rowSelected: function (ui) {\r\n                if (mode != \"execution\") return;\r\n                self.triggerHandler(\"rowSelected\", { id: ui.key, data: ui });\r\n            },\r\n            addRow: function (ui) {\r\n                if (mode != \"execution\") return;\r\n                self.addRow();\r\n            },\r\n            editRow: function (ui) {\r\n                if (mode != \"execution\") return;\r\n                self.editRow(ui.key);\r\n            },\r\n            deleteRow: function (ui) {\r\n                if (mode != \"execution\") return;\r\n                self.deleteRow(ui.key);\r\n            },\r\n            moreRows: function (ui) {\r\n                if (mode != \"execution\")\r\n                    return;\r\n                self.moreRows(ui);\r\n            },\r\n            showMore: function (ui) {\r\n                self.showMore(ui.key);\r\n            },\r\n            totalData: function (ui) {\r\n                if (mode != \"execution\") return;\r\n                self.onTotalData();\r\n            }\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Method to render non editable values\r\n    */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n\r\n        // Do the same as the post-render            \r\n        self.postRender();\r\n    },\r\n\r\n    /** \r\n    *   Creates the column model required to initialize the grid plugin\r\n    */\r\n    buildColumnModel: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var columns = self.columns;\r\n\r\n        // Create id column first\r\n        var keyColumn = {\r\n            name: \"id\",\r\n            index: 0,\r\n            label: \"id\",\r\n            hidden: true,\r\n            align: \"center\",\r\n            key: true\r\n        };\r\n\r\n        // Add to column model\r\n        var columnModel = [];\r\n        columnModel.push(keyColumn);\r\n\r\n        $.each(columns, function (index, column) {\r\n\r\n            // Set grid column\r\n            column.columnIndex = index + 1;\r\n            var columnLabel = !bizagi.util.isEmpty(column.properties.displayName) ? column.properties.displayName : \" \";\r\n            var gridColumn = {\r\n                name: column.properties.xpath,\r\n                index: index + 1,\r\n                label: columnLabel,\r\n                key: false,\r\n                hidden: (!column.properties.visible || column.properties.type == \"columnHidden\" || column.properties.columnVisible == false),\r\n                summarizeBy: (column.properties.totalize && column.properties.totalize.operation ? column.properties.totalize.operation : undefined),\r\n                bizAgiProperties: column.properties\r\n            };\r\n\r\n            columnModel.push(gridColumn);\r\n        });\r\n\r\n        return columnModel;\r\n    },\r\n\r\n    /**\r\n    * Makes the grid to refresh\r\n    */\r\n    refresh: function () {\r\n        var self = this;\r\n        self.fetchData();\r\n    },\r\n\r\n    /*\r\n    *   Holds the execution until the grid data is ready after a load operation\r\n    */\r\n    dataReady: function () {\r\n        var self = this;\r\n\r\n        return self.dataReadyDeferred != null ? self.dataReadyDeferred.promise() : null;\r\n    },\r\n\r\n    /*\r\n    * Update data from local changes\r\n    */\r\n    loadChanges: function (rows) {\r\n        var self = this;\r\n        var idRow = [], i;\r\n        // get data from the rows\r\n        for (i = 0, length = rows.length; i < length; i++) {\r\n            idRow.push([rows[i][0], i]); // save id and index\r\n        }\r\n\r\n        for (i = 0, idRowLength = idRow.length; i < idRowLength; i++) {\r\n            var properties = self.changes[idRow[i][0]];\r\n            var index;\r\n            // search for changes\r\n            if (properties !== undefined) {\r\n                var xpath, columnNumber;\r\n                index = idRow[i][1];\r\n                // update all properties in data\r\n                for (xpath in properties) {\r\n                    if (properties.hasOwnProperty(xpath)) {\r\n                        columnNumber = self.getColumn(xpath).columnIndex;\r\n                        rows[index][columnNumber] = properties[xpath];\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Method to set data and update the grid\r\n    */\r\n    updateData: function (data) {\r\n        var self = this;\r\n        var grid = self.grid;\r\n        var columns = self.columns;\r\n\r\n        // Set value in control\r\n        if (data) {\r\n            self.properties.data = data;\r\n            self.setCellOverrides(data, columns);\r\n            grid.bizagi_grid_tablet(\"setData\", data);\r\n\r\n\r\n            if (self.properties.data && self.properties.data.total > self.Class.GRID_PAGE_SIZE) {\r\n                self.alternativePaginator();\r\n                self.isPaginatorActive = true;\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Method to fetch data from the server and then update the data\r\n    */\r\n    fetchData: function (page, sortBy, sortType) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        self.dataReadyDeferred = new $.Deferred();\r\n\r\n        // Define defaults\r\n        page = page || (properties.page || 1);\r\n        sortBy = sortBy || (properties.sortBy || \"\");\r\n        sortType = sortType || (properties.sortOrder || \"asc\");\r\n\r\n        // Update control properties\r\n        properties.page = page;\r\n        properties.sortBy = sortBy;\r\n        properties.sortType = sortType;\r\n        properties.sort = sortBy + \" \" + sortType;\r\n\r\n        // Start loading to avoid multiple calls to the server\r\n        self.startLoading();\r\n\r\n        $.when(self.getRemoteData())\r\n            .then(function (data) {\r\n                if (data) {\r\n                    if (data.deviceMaxRecordsExceeded) {\r\n                        bizagi.showMessageBox(bizagi.localization.getResource(\"render-search-maximum-records-allowed\"));\r\n                    } else {\r\n                        if (self.isRTL()) {\r\n                            data.rows = self.changeOrderData(data.rows);\r\n                        }\r\n                        self.loadChanges(data.rows);\r\n                        self.updateData(data);\r\n                        self.triggerRenderChange();\r\n                        self.dataReadyDeferred.resolve();\r\n\r\n                        //focus on page clicked\r\n                        if (self.isPaginatorActive) {\r\n                            var pageSelected = $(\".ui-bizagi-grid-pager\", self.element).find(\"li[data-page-number=\" + data.page + \"]\");\r\n                            var pageLeftPosition = pageSelected.length > 0 ? pageSelected.position().left : 0;\r\n\r\n                            pageLeftPosition = Number(pageLeftPosition - 30) * -1;\r\n                            var pagerContentWidth = Number($(\".ui-bizagi-grid .ui-bizagi-grid-pager\", self.getControl()).css(\"width\").replace(/[^-\\d\\.]/g, ''));\r\n                            var lastLiElementPosition = $(\".ui-bizagi-grid .ui-bizagi-grid-pager ul li:last\", self.getControl());\r\n                            lastLiElementPosition = lastLiElementPosition.length > 0 ? lastLiElementPosition.position().left : 0;\r\n                            var pagerMarginAnimate = (-lastLiElementPosition + pagerContentWidth) - 90;\r\n\r\n                            if (pagerContentWidth < lastLiElementPosition) {\r\n                                if (pageLeftPosition < pagerMarginAnimate) {\r\n                                    pageLeftPosition = pagerMarginAnimate;\r\n                                }\r\n                                $(\".ui-bizagi-grid .ui-bizagi-grid-pager ul\", self.getControl()).css({ \"margin-left\": pageLeftPosition + \"px\" });\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }).always(function(){\r\n                self.endLoading();\r\n            });\r\n    },\r\n\r\n\r\n    /*\r\n    *   Add the render data to the given collection in order to send data to the server\r\n    */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var grid = self.grid;\r\n\r\n        // Save pending inline add rows\r\n        if (self.grid && (self.properties.inlineAdd || self.properties.inlineEdit)) {\r\n            var newKeys = grid.bizagi_grid_tablet.hasOwnProperty(\"getNewRowKeys\") ? grid.bizagi_grid_tablet(\"getNewRowKeys\") : [];\r\n\r\n            // Save new rows then save the whole screen\r\n            if (newKeys.length > 0 && !self.properties.alreadySaved && self.isValid()) {\r\n                var saveDeferred = self.saveInlineAddedRows(newKeys, true);\r\n\r\n                // Add to deferred collections in order to sync when saving\r\n                renderValues.deferreds = renderValues.deferreds || [];\r\n                renderValues.deferreds.push(saveDeferred);\r\n            }\r\n\r\n            // Remove adding keys from current changes\r\n            for (var i = 0; i < newKeys.length; i++) {\r\n                if (self.changes[newKeys[i]]) {\r\n                    delete self.changes[newKeys[i]];\r\n                }\r\n            }\r\n        }\r\n\r\n        // Call base method\r\n        self._super(renderValues);\r\n    },\r\n\r\n    /*\r\n    *   Customizes the content drawing inside the cell\r\n    */\r\n    drawCell: function (column, key, value, isNewRow) {\r\n        var self = this;\r\n        if (column.key) return value;\r\n\r\n        self.newRecords = self.newRecords || {};\r\n        // Get render column\r\n        var columnIndex = column.index - 1;\r\n        var renderColumn = self.columns[columnIndex];\r\n\r\n        // Get cell properties\r\n        if (!self.cellMetadata[key]) self.cellMetadata[key] = {};\r\n        if (!self.cellMetadata[key][columnIndex]) self.cellMetadata[key][columnIndex] = {};\r\n        var properties = self.cellMetadata[key][columnIndex].properties || renderColumn.originalProperties;\r\n\r\n        var visible = properties.visible !== undefined ? properties.visible : true;\r\n        var editable = properties.editable !== undefined ? properties.editable : true;\r\n        properties.editable = false;\r\n\r\n        // Show editable cell when we are performing inline add operation\r\n        if (isNewRow) editable = true;\r\n        renderColumn.properties.displayType = 'value';\r\n\r\n        if (key == \"summary\") {\r\n            editable = false;\r\n        }\r\n\r\n\r\n        renderColumn.setValue(key, value);\r\n        renderColumn.setSurrogateKey(key);\r\n\r\n        if (properties.visible) {\r\n            renderColumn.properties = properties;\r\n            var defer = new $.Deferred();\r\n\r\n            $.when(renderColumn.renderReadOnly(key, value)).done(function (cell) {\r\n                // Register array with new records              \r\n                for (var j = 0; j < self.columns.length; j++) {\r\n                    self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n                    self.getCellOverride(key, j).visible = true;\r\n                }\r\n                defer.resolve(cell);\r\n            });\r\n            //return renderColumn.renderReadOnly(key, value);\r\n            return defer.promise();\r\n        } else {\r\n\r\n            return \"\";\r\n        }\r\n    },\r\n\r\n\r\n    /*\r\n    *   Executes when the cell is ready and inserted into the DOM\r\n    */\r\n    onCellReady: function (column, key, cell, isNewRow) {\r\n        var self = this;\r\n\r\n        // Get render column\r\n        var columnIndex = column.index - 1;\r\n        var renderColumn = self.columns[columnIndex];\r\n        var properties = ((self.cellMetadata[key][columnIndex] != undefined) ? self.cellMetadata[key][columnIndex].properties : undefined) || renderColumn.originalProperties;\r\n        var visible = properties.visible !== undefined ? properties.visible : true;\r\n        var editable = properties.editable !== undefined ? properties.editable : true;\r\n\r\n        // Show editable cell when we are performing inline add operation\r\n        if (isNewRow) editable = true;\r\n        else editable = false;\r\n        if (visible) {\r\n            if (editable) {\r\n                // Set editable\r\n                var originalEditable = renderColumn.properties.editable;\r\n                renderColumn.properties.editable = editable;\r\n\r\n                if (renderColumn.properties.submitOnChange) {\r\n                    var control = renderColumn.getDecorated(key);\r\n                    if (control) {\r\n                        control.properties.submitOnChangexpathContext = self.properties.xpath + \"[]\";\r\n                    }\r\n                }\r\n\r\n\r\n                // Execute cell post render\r\n                renderColumn.postRender(key, cell);\r\n\r\n                // Restore editable\r\n                renderColumn.properties.editable = originalEditable;\r\n            } else {\r\n                renderColumn.postRenderReadOnly(key, cell);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n    *  Adds a row to the grid\r\n    */\r\n    addRow: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var formParams = self.getFormParams();\r\n\r\n        // Start loading\r\n        self.startLoading();\r\n\r\n        // Send add request\r\n        $.when(self.submitAddRequest())\r\n            .done(function (newid) {\r\n\r\n                // Show a slide with new form after that\r\n                var slideView = new bizagi.rendering.tablet.slide.view(self.dataService, self.renderFactory, {\r\n                    title: self.properties.displayName || \"\",\r\n                    container: form.container,\r\n                    formParams: formParams,\r\n                    navigation: formParams.navigation,\r\n                    showSaveButton: true,\r\n                    onSave: function (data) {\r\n                        return self.submitSaveRequest(newid, data);\r\n                    }\r\n                });\r\n\r\n                // End Loading\r\n                self.endLoading();\r\n\r\n                var recordXpath = properties.xpath + \"[id=\" + newid + \"]\";\r\n\r\n                slideView.render({\r\n                    idRender: properties.id,\r\n                    recordXPath: recordXpath,\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: properties.idPageCache,\r\n                    requestedForm: \"addForm\",\r\n                    url: properties.addPage,\r\n                    formParams: formParams,\r\n                    navigation: formParams.navigation\r\n                }).done(function () {\r\n\r\n                    self.endLoading();\r\n\r\n                    if (!properties.submitOnChange) {\r\n                        // Reload grid\r\n                        self.fetchData();\r\n\r\n                    } else {\r\n                        // Submits the entire form\r\n                        self.submitOnChange();\r\n                    }\r\n\r\n                }).fail(function () {\r\n                    self.endLoading();\r\n                    self.submitRollbackRequest();\r\n                });\r\n            });\r\n\r\n    },\r\n\r\n    /**\r\n    *  Edits a row in the grid\r\n    */\r\n    editRow: function (id) {\r\n\r\n        if (id == 0) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"render-grid-message-no-selected-row\"), bizagi.localization.getResource(\"render-grid-header-no-selected-row\"));\r\n            return;\r\n        }\r\n\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Use tablet inline edit when there are no edit form\r\n        if (properties.inlineEdit == true && properties.allowEdit == false) {\r\n            self.editInline(id);\r\n            return;\r\n        }\r\n\r\n        if (self.cleanActionChanges && self.cleanActionChanges[id] !== undefined) {\r\n\r\n            self.changes = self.cleanActionChanges;\r\n            var data = $.extend(self.changes[id], {});\r\n            data.idPageCache = properties.idPageCache;\r\n\r\n            $(\".ui-tooltip\").remove();\r\n\r\n            $.when(self.submitSaveRequest(id, data)).done(function () {\r\n                // Set loading status\r\n                self.startLoading();\r\n\r\n                if (!properties.submitOnChange) {\r\n                    // Reload grid\r\n                    self.endLoading();\r\n\r\n                    self.fetchData();\r\n                } else {\r\n                    // Submits the entire form\r\n                    self.submitForGridChange().always(function () {\r\n                        self.endLoading();\r\n\r\n                        // Send edit request\r\n                        self.executeSubmitEditRequest(id);\r\n                    });\r\n                }\r\n            });\r\n        } else {\r\n            self.executeSubmitEditRequest(id);\r\n        }\r\n    },\r\n\r\n    executeSubmitEditRequest: function (id) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var formParams = self.getFormParams();\r\n\r\n\r\n        var slideView = new bizagi.rendering.tablet.slide.view(self.dataService, self.renderFactory, {\r\n            title: self.properties.displayName || \"\",            \r\n            container: form.container,\r\n            formParams: formParams,\r\n            navigation: formParams.navigation,\r\n            showSaveButton: true,\r\n            onSave: function (data) {\r\n                return self.submitSaveRequest(id, data);\r\n            }\r\n        });\r\n\r\n        self.startLoading();\r\n\r\n        $.when(self.submitEditRequest(id))\r\n            .done(function () {\r\n\r\n                // Show dialog with new form after that\r\n                var recordXpath = properties.xpath + \"[id=\" + id + \"]\";\r\n\r\n                slideView.render({\r\n                    idRender: properties.id,\r\n                    recordXPath: recordXpath,\r\n                    xpathContext: properties.xpathContext,\r\n                    idPageCache: properties.idPageCache,\r\n                    requestedForm: \"editForm\",\r\n                    url: properties.editPage,\r\n                    formParams: formParams,\r\n                    navigation: formParams.navigation\r\n                }).done(function () {\r\n                    if (!properties.submitOnChange) {\r\n                        // Reload grid\r\n                        self.fetchData();\r\n\r\n                    } else {\r\n                        // Submits the entire form\r\n                        self.submitOnChange();\r\n                    }\r\n                }).fail(function () {\r\n                    self.startLoading();\r\n                    $.when(self.submitRollbackRequest()).always(function () {\r\n                        self.endLoading();\r\n                    });\r\n                });\r\n            }).always(function () {\r\n                self.endLoading();\r\n            });\r\n    },\r\n    /**\r\n    *  Deletes  a row to the grid\r\n    */\r\n    deleteRow: function(id) {\r\n        if (id === 0) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"render-grid-message-no-selected-row\"),\r\n                bizagi.localization.getResource(\"render-grid-header-no-selected-row\"));\r\n            return;\r\n        }\r\n\r\n        var self = this;\r\n\r\n        bizagi.showConfirmationBox(this.getResource(\"render-grid-delete-confirmation\"))\r\n            .done(function () {\r\n                // Do a grid record deletion\r\n                $.when(self.submitDeleteRequest(id))\r\n                    .done(function (data) {\r\n                        // Reload grid\r\n                        self.fetchData();\r\n\r\n                        if (data.type === \"success\") {\r\n                            // Trigger the event\r\n                            //'key' must be included to trigger a single call to actions and validations\r\n                            //line 310 bizagi.command.controllers.action\r\n                            self.triggerRenderChange({ rowDeleted: true, changed: false, key: id });\r\n                        }\r\n                    });\r\n            });\r\n    },\r\n\r\n    moreRows: function (ui) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (typeof properties.originalrowsPerPage === \"undefined\") {\r\n            properties.originalrowsPerPage = properties.rowsPerPage;\r\n        }\r\n\r\n        properties.rowsPerPage += properties.originalrowsPerPage;\r\n\r\n        var dataToSend = {};\r\n        self.collectData(dataToSend);\r\n\r\n        self.startLoading();\r\n\r\n        if (jQuery.isEmptyObject(dataToSend)) {\r\n            self.moreRowsCommon(ui);\r\n            return;\r\n        }\r\n        // Send the data\r\n        self.dataService.submitData({\r\n            action: \"SUBMITONCHANGE\",\r\n            data: dataToSend,\r\n            idRender: properties.id,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache\r\n        }).done(function () {\r\n\r\n            self.endLoading();\r\n\r\n            self.moreRowsCommon(ui);\r\n        });\r\n\r\n    },\r\n\r\n    moreRowsCommon: function (ui) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        self.fetchData(ui.page, ui.sortBy, ui.sortType);\r\n\r\n        $.when(self.dataReadyDeferred).done(function () {\r\n\r\n            if (properties.records != 0)\r\n                if (properties.records + 1 <= properties.rowsPerPage) {\r\n                    $(\".ui-bizagi-grid-dynamic-pager\", self.getControl()).hide();\r\n                }\r\n\r\n        });\r\n    },\r\n\r\n    /**\r\n    *  Shows more info about a grid row\r\n    */\r\n    showMore: function (id) {\r\n        var self = this;\r\n        var data = self.properties.data;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();                \r\n        var formParams = self.getFormParams();\r\n\r\n        // Search row\r\n        var currentRow = [];\r\n        for (var i = 0, length = data.rows.length; i < length; i++) {\r\n            if (data.rows[i][0] == id) {\r\n                currentRow = data.rows[i];\r\n                break;\r\n            }\r\n        }\r\n\r\n        // Render grid view\r\n        var slideView = new bizagi.rendering.tablet.slide.view.grid(self.dataService, self.renderFactory, {\r\n            title: self.properties.displayName || \"\",\r\n            container: form.container,            \r\n            allowEdition: false,\r\n            formParams: formParams,\r\n            navigation: formParams.navigation\r\n        });\r\n\r\n        self.startLoading();\r\n\r\n        slideView.render({\r\n            row: currentRow,\r\n            columns: self.columns,\r\n            pageCacheId: properties.idPageCache,\r\n            xpath: properties.xpath,\r\n            xpathContext: properties.xpathContext,\r\n            sessionId: form.properties.sessionId,\r\n            actions: form.actions,\r\n            formParams: formParams,\r\n            navigation: formParams.navigation\r\n        }).done(function () {\r\n            self.endLoading();\r\n        });\r\n    },\r\n\r\n    /**\r\n    *  Edits the entire row (inline) in another slide\r\n    */\r\n    editInline: function (id) {\r\n        var self = this;\r\n        var data = self.properties.data;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var formParams = self.getFormParams();\r\n\r\n        // Search row\r\n        var currentRow = [];\r\n        for (var i = 0, length = data.rows.length; i < length; i++) {\r\n            if (data.rows[i][0] == id) {\r\n                currentRow = data.rows[i];\r\n                break;\r\n            }\r\n        }\r\n\r\n        // Render grid view\r\n        var slideView = new bizagi.rendering.tablet.slide.view.grid(self.dataService, self.renderFactory, {\r\n            title: self.properties.displayName || \"\",\r\n            container: form.container,\r\n            formParams: formParams,\r\n            navigation: formParams.navigation,\r\n            allowEdition: true\r\n        });\r\n\r\n        // Render the editable view\r\n        $.when(\r\n            slideView.render({\r\n                row: currentRow,\r\n                columns: self.columns,\r\n                pageCacheId: properties.idPageCache,\r\n                xpath: properties.xpath,\r\n                xpathContext: properties.xpathContext,\r\n                sessionId: form.properties.sessionId,\r\n                actions: form.actions,                \r\n                validations: form.validations,\r\n                formParams: formParams,\r\n                navigation: formParams.navigation\r\n            })\r\n        ).done(function (data) {\r\n            // This code is executed when the user press save on the slide\r\n\r\n            // Update internal data\r\n            for (xpath in data) {\r\n                self.collectGridChange({ id: id, xpath: xpath, value: data[xpath], trigger: false });\r\n            }\r\n\r\n            // Prepare grid data\r\n            var dataToSend = {};\r\n            self.collectData(dataToSend);\r\n\r\n            // Send the data\r\n            self.dataService.submitData({\r\n                action: \"SUBMITONCHANGE\",\r\n                data: dataToSend,\r\n                idRender: properties.id,\r\n                xpath: properties.xpath,\r\n                xpathContext: properties.xpathContext,\r\n                idPageCache: properties.idPageCache\r\n            }).done(function () {\r\n                    // After successfully response refresh the grid\r\n                    self.fetchData();\r\n                });\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Changes the background for a cell\r\n    */\r\n    changeCellBackgroundColor: function (key, xpath, argument) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n            for (var j = 0; j < self.columns.length; j++) {\r\n                var isVisible = self.getCellOverride(key, j).visible;\r\n                if (self.columns[j].properties.xpath == xpath && isVisible) {\r\n                    var cell = self.grid.bizagi_grid_tablet('getCell', key, xpath, j);\r\n\r\n                    if (self.properties.editable) {\r\n                        cell = cell.find(\"input\");\r\n                    }\r\n\r\n                    cell.css(\"background-color\", argument);\r\n                    break;\r\n                }\r\n            }\r\n\r\n        } else {\r\n            if (self.pendingActions) {\r\n                self.pendingActions.push({\r\n                    method: sel * f.changeCellBackgroundColor,\r\n                    arguments: arguments\r\n                });\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Changes the background for a cell\r\n    */\r\n    changeCellColor: function (key, xpath, argument) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n            for (var j = 0; j < self.columns.length; j++) {\r\n                if (self.columns[j].properties.xpath == xpath) {\r\n                    var cell = self.grid.bizagi_grid_tablet('getCell', key, xpath, j);\r\n\r\n                    if (self.properties.editable) {\r\n                        cell = cell.find(\"input\");\r\n                    }\r\n\r\n                    cell.css(\"color\", argument);\r\n                    $(cell).find(\".ui-bizagi-cell-readonly\").css(\"color\", argument);\r\n                    break;\r\n                }\r\n            }\r\n        } else {\r\n            if (self.pendingActions) {\r\n                self.pendingActions.push({\r\n                    method: self.changeCellColor,\r\n                    arguments: arguments\r\n                });\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Changes the visibility for a cell\r\n    */\r\n    changeCellVisibility: function (key, xpath, argument) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n            for (var j = 0; j < self.columns.length; j++) {\r\n                if (self.columns[j].properties.xpath == xpath) {\r\n                    var cell = self.grid.bizagi_grid_tablet('getCell', key, xpath, j);\r\n                    // Change visibility\r\n                    if (argument == true) {\r\n                        cell.show();\r\n                    } else {\r\n                        cell.hide();\r\n                    }\r\n\r\n                    self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n                    self.getCellOverride(key, j).visible = argument;\r\n                    break;\r\n                }\r\n            }\r\n        } else {\r\n            if (self.pendingActions) {\r\n                self.pendingActions.push({\r\n                    method: self.changeCellVisibility,\r\n                    arguments: arguments\r\n                });\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *  Changes the required for cell\r\n    */\r\n    changeCellValue: function(key, xpath, argument) {\r\n        var self = this;\r\n    },\r\n\r\n    /*\r\n    *   Sets an error on the cell\r\n    */\r\n    setError: function (key, xpath) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n            for (var j = 0; j < self.columns.length; j++) {\r\n                var isVisible = self.getCellOverride(key, j).visible;\r\n                if (self.columns[j].properties.xpath == xpath && isVisible) {\r\n                    var cell = self.grid.bizagi_grid_tablet('getCell', key, xpath, j);\r\n                    cell.parent().addClass(\"ui-bizagi-render-grid-cell-error\");\r\n                    break;\r\n                }\r\n            }\r\n\r\n        } else {\r\n            if (self.pendingActions) {\r\n                self.pendingActions.push({\r\n                    method: self.setError,\r\n                    arguments: arguments\r\n                });\r\n            }\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready\r\n    */\r\n    ready: function () {\r\n        var self = this;\r\n        var parentPromise = self._super();\r\n        var inlineAddPromise = self.inlineAddDeferred ? self.inlineAddDeferred.promise() : null;\r\n        return $.when(parentPromise, inlineAddPromise);\r\n    },\r\n\r\n    /*\r\n    *   Method to start loading for ajax data and update the ui\r\n    */\r\n    startLoading: function (bUseTimeout) {\r\n        var self = this;\r\n\r\n        bizagi.loading.start();\r\n\r\n        self._super(bUseTimeout);\r\n    },\r\n\r\n    /*\r\n    *   Method to remove the loading message\r\n    */\r\n    endLoading: function () {\r\n        var self = this;\r\n\r\n        bizagi.loading.stop();\r\n\r\n        self._super();\r\n    },\r\n\r\n    cleanCellData: function (key, xpath) {\r\n        var self = this;\r\n\r\n        if (self.initialLoadDone) {\r\n            var control = self.getControlCell(key, xpath);\r\n            if (control) {\r\n                control.cleanData();\r\n                for (var j = 0; j < self.columns.length; j++) {\r\n                    if (self.columns[j].properties.xpath == xpath) {\r\n                        break;\r\n                    }\r\n                }\r\n\r\n                var rows = self.properties.data.rows;\r\n                var i = 0;\r\n                var rowLength = rows.length;\r\n\r\n                for (; i < rowLength; i++) {\r\n                    if (Number(key) === rows[i][0]) {\r\n                        rows[i][j + 1] = [[\"\", \"\"]];\r\n                        break;\r\n                    }\r\n                }\r\n                self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n                self.getCellOverride(key, j).value = null;\r\n\r\n                if (!self.cleanActionChanges) {\r\n                    self.cleanActionChanges = {};\r\n                }\r\n                if (!self.cleanActionChanges[key]) {\r\n                    self.cleanActionChanges[key] = {};\r\n                }\r\n                self.cleanActionChanges[key][xpath] = \"\";\r\n            }\r\n        } else {\r\n            self.pendingActions.push({\r\n                method: self.cleanData,\r\n                arguments: \"\"\r\n            });\r\n        }\r\n    },\r\n\r\n    onTotalData: function (ui) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var data = properties.data || {};\r\n        var rows = data.rows;\r\n        var rowsLength = rows.length;        \r\n        var showTotal = [];\r\n        var columnsModel = self.buildColumnModel();\r\n        var result;\r\n\r\n        bizagi.util.tablet.startLoading();\r\n\r\n        columnsModel.forEach( function callback( column, columnIndex) {\r\n            if (column.bizAgiProperties) {\r\n                operationState = column.bizAgiProperties.totalize.operation;\r\n\r\n                switch (operationState) {\r\n                    case \"sum\":\r\n                        result = rows.sum(function(row){\r\n                            var return_value = row[columnIndex] !== null ? row[columnIndex] : column.bizAgiProperties.defaultvalue;\r\n                            return Number(return_value)\r\n                        }, columnIndex);\r\n                        break;\r\n\r\n                    case \"count\":\r\n                        result = rows.count(function(row){\r\n                            //Checks if there is a DefaultValue, so assign it to the returnedvalu in case it doesn't have value\r\n                            var return_value = row[columnIndex] !== null ? row[columnIndex] : column.bizAgiProperties.defaultvalue;\r\n\r\n                            if (!bizagi.util.isArray(return_value)){\r\n                                 return return_value;\r\n                            }\r\n\r\n                            if (bizagi.util.isArray(return_value) && return_value.length > 0) {\r\n                                return return_value; //If the returned value is not undefined, neither null, it will count +1\r\n                            }\r\n                        }, column, columnIndex);\r\n\r\n                        break;\r\n\r\n                    case \"max\":\r\n                        result = rows.max(function(row){\r\n                            var return_value = row[columnIndex] !== null ? row[columnIndex] : column.bizAgiProperties.defaultvalue;\r\n                            return Number(return_value)\r\n                        }, columnIndex);\r\n\r\n                        break;\r\n\r\n                    case \"min\":\r\n                        result = rows.min(function(row){\r\n                             var return_value = row[columnIndex] !== null ? row[columnIndex] : column.bizAgiProperties.defaultvalue;\r\n                             return Number(return_value);\r\n                         }, columnIndex);\r\n                        break;\r\n\r\n                    case \"avg\":\r\n                        result = rows.avg(function(row){\r\n                            var return_value = row[columnIndex] !== null ? row[columnIndex] : column.bizAgiProperties.defaultvalue;\r\n                            return Number(return_value);\r\n                        }, columnIndex);\r\n\r\n                        result = result.toFixed(2);\r\n                        break;\r\n                }\r\n\r\n                if (operationState) {\r\n                    result = self.formatTotalizedResult(operationState, column.bizAgiProperties.type, result);\r\n                    showTotal.push({ label: column.label, total: result });\r\n                }\r\n            }\r\n        });\r\n        self.showTotals(showTotal);\r\n        bizagi.loading.stop();\r\n    },\r\n\r\n    formatTotalizedResult: function(operation, controlType, value){\r\n        switch(operation){\r\n            case 'sum':\r\n            case 'avg':\r\n            case 'min':\r\n            case 'max':\r\n                if (controlType == \"columnMoney\" || controlType == \"money\") {\r\n                    return bizagi.util.formatMonetaryCell(value);\r\n                }\r\n            break;\r\n        }\r\n\r\n        return value || 0;\r\n    },\r\n\r\n    showTotals: function (params) {\r\n        var self = this;\r\n        var modalViewTemplate = self.renderFactory.getTemplate('bizagi.grid.totalizer');\r\n        var data = $.extend(params, { \"orientation\": self.properties.orientation })\r\n        var modalView = $.fasttmpl(modalViewTemplate, data);\r\n\r\n        $(\".bz-rn-grid-totalize-container\").remove();\r\n\r\n        modalView.kendoMobileModalView({\r\n            close: function () {\r\n                this.destroy();\r\n                this.element.remove();\r\n            },\r\n            useNativeScrolling: true\r\n        });\r\n\r\n        modalView.delegate(\".bz-rn-grid-totalize-close-btn\", \"click\", function () {\r\n            modalView.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        modalView.kendoMobileModalView(\"open\");\r\n    },\r\n\r\n    alternativePaginator: function () {\r\n    }\r\n});","/*\r\n*   Name: BizAgi Tablet Render Grid Extension\r\n*   Author: Richar Urbano (based on Diego Parra version)\r\n*   Comments:\r\n*   -   This script will redefine the grid render class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.grid.extend(\"bizagi.rendering.grid.offline\", {\r\n    MAX_ROWS_SUPPORTED: 4\r\n}, {\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function(params) {\r\n        var self = this;\r\n        var data = params.data;\r\n\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Create a data-structure to keep track of each cell properties\r\n        this.cellMetadata = {};\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n        properties.data.originalRows = bizagi.clone(properties.data.rows);\r\n        var form = self.getFormContainer();\r\n    \r\n        properties.isTaskForm = form.properties.isTaskForm\r\n        //Preload new lines previously added offline\r\n        if(properties.isTaskForm && properties[\"new-records\"]) {\r\n            self.newRecords = {};\r\n            var newRowKeys = Object.keys(properties[\"new-records\"]);\r\n            for(var k = 0; k< newRowKeys.length;k++) {\r\n                self.newRecords[newRowKeys[k]] = {} \r\n                self.changes[newRowKeys[k]] = properties[\"new-records\"][newRowKeys[k]];\r\n                self.newRecords[newRowKeys[k]].createdOffline = true\r\n            }\r\n        }\r\n        // Just apply display-type: vertical, align it to the left\r\n        properties.displayType = \"vertical\";\r\n        properties.labelAlign = \"left\";\r\n        self[\"deleted-records\"] = {};\r\n        if (properties.groupBy || properties.groupSummary) {\r\n            // Add warning\r\n            form.addWarning(self.getResource(\"render-tablet-warning-grid\"));\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n        self.initialLoadDone = false;\r\n\r\n        // Make control to behave as a block container\r\n        control.addClass(\"ui-bizagi-render-grid-container\")\r\n            .addClass(\"ui-bizagi-render-display-block\");\r\n\r\n        // Find component holder\r\n        self.grid = $(\">div\", control);\r\n\r\n        // Hide common label\r\n        self.getLabel().hide();\r\n\r\n        // Grid plugin\r\n        self.applyGridPlugin();\r\n        self.configureHelpText();\r\n\r\n        // Set initial data\r\n        if (properties.data) {\r\n\r\n            self.updateData(properties.data);\r\n\r\n            // Trigger change in order to start up the actions when the controls is ready\r\n            $.when(self.ready())\r\n                .done(function() {\r\n                    self.triggerRenderChange({ changed: false });\r\n                });\r\n        }\r\n\r\n        // Execute pending actions\r\n        self.initialLoadDone = true;\r\n        for (var i in self.pendingActions) {\r\n            self.pendingActions[i].method.apply(self, self.pendingActions[i].arguments);\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Method to render non editable values\r\n    */\r\n    postRenderReadOnly: function() {\r\n        var self = this;\r\n\r\n        // Do the same as the post-render            \r\n        self.postRender();\r\n    },\r\n\r\n    /*\r\n    *   Method to render non editable values\r\n    */\r\n    applyGridPlugin: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var grid = self.grid;\r\n        var mode = self.getMode();\r\n\r\n        // Check is offline form\t    \r\n        var isOfflineForm = bizagi.util.isOfflineForm({ context: self });\r\n\r\n        // Build column metadata\r\n        var columns = self.buildColumnModel();\r\n\r\n        // Apply grid plugin\r\n        grid.bizagi_grid_tablet({\r\n            columns: columns,\r\n            maxColumns: self.Class.MAX_ROWS_SUPPORTED,\r\n            title: properties.displayName,\r\n            isOfflineForm: isOfflineForm || false,\r\n            mode: self.getMode(),\r\n\r\n            template: {\r\n                grid: self.renderFactory.getTemplate(\"bizagi.grid.grid\"),\r\n                waiting: self.renderFactory.getTemplate(\"bizagi.grid.waiting\"),\r\n                table: self.renderFactory.getTemplate(\"bizagi.grid.table\"),\r\n                emptyTable: self.renderFactory.getTemplate(\"bizagi.grid.table.empty\"),\r\n                column: self.renderFactory.getTemplate(\"bizagi.grid.column\"),\r\n                specialColumn: self.renderFactory.getTemplate(\"bizagi.grid.column.special\"),\r\n                row: self.renderFactory.getTemplate(\"bizagi.grid.row\"),\r\n                rowButtons: self.renderFactory.getTemplate(\"bizagi.grid.row.buttons.offline\"),\r\n                cell: self.renderFactory.getTemplate(\"bizagi.grid.cell\"),\r\n                specialCell: self.renderFactory.getTemplate(\"bizagi.grid.cell.special\"),\r\n                pager: self.renderFactory.getTemplate(\"bizagi.grid.pager\"),\r\n                buttons: self.renderFactory.getTemplate(\"bizagi.grid.buttons.offline\"),\r\n                dynamicPager: self.renderFactory.getTemplate(\"bizagi.grid.dynamicpager\")\r\n            },\r\n\r\n            actions: {\r\n                add: properties.allowAdd,\r\n                edit: (properties.allowEdit && properties.withEditForm && properties.data != null),\r\n                remove: properties.allowDelete,\r\n                details: false,\r\n                inlineAdd: true, //properties.inlineAdd,\r\n                allowMore: false,\r\n                enableXlsExport: false,\r\n                enablePdfExport: false\r\n            },\r\n\r\n            isValid: function() {\r\n                return self.isValidGrid();                \r\n            },\r\n            pageRequested: function(ui) {\r\n                if (mode != \"execution\") return;\r\n                self.fetchData(ui.page, ui.sortBy, ui.sortType);\r\n            },\r\n            drawCell: function(ui) {\r\n                return self.drawCell(ui.column, ui.key, ui.value, ui.isNewRow);\r\n            },\r\n            cellReady: function(ui) {\r\n\r\n                return self.onCellReady(ui.column, ui.key, ui.cell, ui.isNewRow);\r\n            },\r\n            rowSelected: function(ui) {\r\n                if (mode != \"execution\") return;\r\n                var data = ui;\r\n                self.triggerHandler(\"rowSelected\", { id: ui.key, data: ui });\r\n            },\r\n            addRow: function(ui) {\r\n                if (mode != \"execution\") return;\r\n                self.addRow();\r\n            },\r\n            editRow: function(ui) {\r\n                if (mode != \"execution\") return;\r\n                self.editRow(ui.key);\r\n            },\r\n            deleteRow: function(ui) {\r\n                if (mode != \"execution\") return;\r\n                self.deleteRow(ui.key);\r\n            },\r\n            saveAddedRows: function(ui) {\r\n                self.saveInlineAddedRows(ui.keys);\r\n            },\r\n            beforeInlineAdd: function() {\r\n                self.inlineAddDeferred = new $.Deferred();\r\n            },\r\n            afterInlineAdd: function() {\r\n                if (self.inlineAddDeferred) {\r\n                    self.inlineAddDeferred.resolve();\r\n                }\r\n            },\r\n            cancelEdition: function(ui) {\r\n                self.removeNewRecords(ui);\r\n            },\r\n            removeNewRecords: function(ui) {\r\n                self.removeNewRecords(ui);\r\n            }\r\n        });\r\n    },\r\n\r\n    /** \r\n    *   Creates the column model required to initialize the grid plugin\r\n    */\r\n\r\n    buildColumnModel: function() {\r\n        return bizagi.rendering.grid.prototype.buildColumnModel.call(this);\r\n    },\r\n\r\n    /**\r\n    * Makes the grid to refresh\r\n    */\r\n    refresh: function() {\r\n        var self = this;\r\n\r\n        self.fetchData();\r\n    },\r\n\r\n    /*\r\n    *   Holds the execution until the grid data is ready after a load operation\r\n    */\r\n    dataReady: function() {\r\n        var self = this;\r\n        return self.dataReadyDeferred != null ? self.dataReadyDeferred.promise() : null;\r\n    },\r\n\r\n    /*\r\n    *   Method to set data and update the grid\r\n    */\r\n    updateData: function(data) {\r\n        return bizagi.rendering.grid.prototype.updateData.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    *   Method to fetch data from the server and then update the data\r\n    */\r\n    fetchData: function(page, sortBy, sortType) {\r\n        var self = this;\r\n\r\n        self.dataReadyDeferred = new $.Deferred();\r\n\r\n        // Start loading to avoid multiple calls to the server\r\n        self.startLoading();\r\n\r\n        $.when(self.getRemoteData())\r\n            .then(function(data) {\r\n                self.endLoading();\r\n                if (data) {\r\n                    self.updateData(data);\r\n                    self.triggerRenderChange();\r\n                    self.dataReadyDeferred.resolve();\r\n                }\r\n            });\r\n    },\r\n\r\n    processChanges: function() {\r\n        var self = this;\r\n        var rowsList = [];\r\n        var data = self.properties.data;\r\n        if(self.properties.isTaskForm) {\r\n            return [];\r\n        }\r\n\r\n        // Save pending inline add rows\r\n        for (var id in self.changes) {\r\n            var sortArray = [];\r\n            sortArray.push(id);\r\n\r\n            for (var columnXpath in self.changes[id]) {\r\n\r\n\r\n                // Check if the render can submit data\r\n                if (self.canColumnBeSent(id, columnXpath)) {\r\n                    var value = self.changes[id][columnXpath];\r\n\r\n                    if (typeof value === \"string\") {\r\n                        if (value.match(/\\n/gm) !== null) {\r\n                            value = value.replaceAll(\"\\n\", \"\\\\n\");\r\n                        }\r\n                    }\r\n\r\n                    sortArray.push({\r\n                        value: value,\r\n                        xpath: columnXpath,\r\n                        DataType: self.getColumn(columnXpath).properties.dataType\r\n                    });\r\n                }\r\n            }\r\n\r\n            if (typeof (self.properties.data.rows) !== \"undefined\" && self.properties.data.rows.length > 0) {\r\n                // Search row\r\n                var currentRow = [];\r\n                for (var i = 0; i < data.rows.length; i++) {\r\n                    if (data.rows[i][0] == id) {\r\n                        currentRow = data.rows[i];\r\n\r\n                        // Delete current data\r\n                        data.rows.splice(i, 1);\r\n                        i--;\r\n\r\n                        // Mixed data\r\n                        currentRow = self.processRow(currentRow);\r\n                        sortArray = $.extend(true, currentRow, sortArray);\r\n\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n\r\n            rowsList.push(sortArray);\r\n        }\r\n\r\n        return rowsList;\r\n    },\r\n    \r\n    collectOfflineTaskData: function(renderValues) {\r\n        var self = this;        \r\n        var properties = self.properties;\r\n        var errorsMessage = [];\r\n        var internalRedersValues = [];\r\n        var data = self.properties.data;\r\n\r\n            // Save pending inline add rows\r\n            if (self.isValid(errorsMessage)) {\r\n                for (var id in self.changes) {\r\n                    var sortArray = [];\r\n                    var currentChanges = {};\r\n                    for (var columnXpath in self.changes[id]) {\r\n                        \r\n                        if (self.canColumnBeSent(id, columnXpath)) {\r\n                            var columnNumber = self.getColumn(columnXpath).columnIndex - 1;\r\n                            var value = self.changes[id][columnXpath];\r\n\r\n                            if (typeof value === \"string\") {\r\n                                if (value.match(/\\n/gm) !== null) {\r\n                                    value = value.replaceAll(\"\\n\", \"\\\\n\");\r\n                                }\r\n                            }\r\n\r\n                            sortArray[columnNumber] = value;                                  \r\n                            var xpath = properties.xpath + self.buildCellXpathFilter(id) + \".\" + columnXpath;\r\n                            var value = self.changes[id][columnXpath].value?self.changes[id][columnXpath].value:self.changes[id][columnXpath];                                \r\n                            renderValues[xpath] = value;\r\n                            //Changes are store to delete them if the row is new, the rest of changes can be saved by xpath\r\n                            currentChanges[xpath] = value;\r\n                        }\r\n                    }\r\n                    //If new record store action data\r\n                    if(self.newRecords[id]) {\r\n                        //Use - to avoid issues with possible xpaths in renderValues used both in new and deleted records\r\n                        renderValues[\"new-records\"] = renderValues[\"new-records\"] ? renderValues[\"new-records\"] : [];\r\n                        var addRowData = {\r\n                            url: properties.addUrl,\r\n                            idRender: properties.id,\r\n                            xpath: properties.xpath,\r\n                            xpathContext: properties.xpathContext,\r\n                            contexttype: properties.contexttype,\r\n                            idPageCache: properties.idPageCache,\r\n                            submitData: self.changes[id],\r\n                            prepare: true,\r\n                            idRow: parseInt(id+'')\r\n                        }\r\n                        renderValues[\"new-records\"][id] = addRowData;\r\n                        for(change in currentChanges) {\r\n                            delete renderValues[change];\r\n                        }\r\n                        sortArray.idRow = parseInt(id+'');    \r\n                        sortArray.isNew = true;\r\n                        sortArray.changes = self.changes[id];\r\n                        if (!self.newRecords[id].createdOffline)                         \r\n                            internalRedersValues[internalRedersValues.length] = sortArray;                                            \r\n                    }                        \r\n                    \r\n                    \r\n                }\r\n            }\r\n            // Get dataz\r\n            if (JSON.stringify(data.rows) !== JSON.stringify(data.originalRows) || internalRedersValues.length > 0) {\r\n                if (typeof (data.rows) !== \"undefined\" && internalRedersValues.length > 0) {\r\n                    //Merge new and edited rows only saved for future edition\r\n                    renderValues[properties.xpath] = $.merge($.merge([], self.processOldRows(data.rows)),\r\n                        internalRedersValues);\r\n                } else if (typeof (data.rows) !== \"undefined\" && data.rows.length > 0) {\r\n                    renderValues[properties.xpath] = self.processOldRows(data.rows);\r\n                } else {\r\n                    renderValues[properties.xpath] = internalRedersValues;\r\n                }\r\n            }                                    \r\n        \r\n            self.collectChangesWithoutDeleting(renderValues);    \r\n            \r\n            renderValues[\"deleted-records\"] = self[\"deleted-records\"];\r\n    },\r\n\r\n    /*\r\n    * Old Method that collects data only for Offline start forms and prepares data for AsyncWorkItem\r\n    */\r\n    collectOfflineStartData: function(renderValues){\r\n        var self = this;\r\n        var errorsMessage = [];\r\n        var internalRedersValues = [];\r\n        var properties = self.properties;\r\n        var data = self.properties.data;\r\n        // Save pending inline add rows\r\n        if (self.isValid(errorsMessage)) {\r\n            for (var id in self.changes) {\r\n                var sortArray = [];\r\n                for (var columnXpath in self.changes[id]) {\r\n                    // Check if the render can submit data\r\n                    if (self.canColumnBeSent(id, columnXpath)) {\r\n                        var columnNumber = self.getColumn(columnXpath).columnIndex - 1;\r\n                        var value = self.changes[id][columnXpath];\r\n                        if (typeof value === \"string\") {\r\n                            if (value.match(/\\n/gm) !== null) {\r\n                                value = value.replaceAll(\"\\n\", \"\\\\n\");\r\n                            }\r\n                        }\r\n                        sortArray[columnNumber] = {\r\n                            value: value,\r\n                            xpath: columnXpath,\r\n                            DataType: self.getColumn(columnXpath).properties.dataType\r\n                        };\r\n                    }\r\n                }\r\n                if (typeof (self.properties.data.rows) !== \"undefined\" && self.properties.data.rows.length > 0) {\r\n                    // Search row\r\n                    var currentRow = [];\r\n                    for (var i = 0; i < data.rows.length; i++) {\r\n                        if (data.rows[i][0] == id) {\r\n                            currentRow = data.rows[i];\r\n                            // Delete current data\r\n                            data.rows.splice(i, 1);\r\n                            i--;\r\n                            // Mixed data\r\n                            currentRow = self.processRow(currentRow);\r\n                            sortArray = $.extend(true, currentRow, sortArray);\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n                internalRedersValues[internalRedersValues.length] = sortArray;\r\n            }\r\n        }\r\n\r\n\r\n        // Get data\r\n        if (JSON.stringify(data.rows) !== JSON.stringify(data.originalRows) || internalRedersValues.length > 0) {\r\n            if (typeof (data.rows) !== \"undefined\" && internalRedersValues.length > 0) {\r\n                renderValues[properties.xpath] = $.merge($.merge([], self.processOldRows(data.rows)),\r\n                    internalRedersValues);\r\n            } else if (typeof (data.rows) !== \"undefined\" && data.rows.length > 0) {\r\n                renderValues[properties.xpath] = self.processOldRows(data.rows);\r\n            } else {\r\n                renderValues[properties.xpath] = internalRedersValues;\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    *   Add the render data to the given collection in order to send data to the server\r\n    */\r\n    collectData: function(renderValues) {\r\n        var self = this;\r\n        \r\n        var properties = self.properties;\r\n                \r\n        if(properties.isTaskForm) {\r\n            self.collectOfflineTaskData(renderValues);\r\n        } else {\r\n            self.collectOfflineStartData(renderValues);\r\n        }               \r\n\r\n    },\r\n    collectChangesWithoutDeleting: function(renderValues) {\r\n        if (self.exclusiveChanges) {\r\n            for (var id in self.exclusiveChanges) {\r\n                var columnExclusiveChanges = self.exclusiveChanges[id];\r\n                var columnEnabledChecks = self.enabledChecks[id];\r\n                if (columnExclusiveChanges && columnEnabledChecks) {\r\n                    for (var i = 0; i < columnEnabledChecks.length; i++) {\r\n                        var columnSimpleXpathEnabled = properties.xpath + self.buildCellXpathFilter(columnEnabledChecks[i][0]) + \".\" + id;\r\n                        renderValues[columnSimpleXpathEnabled] = false;\r\n                    }\r\n                    var columnSimpleXpath = properties.xpath + self.buildCellXpathFilter(columnExclusiveChanges.key) + \".\" + columnExclusiveChanges.xpath;\r\n                    renderValues[columnSimpleXpath] = columnExclusiveChanges.value;\r\n\r\n                }\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    *   Delete field id array objects\r\n    */\r\n    processOldRows: function(rows) {\r\n        var newRows = [];\r\n        var tempRows = rows;\r\n        for (var col = 0, leng = tempRows.length; col < leng; col++) {\r\n            var temp = tempRows[col];\r\n            newRows[col] = $.grep(temp, function(n, i) { return i > 0; });\r\n            newRows[col].idRow = temp[0];\r\n        }\r\n\r\n        return newRows;\r\n    },\r\n    /*\r\n    *   Delete field id array\r\n    */\r\n    processRow: function(row) {\r\n        return $.grep(row, function(n, i) { return i > 0; });\r\n    },\r\n    /*\r\n    *   Customizes the content drawing inside the cell\r\n    */\r\n    drawCell: function(column, key, value, isNewRow) {\r\n        var self = this;\r\n\r\n        if (column.key) return value;\r\n\r\n        if (typeof (value) === \"object\" && !isNewRow) {\r\n            value = value.hasOwnProperty(\"value\") ? value.value : value;\r\n        }\r\n\r\n        // Get render column                \r\n        var columnIndex = column.index - 1;\r\n        var renderColumn = self.columns[columnIndex];\r\n        var cellOverride = self.getCellOverride(key, column.index - 1);\r\n\r\n        self.newRecords = self.newRecords || {};\r\n\r\n        // Get cell properties\r\n        if (!self.cellMetadata[key]) self.cellMetadata[key] = {};\r\n        if (!self.cellMetadata[key][columnIndex]) self.cellMetadata[key][columnIndex] = {};\r\n        var properties = self.cellMetadata[key][columnIndex].properties || renderColumn.originalProperties;\r\n\r\n        var visible = properties.visible !== undefined ? properties.visible : true;\r\n        var editable = properties.editable !== undefined ? properties.editable : true;\r\n\r\n        // Apply overrides from cellOverrides\r\n        visible = cellOverride.visible;\r\n        editable = (properties.editable) ? cellOverride.editable : false;\r\n\r\n        // Show editable cell when we are performing inline add operation\r\n        if (isNewRow) editable = true;\r\n\r\n        // If the cell we are drawing is the summary cell, we need to make it readonly\r\n        if (key == \"summary\") editable = false;\r\n\r\n        renderColumn.properties.displayType = 'value';\r\n        renderColumn.setValue(key, value);\r\n        renderColumn.setSurrogateKey(key);\r\n\r\n        // Column search\r\n        if (renderColumn.properties.type == \"columnSearch\" && value != null) {\r\n            for (var i = 0, len = renderColumn.properties.data.length; i < len; i++) {\r\n                if (renderColumn.properties.data[i].id == value) {\r\n                    value = { id: renderColumn.properties.data[i].id, label: renderColumn.properties.data[i].value };\r\n                }\r\n            }\r\n        }\r\n\r\n        if ((renderColumn.properties.type == \"columnCombo\" || renderColumn.properties.type == \"columnList\") && value !=\r\n            null) { //|| renderColumn.properties.type == \"columnRadio\"\r\n            for (var i = 0, len = renderColumn.properties.data.length; i < len; i++) {\r\n                if (renderColumn.properties.data[i].id == value) {\r\n                    value = [[renderColumn.properties.data[i].id, renderColumn.properties.data[i].value]];\r\n                }\r\n            }\r\n        }\r\n\r\n        // Do the render\r\n        if (visible) {\r\n            if (editable) {\r\n                return self.drawEditableCell(renderColumn, properties, key, value, isNewRow);\r\n            } else {\r\n                return self.drawReadonlyCell(renderColumn, properties, key, value);\r\n            }\r\n        } else {\r\n            return \"\";\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Draws the editable version for the cell\r\n    */\r\n    drawEditableCell: function(renderColumn, properties, key, value, isNewRow) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        // Set editable\r\n        var originalEditable = renderColumn.properties.editable;\r\n        renderColumn.properties.editable = true;\r\n\r\n        // Fix problem when required property lose\r\n        renderColumn.overrideProperties({ required: properties.required });\r\n\r\n        // Render cell\r\n        $.when(renderColumn.render(key, value)).done(function(cell) {\r\n            // Register array with new records, just when this is a newrecord\r\n            if (isNewRow && !self.newRecords[key]) {\r\n                self.newRecords[key] = {};\r\n            }\r\n\r\n            // convert all row visible\r\n            for (var j = 0; j < self.columns.length; j++) {\r\n                self.cellOverrides[key] = self.cellOverrides[key] || {};\r\n                self.getCellOverride(key, j).visible = (self.getCellOverride(key, j).visible != undefined) ? self\r\n                    .getCellOverride(key, j).visible : true;\r\n            }\r\n\r\n            // Add change handler  \r\n            renderColumn.getDecorated(key).bind(\"renderchange\", function(render) {\r\n                self.onCellChange(renderColumn, cell, key);\r\n            });\r\n\r\n            // Resolve cell\r\n            defer.resolve(cell);\r\n        });\r\n\r\n        // Restore editable\r\n        renderColumn.properties.editable = originalEditable;\r\n\r\n        // Return promise\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n    *   Draws the readonly version for the cell\r\n    */\r\n    drawReadonlyCell: function(renderColumn, properties, key, value) {\r\n        var self = this;\r\n        var result = \"\";\r\n\r\n        // Use totalizer format when printing summary row\r\n        if (key == \"summary\") {\r\n            var originalFormat = renderColumn.properties.textFormat;\r\n            if (renderColumn.properties.totalize) {\r\n                renderColumn.properties.textFormat = renderColumn.properties.totalize.format;\r\n            }\r\n\r\n            result = renderColumn.renderSummary(key, value);\r\n\r\n            // Restore column format\r\n            renderColumn.properties.textFormat = originalFormat;\r\n        } else {\r\n            result = renderColumn.renderReadOnly(key, value);\r\n        }\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    *   Defines the handler when a cell changes its value\r\n    */\r\n    onCellChange: function(renderColumn, cell, key) {\r\n\r\n        var self = this;\r\n        var _value = renderColumn.getValue(key);\r\n        var compositeValue = renderColumn.getCompositeValue(key);\r\n\r\n        if (renderColumn.properties.type == \"columnDate\" && renderColumn.data.properties.showTime == true) {\r\n\r\n            if (!bizagi.util.isEmpty(_value)) {\r\n                var date = bizagi.util.dateFormatter.getDateFromInvariant(_value, true);\r\n                _value = bizagi.util.dateFormatter.formatInvariant(date, true);\r\n            } else if (_value === \"\") {\r\n                _value = \"\";\r\n            }\r\n        } else if (renderColumn.properties.type == \"columnDate\") {\r\n\r\n            if (!bizagi.util.isEmpty(_value)) {\r\n                var date = bizagi.util.dateFormatter.getDateFromInvariant(_value, false);\r\n                date.setHours(0, 0, 0, 0);\r\n                _value = bizagi.util.dateFormatter.formatInvariant(date, true);\r\n            } else if (_value === \"\") {\r\n                _value = \"\";\r\n            }\r\n        }\r\n\r\n        if (self.properties.allowEdit || self.grid.bizagi_grid_tablet(\"isNewRecord\", key)) {\r\n            var trigger = self.grid.bizagi_grid_tablet(\"isNewRecord\", key) ? false : true;\r\n            self.collectGridChange({\r\n                id: key,\r\n                xpath: renderColumn.properties.xpath,\r\n                value: _value,\r\n                compositeValue: compositeValue,\r\n                columnIndex: renderColumn.columnIndex,\r\n                trigger: trigger\r\n            });\r\n        }\r\n\r\n        // Update change in grid's component data\r\n        self.grid.bizagi_grid_tablet(\"changeCellValue\", key, renderColumn.columnIndex, _value);\r\n\r\n        // If the column has totalizers then we need to refresh the summary\r\n        if (renderColumn.properties.totalize && renderColumn.properties.totalize.operation) {\r\n            self.grid.bizagi_grid_tablet(\"refreshSummary\", renderColumn.columnIndex);\r\n        }\r\n    },\r\n    /*\r\n    *   Collect a single cell change made in the grid to send the data when the user saves the form\r\n    */\r\n    collectGridChange: function(params) {\r\n        var self = this;\r\n        params = params || {};\r\n        var id = params.id;\r\n        var xpath = params.xpath;\r\n        var value = params.value;\r\n        var trigger = typeof (params.trigger) !== \"undefined\" ? params.trigger : true;\r\n\r\n        self.changes[id] = self.changes[id] || {};\r\n        self.changes[id][xpath] = value;\r\n        if (trigger)\r\n            self.triggerRenderChange({ key: id, column: xpath });\r\n    },\r\n    /*\r\n    *   Executes when the cell is ready and inserted into the DOM\r\n    */\r\n    onCellReady: function(column, key, cell, isNewRow) {\r\n        // Avalaible editable\r\n        isNewRow = true;\r\n        bizagi.rendering.grid.prototype.onCellReady.apply(this, arguments);\r\n    },\r\n\r\n    /**\r\n    *  Adds a row to the grid\r\n    */\r\n    addRow: function() {\r\n        bizagi.showMessageBox(bizagi.localization.getResource(\"render-tablet-error-userfield\"), bizagi.localization\r\n            .getResource(\"render-tablet-error-userfield\"));\r\n    },\r\n\r\n    /**\r\n    *  Edits a row in the grid\r\n    */\r\n    editRow: function(id) {\r\n    },\r\n\r\n    /**\r\n    *  Deletes a row to the grid\r\n    */\r\n    deleteRow: function(id) {\r\n        if (!id || id == 0) {\r\n            bizagi.showMessageBox(bizagi.localization.getResource(\"render-grid-message-no-selected-row\"), bizagi\r\n                .localization.getResource(\"render-grid-header-no-selected-row\"));\r\n            return;\r\n        }\r\n\r\n        var self = this;\r\n\r\n        bizagi.showConfirmationBox(this.getResource(\"render-grid-delete-confirmation\"))\r\n            .done(function() {\r\n                // Do a grid record deletion\r\n                $.when(self.submitDeleteRequest(id))\r\n                    .done(function() {\r\n                        // Reload grid\r\n                        self.fetchData();\r\n                    });\r\n            });\r\n    },\r\n\r\n    /**\r\n    *  Edits the entire row (inline) in another slide\r\n    */\r\n    editInline: function(id) {\r\n    },\r\n    /*\r\n    *   Retrieve the data for the new rows and push them into the server\r\n    */\r\n    saveInlineAddedRows: function(keys, bRefresh) {\r\n        var self = this;\r\n        var rows = self.processChanges();\r\n\r\n        if (!bizagi.util.isEmpty(rows)) {\r\n            self.properties.data.rows = $.merge(self.properties.data.rows, rows);;\r\n        }\r\n    },\r\n\r\n    /*\r\n    * Removes invalid records \r\n    */\r\n    removeNewRecords: function(ui) {\r\n        var self = this;\r\n\r\n        if (ui && ui.keys) {\r\n            $.each(ui.keys, function(_, key) {\r\n                if (self.newRecords[key]) {\r\n                    delete self.newRecords[key];\r\n                }\r\n            });\r\n        }\r\n    },\r\n    /*\r\n    *   Changes the background for a cell\r\n    */\r\n    changeCellBackgroundColor: function(key, xpath, argument) {\r\n        bizagi.rendering.grid.prototype.changeCellBackgroundColor.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    *   Changes the background for a cell\r\n    */\r\n    changeCellColor: function(key, xpath, argument) {\r\n        bizagi.rendering.grid.prototype.changeCellColor.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    * Change the visibility for a cell\r\n    */\r\n    changeCellVisibility: function(key, xpath, argument) {\r\n        bizagi.rendering.grid.prototype.changeCellVisibility.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    *   Changes the editability for a cell\r\n    */\r\n    changeCellEditability: function(key, xpath, argument) {\r\n        bizagi.rendering.grid.prototype.changeCellEditability.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    *  Clean data of cell\r\n    */\r\n    cleanCellData: function(key, xpath) {\r\n        bizagi.rendering.grid.prototype.cleanCellData.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    *  Changes the required for cell\r\n    */\r\n    changeCellRequired: function(key, xpath, argument) {\r\n        bizagi.rendering.grid.prototype.changeCellRequired.apply(this, arguments);\r\n    },\r\n    /*\r\n    *   Sets an error on the cell\r\n    */\r\n    setError: function(key, xpath) {\r\n        bizagi.rendering.grid.prototype.setError.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n    *   Returns a promise that will resolve when the element is ready\r\n    */\r\n    ready: function() {\r\n        var self = this;\r\n        var parentPromise = self._super();\r\n        var inlineAddPromise = self.inlineAddDeferred ? self.inlineAddDeferred.promise() : null;\r\n        return $.when(parentPromise, inlineAddPromise);\r\n    },\r\n    /*\r\n    *   Fetch the data into a deferred\r\n    */\r\n    getRemoteData: function(params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set params\r\n        params = params || {};\r\n\r\n        // Check if a custom method has been given\r\n        if (properties.overrideGetRemoteData) {\r\n            var result = properties.overrideGetRemoteData(params);\r\n            return result != null ? result.promise() : null;\r\n        }\r\n\r\n        // Default ajax call\r\n        var defer = new $.Deferred();\r\n\r\n        // Resolve with remote data\r\n        var data = properties.data;\r\n\r\n        // Resolve with fetched data    \r\n        properties.page = data.page;\r\n        properties.records = data.records;\r\n        properties.totalPages = data.totalPages;\r\n\r\n        // Check RTL\r\n        if (self.isRTL()) {\r\n            data.rows = self.changeOrderData(data.rows);\r\n\r\n        }\r\n\r\n        defer.resolve(data);\r\n\r\n        return defer.promise();\r\n    },\r\n    /*\r\n    *   Submits a grid delete record request for the given id \r\n    *   Returns a deferred\r\n    */\r\n    submitDeleteRequest: function(id) {\r\n        var self = this;\r\n        var data = self.properties.data,\r\n        properties = self.properties;\r\n        var statusAction = false;\r\n\r\n        // Found row by id\r\n        var currentRow = [];\r\n        for (var i = 0, length = data.rows.length; i < length; i++) {\r\n            if (data.rows[i][0] == id) {\r\n                currentRow = data.rows[i];\r\n\r\n                data.rows.splice(i, 1);\r\n                i--;\r\n\r\n                data.records--;\r\n                statusAction = true;\r\n                if(!self.newRecords[id])\r\n                {\r\n                    var xpath = properties.xpath + self.buildCellXpathFilter(id);\r\n\r\n                    var delInfo = {\r\n                        url: properties.deleteUrl,\r\n                        idRender: properties.id,\r\n                        xpath: xpath,\r\n                        xpathContext: properties.xpathContext,\r\n                        idPageCache: properties.idPageCache,\r\n                        contexttype: properties.contextType,\r\n                        prepare: true\r\n                    }\r\n                    self[\"deleted-records\"][id] = delInfo;\r\n                }\r\n                break;\r\n            }\r\n        }\r\n\r\n        // verified status action\r\n        if (!statusAction) {\r\n            bizagi.showMessageBox(this.getResource(\"workportal-general-no-records-found\"));\r\n        }\r\n\r\n        return (data.rows);\r\n    },\r\n\r\n    isValidGrid: function() {\r\n        var self = this;\r\n        var errorsMessage = [];\r\n        var form = self.getFormContainer();\r\n\r\n        if (typeof(form.validationController) !== \"undefined\")\r\n            form.validationController.clearValidationMessages();\r\n\r\n        self.isValid(errorsMessage);\r\n\r\n        if (errorsMessage.length > 0) {\r\n            if (typeof(form.validationController) !== \"undefined\") {\r\n                for (var index = 0; index < errorsMessage.length; index++) {\r\n                    form.validationController.showValidationMessage(errorsMessage[index].message, errorsMessage[index].xpath);\r\n                }\r\n            }\r\n\r\n            return false;\r\n        } else {\r\n            return true;\r\n        }\r\n    }\r\n});","/*\r\n*   Name: BizAgi Tablet Render Join Search Dialog Extension\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This script will redefine the Join Search Dialog render class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.search.extend(\"bizagi.rendering.search\", {\r\n    ADVANCED_SEARCH_ID: -1,\r\n    ADVANCED_ADDITION_ID: -2,\r\n    SEARCH_MIN_LENGTH: 3,\r\n    SEARCH_DELAY: 750,\r\n    MAX_ITEMS:10,\r\n    MAX_ITEMS_OFFLINE:50\r\n\r\n}, {\r\n\r\n        /*\r\n        *   Constructor\r\n        */\r\n        init: function (params) {\r\n            var self = this;\r\n\r\n            // Call base\r\n            self._super(params);\r\n        },\r\n\r\n        /**\r\n         * When the render isn't editable\r\n         */\r\n        renderReadOnly: function () {\r\n            var self = this;\r\n            var template = self.renderFactory.getTemplate(\"readonlySearch\");\r\n            var value = self.properties.value;\r\n            var label = value && self.hasValue() ? (value.additionallabel ? (value.label + \", \" + value.additionallabel) : value.label) : \"\";\r\n\r\n            // Render template\r\n            return $.kendoTmpl(template, { value: label });\r\n        },\r\n\r\n        /**\r\n         * When the render isn't editable\r\n         */\r\n        postRenderReadOnly: function () {\r\n            var self = this;\r\n            var control = self.getControl();\r\n\r\n            self.input = $(\".bz-rn-text\", control);\r\n            control.closest(\".ui-bizagi-render\").addClass(\"bz-rn-read-only\");\r\n        },\r\n\r\n        /*\r\n        *   Template method to implement in each device to customize each render after processed\r\n        */\r\n        postRender: function () {\r\n            var self = this;\r\n            var control = self.getControl();\r\n\r\n            // Check is offline form        \r\n            var isOfflineForm = bizagi.util.isOfflineForm({ context: self });\r\n\r\n            // Call base \r\n            self._super();\r\n\r\n            self.input = $(\".bz-rn-container-control-search\", control);\r\n            self.searchInput = $(\"input\", control);\r\n            self.isOfflineForm = isOfflineForm || false;\r\n\r\n            if (self.isOfflineForm) {\r\n                self.properties.submitOnChange = false;\r\n                self._simplySuggestOffline();\r\n            } else if (self.properties.advancedSearch) {\r\n                self._advanceSearch();\r\n            } else {\r\n                self._simplySearch();\r\n            }\r\n        },\r\n\r\n        /*\r\n        *\r\n        */\r\n        configureHandlers: function () {\r\n            var self = this;\r\n            var properties = self.properties;\r\n            var control = self.getControl();\r\n\r\n            if (properties.editable) {\r\n                $(\".bz-rn-search-control-icons-clear\", control).bind(\"click\", function (e) {\r\n                    e.stopPropagation();\r\n                    self.setValue({ id: \"\" });\r\n                    self.searchInput.prop(\"value\", \"\");\r\n                    $(this).addClass(\"hidden\");\r\n                    self.input.find(\".bz-rn-input-search-text\").removeClass(\"hasValue\");\r\n                });\r\n            }\r\n        },\r\n\r\n        /*\r\n        *\r\n        */\r\n        renderControl: function () {\r\n            var self = this;\r\n            var properties = self.properties;\r\n            var template = self.renderFactory.getTemplate(\"search\");\r\n\r\n            var params = {\r\n                allowSuggest: properties.allowSuggest,\r\n                editable: properties.editable,\r\n                allowClear: properties.allowClear,\r\n                id: properties.id,\r\n                xpath: properties.xpath,\r\n                hasValue: (typeof (properties.value) !== \"undefined\" && properties.value !== null) &&\r\n                    typeof (properties.value.label) !== \"undefined\" && properties.value.label !== \"\",\r\n                allowTyping: properties.allowTyping,\r\n                advancedSearch: properties.advancedSearch,\r\n                hasMozillaHelpText: ($.browser && $.browser.mozilla &&\r\n                    properties.helpText !== null && properties.helpText !== \"\") ? true : false\r\n            };\r\n\r\n            return $.kendoTmpl(template, params);\r\n        },\r\n\r\n        /*Simply suggest autocomplete offline*/\r\n        _simplySuggestOffline: function () {\r\n            var self = this;\r\n            var control = self.getControl();\r\n\r\n            $(\".bz-wp-search-control-search-icon\", control).addClass(\"disable-search\");\r\n            self.applyAutocompletePlugin();\r\n        },\r\n\r\n        /*Simply search autocomplete*/\r\n        _simplySearch: function () {\r\n            var self = this;\r\n            var control = self.getControl();\r\n\r\n            $(\".bz-wp-search-control-search-icon\", control).addClass(\"disable-search\");\r\n            self.applyAutocompletePlugin();\r\n        },\r\n\r\n        _advanceSearch: function () {\r\n            var self = this;\r\n            // Set readonly property\r\n            self.searchInput.attr(\"readonly\", \"true\");\r\n\r\n            //Bind search click button\r\n            self.input.bind(\"click\", function () {\r\n                //Call showSlideSearch method\r\n                self.showSlideSearch();\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Sets the value to show and calls the method to sets the control value\r\n         * @param {object} value\r\n         * @param {int} value.id\r\n         * @param {string} value.label\r\n         * @param {string=} value.additionallabel\r\n         * @example\r\n         *   value = {\r\n         *     id: 123,\r\n         *     label: \"xx\",\r\n         *     additionallabel: \"yyyy\"\r\n         *   }\r\n        */\r\n        setDisplayValue: function (value) {\r\n            var self = this;\r\n            var label = \"\";\r\n            value = self.mapValue(value);\r\n\r\n            if (value !== null && typeof value !== \"undefined\" && typeof value.id !== \"undefined\") {\r\n                if (value.additionallabel && value.label) {\r\n                    label = value.label + \",\" + value.additionallabel;\r\n                } else if (value.label) {\r\n                    label = value.label;\r\n                } else {\r\n                    label = \"\";\r\n                }\r\n\r\n                if (self.properties.editable) {\r\n                    self.searchInput.val(label);\r\n\r\n                    if (typeof value !== \"undefined\") {\r\n                        self.input.find(\".bz-rn-input-search-text\").addClass(\"hasValue\");\r\n                    } else {\r\n                        self.input.find(\".bz-rn-input-search-text\").removeClass(\"hasValue\");\r\n                    }\r\n                } else {\r\n                    self.input.text(label);\r\n                }\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Cleans the control's data\r\n         * */\r\n        cleanData: function () {\r\n            var self = this;\r\n            var value = { id: \"\", value: \"\" };\r\n            self.setValue(value);\r\n            self.setDisplayValue(value);\r\n        },\r\n\r\n        /*\r\n        *   Returns the value to display, ex. non-editable renders\r\n        */\r\n        getDisplayValue: function () {\r\n            return this.selectedValue;\r\n        },\r\n\r\n        /* \r\n        *   Opens the search slide\r\n        */\r\n        showSlideSearch: function () {\r\n            var self = this;\r\n            var properties = self.properties;\r\n            var slideParams = $.extend({}, self.getParams(), {\r\n                container: self.getFormContainer().container,\r\n                title: properties.displayName || \"\",\r\n                allowNew: properties.allowNew\r\n            });\r\n\r\n            // Show search dialog\r\n            // Create slide search object\r\n            var slideView = new bizagi.rendering.tablet.slide.view.search(self.dataService, self.renderFactory,\r\n                properties.searchForms, {\r\n                    allowFullSearch: properties.allowFullSearch,\r\n                    maxRecords: properties.maxRecords,\r\n                    idRender: properties.id,\r\n                    navigation: self.getParams().navigation,\r\n                    idPageCache: properties.idPageCache,\r\n                    orientation: properties.orientation || \"ltr\"\r\n                }, slideParams);\r\n\r\n            // Render the search form\r\n            slideView.render({\r\n                idRender: properties.id,\r\n                xpath: properties.xpath,\r\n                xpathContext: properties.xpathContext,\r\n                idPageCache: properties.idPageCache\r\n            }).done(function (item) {\r\n                // Set data\r\n                self.setValue(item);\r\n\r\n                // Submit info to server\r\n                self.submitData();\r\n            });\r\n        },\r\n\r\n        /* Apply autocomplete capabilities to a single input*/\r\n        applyAutocompletePlugin: function () {\r\n            var self = this;\r\n            var control = self.getControl();\r\n            var searchInput = self.searchInput;\r\n            self.searchInput.parent().find(\".bz-rn-autocomplete-wrapper\").addClass(\"hidden\");\r\n\r\n            searchInput.addClass(\"ui-autocomplete-input\");\r\n            searchInput.on(\"click keyup\", function () {\r\n                self.autoCompleteSearchResults();\r\n            });\r\n\r\n            control.on(\"click mousedown\", \"li\", function () {\r\n                var elemObject = $.data(this).itemautocomplete;\r\n\r\n                self.setValue({ id: elemObject.id, label: elemObject.value }, true);\r\n                self.setDisplayValue({ id: elemObject.id, label: elemObject.value });\r\n\r\n                if (self.isOfflineForm) {\r\n                    $(this).parent().hide();\r\n                } else {\r\n                    if (typeof self.properties.submitOnChange !== \"undefined\" && self.properties.submitOnChange) {\r\n                        self.submitOnChange();\r\n                    }\r\n\r\n                    $(this).parent().hide();\r\n                }\r\n\r\n                self.getControl().find(\".bz-rn-search-control-icons-clear\").removeClass(\"hidden\");\r\n                self.input.find(\".bz-rn-input-search-text\").addClass(\"hasValue\");\r\n            });\r\n\r\n            control.on(\"focusout\", \"input\", function () {\r\n                control.find(\"ul\").hide();\r\n                self.searchInput.parent().find(\".bz-rn-autocomplete-wrapper\").addClass(\"hidden\");\r\n            });\r\n        },\r\n\r\n        /* Search results on keyup or click the input field*/\r\n        autoCompleteSearchResults: function () {\r\n            var self = this;\r\n            var searchInput = self.searchInput;\r\n            var currentValue = self.searchInput.val();\r\n\r\n            if (currentValue === \"\") {\r\n                self.input.find(\".bz-rn-search-control-icons-clear\").addClass(\"hidden\");\r\n            }\r\n\r\n            $.when(\r\n                self.processRequest({ term: searchInput.val() }, function () { })\r\n            ).done(function (resp) {\r\n                var wrapper = self.searchInput.parent().find(\".bz-rn-autocomplete-wrapper\");\r\n                if (resp.length > 0) {\r\n                    wrapper.removeClass(\"hidden\");\r\n                } else {\r\n                    if (!wrapper.hasClass(\"hidden\")) {\r\n                        wrapper.addClass(\"hidden\");\r\n                    }\r\n                }\r\n\r\n                var elementUl = searchInput.parent().find(\"ul\");\r\n                elementUl.find(\"li\").remove();\r\n\r\n                elementUl.css({\r\n                    display: \"inline-block\",\r\n                    left: searchInput.position().left,\r\n                    top: searchInput.position().top + 15\r\n                });\r\n\r\n                var length = resp.length;\r\n                if (length > 0) {\r\n                    //display the wrapper\r\n                    self.control.find(\".bz-rn-autocomplete-wrapper\").show();\r\n\r\n                    for (var i = 0; i < length; i++) {\r\n                        var searchItem = self.renderSearchItem(resp[i]);\r\n                        $(searchItem).addClass(\"bz-rn-autocomplete-item\");\r\n                        searchItem.appendTo(elementUl);\r\n                    }\r\n                }\r\n            });\r\n        },\r\n\r\n        processRequest: function (req) {\r\n            var self = this;\r\n            var properties = self.properties;\r\n            var defer = new $.Deferred();\r\n\r\n            // Create array for response objects   \r\n            var suggestions = [];\r\n\r\n            /* \r\n            *   Method to add the special items to the suggestions \r\n            */\r\n            function addToSuggestions(alSuggestions) {\r\n\r\n                // Add the clear option - TODO: To implement            \r\n                /* if (properties.allowClear && (self.value !== undefined)) { \r\n                alSuggestions.push({ id: self.Class.CLEAR_SEARCH_ID, label: \"\", value: \"\" });\r\n                }*/\r\n\r\n                // Add additional option if advanced search is on\r\n                if (properties.advancedSearch) {\r\n                    alSuggestions.push({ id: self.Class.ADVANCED_SEARCH_ID, label: \"\", value: \"\" });\r\n                }\r\n                // Add additional option if allow addition is on\r\n                if (properties.allowAdd) {\r\n                    alSuggestions.push({ id: self.Class.ADVANCED_ADDITION_ID, label: \"\", value: \"\" });\r\n                }\r\n                // Pass array to callback   \r\n                defer.resolve(alSuggestions);\r\n            }\r\n\r\n            if ((req.term.length >= this.Class.SEARCH_MIN_LENGTH)) {\r\n                // Update term property to reflect the search\r\n                properties.term = req.term;\r\n                if (self.isOfflineForm) {\r\n\r\n                    var dataOffline = self.properties.data;\r\n                    var itemsAttached = 0;\r\n\r\n                    $.each(dataOffline, function (index, current) {\r\n\r\n                        if ( itemsAttached >= self.Class.MAX_ITEMS_OFFLINE ){\r\n                            return false;\r\n                        }\r\n\r\n                        var parseValue = \"\";\r\n                        switch (typeof current.value) {\r\n                            case \"number\":\r\n                                parseValue = current.value;\r\n                                break;\r\n                            case \"object\":\r\n                                parseValue = current.value.toString();\r\n                                break;\r\n                            case \"string\":\r\n                                parseValue = current.value;\r\n                                break;\r\n                            default:\r\n                                parseValue = current.value;\r\n                                break;\r\n                        }\r\n\r\n                        var isSuggestMatch = parseValue !== undefined &&\r\n                            (parseValue.toLowerCase().indexOf(properties.term.toLowerCase()) !== -1 || properties.term === \"%%%\");\r\n\r\n                        if (isSuggestMatch) {\r\n                            suggestions.push({\r\n                                id: current.id !== undefined ? current.id : \"\",\r\n                                label: parseValue !== undefined ? parseValue.replace(new RegExp(\"(?![^&;]+;)(?!<[^<>]*)(\" +\r\n                                    $.ui.autocomplete.escapeRegex(properties.term) + \")(?![^<>]*>)(?![^&;]+;)\", \"gi\"),\r\n                                    \"<strong>$1</strong>\") : \"\",\r\n                                value: parseValue !== undefined ? current.value : \"\"\r\n                            });\r\n                        }\r\n\r\n                        itemsAttached += 1;\r\n                    });\r\n\r\n                    addToSuggestions(suggestions);\r\n                } else {\r\n                    this.getData()\r\n                        .done(function (data) {\r\n                            // Process response to highlight matches\r\n                            var i = -1;\r\n                            var item;\r\n\r\n                            while ((item = data[++i]) && properties.maxRecords > i && i < self.Class.MAX_ITEMS) {\r\n                                suggestions.push({\r\n                                    id: item.id,\r\n                                    label: item.value.toString()\r\n                                        .replace(new RegExp(\"(?![^&;]+;)(?!<[^<>]*)(\" +\r\n                                            $.ui.autocomplete.escapeRegex(req.term) + \")(?![^<>]*>)(?![^&;]+;)\", \"gi\"),\r\n                                        \"<strong>$1</strong>\"),\r\n                                    value: item.value\r\n                                });\r\n                            }\r\n\r\n                            addToSuggestions(suggestions);\r\n                        }).fail(function () {\r\n                            // fail\r\n                            defer.reject();\r\n                        });\r\n                }\r\n            } else {\r\n                addToSuggestions(suggestions);\r\n            }\r\n\r\n            return defer.promise();\r\n        },\r\n\r\n        renderSearchItem: function (item) {\r\n            var self = this;\r\n            var searchItem = $.kendoTmpls(self.renderFactory.getTemplate(\"searchItem\"), {\r\n                id: item.id,\r\n                label: item.label,\r\n                value: item.value\r\n            });\r\n\r\n            searchItem.data(\"itemautocomplete\", item);\r\n\r\n            return searchItem;\r\n        },\r\n\r\n        showAddRecordDialog: function () {\r\n            var self = this;\r\n            var properties = self.properties;\r\n            var buttons = {\r\n                text: bizagi.localization.getResource(\"render-form-dialog-box-add\"),\r\n                click: function () {\r\n                    // Show dialog with add form\r\n                    var dialog = new bizagi.rendering.dialog.form(self.dataService, self.renderFactory, {\r\n                        showSaveButton: properties.editable,\r\n                        title: bizagi.localization.getResource(\"render-dialog-entity\"),\r\n                        onSave: function (data) {\r\n                            // Remove pagecache from data\r\n                            var idPageCache = data.idPageCache;\r\n\r\n                            var params = {\r\n                                action: \"SAVE\",\r\n                                data: data,\r\n                                idPageCache: idPageCache,\r\n                                guidEntity: properties.entity,\r\n                                contexttype: \"entity\"\r\n                            };\r\n\r\n                            $.when(\r\n                                self.dataService.submitData(params)\r\n                            ).done(function () {\r\n                                // SUCCESS\r\n                            });\r\n                        }\r\n                    });\r\n\r\n                    dialog.render({\r\n                        idRender: properties.id,\r\n                        idPageCache: properties.idPageCache,\r\n                        requestedForm: \"addForm\",\r\n                        guidEntity: properties.entity,\r\n                        contextType: \"entity\"\r\n                    }).fail(function () {\r\n\r\n                    });\r\n                }\r\n            };\r\n\r\n            return {\r\n                buttons: buttons\r\n            };\r\n        }\r\n    });","/*\r\n*   Name: BizAgi Tablet Render Letter Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the letter render class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.letter.extend(\"bizagi.rendering.letter\", {}, {\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Fill default properties\r\n        var properties = this.properties;\r\n\r\n        // Fix required\r\n        // No letter can be required on the iPad, \r\n    \t// NOTE: We must implement something to warn the user that there is an editable letter that must be filled in the PC version\r\n    \tproperties.required = false;\r\n    \r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Tablet Render Button Extension\r\n*   Author: Bizagi Bizagi Team\r\n*   Comments:\r\n*   -   This script will redefine the button render class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.button.extend(\"bizagi.rendering.button\", {}, {\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var button = $(\":button\", control);\r\n\r\n        // Stylize button\r\n        button.button();\r\n        button.removeClass(\"ui-state-default\");\r\n\r\n        // Bind event\r\n        button.click(function() {\r\n            // Process button actions\r\n            self.processButton();\r\n        });\r\n    },\r\n\r\n    /*\r\n    *   Method to render non editable values\r\n    */\r\n    postRenderReadOnly: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Execute the same as post-render\r\n        self.postRender();\r\n\r\n        // Set as disabled\r\n        var button = $(\":button\", control);\r\n        button.button(\"option\", \"disabled\", \"true\");\r\n    },\r\n    /*\r\n    *   Process the button actions workflow\r\n    */\r\n    processButton: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (properties.editable) {\r\n\r\n            // Check if action need conformation\r\n            if (properties.needsUserConfirmation) {\r\n                $.when(bizagi.showConfirmationBox(properties.userConfirmationMessage, \"Bizagi\", \"warning\"))\r\n                    .done(function() {\r\n                        // Trigger change\r\n                        self.triggerRenderChange({ pressed: true });\r\n                    });\r\n            } else {\r\n                if (!properties.preventDefault) {\r\n                    self.runButtonAction();\r\n                }\r\n                // Trigger change\r\n                self.triggerRenderChange({ pressed: true });\r\n            }\r\n        }\r\n    },\r\n\r\n    runButtonAction: function() {\r\n        var self = this;\r\n\r\n        // Save the form prior opening the dialog\r\n        self.getFormContainer().clearValidationMessages();\r\n\r\n        self.saveForm().pipe(function() {\r\n            return self.executeButton();\r\n        }).done(function(result) {\r\n            if (result == null || result == true || result.result == \"success\" || result.type == \"success\") {\r\n                return self.refreshForm();\r\n            } else if (result.type == \"validationMessages\") {\r\n                try {\r\n                    // Add validation messages \r\n                    self.getFormContainer().addValidationMessage(result.messages);\r\n                } catch (e) {\r\n                    bizagi.showMessageBox(result.messages, \"Error\");\r\n                }\r\n            }\r\n        }).fail(function(a, b, message) {\r\n            // Add error messages \r\n            try {\r\n                self.getFormContainer().addErrorMessage(message);\r\n            } catch (e) {\r\n                bizagi.showMessageBox(message, \"Error\");\r\n            }\r\n        });\r\n    },\r\n\r\n    // rewrite method to prevent the button on the tablet be affected when customizing on other platforms\r\n    processLayout: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var visible = properties.visible != undefined ? bizagi.util.parseBoolean(properties.visible) : true;\r\n\r\n        // Set required and visiblity\r\n        properties.required = properties.required != undefined ? bizagi.util.parseBoolean(properties.required) : false;\r\n\r\n        if (properties.required) {\r\n            self.changeRequired(properties.required);\r\n        }\r\n\r\n        if (!visible) {\r\n            self.changeVisibility(visible);\r\n        }\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: BizAgi Desktop Render fileprint Extension\r\n *   Author: Christian Collazos\r\n *   Comments:\r\n *   -   This script will redefine the fileprint render class to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.fileprint.extend(\"bizagi.rendering.fileprint\", {}, {\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n        self.getControl().parent().hide();\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: Bizagi Tablet Render Link Extension\r\n *   Author: Bizagi Mobile Team\r\n *   Comments:\r\n *   -   This script will redefine the link render class to adjust to tablet devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.link.extend(\"bizagi.rendering.link\", {}, {\r\n\r\n    /**\r\n     * Configure the controls interactions\r\n     * @returns {} \r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var link = $(\".ui-bizagi-render-link\", control);\r\n\r\n        self.input = control.find(\"a\");\r\n\r\n        if (properties.value) {\r\n            $(self.input).on(\"click\", function (event) {\r\n                event.preventDefault();\r\n\r\n                if (self.isValidValue(properties.value)) {\r\n                    window.open(encodeURI(this.getAttribute(\"href\")), \"_system\");\r\n                }\r\n            });\r\n        } else {\r\n            link.addClass(\"bz-rn-link-disabled\");\r\n            control.closest(\".ui-bizagi-render\").addClass(\"bz-rn-read-only\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Checks if the value is a valid url (http/https valid urls)\r\n     *\r\n     * @param {String} value The control's value that is needed to be displayed\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n\r\n        if (self.isValidValue(value)) {\r\n            //Get the decoded version of the URL\r\n            value = getFullyDecodedURI($.trim(value));\r\n            self.input.attr(\"href\", value);\r\n            self.input.attr(\"target\", \"_blank\");\r\n            self.input.attr(\"data-rel\", \"external\");\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Method to render non editable values\r\n     */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Execute configure handlers\r\n        if (properties.value) {\r\n            self.configureHandlers();\r\n        }\r\n\r\n        // Help Text Control\r\n        self.configureHelpText();\r\n    },\r\n\r\n    /**\r\n     * Checks if the value is a valid url (http/https valid urls)\r\n     *\r\n     * @param {String} value Stored value in the control\r\n     */\r\n    isValidValue: function (value) {\r\n        return (value && $.trim(value + \"\").toLowerCase().match(/^(http|https):\\/\\//) !== null) || false;\r\n    }\r\n});","/*  \r\n *   Name: BizAgi Desktop Render list Extension\r\n *   Author: Iván Ricardo Taimal Narváez\r\n *   Comments:\r\n *   -   This script will redefine the list render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from base list\r\nbizagi.rendering.checkList.extend(\"bizagi.rendering.checkList\", {}, {\r\n\r\n    /*\r\n     *   Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        // Call base \r\n        this._super();\r\n        // Set control container to behave as a block\r\n        control.addClass(\"ui-bizagi-render-display-block\");\r\n        self.properties.unique = Math.ceil(Math.random() * 1000);\r\n        // Apply plugin\r\n        //$(\".ui-bizagi-render-checkList-label\", self.checkListGroup).check();\r\n    },\r\n\r\n    /*\r\n     *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\r\n    configureHandlers: function() {\r\n        var self = this;\r\n        // Call base\r\n        self._super();\r\n        // Bind change event\r\n        if (!bizagi.util.isIE()) {\r\n            // PLUGIN IMPLEMENTATION\r\n            //todo: change bind type for IE\r\n            $(\"input[type=checkbox]\", self.checkListGroup).bind(\"change\", function(evt, ui) {\r\n                var itemId = $(this).data(\"item-guid\");\r\n                var checked = false;\r\n                if ($(this).hasClass(\"bz-check\")) {\r\n                    $(this).removeClass(\"bz-check\").addClass(\"bz-full-ball\");\r\n                    checked = false;\r\n                } else {\r\n                    $(this).removeClass(\"bz-full-ball\").addClass(\"bz-check\");\r\n                    checked = true;\r\n                }\r\n                self.onCheckListGroupChange(itemId, checked);\r\n            });\r\n        } else {\r\n            // NON PLUGIN IMPLEMENTATION\r\n            $(\"input[type=checkbox]\", self.checkListGroup).bind(\"change\", function(evt, ui) {\r\n                var itemId = $(this).data(\"item-guid\");\r\n                var checked = false;\r\n                if ($(this).hasClass(\"bz-check\")) {\r\n                    $(this).removeClass(\"bz-check\").addClass(\"bz-full-ball\");\r\n                    checked = false;\r\n                } else {\r\n                    $(this).removeClass(\"bz-full-ball\").addClass(\"bz-check\");\r\n                    checked = true;\r\n                }\r\n                self.onCheckListGroupChange(itemId, checked);\r\n            });\r\n        }\r\n    },\r\n\r\n    onCheckListGroupChange: function(itemId, checked) {\r\n        var self = this;\r\n        var item;\r\n        var items = $.grep(self.properties.items, function(element, index) {\r\n            return element.guid === itemId;\r\n        });\r\n        if (items && items.length > 0) {\r\n            item = items[0];\r\n        }\r\n        item.checked = checked;\r\n    },\r\n\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    clearDisplayValue: function() {\r\n        var self = this;\r\n        if (!bizagi.util.isIE()) {\r\n            // PLUGIN IMPLEMENTATION\r\n            $(\"input[type=checkbox]\", self.checkListGroup).check(\"uncheckItem\");\r\n        } else {\r\n            // NON PLUGIN IMPLEMENTATION\r\n            $(\"input[type=checkbox]\", self.checkListGroup).removeAttr(\"checked\");\r\n        }\r\n    },\r\n\r\n    setDisplayValue: function(value) {\r\n        var self = this;\r\n    }\r\n\r\n});\r\n","/*  \r\n *   Name: BizAgi Desktop Render list Extension\r\n *   Author: Iván Ricardo Taimal Narváez\r\n *   Comments:\r\n *   -   This script will redefine the list render class to adjust to desktop devices\r\n */\r\n\r\n// Extends from base list\r\nbizagi.rendering.checkList.extend(\"bizagi.rendering.activityCheckList\", {}, {\r\n\r\n    /*\r\n     *   Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        // Call base\r\n        this._super();\r\n        self.header = $(\".ui-bizagi-render-checkList-activity-work\", self.element);\r\n        self.addButton = $(\".ui-bizagi-render-checkList-add-item\", self.control);\r\n        self.newItemName = $(\".ui-bizagi-render-checkList-input-name\", self.control);\r\n        self.separator = $(\".ui-bizagi-render-checkList-separator\", self.element);\r\n        self.goalActivity = $(\".ui-bizagi-render-checkList-goal-activity\", self.element);\r\n        self.addEditButton = $(\".add-edit-item-button-checklist\", self.control);\r\n        self.cancelEditButton = $(\".cancel-edit-item-button-checklist\", self.control);\r\n        self.additionalElements();\r\n        //self.configureHandlers();\r\n\r\n        self.notifyLoadItems();\r\n\r\n        //self.configureProgressHandlers();\r\n    },\r\n\r\n    /**\r\n     * Event Handlers\r\n     *\r\n    configureProgressHandlers: function () {\r\n        var self = this;\r\n\r\n        bizagi.webpart.subscribe('onLoadDataFromFormActivityPlan', function (e, params) {\r\n            var activityWorkTitle = self.getResource(\"render-activity-check-list-activitywork\") + \" (\" + params.activityWork.progress + \"%)\";\r\n\r\n            $(\".ui-bizagi-render-checkList-activity-work\").text(activityWorkTitle);\r\n            e.stopImmediatePropagation();\r\n        });\r\n    },*/\r\n\r\n    notifyLoadItems: function(){\r\n        var self = this;\r\n        setTimeout(function(){\r\n            var resolvedItems = self.properties.items.filter(function(i){\r\n                return i.resolved\r\n            }).length;\r\n            bizagi.util.setItemLocalStorage(\"newChanges\", JSON.stringify({\r\n                'hasChanges': true,\r\n                'idActivity': self.properties.idActivity,\r\n                'itemsResolved': resolvedItems,\r\n                'items': self.properties.items,\r\n                'progress': self.properties.activityWork\r\n            }));\r\n\r\n            bizagi.webpart.publish(\"onLoadDataItemsFromFormActivityPlan\", { \"items\": self.properties.items, \"activityWork\": self.properties.activityWork });\r\n        }, 100);\r\n    },\r\n\r\n    additionalElements: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var activityWorkTitle = this.getResource(\"render-activity-check-list-activitywork\") + \" (\" + self.properties.activityWork + \"%)\";\r\n        var activityFormTitle = this.getResource(\"render-activity-check-list-form\");\r\n        if (!(self.header && self.header.length > 0)) {\r\n            self.element.prepend($(\"<div/>\").addClass(\"ui-bizagi-render-checkList-activity-work\").append($(\"<span/>\").text(bizagi.localization.getResource(\"workportal-project-plan-activity-work-title\"))));\r\n        }\r\n        if (!(self.goalActivity && self.goalActivity.length > 0)) {\r\n            if(self.properties.activityDescription && self.properties.activityDescription !== \"\"){\r\n                self.element.prepend($(\"<div/>\").addClass(\"ui-bizagi-render-checkList-goal-activity\").append(\"<h4><span class='ui-bizagi-wp-bold'>\" +\r\n                bizagi.localization.getResource(\"workportal-project-plan-activity-goal\") +\r\n                \": </span><span>\" + self.properties.activityDescription  + \"</span></h4>\"));\r\n            }\r\n        }\r\n        if (!(self.addButton && self.addButton.length > 0)) {\r\n            self.control.append($(\"<div/>\").addClass(\"ui-bizagi-render-checkList-add-item\").append($(\"<button/>\").text(\"+\")));\r\n        }\r\n        if (!(self.separator && self.separator.length > 0)) {\r\n            self.element.append($(\"<div/>\").addClass(\"ui-bizagi-render-checkList-separator\").append($(\"<span/>\").text(activityFormTitle)));\r\n        }\r\n        if (self.addEditButton && self.addEditButton.length > 0) {\r\n                self.addEditButton.hide();\r\n        }\r\n        if (self.cancelEditButton && self.cancelEditButton.length > 0) {\r\n                self.cancelEditButton.hide();\r\n        }\r\n        control.parent().addClass(\"render-activity-check\");\r\n    },\r\n\r\n    configureHandlers: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        this._super();\r\n\r\n        $(\".ui-bizagi-render-checkList-add-item button\", control).unbind(\"click\").click(function() {\r\n            var itemSelected = $(\".ui-bizagi-render-checkList-item.selected\", self.control);\r\n            if (itemSelected.length <= 0) {\r\n                self.prepareNewItem();\r\n            } else {\r\n                $(\".ui-bizagi-render-checkList-input-name\", itemSelected).focus();\r\n            }\r\n        });\r\n\r\n        $(\".delete-item-from-activity\", self.control).bind(\"click\", function() {\r\n            var that = this;\r\n            var message = bizagi.localization.getResource(\"workportal-widget-reports-confirm\");\r\n            var contentHolder = $(this).closest(\".ui-bizagi-render-checkList-item\");\r\n\r\n            contentHolder.addClass(\"ui-bizagi-to-remove\");\r\n\r\n            $.when(bizagi.showConfirmationBox(message, \"Bizagi\", \"info\"))\r\n                .done(function() {\r\n\r\n                    var itemId = $(that).closest(\".ui-bizagi-render-checkList-item\").data(\"item-guid\");\r\n\r\n                    self.deleteItem(itemId);\r\n                    self.addButton.show();\r\n\r\n                }).fail(function() {\r\n                    contentHolder.removeClass(\"ui-bizagi-to-remove\");\r\n                });\r\n        });\r\n\r\n        $(\".activity-work-items\", self.control).bind(\"click\", function() {\r\n            var element = $(this).closest(\".ui-bizagi-render-checkList-item\");\r\n            var itemId = element.data(\"item-guid\");\r\n            var itemPosition = element.data(\"item-position\");\r\n            self.selectItem(itemId, itemPosition);\r\n        });\r\n    },\r\n\r\n    selectItem: function (itemId) {\r\n        var self = this;\r\n\r\n        for (var i = 0; i < self.properties.items.length; i++) {\r\n            self.properties.items[i].selected = self.properties.items[i].guid === itemId;\r\n        }\r\n        self.repaintControl();\r\n        var itemSelected = $(\".ui-bizagi-render-checkList-item.selected\");\r\n        var itemSelectedName = $(\".ui-bizagi-render-checkList-input-name\", itemSelected);\r\n        var itemContent = itemSelectedName.val();\r\n        itemSelectedName.focus();\r\n        itemSelectedName[0].setSelectionRange(itemContent.length, itemContent.length);\r\n        self.configureHandlers();\r\n        self.addSelectedHandlers();\r\n    },\r\n\r\n    deleteItem: function (itemId) {\r\n        var self = this;\r\n        for (var i = 0; i < self.properties.items.length ; i++) {\r\n            if (self.properties.items[i].guid === itemId) {\r\n                self.properties.items.splice(i,1);\r\n                break;\r\n            }\r\n        }\r\n        self.setValue(self.properties.items);\r\n        self.repaintControl();\r\n        self.configureHandlers();\r\n        self.addSelectedHandlers();\r\n    },\r\n\r\n    prepareNewItem: function () {\r\n        var self = this;\r\n        var newItem = {\r\n            guid: Math.guid(),\r\n            resolved: false,\r\n            name: \"\",\r\n            selected: true\r\n        };\r\n        self.properties.items.push(newItem);\r\n        self.repaintControl();\r\n        self.addButton.hide();\r\n        self.newItemName.focus();\r\n        self.newItemName.blur(function () {\r\n             var itemSelected = $(\".ui-bizagi-render-checkList-item.selected\", self.control);\r\n             var itemSelectedName = $(\".ui-bizagi-render-checkList-input-name\", itemSelected);\r\n             var valueInput = itemSelectedName.val();\r\n\r\n             if(valueInput === \"\" && self.properties.items && self.properties.items.length >= 1\r\n                    && self.properties.items.slice(-1)[0].name === \"\"){\r\n                self.properties.items.pop();\r\n             }\r\n        });\r\n        self.addSelectedHandlers();\r\n        self.newItemName.keypress(function (event) {\r\n            if (event.which == 13) {\r\n                event.preventDefault();\r\n                self.addItem();\r\n                self.prepareNewItem();\r\n            }\r\n        });\r\n    },\r\n\r\n    addSelectedHandlers: function () {\r\n        var self = this;\r\n        var itemSelected = $(\".ui-bizagi-render-checkList-item.selected\", self.control);\r\n        var itemSelectedName = $(\".ui-bizagi-render-checkList-input-name\", itemSelected);\r\n        itemSelectedName.focus();\r\n        $(\".add-item-button-checklist\", itemSelected).bind(\"click\", function () {\r\n            var newItemName = itemSelectedName.val();\r\n            if (newItemName && newItemName !== \"\") {\r\n                self.addItem();\r\n            }\r\n        });\r\n        $(\".cancel-item-button-checklist\", itemSelected).bind(\"click\", function (e) {\r\n            var newItemName = itemSelectedName.val();\r\n            var element = $(this).closest(\".ui-bizagi-render-checkList-item\");\r\n            var itemPosition = element.data(\"item-position\");\r\n            var guidItem = element.data(\"item-guid\");\r\n\r\n            if (newItemName && newItemName !== \"\" && self.properties.items[itemPosition].name !== \"\") {\r\n                self.properties.items[itemPosition].selected = false;\r\n            }\r\n            if (newItemName === \"\" || self.properties.items[itemPosition].name === \"\") {\r\n                self.deleteItem(guidItem);\r\n            }\r\n            self.addButton.show();\r\n            self.repaintControl();\r\n            self.configureHandlers();\r\n        });\r\n    },\r\n\r\n    addItem: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        var itemSelected = $(\".ui-bizagi-render-checkList-item.selected\", self.control);\r\n        var itemSelectedName = $(\".ui-bizagi-render-checkList-input-name\", itemSelected);\r\n        var newItemName = itemSelectedName.val();\r\n\r\n        $.each(self.properties.items, function (index, item) {\r\n            if (item.selected) {\r\n                item.name = newItemName;\r\n                item.selected = false;\r\n            }\r\n        });\r\n        self.updateOriginalValue();\r\n        self.setValue(self.properties.items);\r\n        self.repaintControl();\r\n        self.configureHandlers();\r\n        self.addButton.show();\r\n    },\r\n\r\n    repaintControl: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var checkListHtml = self.renderControl();\r\n        $(\".ui-bizagi-render-checkList\", self.control).replaceWith(checkListHtml);\r\n        self.postRender();\r\n    },\r\n\r\n    onCheckListGroupChange: function (itemId, checked) {\r\n        var self = this;\r\n        var item;\r\n        var items = $.grep(self.properties.items, function (element, index) {\r\n            return element.guid === itemId;\r\n        });\r\n        if (items && items.length > 0) {\r\n            item = items[0];\r\n        }\r\n        item.resolved = checked;\r\n        self.setValue(self.properties.items);\r\n        self.refreshValue(self.properties.items);\r\n    },\r\n\r\n    refreshValue: function(items){\r\n        var self = this,\r\n            control = self.getControl(),\r\n            length = items.length,\r\n            completed = 0;\r\n\r\n        for (var i = 0; i < length; i++) {\r\n            if (items[i].resolved) {\r\n                completed += 1;\r\n            }\r\n        }\r\n\r\n        if (length > 0) {\r\n            self.properties.activityWork = Math.floor(100 * completed / length);\r\n        }\r\n        else {\r\n            self.properties.activityWork = 100;\r\n        }\r\n\r\n        self.notifyLoadItems();\r\n    },\r\n\r\n    getValue: function (data) {\r\n        var self = this;\r\n\r\n        return self.value || [];\r\n    },\r\n\r\n    controlValueIsChanged: function () {\r\n        var self = this;\r\n        var originalValue = JSON.stringify(self.properties.originalValue);\r\n        var newValue = JSON.stringify(self.value);\r\n        return originalValue !== newValue;\r\n    },\r\n\r\n    /*\r\n     *   Updates original value for some comparisons\r\n     */\r\n    updateOriginalValue: function () {\r\n        var self = this;\r\n        self.properties.originalValue = bizagi.clone(self.value);\r\n    },\r\n\r\n    /*\r\n     *   Add the render data to the given collection in order to send data to the server\r\n     */\r\n    collectData: function (renderValues) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Add the render value\r\n        var xpath = properties.xpath;\r\n        var value = self.getValue();\r\n        var idActivity = self.properties.idActivity;\r\n\r\n        if (self.controlValueIsChanged()) {\r\n            // Filter by valid xpaths and valid values\r\n            if (!bizagi.util.isEmpty(xpath) && !bizagi.util.isEmpty(idActivity)) {\r\n                if (Array.isArray(value)) {\r\n                    renderValues[properties.xpath] = {\r\n                        idActivity: idActivity,\r\n                        items: value\r\n                    };\r\n                } else if (value === \"\") {\r\n                    renderValues[properties.xpath] = \"\";\r\n                }\r\n            }\r\n        }else{\r\n            bizagi.util.setItemLocalStorage(\"newChanges\", JSON.stringify({\r\n                'hasChanges': false\r\n            }));\r\n        }\r\n    },\r\n\r\n    isValid: function (invalidElements) {\r\n        var self = this,\r\n            properties = self.properties,\r\n            message;\r\n        var items = self.getValue();\r\n        message = self.getResource(\"render-activity-check-list-validation\");\r\n        for (var i = 0; i < items.length; i+=1) {\r\n            var item = items[i];\r\n            if (!item.resolved) {\r\n                invalidElements.push({\r\n                    xpath: properties.xpath,\r\n                    message: message\r\n                });\r\n                break;\r\n            }\r\n        }\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Render Layout Image Class\r\n *   Author: Ricardo Pérez\r\n *   Comments:\r\n *   -   This script will define basic stuff for non editable image control inside templates\r\n *   -   This control is based on the image no flash render control\r\n */\r\n\r\nbizagi.rendering.layoutImage.extend(\"bizagi.rendering.layoutImage\", {\r\n\r\n}, {\r\n    renderControl: function () {\r\n        var self = this;\r\n        var templateUri = self.renderFactory.getTemplate(\"layout-image\");\r\n        self.control = self.getControl();\r\n        return $.kendoTmpl(templateUri, {});\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        if (self.value && typeof self.value.value !== \"undefined\" && self.value.value !== \"\" && self.value.value !== null) {\r\n            //Get image of customer in binary format\r\n            var url = self.getImageUri();\r\n            $.ajax({\r\n                url: url,\r\n                type: \"GET\",\r\n                dataType: \"binary\",\r\n                processData: false,\r\n                success: function (blob) {\r\n\r\n                    if (typeof blob == \"string\") {\r\n                        var xhr = arguments[2];\r\n                        var contentType = xhr.getResponseHeader('Content-type');\r\n                        blob = bizagi.util.media.byteArrayToBlob(bizagi.util.media.stringToByteArray(blob), contentType);\r\n                    }\r\n\r\n                    var urlCreator = window.URL || window.webkitURL;\r\n                    var imageUrl = urlCreator.createObjectURL(blob);\r\n\r\n                    $(control).find('img').attr(\"src\", imageUrl);\r\n                }\r\n            });\r\n        }\r\n    },\r\n    /**\r\n     * Gets the url to get the array image\r\n     */\r\n    getImageUri: function () {\r\n        var self = this;\r\n        var templateControl = self.parent.parent;\r\n        var renderParams = templateControl.properties.paramsRender || {};\r\n\r\n        var map = {\r\n            entity: self.value.guid,\r\n            surrogateKey: self.value.surrogateKey,\r\n            xpath: self.properties.xpath,\r\n            width: 96,\r\n            height: 96,\r\n            hash: self.value.value,\r\n            idcase: renderParams.idRender ? renderParams.formParams.idCase : \"_\",\r\n            idworkitem: renderParams.idRender ? renderParams.formParams.idWorkitem : \"_\",\r\n            contextxpath: renderParams.idRender ? renderParams.xpathActions : \"_\"\r\n        };\r\n\r\n        return self.dataService.serviceLocator.getUrl(\"render-entity-layout-imageByteArray\").replaceMultiple(map);\r\n    },\r\n    /**\r\n     *   Sets the value in the rendered control\r\n     */\r\n    getDisplayValue: function () {\r\n        var self = this;\r\n        return [self.value];\r\n    }\r\n});","/*\r\n *   Name: BizAgi Render Layout Simple Link Class\r\n *   Author: Ricardo Pérez\r\n *   Comments:\r\n *   -   This script will define basic stuff for non editable link renders inside templates\r\n *   -   This control is based on the link render control\r\n */\r\n\r\nbizagi.rendering.layoutLink.extend(\"bizagi.rendering.layoutLink\", {}, {\r\n    /*\r\n     *   Template method to implement in each children to customize each control\r\n     */\r\n    render: function () {\r\n        var self = this;\r\n        var container = self.getContainerRender();\r\n        container.addClass(\"bz-command-not-edit\");\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n        var element = self.element;\r\n        if (element) {\r\n            element.on(\"click\", $.proxy(self.onClickElement, self));\r\n        }\r\n    },\r\n\r\n    onClickElement: function () {\r\n        var self = this;\r\n        var params = {\r\n            'displayName': self.properties.displayName,\r\n            'navigateFromRender': false,\r\n            'reference': self.properties.reference,\r\n            'referenceType': self.properties.referenceType,\r\n            'xpath': self.properties.xpath\r\n        };\r\n\r\n        if (bizagi.kendoMobileApplication && bizagi.kendoMobileApplication.view().id === \"#renderSplitView\") {\r\n            params.navigateFromRender = true;\r\n        }\r\n\r\n        self.triggerGlobalHandler(\"DATA-NAVIGATION\", params);\r\n    }\r\n});","/*\r\n*   Name: BizAgi Render Layout Label Class\r\n*   Author: Ricardo Pérez\r\n*   Comments:\r\n*   -   This script will define basic stuff for labels inside templates\r\n*/\r\n\r\nbizagi.rendering.layoutLabel.extend(\"bizagi.rendering.layoutLabel\", {}, {\r\n    setValue: function (val, triggerEvents) {\r\n        var self = this;\r\n        self.properties.displayName = val;\r\n        this._super(val, triggerEvents);\r\n        var control = self.getControl();\r\n\r\n        if (control) {\r\n            $(\".ui-bizagi-render-label\", control).text(val);\r\n        }\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Render Layout Text Class\r\n*   Author: Ricardo Pérez\r\n*   Comments:\r\n*   -   This script will define basic stuff for text renders inside templates\r\n*/\r\n\r\nbizagi.rendering.layoutText.extend(\"bizagi.rendering.layoutText\", {}, {\r\n\r\n});","/*\r\n*   Name: BizAgi Desktop Render Template dateTime Extension\r\n*   Author: Andres Fernando Muñoz\r\n*   Comments:\r\n*   -   This script will redefine the date time render class inside templates to adjust to desktop devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.layoutDateTime.extend(\"bizagi.rendering.layoutDateTime\", {}, {\r\n\r\n});","/*\r\n *   Name: BizAgi Desktop Render Template number Extension\r\n *   Author: Mauricio Sanchez\r\n *   Comments:\r\n *   -   This script will redefine the number render class inside templates to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.layoutNumber.extend(\"bizagi.rendering.layoutNumber\", {}, {\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    setValue: function (value, triggerEvents) {\r\n        var self = this;\r\n        value = value ? self.getDisplayValue(value) : self.getDisplayValue(0);\r\n        self.properties.displayName = value;\r\n        this._super(value, triggerEvents);\r\n        var control = self.getControl();\r\n        if(control) {\r\n            $(\".ui-bizagi-render-number\", control).text(value);\r\n        }\r\n    }\r\n});","/*\r\n *   Name: BizAgi Desktop Render Template Money Extension\r\n *   Author: Andres Fernando Muñoz\r\n *   Comments:\r\n *   -   This script will redefine the money render class inside templates to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.layoutMoney.extend(\"bizagi.rendering.layoutMoney\", {}, {\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    setValue: function (value,triggerEvents) {\r\n        var self = this;\r\n        value = value ? self.getDisplayValue(value) : self.getDisplayValue(0);\r\n        self.properties.displayName = value;\r\n        this._super(value, triggerEvents);\r\n        var control = self.getControl();\r\n        if(control) {\r\n            $(\".ui-bizagi-render-number\", control).text(value);\r\n        }\r\n    }\r\n});","/*\r\n *   Name: BizAgi Desktop Render Layout Upload\r\n *   Author: Bizagi\r\n *   Comments:\r\n *   -   This script will define the upload on entity template\r\n */\r\n\r\nbizagi.rendering.layoutUpload.extend(\"bizagi.rendering.layoutUpload\", {}, {\r\n    /**\r\n     *   Template method to implement in each children to customize each control\r\n     */\r\n    renderControl: function () {\r\n        var self = this,\r\n            properties = self.properties,\r\n            defer = $.Deferred();\r\n\r\n        $.when(self.getValueFilesByData(bizagi.clone(properties))).done(function(properties, valueResult){\r\n            self.properties = properties;\r\n            self.files = valueResult.files;\r\n            defer.resolve(self.getHTMLFiles());\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    getHTMLFiles: function(){\r\n        var self = this;\r\n        var files = $.map(self.files, function(el){\r\n            var file = {\"id\": el[0], \"filename\": el[1]};\r\n            file.url =  self.buildItemUrl(file);\r\n            return file;\r\n        });\r\n\r\n        var template = self.renderFactory.getTemplate(\"layout-upload\");\r\n        return $.fasttmpl(template, {\"files\": files});\r\n    },\r\n\r\n    postRender: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        var filesLinkElements = control.find(\".ui-bizagi-render-layout-upload-item a\");\r\n\r\n        filesLinkElements.on(\"click\", function () {\r\n            bizagi.loading.start();\r\n            $.when(bizagi.util.media.downloadFile($(this).attr(\"data-url\"), this.title)).fail(function (error) {\r\n                if (error.responseText){\r\n                    self.getFormContainer().failHandler(error.responseText);\r\n                }\r\n            }).always(function(){\r\n                bizagi.loading.stop();\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     *   Builds the upload item url\r\n     */\r\n    buildItemUrl: function (file) {\r\n        var self = this,\r\n            properties = self.properties;\r\n\r\n        var form = self.getFormContainer();\r\n\r\n        return self.dataService.getUploadFileEntityUrl({\r\n            isContextContainerWidgetRender: self.isContextContainerWidgetRender(),\r\n            xpath: self.getUploadXpath(),\r\n            fileId: file.id,\r\n            idRender: form.properties.paramsRender.idRender || \"undefined\",\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: form.properties.paramsRender.idPageCache || \"undefined\",\r\n            xpathActions: form.properties.paramsRender.xpathActions || \"undefined\",\r\n            sessionId: form.properties.sessionId,\r\n            surrogatekey: self.properties.value.surrogateKey,\r\n            guidentity: self.properties.value.guid\r\n        });\r\n    }\r\n});","/*\r\n *   Name: BizAgi Tablet Render Form Link Extension\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will redefine the link render class to adjust to tablet devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.formLink.extend(\"bizagi.rendering.formLink\", {}, {\r\n    /* POSTRENDER\r\n     ===========================================*/\r\n    postRender: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var link = $(\".ui-bizagi-render-link\", control);\r\n\r\n        // Bind click event\r\n        link.click(function() {\r\n            // Open the link inside a slideForm\r\n            if(self.properties.hasentryrule) {\r\n                var form = self.getFormContainer();\r\n                $.when(form.saveForm()).done(function () {\r\n                    self.submitCheckpointRequest().done(function () {\r\n                        return self.openLinkRule(\"entryrule\");\r\n                    });\r\n                });\r\n            } else {\r\n                self.openLink();\r\n            }\r\n\r\n        });\r\n\r\n        if (!self.properties.editable) {\r\n            self.element.addClass(\"bz-rn-read-only\");\r\n        }\r\n    },\r\n\r\n    /* OPENS LINK DISPLAY FORM INSIDE A DIALOG\r\n     ===========================================*/\r\n    openLink: function() {\r\n        var self = this;\r\n        // var form = self.getFormContainer();\r\n\r\n        // Fixed multiple recursion of Formlinks inside Formlinks\r\n        // var formParams = $.extend({}, form.params, self.getFormParams());\r\n\r\n        // Send edit request\r\n        $.when(self.submitEditRequest())\r\n            .done(function() {\r\n                bizagi.util.tablet.startLoading();\r\n                //self.paintFormLink();\r\n\r\n                $.when(self.paintFormLink()).done(function () {\r\n                    bizagi.util.tablet.stopLoading();\r\n                }).fail(function () { //Executes Rollback actionpaintForm\r\n                    bizagi.util.tablet.startLoading();\r\n                    self.rollbackForm();\r\n                }).always(function () {\r\n                    bizagi.util.tablet.stopLoading();\r\n                });\r\n\r\n            }).always(function () {\r\n            bizagi.util.tablet.stopLoading();\r\n        });\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    openLinkRule: function (property) {\r\n        var self = this;\r\n        var def = new $.Deferred();\r\n\r\n        bizagi.util.tablet.startLoading();\r\n\r\n        self.getPropertyValue(property, {})\r\n            .done(function (dataRuleResp) {\r\n\t    \tdataRuleResp = dataRuleResp || {};\r\n                if (typeof dataRuleResp.messages !== \"undefined\" && dataRuleResp.messages !== null) {\r\n                    var message = dataRuleResp.messages[0];\r\n                    var form = self.getFormContainer();\r\n                    form.validationController.showErrorMessage(message);\r\n                    def.reject();\r\n                } else {\r\n                    if (property == \"entryrule\") {\r\n                        self.openLink();\r\n                    }\r\n                }\r\n                def.resolve();\r\n            }).fail(function(){\r\n            def.reject();\r\n        })\r\n            .always(function () {\r\n                bizagi.util.tablet.stopLoading();\r\n            });\r\n        return def.promise();\r\n    },\r\n\r\n    /*\r\n     *   Method to render non editable values\r\n     */\r\n    postRenderReadOnly: function() {\r\n        var self = this;\r\n\r\n        // Execute the same as post-render\r\n        self.postRender();\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    paintFormLink: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var form = self.getFormContainer();\r\n        var formParams = self.getFormParams();\r\n\r\n        var deferred = $.Deferred();\r\n\r\n        // Instantiate slide form object\r\n        var slideView = new bizagi.rendering.tablet.slide.view(self.dataService, self.renderFactory, {\r\n            title: self.properties.displayName || \"\",\r\n            container: form.container,\r\n            navigation: self.getParams().navigation,\r\n            showSaveButton: properties.editable,\r\n            orientation: properties.orientation || \"ltr\",\r\n            onSave: function(data) {\r\n                // When the data is saved then\r\n                return self.actionSave(data).then(function (result) {\r\n                    //Process the result\r\n                    return self.submitForm(result)\r\n                        .done(function () {\r\n                            deferred.resolve(result);\r\n                        }).fail(function() {\r\n                            deferred.reject();\r\n                        });\r\n                }).fail(function (result) {\r\n                    deferred.reject(result);\r\n                });\r\n            },\r\n            goBack: function(){\r\n                self.rollbackForm();\r\n            }\r\n        });\r\n\r\n        slideView.render({\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            recordXPath: self.getFormLinkXpath(),\r\n            requestedForm: \"linkform\",\r\n            editable: properties.editable,\r\n            formParams: formParams,\r\n            url: properties.editPage\r\n        }).fail(function() {\r\n            // Sends a rollback request to delete checkpoints\r\n            deferred.reject();\r\n        });\r\n\r\n        return deferred.promise();\r\n    },\r\n\r\n    getPropertyValue: function (propertyName, params) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var defer = new $.Deferred();\r\n\r\n        self.dataService.multiaction().getPropertyData({\r\n            url: properties.dataUrl,\r\n            xpath: properties.xpath,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext,\r\n            idPageCache: properties.idPageCache,\r\n            property: propertyName,\r\n            extra: params,\r\n            dataType: params ? params.dataType : null\r\n        }).done(function (data) {\r\n            if (data.type == \"error\") {\r\n                // Workflow engine error, we gotta show it with error\r\n                var form = self.getFormContainer();\r\n                form.validationController.showErrorMessage(data.message);\r\n                defer.reject(data);\r\n            } else {\r\n                defer.resolve(data);\r\n            }\r\n        }).fail(function (jqXHR, textStatus, errorThrown) {\r\n            // Add error messages\r\n            var form = self.getFormContainer();\r\n            form.validationController.showErrorMessage(jqXHR.message);\r\n            defer.reject(jqXHR, textStatus, errorThrown);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    actionSave: function (data) {\r\n        var self = this;\r\n        var deferred = $.Deferred();\r\n\r\n        $.when(self.submitSaveRequest(data)).done(function (result) {\r\n            try {\r\n                if (result.type == \"validationMessages\") {\r\n                    // Add validation messages\r\n                    self.form.addValidationMessage(result.messages);\r\n                } else if (result.type == \"error\") {\r\n                    // Add error messages\r\n                    deferred.reject(result);\r\n                }\r\n\r\n                deferred.resolve(result);\r\n            } catch (ex) {\r\n                deferred.reject({ noAction: true });\r\n            }\r\n        }).fail( function(data) {\r\n            deferred.reject(data);\r\n        });\r\n\r\n        return deferred.promise();\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    submitSaveRequest: function (data) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Don't send request when the link is not editable\r\n        if (properties.editable === false && !properties.value) {\r\n            return null;\r\n        }\r\n\r\n        var xpath = self.getFormLinkXpath();\r\n        return self.dataService.saveLinkForm({\r\n            url: properties.saveUrl,\r\n            idRender: properties.id,\r\n            xpathContext: properties.xpathContext === undefined || properties.xpathContext === \"\" ? xpath : (xpath ? properties.xpathContext + \".\" + xpath : properties.xpathContext),\r\n            submitData: data\r\n        });\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    submitForm: function(result) {\r\n        var self = this;\r\n        var deferred = $.Deferred();\r\n\r\n        var executeSubmitOnChange = true;\r\n\r\n        if (result && result.type == \"validationMessages\") {\r\n            executeSubmitOnChange = false;\r\n        }\r\n\r\n        if (self.properties.hasexitrule) {\r\n            self.closeExitRule().done(function () {\r\n                if(executeSubmitOnChange) {\r\n                    //All commits must be resolved before the submitOnChange is executed\r\n                    self.submitCommitRequest().done(function () {\r\n                        if(self.properties.hasentryrule){\r\n                            self.submitCommitRequest().done(function(){\r\n                                $.when(self.submitOnChange()).done(function(){\r\n                                    deferred.resolve(result);\r\n                                });\r\n                            });\r\n                        } else{\r\n                            $.when(self.submitOnChange()).done(function(){\r\n                                deferred.resolve(result);\r\n                            });\r\n                        }\r\n                    });\r\n                }\r\n            }).fail(function(){\r\n                deferred.reject();\r\n            });\r\n\r\n        } else if (executeSubmitOnChange) {\r\n            if(executeSubmitOnChange) {\r\n                //All commits must be resolved before the submitOnChange is executed\r\n                self.submitCommitRequest().done(function () {\r\n                    if(self.properties.hasentryrule){\r\n                        self.submitCommitRequest().done(function(){\r\n                            $.when(self.submitOnChange()).done(function(){\r\n                                deferred.resolve(result);\r\n                            });\r\n                        });\r\n                    } else {\r\n                        $.when(self.submitOnChange()).done(function(){\r\n                            deferred.resolve(result);\r\n                        });\r\n                    }\r\n                }).fail( function() {\r\n                    deferred.reject();\r\n                });\r\n            }\r\n        }\r\n\r\n        return deferred.promise();\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    closeExitRule: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var def = new $.Deferred();\r\n\r\n        if (properties.hasexitrule) {\r\n            $.when(self.openLinkRule(\"exitrule\")).done(function (result) {\r\n                def.resolve(result);\r\n            }).fail(function(){\r\n                def.reject();\r\n            });\r\n        }\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /*\r\n     *\r\n     */\r\n    rollbackForm: function () {\r\n        var self = this;\r\n\r\n        $.when(self.submitRollbackRequest()).done(function () {\r\n            //Sends additional rollback request to delete checkpoint from entry rule\r\n            if (self.properties.hasentryrule) {\r\n                self.submitRollbackRequest();\r\n            }\r\n        });\r\n    },\r\n\r\n    getFormLinkXpathContext: function () {\r\n        var self = this;\r\n        var xpathContext = self.properties.xpathContext;\r\n        var parentXpathContext = self.getXpathContext();\r\n        if (parentXpathContext && xpathContext) {\r\n            if (xpathContext.indexOf(parentXpathContext) === 0) {\r\n                return xpathContext;\r\n            } else {\r\n                return parentXpathContext + \".\" + xpathContext;\r\n            }\r\n        } else {\r\n            return xpathContext;\r\n        }\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi tablet Render Hidden Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the hidden render class to adjust to tablet devices\r\n*/\r\n\r\n\r\n// Extends itself\r\nbizagi.rendering.hidden.extend(\"bizagi.rendering.hidden\", {}, {\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Tablet Render Money Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the money render class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.money.extend(\"bizagi.rendering.money\", {}, {\r\n\r\n    renderReadOnly: function() {\r\n        var self = this;\r\n        var value = self._super();\r\n        var template = self.renderFactory.getTemplate(\"readonlyNumber\");\r\n        var tmpl = $($.kendoTmpl(template, {value: value}));\r\n        $(\".bz-cm-icon\", tmpl).removeClass(\"bz-rn-icon-number\").removeClass(\"bz-number-icon\").addClass(\"bz-coin-input\").addClass(\"bz-rn-icon-coin\");\r\n\r\n        return tmpl.get(0).outerHTML;\r\n    },\r\n\r\n    /* POSTRENDER \r\n    =====================================================*/\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n\r\n        self.numericInput = $(\".ui-bizagi-render-numeric\", self.getControl());\r\n        self.numericIcon = $(\".bz-cm-icon\", self.getControl());\r\n\r\n        self.numericIcon.removeClass(\"bz-rn-icon-number\").addClass(\"bz-rn-icon-coin\");        \r\n        self.numericIcon.removeClass(\"bz-number-icon\").addClass(\"bz-coin-input\");\r\n\r\n        //Adjust the input in order to accept the comma input as decimal separator for certain language standars\r\n        if(self.properties.decimalSymbol == ',') {\r\n            self.numericInput.attr(\"lang\", \"en-150\");\r\n        }\r\n\r\n        var input = $(\"input\", self.element);\r\n        if (!input || input.length == 0) return;\r\n    },\r\n\r\n\r\n    /*\r\n    *\r\n    */\r\n    postRenderReadOnly: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        control.closest(\".ui-bizagi-render\").addClass(\"bz-rn-read-only\");\r\n        self.numericInput = $(\".ui-bizagi-render-numeric\", control);\r\n    },\r\n\r\n    /* SETS THE VALUE IN THE RENDERED CONTROL\r\n    =====================================================*/\r\n    setDisplayValue: function(value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Set value in input\r\n        if (value != null) {\r\n            if (properties.editable) {\r\n                self.numericInput.val(value);\r\n\r\n                // Formats the input\r\n                self.attachFormatCurrency();\r\n                self.executeFormatCurrencyPlugin();\r\n            } else {\r\n                self.numericInput.text(self.getDisplayValue());\r\n            }\r\n        }\r\n    }\r\n});","/*  \r\n *   Name: BizAgi Tablet Render list Extension\r\n *   Author: Bizagi Mobile Team\r\n *   Comments:\r\n *   -   This script will redefine the list render class to adjust to tablet devices\r\n */\r\n\r\n// Extends from base list\r\nbizagi.rendering.radio.extend('bizagi.rendering.radio', {}, {\r\n\r\n    /**\r\n     * Post render\r\n     * @returns {} \r\n     */\r\n    postRender: function() {\r\n        var self = this;\r\n\r\n        // Call base \r\n        this._super();\r\n\r\n        self.combo = self.getControl();\r\n\r\n        // Set control container to behave as a block\r\n        self.combo.addClass(\"ui-bizagi-render-control-radio\");\r\n\r\n        // Help Text Control\r\n        self.configureHelpText();\r\n\r\n        // Bind changes to set value\r\n        self.combo.change(function () {\r\n            var selectedRadio = self.combo.find(\"input:radio:checked\");\r\n\r\n            self.combo.find(\".checked\").removeClass(\"checked\");\r\n            self.combo.find(\".bz-check\").addClass(\"bz-unchecked\").removeClass(\"bz-check\");\r\n\r\n            selectedRadio.closest(\"div\").addClass(\"checked\");\r\n            selectedRadio.addClass(\"bz-check\");\r\n            selectedRadio.removeClass(\"bz-unchecked\");\r\n\r\n            // The value is the Id LOL\r\n            var newValue = {\r\n                id: selectedRadio.prop(\"value\"),\r\n                value: selectedRadio.siblings(\"label\").text()\r\n            };\r\n\r\n            self.setValue(newValue);\r\n        });\r\n    },\r\n\r\n    renderReadOnly: function () {        \r\n        var template = this.renderFactory.getTemplate(\"readonly\");\r\n        return $.kendoTmpl(template, {});\r\n    },\r\n\r\n    /**\r\n     * Set display readonly\r\n     * @returns {} \r\n     */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var container = self.getControl();\r\n\r\n        self._super();\r\n\r\n        container.addClass(\"bz-rn-read-only\");\r\n\r\n        // Help Text Control\r\n        self.configureHelpText();\r\n    },\r\n\r\n    /**\r\n     * Set display value\r\n     * @param {} value \r\n     * @returns {} \r\n     */\r\n    setDisplayValue: function(value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (value !== undefined && value.id != null) {\r\n            if (properties.editable) {\r\n                // Find the control to check where value is\r\n                var comboItem = self.combo.find(\"input[type='radio'][value='\" + value.id + \"']\");\r\n                comboItem.prop(\"checked\", \"checked\");\r\n                comboItem.closest(\"div\").addClass(\"checked\");\r\n                comboItem.addClass(\"bz-check\").removeClass(\"bz-unchecked\");\r\n            } else {\r\n                // Find the control to check where value is\r\n                self.getControl().html(value.value);\r\n            }\r\n        }\r\n    },\r\n\r\n    \r\n\r\n    /**\r\n     * Cleans current data\r\n     */\r\n    cleanData: function () {\r\n        var self = this;\r\n        var value = { id: \"\", value: \"\" };\r\n        var selectedItem = self.element.find(\".ui-bizagi-render-radio-item .bz-check\");\r\n\r\n        selectedItem.prop(\"checked\", false).removeClass(\"bz-check\").addClass(\"bz-unchecked\");\r\n        self.setValue(value, false);\r\n        self.setDisplayValue(value);\r\n    }\r\n});","/*\r\n *   Name: BizAgi Tablet Render Cascading combo Extension\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will redefine the cascading combo render class to adjust to tablet devices\r\n */\r\n\r\n// Extends from base cascading combo, then apply tablet combo stuff\r\nbizagi.rendering.cascadingCombo.extend(\"bizagi.rendering.cascadingCombo\", {}, {\r\n\r\n    init: function(params){\r\n        var self = this;\r\n        self._super(params);\r\n        this.properties.data = this.properties.data || [];\r\n\r\n        self.bind(\"select\", function (ex, value) {\r\n            self.onComboChange(value);\r\n        });\r\n    },\r\n    /*\r\n     * Generates the read-only render control\r\n     */\r\n    renderReadOnly: function() {\r\n        return bizagi.rendering.combo.prototype.renderReadOnly.apply(this, arguments);\r\n    },\r\n\r\n    initializeCombo: function() {\r\n        var self = this;\r\n        var parentCombo = self.getParentCombo();\r\n        if (parentCombo != null) {\r\n            if (parentCombo.properties.type == \"cascadingCombo\") {\r\n                self.isDependant = true;\r\n                parentCombo.dependants.push(self);\r\n                if (self.getValue() != null) {\r\n                    self.properties.parentComboValue = self.getValue().id;\r\n                } else {\r\n                    self.initializingCascadingCombo = true;\r\n                }\r\n            }\r\n        }\r\n\r\n        self.initialValueSet = true;\r\n        $.when(bizagi.rendering.combo.prototype.initializeCombo.apply(self, arguments))\r\n            .done(function() {\r\n                if (self.value && self.isDependant == false){\r\n                    self.triggerHandler(\"select\", self.value);\r\n                }\r\n                self.initialValueSet = false;\r\n            });\r\n    },\r\n\r\n    bindDependantCombo: function(){\r\n\r\n    },\r\n\r\n    postRender: function() {\r\n        bizagi.rendering.combo.prototype.postRender.apply(this, arguments);\r\n    },\r\n\r\n    postRenderReadOnly: function() {\r\n        bizagi.rendering.combo.prototype.postRenderReadOnly.apply(this, arguments);\r\n    },\r\n\r\n    renderEdition: function() {\r\n        bizagi.rendering.combo.prototype.renderEdition.apply(this, arguments);\r\n    },\r\n\r\n    configureCombo: function() {\r\n        bizagi.rendering.combo.prototype.configureCombo.apply(this, arguments);\r\n    },\r\n\r\n    configureModalViewHandlers: function() {\r\n        bizagi.rendering.combo.prototype.configureModalViewHandlers.apply(this, arguments);\r\n    },\r\n\r\n    filterList: function() {\r\n        bizagi.rendering.combo.prototype.filterList.apply(this, arguments);\r\n    },\r\n\r\n    actionSave: function() {\r\n        bizagi.rendering.combo.prototype.actionSave.apply(this, arguments);\r\n    },\r\n\r\n    setModalViewDisplayValue: function() {\r\n        bizagi.rendering.combo.prototype.setModalViewDisplayValue.apply(this, arguments);\r\n    },\r\n\r\n\r\n    /*\r\n     *   Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function(value) {\r\n        bizagi.rendering.combo.prototype.setDisplayValue.apply(this, arguments);\r\n    },\r\n\r\n    setValue: function (value, triggerEvents) {\r\n        var self = this;\r\n        triggerEvents = triggerEvents !== undefined ? triggerEvents : true;\r\n\r\n        if (value === \"\") {\r\n            value = { id: \"\", value: \"\" };\r\n        }\r\n\r\n        if (!!value) {\r\n            if (self.value === null || self.value.id !== value.id){\r\n                self.triggerHandler(\"select\", value);\r\n            }\r\n\r\n            this._super(value, triggerEvents);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Finds an element in the combo data values by id\r\n     * @param {int} id\r\n     * @returns {Object}\r\n     */\r\n    findDataValueById: function (id) {\r\n        return (this.properties.data || []).find(function(e) {\r\n            return e.id == id;\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Cleans the control's data\r\n     * */\r\n    cleanData: function () {\r\n        bizagi.rendering.combo.prototype.cleanData.apply(this, arguments);\r\n    },\r\n\r\n    resetData: function () {\r\n        bizagi.rendering.combo.prototype.resetData.apply(this, arguments);\r\n    },\r\n\r\n    changeCombo: function(valueItem, valueObjet) {\r\n        bizagi.rendering.combo.prototype.changeCombo.apply(this, arguments);\r\n    },\r\n\r\n    processComboData: function(data) {\r\n        bizagi.rendering.combo.prototype.processComboData.apply(this, arguments);\r\n    },\r\n\r\n    validateValue: function(value) {\r\n        bizagi.rendering.combo.prototype.validateValue.apply(this, arguments);\r\n    },\r\n\r\n    /*\r\n     *   Returns the selected value in the template\r\n     */\r\n    getSelectedValue: function() {\r\n        return bizagi.rendering.combo.prototype.getSelectedValue.call(this, arguments);\r\n    },\r\n\r\n    /*\r\n     *   Handler for combo change\r\n     */\r\n    onComboChange: function(newValue) {\r\n        var self = this;\r\n        self.selectedValue = newValue.value;\r\n        var params = {};\r\n        params[self.Class.BA_ACTION_PARAMETER_PREFIX + \"parent\"] = newValue.id;\r\n\r\n        $.each(this.dependants, function(key, dependant){\r\n            dependant.properties.params = params;\r\n            dependant.properties.parentComboValue = newValue.id;\r\n\r\n            if (newValue.id == \"\"){\r\n                dependant.resetData();\r\n                dependant.setDisplayValue({ id: \"\", value: \"\" });\r\n            }else{\r\n                $.when(dependant.getData(params)).done(function (data) {\r\n                    dependant.properties.data = data;\r\n                    if (dependant.value !== null){\r\n                        var selected = dependant.findDataValueById(dependant.value.id);\r\n                        if (selected){\r\n                            if (selected.id == \"\" && (self.value && self.value.value == \"\")){\r\n                                dependant.resetData();\r\n                                dependant.setDisplayValue({ id: \"\", value: \"\" });\r\n                            }else{\r\n                                dependant.triggerHandler(\"select\", selected);\r\n                            }\r\n                        }\r\n                        else{\r\n                            dependant.setDisplayValue({ id: \"\", value: \"\" });\r\n                            dependant.triggerHandler(\"select\", { id: \"\", value: \"\" });\r\n                        }\r\n                    }else{\r\n                        dependant.triggerHandler(\"select\", { id: \"\", value: \"\" });\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n\r\n    getTemplateName: function() {\r\n        return \"combo\";\r\n    }\r\n});\r\n","/**\r\n*   Name: BizAgi Tablet Render list Extension\r\n*   Author: Cristian O\r\n*   Date: 2015 - Oct - 10\r\n*   Comments:\r\n*   -   This script will redefine the list render class to adjust to tablet devices\r\n*/\r\n\r\n// Extends from base list \r\nbizagi.rendering.list.extend(\"bizagi.rendering.list\", {}, {\r\n    postRender: function () {\r\n        // Call combo postRender\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Call base \r\n        this._super();\r\n\r\n        // Set control container to behave as a block\r\n        control.addClass(\"ui-bizagi-render-display-block\");\r\n\r\n        // Apply plugin\r\n        self.list = $(\".ui-bizagi-render-list\", control);\r\n\r\n        if (!self.properties.editable) {\r\n            //Add styles class\r\n            container.addClass(\"bz-command-not-edit\");\r\n            self.list.attr('readonly', \"readonly\");\r\n\r\n            var value = self.properties.value ? self.properties.value.value : \"- - \";\r\n\r\n            self.control.html(\"<span class=\\\"bz-command-not-edit bz-rn-align-class bz-rn-text\\\">\" + value + \"</span>\");\r\n        }\r\n\r\n        //Show clear icon\r\n        $.when(self.ready()).done(function(){\r\n            if(!self.hasValue()){\r\n                self.getControl().find(\".bz-rn-input-selected\").html(\"-------------\");\r\n                self.getControl().find(\".bz-wp-list-clear-icon-list\").hide(500);\r\n            }else{\r\n                self.getControl().find(\".bz-wp-list-clear-icon-list\").show(500);\r\n            }\r\n        });\r\n\r\n        self.configureListHandlers();\r\n    },\r\n\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"readonly\");\r\n        return $.kendoTmpl(template, {});\r\n    },\r\n\r\n    /**\r\n    * Set display readonly\r\n    * @returns {} \r\n    */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        self._super();\r\n        self.list = control.find(\".readonly-control\");\r\n    },\r\n\r\n    /**\r\n     * Setting the control events\r\n     * */\r\n    configureListHandlers: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        self.list.find(\".see-more-icon\").bind(\"click\", function() {\r\n            var template = self.renderFactory.getTemplate(\"listModalView\");\r\n            var modalViewTemplate = kendo.template(template, { useWithBlock: false });\r\n            var data = {\r\n                'items': self.properties.data,\r\n                'displayName': self.properties.displayName || \"\",\r\n                \"orientation\": self.properties.orientation\r\n            };\r\n\r\n            var modalView = $($.trim(modalViewTemplate(data)));\r\n\r\n            modalView.kendoMobileModalView({\r\n                close: function() {\r\n                    self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n\r\n                    this.destroy();\r\n                    this.element.remove();\r\n                },\r\n                useNativeScrolling: true,\r\n                modal: false\r\n            });\r\n\r\n            self.configureModalViewHandlers(modalView);\r\n\r\n            self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n            modalView.kendoMobileModalView(\"open\");\r\n\r\n            modalView.closest(\".k-animation-container\").addClass(\"bz-rn-new-modalview-position\");\r\n        });\r\n\r\n        //Setting the initial selected display value\r\n        self.list.on(\"click\", \".bz-rn-regular-element\", function() {\r\n            var val = $(this).data(\"value\");\r\n            var label = $(this).text();\r\n\r\n            var newValue = { \"id\": val, \"value\": label };\r\n            self.selectedValue = newValue.value;\r\n            self.setValue(newValue);\r\n            self.setDisplayValue(newValue);\r\n        });\r\n\r\n        //Set clear event\r\n        control.find(\".bz-rn-first-element-container\").on(\"click\", \".bz-wp-list-clear-icon-list\", function() {\r\n            var val = \"\";\r\n            var label = \"-------------\";\r\n\r\n            var newValue = { \"id\": val, \"value\": label };\r\n            self.setValue(newValue);\r\n            self.selectedValue = newValue.value;\r\n            self.setDisplayValue(newValue);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Configure the modalView Handlers for the new combo control.\r\n     * */\r\n    configureModalViewHandlers: function (inputContainer) {\r\n        var self = this;\r\n\r\n        var closeModalViewPromise = new $.Deferred();\r\n\r\n        //getting combo list elements\r\n        var container = inputContainer.find(\".ui-bizagi-render-list-elements li\");\r\n\r\n        //Hide the clear text icon\r\n        inputContainer.find(\".bz-wp-modalview-header-cancel-search\").hide(500);\r\n\r\n        //Closing modalview\r\n        inputContainer.delegate(\"#ui-bizagi-cancel-button\", \"click\", function () {\r\n            closeModalViewPromise.reject();\r\n            inputContainer.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        //Filtering list\r\n        inputContainer.find(\".bz-wp-modalview-header-input-search\").bind('change keypress keyup change', function () {\r\n            self.filterList(this.value, container, inputContainer);\r\n        });\r\n\r\n        //Cleaning list\r\n        inputContainer.find(\".bz-wp-modalview-header-cancel-search\").bind('click', function () {\r\n            self.filterList(\"\", container, inputContainer);\r\n            inputContainer.find(\".bz-wp-modalview-header-input-search\").val(\"\");\r\n            $(this).hide(500);\r\n        });\r\n\r\n        //Configuring list as a selectable element\r\n        self.modalViewList = $(\".ui-bizagi-render-list-elements\", inputContainer);\r\n        self.setModalViewDisplayValue();\r\n\r\n        //Setting the initial selected display value\r\n        self.modalViewList.on(\"click\", \"li\", function () {\r\n            self.modalViewList.find(\"li\").filter(function () {\r\n                if ($(this).hasClass(\"ui-state-active\")) {\r\n                    return $(this);\r\n                }\r\n            }).removeClass(\"ui-state-focus ui-selected ui-state-active\");\r\n\r\n            $(this).addClass(\"ui-state-focus ui-selected ui-state-active\");\r\n            $(\".bz-wp-modalview-header-input-search\", inputContainer).blur();\r\n        });\r\n\r\n        inputContainer.delegate(\".ui-bizagi-apply-button\", \"click\", function () {\r\n            closeModalViewPromise.resolve();\r\n            inputContainer.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        inputContainer.find(\".bz-wp-modalview-close\").bind(\"click\", function () {\r\n            closeModalViewPromise.reject();\r\n            inputContainer.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        $.when(closeModalViewPromise).done(function () {\r\n            var selected = $(\"li.ui-selected\", self.modalViewList);\r\n            var _value = $(selected).data(\"value\");\r\n            var label = $(selected).text();\r\n\r\n            //Update internal value\r\n            if (typeof _value !== \"undefined\") {\r\n                var newValue = { \"id\": _value, \"value\": label };\r\n                self.setValue(newValue);\r\n                self.selectedValue = newValue.value;\r\n                self.setDisplayValue(newValue);\r\n            }\r\n        }).fail(function () {\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Filtering list of elements\r\n     * */\r\n    filterList: function (search, $li, inputContainer) {\r\n        if (search !== \"\") {\r\n            inputContainer.find(\".bz-wp-modalview-header-cancel-search\").show(500);\r\n        } else {\r\n            inputContainer.find(\".bz-wp-modalview-header-cancel-search\").hide(500);\r\n        }\r\n\r\n        $li.filter(function () {\r\n            var stringContainer = $(this).text().toUpperCase();\r\n            var stringToSearch = search.toUpperCase();\r\n\r\n            if (stringContainer.indexOf(stringToSearch) >= 0) {\r\n                return $(this);\r\n            } else {\r\n                $(this).hide();\r\n            }\r\n        }).show();\r\n    },\r\n\r\n    /* SETS THE VALUE IN THE RENDERED CONTROL\r\n    =====================================================*/\r\n    /**\r\n    *   Sets the value in the rendered control\r\n    */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n\r\n        if (typeof (value) !== \"undefined\") {\r\n            if (properties.editable) {\r\n            \r\n                control.find(\".bz-rn-input-selected\").html(value.value);\r\n\r\n                if(value.value === \"-------------\" || value.value === \"\") {\r\n                    control.find(\".bz-wp-list-clear-icon-list\").hide();\r\n                }else{\r\n                    control.find(\".bz-wp-list-clear-icon-list\").show();\r\n                }\r\n            } else {\r\n                self.list.text(value.value);\r\n            }\r\n        }\r\n    },\r\n\r\n    cleanData: function(){\r\n        var self = this;\r\n        var value = {id:\"\", value:\"\"};\r\n\r\n        self.setValue(value);\r\n        self.setDisplayValue(value);\r\n    },\r\n\r\n    /**\r\n     * Setting the selected element.\r\n     * */\r\n    setModalViewDisplayValue: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        if (self.list && properties.editable &&\r\n            self.properties.value && typeof (self.properties.value) !== \"undefined\" &&\r\n            self.properties.value.id !== \"\") {\r\n            $(\"#ui-bizagi-list-\" + self.properties.value.id, self.modalViewList)\r\n\t    \t.addClass(\"ui-state-focus ui-selected ui-state-active\");\r\n        }\r\n    },\r\n\r\n    /**\r\n    *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        // Call base\r\n        self._super();\r\n        // Nothing todo, all events apply in selectable plugin\r\n    },\r\n\r\n    /**\r\n    *   Returns the selected value in the template\r\n    */\r\n    getSelectedValue: function () {\r\n        var self = this;\r\n        return self.selectedValue;\r\n    }\r\n});\r\n","/*\r\n *   Name: Bizagi Tablet Render MultiSelect Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the MultiSelect render class to adjust to tablet devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.multiSelect.extend(\"bizagi.rendering.multiSelect\", bizagi.rendering.render.base.prototype);\r\n// Extends itself\r\nbizagi.rendering.multiSelect.extend(\"bizagi.rendering.multiSelect\", {\r\n    MORE_OPTION_WIDTH: 40,\r\n    SEARCH_MIN_LENGTH: 1,\r\n    temporalElements: {}\r\n}, {\r\n\r\n    /**\r\n     * Template method to implement in each device to customize each render after processed\r\n     */\r\n    postRender: function () {\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    configureHandlers: function () {\r\n        var $control = this.getControl();\r\n        $(\".bz-multiselect__arrow\", $control)\r\n            .on(\"click\", this.openModalView.bind(this));\r\n\r\n        $('ul.bz-multiselect__tags', $control)\r\n            .on(\"click\", \"li div.bz-btn-icn\", this.onUnselectElement.bind(this))\r\n            .on(\"click\", \"li.bz-multiselect__plus\", this.onShowSelectedElements.bind(this));\r\n    },\r\n\r\n    /**\r\n     * Template method to implement in each device to customize the render's behaviour to add handlers when the control is readonly\r\n     */\r\n    configureHandlersReadOnly: function () {\r\n        var $control = this.getControl();\r\n\r\n        $('ul.bz-multiselect__tags', $control)\r\n            .on(\"click\", \"li.bz-multiselect__plus\", this.onShowSelectedElements.bind(this));\r\n    },\r\n\r\n    onUnselectElement: function (ev) {\r\n        var $element = $(ev.target);\r\n        var idToRemove = $element.data(\"id\");\r\n\r\n        // Remove element\r\n        this.removeElement({id: idToRemove});\r\n        this.addSelectedElements();\r\n    },\r\n\r\n    onShowSelectedElements: function (ev) {\r\n        var self = this;\r\n        var $element = $(ev.currentTarget);\r\n        var index = $element.data('index');\r\n        var values = self.getDataValue();\r\n        var valuesToShow = (values || []).slice(index);\r\n        var template = this.renderFactory.getTemplate(\"list-multiselect-tags\");\r\n        var $listView = this.showFloatListView(template, {\r\n            datasource: valuesToShow,\r\n            editable: self.properties.editable\r\n        });\r\n\r\n        var $tagElements = $('ul.bz-multiselect__tags', $listView);\r\n\r\n        $tagElements.on(\"click, mousedown\", \"li div.bz-btn-icn\", function (ev) {\r\n            self.onUnselectElement(ev);\r\n            $listView.remove();\r\n        });\r\n\r\n        $listView.on(\"closeView\", function () {\r\n            $tagElements.off(\"click\", \"li div.bz-btn-icn\", self.onUnselectElement.bind(self))\r\n            $listView.remove();\r\n        });\r\n\r\n    },\r\n\r\n    openModalView: function () {\r\n        //Creating modal view\r\n        var self = this;\r\n        //Reset the temporal array\r\n        self.Class.temporalElements = {};\r\n        var template = self.renderFactory.getTemplate('multiselectModalView');\r\n        var values = self.getDataValue();\r\n        var options = {\r\n            selected: values,\r\n            isChecked: function (id) {\r\n                return self.markAsChecked.call(this, id);\r\n            }\r\n        };\r\n\r\n        this.getData().done(function (result) {\r\n            var data = {\r\n                'displayName': self.properties.displayName || \"\",\r\n                \"orientation\": self.properties.orientation,\r\n                \"datasource\": result,\r\n                \"options\": options\r\n            };\r\n            try {\r\n                var modalViewTemplate = kendo.template(template, {useWithBlock: false});\r\n                for (var i = 0, length = values.length; i < length; i++) {\r\n                    self.Class.temporalElements[values[i].id] = values[i];\r\n                }\r\n                var modalView = $($.trim(modalViewTemplate(data)));\r\n                self.modalListHandlers(modalView);\r\n\r\n                modalView.kendoMobileModalView({\r\n                    close: function () {\r\n                        self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n                        this.destroy();\r\n                        this.element.remove();\r\n                    },\r\n                    useNativeScrolling: true,\r\n                    modal: false\r\n                });\r\n\r\n                self.configureModalViewHandlers(modalView);\r\n\r\n                self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n                modalView.kendoMobileModalView('open');\r\n\r\n                modalView.closest(\".k-animation-container\").addClass(\"bz-rn-new-modalview-position\");\r\n            } catch (e) {\r\n                bizagi.log(e.message);\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Configure the modalView Handlers for the new combo control.\r\n     * */\r\n    configureModalViewHandlers: function (inputContainer) {\r\n        var self = this;\r\n        var $listContainer = inputContainer.find(\".bz-multiselect__list li\");\r\n        var closeModalViewPromise = new $.Deferred();\r\n\r\n        //Hide the clear text icon\r\n        inputContainer.find(\".bz-wp-modalview-header-cancel-search\").hide(500);\r\n\r\n        inputContainer.delegate(\"#ui-bizagi-cancel-button\", \"click\", function () {\r\n            closeModalViewPromise.reject();\r\n            inputContainer.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        //Showing found results\r\n        inputContainer.find(\".bz-wp-modalview-header-input-search\").bind('keypress keyup', function () {\r\n            if (this.value !== \"\") {\r\n                inputContainer.find(\".bz-wp-modalview-header-cancel-search\").show(500);\r\n            } else {\r\n                inputContainer.find(\".bz-wp-modalview-header-cancel-search\").hide(500);\r\n                $(\"#ui-bizagi-wp-filter-results-multiselect-wrapper ul li\", inputContainer).show();\r\n            }\r\n\r\n            // Getting and showing the data\r\n            self.filterList(this.value, $listContainer);\r\n        }).focus(function () {\r\n            inputContainer.find(\".filter-searchlist-modal-view-tags\").addClass(\"searching\");\r\n        }).blur(function () {\r\n            inputContainer.find(\".filter-searchlist-modal-view-tags\").removeClass(\"searching\");\r\n        });\r\n\r\n        //Cleaning search\r\n        inputContainer.find(\".bz-wp-modalview-header-cancel-search\").bind('click', function () {\r\n            $(\"#ui-bizagi-wp-filter-results-multiselect-wrapper ul li\", inputContainer).show();\r\n            inputContainer.find(\".bz-wp-modalview-header-input-search\").val(\"\");\r\n            $(this).hide(500);\r\n        });\r\n\r\n        //when click on apply button\r\n        inputContainer.delegate(\".ui-bizagi-apply-button\", \"click\", function () {\r\n            closeModalViewPromise.resolve();\r\n            inputContainer.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        inputContainer.find(\".bz-wp-modalview-close\").bind(\"click\", function () {\r\n            closeModalViewPromise.reject();\r\n            inputContainer.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        //Trigger delete event for tags\r\n        inputContainer.find(\".filter-searchlist-modal-view-tags\").on(\"click\", '.bz-rn-remove-tag-on-search-list', function () {\r\n            self.removeItem($(this), true);\r\n\r\n            var term = inputContainer.find(\".bz-wp-modalview-header-input-search\").val();\r\n\r\n            // Getting and showing the data\r\n            self.filterList(term, $listContainer);\r\n        });\r\n\r\n        $.when(closeModalViewPromise).done(function () {\r\n            self.addNewValuesToInput();\r\n            self.Class.temporalElements = {};\r\n        }).fail(function () {\r\n            self.Class.temporalElements = {};\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Adding new values to input\r\n     * */\r\n    addNewValuesToInput: function () {\r\n        var self = this;\r\n\r\n        //Create a temporal array\r\n        var tempArray = [];\r\n\r\n        $.each(self.Class.temporalElements, function (i, ele) {\r\n            tempArray.push(ele);\r\n        });\r\n\r\n        self.setValue(tempArray);\r\n        self.addSelectedElements();\r\n    },\r\n\r\n    /**\r\n     * Method to render non editable values\r\n     */\r\n    postRenderReadOnly: function () {\r\n        // Call base\r\n        this._super();\r\n    },\r\n\r\n    /**\r\n     * addSelectedElements\r\n     */\r\n    addSelectedElements: function () {\r\n        var self = this;\r\n        var $control = self.getControl();\r\n        var values = self.getDataValue();\r\n        var totalValues = values.length;\r\n        var $tagsContainer = $('ul.bz-multiselect__tags', $control);\r\n        var editable = this.properties.editable;\r\n        $tagsContainer.empty();\r\n\r\n        if (totalValues > 0) {\r\n\r\n            var template = this.renderFactory.getTemplate(\"list-multiselect-tag\");\r\n\r\n            for (var i = 0; i < totalValues; i++) {\r\n                var item = values[i];\r\n                var data = {id: item.id, value: item.value, editable: editable};\r\n                var elementTemplate = kendo.template(template, {useWithBlock: false});\r\n                var $ChildToAdd = $($.trim(elementTemplate(data)));\r\n\r\n                $tagsContainer.append($ChildToAdd);\r\n\r\n                // Process the control in the layout\r\n                this.processControlLayout(this.properties.valueFormat || {});\r\n\r\n                if (!this.canAddMoreItems($tagsContainer)) {\r\n                    // Remove last item added\r\n                    $tagsContainer\r\n                        .children()\r\n                        .last()\r\n                        .remove();\r\n\r\n                    // Add the view mode item\r\n                    var data = {\r\n                        'value': totalValues - i,\r\n                        'index': i\r\n                    };\r\n\r\n                    var viewMoreTemplate = kendo.template(this.renderFactory.getTemplate(\"list-multiselect-view-more\"), {useWithBlock: false})\r\n                    var $viewMore = $($.trim(viewMoreTemplate(data)));\r\n                    $tagsContainer.append($viewMore);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n    },\r\n\r\n    modalListHandlers: function ($floatListContext) {\r\n        var self = this;\r\n        var $listContainer = $floatListContext.find(\".bz-multiselect__list li\");\r\n        var checkbox = $listContainer.find(\"input[type=checkbox]\");\r\n\r\n        $floatListContext.find(\".bz-multiselect__search_input\").bind(\"change keypress keyup mousedown\", function (evt) {\r\n            evt.stopPropagation();\r\n\r\n            self.filterList(this.value, $listContainer);\r\n        });\r\n\r\n        checkbox.change(function () {\r\n            var $context = $(this);\r\n            var isChecked = $context.is(\":checked\");\r\n            var newValue = {id: $context.data(\"id\"), value: $context.data(\"value\")};\r\n\r\n            if (isChecked) {\r\n                self.addTemporalElement(newValue, false);\r\n            } else {\r\n                self.addTemporalElement(newValue, true);\r\n            }\r\n        });\r\n\r\n        $floatListContext.on(\"closeView\", function () {\r\n            self.closeFloatView();\r\n\r\n            $(document).unbind(\"mousedown.multiselect\");\r\n        });\r\n    },\r\n\r\n    addTemporalElement: function (element, elementToRemove) {\r\n        var self = this;\r\n        if (elementToRemove) {\r\n            delete self.Class.temporalElements[element.id];\r\n        } else {\r\n            self.Class.temporalElements[element.id] = element;\r\n        }\r\n    },\r\n\r\n    showFloatListView: function (template, data) {\r\n        var self = this;\r\n        var $control = self.getControl();\r\n        var multiSelect = $(\".bz-multiselect\", $control);\r\n        var $containerControl = $control.closest(\".ui-bizagi-render-control\");\r\n        var modalViewTemplate = kendo.template(template, {useWithBlock: false});\r\n        var $floatList = $($.trim(modalViewTemplate(data))); //$.tmpl(template, data, options);\r\n        var widthControl = multiSelect.width();\r\n        $containerControl.append($floatList);\r\n        $floatList.width(widthControl);\r\n        $floatList.position({\r\n            my: \"left top\",\r\n            at: \"left bottom\",\r\n            of: multiSelect,\r\n            collision: \"fit\"\r\n        }).hide();\r\n        // Display view\r\n        $floatList.show();\r\n        // Stop bubbling outside the dropdown\r\n        $floatList.on(\"mousedown\", function (ev) {\r\n            ev.preventDefault();\r\n            return false;\r\n        });\r\n        // Add global handler to close the float view\r\n        $(document).one(\"mousedown.multiselect\", function (evt) {\r\n            $floatList.trigger('closeView');\r\n        });\r\n        return $floatList;\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Tablet Render Association\r\n*   Author: RicharU (based on Edward Morales)\r\n*   Comments: Defines the association control\r\n*/\r\n\r\nbizagi.rendering.association.extend('bizagi.rendering.association', {}, {\r\n    /**\r\n     * Template method to implement in each children to customize each control\r\n     * \r\n     * @returns {} \r\n     */\r\n    renderControl: function() {\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"association\");\r\n        var def = new $.Deferred();\r\n\r\n        self.properties.property = \"flipped\";\r\n        self.properties.idRender = self.properties.id;\r\n\r\n        // Define flipped\r\n        $.when(self.getFlipAssociation())\r\n            .done(function(flip) {\r\n\r\n                // Make json base, create self.properties.formatJson\r\n                self.makeJsonBase();\r\n\r\n                self.properties.flipped = bizagi.util.parseBoolean(flip) || false;\r\n\r\n                var columnData = self.getColumnData();\r\n\r\n                var html = $.kendoTmpl(template, $.extend(self.properties, { columnData: columnData }), {\r\n                    getColumnData: self.getColumnData,\r\n                    getRightAssociation: self.getRightAssociation\r\n                });\r\n\r\n                /* by default need set self.properties.formatJson */\r\n                self.setValue(JSON.encode(self.properties.formatJson));\r\n\r\n                def.resolve(html);\r\n            });\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    /**\r\n    * Get Left Data, verify if flipper flags sets true\r\n    *\r\n    * @param column {'0'||'1'}\r\n    */\r\n    getColumnData: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var data = [];\r\n\r\n        self.data = properties;\r\n\r\n        var dataAssociation = properties.flipped ? properties.rightData : properties.leftData;\r\n\r\n        $.each(dataAssociation, function(key, item) {\r\n            data.push({\r\n                id: item.id,\r\n                value: item.value,\r\n                association: self.getRightAssociation(item.id)\r\n            });\r\n        });\r\n\r\n        return data;\r\n    },\r\n\r\n    /**\r\n     * Post render control\r\n     * @returns {} \r\n     */\r\n    postRender: function() {\r\n\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Cache control\r\n        self.association = $(\".bz-rn-association-control\", control);\r\n\r\n        // Add Event at Association Control\r\n        self.addEventControl();\r\n\r\n        self.showDefaultContainer();\r\n    },\r\n\r\n    showDefaultContainer: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var associations = $('.bz-rn-association-group .bz-rn-association-header', control);\r\n\r\n        if (associations.length > 0) {\r\n            var defaultHeader = $($('.bz-rn-association-group .bz-rn-association-header', control)[0]);\r\n            var defaultContainer = $($('.bz-rn-association-group .bz-rn-association-items', control)[0]);\r\n\r\n            self.closeAccordionSection(true);\r\n            defaultHeader.addClass('active');\r\n            defaultContainer.slideDown(300).addClass('open');\r\n        }\r\n    },\r\n\r\n    closeAccordionSection: function(i) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var headers = $('.bz-rn-association-group .bz-rn-association-header', control);\r\n        var contents = $('.bz-rn-association-group .bz-rn-association-items', control);\r\n\r\n        if (i) {\r\n            headers = headers.not(':first').removeClass('active');\r\n            contents = contents.not(':first').slideUp(300).removeClass('open');\r\n        }\r\n\r\n        headers.removeClass('active');\r\n        contents.slideUp(300).removeClass('open');\r\n    },\r\n\r\n    /**\r\n     * Add event to control\r\n     * @returns {} \r\n     */\r\n    addEventControl: function() {\r\n\r\n        var self = this;\r\n        var template = self.renderFactory.getTemplate(\"association\");\r\n        var control = self.getControl();\r\n\r\n        // Bind check toggle\r\n        self.association.delegate(\"input:checkbox\", \"change\", function() {\r\n\r\n            var contextElement = $(this);\r\n\r\n            if (contextElement.prop(\"checked\")) {\r\n                // Associate item\r\n                contextElement.addClass(\"bz-check\");\r\n                self.associateElement(contextElement);\r\n            } else {\r\n                // Dissociate item\r\n                contextElement.removeClass(\"bz-check\");\r\n                self.dissociateElement(contextElement);\r\n            }\r\n        });\r\n\r\n        // Bind flip actions\r\n        self.association.delegate(\".bz-rn-association-flip-button\", \"click\", function() {\r\n\r\n            $(control).empty();\r\n\r\n            // Define flipped\r\n            self.properties.flipped = !self.properties.flipped;\r\n\r\n            // Send flip data to server\r\n            self.properties.flipstate = self.properties.flipped;\r\n            self.dataService.getFlipAssociation(self.properties);\r\n\r\n            var columnData = self.getColumnData();\r\n\r\n            // Render template\r\n            $.kendoTmpls(template, $.extend(self.properties, { columnData: columnData }), {\r\n                getColumnData: self.getColumnData,\r\n                getRightAssociation: self.getRightAssociation,\r\n                getLeftName: self.getLeftName\r\n            }).appendTo(control);\r\n\r\n            self.postRender();\r\n        });\r\n\r\n        self.association.delegate(\".bz-rn-association-container .bz-rn-association-header\", \"click\", function() {\r\n            if (!$(this).is('.active')) {\r\n                self.closeAccordionSection();\r\n                $(this).addClass('active');\r\n                $(this).siblings().slideDown(300).addClass('open');\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Render for readonly\r\n     * @returns {} \r\n     */\r\n    postRenderReadOnly: function() {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var template = self.renderFactory.getTemplate(\"association\");\r\n\r\n        control.empty();\r\n\r\n        // Make json base, create self.properties.formatJson\r\n        self.makeJsonBase();\r\n\r\n        var columnData = self.getColumnData();\r\n\r\n        // Render template  \r\n        $.kendoTmpls(template, $.extend(self.properties, { columnData: columnData }), {\r\n            getColumnData: self.getColumnData,\r\n            getRightAssociation: self.getRightAssociation,\r\n            getLeftName: self.getLeftName\r\n        }).appendTo(control);\r\n\r\n        self.association = $(\".bz-rn-association-control\", control);\r\n        self.association.find(\"input:checkbox\").hide();\r\n        self.association.find(\".ui-bz-rn-check-item label\").addClass(\"bz-rn-association-non-editable\");\r\n\r\n        $.when(self.ready()).done(function() {\r\n            self.showDefaultContainer();\r\n\r\n            // Bind event for flip botton\r\n            if (self.properties.allowFlip) {\r\n                self.association.delegate(\".bz-rn-association-flip-button\", \"click\", function() {\r\n                    $(control).empty();\r\n                    // Define flipped\r\n                    self.properties.flipped = !self.properties.flipped;\r\n\r\n                    self.postRenderReadOnly();\r\n                });\r\n            }\r\n\r\n            self.association.delegate(\".bz-rn-association-container .bz-rn-association-header\", \"click\", function() {\r\n                if (!$(this).is('.active')) {\r\n                    self.closeAccordionSection();\r\n                    $(this).addClass('active');\r\n                    $(this).siblings().slideDown(300).addClass('open');\r\n                }\r\n            });\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Associate the left item with the active parent\r\n     * @param {} element \r\n     * @returns {} \r\n     */\r\n    associateElement: function(element) {\r\n\r\n        var self = this;\r\n        var context = self.getControl();\r\n\r\n        // Get the parent id\r\n        var parentId = $(element.parents(\"ul\"), context).data(\"parent-id\");\r\n        var itemAdd = element.data(\"id\");\r\n\r\n        // Update JSON object\r\n        self.addElement(parentId, itemAdd);\r\n    },\r\n\r\n    /**\r\n     * Dissociates an item from the active collection\r\n     * @param {} element \r\n     * @returns {} \r\n     */\r\n    dissociateElement: function(element) {\r\n\r\n        var self = this;\r\n        var context = self.getControl();\r\n\r\n        // Get the parent id\r\n        var parentId = $(element.parents(\"ul\"), context).data(\"parent-id\");\r\n        var itemRemove = element.data(\"id\");\r\n\r\n        // Update JSON object\r\n        self.removeElement(parentId, itemRemove);\r\n    }\r\n});","/**\r\n *   Name: BizAgi Tablet Render ECM\r\n *   Author: Bizagi Mobile Team\r\n *   Comments: Defines the ECM control for iPad\r\n */\r\n\r\nbizagi.rendering.ecm.extend(\"bizagi.rendering.ecm\", {\r\n    BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\r\n    BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\r\n    QUALITY_PICTURE: 50,\r\n    LIMIT: 1,\r\n//limit: The maximum number of audio clips,video clips,etc in the device user can record in a single capture operation.\r\n    EXTENSIONSIMG: [\"image/jpeg\", \"jpeg\", \"image\", \"png\", \"jpg\"],\r\n    EXTENSIONSVIDEO: [\"video/quicktime\", \"quicktime\", \"qt\", \"mov\"],\r\n    EXTENSIONSAUDIO: [\"audio/wav\", \"audio\", \"wav\"]\r\n}, {\r\n    renderControl: function(listControl, fileProperties) {\r\n        var self = this;\r\n\r\n        return $.when(self._super(listControl, fileProperties))\r\n            .done(function(html) {\r\n                return html;\r\n            }).fail(function() {\r\n                return \"Error\";\r\n            }).always(function(html) {\r\n                self.stopLoading();\r\n                return html;\r\n            });\r\n    },\r\n\r\n    postRender: function() {\r\n        var self = this;\r\n        // Call base\r\n        self._super();\r\n\r\n        self.activateUploadNative();\r\n    },\r\n\r\n    replaceControlHtml: function(html, replace) {\r\n        html = html || \"\";\r\n        replace = replace || \"\";\r\n\r\n        var respString = $(html.replace(\"{{control}}\", replace));\r\n\r\n        if (replace === \"\") {\r\n            this.startLoading(respString);\r\n        }\r\n\r\n        return respString.get(0).outerHTML;\r\n    },\r\n\r\n    /**\r\n     * Override because of the required element\r\n     * @override\r\n     * @param argument\r\n     */\r\n    changeRequired: function(argument) {\r\n        var self = this;\r\n        var labelElement = $(\"label\", self.getLabel());\r\n        var control = self.getControl();\r\n\r\n        //Remove the required div from the dom in order to have only one any time\r\n        control.find(\".ui-bizagi-render-control-required, .bz-rn-ecm-required\").remove();\r\n        var properties = self.properties;\r\n\r\n        // Update properties\r\n        properties.required = argument;\r\n\r\n        // Changes label\r\n        if (bizagi.util.parseBoolean(argument)) {\r\n            labelElement.text((properties.displayName || \"\") + \" \");\r\n            if (!self.hasValue()) {\r\n                control.prepend(\"<div class=\\\"bz-rn-ecm-required\\\"></div>\");\r\n            }else{\r\n                control.prepend(\"<div class=\\\"bz-rn-ecm-required\\\" style=\\\"display: none\\\"></div>\");\r\n            }\r\n        } else {\r\n            labelElement.text((properties.displayName || \"\")); //+ ' :'\r\n        }\r\n\r\n        // Perform validations again to check if the form is valid after this change\r\n        self.triggerRenderValidate();\r\n    },\r\n\r\n    /**\r\n     * Override because of the required element\r\n     * @override\r\n     */\r\n    changeRequiredLabel: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var control = self.getControl();\r\n        control.find(\".ui-bizagi-render-control-required, .bz-rn-ecm-required\").remove();\r\n\r\n        if (properties.required) {\r\n\r\n            if (!self.checkRequired([])) {\r\n                control.prepend(\"<div class=\\\"bz-rn-ecm-required\\\"></div>\");\r\n\r\n            } else {\r\n                control.prepend(\"<div class=\\\"bz-rn-ecm-required\\\" style=\\\"display: none\\\"></div>\");\r\n            }\r\n        }\r\n    },\r\n\r\n    startLoading: function( holder ){\r\n        holder = holder || this.getRenderedElement();\r\n        $(\".ui-bizagi-render-control\", holder).prepend(\"<div class=\\\"innerLoader\\\"></div>\").addClass(\"bz-rn-ecm-control\");\r\n    },\r\n\r\n    stopLoading: function(){\r\n        $(\".innerLoader\", this.getControl()).remove();\r\n    },\r\n\r\n    startWaiting: function( $button ){\r\n        var $control = $button.closest(\".bz-rn-ecm-metadata\");\r\n        $button.addClass(\"loading\");\r\n        $control.find(\"input, a\").css(\"opacity\", 0.6);\r\n        $control.find(\".ui-bizagi-render-button, button, input\").prop(\"disabled\", \"disabled\");\r\n        $control.find(\"input\").prop(\"readonly\", \"readonly\");\r\n    },\r\n\r\n    stopWaiting: function( $button ){\r\n        var $control = $button.closest(\".bz-rn-ecm-metadata\");\r\n        $control.find(\"input, a\").css(\"opacity\", 1);\r\n        $control.find(\".ui-bizagi-render-button, button, input\").prop(\"disabled\", false);\r\n        $control.find(\"input\").prop(\"readonly\", false);\r\n        $control.find(\".loading\").removeClass(\"loading\");\r\n    },\r\n\r\n    postRenderReadOnly: function() {\r\n        var self = this;\r\n\r\n        if (!bizagi.util.isCordovaSupported()) {\r\n            self.addEventToOpenSlide();\r\n        }\r\n\r\n        if (!self.properties.editable) {\r\n            self.element.addClass(\"bz-rn-read-only\");\r\n        }\r\n\r\n        self.closeAccordionSection();\r\n    },\r\n\r\n    addEventToOpenSlide: function() {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        var container = self.getControl();\r\n\r\n        self.itemAddfile = $(\".bz-rn-upload-show-menu\", container);\r\n        self.itemAddfile.hide();\r\n\r\n        $(\"li\", container).click(function () {\r\n            if (mode === \"execution\") {\r\n                bizagi.loading.start();\r\n                var title = this.title || $(this).data(\"filename\");\r\n                $.when(bizagi.util.media.downloadFile($(this).data(\"url\"), title)).fail(function (error) {\r\n                    if (error.responseText){\r\n                        self.getFormContainer().failHandler(error.responseText);\r\n                    }\r\n                }).always(function(){\r\n                    bizagi.loading.stop();\r\n                });\r\n            }\r\n        });\r\n    },\r\n\r\n    activateUploadNative: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var container = self.getControl();\r\n        var control = self.getControl();\r\n\r\n        if (self.getLabel()) {\r\n            self.getLabel().hide();\r\n        }\r\n\r\n        self.itemAddfile = $(\".bz-rn-ecm-upload\", container);\r\n        self.$inputFile = $(\".bz-rn-upload-files-web\", control);\r\n\r\n        $(\".bz-rn-ecm-activate-menu\", control).bind(\"click\", function() {\r\n            var elementBase = $(this);\r\n            var parents = elementBase.parents(\".bz-rn-ecm-metadata\");\r\n            var menu = $(\".bz-rn-ecm-menu-container\", parents);\r\n\r\n            if (!$(this).is(\".active\") && !$(\".bz-rn-ecm-metadata-container\", parents).is(\".active\")) {\r\n                self.closeAccordionSection();\r\n                $(this).addClass(\"active\");\r\n                menu.addClass(\"showMenu\");\r\n            } else if (!$(\".bz-rn-ecm-metadata-container\", parents).is(\".active\")) {\r\n                $(this).removeClass(\"active\");\r\n                self.closeAccordionSection();\r\n            }\r\n\r\n            var tmpidElement = elementBase.parent().data(\"idfileupload\") || \"\";\r\n            self.elementsEvent = {\r\n                \"menu\": menu,\r\n                \"lock\": $(\".bz-ecm-lock\", menu),\r\n                \"unlock\": $(\".bz-ecm-unlock\", menu),\r\n                \"del\": $(\".bz-ecm-delete\", menu),\r\n                \"edit\": $(\".bz-ecm-edit\", menu),\r\n                \"element\": {\r\n                    \"id\": tmpidElement,\r\n                    \"filename\": elementBase.parent().attr(\"title\") || \"\",\r\n                    elementReference: this\r\n                },\r\n                \"params\": {\r\n                    idFileUpload: tmpidElement,\r\n                    xPath: self.properties.xpath,\r\n                    idAttrib: self.properties.idAttrib,\r\n                    idPageCache: self.properties.idPageCache,\r\n                    xpathContext: self.getXpathContext()\r\n                },\r\n                \"panelMetadata\": $(\".bz-rn-ecm-metadata-container\", parents),\r\n                \"btnCancel\": $(\".ecm-btn-cancel\", parents),\r\n                \"btnSave\": $(\".ecm-btn-save\", parents)\r\n            };\r\n\r\n            if (menu.is(\":visible\")) {\r\n                self.addEventsEcm();\r\n            } else {\r\n                self.removeEventsEcm();\r\n            }\r\n\r\n        });\r\n\r\n        if (!properties.editable) {\r\n            self.itemAddfile.hide();\r\n            return;\r\n        }\r\n\r\n        if (bizagi.util.isCordovaSupported()) {\r\n            if (bizagi.util.isAndroidTabletDevice()) {\r\n                self.uploadEcmLink = $(\".bz-rn-ecm-url > span\", container);\r\n                self.uploadEcmLink.on(\"click\", function() {\r\n                    window.open(encodeURI(this.getAttribute(\"href\")), \"_system\", \"location=yes\");\r\n                });\r\n            } else if (bizagi.util.isNativePluginSupported()) {\r\n                // iOS native behaviour, should open files through a webview\r\n                var filesLinkElements = container.find(\".bz-rn-ecm-url > a\");\r\n\r\n                filesLinkElements.removeAttr(\"href\");\r\n                filesLinkElements.on(\"click\", function() {\r\n                    bizagi.loading.start();\r\n                    $.when(bizagi.util.media.downloadFile($(this).data(\"url\"), this.title)).fail(function(error) {\r\n                        if (error.responseText) {\r\n                            self.getFormContainer().failHandler(error.responseText);\r\n                        }\r\n                    }).always(function() {\r\n                        bizagi.loading.stop();\r\n                    });\r\n                });\r\n            }\r\n\r\n            self.itemsUpload = {\r\n                \"file\": $(\".file\", container),\r\n                \"image\": $(\".image\", container),\r\n                \"cimage\": $(\".cimage\", container),\r\n                \"caudio\": $(\".caudio\", container),\r\n                \"cvideo\": $(\".cvideo\", container)\r\n            };\r\n\r\n            self.itemAddfile.bind(\"click\", function() {\r\n                var template = self.renderFactory.getTemplate(\"ecmModalView\");\r\n                var modalViewTemplate = kendo.template(template, { useWithBlock: false });\r\n                var data = {\r\n                    \"editable\": self.properties.editable,\r\n                    \"displayName\": self.properties.displayName || \"\"\r\n                };\r\n                var modalView = $($.trim(modalViewTemplate(data))).clone();\r\n\r\n                modalView.kendoMobileModalView({\r\n                    close: function() {\r\n\r\n                        self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n\r\n                        this.destroy();\r\n                        this.element.remove();\r\n                    },\r\n                    modal: false\r\n                });\r\n\r\n                self.configureModalViewHandlers(modalView);\r\n\r\n                self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n                modalView.kendoMobileModalView(\"open\");\r\n            });\r\n\r\n            self.checkExtensions();\r\n            self.checkMaxFiles();\r\n        } else {\r\n            if (bizagi.util.media.fileAPISupported()) {\r\n                $(self.itemAddfile).click(function() {\r\n                    self.$inputFile.click();\r\n                });\r\n            } else {\r\n                // Bloquea la acción de carga de archivos\r\n                self.itemAddfile.hide();\r\n            }\r\n\r\n            // Just in case\r\n            self.$inputFile.on(\"click\", function(e) { e.stopPropagation(); });\r\n\r\n            // Image change (Web only)\r\n            self.$inputFile.on(\"change\", function() {\r\n                var dataFile = self.$inputFile[0].files[0];\r\n                dataFile.fullPath = self.$inputFile[0].value;\r\n                var extensions = [].concat(self.Class.EXTENSIONSIMG, self.Class.EXTENSIONSVIDEO, self.Class.EXTENSIONSAUDIO);\r\n\r\n                self.startLoading();\r\n                if (bizagi.util.media.checkMaxSizeFile(dataFile, self.properties) &&\r\n                    bizagi.util.media.checkFileTypes(dataFile, self.properties, extensions)) {\r\n\r\n                    $.when(self.uploadFile(dataFile)).done(function(result) {\r\n                        if (typeof result !== \"object\") {\r\n                            // onUploadFileCompleted 2nd param needs to be a response object\r\n                            result = {\r\n                                response: result\r\n                            };\r\n                        }\r\n                        self.onUploadFileCompleted(self, result);\r\n                    }).fail(function(error) {\r\n                        self.stopLoading();\r\n\r\n                        if (error.statusText !== \"Unauthorized\") {\r\n                            bizagi.showMessageBox(self.getResource(\"workportal-widget-admin-language-error\"));\r\n                        }\r\n\r\n                        if (error.code === 3) {\r\n                            bizagi.showMessageBox(self.getResource(\"render-ecm-service-not-available\"), \"Error\");\r\n                        } else {\r\n                            bizagi.showMessageBox(self.getResource(\"render-ecm-service-general-error\"), \"Error\");\r\n                        }\r\n                        bizagi.log(\"An error has occurred: Code = \" + error.code);\r\n                    });\r\n\r\n                } else {\r\n                    self.stopLoading();\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    closeAccordionSection: function(){\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var menuItem = $(\".bz-rn-ecm-activate-menu\", control);\r\n        var menu = $(\".bz-rn-ecm-menu-container\", control);\r\n        var metadata = $(\".bz-rn-ecm-metadata-container\", control);\r\n\r\n        menuItem.removeClass(\"active\");\r\n        menu.removeClass(\"showMenu\");\r\n\r\n        metadata.removeClass(\"active\");\r\n        metadata.slideUp(300).removeClass(\"open\");\r\n    },\r\n\r\n    /**\r\n     * Configure the modalView Handlers for the new combo control.\r\n     * @param {} inputContainer\r\n     * @returns {}\r\n     */\r\n    configureModalViewHandlers: function(inputContainer) {\r\n        var self = this;\r\n\r\n        // Getting combo list elements\r\n        self.listOptions = inputContainer.find(\".bz-rn-upload-options li\");\r\n\r\n        // Setting the initial selected display value\r\n        self.listOptions.bind(\"click\", function() {\r\n            inputContainer.kendoMobileModalView(\"close\");\r\n            self.applyListener($(this).data(\"role\"));\r\n        });\r\n\r\n        inputContainer.find(\".bz-wp-modalview-close\").bind(\"click\", function() {\r\n            inputContainer.kendoMobileModalView(\"close\");\r\n        });\r\n    },\r\n\r\n    addEventsEcm: function() {\r\n        var self = this;\r\n        self.removeEventsEcm();\r\n\r\n        self.elementsEvent.lock.click(function() {\r\n            $.when(self.dataService.checkOutFile(self.elementsEvent.params)).done(function() {\r\n                self.elementsEvent.lock.removeClass(\"bz-ecm-item-menu-enable\");\r\n                self.elementsEvent.unlock.addClass(\"bz-ecm-item-menu-enable\");\r\n\r\n            });\r\n        });\r\n\r\n        self.elementsEvent.unlock.click(function() {\r\n            $.when(self.dataService.cancelCheckOut(self.elementsEvent.params)).done(function() {\r\n                self.elementsEvent.unlock.removeClass(\"bz-ecm-item-menu-enable\");\r\n                self.elementsEvent.lock.addClass(\"bz-ecm-item-menu-enable\");\r\n            });\r\n        });\r\n\r\n        var nTimeoutAccordionSection = null;\r\n\r\n        self.elementsEvent.del.bind(\"click\", function () {\r\n            // To avoid to be triggered more than once\r\n            clearTimeout( nTimeoutAccordionSection );\r\n            self.closeAccordionSection();\r\n            self.startLoading();\r\n\r\n            $(self.elementsEvent.element.elementReference).closest(\".bz-rn-ecm-metadata\").css(\"opacity\", 0.5);\r\n\r\n            $.when(self.dataService.deleteECMFile(self.elementsEvent.params)).done(function () {\r\n                self.stopLoading();\r\n                self.removeEventsEcm();\r\n                $(self.elementsEvent.element.elementReference).parents(\".bz-rn-ecm-metadata\").remove();\r\n\r\n                //Set files in a temporal array\r\n                var files = [].concat(self.files);\r\n\r\n                //Remove element form files array\r\n                for (var i = 0; i < files.length; i++) {\r\n                    if (files[i][0] === self.elementsEvent.params.idFileUpload) {\r\n                        files.splice(i, 1);\r\n                    }\r\n                }\r\n\r\n                //Set Value\r\n                self.setValue(files);\r\n\r\n                // Check maxFiles\r\n                self.checkMaxFiles();\r\n\r\n\r\n            });\r\n        });\r\n\r\n        self.setMobiscroll();\r\n\r\n        self.elementsEvent.edit.click(function () {\r\n            // To avoid to be triggered more than once\r\n            clearTimeout( nTimeoutAccordionSection );\r\n            self.closeAccordionSection();\r\n\r\n            if(!self.elementsEvent.panelMetadata.is(\".active\")) {\r\n                self.elementsEvent.panelMetadata.addClass(\"active\");\r\n                nTimeoutAccordionSection = setTimeout(function(){\r\n                    self.elementsEvent.panelMetadata.stop().slideDown(300).addClass(\"open\");\r\n                }, 200);\r\n            }\r\n        });\r\n\r\n        self.elementsEvent.btnSave.click(function () {\r\n            var properties = self.properties;\r\n            var elementsToCheck = $(\".bz-rn-ecm-metadata-value\", self.elementsEvent.panelMetadata);\r\n            var metadata = [];\r\n            var isInvalid = false;\r\n            var $button = $(this);\r\n\r\n            // To avoid to be triggered more than once\r\n            clearTimeout( nTimeoutAccordionSection );\r\n            //self.closeAccordionSection();\r\n            //self.startLoading();\r\n            self.startWaiting( $button );\r\n\r\n            for (var metadataelement = 0; metadataelement < elementsToCheck.length; metadataelement++) {\r\n                var tmpElement = elementsToCheck[metadataelement];\r\n                var oldValue = $(tmpElement).data(\"value\");\r\n                var type = $(tmpElement).data(\"metadatatype\");\r\n                var required = $(tmpElement).data(\"required\");\r\n                var readonly = $(tmpElement).data(\"readonly\");\r\n                var description = $(tmpElement).data(\"description\");\r\n                var idmetadata = $(tmpElement).data(\"idmetadata\");\r\n                var actualValue = null;\r\n\r\n                if (readonly) {\r\n                    self.stopLoading();\r\n                    self.stopWaiting($button);\r\n                    return true;\r\n                }\r\n\r\n                if (type == \"STRING\" || type == \"DECIMAL\") {\r\n                    actualValue = $(\"input\", tmpElement).val();\r\n                } else if (type == \"BOOL\") {\r\n                    actualValue = $(\"input[name=ecm-radio]:checked\", tmpElement).val();\r\n                } else if (type == \"DATETIME\") {\r\n                    var format = ( self.properties.fullFormat ? self.properties.fullFormat : ( self.getResource(\"fullFormat\") != \"fullFormat\" ? self.getResource(\"fullFormat\") : \"yyyy-MM-dd HH:mm:ss\" ) );\r\n                    actualValue = bizagi.util.dateFormatter.formatDate( bizagi.util.dateFormatter.getDateFromISO( $(\"input\", tmpElement).attr(\"value\"), false ), format );\r\n                }\r\n\r\n                if (required && ( actualValue === \"\" || actualValue === null)) {\r\n                    bizagi.showMessageBox(description + \": \" + self.getResource(\"render-ecm-tooltip-mandatory\"), \"Error\");\r\n                    isInvalid = true;\r\n                }\r\n\r\n                if (!isInvalid && actualValue != oldValue) {\r\n                    metadata.push({\r\n                        idMetadata: idmetadata,\r\n                        value: actualValue\r\n                    });\r\n                }\r\n            }\r\n\r\n            if (!isInvalid) {\r\n                var params = self.buildAddParams();\r\n                params.fileName = self.elementsEvent.element.filename;\r\n                params.idFileUpload = self.elementsEvent.element.id;\r\n                params.idPageCache = properties.idPageCache;\r\n                params.metaValues = JSON.encode({\r\n                    metadataValues: metadata\r\n                });\r\n\r\n                $.when(self.dataService.updateECMMetadata(params)).done(function () {\r\n                    self.stopLoading();\r\n                    self.stopWaiting($button);\r\n                });\r\n            }\r\n            else {\r\n                self.stopLoading();\r\n                self.stopWaiting($button);\r\n            }\r\n        });\r\n\r\n        self.elementsEvent.btnCancel.click(function () {\r\n            self.closeAccordionSection();\r\n            self.removeEventsEcm();\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Creates the date picker for the DOM.bz-ecm-metadata-date elements\r\n     */\r\n    setMobiscroll: function(){\r\n        var self = this;\r\n        var metadataElements = self.elementsEvent.panelMetadata.find(\".bz-ecm-metadata-date\");\r\n        metadataElements.each(function(index, input){\r\n            var $input = $(input);\r\n            var value = $input.attr(\"value\");\r\n            var now = new Date();\r\n            var valueDate = new Date( value ) || now;\r\n            var minDate = ( now.getTime() < valueDate.getTime() ? now : valueDate );\r\n            minDate.setFullYear( minDate.getFullYear() - 2 );\r\n            $input.mobiscroll().calendar({\r\n                mode: \"mixed\", // Specify scroller mode like: mode: \"mixed\" or omit setting to use default\r\n                display: \"bottom\", // Specify display mode like: display: \"bottom\" or omit setting to use default\r\n                controls: [\"calendar\"],\r\n                min: minDate,\r\n                defaultValue: valueDate,\r\n                lang: bizagi.util.languages[BIZAGI_LANGUAGE] || \"en\",\r\n                onSet: function(e) {\r\n                    // It seems like the plugin doesn't sets the value\r\n                    $input.attr(\"value\", e.valueText );\r\n                }\r\n            });\r\n        });\r\n    },\r\n\r\n    removeEventsEcm: function () {\r\n        var self = this;\r\n\r\n        self.elementsEvent.lock.unbind(\"click\");\r\n        self.elementsEvent.unlock.unbind(\"click\");\r\n        self.elementsEvent.del.unbind(\"click\");\r\n        self.elementsEvent.edit.unbind(\"click\");\r\n        self.elementsEvent.btnSave.unbind(\"click\");\r\n        self.elementsEvent.btnCancel.unbind(\"click\");\r\n    },\r\n\r\n    removeListener: function() {\r\n        var self = this;\r\n        self.itemsUpload.image.unbind(\"click\");\r\n        self.itemsUpload.file.unbind(\"click\");\r\n        self.itemsUpload.cimage.unbind(\"click\");\r\n        self.itemsUpload.caudio.unbind(\"click\");\r\n        self.itemsUpload.cvideo.unbind(\"click\");\r\n    },\r\n\r\n    applyListener: function(option) {\r\n        var self = this;\r\n\r\n        switch (option) {\r\n            case \"image\":\r\n                navigator.camera.getPicture(function(dataImage) {\r\n\r\n                    $.when(bizagi.util.media.checkMaxSize(dataImage, self.properties)).done(function() {\r\n                        $.when(bizagi.util.media.getFileDataInfo(dataImage)).then(function(fileData) {\r\n                            self.fileProperties = fileData;\r\n                            self.saveImage(self, dataImage);\r\n                        });\r\n                    });\r\n                    self.itemAddfile.click();\r\n                }, self.onFail, {\r\n                    quality: self.Class.QUALITY_PICTURE,\r\n                    sourceType: Camera.PictureSourceType.PHOTOLIBRARY\r\n                });\r\n                break;\r\n\r\n            case \"cimage\":\r\n                navigator.camera.getPicture(function(dataImage) {\r\n                        $.when(bizagi.util.media.checkMaxSize(dataImage, self.properties)).done(function() {\r\n                            $.when(bizagi.util.media.getFileDataInfo(dataImage)).then(function(fileData) {\r\n                                self.fileProperties = fileData;\r\n                                self.saveImage(self, dataImage);\r\n                            });\r\n                        });\r\n                        self.itemAddfile.click();\r\n                    },\r\n                    self.onFail, { \r\n                        quality: self.Class.QUALITY_PICTURE,\r\n                        correctOrientation: true\r\n                    });\r\n                break;\r\n\r\n            case \"caudio\":\r\n                navigator.device.capture.captureAudio(function(mediaFiles) {\r\n                    var audioUrl = mediaFiles[0].localURL;\r\n                    $.when(bizagi.util.media.checkMaxSize(audioUrl, self.properties)).done(function() {\r\n                        self.saveAudio(self, mediaFiles);\r\n                    }).always(function() {\r\n                        bizagi.loading.stop({});\r\n                    });\r\n                    self.itemAddfile.click();\r\n                }, self.onFail, { limit: self.Class.LIMIT });\r\n                break;\r\n\r\n            case \"cvideo\":\r\n                navigator.device.capture.captureVideo(function(dataImage) {\r\n                    $.when(bizagi.util.media.checkMaxSizeVideo(dataImage, self.properties)).done(function() {\r\n                        self.saveVideo(self, dataImage);\r\n                    }).always(function() {\r\n                        bizagi.loading.stop({});\r\n                    });\r\n                    self.itemAddfile.click();\r\n                }, self.onFail, { limit: self.Class.LIMIT });\r\n                break;\r\n\r\n            case \"file\":\r\n                bizagi.showMessageBox(\"In development\", \"Error\");\r\n                break;\r\n\r\n            default:\r\n                break;\r\n        }\r\n    },\r\n\r\n    renderUploadItem: function(file) {\r\n        return this._super(file);\r\n    },\r\n\r\n    /**\r\n     * Send file using HTTP\r\n     * @param dataFile\r\n     * @return {jQuery} $.Deferred()\r\n     */\r\n    uploadFile: function(dataFile) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        if (bizagi.util.media.checkMaxSizeFile(dataFile, self.properties) &&\r\n            bizagi.util.media.checkFileTypes(dataFile, self.properties, [].concat( self.Class.EXTENSIONSIMG, self.Class.EXTENSIONSVIDEO, self.Class.EXTENSIONSAUDIO ) )) {\r\n\r\n            // Get form data for POSTing\r\n            var formData = new FormData();\r\n            var form = self.getFormContainer();\r\n            var data = self.buildAddParams();\r\n\r\n            var keys = Object.keys( data );\r\n            keys.map(function( key ){\r\n                formData.append(key, data[key]);\r\n            });\r\n\r\n            formData.append(\"Filedata\", dataFile);\r\n            // It seems like some OS uses \\ instead of / so ...\r\n            formData.append(\"Filename\", dataFile.name.substr(dataFile.name.replace(/([\\\\\\/]+)/g, \"/\").lastIndexOf(\"/\") + 1) );\r\n\r\n            if (self.properties.contexttype) {\r\n                formData.append(self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\", self.properties.contexttype);\r\n            }\r\n\r\n            try {\r\n                if (typeof (BIZAGI_SESSION_NAME) !== \"undefined\") {\r\n                    formData.append(BIZAGI_SESSION_NAME, form.properties.sessionId);\r\n                } else {\r\n                    formData.append(\"JSESSIONID\", form.properties.sessionId);\r\n                }\r\n            } catch (e) {\r\n                formData.append(\"JSESSIONID\", form.properties.sessionId);\r\n            }\r\n\r\n            self.dataService.processUploadFile({\r\n                url: self.properties.addUrl,\r\n                formData: formData\r\n            }).done(function(response) {\r\n                defer.resolve(response);\r\n            }).fail(function(error) {\r\n                defer.reject(error);\r\n            });\r\n\r\n        } else {\r\n            bizagi.loading.stop();\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Send image using HTTP\r\n     * @param {} context\r\n     * @param {} dataImage\r\n     * @returns {}\r\n     */\r\n    saveImage: function(context, dataImage) {\r\n        var self = context;\r\n        var params = {};\r\n        var addParams = self.buildAddParams();\r\n        var fileName = self.fileProperties.name;\r\n\r\n        if (self.editedImageURL) {\r\n            params.dataFile = self.editedImageURL;\r\n        } else if(self.fileProperties) {\r\n            params.dataFile = self.fileProperties.url;\r\n        }\r\n\r\n        addParams.queueID = \"q_\" + bizagi.util.encodeXpath(self.getUploadXpath());\r\n        addParams[\"xPath\"] = addParams[\"xPath\"];\r\n        addParams.Filename = fileName;\r\n\r\n        params.data = addParams;\r\n        params.options = new FileUploadOptions();\r\n        params.options.fileKey = \"file\";\r\n        params.options.fileName = fileName;\r\n        params.options.mimeType = \"image/jpeg\";\r\n        params.options.uploadKey = {key: addParams[\"h_xpath\"]};\r\n        params.options.addUrl = self.properties.addUrl;\r\n\r\n        //Cleans variables related previous uploads\r\n        self.editedImageURL = null;\r\n        self.fileProperties = null;\r\n\r\n        // Fix android 4.4 getting images from recent folder\r\n        params.dataFile = bizagi.util.media.getImagePath(params.dataFile);\r\n\r\n        bizagi.loading.start();\r\n        $.when(bizagi.util.media.uploadFile(params)).done(function(r) {\r\n            self.onUploadFileCompleted(context, r);\r\n        }).fail(function(error) {\r\n            if (error.code === 3) {\r\n                bizagi.showMessageBox(self.getResource(\"render-ecm-service-not-available\"), \"Error\");\r\n            } else {\r\n                bizagi.showMessageBox(self.getResource(\"render-ecm-service-general-error\"), \"Error\");\r\n            }\r\n            bizagi.log(\"An error has occurred: Code = \" + error.code);\r\n        }).always(function() {\r\n            bizagi.loading.stop({});\r\n        });\r\n    },\r\n\r\n    saveAudio: function(context, dataAudio) {\r\n        var self = context;\r\n        var params = {};\r\n        var fileName = dataAudio[0].name;\r\n        var addParams = self.buildAddParams();\r\n\r\n        addParams.queueID = \"q_\" + bizagi.util.encodeXpath(self.getUploadXpath());\r\n        addParams[\"xPath\"] = addParams[\"xPath\"];\r\n        addParams.Filename = fileName;\r\n\r\n        params.data = addParams;\r\n        params.options = new FileUploadOptions();\r\n        params.options.fileName = fileName;\r\n        params.options.uploadKey = {key: addParams[\"xPath\"]};\r\n        params.options.addUrl = self.properties.addUrl;\r\n        params.dataFile = dataAudio[0].fullPath;\r\n\r\n        bizagi.loading.start();\r\n        $.when(bizagi.util.media.uploadFile(params)).done(function(r) {\r\n            self.onUploadFileCompleted(context, r);\r\n        }).fail(function(error) {\r\n            if (error.code === 3) {\r\n                bizagi.showMessageBox(self.getResource(\"render-ecm-service-not-available\"), \"Error\");\r\n            } else {\r\n                bizagi.showMessageBox(self.getResource(\"render-ecm-service-general-error\"), \"Error\");\r\n            }\r\n            bizagi.log(\"An error has occurred: Code = \" + error.code);\r\n        }).always(function() {\r\n            bizagi.loading.stop({});\r\n        });\r\n    },\r\n\r\n    saveVideo: function(context, dataVideo) {\r\n        var self = context;\r\n        var params = {};\r\n        var fileName = dataVideo[0].name;\r\n        var addParams = self.buildAddParams();\r\n\r\n        addParams.queueID = \"q_\" + bizagi.util.encodeXpath(self.getUploadXpath());\r\n        addParams[\"xPath\"] = addParams[\"xPath\"];\r\n        addParams.Filename = fileName;\r\n\r\n        params.data = addParams;\r\n        params.options = new FileUploadOptions();\r\n        params.options.fileKey = \"file\";\r\n        params.options.fileName = fileName;\r\n        params.options.uploadKey = {key: addParams[\"xPath\"]};\r\n        params.options.addUrl = self.properties.addUrl;\r\n        params.dataFile = dataVideo[0].fullPath;\r\n\r\n        bizagi.loading.start();\r\n        $.when(bizagi.util.media.uploadFile(params)).done(function(r) {\r\n            self.onUploadFileCompleted(context, r);\r\n        }).fail(function(error) {\r\n            if (error.code === 3) {\r\n                bizagi.showMessageBox(self.getResource(\"render-ecm-service-not-available\"), \"Error\");\r\n            } else {\r\n                bizagi.showMessageBox(self.getResource(\"render-ecm-service-general-error\"), \"Error\");\r\n            }\r\n\r\n            bizagi.log(\"An error has occurred: Code = \" + error.code);\r\n        }).always(function() {\r\n            bizagi.loading.stop({});\r\n        });\r\n    },\r\n\r\n    onFail: function(error) {\r\n        bizagi.log(\"Error code: \" + error.code);\r\n    },\r\n\r\n    onUploadFileCompleted: function(context, response) {\r\n        var self = this;\r\n\r\n        try {\r\n            response = JSON.parse(decodeURI(response.response));\r\n            if ( response.idFileUpload ) {\r\n                self.submitOnChange();\r\n            } else {\r\n                throw \"not present idFileUpload\";\r\n            }\r\n        } catch (e) {\r\n            bizagi.showMessageBox(self.getResource(\"render-ecm-service-not-available\"), \"Error\");\r\n            bizagi.log(\"Error ECM:\");\r\n            bizagi.log(e);\r\n        }\r\n    },\r\n\r\n    checkMaxFiles: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var maxFiles = properties.maxfiles;\r\n        var actualFiles = properties.value.length;\r\n\r\n        if (maxFiles !== 0 && (actualFiles >= maxFiles)) {\r\n            self.itemAddfile.hide();\r\n            self.removeListener();\r\n        }\r\n    },\r\n\r\n    checkExtensions: function() {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var validExtensions = properties.validExtensions;\r\n\r\n        if ( !validExtensions ) {\r\n            return;\r\n        }\r\n\r\n        validExtensions = validExtensions.split(\";\");\r\n\r\n        if (validExtensions.length == 1 && validExtensions[0].indexOf(\"*.*\") !== -1) {\r\n            return;\r\n        }\r\n\r\n        var enableVideo = false;\r\n        var enableAudio = false;\r\n        var enableImage = false;\r\n\r\n        for (var i = 0; i < validExtensions.length; i++) {\r\n            validExtensions[i] = validExtensions[i].replace(\"*.\", \"\");\r\n\r\n            var image = self.Class.EXTENSIONSIMG.toString().indexOf(validExtensions[i]);            \r\n\r\n            if (image >= 0) {\r\n                enableImage = true;\r\n            }           \r\n        }\r\n\r\n        if (!enableImage) {\r\n            self.itemsUpload.image.hide();\r\n            self.itemsUpload.cimage.hide();\r\n\r\n            self.itemsUpload.image.parent().addClass(\"bz-rn-upload-hidden-item\");\r\n            self.itemsUpload.cimage.parent().addClass(\"bz-rn-upload-hidden-item\");\r\n        }\r\n\r\n        if (!enableAudio) {\r\n            self.itemsUpload.caudio.hide();\r\n            self.itemsUpload.caudio.parent().addClass(\"bz-rn-upload-hidden-item\");\r\n        }\r\n\r\n        if (!enableVideo) {\r\n            self.itemsUpload.cvideo.hide();\r\n            self.itemsUpload.cvideo.parent().addClass(\"bz-rn-upload-hidden-item\");\r\n        }\r\n\r\n\r\n        if (!enableAudio && !enableImage && !enableVideo) {\r\n            self.itemAddfile.hide();\r\n            self.removeListener();\r\n        }\r\n    },\r\n\r\n    renderFileLayout: function (data, fileProperties) {\r\n        var self = this;\r\n        var form = self.getFormContainer();\r\n        var metadataTemplate = self.renderFactory.getTemplate(\"ecm-metadata\");\r\n        var deferred = $.Deferred();\r\n\r\n        $.when(self.dataService.getECMMetadata(data),\r\n            (fileProperties) ? [fileProperties] : self.dataService.getFileProperties(data)\r\n        ).done(function (metaData, fileProperties) {\r\n\r\n            fileProperties[0].data = data;\r\n\r\n            // Make xpath context\r\n            fileProperties[0].xpathContext = fileProperties[0].xpathContext || form.properties.xpathContext || \"\";\r\n            fileProperties[0].xpath = self.properties.xpath;\r\n\r\n            metaData[0].filename = data.fileName;\r\n            metaData[0].url = self.buildItemUrl(fileProperties[0]);\r\n\r\n            // Define File Properties\r\n            metaData[0].ecm_ecmStatus = fileProperties[0].ecmStatus;\r\n            metaData[0].ecm_isVisible = fileProperties[0].isVisible;\r\n            metaData[0].ecm_allowUpdateMetadata = fileProperties[0].allowUpdateMetadata;\r\n            metaData[0].ecm_allowDelete = fileProperties[0].allowDelete;\r\n            metaData[0].ecm_allowUpdateContent = fileProperties[0].allowUpdateContent;\r\n            metaData[0].ecm_allowView = fileProperties[0].allowView;\r\n            metaData[0].ecm_allowCheckOut = fileProperties[0].allowCheckOut;\r\n            metaData[0].ecm_allowCancelCheckOut = fileProperties[0].allowCancelCheckOut;\r\n            metaData[0].ecm_allowEdit = data.editable && fileProperties[0].allowEdit;\r\n            metaData[0].ecm_ecmStatus = fileProperties[0].ecmStatus;\r\n            metaData[0].idFileUploads = fileProperties[0].idFileUpload;\r\n            metaData[0].xpath = fileProperties[0].xpath;\r\n            metaData[0].value = bizagi.util.parseBoolean(fileProperties[0].value);\r\n            metaData[0].deviceType = bizagi.detectDevice();\r\n\r\n            if( metaData[0].metadata && metaData[0].metadata.length ) {\r\n                metaData[0].metadata.map(function shapeMetadataValues( meta ){\r\n                    if( meta.metadataType === \"DATETIME\" ) {\r\n                        // Format the actual date to ISO, so mobiscroll can useit\r\n                        // Before save the value it has to go back to the original format (cause service will accept any format)\r\n                        meta.dateFormat = ( self.getResource(\"fullFormat\") !== \"fullFormat\" ? self.getResource(\"fullFormat\") : ( self.properties.fullFormat ? self.properties.fullFormat : \"yyyy-MM-dd HH:mm:ss\" ) );\r\n                        meta.value = bizagi.util.dateFormatter.formatDate( ( meta.value ? bizagi.util.dateFormatter.getDateFromFormat( meta.value, meta.dateFormat) : new Date() ), \"yyyy-MM-dd\" );\r\n                    }\r\n                });\r\n            }\r\n\r\n            var html = $.kendoTmpl(metadataTemplate, metaData[0]);\r\n            deferred.resolve(html);\r\n        });\r\n\r\n        return deferred.promise();\r\n    },\r\n    /*Check if all meta data fields that's right */\r\n    isValid: function (invalidElements) {\r\n        var self = this,\r\n            control = self.getControl(),\r\n            message = [],\r\n            error = false,\r\n            properties = self.properties;\r\n\r\n\r\n        var bValid = true;\r\n\r\n        if (properties.required) {\r\n            var newRow = self.grid && self.grid.isFromCreatedRow.apply(self);\r\n            // Call base\r\n            bValid = newRow ? true : this._super(invalidElements);\r\n\r\n            if (self.filesCount === 0 && bValid) {\r\n\r\n                invalidElements.push({\r\n                    xPath: properties.xpath,\r\n                    message: self.getResource(\"render-required-text\").replaceAll(\"#label#\", properties.displayName)\r\n                });\r\n                bValid = false;\r\n            }\r\n        }\r\n\r\n        if (properties.editable) {\r\n            var $arrayEcmControls = $(\".bz-rn-ecm-container:visible\", control).find(\".bz-rn-ecm-metadata-value[data-required='true']\");\r\n            $.each($arrayEcmControls, function (key, value) {\r\n                if ($(\"input\", value).val() === \"\") {\r\n                    message.push($(value).data(\"description\"));\r\n                    error = true;\r\n                }\r\n            });\r\n        }\r\n\r\n        if (error) {\r\n            var errorMessage = self.getResource(\"render-required-text\").replaceAll(\"#label#\", message.join(\", \"));\r\n            invalidElements.push({\r\n                xPath: properties.xpath,\r\n                message: errorMessage\r\n            });\r\n\r\n            // If it has error, enable editable view.\r\n            // open popup\r\n\r\n        }\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /**\r\n     * Cleans current value\r\n     */\r\n    cleanData: function () {\r\n        var self = this;\r\n\r\n        self.setValue(null);\r\n        self.clearDisplayValue();\r\n    },\r\n\r\n    /**\r\n     *   Sets the value in the rendered control\r\n     */\r\n    clearDisplayValue: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        var arrayItems = control.find(\".bz-rn-ecm-file-container\");\r\n        var length = arrayItems.length - 1;\r\n\r\n        $.each(arrayItems, function (index, value) {\r\n            var item = $(value);\r\n            var file = item.data();\r\n\r\n            if (file) {\r\n                $.when(self.deleteUploadItem(item, file.idfileupload)).done(function () {\r\n                    // Detach item\r\n                    item.remove();\r\n                });\r\n            }\r\n        });\r\n\r\n        // Check maxFiles\r\n        self.filesCount = 0;\r\n    }\r\n});","/**\r\n *   Name: Bizagi Tablet Render Yes-No Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the Yes-No render class to adjust to desktop devices\r\n */\r\n\r\nbizagi.rendering.searchList.extend(\"bizagi.rendering.searchList\", {\r\n    SEARCH_MIN_LENGTH: 2,\r\n    temporalElements: {}\r\n}, {\r\n    /**\r\n     * RenderSingle Method\r\n     * */\r\n    initializeList: function () {\r\n        var self = this;\r\n\r\n        self._super();\r\n        var control = self.getControl();\r\n\r\n        //Getting all aux templates\r\n        self.modalViewTemplates = kendo.template(self.renderFactory.getTemplate('searchListModalViewAuxTemplates'), { useWithBlock: false });\r\n        self.inputTemplates = kendo.template(self.renderFactory.getTemplate('searchListInputAuxTemplates'), { useWithBlock: false });\r\n\r\n        //Getting the input\r\n        self.input = $(\".bz-rn-container-searchlist\", control);\r\n\r\n        self.configureListHandlers();\r\n    },\r\n\r\n    /**\r\n     * Postrender Method\r\n     * */\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        //Initialicing the list\r\n        self.initializeList();\r\n\r\n        // Call base\r\n        this._super();\r\n\r\n        //trigger click event on remove tag\r\n        self.input.on(\"click\", '.bz-rn-remove-tag-on-search-list', function () {\r\n            self.removeItem($(this));\r\n        });\r\n    },\r\n\r\n    postRenderReadOnly: function(){\r\n        var self = this;\r\n\r\n        // Initialicing the list\r\n        self.initializeList();\r\n\r\n        // Call base\r\n        this._super();\r\n\r\n        if (!self.properties.editable) {\r\n            //Add styles class\r\n            self.configureReadOnly();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Setting the control events\r\n     * */\r\n    configureListHandlers: function () {\r\n        var self = this;\r\n\r\n        if (self.properties.editable) {\r\n            if (self.properties.value.length > 0) {\r\n                self.configureModalView(\".bz-rn-last-child\");\r\n            } else {\r\n                self.configureModalView(\"ul\");\r\n                self.configureModalView(\".bz-rn-last-child\");\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Configure the modal view to select values\r\n     * */\r\n    configureModalView: function(selector) {\r\n        var self = this;\r\n        var inputContainer = (selector === \"\") ? self.input : $(selector, self.input);\r\n\r\n        inputContainer.unbind().bind(\"click\", function() {\r\n            //Getting the values to show\r\n            var elements = $(\"ul li.bz-rn-regular-element\", self.input);\r\n            var values = [];\r\n\r\n            //Reset the temporal array\r\n            self.Class.temporalElements = {};\r\n\r\n            for (var i = 0, length = elements.length; i < length; i++) {\r\n                var id = $(elements[i]).data(\"id\");\r\n                var value = $(\"label\", $(elements[i])).text();\r\n                var newElement = { 'id': id, 'value': value };\r\n\r\n                values.push(newElement);\r\n\r\n                //Add element to temporal context array\r\n                self.addTemporalElement(id, value, false);\r\n            }\r\n\r\n            //Creating modal view\r\n            var template = self.renderFactory.getTemplate('searchListModalView');\r\n            var modalViewTemplate = kendo.template(template, { useWithBlock: false });\r\n            var data = {\r\n                'items': values,\r\n                'displayName': self.properties.displayName || \"\",\r\n                \"orientation\": self.properties.orientation\r\n            };\r\n            var modalView = $($.trim(modalViewTemplate(data)));\r\n\r\n            modalView.kendoMobileModalView({\r\n                close: function() {\r\n                    self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n\r\n                    this.destroy();\r\n                    this.element.remove();\r\n                },\r\n                useNativeScrolling: true,\r\n                modal: false\r\n            });\r\n\r\n            self.configureModalViewHandlers(modalView);\r\n\r\n            self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n            modalView.kendoMobileModalView('open');\r\n            modalView.closest(\".k-animation-container\").addClass(\"bz-rn-new-modalview-position\");\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Configure the modalView Handlers for the new combo control.\r\n     * */\r\n    configureModalViewHandlers: function(inputContainer) {\r\n        var self = this;\r\n\r\n        var closeModalViewPromise = new $.Deferred();\r\n\r\n        //Hide the clear text icon\r\n        inputContainer.find(\".bz-wp-modalview-header-cancel-search\").hide(500);\r\n\r\n        //Showing found results\r\n        inputContainer.find(\".bz-wp-modalview-header-input-search\").on('keypress keyup', function() {\r\n            if (this.value !== \"\") {\r\n                inputContainer.find(\".bz-wp-modalview-header-cancel-search\").show(500);\r\n            } else {\r\n                inputContainer.find(\".bz-wp-modalview-header-cancel-search\").hide(500);\r\n            }\r\n\r\n            //Show splash loader\r\n            bizagi.loading.start({ 'selector': \".bz-rn-new-modalview-content-styles\" });\r\n\r\n            //Getting and showing the data\r\n            $.when(self.showResults(this.value, inputContainer)).always(function() {\r\n                bizagi.loading.stop({ 'selector': \".bz-rn-new-modalview-content-styles\" });\r\n            });\r\n        });\r\n\r\n        //Cleaning search\r\n        inputContainer.find(\".bz-wp-modalview-header-cancel-search\").bind('click', function() {\r\n            self.showNoResultsMessage(self.getResource(\"workportal-widget-inboxcommon-no-results-found\"), inputContainer);\r\n            inputContainer.find(\".bz-wp-modalview-header-input-search\").val(\"\");\r\n            $(this).hide(500);\r\n        });\r\n\r\n        //when click on apply button\r\n        inputContainer.delegate(\".ui-bizagi-apply-button-searchlist\", \"click\", function() {\r\n            closeModalViewPromise.resolve();\r\n            inputContainer.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        inputContainer.find(\".bz-wp-modalview-close\").bind(\"click\", function() {\r\n            closeModalViewPromise.reject();\r\n            inputContainer.data(\"kendoMobileModalView\").close();\r\n        });\r\n\r\n        //Trigger delete event for tags\r\n        inputContainer.find(\".filter-searchlist-modal-view-tags\").on(\"click\", '.bz-rn-remove-tag-on-search-list',\r\n            function() {\r\n                self.removeItem($(this), true);\r\n\r\n                var term = inputContainer.find(\".bz-wp-modalview-header-input-search\").val();\r\n\r\n                //Show splash loader\r\n                bizagi.loading.start({ 'selector': \".bz-rn-new-modalview-content-styles\" });\r\n\r\n                //Getting and showing the data\r\n                $.when(self.showResults(term, inputContainer)).always(function() {\r\n                    bizagi.loading.stop({ 'selector': \".bz-rn-new-modalview-content-styles\" });\r\n                });\r\n            });\r\n\r\n        $.when(closeModalViewPromise)\r\n            .done(function() {\r\n                self.addNewValuesToInput();\r\n                self.Class.temporalElements = {};\r\n            }).fail(function() {\r\n                self.Class.temporalElements = {};\r\n            });\r\n    },\r\n\r\n    /**\r\n     * Show finded results\r\n     * */\r\n    showResults: function (value, inputContainer) {\r\n        var self = this;\r\n\r\n        return $.when(self.processRequest({ 'term': value })).done(function (suggestions) {\r\n            if (suggestions.length === 0) {\r\n                self.showNoResultsMessage(self.getResource(\"workportal-widget-inboxcommon-no-results-found\"), inputContainer);\r\n            } else {\r\n                //Hide current results\r\n                $(\"#ui-bizagi-wp-filter-results-searchlist-wrapper ul li\", inputContainer).remove();\r\n\r\n                //Add new results to list\r\n                var newElement = $(\"li\", $(bizagi.util.trim(self.modalViewTemplates({ 'template': \"sugestions\", 'items': suggestions }))));\r\n                newElement.appendTo($(\"#ui-bizagi-wp-filter-results-searchlist-wrapper ul\", inputContainer));\r\n\r\n                //Get list of elements\r\n                self.modalViewList = $(\".ui-bizagi-render-list-elements\", inputContainer);\r\n\r\n                //Setting the initial selected display value\r\n                self.modalViewList.find(\"li\").unbind().bind(\"click\", function () {\r\n                    //add new element to data control\r\n                    self.appendFoundItem(this, $(\".filter-searchlist-modal-view-tags\", inputContainer));\r\n\r\n                    if ($(this).siblings().length === 0) {\r\n                        self.showNoResultsMessage(self.getResource(\"workportal-widget-inboxcommon-no-results-found\"), inputContainer);\r\n                    }\r\n\r\n                    $(this).remove();\r\n                });\r\n            }\r\n        }).fail(function (response) {\r\n            self.showNoResultsMessage(response, inputContainer);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Adding new values to input\r\n     * */\r\n    addNewValuesToInput: function () {\r\n        var self = this;\r\n\r\n        //Create a temporal array\r\n        var tempArray = [];\r\n\r\n        $.each(self.Class.temporalElements, function (i, ele) {\r\n            tempArray.push(ele.obj);\r\n        });\r\n\r\n        self.setValue(tempArray);\r\n\r\n        //Clear the input\r\n        $(\"ul li\", self.input).remove();\r\n\r\n        //Get the input content\r\n        var inputContainer = $(\"li\", $(bizagi.util.trim(self.inputTemplates({ 'template': \"inputContainer\", 'value': tempArray }))));\r\n\r\n        //Add the input container\r\n        inputContainer.appendTo($(\"ul\", self.input));\r\n\r\n        //unbind current events\r\n        $(\"ul\", self.input).unbind();\r\n        $(\".bz-rn-last-child\", self.input).unbind();\r\n\r\n        //Trigger click event\r\n        if (tempArray.length > 0) {\r\n            self.configureModalView(\".bz-rn-last-child\");\r\n        } else {\r\n            self.configureModalView(\"ul\");\r\n            self.configureModalView(\".bz-rn-last-child\");\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   check if the control has value\r\n     */\r\n    hasValue: function () {\r\n        var self = this;\r\n        return JSON.parse(self.getValue()).value.length > 0;\r\n    },\r\n\r\n    /*\r\n     *   Sets the internal value\r\n     */\r\n    setValue: function (value, triggerEvents) {\r\n        var self = this;\r\n        triggerEvents = triggerEvents !== undefined ? triggerEvents : true;\r\n\r\n        // Change internal value\r\n        self.value = JSON.encode({\r\n            \"value\": value\r\n        });\r\n\r\n        self.changeRequiredLabel(!self.hasValue());\r\n\r\n        // Trigger events\r\n        if (triggerEvents && !self.internalSetInitialValueFlag) {\r\n            self.triggerRenderChange();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Show the correct message if there are elements to show\r\n     * */\r\n    showNoResultsMessage: function (message, inputContainer) {\r\n        var self = this;\r\n        $(\"#ui-bizagi-wp-filter-results-searchlist-wrapper ul li\", inputContainer).remove();\r\n        var newElement = $(\"li\", $(bizagi.util.trim(self.modalViewTemplates({ 'template': \"modalViewDefaultMessage\", 'message': message }))));\r\n        newElement.appendTo($(\"#ui-bizagi-wp-filter-results-searchlist-wrapper ul\", inputContainer));\r\n    },\r\n\r\n    /**\r\n     * Append founded item\r\n     * */\r\n    appendFoundItem: function (item, container) {\r\n        var self = this;\r\n\r\n        // Map the ids of the elements to an array\r\n        var uniqueIds = $.map($('li', container), function (val) {\r\n            return $(val).data('id');\r\n        });\r\n\r\n        // Avoid appending duplicated items\r\n        if (uniqueIds.indexOf($(item).data(\"id\")) == -1) {\r\n            var id = $(item).data(\"id\");\r\n            var value = $(\"label\", item).text();\r\n            var $newElement = $(\"li\", $(bizagi.util.trim(self.modalViewTemplates({ 'template': \"fullElement\", 'id': id, 'value': value }))));\r\n\r\n            // Get the latest item on list to append new li with match word\r\n            var lastElement = $('li:last', container);\r\n            if (lastElement.hasClass(\"bz-rn-any-element\")) {\r\n                lastElement.remove();                \r\n                $('ul', container).prepend($newElement);\r\n            } else {                \r\n                $('ul', container).prepend($newElement);\r\n            }\r\n\r\n            self.addTemporalElement($(item).data(\"id\"), $(\"label\", item).text(), false);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Removen a item from the list\r\n     * */\r\n    removeItem: function (element, isModalViewContainer) {\r\n        var self = this;\r\n        var li = element.parent();\r\n        var container = element.closest(\".bz-rn-container-searchlist\");\r\n\r\n        if (container.length === 0) {\r\n            container = element.closest(\".filter-searchlist-modal-view-tags\");\r\n        }\r\n\r\n        if (!isModalViewContainer) {\r\n            // Remove from main memory and set the new value\r\n            self.removeElement({ id: li.data('id') });\r\n        } else {\r\n            delete self.Class.temporalElements[li.data('id')];\r\n        }\r\n\r\n        // Remove list element\r\n        li.remove();\r\n\r\n        if (container.find(\"li\").length <= 1 && !isModalViewContainer) {\r\n            $('.bz-rn-click-to-add-span', container).removeClass(\"hidden\");\r\n            self.configureModalView(\"ul\");\r\n            self.configureModalView(\".bz-rn-last-child\");\r\n        } else if (container.find(\"li\").length === 0 && isModalViewContainer) {\r\n            var defaultElement = $(bizagi.util.trim(self.modalViewTemplates({ 'template': \"modalViewDefaultValue\" })));\r\n            $(\"li\", defaultElement).appendTo($(\"ul\", container));\r\n        }\r\n    },\r\n\r\n    /**\r\n     *   Process the request data for the autocomplete control\r\n     */\r\n    processRequest: function (req) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Create array for response objects\r\n        var suggestions = [];\r\n        var defer = new $.Deferred();\r\n\r\n        if ((req.term.length >= this.Class.SEARCH_MIN_LENGTH)) {\r\n\r\n            // Update term property to reflect the search\r\n            properties.term = req.term;\r\n            this.getData()\r\n                    .done(function (data) {\r\n\r\n                        // Process response to highlight matches\r\n                        $.each(data, function (i, val) {\r\n                            var parseValue;\r\n                            switch (typeof val.value) {\r\n                                case \"number\":\r\n                                    parseValue = val.value;\r\n                                    break;\r\n                                case \"object\":\r\n                                    parseValue = val.value.toString();\r\n                                    break;\r\n                                case \"string\":\r\n                                    parseValue = val.value.replace(new RegExp(\"(?![^&;]+;)(?!<[^<>]*)(\" + req.term + \")(?![^<>]*>)(?![^&;]+;)\", \"gi\"), \"<strong>$1</strong>\");\r\n                                    break;\r\n                                default:\r\n                                    parseValue = val.value;\r\n                                    break;\r\n                            }\r\n\r\n                            if (typeof self.Class.temporalElements[val.id] === 'undefined') {\r\n                                suggestions.push({\r\n                                    id: val.id,\r\n                                    label: parseValue,\r\n                                    value: val.value\r\n                                });\r\n                            }\r\n                        });\r\n\r\n                        defer.resolve(suggestions);\r\n                    });\r\n        } else {\r\n            defer.reject(self.getResource(\"workportal-widget-inboxcommon-no-results-found\"));\r\n        }\r\n\r\n        return defer;\r\n    },\r\n\r\n    /**\r\n     *   Sets the value in the rendered control\r\n     */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        var finalValue = typeof value === \"string\" ? JSON.parse(value).value : value.value;\r\n\r\n        // Set internal value\r\n        self.setValue(finalValue);\r\n\r\n        if (value !== undefined) {\r\n            if (properties.editable) {\r\n                self.input.val(value.label);\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     *   Returns the value to display, ex. non-editable renders\r\n     */\r\n    getDisplayValue: function () {\r\n        return this.selectedValue;\r\n    },\r\n\r\n    /**\r\n     * When the render isn't editable\r\n     */\r\n    renderReadOnly: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        var template = self.renderFactory.getTemplate(\"searchList\");\r\n\r\n        return $.kendoTmpl(template, {\r\n            id: properties.id,\r\n            xpath: properties.xpath,\r\n            value: properties.value,\r\n            editable: false\r\n        });\r\n    },\r\n\r\n    configureReadOnly: function(){\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        // Remove click event\r\n        $('.bz-rn-last-child', control).unbind(\"click\");\r\n        $('.bz-rn-searchlist-search-icon', control).unbind(\"click\");\r\n\r\n        //hide all elements\r\n        $('.bz-rn-click-to-add-span', control).remove();\r\n\r\n        // Remove \"x\" icon from each element on the list\r\n        $('.bz-rn-remove-tag-on-search-list', control).remove();\r\n\r\n        self.input.addClass(\"searchListNonEditable\");\r\n    },\r\n\r\n    /**\r\n     * Add new element to the temporal array\r\n     * */\r\n    addTemporalElement: function (id, value, elementToRemove) {\r\n        var self = this;\r\n\r\n        if (self.Class.temporalElements[id]) {\r\n            delete self.Class.temporalElements[id];\r\n        }\r\n\r\n        self.Class.temporalElements[id] = { 'obj': { 'id': id, 'value': value }, 'remove': elementToRemove };\r\n    }\r\n});","/*\r\n*   Name: BizAgi User Field render tablet Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define the basic behaviour for userfields\r\n*/\r\n\r\n// Auto-extension\r\nbizagi.rendering.basicUserField.extend(\"bizagi.rendering.basicUserField\", {}, {\r\n\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        this._super(params);\r\n\r\n        // Check if the userfield is supported\r\n        if (!this.isSupported()) {\r\n            var form = self.getFormContainer();\r\n            form.addError(self.getResource(\"render-tablet-error-userfield\"));\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    getEditableControl: function () {\r\n        if (!this.isSupported()) {\r\n            return bizagi.rendering.defaultUserField.prototype.getEditableControl.apply(this, arguments);\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    getReadonlyControl: function () {\r\n        if (!this.isSupported()) {\r\n            return bizagi.rendering.defaultUserField.prototype.getReadonlyControl.apply(this, arguments);\r\n        }\r\n    },\r\n\r\n    /*\r\n\t*   Returns if the userfield is supported in this device\r\n\t*/\r\n    isSupported: function () { return true; }\r\n});\r\n\r\n/*\r\n*   Default implementation for user fields\r\n*/\r\nbizagi.rendering.basicUserField.extend(\"bizagi.rendering.defaultUserField\", {}, {\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    getEditableControl: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n        var properties = self.properties;\r\n        var controlName = properties.control.replace(/column/g, \"\");\r\n\r\n        self.input = $(\"<label>Userfield: \" + controlName + \" not found</label>\").appendTo(control);\r\n        self.input.addClass(\"ui-bizagi-render-userfield-notSupported\");\r\n\r\n        return self.input;\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each device to customize each render after processed\r\n    */\r\n    getReadonlyControl: function () {\r\n        return this.getEditableControl();\r\n    },\r\n\r\n    /*\r\n\t*  Dont send the data to the server\r\n\t*/\r\n    collectData: function (renderValues) {\r\n    }\r\n});","/**\r\n *   Name: BizAgi Render Image Class\r\n *   Author: Bizagi Mobile Team\r\n *   Comments:\r\n *   -   This script will redefine the image render class to adjust to tablet devices\r\n */\r\n// Extends itself\r\n//noinspection JSValidateTypes\r\nbizagi.rendering.image.extend(\"bizagi.rendering.image\", {\r\n    QUALITY_PICTURE: 50,\r\n    EXTENSIONSIMG: [\"jpeg\", \"jpg\", \"png\"]\r\n}, {\r\n    /**\r\n     * Just listing the order of function calls (bizagi.rendering.render)\r\n     * 1. renderControl (found it on bizagi.rendering.image)\r\n     * 2. postRender / postRenderReadOnly / postRenderPrintVersion\r\n     * 3. configureHandlers / configureHandlersReadOnly\r\n     *\r\n     * Other functions are just local implementation\r\n     *\r\n     */\r\n\r\n    /**\r\n     * DOM elements to use as an ADD option button\r\n     * @var $actionImage jQuery DOM\r\n     */\r\n    $addImage: null,\r\n    /**\r\n     * DOM elements to use as a REMOVE option button\r\n     * @var $actionImage jQuery DOM\r\n     */\r\n    $deleteImage: null,\r\n    /**\r\n     * DOM input to handle HTML uploads\r\n     * @var $inputFile jQuery DOM\r\n     */\r\n    $inputFile: null,\r\n    /**\r\n     * Whether or not is a native device 'Just a shortcut\r\n     * @var isNative boolean\r\n     */\r\n    isNative: false,\r\n    /**\r\n     * Whether or not we are offline 'Just a shortcut\r\n     * @var isOfflineForm boolean\r\n     */\r\n    isOfflineForm: false,\r\n    /**\r\n     * resolution options to show in menu after selecting an image\r\n     * @var resolutionUpload Array\r\n     */\r\n    resolutionUpload: [],\r\n\r\n    /**\r\n     * This method tries to get the HTML template an render the current object inside\r\n     * @return {jQuery} $.Deferred()\r\n     */\r\n    renderControl: function () {\r\n        var self = this;\r\n\r\n        /**\r\n         * Check if this is an offline form\r\n         * It doesn't validate if the device goes offline so..\r\n         */\r\n        this.isOfflineForm = bizagi.util.isOfflineForm({context: this});\r\n        //noinspection JSValidateTypes,JSUnresolvedVariable\r\n        this.isNative = bizagi.util.isCordovaSupported();\r\n\r\n        if (this.isOfflineForm) {\r\n            var maxFileSizeOfProperty = Number(self.properties.maxSize) || 1048576;\r\n            var maxFileSizeOfUser = typeof (BIZAGI_SETTINGS) !== \"undefined\" && typeof (BIZAGI_SETTINGS.UploadMaxFileSize) !== \"undefined\" ? Number(BIZAGI_SETTINGS.UploadMaxFileSize) : 1048576;\r\n\r\n            self.properties.maxSize = maxFileSizeOfProperty < maxFileSizeOfUser ? maxFileSizeOfProperty : maxFileSizeOfUser;\r\n        }\r\n\r\n        var template = self.renderFactory.getTemplate(\"image\");\r\n\r\n        var allowDelete = self.isOfflineForm ? false : self.properties.allowDelete && self.properties.editable;\r\n        var html = $.kendoTmpl(template, {\r\n            url: \"\",\r\n            allowDelete: allowDelete,\r\n            editable: self.properties.editable\r\n        });\r\n\r\n        return html;\r\n    },\r\n\r\n    /**\r\n     * There is no difference when rendering a readonly image, so ...\r\n     * @return {jQuery} $.Deferred()\r\n     */\r\n    renderReadOnly: function () {\r\n        return this.renderControl();\r\n    },\r\n\r\n    /**\r\n     * After rendering element\r\n     */\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        self.showAsyncImage();\r\n    },\r\n\r\n    /**\r\n     * After rendering a readonly element\r\n     */\r\n    postRenderReadOnly: function () {\r\n        var self = this;\r\n\r\n        // Just a little colors\r\n        self.element.addClass(\"bz-rn-read-only bz-rn-non-editable\");\r\n        self.showAsyncImage();\r\n    },\r\n    /**\r\n     * Add action handlers\r\n     */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n        var version = bizagi.util.getAndroidVersion();\r\n        var modalOptions = null;\r\n\r\n        this.resolutionUpload = [];\r\n        this.$addImage = $(\".bz-rn-image-actions-add\", this.getControl());\r\n        this.$deleteImage = $(\".bz-rn-image-actions-delete\", this.getControl());\r\n        this.$inputFile = $(\".bz-rn-upload-image-web\", this.getControl());\r\n\r\n        this._super();\r\n\r\n        if (this.isNative) {\r\n\r\n            this.$addImage.off(\"click\").click(function () {\r\n\r\n                var modal = self.createModal();\r\n                // Upload Image Options\r\n                modalOptions = modal.find(\"ul.bz-rn-image-options\");\r\n\r\n                // Can't remove from here\r\n                modalOptions.find(\"li[data-role=\\\"dimage\\\"]\").remove();\r\n\r\n                modal.find(\"ul.bz-rn-image-options li\").bind(\"click\", function() {\r\n                    modal.kendoMobileModalView(\"close\");\r\n                    switch ($(this).data(\"role\")) {\r\n                        case \"image\":\r\n                            self.imageAdd();\r\n                            break;\r\n                        case \"cimage\":\r\n                            self.imageAdd(true);\r\n                            break;\r\n                        default:\r\n                    }\r\n                });\r\n                modal.find(\".bz-wp-modalview-close\").unbind(\"click\").bind(\"click\", function() {\r\n                    modal.kendoMobileModalView(\"close\");\r\n                });\r\n\r\n                self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n                modal.kendoMobileModalView(\"open\");\r\n                modal.adjustSize();\r\n\r\n                modal.closest(\".km-modalview-root\").unbind(\"click\").bind(\"click\", function() {\r\n                    modal.kendoMobileModalView(\"close\");\r\n                });\r\n\r\n            });\r\n\r\n        } else {\r\n            if (bizagi.util.media.fileAPISupported() && !self.isOfflineForm) {\r\n                this.$addImage.off(\"click\").click(function () {\r\n                    self.$inputFile.click();\r\n                });\r\n            } else {\r\n                this.element.addClass(\"bz-rn-read-only bz-rn-non-editable\");\r\n                this.$addImage.removeClass(\"bz-plus\").addClass(\"bz-rn-read-only\");\r\n            }\r\n        }\r\n\r\n        // remove Image\r\n        this.$deleteImage.off(\"click\").click(function () {\r\n            self.imageDelete();\r\n        });\r\n        // Image change (Hybrid only)\r\n        this.$inputFile.off(\"change\").on(\"change\", function () {\r\n            self.imageAdd();\r\n            this.value = \"\";\r\n        });\r\n\r\n        // Just in case\r\n        this.$inputFile.off(\"click\").on(\"click\", function (e) {\r\n            e.stopPropagation();\r\n        });\r\n\r\n        this.getControl().find(\"img\").off(\"click\").click(function () {\r\n            self.renderEdition();\r\n        });\r\n\r\n        // Resolution upload menu\r\n        // If android version is less than 4.4 avoid to show upload sizes due to compatibility with blob files\r\n        if (version && version <= 4.4) {\r\n            resolutionUpload = [\r\n                {\"guid\": 4, \"displayName\": bizagi.localization.getResource(\"workportal-size-original\")}\r\n            ];\r\n        } else {\r\n            resolutionUpload = bizagi.util.media.getImageResolutionItems();\r\n        }\r\n\r\n        $(\".bz-resolution-container\", self.getControl()).off(\"click\").actionSheet({\r\n            actions: resolutionUpload,\r\n            actionClicked: function (action) {\r\n                bizagi.loading.start();\r\n                $.when(self.resolutionButtonHandler(action.guid))\r\n                    .always(function () {\r\n                        bizagi.loading.stop();\r\n                    });\r\n            },\r\n            appear: function (action) {\r\n                self.triggerGlobalHandler(\"modalViewDidAppear\", {});\r\n            },\r\n            cancelClicked: function (action) {\r\n                self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n            }\r\n        });\r\n    },\r\n\r\n    clearDisplayValue: function () {\r\n        this.$deleteImage.click();\r\n    },\r\n\r\n    /**\r\n     * Render edition view\r\n     */\r\n    renderEdition: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // TODO Creates a container, be careful you must destroy it later\r\n        var baseParams = self.getParams();\r\n        var container = baseParams.navigation.createRenderContainer({\r\n            title: properties.displayName,\r\n            view: {\r\n                zoom: true,\r\n                useNativeScrolling: false\r\n            }\r\n        });\r\n\r\n        var img = $.kendoTmpls(self.renderFactory.getTemplate(\"image-preview\"), { \"url\": (self.value && self.value[0] !== \"\" ? self.value[0] : \"\") });\r\n        container.element.css(\"display\", \"none\");\r\n        self.inputEdition = container.element.html(img);\r\n        baseParams.navigation.navigate(container.id);\r\n\r\n        if (self.isOfflineForm) {\r\n            container.element.on(\"close\", self.onPreviewActionBack.bind(self));\r\n        }\r\n\r\n        bizagi.loading.start();\r\n\r\n        // TODO review fail scenario, should it call the forms.failHandler method?\r\n        $.when(self.buildFullItemUrl()).done(function (dataUrl) {\r\n            container.element.css(\"display\", \"block\");\r\n\r\n            if (dataUrl.indexOf(\"error\") < 0) {\r\n                $(\".bz-rn-image-render-preview\", container.element).attr(\"src\", dataUrl);\r\n                var originalImage = $(\".bz-rn-image-render-preview\", container.element)[0];\r\n                var originalImageWidth = $(originalImage).css(\"width\");\r\n                originalImageWidth = Number(originalImageWidth.substring(0, originalImageWidth.length - 2));\r\n\r\n                if (self.properties.width !== -1 && self.properties.width < originalImageWidth) {\r\n                    $(\".bz-rn-image-render-preview\", container.element).css(\"width\", \"100%\");\r\n                }\r\n            }\r\n        }).always(function () {\r\n            bizagi.loading.stop();\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Refresh data\r\n     * @param {} event      \r\n     */\r\n    onPreviewActionBack: function (event) {\r\n        var self = this;\r\n        var dataUrl = $(\".bz-rn-image-render-preview\", event.target).attr(\"src\") || \"\";\r\n\r\n        var dataUrlToSave = dataUrl.length > 0 ? [].concat(dataUrl) : null;\r\n        self.setValue(dataUrlToSave);\r\n    },\r\n\r\n    /**\r\n     * Creates the modalview based on template\r\n     * @returns {jQuery} kendoMobileModalView\r\n     */\r\n    createModal: function () {\r\n        var self = this;\r\n\r\n        var imageTemplate = self.renderFactory.getTemplate(\"imageModalView\");\r\n        var modalViewTemplate = kendo.template(imageTemplate, {useWithBlock: false});\r\n\r\n        var modalView = $($.trim(modalViewTemplate({\r\n            editable: self.properties.editable,\r\n            displayName: self.properties.displayName || \"\",\r\n            orientation: self.properties.orientation || \"\"\r\n        })));\r\n\r\n        //noinspection JSUnresolvedFunction\r\n        modalView.kendoMobileModalView({\r\n            close: function (event) {\r\n                event.preventDefault();\r\n\r\n                if (window.event && window.event.stopPropagation)\r\n                    window.event.stopPropagation();\r\n\r\n                self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\r\n\r\n                this.destroy();\r\n                this.element.remove();\r\n            },\r\n            show: function () {\r\n\r\n            },\r\n            modal: false\r\n        });\r\n\r\n        // Adjust modal to window size\r\n        modalView.adjustSize = function () {\r\n            var maxHeight = 0;\r\n            var elements = $(this).parent();\r\n\r\n            var windowHeightSize = window.innerHeight;\r\n            var windowWidthSize = window.innerWidth;\r\n\r\n            var listHeight = $(\".bz-wp-modalview-results-wrapper\", elements).height();\r\n            var maxWidth = $(\".bz-wp-modalview-results-wrapper\", elements).width();\r\n            var popupHeight = $(\"[data-role=header]\", elements).height();\r\n\r\n            if (listHeight + popupHeight >= windowHeightSize) {\r\n                maxHeight = windowHeightSize - 20;\r\n            } else {\r\n                maxHeight = listHeight + popupHeight + 10;\r\n            }\r\n\r\n            var top = ((windowHeightSize - maxHeight) / 2);\r\n            var left = ((windowWidthSize - maxWidth) / 2);\r\n\r\n            elements.css(\"height\", maxHeight);\r\n\r\n            elements.parent().css(\"top\", top);\r\n            elements.parent().css(\"left\", left);\r\n            elements.parent().css(\"height\", maxHeight);\r\n        };\r\n\r\n        return modalView;\r\n    },\r\n\r\n    /**\r\n     * Add an image\r\n     * @param useCamera boolean Whether or not to use device's camera\r\n     */\r\n    imageAdd: function (useCamera) {\r\n        var self = this;\r\n\r\n        if (!this.isNative) {\r\n            var dataFile = this.$inputFile[0].files[0];\r\n            dataFile.fullPath = this.$inputFile[0].value;\r\n            var extensions = this.Class.EXTENSIONSIMG;\r\n\r\n            bizagi.loading.start();\r\n            if (bizagi.util.media.checkMaxSizeFile(dataFile, self.properties) &&\r\n                bizagi.util.media.checkFileTypes(dataFile, self.properties, extensions)) {\r\n\r\n                $.when(self.uploadFile(dataFile)).done(function (result) {\r\n                    self.uploadFileCompleted(self);\r\n                }).fail(function (error) {\r\n                    self.executeFormFailHandler(error);\r\n                }).always(function () {\r\n                    bizagi.loading.stop();\r\n                });\r\n            } else {\r\n                bizagi.loading.stop();\r\n            }\r\n        } else {\r\n\r\n            var options = {\r\n                quality: self.Class.QUALITY_PICTURE,\r\n                targetWidth: 1280,\r\n                targetHeight: 960,\r\n                correctOrientation: true\r\n            };\r\n\r\n            if (!useCamera) {\r\n                var coordinates = self.getControl()[0].getBoundingClientRect();\r\n                //noinspection JSUnresolvedVariable,JSUnresolvedFunction\r\n                options = {\r\n                    quality: self.Class.QUALITY_PICTURE,\r\n                    sourceType: Camera.PictureSourceType.PHOTOLIBRARY,\r\n                    popoverOptions: new CameraPopoverOptions(coordinates.left, coordinates.top - 20, 200, 100, 4),\r\n                    destinationType: navigator.camera.DestinationType.FILE_URI\r\n                };\r\n            }\r\n\r\n            //noinspection JSUnresolvedFunction,JSUnresolvedVariable\r\n            navigator.camera.getPicture(function (dataImage) {\r\n                bizagi.loading.start();\r\n\r\n                $.when(bizagi.util.media.checkMaxSize(dataImage, self.properties)).then(function () {\r\n                    return $.when(bizagi.util.media.getFileDataInfo(dataImage)).then(function (fileData) {\r\n                        if (bizagi.util.media.checkFileTypes(fileData, self.properties, self.Class.EXTENSIONSIMG)) {\r\n                            self.dataImage = dataImage;\r\n                            self.fileProperties = fileData;\r\n                            // \"new Blob\" constructor is not supported in android version 4.2.2\r\n                            var version = bizagi.util.getAndroidVersion();\r\n                            if ((version && version <= 4.2) || self.isOfflineForm) {\r\n\r\n                                return $.when(self.uploadFile(self.dataImage)).done(function (result) {\r\n                                    self.uploadFileCompleted(self);\r\n                                }).fail(function (error) {\r\n                                    self.executeFormFailHandler(error);\r\n                                });\r\n                            } else {\r\n\r\n                                if (!bizagi.util.isAndroid()) {\r\n                                    return $.when(bizagi.util.media.modalResolutionUpload()).then(function (buttonIndex) {\r\n                                        if (buttonIndex <= bizagi.util.media.getImageResolutionItems().length) {\r\n                                            return self.resolutionButtonHandler(buttonIndex);\r\n                                        }\r\n                                    });\r\n\r\n                                } else {\r\n                                    // force click to show actionsheet menu\r\n                                    $(\".bz-resolution-container\", self.getControl()).click();\r\n                                }\r\n                            }\r\n                        }\r\n                    });\r\n                }).always(function () {\r\n                    bizagi.loading.stop();\r\n                });\r\n            }, self.onFail, options);\r\n\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Management fail messages\r\n     * @param {} error\r\n     * @returns {}\r\n     */\r\n    onFail: function (error) {\r\n        bizagi.loading.stop();\r\n    },\r\n\r\n    /**\r\n     * Remove the current image\r\n     */\r\n    imageDelete: function () {\r\n        var self = this;\r\n\r\n        bizagi.showConfirmationBox(bizagi.localization.getResource(\"workportal-actionsheet-upload-remove-photo\"))\r\n            .done(function () {\r\n                bizagi.loading.start();\r\n                $.when(self.dataService.deleteImage({\r\n                    url: self.properties.deleteUrl,\r\n                    idRender: self.properties.id,\r\n                    xpath: self.properties.xpath,\r\n                    xpathContext: self.properties.xpathContext,\r\n                    idPageCache: self.properties.idPageCache,\r\n                    contexttype: self.properties.contexttype\r\n                })).done(function () {\r\n                    self.uploadFileCompleted(self);\r\n                }).fail(function (msg) {\r\n                    var message;\r\n                    var responseText = msg.responseText;\r\n\r\n                    try {\r\n                        message = JSON.parse(responseText);\r\n                        message = message.message || responseText;\r\n                    } catch (e) {\r\n                        message = responseText;\r\n                    }\r\n                    bizagi.showMessageBox(message, \"Error\");\r\n\r\n                }).always(function () {\r\n                    bizagi.loading.stop();\r\n                });\r\n            });\r\n    },\r\n\r\n    /**\r\n     * Send file using HTTP\r\n     * @param dataFile\r\n     * @return {jQuery} $.Deferred()\r\n     */\r\n    uploadFile: function (dataFile) {\r\n\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        if (!this.isOfflineForm) {\r\n            if (this.isNative) {\r\n                //noinspection JSUnresolvedFunction\r\n                var params = {};\r\n                var addParams = self.buildAddParams();\r\n                var fileName = self.fileProperties.name;\r\n\r\n                if (self.editedImageURL) {\r\n                    params.dataFile = self.editedImageURL;\r\n                } else if (self.fileProperties) {\r\n                    params.dataFile = self.fileProperties.url;\r\n                }\r\n\r\n                addParams.queueID = \"q_\" + bizagi.util.encodeXpath(self.getUploadXpath());\r\n                params.data = addParams;\r\n                params.options = new FileUploadOptions();\r\n                params.options.fileKey = \"file\";\r\n                params.options.fileName = fileName;\r\n                params.options.mimeType = \"image/jpeg\";\r\n                params.options.uploadKey = {key: addParams[\"h_xpath\"]};\r\n                params.options.addUrl = self.properties.addUrl;\r\n\r\n                //Cleans variables related previous gallery uploads\r\n                self.editedImageURL = null;\r\n                self.fileProperties = null;\r\n\r\n                // Fix android 4.4 getting images from recent folder\r\n                params.dataFile = bizagi.util.media.getImagePath(params.dataFile);\r\n\r\n                $.when(bizagi.util.media.uploadFile(params)).done(function (result) {\r\n                    var response = JSON.parse(decodeURIComponent(result.response));\r\n\r\n                    if (response.type === \"error\") {\r\n                        defer.reject(response);\r\n                    } else {\r\n                        defer.resolve(response);\r\n                    }\r\n                }).fail(function (error) {\r\n                    defer.reject(error);\r\n                }).always(function () {\r\n                });\r\n\r\n            } else {\r\n                if (bizagi.util.media.checkMaxSizeFile(dataFile, self.properties) &&\r\n                    bizagi.util.media.checkFileTypes(dataFile, self.properties, self.Class.EXTENSIONSIMG)) {\r\n\r\n                    self.dataService.processUploadFile({\r\n                        url: self.properties.addUrl,\r\n                        formData: self.buildAddFileParams(dataFile)\r\n                    }).done(function (response) {\r\n                        defer.resolve(response);\r\n                    }).fail(function (error) {\r\n                        defer.reject(error);\r\n                    });\r\n                } else {\r\n                    defer.reject();\r\n                }\r\n            }\r\n        } else {\r\n            // Load image\r\n            self.saveImageOffline(dataFile, function (dataUrl) {\r\n                var dataUrltoSave = dataUrl.replace(/^data:.*;base64,/, \"\");\r\n\r\n                self.setValue(dataUrltoSave);\r\n                defer.resolve();\r\n            });\r\n\r\n            // Enables canbesent on offline mode\r\n            self.canBeSent = function () {\r\n                $.forceCollectData = true;\r\n                return true;\r\n            };\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * File upload is done\r\n     * @param context\r\n     */\r\n    uploadFileCompleted: function (context) {\r\n        var self = context;\r\n\r\n        try {\r\n            self.showAsyncImage();\r\n            self.editedImageURL = null;\r\n        } catch (error) {\r\n            self.getFormContainer().refreshForm();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Show aync image\r\n     * */\r\n    showAsyncImage: function () {\r\n        var self = this;\r\n        var control = self.getControl();\r\n\r\n        $.when(self.buildItemUrl()).done(function (dataUrl) {\r\n            if (!self.isDisposed()) {\r\n                self.properties.url = (dataUrl !== \"\") ? dataUrl : \"\";\r\n                self.properties.value = self.properties.url.length > 0 ? [].concat(self.properties.url) : null;\r\n                self.setValue(self.properties.value);\r\n\r\n                if (self.isOfflineForm && dataUrl.indexOf(\"Invalid case id\") !== -1) {\r\n                    self.properties.url = \"\";\r\n                }\r\n\r\n                control.find(\".bz-rn-image-container\").off(\"click\")\r\n                    .toggleClass(\"bz-rn-image-actions-add\", self.properties.editable && self.properties.url === \"\");\r\n\r\n                if (self.properties.url !== \"\") {\r\n                    control.find(\".bz-rn-image-container img\").css(\"display\", \"inherit\").attr(\"src\", self.properties.url);\r\n                    control.find(\".bz-rn-image-container img\").off(\"click\").click(function () {\r\n                        self.renderEdition();\r\n                    });\r\n                    control.find(\".bz-rn-image-actions-add\").toggle(self.properties.editable);\r\n                    control.find(\".bz-rn-image-actions-delete\").toggle(self.properties.allowDelete && self.properties\r\n                        .editable);\r\n                } else {\r\n                    control.find(\".bz-rn-image-container img\").css(\"display\", \"none\");\r\n                    control.find(\".bz-rn-image-actions-add.bz-upload\").hide();\r\n                    control.find(\".bz-rn-image-actions-delete\").hide();\r\n                }\r\n\r\n                if (self.properties.required) {\r\n                    self.getControl()\r\n                        .children(\".ui-bizagi-render-control-required, .ui-bizagi-render-control-required-rtl\")\r\n                        .addClass(\"image-required\");\r\n                }\r\n                self.configureHandlers();\r\n            }\r\n        }).fail(function () {\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Create an image offline\r\n     * @param context\r\n     * @param url\r\n     * @param callback\r\n     */\r\n    saveImageOffline: function (path, callback) {\r\n        var self = this;\r\n\r\n        // Fix android 4.4 getting images from recent folder        \r\n        var dataImage = bizagi.util.media.getImagePath(path);\r\n        var xhr = new XMLHttpRequest();\r\n\r\n        try {\r\n\r\n            xhr.onload = function () {\r\n                var reader = new FileReader();\r\n\r\n                reader.onloadend = function () {\r\n                    var content = reader.result;\r\n                    callback(content);\r\n                }\r\n                reader.readAsDataURL(xhr.response);\r\n            };\r\n\r\n            xhr.open(\"GET\", dataImage);\r\n            xhr.responseType = \"blob\";\r\n            xhr.send();\r\n\r\n        } catch (error) {\r\n            callback(\"\");\r\n        }\r\n    },\r\n\r\n    /**\r\n     * resolutionButtonHandler\r\n     * @param buttonOrdinal\r\n     */\r\n    resolutionButtonHandler: function (ordinal) {\r\n        var self = this;\r\n        var actionSelected = ordinal || 0;\r\n\r\n        // If original, save image normally, if not, reduce quality and size\r\n        if (actionSelected === bizagi.util.media.ResolutionType.ORIGINAL) {\r\n            return $.when(self.uploadFile(self.dataImage)).done(function (result) {\r\n                self.uploadFileCompleted(self);\r\n            }).fail(function (error) {\r\n                self.executeFormFailHandler(error);\r\n            });\r\n\r\n        } else {\r\n            var resolution = bizagi.util.media.getImageResolution(actionSelected);\r\n            return $.when(bizagi.util.media.transformImageSize(self.dataImage, resolution))\r\n                .then(function (result) {\r\n\r\n                    self.editedImageURL = result.localUrl;\r\n                    self.properties.url = result.base64Image;\r\n\r\n                    return $.when(self.uploadFile(self.dataImage))\r\n                        .done(function (result) {\r\n                            self.uploadFileCompleted(self);\r\n                        }).fail(function (error) {\r\n                            self.executeFormFailHandler(error);\r\n                        });\r\n\r\n                });\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n     * Call the form failhandler with an specific error\r\n     * @param {} error\r\n     * @returns {}\r\n     */\r\n    executeFormFailHandler: function (error) {\r\n        var self = this;\r\n        var errorResponse = error.responseText ? error.responseText : bizagi.localization.getResource(\"workportal-general-error\");\r\n        self.getFormContainer().failHandler(errorResponse);\r\n    },\r\n\r\n    /**\r\n     * Build add params to send to the server\r\n     * @param {} dataFile\r\n     * @returns {}\r\n     */\r\n    buildAddFileParams: function (dataFile) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n\r\n        // Get form data for POSTing\r\n        var formData = new FormData();\r\n        var form = self.getFormContainer();\r\n\r\n        // Build add params to send to the server\r\n        formData.append(self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\", properties.xpath);\r\n        formData.append(self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\", properties.id);\r\n        formData.append(self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\", properties.xpathContext);\r\n        formData.append(self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE, properties.idPageCache);\r\n        formData.append(self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\", form.properties.sessionId);\r\n        formData.append(self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\", \"savefile\");\r\n        formData.append(properties.xpath, dataFile);\r\n\r\n        if (self.properties.contexttype) {\r\n            formData.append(self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\", properties.contexttype);\r\n        }\r\n\r\n        try {\r\n            if (typeof (BIZAGI_SESSION_NAME) !== \"undefined\") {\r\n                formData.append(BIZAGI_SESSION_NAME, form.properties.sessionId);\r\n            } else {\r\n                formData.append(\"JSESSIONID\", form.properties.sessionId);\r\n            }\r\n        } catch (e) {\r\n            formData.append(\"JSESSIONID\", form.properties.sessionId);\r\n        }\r\n\r\n        return formData;\r\n    }\r\n});\r\n","/**\r\n *   Name: BizAgi Render Image Class\r\n *   Author: Bizagi Mobile Team\r\n *   Comments:\r\n *   -   This script will redefine the image render class to adjust to tablet devices\r\n */\r\n\r\n// Extends itself\r\n//noinspection JSValidateTypes\r\nbizagi.rendering.image.extend(\"bizagi.rendering.image\", {\r\n    QUALITY_PICTURE: 50,\r\n    EXTENSIONSIMG: [\"jpeg\", \"jpg\", \"png\"]\r\n}, {\r\n\r\n    /**\r\n     * Add an image\r\n     * @param useCamera boolean Whether or not to use device's camera\r\n     */\r\n    imageAdd: function (useCamera) {\r\n        var self = this;\r\n        var imageEditorParams = bizagi.override && bizagi.override.mobileImageEditorParams ? bizagi.override.mobileImageEditorParams : {};\r\n        var source = useCamera ? \"camera\" : \"library\";\r\n\r\n        //1. if image editor is not supported, behaves as before\r\n        //2. if image editor is supported, but there are no client-side overrides, image editor will appear\r\n        //3. if image editor is supported, there are client-side overrides and the image editor is enabled, image editor will appear\r\n        //4. if image editor is supported, there are client-side overrides but the image editor is disabled, behaves as before\r\n\r\n        if (!bizagi.util.isNativeImageEditorSupported() || (bizagi.util.isNativeImageEditorSupported() && typeof(imageEditorParams.enableImageEditor) != \"undefined\" && !imageEditorParams.enableImageEditor)) {\r\n            self._super(useCamera);\r\n            return;\r\n        }\r\n\r\n        $.when(self.openImageEditor(source, imageEditorParams)).done(function (dataImage) {\r\n            $.when(bizagi.util.media.checkMaxSize(dataImage, self.properties)).done(function () {\r\n                bizagi.util.media.getFileDataInfo(dataImage).then(function (fileData) {\r\n                    if (bizagi.util.media.checkFileTypes(fileData, self.properties, self.Class.EXTENSIONSIMG)) {\r\n                        self.dataImage = dataImage;\r\n                        self.fileProperties = fileData;\r\n                        $.when(self.uploadFile(self.dataImage)).done(function (result) {\r\n                            self.uploadFileCompleted(self, result);\r\n                        }).fail(function (error) {\r\n                            self.executeFormFailHandler(error);\r\n                        }).always(function () {\r\n                            bizagi.loading.stop()\r\n                        });\r\n                    }\r\n                });\r\n            });\r\n        }).fail(function (error) {\r\n            bizagi.showMessageBox(error);\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Open a native image editor to crop, resize and apply filters\r\n     * @param source string to identify if image is loaded from library or camera\r\n     */\r\n    openImageEditor: function (source, imageEditorParams) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n        imageEditorParams.source = source;\r\n        imageEditorParams.imageMaxSize = self.properties.maxSize;\r\n\r\n        bizagiapp.openImageEditor(imageEditorParams,\r\n            function (response) {\r\n                defer.resolve(JSON.parse(response).imageURL);\r\n            },\r\n            function (error) {\r\n                defer.reject(\"Something went wrong loading the image.\");\r\n            });\r\n\r\n        return defer.promise();\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: BizAgi Smarphone Render Document Generator Extension\r\n *   Author: Dario Estupiñan\r\n *   Comments:\r\n *   -   This script will redefine the document generator render class to adjust to desktop devices\r\n */\r\n\r\n// Extends itself\r\nbizagi.rendering.document.extend(\"bizagi.rendering.document\", {}, {\r\n\t/*\r\n\t *   Template method to implement in each device to customize each render after processed\r\n\t */\r\n\tpostRender: function () {\r\n\t\tvar self = this;\r\n\r\n\t\tself.configureHelpText();\r\n\t\tself.applyDocumentTemplatesFormat();\r\n\t\tself.configureHandlers();\r\n\t},\r\n\r\n\t/*\r\n\t *   Put formating to the documents that are generated by the control\r\n\t */\r\n\tapplyDocumentTemplatesFormat: function () {\r\n\t\tvar self = this;\r\n\t\tvar control = self.getControl();\r\n\r\n\t\t// Set control container to behave as a block\r\n\t\tcontrol.addClass(\"ui-bizagi-render-display-block\");\r\n\r\n\t\t// Resolve the type of the document based on the extension and put the icon to acconding to it\r\n\t\tvar documentList = $(\".ui-bizagi-document-upload-item\", control);\r\n\r\n\r\n\t\t//Configure items\r\n\t\t$.each(documentList, function (index, value) {\r\n\t\t\t$(\".ui-bizagi-document-type\", value).addClass(\"ui-bizagi-document-extension\");\r\n\r\n\t\t\t// Add the tooltip to the document preview icon\r\n\t\t\tvar previewTooltip = $(\".ui-bizagi-document-preview\", value);\r\n\t\t\tpreviewTooltip.attr(\"title\", self.resources.getResource(\"render-document-preview-tooltip\"));\r\n\t\t\tpreviewTooltip.tooltip();\r\n\r\n\t\t\t// Add file extension\r\n\t\t\tvar returnType = self.returnCssTypeFile($(\"a > span\", value).html());\r\n\t\t\t$(\".ui-bizagi-document-type\", value).addClass(returnType);\r\n\r\n\t\t\t// Disable preview\r\n\t\t\t$(\".ui-bizagi-button\", value).remove();\r\n\t\t\t$(\".ui-bizagi-document-preview\", value).attr(\"display\", \"none\");\r\n\r\n\t\t});\r\n\r\n\t\t// Configure preview handler\r\n\t\t$(\".ui-bizagi-document-upload-item > .ui-bizagi-document-upload-element\", control).click(function (e) {\r\n\t\t\tself.showDocumentPreview($(this).data(\"url\"), $(this).attr(\"title\"));\r\n\t\t});\r\n\r\n\r\n\t\t// Configure delete handler\r\n\t\t$(\".bz-rn-document-delete-icon\", control).click(function (e) {\r\n\t\t\tif (e.isPropagationStopped())\r\n\t\t\t\treturn;\r\n\t\t\te.stopPropagation();\r\n\r\n\t\t\tself.deleteDocumentTemplate($(this).parent().data(\"filename\"));\r\n\t\t});\r\n\t},\r\n\r\n\t/**\r\n\t * Identifies the extension of the file in a simpler way that ECM does\r\n\t * @param {} file\r\n\t * @returns {}\r\n\t */\r\n\treturnCssTypeFile: function (file) {\r\n\r\n\t\tif (file == undefined || file.lenght === 0) {\r\n\t\t\treturn \"ui-bizagi-document-upload-item-generic-file bz-file-text\";\r\n\t\t}\r\n\r\n\t\tvar extension = file.substr((file.lastIndexOf(\".\") + 1));\r\n\r\n\t\tswitch (extension) {\r\n\t\t\tcase \"docx\":\r\n\t\t\t\treturn \"ui-bizagi-document-upload-item-doc bz-file-word\";\r\n\t\t\tcase \"pdf\":\r\n\t\t\t\treturn \"ui-bizagi-document-upload-item-pdf bz-file-pdf\";\r\n\t\t\tcase \"xlsx\":\r\n\t\t\t\treturn \"ui-bizagi-document-upload-item-xls bz-file-excel\";\r\n\t\t\tdefault:\r\n\t\t\t\treturn \"ui-bizagi-document-upload-item-generic-file bz-file-text\";\r\n\t\t}\r\n\t},\r\n\r\n\t/*\r\n\t *   Redraw documents when needed\r\n\t */\r\n\tredrawDocuments: function (documents, noFiles, downloadalldocuments) {\r\n\t\tvar self = this;\r\n\r\n\t\tself._super(documents, noFiles, downloadalldocuments);\r\n\r\n\t\t// Add icons\r\n\t\tself.applyDocumentTemplatesFormat();\r\n\t},\r\n\r\n\t/*\r\n\t *   Shows the document if the flag is set.\r\n\t */\r\n\tautoOpenDocuments: function () {\r\n\t},\r\n\r\n\tupdateControlForPrintMode: function () {\r\n\t},\r\n\r\n\tshowDocumentPreview: function (url, title) {\r\n\t    bizagi.loading.start();\r\n\r\n\t\t$.when(bizagi.util.media.downloadFile(url, title)).fail(function (error) {\r\n\t\t\tif (error.responseText){\r\n\t\t\t\tself.getFormContainer().failHandler(error.responseText);\r\n\t\t\t}\r\n\t\t}).always(function(){\r\n\t\t\tbizagi.loading.stop();\r\n\t\t});\r\n\t}\r\n});\r\n","/**\r\n * Desktop definition of range date control\r\n *\r\n * @author: Andr�s Fernando Mu�oz\r\n */\r\n\r\nbizagi.rendering.rangeDate.extend(\"bizagi.rendering.rangeDate\", {}, {\r\n    /**\r\n     * Render actual value of control and set events\r\n     * @param data\r\n     */\r\n    setDisplayValue: function (data) {\r\n        var self = this;\r\n        var control = self.getControl();\r\n    }\r\n});","/**\r\n * Desktop definition of range money control\r\n *\r\n * @author: Andr�s Fernando Mu�oz\r\n */\r\n\r\nbizagi.rendering.rangeMoney.extend(\"bizagi.rendering.rangeMoney\", {}, {\r\n\r\n\t/**\r\n\t * Render a specific implementation for Desktop device\r\n\t */\r\n\tpostRender: function() {\r\n\t\tvar self = this;\r\n\r\n\t\tvar minControl = new bizagi.rendering.money(self.getRenderProperties(\"min\"));\r\n\t\tvar maxControl = new bizagi.rendering.money(self.getRenderProperties(\"max\"));\r\n\r\n\t\tself.setRanageControls(minControl, maxControl);\r\n\t},\r\n\r\n\tgetRenderProperties: function (typeRangeControl){\r\n\t\tvar self = this;\r\n\t\tvar form = self.getFormContainer();\r\n\t\tvar properties = self.properties;\r\n\r\n\t\tvar renderProperties = {\r\n\t\t\tdata: {\r\n\t\t\t\tproperties: {\r\n\t\t\t\t\t\"id\": properties.id,\r\n\t\t\t\t\t\"xpath\": properties.xpath\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tmode: \"execute\",\r\n\t\t\tparent: form,\r\n\t\t\trenderFactory: self.renderFactory,\r\n\t\t\tresources: bizagi.localization,\r\n\t\t\tdataService: self.dataService\r\n\t\t};\r\n\r\n\t\tif (typeRangeControl === \"min\"){\r\n\t\t\trenderProperties.data.properties.displayName = \"From\";\r\n\t\t}else{\r\n\t\t\trenderProperties.data.properties.displayName = \"To\";\r\n\t\t}\r\n\r\n\t\treturn renderProperties;\r\n\t},\r\n\r\n\t/**\r\n\t * Render actual value of control and set events\r\n\t * @param data\r\n\t */\r\n\tsetDisplayValue: function(data) {\r\n\t\tvar self = this;\r\n\t\tvar control = self.getControl();\r\n\t}\r\n});","/**\r\n * Desktop definition of range number control\r\n *\r\n * @author: Andr�s Fernando Mu�oz\r\n */\r\n\r\nbizagi.rendering.rangeNumber.extend(\"bizagi.rendering.rangeNumber\", {}, {\r\n\r\n\t/**\r\n\t * Render a specific implementation for Desktop device\r\n\t */\r\n\tpostRender: function() {\r\n\t\tvar self = this;\r\n\r\n\t\tvar minControl = new bizagi.rendering.number(self.getRenderProperties(\"min\"));\r\n\t\tvar maxControl = new bizagi.rendering.number(self.getRenderProperties(\"max\"));\r\n\r\n\t\tself.setRanageControls(minControl, maxControl);\r\n\t},\r\n\r\n\tgetRenderProperties: function (typeRangeControl){\r\n\t\tvar self = this;\r\n\t\tvar form = self.getFormContainer();\r\n\t\tvar properties = self.properties;\r\n\r\n\t\tvar renderProperties = {\r\n\t\t\tdata: {\r\n\t\t\t\tproperties: {\r\n\t\t\t\t\t\"id\": properties.id,\r\n\t\t\t\t\t\"xpath\": properties.xpath\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tmode: \"execute\",\r\n\t\t\tparent: form,\r\n\t\t\trenderFactory: self.renderFactory,\r\n\t\t\tresources: bizagi.localization,\r\n\t\t\tdataService: self.dataService\r\n\t\t};\r\n\r\n\t\tif (typeRangeControl === \"min\"){\r\n\t\t\trenderProperties.data.properties.displayName = \"From\";\r\n\t\t}else{\r\n\t\t\trenderProperties.data.properties.displayName = \"To\";\r\n\t\t}\r\n\r\n\t\treturn renderProperties;\r\n\t},\r\n\r\n\t/**\r\n\t * Render actual value of control and set events\r\n\t * @param data\r\n\t */\r\n\tsetDisplayValue: function(data) {\r\n\t\tvar self = this;\r\n\t\tvar control = self.getControl();\r\n\t}\r\n});","/*\r\n*   Name: Bizagi Render Geolocation control\r\n*   Author: Ricardo Perez\r\n*   Comments:\r\n*   -   This script will define basic stuff for form link renders\r\n*/\r\n\r\nbizagi.rendering.geolocation.extend(\"bizagi.rendering.geolocation\", {}, {\r\n\r\n    /* \r\n    * Template method to implement in each device to customize each render after processed \r\n    */\r\n    postRender: function () {\r\n        var self = this;\r\n\r\n        // Call base \r\n        self._super();\r\n\r\n        var control = self.getControl();\r\n\r\n        self.cordinate = $(\".bz-rn-geolocation-coordinate\", control);\r\n    },\r\n    /* \r\n    * Public method to determine if a value is valid or not \r\n    */\r\n    isValid: function (invalidElements) {\r\n        var self = this;\r\n\r\n        // Call base\r\n        var bValid = self._super(invalidElements);\r\n\r\n        return bValid;\r\n    },\r\n\r\n    /* \r\n    * Template method to implement in each device to customize the render's behaviour to add handlers \r\n    */\r\n    configureHandlers: function () {\r\n        var self = this;\r\n\r\n        if (self.getMode() === \"execution\") {\r\n\r\n            //If the control doesn't have a value set the position\r\n            if (self.value == null)\r\n                self.updateDisplayValue();\r\n\r\n            $(\".bz-rn-geolocation-selector\", self.getControl()).on(\"click\", function () {\r\n                self.cordinate.empty();\r\n\r\n                //this retun a promise if is usefull\r\n                self.updateDisplayValue();\r\n            });\r\n        }\r\n    },\r\n\r\n    /* \r\n    * Sets the value in the rendered control \r\n    */\r\n    setDisplayValue: function (value) {\r\n        var self = this;\r\n        var def = new $.Deferred();\r\n\r\n        if (value != null && value !== \"\") {\r\n            if (!self.cordinate)\r\n                self.cordinate = self.getControl();\r\n\r\n            self.cordinate.html(value);\r\n\r\n            // Set internal value \r\n            self.setValue(value, false);\r\n            def.resolve();\r\n        } else {\r\n            var onSuccess = function (position) {\r\n                var latitude = position.coords.latitude.toString();\r\n                var longitude = position.coords.longitude.toString();\r\n                var cordinate = latitude + \" \" + longitude;\r\n\r\n                self.cordinate.html(cordinate);\r\n\r\n                // Set internal value \r\n                self.setValue(cordinate, false);\r\n                def.resolve();\r\n            };\r\n\r\n            // onError Callback receives a PositionError object\r\n            var onError = function (message) {\r\n                var strMessage = message;\r\n\r\n                if (bizagi.util.isCordovaSupported() && bizagi.util.isiOSDevice()) {\r\n                    strMessage = self.getErrorMessage(message)\r\n                }\r\n\r\n                def.reject(strMessage);\r\n            };\r\n\r\n            if (bizagi.util.isCordovaSupported() && bizagi.util.isiOSDevice()) {\r\n                navigator.geolocation.getCurrentPosition(onSuccess, onError);\r\n            } else {\r\n                self.getCurrentPosition(onSuccess, onError);\r\n            }\r\n        }\r\n\r\n        return def.promise();\r\n    },\r\n\r\n    updateDisplayValue: function () {\r\n        var self = this;\r\n\r\n        self.setDisplayValue().then(function () { }).fail(function (message) {\r\n            self.cordinate.val(\"\");\r\n            self.cordinate.html(\"<span style='color: red'>\" + message + \"</span>\");\r\n        });\r\n    }\r\n\r\n});","/*\r\n*   Name: BizAgi Tablet Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.column\", {}, {\r\n\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n\r\n        if (!decorated) return;        \r\n\r\n        // Hacks the getControl method in the decorated render to add features\r\n        if (decorated && decorated.getControl) {\r\n            this.originalGetControl = decorated.getControl;\r\n            decorated.getControl = this.getControl;\r\n        }\r\n\r\n        /* Customizes the font weight */\r\n        decorated.getFormattingLabel = function (bold) {\r\n            var self = this;\r\n            return self.getControl();\r\n        };\r\n    },\r\n\r\n    /*\r\n    *   Template method to get the control element\r\n    *   This code runs under the decorated element context\r\n    */\r\n    getControl: function () {\r\n        var self = this;\r\n        var result = this._super();\r\n\r\n        if (!result || result.length == 0) {\r\n            result = $(\".ui-bizagi-cell-readonly\", self.element || self.observableElement);\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n\r\n    /**\r\n     * Overrides the normal flow in order to set the grid to decorator always\r\n     * @param surrogateKey\r\n     * @returns {*}\r\n     */\r\n    getDecorated: function (surrogateKey) {\r\n        var decorated = this._super(surrogateKey);\r\n        if (typeof decorated.grid === \"undefined\") {\r\n            decorated.grid = this.grid;\r\n        }\r\n\r\n        return decorated;\r\n    },\r\n\r\n    /*\r\n    *   Returns the in-memory processed element \r\n    *   so the caller could append it to any place\r\n    */\r\n    render: function (surrogateKey, value, tableCell) {\r\n        var result = this._super(surrogateKey, value, tableCell);\r\n        var decorated = this.getDecorated(surrogateKey);\r\n        if (decorated.element) {\r\n            // Clean all display types\r\n            decorated.element.removeClass(\"ui-bizagi-render-display-normal ui-bizagi-render-display-vertical ui-bizagi-render-display-reversed\")\r\n                          .removeClass(\"ui-bizagi-render-display-vertical-reversed ui-bizagi-render-display-label ui-bizagi-render-display-value\");\r\n\r\n            // Add a new common class for all cells\r\n            decorated.element.addClass(\"ui-bizagi-render-display-cell\");\r\n        }\r\n\r\n        return result;\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function (surrogateKey, cell) {\r\n\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        var editable = self.properties.editable;\r\n        decorated.properties.editable = false;\r\n\r\n        if (decorated.grid == undefined) {\r\n            decorated.grid = self.grid;\r\n        }\r\n        \r\n        if (self.properties.singleInstance) {\r\n            decorated.element = cell;\r\n        }\r\n        \r\n        decorated.postRenderElement(cell);\r\n        decorated.properties.editable = editable;        \r\n    },\r\n\r\n    /*\r\n    *   Apply column styles to a specified element\r\n    */\r\n    applyColumnStyles: function (element) {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        \r\n        element = $(element);\r\n        \r\n        // Set cell alignment\r\n        element.css(\"-webkit-box-pack\", properties.align);\r\n\r\n        // Set cell back color\r\n        if (properties.textFormat.background) {\r\n            element.css(\"background-color\", properties.textFormat.background);\r\n            element.css(\"background-image\", \"none\");\r\n        }\r\n    }\r\n});","/*\r\n*   Name: BizAgi Tablet Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.columns.combo.extend(\"bizagi.rendering.columns.combo\", {}, {\r\n    /*\r\n    *   Sets the internal value\r\n    */\r\n    setValue: function (surrogateKey, value) {\r\n        var self = this;\r\n        var decorated = self.getDecorated(surrogateKey);\r\n        // Check is offline form\t    \r\n        var isOfflineForm = bizagi.util.isOfflineForm({ context: self });\r\n\r\n        if (decorated === null) {\r\n            return;\r\n        }\r\n\r\n        // Perform default set value when rendering summary row\r\n        if (surrogateKey == \"summary\") return self._super(surrogateKey, value);\r\n\r\n        if(isOfflineForm && (typeof (value) == \"number\" || typeof (value) == \"string\")){\r\n            var newValue =  typeof (self.properties.data) == \"object\" ? self.properties.data.find(function(item){ return item.id == value }) : value;\r\n\r\n            self._super(surrogateKey, newValue);\r\n            decorated.selectedValue = value;\r\n        } else if (value && value.length > 0) {\r\n\r\n            // Create the value property\r\n            var newValue = {\r\n                id: value[0][0],\r\n                value: value[0].length > 2 ? $.grep(value[0], function (item, i) { return i != 0; }) : value[0][1]\r\n            };\r\n            // Call base\r\n            self._super(surrogateKey, newValue);\r\n            decorated.selectedValue = newValue.value;\r\n        } else if (value && value.id && value.value) {\r\n            self._super(surrogateKey, value);\r\n            decorated.selectedValue = value.value;\r\n        } else if (self.properties.type == \"columnRadio\") {\r\n            self._super(surrogateKey, null);\r\n            decorated.selectedValue = value;\r\n        } else if (value && typeof (value) == \"number\") {\r\n            self._super(surrogateKey, value);\r\n        } else if (isOfflineForm && (value !== null && typeof (value) === \"object\" && value.value)) {\r\n            self._super(surrogateKey, value.value);\r\n            decorated.selectedValue = value.value;\r\n        } else {\r\n            // Set null values when the entry array is null\r\n            self._super(surrogateKey, null);\r\n            decorated.selectedValue = \"\";\r\n        }\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Desktop Render Document Generator Extension\r\n*   Author: Mauricio Gonzalez\r\n*   Comments:\r\n*   -   This script will redefine the document generator render class to adjust to desktop devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.document\", {}, {\r\n\r\n\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n        self._super(decorated);\r\n\r\n        decorated.getControlHtml = self.getControlHtml;\r\n\r\n        if (mode != \"design\") {\r\n            self.surrogateKey = decorated.surrogateKey;\r\n            decorated.getXpath = this.getXpath;\r\n            decorated.getDocumentXpath = this.getDocumentXpath;\r\n            decorated.getContextXpath = this.getContextXpath;\r\n            decorated.documentTemplateGenerate = this.documentTemplateGenerate;\r\n            decorated.preRenderControl = this.preRenderControl;\r\n            decorated.properties.xpathContext = self.getContextXpath();\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   Creates the event of generation of templates.\r\n    */\r\n    documentTemplateGenerate: function () {\r\n        var self = this;\r\n        var properties = self.properties;\r\n        self.startLoading();\r\n        //Get the context xPath\r\n        properties.xpathcontext = self.getContextXpath();\r\n        properties.xpath = self.getDocumentXpath(properties.xpath);\r\n\r\n        var grid = self.parent;\r\n\r\n        $.when(grid.submitOnChange(\"\", false))\r\n            .done(function () {\r\n                $.when(self.dataService.generateDocumentTemplate(properties))\r\n                    .done(function (response) {\r\n                        $.when(grid.refresh())\r\n                            .done(function () {\r\n                                self.autoOpenDocuments();\r\n                            });\r\n\r\n                        self.endLoading();\r\n                    }).fail(function (error) {\r\n                        self.endLoading();\r\n\r\n                        // Add error messages       \r\n                        self.showErrorMessage(error);\r\n                        \r\n                    });\r\n            }).fail(function (error) {\r\n                self.endLoading();\r\n\r\n                // Add error messages                 \r\n                self.showErrorMessage(error);                \r\n            });\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    getControlHtml: function (template, mode, downloadalldocuments, allowGenerate, properties, noFiles) {\r\n        var self = this;\r\n        var isInlineRow = true;\r\n\r\n        for (var i = 0, length = self.parent.properties.data.rows.length; i < length; i++) {\r\n            if (self.parent.properties.data.rows[i][0] == self.surrogateKey) {\r\n                isInlineRow = false;\r\n                break;\r\n            }\r\n        }\r\n\r\n        var html = $.kendoTmpl(template, {\r\n            noActivateButton: isInlineRow,\r\n            editable: mode != \"execution\",\r\n            downloadalldocuments: downloadalldocuments,\r\n            required: properties.required,\r\n            allowgenerate: allowGenerate,\r\n            xpath: self.getXpath(properties.xpath),\r\n            append: properties.append ? properties.append : false,\r\n            caption: properties.caption,\r\n            noFiles: noFiles\r\n        });\r\n\r\n        return html.replace(\"ui-bizagi-document-upload-item-design\", \"ui-bizagi-document-upload-item-design-column\");\r\n    },\r\n\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    getXpath: function (xpath) {\r\n        var xpathPath = xpath;\r\n        var index = xpathPath.indexOf(this.grid.properties.xpath);\r\n\r\n        if (index != -1) {\r\n            xpathPath = xpathPath.substr(index + this.grid.properties.xpath.length + 1);\r\n        }\r\n\r\n        return this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"].\" + xpathPath;\r\n    },\r\n\r\n    /*\r\n    *   Returns the xpath to be used  \r\n    */\r\n    getDocumentXpath: function (xpath) {\r\n        var xpathPath = xpath;\r\n        var index = xpathPath.indexOf(this.grid.properties.xpath);\r\n\r\n        if (index != -1) {\r\n            xpathPath = xpathPath.substr(index + this.grid.properties.xpath.length + 1);\r\n        }\r\n\r\n        return xpathPath;\r\n    },\r\n\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRenderReadOnly: function (surrogateKey, cell, tableCell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell, tableCell);\r\n    },\r\n\r\n    /*\r\n    *   Returns the xpath to be used  \r\n    */\r\n    getContextXpath: function () {\r\n        return this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"]\";\r\n    },\r\n\r\n    /*\r\n    *   Template method to implement in each children to customize each control\r\n    */\r\n    preRenderControl: function () {\r\n        var self = this;\r\n        self.properties.value = self.value;\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Desktop Date Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the date column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.date\", {}, {\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n        this._super(decorated);\r\n    }   \r\n});","/*\r\n*   Name: BizAgi Tablet Text Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the text column decorator class to adjust to tablet devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.text\", {}, {\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Tablet Number Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the number column decorator class to adjust to tablet devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.number\", {}, {\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n    postRender: function (surrogateKey, cell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        // Apply styles to input\r\n        var input = $(\"input\", cell);\r\n        this.applyColumnStyles(input);\r\n    },\r\n    renderSummary: function (key, value) {\r\n        var self = this;\r\n        return self.renderReadOnly(key, value);\r\n    },\r\n    \r\n    postRenderSummary: function (key, value) {\r\n        var self = this;\r\n        self.postRenderReadOnly(key, value);\r\n        return true;\r\n    }\r\n});\r\n","\r\n/*\r\n *   Name: Bizagi Column Rendering Tablet numberScientificNotation\r\n *   Author: Luis Cabarique - LuisCE\r\n *   Comments:\r\n *   -   This script will define a base class to define the Column Scientific number notation\r\n */\r\n\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.numberScientificNotation\", {}, {\r\n    /*\r\n     *   Post process the element after it has been rendered\r\n     */\r\n    postRender: function (surrogateKey, cell) {\r\n        // Call base\r\n        this._super(surrogateKey, cell);\r\n\r\n        // Apply styles to input\r\n        var input = $(\"input\", cell);\r\n        this.applyColumnStyles(input);\r\n    },\r\n    renderSummary: function (key, value) {\r\n        var self = this;\r\n        return self.renderReadOnly(key, value);\r\n    },\r\n    postRenderSummary: function (key, value) {\r\n        var self = this;\r\n        self.postRenderReadOnly(key, value);\r\n        return true;\r\n    }\r\n});","/*\r\n*   Name: BizAgi Tablet Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.image\", {}, {\r\n\r\n    applyOverrides: function(decorated) {\r\n        var properties = this.properties;\r\n        this._super(decorated);\r\n\r\n        decorated.getXpathContext = this.getImageXpathContext;\r\n\r\n        decorated.setDisplayValue = function () {\r\n            return true;\r\n        };\r\n\r\n        // Change xpath context\r\n        // Taken from desktop version to fix non existence of \"xpathContext\" property\r\n        if ( this.getMode() === \"execution\") {\r\n            decorated.properties.xpathContext = ( properties.xpathContext ? properties.xpathContext + \".\" : \"\" ) + this.grid.properties.xpath + \"[id=\" + decorated.surrogateKey + \"]\";\r\n        }\r\n    },\r\n\r\n    getImageXpathContext: function () {\r\n        return ( this.column.properties.xpathContext ? this.column.properties.xpathContext + \".\" : \"\" ) + this.column.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"]\";\r\n    }\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Tablet Text Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the text column decorator class to adjust to tablet devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.upload\", {}, {\r\n     applyOverrides: function (decorated) {\r\n        this._super(decorated);\r\n    \r\n        decorated.getUploadXpath = this.getUploadXpath;\r\n        // hack apply upload plugin method in order to execute it only when the control is inserted in the DOM\r\n         var originalMethod = decorated.applyUploadPlugin;\r\n\r\n            decorated.getXpathContext = function () {\r\n                var surrogateKey = this.surrogateKey || \"\";\r\n                var self = this;\r\n                var properties = self.properties;\r\n                return properties.xpathContext.length > 0 ? properties.xpathContext + \".\" + self.grid.properties.xpath + \"[id=\" + self.surrogateKey + \"]\" : self.grid.properties.xpath + \"[id=\" + self.surrogateKey + \"]\";\r\n            };\r\n\r\n            decorated.buildItemUrl = function (file) {\r\n                var self = this;\r\n                var properties = self.properties;\r\n\r\n                var form = self.getFormContainer();\r\n                var xpathContext = self.getXpathContext();\r\n                var contextXpath = \"\";\r\n\r\n                return self.dataService.getUploadFileUrl({\r\n                    idRender: properties.id,\r\n                    xpath: properties.xpath,\r\n                    xpathContext: xpathContext,\r\n                    idPageCache: properties.idPageCache,\r\n                    fileId: file.id,\r\n                    sessionId: form.properties.sessionId,\r\n                    contexttype: properties.contexttype\r\n                });\r\n            };\r\n   },\r\n\r\n   getUploadXpath: function () {\r\n        return this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"].\" + this.properties.xpath;\r\n    }\r\n    \r\n});\r\n","/*\r\n *   Name: Bizagi Tablet Link Column Decorator Extension\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will redefine the link column decorator class to adjust to tablet devices\r\n */\r\n\r\n// Extends from column\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.link\", {}, {\r\n    applyOverrides: function(decorated) {\r\n        var self = this;\r\n        var mode = self.getMode();\r\n\r\n        self._super(decorated);\r\n\r\n        if (mode !== \"design\" && mode !== \"layout\") {\r\n            self.surrogateKey = decorated.surrogateKey;\r\n            decorated.getXpath = self.getXpath;\r\n\r\n            decorated.properties.xpathContext = self.grid.properties.xpath + \"[id=\" + self.surrogateKey + \"]\";\r\n\r\n            if (self.grid.properties.xpathContext && decorated.properties.xpathContext.indexOf(self.grid.properties.xpathContext) == -1)\r\n                decorated.properties.xpathContext = self.grid.properties.xpathContext + \".\" + decorated.properties.xpathContext;\r\n        }\r\n\r\n        if (decorated.properties.type == \"columnFormLink\") {\r\n            decorated.getFormLinkXpath = this.getFormLinkXpath;\r\n        }\r\n    },\r\n\r\n    /*\r\n     *   Apply custom overrides to each decorated instance\r\n     */\r\n    getXpath: function(xpath) {\r\n        var self = this;\r\n        var xpathPath = xpath;\r\n        var index = xpathPath.indexOf(self.grid.properties.xpath);\r\n\r\n        if (index !== -1) {\r\n            xpathPath = xpathPath.substr(index + self.grid.properties.xpath.length + 1);\r\n        }\r\n\r\n        return self.grid.properties.xpath + \"[id=\" + self.surrogateKey + \"].\" + xpathPath;\r\n    },\r\n\r\n    /*\r\n     *   Get Form Link xpath to use\r\n     */\r\n    getFormLinkXpath: function () {\r\n        // Calculate layout properties to maximized property\r\n        this.properties.maximized = bizagi.util.parseBoolean(this.properties.maximized) != null ? bizagi.util.parseBoolean(this.properties.maximized) : false;\r\n        this.calculateInitialLayoutProperties();\r\n\r\n        if (!this.properties.xpath){\r\n            return;\r\n        }\r\n        return this.properties.xpath;\r\n    }\r\n});\r\n","/*\r\n*   Name: BizAgi Desktop Text Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the text column decorator class to adjust to desktop devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.uploadecm\", {}, {\r\n    /*\r\n    *   Apply custom overrides to each decorated instance\r\n    */\r\n    applyOverrides: function (decorated) {\r\n        var self = this;\r\n        self._super(decorated);\r\n\r\n        if (decorated && decorated.getControl) {\r\n            self.originalGetControl = decorated.getControl;\r\n            decorated.getControl = self.getControl;\r\n        }\r\n        \r\n        decorated.getUploadXpath = this.getUploadXpath;\r\n\r\n        decorated.buildItemUrl = function (file) {\r\n            var self = this;\r\n            var properties = self.properties;\r\n\r\n            var form = self.getFormContainer();\r\n\r\n            var columnXpath = self.getUploadXpath(self.surrogateKey);\r\n            columnXpath = columnXpath.split(\".\");\r\n            var nameFile = columnXpath[columnXpath.length - 1];\r\n            var xpathContext = self.getXpathContext(self.surrogateKey);\r\n\r\n            return self.dataService.getUploadFileUrl({\r\n                idRender: properties.id,\r\n                xpath: nameFile,\r\n                xpathContext: xpathContext,\r\n                idPageCache: properties.idPageCache,\r\n                fileId: file.idFileUpload,\r\n                sessionId: form.properties.sessionId,\r\n                contexttype: properties.contexttype\r\n            });\r\n        };\r\n\r\n        decorated.getXpathContext = function () {\r\n            var self = this;\r\n            var properties = self.properties;\r\n            return properties.xpathContext.length > 0 ? properties.xpathContext + \".\" + self.grid.properties.xpath + \"[id=\" + self.surrogateKey + \"]\" : self.grid.properties.xpath + \"[id=\" + self.surrogateKey + \"]\";\r\n        };\r\n    },\r\n    /*\r\n    *   Returns the in-memory processed element when the element is read-only\r\n    */\r\n    renderReadOnly: function (surrogateKey, value) {\r\n        var self = this;\r\n        var cell = \"<div></div>\";\r\n\r\n        var decorated = this.getDecorated(surrogateKey);\r\n        decorated.setValue(value);\r\n        self.setValue(surrogateKey, value);\r\n        self.setSurrogateKey(surrogateKey);\r\n\r\n        self.applyOverrides(decorated);\r\n        // Set grid and id references to the control in order to render the content\r\n        decorated.grid = this.grid;\r\n        decorated.column = this;\r\n        decorated.surrogateKey = surrogateKey;\r\n\r\n        // Set ready deferred\r\n        self.readyDeferred = new $.Deferred();\r\n\r\n        // We need to render the inner control as read-only\r\n        if (decorated.files.length > 0) {\r\n            // Changes editable to false to render read-only\r\n            var editable = this.properties.editable;\r\n            decorated.properties.editable = false;\r\n            cell = decorated.render(\"cell.upload\");\r\n        }\r\n        return cell;\r\n    },\r\n    /*\r\n    *   Post process the element after it has been rendered\r\n    */\r\n\r\n    getUploadXpath: function (surrogateKey) {\r\n        surrogateKey = this.surrogateKey || surrogateKey || \"\";\r\n        return this.grid.properties.xpath + \"[id=\" + surrogateKey + \"].\" + this.properties.xpath;\r\n    },\r\n\r\n    getControl: function () {\r\n        var self = this;\r\n        var result = self._super();\r\n\r\n        if (!result || result.length == 0) {\r\n            return $(\".ui-bizagi-cell-readonly\", self.element || self.observableElement);\r\n        } else {\r\n            return $(\".ui-bizagi-render-control\", self.element || self.observableElement);\r\n        }\r\n\r\n    }\r\n\r\n});\r\n","/**\r\n* Grid control Column Button\r\n*\r\n* @author Ricardo Pérez\r\n*/\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.button\", {}, {\r\n\r\n});","/*\r\n*   Name: BizAgi Tablet Radio Column Decorator Extension\r\n*   Author: Richar Urbano\r\n*   Comments:\r\n*   -   This script will redefine the text column decorator class to adjust to tablet devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.columns.combo.extend(\"bizagi.rendering.columns.radio\", {}, {\r\n});\r\n","/*\r\n*   Name: BizAgi Tablet Column Decorator Extension\r\n*   Author: RicharU\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.columns.combo.extend(\"bizagi.rendering.columns.list\", {}, {\r\n\r\n});\r\n","/*\r\n*   Name: BizAgi Tablet Column Decorator Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to tablet devices\r\n*/\r\n\r\n// Extends itself\r\nbizagi.rendering.columns.search.extend(\"bizagi.rendering.columns.search\", {}, {\r\n    \r\n        applyOverrides: function (decorated) {\r\n            this._super(decorated);\r\n        },\r\n    \r\n        renderReadOnly: function (surrogateKey, value) {\r\n            var self = this;\r\n            if (value.length > 0) {\r\n                value = [].concat(value[0]);\r\n                return self._super(surrogateKey, {\r\n                    id: value[0],\r\n                    label: value[1],\r\n                    additionallabel: value[2] || undefined\r\n                });\r\n            } \r\n            else {\r\n                return self._super(surrogateKey, value);\r\n            }\r\n        }\r\n    });","/*\r\n*   Name: BizAgi tablet Date Column Decorator Extension\r\n*   Author: RicharU\r\n*   Comments:\r\n*   -   This script will redefine the check column to adjust to tablet devices\r\n*/\r\n\r\n// Extends from column\r\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.columns.exclusiveCheck\", {}, {\r\n});","/*\r\n *   Name: Bizagi Base Render Factory\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define an abstract render factory in order to do common stuff for all device factories\r\n */\r\n\r\n$.Class.extend(\"bizagi.rendering.base.factory\", {}, {\r\n    /* \r\n    *   Constructor\r\n    */\r\n    init: function (dataService) {\r\n        this.templates = {};\r\n        this.dataService = dataService;        \r\n    },\r\n\r\n    /**\r\n    * Load client resources in order to override a default behavior\r\n    */\r\n    loadOverrides: function () {\r\n    },\r\n    /*\r\n    *   This function will load asynchronous stuff needed in the module\r\n    */\r\n    initAsyncStuff: function() {\r\n        return $.when.apply($, [this.loadOverrides(), this.loadTemplates()]);\r\n    },\r\n    /*\r\n    *   Load all the templates used for rendering\r\n    */\r\n    loadTemplates: function () {\r\n    },\r\n    /*\r\n    *   Load one template and save it internally\r\n    */\r\n    loadTemplate: function(template, templateDestination) {\r\n        var self = this;\r\n\r\n        // Go fetch the template\r\n        return bizagi.templateService.getTemplate(templateDestination, template)\r\n                .done(function (resolvedTemplate) {\r\n                self.templates[template] = resolvedTemplate;\r\n            });\r\n    },\r\n    /*\r\n    * Returns a common  used template for the framework\r\n    */\r\n    getCommonTemplate: function (template) {        \r\n        return this.templates[template];\r\n    },\r\n    /*\r\n    *   Returns the appropiate container based on the container type\r\n    */\r\n    getContainer: function (params) {\r\n        // TODO: REMOVE IMPLEMENTATION\r\n\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var containerParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (type == \"form\") {\r\n            return new bizagi.rendering.form(containerParams);\r\n        }\r\n\r\n        if (type == \"mobileform\") {\r\n            return new bizagi.rendering.mobileform(containerParams);\r\n        }\r\n\r\n        if (type == \"template\") {\r\n            return new bizagi.rendering.formTemplate(containerParams);\r\n        }\r\n\r\n        if (type == \"queryForm\") {\r\n            return new bizagi.rendering.queryForm(containerParams);\r\n        }\r\n\r\n        if (type == \"layout\") {\r\n            return new bizagi.rendering.layout(containerParams);\r\n        }\r\n\r\n        if (type == \"usersForm\") {\r\n            return new bizagi.rendering.usersForm(containerParams);\r\n        }\r\n\r\n        if (type == \"panel\") {\r\n            return new bizagi.rendering.panel(containerParams);\r\n        }\r\n\r\n        if (type == \"contentPanel\" || type == \"contentpanel\") {\r\n            return new bizagi.rendering.contentPanel(containerParams);\r\n        }\r\n\r\n        if (type.toLowerCase() == \"nestedform\") {\r\n            return new bizagi.rendering.nestedForm(containerParams);\r\n        }\r\n\r\n        if (type == \"tab\") {\r\n            return new bizagi.rendering.tab(containerParams);\r\n        }\r\n\r\n        if (type == \"tabItem\" || type == \"tabitem\") {\r\n            return new bizagi.rendering.tabItem(containerParams);\r\n        }\r\n\r\n        if (type == \"horizontal\") {\r\n            return new bizagi.rendering.horizontal(containerParams);\r\n        }\r\n\r\n        if (type == \"accordion\") {\r\n            return new bizagi.rendering.accordion(containerParams);\r\n        }\r\n\r\n        if (type == \"accordionItem\") {\r\n            return new bizagi.rendering.accordionItem(containerParams);\r\n        }\r\n\r\n        if (type == \"group\") {\r\n            return new bizagi.rendering.group(containerParams);\r\n        }\r\n\r\n        if (type == \"mobilegroup\") {\r\n            return new bizagi.rendering.mobilegroup(containerParams);\r\n        }\r\n\r\n        if (type == \"searchForm\") {\r\n            containerParams.context = \"search\";\r\n            containerParams.contexttype = \"metadata\";\r\n            return new bizagi.rendering.searchForm(containerParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n    /*\r\n    *   Returns the appropiate render based on the render type\r\n    */\r\n    getRender: function (params) {\r\n\r\n        // TODO: REMOVE IMPLEMENTATION\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var renderParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (!type)\r\n            type = \"label\";\r\n\r\n        if (type == \"text\") {\r\n            var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\r\n\r\n            if (isExtended) {\r\n                // Creates one extended render\r\n                return new bizagi.rendering.extendedText(renderParams);\r\n            }\r\n\r\n            // Creates one normal text render\r\n            return new bizagi.rendering.text(renderParams);\r\n        }\r\n        if (type == \"mobiletext\") {\r\n            return new bizagi.rendering.mobiletext(renderParams);\r\n        }\r\n\r\n        if (type == \"association\") {\r\n            return new bizagi.rendering.association(renderParams);\r\n        }\r\n\r\n        if (type == \"label\") {\r\n            return new bizagi.rendering.label(renderParams);\r\n        }\r\n\r\n        if (type == \"hidden\") {\r\n            return new bizagi.rendering.hidden(renderParams);\r\n        }\r\n\r\n        if (type == \"number\") {\r\n            return new bizagi.rendering.number(renderParams);\r\n        }\r\n\r\n        if (type == \"money\") {\r\n            return new bizagi.rendering.money(renderParams);\r\n        }\r\n\r\n        if (type == \"date\") {\r\n            return new bizagi.rendering.date(renderParams);\r\n        }\r\n\r\n        if (type == \"boolean\") {\r\n            var display = data.properties.display || \"option\";\r\n\r\n            if (display == \"check\") {\r\n                // Creates one check render\r\n                return new bizagi.rendering.check(renderParams);\r\n            }\r\n\r\n            // Creates one yes-no render\r\n            return new bizagi.rendering.yesno(renderParams);\r\n        }\r\n\r\n        if (type == \"combo\") {\r\n            return new bizagi.rendering.combo(renderParams);\r\n        }\r\n\r\n        if (/^cascadingcombo$/i.test(type)) {\r\n            return new bizagi.rendering.cascadingCombo(renderParams);\r\n        }\r\n\r\n        if (type == \"list\") {\r\n            return new bizagi.rendering.list(renderParams);\r\n        }\r\n\r\n        if (type == \"multiSelect\") {\r\n            return new bizagi.rendering.multiSelect(renderParams);\r\n        }\r\n\r\n        if (type == \"radio\") {\r\n            return new bizagi.rendering.radio(renderParams);\r\n        }\r\n\r\n        if (type == \"image\") {\r\n            // Override for test purposes\r\n            return new bizagi.rendering.image(renderParams);\r\n        }\r\n        if (type == \"uploadecm\") {\r\n            // Check if its ECM file            \r\n            return new bizagi.rendering.ecm(renderParams);\r\n        }\r\n\r\n        if (type == \"upload\") {\r\n            return new bizagi.rendering.upload(renderParams);\r\n        }\r\n        if (type == \"grid\") {\r\n            return new bizagi.rendering.grid(renderParams);\r\n        }\r\n\r\n        if (type == \"groupedgrid\") {\r\n            return new bizagi.rendering.grid(renderParams);\r\n        }\r\n\r\n        if (type == \"search\") {\r\n            return new bizagi.rendering.search(renderParams);\r\n        }\r\n\r\n        if (type == \"suggest\") {\r\n            renderParams.data.properties.enableQuerySuggestBehavior = true;\r\n            return new bizagi.rendering.search(renderParams);\r\n        }\r\n\r\n        if (type == \"searchList\") {\r\n            return new bizagi.rendering.searchList(renderParams);\r\n        }\r\n\r\n        if (type == \"letter\") {\r\n            return new bizagi.rendering.letter(renderParams);\r\n        }\r\n\r\n        if (type == \"button\") {\r\n            return new bizagi.rendering.button(renderParams);\r\n        }\r\n\r\n        if (type == \"formLink\") {\r\n            return new bizagi.rendering.formLink(renderParams);\r\n        }\r\n\r\n        if (type == \"link\") {\r\n            return new bizagi.rendering.link(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutImage\") {\r\n            return new bizagi.rendering.layoutImage(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutLink\") {\r\n            return new bizagi.rendering.layoutLink(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutLabel\") {\r\n            return new bizagi.rendering.layoutLabel(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutText\") {\r\n            return new bizagi.rendering.layoutText(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutDateTime\") {\r\n            return new bizagi.rendering.layoutDateTime(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutNumber\") {\r\n            return new bizagi.rendering.layoutNumber(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutMoney\") {\r\n            return new bizagi.rendering.layoutMoney(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutPlaceholder\") {\r\n            return new bizagi.rendering.layoutPlaceholder(renderParams);\r\n        }\r\n\r\n        if (type == \"actionLauncher\") {\r\n            return new bizagi.rendering.actionLauncher(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutBoolean\") {\r\n            return new bizagi.rendering.layoutBoolean(renderParams);\r\n        }\r\n\r\n        if (type == \"layoutUpload\") {\r\n            return new bizagi.rendering.layoutUpload(renderParams);\r\n        }\r\n\r\n        if (type == \"entityTemplate\") {\r\n            return new bizagi.rendering.entityTemplate(renderParams);\r\n        }\r\n\r\n        if (type == \"polymorphicLauncher\") {\r\n            return new bizagi.rendering.polymorphicLauncher(renderParams);\r\n        }\r\n\r\n        if (type == \"userfield\") {\r\n            return new bizagi.rendering.userfieldWrapper(renderParams);\r\n        }\r\n\r\n        // Check search renders (starts with \"search\")\r\n        if (type.indexOf(\"search\") == 0) {\r\n            return this.getSearchRender(params);\r\n        }\r\n\r\n        if (type.indexOf(\"query\") == 0) {\r\n            return this.getQueryRender(params);\r\n        }\r\n\r\n        if (type == \"document\") {\r\n            return new bizagi.rendering.document(renderParams);\r\n        }\r\n\r\n        if (type == \"image\") {\r\n            return new bizagi.rendering.image(renderParams);\r\n        }\r\n        if (type == \"fileprint\") {\r\n            return new bizagi.rendering.fileprint(renderParams);\r\n        }\r\n        if (type == \"geolocation\") {\r\n            return new bizagi.rendering.geolocation(renderParams);\r\n        }\r\n\r\n        if (type == \"collectionnavigator\") {\r\n            return new bizagi.rendering.collectionnavigator(renderParams);\r\n        }\r\n\r\n        if (type == \"getUser\") {\r\n            return new bizagi.rendering.getUser(renderParams);\r\n        }\r\n\r\n        if (type == \"rangeDate\") {\r\n            return new bizagi.rendering.rangeDate(renderParams);\r\n        }\r\n\r\n        if (type == \"rangeMoney\") {\r\n            return new bizagi.rendering.rangeMoney(renderParams);\r\n        }\r\n\r\n        if (type == \"rangeNumber\") {\r\n            return new bizagi.rendering.rangeNumber(renderParams);\r\n        }\r\n\r\n        if (type == \"activityCheckList\") {\r\n            return new bizagi.rendering.activityCheckList(renderParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n    /*\r\n    *   Returns the appropiate column based on the render type\r\n    */\r\n    getColumn: function (params) {\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var columnParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService,\r\n            singleInstance: bizagi.util.isEmpty(params.singleInstance) ? true : params.singleInstance\r\n        });\r\n\r\n        if (type == \"columnText\") {\r\n            var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\r\n\r\n            if (isExtended) {\r\n                // Creates one extended render\r\n                columnParams.decorated = bizagi.rendering.extendedText;\r\n            } else {\r\n                // Creates one normal text render\r\n                columnParams.decorated = bizagi.rendering.text;\r\n            }\r\n            return new bizagi.rendering.columns.text(columnParams);\r\n        }\r\n\r\n        if (type == \"columnSearchList\") {\r\n            columnParams.decorated = bizagi.rendering.searchList;\r\n            return new bizagi.rendering.columns.searchList(columnParams);\r\n        }\r\n\r\n        if (type == \"columnNumber\") {\r\n            columnParams.decorated = bizagi.rendering.number;\r\n            return new bizagi.rendering.columns.number(columnParams);\r\n        }\r\n\r\n        if (type == \"columnMoney\") {\r\n            columnParams.decorated = bizagi.rendering.money;\r\n            return new bizagi.rendering.columns.number(columnParams);\r\n        }\r\n\r\n        if (type == \"columnDate\") {\r\n            columnParams.decorated = bizagi.rendering.date;\r\n            return new bizagi.rendering.columns.date(columnParams);\r\n        }\r\n\r\n        if (type == \"columnBoolean\") {\r\n            var display = data.properties.display || \"option\";\r\n\r\n            if (display == \"check\") {\r\n                // Creates one check render\r\n                columnParams.decorated = bizagi.rendering.check;\r\n                if (params.data.properties.isExclusive) {\r\n                    return new bizagi.rendering.columns.exclusiveCheck(columnParams);\r\n                }\r\n            } else {\r\n                // Creates one yes-no render\r\n                columnParams.decorated = bizagi.rendering.yesno;\r\n            }\r\n            return new bizagi.rendering.columns.column(columnParams);\r\n        }\r\n\r\n        if (type == \"columnCombo\") {\r\n            columnParams.decorated = bizagi.rendering.combo;\r\n            return new bizagi.rendering.columns.combo(columnParams);\r\n        }\r\n\r\n        if (type == \"columnRadio\") {\r\n            columnParams.decorated = bizagi.rendering.radio;\r\n            return new bizagi.rendering.columns.radio(columnParams);\r\n        }\r\n\r\n        if (type == \"columnList\") {\r\n            columnParams.decorated = bizagi.rendering.list;\r\n            return new bizagi.rendering.columns.list(columnParams);\r\n        }\r\n\r\n        if (type == \"columnHidden\") {\r\n            columnParams.decorated = bizagi.rendering.hidden;\r\n            return new bizagi.rendering.columns.column(columnParams);\r\n        }\r\n\r\n        if (type == \"columnUpload\") {\r\n            columnParams.decorated = bizagi.rendering.upload;\r\n            return new bizagi.rendering.columns.upload(columnParams);\r\n        }\r\n\r\n        if (type == \"columnImage\") {\r\n            columnParams.decorated = bizagi.rendering.image;\r\n            return new bizagi.rendering.columns.image(columnParams);\r\n        }\r\n\r\n        if (type == \"columnUploadEcm\") {\r\n            columnParams.decorated = bizagi.rendering.ecm;\r\n            return new bizagi.rendering.columns.uploadecm(columnParams);\r\n        }\r\n        if (type == \"columnLink\") {\r\n            columnParams.decorated = bizagi.rendering.link;\r\n            return new bizagi.rendering.columns.link(columnParams);\r\n        }\r\n\r\n        if (type == \"columnFormLink\") {\r\n            columnParams.decorated = bizagi.rendering.formLink;\r\n            return new bizagi.rendering.columns.link(columnParams);\r\n        }\r\n\r\n        if (type == \"columnUserfield\") {\r\n            columnParams.decorated = bizagi.rendering.userfieldWrapper;\r\n            return new bizagi.rendering.columns.column(columnParams);\r\n        }\r\n\r\n        if (type == \"columnSearch\") {\r\n            columnParams.decorated = bizagi.rendering.search;\r\n            return new bizagi.rendering.columns.search(columnParams);\r\n        }\r\n\r\n        if (type == \"columnLabel\") {\r\n            columnParams.decorated = bizagi.rendering.label;\r\n            return new bizagi.rendering.columns.column(columnParams);\r\n        }\r\n\r\n        if (type == \"columnReadonly\") {\r\n            columnParams.decorated = bizagi.rendering.label;\r\n            return new bizagi.rendering.columns.readonly(columnParams);\r\n        }\r\n\r\n        if (type == \"columnDocument\") {\r\n            columnParams.decorated = bizagi.rendering.document;\r\n            return new bizagi.rendering.columns.document(columnParams);\r\n        }\r\n\r\n        if (type == \"columnLetter\") {\r\n            columnParams.decorated = bizagi.rendering.letter;\r\n            return new bizagi.rendering.columns.letter(columnParams);\r\n        }\r\n\r\n        if (type == \"columnButton\") {\r\n            columnParams.decorated = bizagi.rendering.button;\r\n            return new bizagi.rendering.columns.button(columnParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n    /*\r\n    *   Returns the appropiate search render based on the type\r\n    */\r\n    getSearchRender: function (params) {\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var searchParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (type == \"searchText\") {\r\n            var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\r\n\r\n            if (isExtended) {\r\n                // Creates one extended render\r\n                return new bizagi.rendering.extendedText(searchParams);\r\n            }\r\n\r\n            // Creates one normal text render\r\n            return new bizagi.rendering.text(searchParams);\r\n        }\r\n\r\n        if (type == \"searchBoolean\") {\r\n            var display = data.properties.display || \"option\";\r\n\r\n            if (display == \"check\") {\r\n                // Creates one check render\r\n                return new bizagi.rendering.check(searchParams);\r\n            }\r\n\r\n            // Creates one yes-no render\r\n            return new bizagi.rendering.yesno(searchParams);\r\n        }\r\n\r\n        if (type == \"searchNumber\") {\r\n            if (data.properties.dataType == 29) {\r\n                //Creates a Scientific Notation render\r\n                return new bizagi.rendering.numberScientificNotation(searchParams);\r\n            }\r\n            return new bizagi.rendering.number(searchParams);\r\n        }\r\n\r\n        if (type == \"searchMoney\") {\r\n            return new bizagi.rendering.money(searchParams);\r\n        }\r\n\r\n        if (type == \"searchDate\") {\r\n            return new bizagi.rendering.date(searchParams);\r\n        }\r\n\r\n        if (type == \"searchCombo\") {\r\n            return new bizagi.rendering.combo(searchParams);\r\n        }\r\n\r\n        if (type == \"searchSuggest\") {\r\n            return new bizagi.rendering.search(searchParams);\r\n        }\r\n\r\n        if (type == \"searchLabel\") {\r\n            return new bizagi.rendering.label(searchParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n    /*\r\n    *   Returns the appropiate search render based on the type\r\n    */\r\n    getQueryRender: function (params) {\r\n        var type = params.type;\r\n        var data = params.data;\r\n        var searchParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        if (type == \"queryText\") {\r\n            var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\r\n\r\n            if (isExtended) {\r\n                // Creates one extended render\r\n                return new bizagi.rendering.queryExtendedText(searchParams);\r\n            }\r\n\r\n            // Creates one normal text render\r\n            return new bizagi.rendering.queryText(searchParams);\r\n        }\r\n\r\n        if (type == \"queryBoolean\") {\r\n            var display = data.properties.display || \"option\";\r\n\r\n            if (display == \"check\") {\r\n                // Creates one check render\r\n                return new bizagi.rendering.queryCheck(searchParams);\r\n            }\r\n\r\n            // Creates one yes-no render\r\n            return new bizagi.rendering.queryYesNo(searchParams);\r\n        }\r\n\r\n        if (type == \"queryNumber\") {\r\n\r\n            return new bizagi.rendering.queryNumber(searchParams);\r\n        }\r\n\r\n        if (type == \"queryMoney\") {\r\n            return new bizagi.rendering.queryMoney(searchParams);\r\n        }\r\n\r\n        if (type == \"queryDate\") {\r\n            return new bizagi.rendering.queryDate(searchParams);\r\n        }\r\n\r\n        if (type == \"queryCombo\") {\r\n            return new bizagi.rendering.queryCombo(searchParams);\r\n        }\r\n\r\n        if (type == \"queryCascadingCombo\") {\r\n            return new bizagi.rendering.queryCascadingCombo(searchParams);\r\n        }\r\n\r\n        if (type == \"querySuggest\") {\r\n            return new bizagi.rendering.querySuggest(searchParams);\r\n        }\r\n\r\n        if (type == \"queryLabel\") {\r\n            return new bizagi.rendering.queryLabel(searchParams);\r\n        }\r\n\r\n        if (type == \"queryList\") {\r\n            return new bizagi.rendering.queryList(searchParams);\r\n        }\r\n        \r\n        if (type == \"queryMultiSelect\") {\r\n            return new bizagi.rendering.queryMultiSelect(searchParams);\r\n        }\r\n\r\n        if (type == \"querySearch\") {\r\n            return new bizagi.rendering.querySearch(searchParams);\r\n        }\r\n\r\n        if (type == \"queryRadio\") {\r\n            return new bizagi.rendering.queryRadio(searchParams);\r\n        }\r\n\r\n        if (type == \"queryState\") {\r\n            return new bizagi.rendering.queryState(searchParams);\r\n        }\r\n\r\n        if (type == \"queryCaseState\") {\r\n            return new bizagi.rendering.queryCaseState(searchParams);\r\n        }\r\n\r\n        if (type == \"queryProcess\") {\r\n            return new bizagi.rendering.queryProcess(searchParams);\r\n        }\r\n\r\n        if (type == \"querySearchUser\") {\r\n            return new bizagi.rendering.querySearchUser(searchParams);\r\n        }\r\n\r\n        if (type == \"queryHidden\") {\r\n            return new bizagi.rendering.hidden(searchParams);\r\n        }\r\n\r\n        // No type supported\r\n        bizagi.log(type + \" not supported in render factory\", data, \"error\");\r\n        return null;\r\n    },\r\n    /*\r\n    *   Method to fetch templates from a private dictionary\r\n    */\r\n    getTemplate: function (template) {\r\n        var self = this;\r\n        return self.templates[template];\r\n    }\r\n});\r\n","/*\r\n *   Name: BizAgi Tablet Render Factory\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define a render factory to create tablet versions of each render type\r\n */\r\n\r\nbizagi.rendering.base.factory.extend(\"bizagi.rendering.tablet.factory\", {}, {\r\n\r\n    init: function (dataService) {\r\n        var self = this;\r\n\r\n        self._super(dataService);\r\n\r\n        if (bizagi.override.enableMSF) {\r\n            if (bizagi.hasOwnProperty(\"kendo\")) {\r\n                self.templateService = new bizagi.kendo.templates.services.service(bizagi.localization);\r\n            } else {\r\n                self.templateService = new bizagi.templates.services.service(bizagi.localization)\r\n            }\r\n        } else {\r\n            self.templateService = new bizagi.kendo.templates.services.service(bizagi.localization);\r\n        }\r\n    },\r\n\r\n    loadTemplate: function (template, templateDestination) {\r\n        var self = this;\r\n\r\n        // Go fetch the template\r\n        return self.templateService.getTemplate(templateDestination, template)\r\n            .done(function (resolvedRemplate) {\r\n                self.templates[template] = resolvedRemplate;\r\n            });\r\n    },\r\n\r\n    /**\r\n     * Load all the templates used for rendering\r\n     */\r\n    loadTemplates: function() {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        $.when(\r\n            // Common\r\n            self.loadTemplate(\"form-error\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.form-error\")),\r\n            self.loadTemplate(\"form-waiting\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.form-waiting\")),\r\n            // Icons\r\n            self.loadTemplate(\"icons\", bizagi.getTemplate(\"common.bizagi.rendering.icons\")),\r\n            // Containers\r\n            self.loadTemplate(\"form\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.form\") + \"#ui-bizagi-render-form\"),\r\n            self.loadTemplate(\"complexgateway\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.form\") + \"#ui-bizagi-render-complexGateway\"),\r\n            self.loadTemplate(\"panel\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.panel\")),\r\n            self.loadTemplate(\"tab\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.tab\")),\r\n            self.loadTemplate(\"tabItem\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.tabItem\")),\r\n            self.loadTemplate(\"horizontal\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.horizontal\")),\r\n            self.loadTemplate(\"accordion\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.accordion\")),\r\n            self.loadTemplate(\"accordionItem\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.accordionItem\")),\r\n            self.loadTemplate(\"group\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.group\")),\r\n            self.loadTemplate(\"searchForm\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.searchForm\")),\r\n            self.loadTemplate(\"contentPanel\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.contentPanel\")),\r\n\r\n            // Renders\r\n            self.loadTemplate(\"render\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.render\")),\r\n            self.loadTemplate(\"render-layout\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.render.layout\")),\r\n            self.loadTemplate(\"text\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.text\")),\r\n            self.loadTemplate(\"extendedText\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.extendedText\") + \"#ui-bz-mobile-extended-text-control\"),\r\n            self.loadTemplate(\"readonlyExtendedText\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.extendedText\") + \"#ui-bz-mobile-readonly-extended-text-control\"),\r\n            self.loadTemplate(\"number\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.number\") + \"#ui-bz-mobile-number-control\"),\r\n            self.loadTemplate(\"readonlyNumber\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.number\") + \"#ui-bz-mobile-readonly-number-control\"),\r\n            self.loadTemplate(\"numberScientificNotation\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.numberScientificNotation\")),\r\n            self.loadTemplate(\"date\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.date\") + \"#bz-rn-date\"),\r\n            self.loadTemplate(\"readonlyDate\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.date\") + \"#bz-rn-readonly-date\"),\r\n            self.loadTemplate(\"yesno\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.yesno\")),\r\n            self.loadTemplate(\"check\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.check\")),\r\n            self.loadTemplate(\"combo\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.combo\") + \"#ui-bz-mobile-combo-control\"),\r\n            self.loadTemplate(\"readonlyCombo\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.combo\") + \"#ui-bz-mobile-readonly-combo-control\"),\r\n            self.loadTemplate(\"comboModalView\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.combo\") + \"#ui-bz-wp-popup-combo-control\"),\r\n            self.loadTemplate(\"list\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.list\") + \"#ui-bz-mobile-list-control\"),\r\n            self.loadTemplate(\"listModalView\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.list\") + \"#ui-bz-wp-popup-list-control\"),\r\n            self.loadTemplate(\"radio\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.radio\")),\r\n            self.loadTemplate(\"image\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.image\") + \"#ui-bizagi-render-image\"),\r\n            self.loadTemplate(\"image-item\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.image\") + \"#ui-bizagi-render-image-item\"),\r\n            self.loadTemplate(\"image-preview\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.image\") + \"#bz-rd-upload-render-edition\"),\r\n            self.loadTemplate(\"imageModalView\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.image\") + \"#ui-bizagi-render-image-modalview\"),\r\n            self.loadTemplate(\"upload\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.upload\") + \"#ui-bz-mobile-upload-control\"),\r\n            self.loadTemplate(\"uploadModalView\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.upload\") + \"#ui-bz-wp-popup-upload-control\"),\r\n            self.loadTemplate(\"uploadItem\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.uploadItem\")),\r\n            self.loadTemplate(\"uploadSlide\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.slide.upload\")),\r\n            self.loadTemplate(\"grid\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.grid\")),\r\n            self.loadTemplate(\"cell\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.cell\")),\r\n            self.loadTemplate(\"cell.readonly\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.cell.readonly\")),\r\n            self.loadTemplate(\"cell.upload\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.cell.upload\")),\r\n            self.loadTemplate(\"search\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.search\") + \"#ui-bz-mobile-search-control\"),\r\n            self.loadTemplate(\"readonlySearch\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.search\") + \"#ui-bz-mobile-readonly-search-control\"),\r\n            self.loadTemplate(\"searchAddItem\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.searchAddItem\")),\r\n            self.loadTemplate(\"searchItem\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.searchItem\")),\r\n            self.loadTemplate(\"searchList\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.searchList\") + \"#ui-bz-mobile-searchlist-control\"),\r\n            self.loadTemplate(\"searchListModalView\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.searchList\") + \"#ui-bz-wp-popup-searchlist-control\"),\r\n            self.loadTemplate(\"searchListModalViewAuxTemplates\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.searchList\") + \"#ui-bz-wp-searchlist-control-modalview-auxiliary-templates\"),\r\n            self.loadTemplate(\"searchListInputAuxTemplates\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.searchList\") + \"#ui-bz-wp-searchlist-control-input-auxiliary-templates\"),\r\n            self.loadTemplate(\"letter\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.letter\")),\r\n            self.loadTemplate(\"letter.readonly\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.letter.readonly\")),\r\n            self.loadTemplate(\"letter.dialog\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.dialog-letter\")),\r\n            self.loadTemplate(\"button\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.button\")),\r\n            self.loadTemplate(\"link\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.link\")),\r\n            self.loadTemplate(\"geolocation\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.geolocation\")),\r\n            self.loadTemplate(\"association\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.association\")),\r\n            self.loadTemplate(\"ecm\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.ecm\") + \"#bz-rn-ecm-view-default-item\"),\r\n            self.loadTemplate(\"ecm-metadata\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.ecm\") + \"#bz-rn-ecm-metadata\"),\r\n            self.loadTemplate(\"ecmModalView\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.ecm\") + \"#ui-bizagi-render-ecm-modalview\"),\r\n            self.loadTemplate(\"checkList\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.checkList\")),\r\n            self.loadTemplate(\"document\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.document\") + \"#bz-document-generator\"),\r\n            self.loadTemplate(\"document-item\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.document\") + \"#bz-document-generator-item\"),\r\n            self.loadTemplate(\"render-actionLauncher\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.actionLauncher\") + \"#bz-rendering-actionLauncher\"),\r\n            self.loadTemplate(\"render-actionLauncher-horizontal\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.actionLauncher\") + \"#bz-rendering-actionLauncher-horizontal\"),\r\n            self.loadTemplate(\"render-actionLauncher-vertical\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.actionLauncher\") + \"#bz-rendering-actionLauncher-vertical\"),\r\n            self.loadTemplate(\"render-actionLauncher-actions-to-execute\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.actionLauncher\") + \"#bz-rendering-actionLauncher-actions-to-execute\"),\r\n            self.loadTemplate(\"render-polymorphicLauncher\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher\"),\r\n            self.loadTemplate(\"render-polymorphicLauncher-vertical-tree\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-vertical-tree\"),\r\n            self.loadTemplate(\"render-polymorphicLauncher-vertical-tree-item\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-vertical-tree-item\"),\r\n            self.loadTemplate(\"render-polymorphicLauncher-actions-to-execute\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-actions-to-execute\"),\r\n            self.loadTemplate(\"render-polymorphicLauncher-confirm\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-confirm\"),\r\n            self.loadTemplate(\"readonly\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.readonly\")),\r\n            self.loadTemplate(\"list-multiselect\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.multiSelect\") + \"#ui-bz-mobile-multiselect-control\"),\r\n            self.loadTemplate(\"list-multiselect-tag\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.multiSelect\") + \"#ui-bz-mobile-multiselect-tag\"),\r\n            self.loadTemplate(\"list-multiselect-tags\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.multiSelect\") + \"#bz-list-multiselect-tags\"),\r\n            self.loadTemplate(\"list-multiselect-view-more\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.multiSelect\") + \"#ui-bz-mobile-multiselect-view-more\"),\r\n            self.loadTemplate(\"multiselectModalView\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.multiSelect\") + \"#ui-bz-wp-popup-multiselect-control\"),\r\n\r\n\r\n            // Slide View\r\n            self.loadTemplate(\"render-slide-view\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.slide.view\")),\r\n            self.loadTemplate(\"render-slide-view-item\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.slide.view.item\")),\r\n\r\n            //Renders Layouts\r\n            self.loadTemplate(\"layout-image\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.layout.image\") + \"#ui-bizagi-render-layout-image\"),\r\n            self.loadTemplate(\"layout-image64\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.layout.image\") + \"#ui-bizagi-render-layout-image64\"),\r\n            self.loadTemplate(\"layout-label\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.layout.label\")),\r\n            self.loadTemplate(\"layout-link\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.layout.link\")),\r\n            self.loadTemplate(\"layout-text\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.layout.text\")),\r\n            self.loadTemplate(\"layout-date-time\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.layout.dateTime\")),\r\n            self.loadTemplate(\"layout-money\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.layout.money\")),\r\n            self.loadTemplate(\"layout-number\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.layout.number\")),\r\n            self.loadTemplate(\"layout-upload\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.layout.upload\")),\r\n\r\n            // Grid plugin stuff\r\n            self.loadTemplate(\"bizagi.grid.grid\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.grid.component\") + \"#ui-bizagi-grid\"),\r\n            self.loadTemplate(\"bizagi.grid.waiting\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.grid.component\") + \"#ui-bizagi-grid-waiting\"),\r\n            self.loadTemplate(\"bizagi.grid.table\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.grid.component\") + \"#ui-bizagi-grid-table\"),\r\n            self.loadTemplate(\"bizagi.grid.table.empty\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.grid.component\") + \"#ui-bizagi-grid-table-empty\"),\r\n            self.loadTemplate(\"bizagi.grid.column\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.grid.component\") + \"#ui-bizagi-grid-column\"),\r\n            self.loadTemplate(\"bizagi.grid.column.special\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.grid.component\") + \"#ui-bizagi-grid-column-special\"),\r\n            self.loadTemplate(\"bizagi.grid.row\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.grid.component\") + \"#ui-bizagi-grid-row\"),\r\n            self.loadTemplate(\"bizagi.grid.row.buttons\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.grid.component\") + \"#ui-bizagi-grid-row-buttons\"),\r\n            self.loadTemplate(\"bizagi.grid.cell\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.grid.component\") + \"#ui-bizagi-grid-cell\"),\r\n            self.loadTemplate(\"bizagi.grid.cell.special\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.grid.component\") + \"#ui-bizagi-grid-cell-special\"),\r\n            self.loadTemplate(\"bizagi.grid.pager\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.grid.component\") + \"#ui-bizagi-grid-pager\"),\r\n            self.loadTemplate(\"bizagi.grid.buttons\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.grid.component\") + \"#ui-bizagi-grid-buttons\"),\r\n            self.loadTemplate(\"bizagi.grid.dynamicpager\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.grid.component\") + \"#ui-bizagi-grid-dynamic-pager\"),\r\n            self.loadTemplate(\"bizagi.grid.totalizer\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.grid.component\") + \"#ui-bizagi-grid-totalizer\"),\r\n\r\n            // Grid Offline\r\n            self.loadTemplate(\"bizagi.grid.buttons.offline\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.grid.component\") + \"#ui-bizagi-grid-buttons-offline\"),\r\n            self.loadTemplate(\"bizagi.grid.row.buttons.offline\", bizagi.getTemplate(\"bizagi.renderingflat.tablet.grid.component\") + \"#ui-bizagi-grid-row-buttons-offline\")\r\n        ).done(function () {\r\n            var tmplIcons = self.getTemplate(\"icons\");\r\n            var svgStoreCounter = $(\"head\").find('#genome-forms-icons').length;\r\n\r\n            if (svgStoreCounter === 0) {\r\n                $(\"head\").append(tmplIcons);\r\n            }\r\n            // Resolve when all templates are loaded\r\n            defer.resolve();\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Load javascripts after render has been rendered\r\n     */\r\n    loadOverrides: function () {\r\n        // Load custom javascript overrides\r\n        if (bizagi.enableCustomizations) {\r\n            return bizagi.util.loadFile({\r\n                src: bizagi.getJavaScript(\"bizagi.workportal.tablet.overrides\"),\r\n                type: \"js\"\r\n            });\r\n        }\r\n\r\n        return;\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param params\r\n     * @returns {*}\r\n     */\r\n    getRender: function(params) {\r\n        var self = this;\r\n        var type = params.type;\r\n        var data = params.data;\r\n\r\n        var renderParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService\r\n        });\r\n\r\n        // Check is offline form        \r\n        var isOfflineForm = bizagi.util.isOfflineForm({ container: params.parent });\r\n\r\n        if (type === \"grid\") {\r\n            // Review the offline status or context \r\n            if (bizagi.util.isTabletDevice()) {\r\n                if (isOfflineForm) {\r\n                    return new bizagi.rendering.grid.offline(renderParams);\r\n                } else {\r\n                    return new bizagi.rendering.grid(renderParams);\r\n                }\r\n            } else {\r\n                return new bizagi.rendering.grid(renderParams);\r\n            }\r\n        }\r\n\r\n        if (type === \"upload\") {\r\n            // Review the offline status or context  \r\n            if (bizagi.util.isTabletDevice()) {\r\n                if (isOfflineForm) {\r\n                    return new bizagi.rendering.upload.offline(renderParams);\r\n                } else {\r\n                    return new bizagi.rendering.upload(renderParams);\r\n                }\r\n            } else {\r\n                return new bizagi.rendering.upload(renderParams);\r\n            }\r\n        }\r\n\r\n        if (type === \"number\") {\r\n            var properties = data.properties;\r\n            if (properties && properties.dataType === 29) {\r\n                return new bizagi.rendering.numberScientificNotation(renderParams);\r\n            }\r\n\r\n        }\r\n\r\n        // Call base\r\n        return self._super(params);\r\n    },\r\n    /**\r\n     * Returns the appropiate column based on the render type\r\n     * @param params\r\n     * @return {*}\r\n     */\r\n    getColumn: function(params) {\r\n        var self = this;\r\n        var type = params.type;\r\n        var columnParams = $.extend(params, {\r\n            renderFactory: this,\r\n            dataService: params.dataService || this.dataService,\r\n            singleInstance: bizagi.util.isEmpty(params.singleInstance) ? true : params.singleInstance\r\n        });\r\n\r\n        if (type === \"columnNumber\") {\r\n            var data = params.data;\r\n            var properties = data.properties;\r\n\r\n            if (properties && properties.dataType === 29) {\r\n                columnParams.decorated = bizagi.rendering.numberScientificNotation;\r\n                return new bizagi.rendering.columns.numberScientificNotation(columnParams);\r\n            }\r\n        }\r\n\r\n        // Call base\r\n        return self._super(params);\r\n    }\r\n});\r\n","/*\r\n*   Name: Bizagi Device Render Factory\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will detect the current device and then will load the appropriate factory on demand\r\n*/\r\n\r\n$.Class.extend(\"bizagi.rendering.device.factory\", {}, {\r\n\r\n    /**\r\n     * Constructor, detects the device\r\n     * @param params\r\n     */\r\n    init: function (params) {\r\n        this.execution_device = bizagi.util.detectDevice();\r\n        this.cachedFactory = {};\r\n    },\r\n\r\n    /**\r\n     * Returns the appropriate render factory based on the device detection\r\n     * Because it loads the scripts on demand it must return a promise\r\n     * @param dataService\r\n     * @param device\r\n     * @returns {*}\r\n     */\r\n    getRenderFactory: function (dataService, device) {\r\n        var self = this;\r\n        device = device || \"desktop\";\r\n        var defer = new $.Deferred();\r\n\r\n        if (typeof self.cachedFactory[device] !== \"undefined\") {\r\n            // Reset print version value\r\n            self.cachedFactory[device].printVersion = false;\r\n            // Resolve with cached factory                \r\n            defer.resolve(self.cachedFactory[device]);\r\n        } else {\r\n            // If factory is not cached then build it\r\n            if (device === \"print\") {\r\n\r\n                // Load print version references\r\n                self.cachedFactory[device] = new bizagi.rendering.print.factory(dataService);\r\n\r\n                // Wait for async loading\r\n                self.cachedFactory[device].initAsyncStuff()\r\n                    .done(function () {\r\n                        // Resolve operation\r\n                        defer.resolve(self.cachedFactory[device]);\r\n                    });\r\n\r\n            } else if (device === \"desktop\") {\r\n\r\n                // Load desktop references\r\n                self.cachedFactory[device] = new bizagi.rendering.desktop.factory(dataService);\r\n\r\n                // Wait for async loading\r\n                self.cachedFactory[device].initAsyncStuff()\r\n                    .done(function () {\r\n                        // Resolve operation\r\n                        defer.resolve(self.cachedFactory[device]);\r\n                    });\r\n\r\n            } else if (bizagi.util.isTabletDevice(device)) {\r\n\r\n                // Load tablet references\r\n                self.cachedFactory[device] = new bizagi.rendering.tablet.factory(dataService);\r\n\r\n                // Wait for async loading\r\n                self.cachedFactory[device].initAsyncStuff()\r\n                    .done(function () {\r\n                        // Resolve operation\r\n                        defer.resolve(self.cachedFactory[device]);\r\n                    });\r\n            } else if (bizagi.util.isSmartphoneDevice(device)) {\r\n\r\n                // Load tablet references\r\n                self.cachedFactory[device] = new bizagi.rendering.smartphone.factory(dataService);\r\n\r\n                // Wait for async loading\r\n                self.cachedFactory[device].initAsyncStuff()\r\n                    .done(function () {\r\n\r\n                        // Resolve operation\r\n                        defer.resolve(self.cachedFactory[device]);\r\n                    });\r\n            } else {\r\n                // if no device suuported\r\n                bizagi.showMessageBox(\"Not supported device: \" + device);\r\n                defer.reject(\"Not supported device: \" + device);\r\n            }\r\n        }\r\n\r\n        return defer.promise();\r\n    },\r\n\r\n    /**\r\n     * Returns the current data service being used\r\n     * @returns {*}\r\n     */\r\n    getDataService: function () {\r\n        return this.dataService;\r\n    }\r\n\r\n});\r\n","/*\r\n *   Name: BizAgi Rendering\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will process a rendering page by calling an ajax service to retrieve the model,\r\n *       and then process it to create base layout, and then call the device render factory\r\n */\r\n\r\n// Define BizAgi Rendering namespace\r\nbizagi.rendering = bizagi.rendering || {};\r\n\r\n/*\r\n *   This class will define a method to process the page\r\n *   1. Fetch the data\r\n *   2. Call the device factory to appropriately render the content\r\n */\r\n$.Class.extend(\"bizagi.rendering.facade\", {\r\n    form: undefined,\r\n    executionDeferred: new $.Deferred()\r\n}, {\r\n    /*\r\n    *   Constructor\r\n    */\r\n    init: function (params) {\r\n        params = params || {};\r\n\r\n        // Set observable element\r\n        this.observableElement = $({});\r\n\r\n        // Injection of Device, only for print version purpose\r\n        var device = params.device || \"\";\r\n\r\n        // Defines a device factory for all rendering\r\n        this.deviceFactory = new bizagi.rendering.device.factory();\r\n\r\n        // Creates a data service instance\r\n        this.dataService = new bizagi.render.services.service(params);\r\n\r\n        // Retrieves the render factory\r\n        this.renderFactory = this.deviceFactory.getRenderFactory(this.dataService, device);\r\n    },\r\n    getFactory: function () {\r\n        var self = this;\r\n        return {\r\n            deviceFactory: self.deviceFactory,\r\n            dataService: self.dataService,\r\n            renderFactory: self.renderFactory\r\n        };\r\n    },\r\n    /*\r\n    *   Subscribe method\r\n    */\r\n    subscribe: function () {\r\n        this.observableElement.bind.apply(this.observableElement, arguments);\r\n    },\r\n    /*\r\n    *   Unsubscribe method\r\n    */\r\n    unsubscribe: function () {\r\n        this.observableElement.unbind.apply(this.observableElement, arguments);\r\n    },\r\n    /*\r\n    *   Publish method\r\n    */\r\n    publish: function () {\r\n        return this.observableElement.triggerHandler.apply(this.observableElement, arguments);\r\n    },\r\n    /*\r\n    *   This method will re-execute the process\r\n    */\r\n    update: function (params) {\r\n        var self = this;\r\n\r\n        // Update rendering mode\r\n        if (params.mode)\r\n            self.mode = params.mode;\r\n\r\n        // Enable form buttons on desktop view\r\n        return self.execute($.extend({\r\n            canvas: self.canvas,\r\n            mode: self.mode\r\n        }, params));\r\n    },\r\n    /*\r\n    *   Start point method to use in the main javascript pages\r\n    *   This method will process everything and attach the html directly to the dom\r\n    */\r\n    execute: function (params) {\r\n        var self = this;\r\n        var doc = this.ownerDocument;\r\n        var body = $(\"body\", doc);\r\n        params = params || {};\r\n\r\n        // Creates ready deferred\r\n        if (self.executionDeferred && self.executionDeferred.state) {\r\n            if (self.executionDeferred.state() == \"resolved\") {\r\n                self.executionDeferred = $.Deferred();\r\n            }\r\n        } else {\r\n            self.executionDeferred = $.Deferred();\r\n        }\r\n\r\n        // Performance measurement stuff\r\n        bizagi.chrono.initAndStart(\"rendering+data\", true);\r\n        bizagi.rendering.render.startOptimization();\r\n\r\n        // Override mode\r\n        if (typeof (params.mode) === \"undefined\") {\r\n            if (!bizagi.util.isEmpty(window.location.search)) {\r\n                var queryString = bizagi.util.getQueryString();\r\n                params.mode = queryString[\"mode\"];\r\n            }\r\n        }\r\n\r\n        // If the canvas is not given, we need to create one\r\n        var canvas = self.canvas = params.canvas = params.canvas || $(\"<div />\").appendTo(body);\r\n        self.mode = params.mode;\r\n\r\n        self.process(params).done(function (form) {\r\n\r\n            // Clear canvas    \r\n            if (!params.refreshing) {\r\n                canvas.empty();\r\n            }\r\n\r\n            // Append content\r\n            canvas.append(form.container);\r\n\r\n            // Include process path\r\n            $(form.pathProcess).insertBefore(form.container);\r\n\r\n            // Keep reference in class\r\n            self.form = form;\r\n            self.form.setSize({width: self.lastWidth, height: self.lastHeight});\r\n\r\n            // Save window size variables\r\n            setTimeout(function () {\r\n                self.lastWidth = $(window).width();\r\n                self.lastHeight = $(window).height();\r\n                if (window.self !== window.top)\r\n                    self.resizeInPopUpHTML();\r\n            }, 2000);\r\n\r\n            // Publish an event to check if the form has been set in the DOM\r\n            form.triggerHandler(\"ondomincluded\");\r\n\r\n            // Notify to module users that the form has been rendered\r\n            self.publish(\"rendering-formRendered\", {});\r\n\r\n            // Configure handlers\r\n            self.configureRefresh(form, canvas);\r\n            self.configureRouting(form, canvas);\r\n            self.configureRenderError(form, canvas);\r\n            self.configureResize(form);\r\n            self.configureGlobalHandlers(form);\r\n\r\n            // Check if it is a summary form\r\n            if (params.summaryForm) {\r\n                form.container.addClass(\"ui-bizagi-summary-form\");\r\n            }\r\n\r\n            // Ends main timer and log everything\r\n            bizagi.chrono.stopAndLog(\"rendering\");\r\n            bizagi.chrono.stopAndLog(\"rendering+data\");\r\n            bizagi.chrono.stopAndLog(\"submitForm\");\r\n            bizagi.chrono.stopAndLog(\"submitForm-ajax\");\r\n            bizagi.chrono.stopAndLog(\"waiting\");\r\n\r\n            // Resolves deferred\r\n            bizagi.rendering.render.stopOptimization();\r\n\r\n            // Expose public reference of form\r\n            if (bizagi.override.enableE2EInterface) {\r\n                self.Class.form = self.form;\r\n                self.Class.executionDeferred.resolve(self.form);\r\n            }\r\n\r\n            self.executionDeferred.resolve(self.form);\r\n\r\n        }).fail(function (message, errorType) {\r\n\r\n            $.when(self.renderFactory)\r\n                .done(function (renderFactory) {\r\n\r\n                    if (typeof message === \"undefined\" || message === \"\") {\r\n                        message = bizagi.localization.getResource(\"render-error-unknown\");\r\n                    }\r\n\r\n                    var errorTemplate = renderFactory.getCommonTemplate(\"form-error\");\r\n                    // Fill canvas\r\n                    canvas.empty();\r\n                    canvas.append($.tmpl(errorTemplate, {\r\n                        message: message\r\n                    }));\r\n                    self.publish(\"rendering-formRenderedError\", message);\r\n                    self.canvas.triggerHandler(\"errorform\", message);\r\n                    // Ends main timer and log everything\r\n                    bizagi.chrono.stopAndLog(\"rendering\");\r\n                    bizagi.chrono.stopAndLog(\"rendering+data\");\r\n\r\n                    self.executionDeferred.reject();\r\n                });\r\n        });\r\n\r\n        return self.executionDeferred.promise();\r\n    },\r\n    /*\r\n    *   Returns the execution deferred to determine if the component is ready or not\r\n    */\r\n    ready: function () {\r\n        return this.executionDeferred.promise();\r\n    },\r\n    /*\r\n    *   Loads data and render factory in order to process the form\r\n    *   Returns a deferred to set callbacks when the process is done\r\n    */\r\n    process: function (params) {\r\n        var self = this;\r\n        var defer = new $.Deferred();\r\n\r\n        // Call get form data service\r\n        var dataPromise = self.dataService.getFormData(params);\r\n\r\n        var canvas = self.canvas || params.canvas;\r\n\r\n        bizagi.showErrorAlertDialog = false;\r\n        // Set callback when requests have been done\r\n        $.when(dataPromise, self.renderFactory)\r\n            .done(function (data, renderFactory) {\r\n                bizagi.showErrorAlertDialog = true;\r\n\r\n                // When there is no data trigger an event\r\n                if (bizagi.util.isEmpty(data)) {\r\n                    self.publish(\"no-data-found\");\r\n                    defer.fail();\r\n                    return;\r\n                }\r\n\r\n                if (data && data.type == \"reload\") {\r\n                    var form = self.form;\r\n                    if (form) {\r\n                        form.endLoading();\r\n                        form.dispose();\r\n                    }\r\n                    // Trigger handler on canvas\r\n                    canvas.triggerHandler(\"routing\");\r\n\r\n                } else if (data && data.type == \"suspended\") {\r\n                    var errorTemplate = renderFactory.getTemplate(\"info-message\");\r\n                    var message = bizagi.localization.getResource(\"render-case-suspended\");\r\n                    var errorHtml = $.tmpl(errorTemplate, {\r\n                        message: message\r\n                    });\r\n                    // Remove loading icon from summary container\r\n                    errorHtml.appendTo(canvas);\r\n\r\n                    defer.fail();\r\n\r\n                } else if (data && data.type != \"error\") {\r\n                    if (params.hasOwnProperty('printversion')) {\r\n                        data = self.transformGridControl(data);\r\n                        data.form.properties.editable = \"False\";\r\n                    }\r\n\r\n                    bizagi.chrono.initAndStart(\"rendering\");\r\n                    params.type = (data.form && data.form.properties.type) || params.type;\r\n                    var form = self.processForm(data.form, renderFactory, params);\r\n\r\n                    // Resolve deferred\r\n                    defer.resolve(form);\r\n\r\n                } else {\r\n                    self.getFailDeferred(data, defer);\r\n                }\r\n            }).fail(function (errorMessage) {\r\n            self.getFailDeferred(errorMessage, defer);\r\n        });\r\n\r\n        return defer.promise();\r\n    },\r\n    /**\r\n     * In the print version widget when grid control was rendered, the main render has broken\r\n     * Is necesary change id of grid control to fixed these  problems\r\n     */\r\n    transformGridControl: function (data) {\r\n        var self = this;\r\n        if (data == null) {\r\n            return data;\r\n        }\r\n\r\n        if (data.hasOwnProperty('type') && data.type == 'grid') {\r\n            data.id = data.id + \"-print\";\r\n            data.allowAdd = \"False\";\r\n            data.allowDelete = \"False\";\r\n            data.allowEdit = \"False\";\r\n            data.allowGrouping = \"False\";\r\n            data.allowMore = \"False\";\r\n            data.allowSearch = \"False\";\r\n        } else {\r\n            $.each(data, function (key, value) {\r\n                if (typeof (value) == 'object') {\r\n                    data[key] = self.transformGridControl(data[key]);\r\n                }\r\n            });\r\n        }\r\n        return data;\r\n    },\r\n    /**\r\n     * Resolve deferred\r\n     */\r\n    getFailDeferred: function (errorMessage, defer) {\r\n        var self = this;\r\n        var message = \"\";\r\n        var jsonErrorMessage = {};\r\n        try {\r\n            jsonErrorMessage = JSON.parse(errorMessage.responseText);\r\n        } catch (e) {\r\n            jsonErrorMessage = {message: errorMessage.responseText, errorType: \"ERRORUNKNOWN\"};\r\n        }\r\n\r\n\r\n        if (jsonErrorMessage.message) {\r\n            message += \"<br>Error Type: \" + jsonErrorMessage.errorType;\r\n            message += \"<br>Error Message: \" + jsonErrorMessage.message;\r\n        } else {\r\n            if (jsonErrorMessage.errorType == \"JSharpNotSupportedException\") {\r\n                message += \"<br>Error Message: \" + bizagi.localization.getResource(\"jsharp-required\");\r\n            }\r\n        }\r\n\r\n        // Error in metadata InvalidFormMetadata\r\n        if (jsonErrorMessage.errorType == 'ERRORUNKNOWN') {\r\n            defer.reject(message, jsonErrorMessage.errorType);\r\n        } else {\r\n\r\n            defer.reject(message);\r\n        }\r\n    },\r\n    /*\r\n    *   Process the form\r\n    */\r\n    processForm: function (data, renderFactory, params) {\r\n        var form = renderFactory.getContainer($.extend(params, {\r\n            type: params.type || \"form\",\r\n            data: data\r\n        }));\r\n\r\n        //Orientation RTL - OrderButtons\r\n        if (typeof BIZAGI_ORIENTATION != \"undefined\") {\r\n            if ((form.properties.orientation == \"rtl\" || BIZAGI_ORIENTATION == 'rtl') && form.buttons.length > 0) {\r\n                var buttonsForm = form.buttons[0];\r\n\r\n                form.buttons.splice(0, 1);\r\n                form.buttons.push(buttonsForm);\r\n            }\r\n        }\r\n\r\n        // Render the full form\r\n        form.render();\r\n\r\n        return form;\r\n    },\r\n    /*\r\n    *   Performs a resize\r\n    */\r\n    resize: function (args) {\r\n        var self = this;\r\n        if (self.form) {\r\n            self.form.trigger(\"renderresize\", args);\r\n        }\r\n    },\r\n    /*\r\n    *   Binds a refresh handler to detect when the whole form needs to fetch all data from server\r\n    */\r\n    configureRefresh: function (form, canvas) {\r\n        var self = this;\r\n\r\n        // Attach a refresh handler to recreate all the form\r\n        form.bind(\"refresh\", function (_, refreshParams) {\r\n\r\n            // Find the scroll top\r\n            var parent = form.container.parent();\r\n            parent = bizagi.util.scrollTop(parent);\r\n            var scrollTop = parent.scrollTop();\r\n\r\n            $(self.form).trigger(\"onRefreshStarted\");\r\n\r\n            //Dispose current form\r\n            form.dispose(refreshParams);\r\n            canvas.fastEmpty();\r\n            var canvasParent = canvas.parent();\r\n            if (canvasParent.find(\".ui-bizagi-button-container\").length > 0) {\r\n                canvasParent.find(\".ui-bizagi-button-container\").remove();\r\n            }\r\n\r\n            if (self.executionDeferred && self.executionDeferred.state) {\r\n                if (self.executionDeferred.state() == \"resolved\") {\r\n                    self.executionDeferred = $.Deferred();\r\n                }\r\n            }\r\n\r\n            var formParams = self.form.getParams();\r\n            // Re-execute process\r\n            $.when(self.execute($.extend(refreshParams, {\r\n                canvas: canvas,\r\n                refreshing: true,\r\n                idCase: formParams.idCase,\r\n                displayName: formParams.displayName\r\n            }))).done(function () {\r\n\r\n                // Restore scroll at same position\r\n                setTimeout(function () {\r\n                    parent.scrollTop(scrollTop);\r\n                    $(self.form).trigger(\"onRefreshFinished\");\r\n                }, 100);\r\n            });\r\n\r\n            return self.executionDeferred.promise();\r\n        });\r\n    },\r\n    /*\r\n    *   Binds a resize hanlder to configure the resize behaviour\r\n    */\r\n    configureResize: function (form) {\r\n        var self = this;\r\n\r\n        // Attach resize handler\r\n        form.bind(\"renderresize\", function (_, args) {\r\n            args = args || {};\r\n            // Just allow one resize at a time\r\n            if (self.resizeTimeout)\r\n                return;\r\n            var resizeFn = function () {\r\n                // Call resize event in form\r\n                var width = $(window).width();\r\n                var height = $(window).height();\r\n                if (args.forceResize || width != self.lastWidth) {\r\n\r\n                    // Logging stuff\r\n                    bizagi.chrono.initAndStart(\"resize\");\r\n\r\n                    // Perform resize\r\n                    form.resize({\r\n                        width: width,\r\n                        height: height\r\n                    });\r\n                    self.lastWidth = width;\r\n                    self.lastHeight = height;\r\n\r\n                    // Logging stuff\r\n                    bizagi.chrono.stopAndLog(\"resize\");\r\n                    bizagi.chrono.log(\"resize\");\r\n                }\r\n\r\n                self.resizeTimeout = null;\r\n            };\r\n            self.resizeTimeout = setTimeout(resizeFn, 0);\r\n\r\n        });\r\n        self.resize();\r\n    },\r\n    /*\r\n    *   Binds a routing handler to detect when the workportal need to enroute the case\r\n    */\r\n    configureRouting: function (form, canvas) {\r\n        // Attach a routing handler to notify to the caller\r\n        form.bind(\"routing\", function (context, triggerParams) {\r\n            //Dispose current form\r\n            form.dispose();\r\n\r\n            // Trigger handler on canvas\r\n            canvas.triggerHandler(\"routing\", triggerParams);\r\n        });\r\n    },\r\n    /*\r\n    *   Binds a generic handler that will be replicated to facade instantiators\r\n    */\r\n    configureGlobalHandlers: function (form) {\r\n        var self = this;\r\n\r\n        // Attach a routing handler to notify to the caller\r\n        form.bind(\"globalHandler\", function (_, args) {\r\n            // Trigger handler on canvas\r\n            return self.publish(args.eventType, args.data);\r\n        });\r\n    },\r\n    /*\r\n    * Binds error form handler to detect when the render element nop posible get information or error in server\r\n    */\r\n    configureRenderError: function (form, canvas) {\r\n        var self = this;\r\n\r\n        form.bind(\"formRenderingError\", function (event, errorMessage) {\r\n            $.when(self.renderFactory)\r\n                .done(function (renderFactory) {\r\n                    var message = \"<br>Error: \";\r\n\r\n                    errorMessage = errorMessage.replace(/(\\r\\n|\\n|\\r)/gm, \"\");\r\n\r\n                    var jsonErrorMessage = JSON.parse(errorMessage);\r\n                    if (jsonErrorMessage.message) {\r\n                        message += jsonErrorMessage.message;\r\n                        message += \"<br>Error Type: \" + jsonErrorMessage.errorType;\r\n                    }\r\n                    var errorTemplate = renderFactory.getCommonTemplate(\"form-error\");\r\n                    // Fill canvas\r\n                    canvas.empty();\r\n                    canvas.append($.tmpl(errorTemplate, {\r\n                        message: message\r\n                    }));\r\n                    //send the type error to differentiate between a form and an item for render\r\n                    self.canvas.triggerHandler(\"errorform\", \"renderItemError\");\r\n                    // Ends main timer and log everything\r\n                    bizagi.chrono.stopAndLog(\"rendering+data\");\r\n                    bizagi.chrono.stopAndLog(\"rendering\");\r\n                });\r\n        });\r\n    },\r\n\r\n    dispose: function () {\r\n        var self = this;\r\n        if (self.form) {\r\n            self.form.dispose();\r\n        }\r\n        bizagi.util.dispose(self);\r\n    },\r\n\r\n    resizeInPopUpHTML: function () {\r\n        if ($(\".activitiFormContainer\").length > 0 && bizagi.util.getQueryString().type != \"cases\") {\r\n            var heightActivitiFormContainer = $(\".activitiFormContainer\").height() || 0;\r\n            var renderForm = $(\".activitiFormContainer #ui-bizagi-webpart-render-container\");\r\n            var buttonContainer = $(\".ui-bizagi-button-container\", \".activitiFormContainer\");\r\n            var heightButtonContainer = buttonContainer.outerHeight() || 0;\r\n            var renderBehavior = bizagi.util.getQueryString().renderBehavior || \"\";\r\n            renderBehavior = renderBehavior.replace(\"#\", \"\");\r\n\r\n            if (renderBehavior == \"PopUp\") {\r\n                if (typeof (self.postMessageSocket) == \"undefined\") {\r\n                    var heightCanvas = $(\".activitiFormContainer\").height() - 50 || 396;\r\n                    $(\"#render-canvas\").height(heightCanvas);\r\n                    $(\"#render-canvas\").css(\"overflowY\", \"scroll\");\r\n                } else $(\".activitiFormContainer\").height($(\".activitiFormContainer\").height() + $(\".ui-bizagi-button-container\").height() + 30);\r\n                $(\".ui-bizagi-button-container\").css(\"position\", \"absolute\");\r\n                $(\".ui-bizagi-button-container\").appendTo(\".activitiFormContainer\");\r\n                if ($(\".ui-bizagi-button-container\").length > 1) {\r\n                    $(\".ui-bizagi-button-container:first\").hide();\r\n                    renderForm.css(\"marginTop\", \"-17px\");\r\n                }\r\n            }\r\n            if (buttonContainer.length > 0) {\r\n                //display buttons\r\n                renderForm.height(heightActivitiFormContainer - 97 - heightButtonContainer);\r\n            }\r\n            if ($(\".ui-bizagi-button-container\").children().length == 0)\r\n                $(\"#render-canvas\").height($(\"#render-canvas\").height() + heightButtonContainer);\r\n            else {\r\n                buttonContainer.width(\"100%\");\r\n                buttonContainer.css(\"marginLeft\", 0);\r\n                buttonContainer.css(\"bottom\", 0);\r\n            }\r\n        } else if (bizagi.util.getQueryString().type == \"render\") {\r\n            $(\"html\").css(\"overflowX\", \"hidden\");\r\n            ($(\"#render\").height() <= window.innerHeight + 5) ? $(\"html\").css(\"overflowY\", \"hidden\")\r\n                : $(\"html\").css(\"overflowY\", \"scroll\");\r\n            $(\".ui-widget-overlay\").height(650);\r\n        }\r\n    }\r\n\r\n});"]}